{"version":3,"sources":["middlewares/request/requestActions.ts","components/hero/index.jsx","components/cards-grid/index.jsx","components/page-section/index.jsx","components/page/index.jsx","state/user/userReducer.ts","serverApi/urls.ts","state/user/userActions.ts","components/settings-dialog/index.jsx","components/user-login-dialog/user-recover-password-form/index.jsx","constants/getUserErrorsTranslations.js","components/user-login-dialog/index.jsx","state/usersConfig/usersConfigActions.ts","components/sanitized-html/index.jsx","utils/i18n.js","components/settings-select/users-settings-form/user-settings-form/index.jsx","components/button-select/index.jsx","components/user-select/user-change-password-form/index.jsx","components/user-select/index.jsx","links.js","components/categories-tree/index.jsx","state/hubConfig/hubConfigActions.ts","state/spinner/spinnerActions.ts","components/file-input/index.jsx","components/custom-material-table/index.jsx","components/dashboards-manager/index.jsx","state/rootActions.ts","middlewares/persistence/middleware.js","utils/user.ts","components/i18n-input-adornment-select/index.jsx","components/i18n-text-field/index.jsx","components/html-editor/index.jsx","components/i18n-html-editor/index.jsx","components/settings-select/app-settings-form/index.jsx","state/nodesConfig/nodesConfigActions.ts","utils/jsonStat.js","components/label-format-selector/constants.js","utils/criteria.js","components/info-tooltip/index.jsx","components/form-label-with-tooltip/index.jsx","utils/download.js","components/settings-select/nodes-settings-form/node-settings-form/index.jsx","state/dataset/datasetActions.ts","state/cache/cacheActions.ts","components/settings-select/nodes-settings-form/cache-setting-form/index.jsx","state/noteTemplatesConfig/nodeTemplatesConfigActions.ts","components/settings-select/nodes-settings-form/templates-settings-form/index.jsx","components/settings-select/nodes-settings-form/permissions-settings-form/index.jsx","state/nodePermissionsConfig/nodePermissionsConfigActions.ts","components/settings-select/nodes-settings-form/dashboards-settings-form/index.jsx","components/settings-select/nodes-settings-form/index.jsx","components/settings-select/users-settings-form/index.jsx","components/settings-select/index.jsx","components/settings-select/actions.js","components/search-input/index.jsx","components/search-dialog/index.jsx","utils/dashboards.js","state/otherConfig/otherConfigActions.ts","components/other-settings-select/views-settings-form/index.jsx","utils/style.js","components/infinite-scroll-table/sort-buttons/index.jsx","components/infinite-scroll-table/contants.js","components/infinite-scroll-table/utils.js","components/auto-search-input/index.jsx","components/infinite-scroll-table/pre-header/index.jsx","components/infinite-scroll-table/footer/index.jsx","components/custom-empty/index.jsx","components/infinite-scroll-table/filter-button/index.jsx","components/infinite-scroll-table/index.jsx","components/selector/index.jsx","components/i18n-delayed-text-field/index.jsx","constants/getDashboardDynamicFilterLabelTranslations.js","components/dashboard-builder/index.jsx","hocs/call/index.jsx","components/attribute-list/index.jsx","utils/formatters.js","utils/tree.js","middlewares/fetchDatasetAsyncHandler/actions.js","constants/getNutsLevelTranslations.js","components/chart/index.jsx","state/dataset/datasetReducer.ts","constants/getTimingsLabelTranslation.js","components/data-viewer/Timings.jsx","components/data-viewer/ViewBuilder.jsx","utils/other.js","components/table/jsonStatTable.js","components/table/Scrollbars.jsx","components/table/index.jsx","components/data-viewer/TemplateBuilder.jsx","components/data-viewer/Header.jsx","components/data-viewer/Sidebar.jsx","components/data-viewer/Footer.jsx","components/dataset-filters/index.jsx","components/enhanced-tree/index.jsx","components/criteria/TimePeriod.jsx","components/criteria/index.jsx","components/table-layout/index.jsx","components/font-size-selector/index.jsx","components/custom-icons/AreaIcon.jsx","components/custom-icons/RadarIcon.jsx","components/custom-icons/PolarIcon.jsx","components/custom-icons/PyramindIcon.jsx","components/chart-layout/index.jsx","components/map/index.jsx","components/label-format-selector/index.jsx","components/chart-settings/Colors.jsx","components/chart-settings/index.jsx","components/data-viewer/index.jsx","middlewares/fetchDashboardDatasetAsyncHandler/actions.js","state/dashboard/dashboardReducer.ts","state/dashboard/dashboardActions.ts","components/dashboard/DashboardCol.jsx","components/dashboard/DashboardRow.jsx","components/dashboard/index.jsx","components/other-settings-select/user-dashboards-settings-form/index.jsx","components/other-settings-select/index.jsx","components/app-language-select/index.jsx","components/node-header/index.jsx","components/footer/index.jsx","components/home/index.jsx","state/hub/hubActions.ts","components/categories-lists/index.jsx","components/node/index.jsx","state/node/nodeActions.ts","state/catalog/catalogActions.ts","components/results/ResultTree.jsx","components/results/getDownloadButtonStyle.js","components/results/DatasetCard.jsx","components/results/index.jsx","components/data/index.jsx","domains/DatasetDomain.jsx","components/dashboard-filters/index.jsx","domains/DashboardsDomain.jsx","domains/NodeDomain.jsx","domains/MultiLanguageDomain.jsx","state/app/appActions.ts","utils/defaultTheme.js","components/not-implemented-snackbar/NotImplementedSnackbar.jsx","components/error-snackbar/ErrorSnackbar.jsx","components/delete-conflict-modal/index.jsx","state/delete-conflict-modal/deleteConflictModalActions.ts","components/user-set-password-dialog/user-set-password-form/index.jsx","components/user-set-password-dialog/index.jsx","components/spinner/Spinner.jsx","components/error-boundary/index.jsx","components/with-custom-theme/index.jsx","domains/HubDomain.jsx","App.jsx","state/hub/hubReducer.ts","state/node/nodeReducer.ts","model/LocalCategoryProvider.ts","state/rootReducer.ts","state/spinner/spinnerReducer.ts","state/appConfig/appConfigReducer.ts","state/config/configReducer.ts","state/app/appReducer.ts","state/noteTemplatesConfig/nodeTemplatesConfigReducer.ts","state/catalog/catalogReducer.ts","state/hubConfig/hubConfigReducer.ts","state/nodesConfig/nodesConfigReducer.ts","state/cache/cacheReducer.ts","state/otherConfig/otherConfigReducer.ts","state/usersConfig/usersConfigReducer.ts","state/nodePermissionsConfig/nodePermissionsConfigReducer.ts","state/delete-conflict-modal/deleteConflictModalReducer.ts","middlewares/user/userMiddlewareFactory.js","middlewares/request/requestMiddlewareFactory.ts","middlewares/config/configMiddleware.js","middlewares/file-save/middleware.js","middlewares/i18n-middleware/middleware.js","middlewares/request-spinner/requestSpinnerMiddlewareFactory.js","middlewares/feedback/feedbackMiddleware.js","middlewares/fetchDatasetAsyncHandler/middlewareFactory.js","middlewares/fetchDashboardDatasetAsyncHandler/middlewareFactory.js","init.js","index.jsx"],"names":["RequestMethod","withStyles","theme","root","display","flexDirection","justifyContent","alignItems","width","height","background","position","objectFit","zIndex","textContainer","color","textAlign","padding","lightTextContainer","palette","primary","main","buttonsContainer","marginTop","spacing","margin","logo","top","maxWidth","maxHeight","classes","title","slogan","children","Helmet","type","className","Typography","variant","length","style","fontSize","paddingTop","Box","card","list","onClick","squareImage","Grid","container","hasImage","find","c","image","map","i","key","item","xs","Card","id","CardActionArea","CardMedia","component","label","alt","CardContent","gutterBottom","PageSection","props","sectiontitle","Divider","Page","state","transparent","isOldBrowserWarningVisible","handleScroll","scrollTop","window","pageYOffset","document","documentElement","setState","closeWarning","ref","current","scrollIntoView","behavior","alignToTop","scroll","left","isIE","documentMode","isEdge","StyleMedia","this","addEventListener","removeEventListener","oldBrowserWarning","justify","href","target","rel","IconButton","Zoom","in","Fab","fab","ArrowUpward","childrenContainer","Component","right","bottom","appBar","paddingBottom","lineHeight","REQUEST_SUCCESS","UserRoles","UserPermissions","initRequest","url","method","GET","data","messages","extra","baseURL","getHideErrorMessage","hideSpinner","contentType","doNotTransformResponse","payload","uuid","uuidv4","errorRequest","requestActionPayload","statusCode","response","getDatasetUrl","nodeId","datasetId","getDatasetDownloadUrl","format","zipped","getNodeDeleteUrl","force","getDashboardsUrl","dashboardId","showUserLoginForm","alert","SettingsDialog","onSubmit","onClose","open","hasSubmit","noMinHeight","t","useTranslation","Dialog","disableEscapeKeyDown","disableBackdropClick","fullWidth","DialogTitle","DialogContent","minHeight","undefined","DialogActions","Button","Form","compose","field","paper","tabContent","overflowY","overflowX","forwardRef","config","useForm","register","errors","handleSubmit","useImperativeHandle","submit","f","val","cancel","FormControl","TextField","marginBottom","name","error","email","helperText","message","required","inputRef","connect","usersConfig","user","userErrors","dispatch","sendConfig","POST","onStart","str","Alert","severity","getUserErrorsTranslations","InvalidLogin","PasswordRequiresDigit","PasswordTooShort","PasswordRequiresNonAlphanumeric","PasswordRequiresUpper","PasswordRequiresLower","InvalidEmail","translations","recoverPassword","textDecoration","secondary","cursor","onHide","onRegister","useState","isRecoverPasswordModalOpen","setIsRecoverPasswordModalOpen","recoverPasswordFormRef","useRef","password","marginLeft","fetchUsersConfigUsers","SanitizedHTML","html","dangerouslySetInnerHTML","__html","sanitize","validateI18nObj","obj","_","pickBy","keys","value","localizeI18nObj","prefLang","langs","code","Object","getI18nObjCustomFilterAndSearch","language","languages","row","toLowerCase","includes","disclaimerLink","onCancel","isAnonymous","hub","types","defaultValues","isActive","disclaimerAccepted","watch","setValue","showPassword","setShowPassword","showPasswordConfirm","setShowPasswordConfirm","isDisclaimerModalOpen","setIsDisclaimerModalOpen","disclaimerAccetped","useEffect","validate","disabled","emailConfirm","FormControlLabel","control","Checkbox","checked","onChange","e","select","MenuItem","firstName","lastName","organization","InputProps","endAdornment","InputAdornment","Visibility","VisibilityOff","inputProps","autoComplete","passwordConfirm","FormHelperText","disclaimer","appConfig","app","fetchConfig","userId","getUserConfigGetUrl","sendConfigCreate","sendUsersConfigUserCreate","PUT","sendUsersConfigUserEdit","clearConfig","needConfig","setNeedConfig","index","typeOptions","ButtonSelect","anchorEl","setAnchorEl","el","handleMenu","event","currentTarget","handleClose","icon","tooltip","selectedIdx","Boolean","Item","isSelected","startIcon","endIcon","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","filter","showOldPassword","setShowOldPassword","showNewPassword","setShowNewPassword","showNewPasswordConfirm","setShowNewPasswordConfirm","oldPassword","newPassword","newPasswordConfirm","btoa","onLogin","Email","Password","fetchUser","onLogout","onLoginFormShow","onLoginFormHide","isChangePasswordModalOpen","setIsChangePasswordModalOpen","isRegisterModalOpen","setIsRegisterModalOpen","registerFormRef","changePasswordFormRef","isAuthenticated","isLoginDialogOpen","goToDatasets","nodeCode","categoryPath","join","goToData","viewId","a11y","goToDatasetsSearch","query","filters","encodeURIComponent","goToNode","goToHome","noLanguage","goToHubDashboards","goToNodeDashboards","CategoriesTree","expanded","selectedCategoryPath","onExpand","node","catalog","getTreeItems","tree","prevPath","cat","TreeItem","nodeIcon","hasAnnotation","size","onDialogOpen","selectedItem","datasetIdentifiers","childrenCategories","Link","datasetsCount","categoryGroups","categories","TreeView","defaultCollapseIcon","defaultExpandIcon","onNodeToggle","nodeIds","uncategorizedDatasets","content","withTranslation","fetchHubConfigDashboards","addSpinnerMessage","uid","markSpinnerMessage","isError","startAdornment","marginRight","fileInput","substring","lastIndexOf","fileName","setFileName","accept","file","files","fileFormData","FormData","append","fetch","body","headers","token","credentials","then","res","json","filePath","catch","show","htmlFor","CustomMaterialTable","customProps","localization","emptyDataSourceMessage","header","actions","toolbar","searchPlaceholder","searchTooltip","mergedProps","merge","tableIcons","Search","ResetSearch","SortArrow","tableToolbar","buttonAction","typography","button","defaultLanguage","dashboards","allDashboards","fetchDashboards","fetchAllDashboards","addDashboard","removeDashboard","sendDashboardsOrders","clearDashboards","clearAllDashboards","needFetch","setNeedFetch","destroy","orderedDashboardsIds","components","Container","columns","render","customFilterAndSearch","assigned","dashboard","AddIcon","options","paging","draggable","actionsColumnIndex","searchFieldAlignment","maxBodyHeight","showTitle","icons","Toolbar","tableData","ArrowDropUpIcon","rowIndex","slice","ArrowDropDownIcon","DeleteIcon","INIT","persistenceMiddleware","getState","next","action","JSON","parse","localStorage","getItem","result","setItem","stringify","isSetPasswordDialogOpen","supportedLanguages","initialState","roles","permissions","refreshTokenExpiration","tokenTTL","tokenReceivedTime","delayedRequest","userReducer","setPasswordToken","Date","getTime","request","status","getPermissionStr","permission","canDisplayAppSettingsForm","Administrator","canCreateNode","canSortNodes","canDisplayNodesSettingsForm","p","startsWith","ManageCache","ManageTemplate","ManageConfig","canDisplayUsersSettingsForm","canDisplayCacheSettingForm","canDisplayTemplatesSettingsForm","canSaveTemplate","canEditNode","canDisplayUserViews","canSaveAsView","canGetQueryLog","canDisplayPermissionsSettingsForm","canManagePersonalDashboards","canManageAppDashboards","canDeleteNodes","CUSTOM_LANG_TO_COUNTRY","en","langToCountry","setLangToCountry","forEach","langCode","CountryLanguage","getLanguageCountries","err","countries","code_2","lang","data-value","ConnectedComponent","textFieldProps","setLanguage","I18nTextField","HtmlEditor","getInitState","handleEditorChange","bind","editor","getData","items","readOnly","onBeforeLoad","CKEDITOR","disableAutoInline","React","preToolbar","htmlEditorProps","I18nHtmlEditor","disclaimerLabel","tab","setTab","dashboardsManagerRef","createRef","configExtras","extras","pageSize","PageSize","min","Tabs","Tab","Autocomplete","multiple","freeSolo","renderTags","getTagProps","option","Chip","renderInput","params","placeholder","maxObservationsAfterCriteria","maxCells","hubConfig","hubDashboards","sendHubConfig","getAddHubDashboardUrl","addHubConfigDashboardsDashboard","getRemoveHubDashboardUrl","DELETE","removeHubConfigDashboardsDashboard","orderedDashboarIds","fetchNodesConfigNodes","fetchNodesConfigNodeDashboards","getNodeDashboardsUrl","FREQ_DIMENSION_KEY","toUpperCaseFirst","string","toUpperCase","getDimensionLabelFromJsonStat","jsonStat","dimension","getDimensionValueLabelFromJsonStat","category","getDataIdxFromCoordinatesArray","dimensions","dataIdx","multiplier","getCoordinatesArrayFromDataIdx","coordinates","Array","offset","dimensionSize","Math","floor","getFilterTreeFromJsonStat","layout","primaryDim","concat","secondaryDim","paths","path","dim","dimValueIdx","indexOf","push","currentLevel","elem","getInitialFiltersValue","filterTree","selectedPrimaryDim","selectedSecondaryDim","primDimKey","primaryDimValues","secDimKey","secondaryDimValues","filtersValue","iter","selectableValues","allValues","reverse","selectedVal","dimVal","getFilteredLayout","initialLayout","cloneDeep","dimArraysKey","territoryDim","hasOwnProperty","found","getFilteredTableLayout","rows","cols","sections","getFilteredMapLayout","getFilteredChartLayout","getUpdatedLayout","newLayout","allSecondaryDimValues","getDimensionFilterValues","withLabels","dimensionIdx","prevFilters","primDimVal","secDimVal","availableValue","ret","getDimensionValuesIndexesMap","indexesMap","dimValue","idx","getAttributeObjects","attributeList","attributeObj","hiddenAttributes","attributes","ids","hasAsterisk","attr","valueId","values","valueLabel","getDimensionAttributeMap","getIdsHtmlString","series","extension","seriesIndexes","dimensionAttributesMap","dimIdx","findIndex","attributeObjects","htmlString","frequencies","getTimePeriod","initialTimePeriod","criteria","timePeriodCodelist","freqCodelist","minAndMax","moment","add","max","missingRange","getMinAndMax","minDate","maxDate","freq","selectorType","fromDate","from","toDate","to","periods","period","getFreq","freqValues","filterValues","getCriteriaArrayFromObject","criteriaObj","criteriaArr","getCriteriaObjectFromArray","dimensionCriteria","withTheme","placement","aria-label","transform","FormLabelWithTooltip","tooltipOnRight","Tooltip","pointerEvents","downloadFormats","genericdata","genericdata20","compactdata","structurespecificdata","jsondata","csv","getDownloadFormatLabelFromFormat","getDownloadFormatExtensionFromFormat","exportChartJpeg","canvasId","canvas","getElementById","link","createElement","download","toDataURL","appendChild","click","removeChild","mustChangeTabOnErrors","setMustChangeTabOnErrors","active","annotationConfig","showCategoryLevels","decimalNumber","decimalSeparator","catalogNavigationMode","restDataResponseXml","supportPostFilters","enableEndpointV20","endpointV20","enableHttpAuth","enableProxy","optimizeCallWithSoap","namespaceV20","namespaceV21","isPublic","validator","isPort","firstFieldWithErrors","textTransform","agency","Paper","sm","criteriaSelectionMode","endPoint","authHttpUsername","proxyAddress","proxyPort","ttlCatalog","ttlDataflow","helper","getOptionLabel","nodesConfig","getNodeConfigGetUrl","fetchNodesConfigNode","sendNodesConfigNodeEdit","fetchDataflowCache","getDataflowsCacheListUrl","Delete","Edit","Check","Clear","Add","wellFormattedTimeString","days","hours","mins","sec","cacheConfig","fetchCache","clearCache","updateCache","cacheId","ttl","getDataflowsCacheUpdateUrl","updateDataflowCache","createCache","getDataflowsCreateCacheUrl","oldData","createDataflowCache","deleteFromCache","getDataflowsClearCacheUrl","deleteDataflowCache","deleteAllFromCache","getDataflowsClearAllCacheUrl","deleteAllDataflowCache","deleteCatalogCache","getClearNodeCatalogMemoryCacheUrl","hideEmptyDataflowCache","setEmptyDataflowCacheHidden","emptyRowsCounter","setEmptyRowsCounter","rowsCounter","setRowsCounter","cacheSize","editable","rowData","totalSeconds","minutes","seconds","round","secondsToHms","onRowUpdate","newData","Promise","resolve","reject","onRowDelete","dataDelete","splice","editRow","deleteText","editTooltip","deleteTooltip","fetchNodeTemplatesConfig","getNodeTemplatesUrl","templates","nodeTemplatesConfig","fetchTemplates","deleteTemplate","getDeleteTemplateUrl","deleteNodeTemplatesConfigTemplate","clearTemplates","nodes","defaultNodeOpen","onTemplatesClose","needTemplates","setNeedTemplates","deleteTemplateId","setDeleteTemplateId","location","viewTemplateId","autoFocus","styles","PERMISSIONS","getPermissionsTranslations","userVal","nodePermissions","ev","nodePermissionsConfig","getNodePermissionsConfigGetUrl","fetchNodePermissionsConfig","getNodePermissionsConfigPutUrl","sendNodePermissionsConfig","nodeDashboards","getAddNodeDashboardUrl","addNodesConfigDashboardsNodeDashboard","getRemoveNodeDashboardUrl","removeNodesConfigDashboardsNodeDashboard","dashboardsIds","getOrderNodeDashboardsUrl","sendNodesConfigDashboardsNodeOrders","sendOrders","orderedIds","sendNodesConfigNodesOrder","deleteNode","onForce","deleteNodesConfigNode","onNodesClose","isNodeFormVisible","setNodeFormVisibility","nodeFormNodeId","setNodeFormNodeId","nodeDeleteFormNodeId","setNodeDeleteFormNodeId","cacheFormNodeId","setCacheFormNodeId","isCacheFormVisible","setCacheFormVisibility","templatesNodeId","setTemplatesNodeId","permissionsNodeId","setPermissionsNodeId","dashboardsNodeId","setDashboardsNodeId","nodeFormRef","cacheFormRef","templatesRef","permissionsRef","dashboardsRef","orderedNodes","sort","a","b","order","orderedNodesIds","default","PersonIcon","canManageNodeDashboards","DashboardIcon","EditIcon","false","users","deleteUser","getUserDeleteUrl","deleteUsersConfigUser","onUserFormShow","showUserConfigForm","onUserFormHide","userDeleteFormUserId","setUserDeleteFormUserId","userFormRef","SettingsSelect","isAppOpen","isNodesOpen","isUsersOpen","appSettingsRef","nodesSettingsRef","usersSettingsRef","isLogDownloadOpen","logLimit","onAppOpen","onAppClose","showSnackbar","isAppSubmitSnackbarVisible","onNodesOpen","onUsersOpen","onUsersClose","onLogDownloadOpen","onLogDownloadClose","onLogLimitSet","isNaN","onLogDownload","Input","limit","getQueryLog","fileSave","stringifyResponse","downloadQueryLog","onCacheClear","borderRadius","shape","backgroundColor","borderColor","borderWidth","inputRoot","inputInput","input","defaultValue","onKeyDown","preventDefault","$","jQuery","fade","common","white","dialogTop","modalWidth","isOpen","setIsOpen","onRendered","focus","PaperProps","emptyDashboardElem","getViewIdxFromRowAndCol","rowIdx","colIdx","fetchOtherConfigViews","getNewDashboard","newDashboard","dashboardConfig","col","filterDimension","newFilterLevels","labels","filterLevels","viewIds","views","otherConfig","fetchViews","clearViews","deleteView","getDeleteViewUrl","deleteOtherConfigView","onViewsClose","needViews","setNeedViews","deleteViewId","setDeleteViewId","deleteViewNodeId","setDeleteViewNodeId","getScrollBarWidth","temp","css","visibility","overflow","appendTo","widthWithScroll","outerWidth","remove","getTextWidth","text","element","innerText","offsetWidth","SortButtons","CHECKBOX_WIDTH","DATA_INDEX_CHECKED","DEFAULT_PAGE_SIZE","getIndexesFromPaginationParams","pageNum","startIdx","stopIdx","AutoSearchInput","tempValue","timeout","onClear","clearTimeout","onSearch","setTimeout","nextProps","searchText","selectedRowCount","tableActions","renderTableAction","leftActions","rightActions","isLoading","isHidden","rowNumStart","rowNumEnd","rowCount","CircularProgress","fontStyle","textStyle","FilterButton","Popover","InfiniteScrollTable","onSearchTextChange","onFiltersChange","onSortChange","getSelectedRowKeys","onRowSelectionChange","getCols","getNormalizedTableActions","renderActions","renderGridRow","renderFixedActions","renderHeaderCells","renderCheckboxTitle","renderCheckbox","getPopulatedRows","getColWidths","getQueriedRows","getRenderedRows","onRenderedRowsChange","gridKeyForRefresh","scrollLeft","gridScrollbarWidth","sortCol","sortByDesc","selectedRowKeys","rowSelection","populatedRows","colWidths","renderedRows","queriedRows","isResizing","resizeTimeout","pageRequestTimeout","isPaginating","isPaginated","pageRequestParams","viewStartIdx","viewEndIdx","viewIndexesUpdateTimeout","doNotCallOnChangeOnNextRenderedRowsChange","multilangStrDataIndexes","fixedActions","altActions","getIsAltRow","getActionsObjs","populatedRow","dataIndex","getTextWidthEl","get","colTitleWidth","noFilter","noSort","CELL_PADDING","widthToContent","minWidthToContent","renderText","minWidth","isVariableSizeCol","variableSizeCols","colWidthsSum","availableWidth","getIsVerticalScrollbarVisible","widthToAdd","colWidth","colIndex","colsWidths","getRowKey","resRow","getFilteredGridRows","getSearchTextFilteredGridRows","getSortedGridRows","prevProps","isArrayPropertyChangedLazy","newCols","newPopulatedRows","newColWidths","newRenderedRows","newQueriedRows","newScrollTop","$grid","updateRenderedRows","_this","addClass","on","newScrollLeft","off","nextState","nextContext","newFilters","newPageRequestParams","applyQueryChange","newSearchText","colDataIndex","direction","newSortCol","newSortByDesc","rowKey","selected","getIsDisabledRow","onSelect","onSelectAll","newSelectedRowKeys","selRowKey","titleRender","noSearchText","getNormalizedFixedActions","disableOnRowClickForCell","getNormalizedActions","getNormalizedAltActions","withValuesFilter","isValuePassingSearchText","column","_a","_b","sorter","defaultSorter","onRowClick","getRowStyle","cellData","isRowClickDisabled","colLeftAttr","rowStyle","ROW_HEIGHT","columnWidths","uniq","stopPropagation","isCheckDisabled","checkboxProps","getCheckboxProps","overscanStartIdx","overscanEndIdx","currentPageIndexes","pageRowsThird","MAX_PAGE_SIZE","newPaginationParams","maxIdx","minPageSize","maxPageSize","pageNumForMinPageSize","Number","isInteger","minPageNum","ceil","maxPageNum","indexes","getPaginationParamsFromIndexes","rowNum","showHeader","autoSearch","sum","itemSize","itemCount","initialScrollOffset","onItemsRendered","visibleStartIndex","visibleStopIndex","overscanStartIndex","overscanStopIndex","String","prevProp","prop","isDesc","normalize","withSize","iconStyle","Selector","callOnChange","detailTitle","selectTitle","resetTitle","onDetail","onReset","emptyValue","getInitialInternalValue","internalValue","setInternalValue","timeoutId","setTimeoutId","setValueForLanguage","newInternalValue","I18nDelayedTextField","getDashboardDynamicFilterLabelTranslations","Region","Province","Municipality","getStrippedHtmlText","$span","innerHTML","textContent","DashboardBuilderCol","onColRemove","onTypeReset","onViewReset","onTextEdit","onShowTitleChange","onEnableFiltersChange","onFilterDimensionChange","colContainer","viewContainer","view","formLabel","labelPlacement","dynamicViewInput","htmlInput","multiline","viewAction","colActions","DashboardBuilderRow","onRowRemove","onColAdd","rowContainer","rowActions","rowAction","border","verticalAlign","VIEW_ACTION_WIDTH","onViewsHide","selectedRowIdx","setSelectedRowIdx","selectedColIdx","setSelectedColIdx","isEditTextVisible","setEditTextVisibility","tempTextValue","setTempTextValue","handleRowRemove","handleColAdd","handleColRemove","handleTypeReset","handleViewReset","handleEditTextShow","handleEditTextHide","handleShowTitleChange","handleEnableFiltersChange","handleFilterDimensionChange","__originalRow","handleViewSet","handleTextChange","Call","cb","cbParam","Attribute","attribute","cardTitle","fontWeight","datasetAttributesCard","datasetAttributes","seriesAttributes","attributeGroup","otherAttributes","CardHeader","disableTypography","dims","numberFormatter","Intl","NumberFormat","getFormattedInt","separator","subStrs","pop","subStr","getFormattedValue","decimalPlaces","emptyChar","intSeparator","int","decimal","toFixed","getNodesAtDepth","childrenKey","depth","recursive","subTree","currDepth","getTreeFromArray","arr","parentKey","mappedArr","errorFetchDatasetAsyncHandler","getNutsLevelTranslations","0","1","2","3","4","5","6","7","8","9","DEFAULT_COLORS","defaultColorArr","getChartType","isBarChart","isBarOrLineChart","isLineChart","getOptions","chartType","legendPosition","stacked","disableMouseWheel","datasets","dataset","abs","responsive","maintainAspectRatio","scales","xAxes","gridLines","ticks","beginAtZero","callback","yAxes","legend","tooltips","enabled","mode","callbacks","tooltipItem","getValue","datasetIndex","plugins","zoom","pan","removeEmptyValues","labelFormat","colors","primaryDimArr","secondaryDimArr","valorizedDataMap","secondaryDimValue","fill","valorizedDataArr","secDimIdx","primaryDimValue","primDimIdx","dimValueArray","valueIdx","valorizedValues","secDim","getColor","datasetIdx","valIdx","colorIdx","array","n","count","lastIdx","getCorrespondingIndexInFilteredArray","lineTension","getDefaultRemoveEmptyValues","Chart","chartRef","ChartJs","defaults","global","defaultFontFamily","myChart","beforeDraw","chart","ctx","fillStyle","fillRect","isEqual","update","chartId","hideChart","accessibleDataset","isPartialData","isEmptyData","isTooBigData","isCriteriaVisible","isCriteriaAlertVisible","viewerIdx","template","hasViewLayout","hasTemplateLayout","hasAnnotationLayout","tableLayout","mapLayout","chartLayout","tableFilterTree","mapFilterTree","chartFilterTree","initialCriteria","tableEmptyChar","chartStacked","chartLegendPosition","chartColors","mapDetailLevel","enableCriteria","enableLayout","maxAllowedCells","codes","isCodesFlat","codelists","areCodelistsFlat","codelistsLength","timePeriod","timings","isFetchStructureDisabled","isFetchDatasetDisabled","isDownloadWarningVisible","isUnavailableViewWarningVisible","isCriteriaLengthWarningVisible","geometries","geometryDetailLevels","backup","isViewVisible","isViewErrorVisible","viewErrorMessage","isTemplateVisible","datasetReducer","defaultView","getViewerTypeFromIdx","layouts","newCriteria","detailLevel","time","worker","terminate","isResponseNotValid","responseHeaders","backendtimers","isPayloadTooLarge","isView","criteriaView","VIEW_KEY","TEMPLATE_KEY","viewTemplate","hasBackup","viewTemplateLayouts","templateLayouts","layoutChart","structureCriteria","filterData","getViewerIdxFromType","defaultlanguage","emptyCellPlaceHolder","isAccessible","maxTableCells","dimensionCodelist","flatCodes","codelistIdx","newCodelistsLength","parentId","dimensionCodelists","dimensionId","flatCodelists","codelist","timePeriodIdx","freqIdx","detailLevels","nutsLevel","reduce","acc","level","counter","v","console","log","getTimingsLabelTranslations","nsiResponse","nsiResponseDownload","getRow","isTitle","divider","showGenericError","getValorizedElCount","getTableRightPadding","timeoutID","intervalID","isOnMouseDownOnSliderThumb","CustomSlider","orientation","maxValue","onIncrement","isVerticalScrollbarVisible","onMouseUp","clearInterval","handleChange","newValue","sliderId","step","containerRect","getBoundingClientRect","clientY","clientX","isEventInContainer","setInterval","sliderButton","onMouseDown","Slider","track","verticalSlider","SLIDER_WIDTH","horizontalSlider","opacity","spinnerOverlay","verticalValue","verticalMaxValue","verticalTicks","onVerticalScroll","horizontalValue","horizontalMaxValue","horizontalTicks","onHorizontalScroll","isHorizontalScrollbarVisible","setRow","setCol","setIsPaginating","handleSliderScroll","isVertical","getIncrementedValue","prevValue","delta","isIncrement","handleIncrement","prevRow","prevCol","handleWheelScroll","useCallback","wheelDeltaY","wheelDelta","wheelDeltaX","isBetween","newRow","newCol","isFirstRender","isTimeToUpdate","isElementInContainer","checkOnlyVertical","elementRect","getAttributesValueString","onTimeSet","setDatasetHtmlGeneratingTime","addSpinner","removeSpinner","table","isFullscreen","isPreview","removeEmptyLines","isStickyHeader","spinnerUuid","tableSupportStructures","setTableSupportStructures","htmlTable","setHtmlTable","visibleRowCount","setVisibleRowCount","visibleColCount","setVisibleColCount","tableRightPadding","setTableRightPadding","setHorizontalScrollbarVisibility","setVerticalScrollbarVisibility","setAttributes","isCopiedVisible","setCopiedVisibility","Worker","handleStyle","$tooltip","hover","$elem","rect","observationAttributesMap","split","x","innerWidth","empty","cell","cellFontSize","cellPaddingLeft","cellPaddingRight","each","stickyRowCount","stickyColCount","tops","$headerRows","lefts","$firstBodyRowThs","handleScrollbar","updateVisibleRowAndColCount","$tableContainer","colCount","$table","prevIsVerticalScrollbarVisible","prevIsHorizontalScrollbarVisible","onmessage","hasAttributeObservationError","onerror","postMessage","func","colsObj","rowsObj","combinations","valorizedCols","valorizedRows","valorizedRowsPerSection","sectionsLength","rowEnd","colEnd","paginationParams","origColStart","colStart","origColEnd","rowStart","t0","performance","now","colVisited","cc","fullColSpan","repCount","colSpan","sectionLabel","section","r","rr","sectionsStarts","subHeaderHandled","currentSectionIdx","getSectionRow","sectionRow","currentSectionIdxClone","subHeader","rowSpan","getDataCell","dataObj","dataIndexArr","t1","getJsonStatTableHtml","Snackbar","autoHideDuration","prevVal","copy","viewer","viewers","tabId","setTabId","AppBar","scrollButtons","indicatorColor","textColor","titleTypographyProps","enableVariation","tableDefaultLayout","getEmptyViewTemplate","titleContainer","subtitle","attributeIcon","fontFamily","layoutIcon","onViewTemplateShow","showDatasetViewTemplate","onViewTemplateHide","hideDatasetViewTemplate","onViewErrorHide","nodeDownloadFormats","datasetTitle","structureView","structureTemplate","notes","attachedFiles","onViewTemplateSubmit","onDownloadSubmit","mapId","initialView","setInitialView","setView","initialTemplate","setInitialTemplate","setTemplate","isAttributesVisible","setAttributesVisibility","isNotesVisible","setNotesVisibility","isTimingsVisible","setTimingsVisibility","setDownloadFormats","isUpdatingView","setIsUpdatingView","actionsWidth","setAttribute","newDownloadFormats","isDownloadFormatValid","handleViewOpen","isUpdate","handleViewClose","handleTemplateClose","dataSet","datasetIndexes","dimsId","dimsValueId","attrs","currentFilters","dimLabel","canViewTemplateOrAnnotationIcon","canViewTimesLog","handleTemplateOpen","canShare","notImplemented","attachedFile","LMap","exportPng","handleViewSubmit","fullScreen","outline","floatingMenuOption","floatingMenuOptionSelected","categoryTitle","referenceMetadataIcon","iFrame","navigationActionDisabled","isCriteriaDisabled","isLayoutDisabled","isTableDisabled","isChartDisabled","isMapDisabled","referenceMetadataUrl","onViewerSelect","onCriteriaOpen","onLayoutOpen","isRefMetaVisible","setRefMetaVisibility","handleViewerSelect","MenuList","BottomNavigation","showLabels","BottomNavigationAction","src","whiteSpace","sheet","setData","isConfirmOpen","setConfirmVisibility","deleteIcon","onDelete","getFormattedName","isMultiSelectDim","dialogContent","itemDisabled","dimensionTitle","attributeId","attributeAst","visibleId","setVisibleId","checkedKeys","setCheckedKeys","setDimensionAttributesMap","handleFilterClose","InputLabel","Select","renderValue","onOpen","visibleIdx","handleFilterOpen","getKeys","getNodeKey","test","handleHeight","withLevelSelector","actionHeight","levelSelectorHeight","treeActions","treeNode","treeNodeCheckbox","treeNodeLabel","textOverflow","levelTreeNodeLabel","treeNodeAction","showMoreNode","labelKey","getNodeLabel","checkable","defaultExpandedKeys","nodeActions","withoutSearch","withoutCheckControls","withoutExpandControls","withoutPagination","getIsCheckable","isLabelNotMultilingual","setSearchText","expandedKeys","setExpandedKeys","showMoreKeyClicks","setShowMoreKeyClicks","handleCheck","checkedNode","newCheckedKeys","onCheck","handleLevelCheck","nodesAtDepth","filteredTree","handleExpand","getShowMoreNode","parent","remaining","more","getTreeNode","isLevelTree","act","some","child","filterNode","search","subtree","filteredChildren","getFilteredTree","levelTree","maxTreeDepth","getMaxTreeDepth","TREE_NODE_KEY_OF_LEVEL_PREFIX","pointer","disableSelection","year","S1","start","end","endOf","S2","Q1","Q2","Q3","Q4","getYearsArray","startYear","endYear","startYearNumeric","endYearNumeric","getPeriod","date","dateMoment","getNewTimePeriodFromYear","minYear","maxYear","minPeriod","maxPeriod","isFrom","newDate","isSameOrAfter","isSameOrBefore","handleSetTimePeriod","newTimePeriod","onSetTimePeriod","setCriteriaValidity","selectContainer","formControl","timePeriodInput","typeSelectorContainer","typeSelectorLabel","typeSelectorSwitch","lastPeriodsLabel","lastPeriodsInput","isCriteriaValid","fromYear","toYear","fromPeriod","toPeriod","fromPeriods","toPeriods","Switch","utils","DateFnsUtils","DatePicker","openTo","clearable","criteriaContainer","codelistInfo","codelistContainer","emptyContainer","timePeriodContainer","fetchCodelist","flatCriteria","getDatasetStructureDynamicCodelistUrl","isFull","getDatasetStructureCodelistUrl","fetchDatasetStructureCodelist","fetchCodelists","getDatasetStructureCodelistsUrl","fetchDatasetStructureCodelists","onSetCriteria","setDatasetStructureCodelistCriteria","setDatasetStructureCodelistTimePeriod","isCallDisabled","setIsCallDisabled","tmpCriteria","setTmpCriteria","tmpTabId","setTmpTabId","criteriaToRemove","handleTabChange","DataStructureRef","isSelectable","childrenKeys","unselectedChildrenKeys","onDragEnd","setDimensions","source","destination","newDimensions","droppableId","startIndex","endIndex","removed","reorder","droppableSource","droppableDestination","move","Section","Icon","sectionHeaderIcon","sectionHeaderTitle","sectionHeaderContainer","provided","snapshot","sectionContentWrapper","isDraggingOver","draggingHover","innerRef","sectionContent","draggableId","draggableProps","dragHandleProps","isDragging","draggableStyle","userSelect","sectionItem","sectionContainer","previewContainer","setLayout","getFontSizeIcon","styleClasses","fontSizeIcon","fontSizeIconSm","fontSizeIconMd","fontSizeIconLg","fontSizeSelected","boxShadow","setFontSize","AreaIcon","SvgIcon","d","RadarIcon","PolarIcon","PyramidIcon","sourceArr","destinationArr","removedSrc","removedDst","swap","sectionClasses","isDragDisabled","sectionLeft","sectionRight","markSpinner","onGeometryFetch","setDetailLevel","isGeometryData","internalDetailLevel","setInternalDetailLevel","filteredGeometries","setFilteredGeometries","dispatchEvent","Event","firstNotEmptyLevelIndex","destroyMap","mapTranslations","configure","apply","classification","equalInterval","naturalBreaks","quantile","numberOfClasses","startColor","endColor","preview","layerOptions","srid","legendSettings","paletteStartColor","paletteEndColor","paletteCardinality","pointStartRadius","pointEndRadius","pointRadiusCardinality","classificationMethod","onDataRender","valueFormatter","centerMarker","centerMarkerText","selectedCenterMarker","mapOptions","baseMap","baseMapToGray","onLoadingStart","onLoadingFinish","legendFontFamily","initMap","addLayer","geometryMap","g","missingGeometryList","geomId","missingEntry","territoryDimName","dimensionFilterValues","levelsCounter","geom","uniqueId","wkt","float","lev","menuItem","setLabelFormat","getClearedColors","newColors","dimKey","dimValKey","Row","onColorEdit","onColorRemove","rowDimension","itemLabel","itemColor","scrollableRows","selector","initialColors","onColorsSet","setColors","isAddColorVisible","setAddColorVisibility","newDim","setNewDim","newDimVal","setNewDimVal","newColor","setNewColor","isDimension","setIsDimension","isColorPickerVisible","setColorPickerVisibility","tmpDim","setTmpDim","tmpDimVal","setTmpDimVal","tmpColor","setTmpColor","handleAddColorClose","handleColorRemove","handleColorEdit","handleColorPickerClose","rgb","rgba","tabs","isStacked","onIsStackedSet","onLegendPositionSet","viewerType","nodeHeaderHeight","offsetHeight","headerHeight","footerHeight","filtersAndActionsHeight","page","sidebar","viewerContainer","filtersAndActions","footer","warningAlert","criteriaContent","onDatasetFetch","checkCriteriaLength","fetchDataset","onAccessibleDatasetFetch","fetchAccessibleDataset","onFetchDatasetEnable","onCriteriaShow","onCriteriaHide","onCriteriaAlertHide","onViewerSet","setDatasetViewer","onTableLayoutSet","submitDatasetTableLayout","onTableFilterTreeSet","submitDatasetTableFilterTree","onMapLayoutSet","submitDatasetMapLayout","onChartLayoutSet","submitDatasetChartLayout","onChartFilterTreeSet","submitDatasetChartFilterTree","onLabelFormatSet","setDatasetLabelFormat","onChartStackedSet","onChartLegendPositionSet","onChartColorsSet","onMapDetailLevelSet","setDatasetMapDetailLevel","submitDatasetDownload","onDownloadHide","getCreateViewUrl","getCreateTemplateUrl","submitDatasetViewTemplate","onUnavailableViewHide","onCriteriaLengthWarningHide","idList","fetchDatasetGeometries","nodeExtras","maxObservation","tmpTableLayout","setTmpTableLayout","tmpChartLayout","setTmpChartLayout","isLayoutVisible","setLayoutVisibility","setFullscreen","isChartSettingsVisible","setChartSettingsVisibility","tmpChartStacked","setTmpChartStacked","tmpChartLegendPosition","setTmpChartLegendPosition","tmpChartColors","setTmpChartColors","handleLayoutClose","handleLayoutSubmit","newTableFilterTree","newPrimaryDim","newSecondaryDim","prevPrimaryDim","prevSecondaryDim","isSecondaryDimChanged","newChartFilterTree","handleCriteriaClose","handleFilterSelect","handleChartSettingsClose","DownloadFormats","HiddenAttributes","classList","getJsonStatTableSize","errorFetchDashboardDatasetAsyncHandler","requestIds","jsonStats","filterTrees","maps","dashboardReducer","currentDashboardJsonStats","currentDashboardLayouts","currentDashboardFilterTrees","viewIdx","isStaticView","dashboardJsonStats","dashboardLayouts","dashboardFilterTrees","controllersHeight","viewCard","viewPlaceholder","viewControllers","viewTitle","viewStaticFilters","viewStaticFilter","viewActiveFilters","filterValue","dashboardElem","externalJsonStat","externalLayoutObj","externalFilterTree","externalMap","fetchMapGeometries","downloadCsv","setJsonStat","layoutObj","setLayoutObj","setFilterTree","setMap","prevJsonStat","prevLayoutObj","prevFilterTree","prevMaps","staticFilters","Dashboard","externalDashboard","onFilterSet","setDashboard","getStaticDashboard","staticDashboard","initialDashboard","previewDialog","needDashboards","dashboardViews","dashboardMaps","createDashboard","createOtherConfigDashboard","updateDashboard","updateOtherConfigDashboard","changeDashboard","changeOtherConfigDashboard","submitDashboardCreate","submitOtherConfigDashboardCreate","submitDashboardUpdate","getUpdateDashboardUrl","submitOtherConfigDashboardUpdate","deleteDashboard","getDeleteDashboardUrl","deleteOtherConfigDashboard","hideDashboard","fetchOtherConfigDashboardsDataset","setOtherConfigDashboardsDatasetFilter","fetchOtherConfigDashboardsMapGeometries","clearDatasets","onDashboardsClose","deleteDashboardId","setDeleteDashboardId","updateDashboardId","setUpdateDashboardId","isPreviewVisible","setPreviewVisibility","VisibilityIcon","goToDashboard","requests","OtherSettingsSelect","isViewsOpen","isDashboardsOpen","viewsSettigsRef","dashboardsSettingsRef","onViewsOpen","onDashboardsOpen","onDatasetBackup","useLocation","pathname","replace","NodeHeader","isDrawerOpen","defaultTreeOpen","onDrawerOpen","onDrawerClose","shortName","defaultAppConfigOpen","defaultUsersConfigOpen","defaultNodesConfigOpen","defaultNodeConfigOpen","noNode","leftContainer","leftToolbar","menuButton","edge","centerContainer","logoURL","sistanLogo","rightContainer","canClearServerCache","defaultAppOpen","defaultNodesOpen","defaultUsersOpen","Drawer","anchor","drawer","drawerHeader","drawerHeaderTitle","underline","drawerCategories","drawerCategoriesTitle","flexGrow","breakpoints","up","mixins","withRouter","textOnly","Home","info","nodesRef","isListMode","defaultUserConfigOpen","backgroundMediaURL","match","autoPlay","muted","loop","description","fullWidthContainer","anchorContainer","nodesContainer","footerContent","transition","toolbarButtons","fetchHub","paddingLeft","paddingRight","cardContainer","categoriesChunk","rootCategory","fontSizes","Subtree","parentPath","ListItem","ListItemText","Node","configIsListMode","categorySchemeTab","explore","onListModeToggle","setCategorySchemeTab","isDefault","nodeMinimalInfo","uncategorizedCategory","identifier","categoriesForExplore","categoriesContainer","categorySchemesTabs","fetchNode","getNodeUrl","fetchCatalog","getNodeCatalogUrl","resCount","checkbox","categoryGroupsWithCount","uncategorizedDatasetsCount","setExpanded","uncategorizedSelected","noCheckbox","flexWrap","getDownloadButtonStyle","rdf","xml","xls","collapsedDescription","expandedDescription","resultSource","cardContent","downloadChipDeleteIcon","counterAvatar","isExpanded","onViewDataset","onCollapse","isDownloadModalOpen","setIsDownloadModalOpen","downloadModal","setDownloadModal","groupedAttachments","attachedDataFiles","group","urls","headerContent","Avatar","deleteIconSmall","catalogType","keywords","keyword","expandIcon","onExited","Results","expandedIndexes","isA11yMode","expand","collapse","onA11yModeToggle","subCategories","categoryPathLabels","Breadcrumbs","results","subCat","hubExtras","onFetchStructureEnable","enableDatasetStructureFetch","fetchStructure","getDatasetStructureUrl","fetchDatasetStructure","onDatasetReset","isTheSameData","getLabelsMap","getNodes","selectValues","setSelectValues","lastValorizedIdx","setLastValorizedIdx","onFilterApply","isApplyDisabled","setIsApplyDisable","labelsMap","getNode","foundNodes","foundNodesInChild","selects","lastLavorizableIdx","newSelectedValues","dashboardsHeaderHeight","dashboardsFiltersHeight","fetchDashboard","fetchDashboardsDashboard","setDatasetFetchEnableStatus","setDashboardsDatasetFetchEnableStatus","fetchDashboardsDataset","setDashboardsDatasetFilter","fetchDashboardsMapGeometries","submitDashboardDatasetDownload","commonsFilters","dashboardHeader","dashboardTabs","dashboardTitle","setFilterValue","allowedDashboards","setAllowedDashboards","fetchedDashboards","setFetchedDashboards","tabIdx","setTabIdx","newAllowedDashboards","newFetchedDashboards","static","dynamic","handleFilterApply","newFetchedDashboard","handleFetchDatasets","fetchStatic","fetchDynamic","dynamicFilterValue","addRequest","defaultFilterValue","currentDashboardId","isEnable","hasDynamicView","getIsFilterEnabled","FilterComponent","newFilterValue","nodeHavingCode","Recursive","exact","viewParam","URLSearchParams","a11yParam","note","referenceMetadata","ds","datasetsIdsOrDatasetId","getDatasetsIdsAndSubcategoriesOrDatasetId","datasetsIds","lastCategory","datasetIds","nextCategory","categoryId","filtersParams","decodeURIComponent","Set","testDSForQuery","testCatForFilters","dssForCount","dssForResults","searchRecursive","overrideCatSatisfyFilters","catSatisfyFilters","dssSatisfyQueryMap","recursiveCountAndFilterZero","dsId","resultsMap","filtered","appLanguage","setAppLanguage","DEFAULT_THEME","light","dark","contrastText","isInitialized","setIsInitialized","ClickAwayListenerProps","onClickAway","ErrorSnackbar","isVisible","setIsVisible","setMessage","setIsError","deleteConflictModal","usedBy","getObjectTranslation","username","setUserPassword","setPasswordFormRef","overlay","progressContainer","progress","messagesContainer","messageRow","spinner","flushSpinner","isHandlerOn","setIsHandlerOn","LinearProgress","success","ErrorBoundary","hasError","goHome","reload","getPath","setTheme","doc","implementation","createHTMLDocument","styleEl","customTheme","cssRules","selectorText","colorString","createMuiTheme","CssBaseline","ThemeProvider","WithCustomThemeForNode","prefix","substr","WithCustomThemeNoNode","onUserSetPasswordFormShow","showUserSetPasswordForm","defaultNode","tokenParam","hubReducer","nodeReducer","LocalCategoryProvider","categ","rootReducer","datasetMap","datasetUncategorized","newState","dataflowId","cachedDataflow","viewLayout","viewLayouts","haveError","onDeleteConflictForce","userMiddlewareFactory","getMinutes","requestMiddlewareFactory","handleSuccess","requestAction","onSuccess","successRequest","handleGenericError","onGenericError","handleError","onManagedServerError","handleManagedServerError","axios","withCredentials","transformResponse","toString","configMiddleware","fileSaveMiddleware","FileSaver","saveAs","Blob","i18nMiddleware","i18n","changeLanguage","requestSpinnerMiddlewareFactory","spinnerState","feedbackMiddlewareFactory","fetchDatasetAsyncHandlerMiddlewareFactory","myWorker","cellCount","successFetchDatasetAsyncHandler","fetchDashboardDatasetAsyncHandlerMiddlewareFactory","initFetchDashboardDatasetAsyncHandler","newDashboardJsonStats","newDashboardLayouts","newDashboardFilterTrees","successFetchDashboardDatasetAsyncHandler","getRandomParam","random","all","resources","translation","supportedAndTranslatedLanguages","use","initReactI18next","init","lng","returnEmptyString","interpolation","escapeValue","store","configureStore","reducer","middleware","initAction","ReactDOM"],"mappings":"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","file":"static/js/main.e4a18342.chunk.js","sourcesContent":["import {v4 as uuidv4} from 'uuid';\r\n\r\nexport const REQUEST_INIT = \"request/init\";\r\nexport const REQUEST_START = \"request/start\";\r\nexport const REQUEST_ERROR = \"request/error\";\r\nexport const REQUEST_SUCCESS = \"request/success\";\r\n\r\nexport enum RequestMethod {\r\n  GET = \"GET\",\r\n  POST = \"POST\",\r\n  PUT = \"PUT\",\r\n  DELETE = \"DELETE\"\r\n}\r\n\r\ntype RequestMessages = (t: (str: string, options?: any) => string) => {\r\n  onStart?: string,\r\n  onSuccess?: string,\r\n  onError?: string\r\n};\r\n\r\nexport interface RequestActionPayload {\r\n  label: string,\r\n  url: string,\r\n  method: RequestMethod,\r\n  data?: any,\r\n  messages?: RequestMessages,\r\n  extra?: any,\r\n  baseURL?: string,\r\n  getHideErrorMessage?: any,\r\n  hideSpinner?: boolean,\r\n  uuid: string,\r\n  contentType?: string,\r\n  doNotTransformResponse?: boolean\r\n}\r\n\r\nexport const initRequest = (\r\n  label: string,\r\n  url: string,\r\n  method: RequestMethod = RequestMethod.GET,\r\n  data?: any,\r\n  messages?: RequestMessages,\r\n  extra?: any,\r\n  baseURL?: string,\r\n  getHideErrorMessage?: any,\r\n  hideSpinner?: boolean,\r\n  contentType?: string,\r\n  doNotTransformResponse?: boolean\r\n) => ({\r\n  type: REQUEST_INIT,\r\n  payload: {\r\n    uuid: uuidv4(),\r\n    label,\r\n    url,\r\n    method,\r\n    data,\r\n    messages,\r\n    extra,\r\n    baseURL,\r\n    getHideErrorMessage,\r\n    hideSpinner,\r\n    contentType,\r\n    doNotTransformResponse\r\n  }\r\n});\r\n\r\nexport const startRequest = (initRequestPayload: RequestActionPayload) => ({\r\n  type: REQUEST_START,\r\n  payload: initRequestPayload\r\n});\r\n\r\nexport const successRequest = (requestActionPayload: RequestActionPayload, response?: any, extra?: any) => ({\r\n  type: REQUEST_SUCCESS,\r\n  payload: {\r\n    ...requestActionPayload,\r\n    response,\r\n    extra: {\r\n      ...extra,\r\n      ...requestActionPayload.extra\r\n    }\r\n  }\r\n});\r\n\r\nexport type ManagedServerError = {\r\n  errorCode: number,\r\n  stackTrace?: string\r\n};\r\n\r\nexport const errorRequest = (\r\n  requestActionPayload: RequestActionPayload,\r\n  statusCode?: number,\r\n  response?: any,\r\n  extra?: any\r\n) => ({\r\n  type: REQUEST_ERROR,\r\n  payload: {\r\n    ...requestActionPayload,\r\n    statusCode,\r\n    response,\r\n    extra: {\r\n      ...extra,\r\n      ...requestActionPayload.extra\r\n    }\r\n  }\r\n});\r\n","import React, {Fragment} from 'react'\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {Helmet} from \"react-helmet\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  background: {\r\n    \"&, & > *\": {\r\n      position: \"fixed\",\r\n      width: \"100%\",\r\n      height: \"100%\",\r\n      objectFit: \"cover\",\r\n      zIndex: -9999\r\n    }\r\n  },\r\n  textContainer: {\r\n    color: \"white\",\r\n    textAlign: \"center\",\r\n    padding: 24,\r\n    background: \"rgba(0,0,0,0.5)\"\r\n  },\r\n  lightTextContainer: {\r\n    color: theme.palette.primary.main,\r\n    textAlign: \"center\",\r\n    width: \"80%\"\r\n  },\r\n  buttonsContainer: {\r\n    marginTop: theme.spacing(3),\r\n    '& > *': {\r\n      margin: '8px !important'\r\n    }\r\n  },\r\n  logo: {\r\n    position: \"absolute\",\r\n    top: \"80%\",\r\n    width: \"80%\",\r\n    textAlign: \"center\",\r\n    \"& > *\": {\r\n      maxWidth: 340,\r\n      maxHeight: 64\r\n    }\r\n  }\r\n});\r\n\r\nconst Hero = ({classes, title, slogan, logo, background, children}) =>\r\n  <Fragment>\r\n    <Helmet>\r\n      <style type=\"text/css\">\r\n        {`\r\n          html, body, #root {\r\n            height: 100%\r\n          }\r\n        `}\r\n      </style>\r\n    </Helmet>\r\n    <div className={classes.root}>\r\n      <div className={classes.background}>\r\n        {background}\r\n      </div>\r\n      <div className={classes.textContainer}>\r\n        <Typography variant=\"h2\">\r\n          {title}\r\n        </Typography>\r\n        {slogan?.length > 0 && (\r\n          <Typography variant=\"h3\"\r\n                      style={{fontSize: 24, paddingTop: 16}}>\r\n            {slogan}\r\n          </Typography>\r\n        )}\r\n      </div>\r\n      <Box className={classes.buttonsContainer}>\r\n        {children}\r\n      </Box>\r\n      <Box className={classes.logo}>\r\n        {logo}\r\n      </Box>\r\n    </div>\r\n  </Fragment>;\r\n\r\nexport default withStyles(styles)(Hero);","import React from 'react';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardMedia from \"@material-ui/core/CardMedia\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = () => ({\r\n  card: {\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\nconst CardsGrid = ({list, onClick, classes, squareImage}) =>\r\n  <Grid container spacing={2}>\r\n    {(() => {\r\n      const hasImage = squareImage && list.find(c => c.image);\r\n      return list.map((c, i) =>\r\n        <Grid key={i} item xs={hasImage ? 3 : 4}>\r\n          <Card className={classes.card} id={`cards-grid__card-${c.id}`}>\r\n            <CardActionArea onClick={() => onClick(c)}>\r\n              {c.image && (\r\n                <CardMedia\r\n                  component=\"img\"\r\n                  height={hasImage ? 232 : (squareImage ? 315 : 177)}\r\n                  title={c.label}\r\n                  image={c.image}\r\n                  alt={c.label}\r\n                />\r\n              )}\r\n              <CardContent>\r\n                <Typography gutterBottom variant=\"h5\" style={{fontSize: 20}}>\r\n                  {c.label}\r\n                </Typography>\r\n              </CardContent>\r\n            </CardActionArea>\r\n          </Card>\r\n        </Grid>\r\n      );\r\n    })()}\r\n  </Grid>;\r\n\r\nexport default withStyles(styles)(CardsGrid);","import React, {Fragment} from 'react';\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport Box from \"@material-ui/core/Box\";\r\n\r\nconst PageSection = props =>\r\n  <Box {...props}>\r\n    {props.sectiontitle && (\r\n      <Fragment>\r\n        <Typography variant=\"h4\" gutterBottom margin={4} style={{fontSize: 34}}>\r\n          {props.sectiontitle}\r\n        </Typography>\r\n        <Divider/>\r\n      </Fragment>\r\n    )}\r\n    {props.children}\r\n  </Box>;\r\n\r\nexport default PageSection;","import React, {Component} from 'react';\r\nimport Zoom from \"@material-ui/core/Zoom\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport {ArrowUpward} from \"@material-ui/icons\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n  },\r\n  fab: {\r\n    position: 'fixed',\r\n    right: 8,\r\n    bottom: 55,\r\n    height: '50px',\r\n    width: '50px',\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  childrenContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    '& > *:last-child': {\r\n      paddingBottom: theme.spacing(10)\r\n    }\r\n  },\r\n  oldBrowserWarning: {\r\n    position: \"fixed\",\r\n    bottom: 0,\r\n    left: 0,\r\n    zIndex: 1999,\r\n    height: 48,\r\n    width: \"100%\",\r\n    background: \"rgba(0, 0, 0, 0.7)\",\r\n    fontSize: 16,\r\n    lineHeight: \"34px\",\r\n    color: \"white\",\r\n    padding: 8\r\n  }\r\n});\r\n\r\nclass Page extends Component {\r\n\r\n  state = {\r\n    transparent: true,\r\n    isOldBrowserWarningVisible: false\r\n  };\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true,\r\n    });\r\n  }\r\n\r\n  scrollTop() {\r\n    window.scroll({top: 0, left: 0, behavior: 'smooth'});\r\n  }\r\n\r\n  handleScroll = () => {\r\n    const {transparent} = this.state;\r\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n\r\n    if (scrollTop > 50 && transparent) {\r\n      this.setState({transparent: false});\r\n    }\r\n\r\n    if (scrollTop <= 50 && !transparent) {\r\n      this.setState({transparent: true});\r\n    }\r\n  };\r\n\r\n  closeWarning = () => {\r\n    this.setState({isOldBrowserWarningVisible: false});\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Internet Explorer 6-11\r\n    const isIE = !!document.documentMode;\r\n\r\n    // Edge 20+\r\n    const isEdge = !isIE && !!window.StyleMedia;\r\n\r\n    this.setState({isOldBrowserWarningVisible: (isIE || isEdge)});\r\n\r\n    window.scroll({top: 0, left: 0});\r\n\r\n    window.addEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  render() {\r\n\r\n    const {classes, children, id} = this.props;\r\n    const {transparent, isOldBrowserWarningVisible} = this.state;\r\n\r\n    return (\r\n      <div id={id} className={classes.root}>\r\n        {isOldBrowserWarningVisible && (\r\n          <div className={classes.oldBrowserWarning}>\r\n            <Grid container justify=\"space-between\">\r\n              <Grid item>\r\n                This browser in not completely supported, please consider to install the new version\r\n                of <a href=\"https://www.microsoft.com/edge\" target=\"_blank\" rel=\"noopener noreferrer\"\r\n                      style={{color: \"white\"}}>Microsoft Edge</a>\r\n              </Grid>\r\n              <Grid item>\r\n                <IconButton onClick={this.closeWarning} style={{color: \"white\", padding: 7}}>\r\n                  <ClearIcon fontSize=\"small\"/>\r\n                </IconButton>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        )}\r\n        <Zoom in={!transparent}>\r\n          <Fab className={classes.fab} color=\"secondary\" onClick={this.scrollTop}>\r\n            <ArrowUpward/>\r\n          </Fab>\r\n        </Zoom>\r\n        <div className={classes.childrenContainer}>\r\n          {children}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(Page);","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    USER_CLEAR,\r\n    USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR,\r\n    USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET,\r\n    USER_FETCH,\r\n    USER_LOGIN_FORM_HIDE,\r\n    USER_LOGIN_FORM_SHOW,\r\n    USER_REFRESH,\r\n    USER_SET_PASSWORD_FORM_HIDE,\r\n    USER_SET_PASSWORD_FORM_SHOW\r\n} from './userActions';\r\nimport {INIT} from '../rootActions';\r\nimport {PERSISTENCE_ACTION_KEY} from '../../middlewares/persistence/middleware';\r\nimport {USER_ERRORS_INVALID_LOGIN} from '../../constants/getUserErrorsTranslations';\r\n\r\nexport enum UserRoles {\r\n    Administrator= \"Administrator\",\r\n    User = \"User\"\r\n}\r\n\r\nexport enum UserPermissions {\r\n    ManageCache = \"ManageCache\",\r\n    ManageTemplate = \"ManageTemplate\",\r\n    ManageConfig = \"ManageConfig\",\r\n    ManageView = \"ManageView\"\r\n}\r\n\r\nexport type UserState = {\r\n    isAuthenticated: boolean,\r\n    email: string | null,\r\n    roles: UserRoles[],\r\n    permissions: string[],\r\n    token: string | null, // auth token\r\n    refreshTokenExpiration: string | null, // refresh token expiration time (utc)\r\n    tokenTTL: number | null // auth token expiration ttl (minutes)\r\n    tokenReceivedTime: number | null // auth token received time (ms from unix epoch)\r\n    isLoginDialogOpen: boolean,\r\n    delayedRequest: object | null,\r\n    message: string | null\r\n};\r\n\r\nconst initialState = {\r\n    isAuthenticated: false,\r\n    email: null,\r\n    roles: [],\r\n    permissions: [],\r\n    token: null,\r\n    refreshTokenExpiration: null,\r\n    tokenTTL: null,\r\n    tokenReceivedTime: null,\r\n    isLoginDialogOpen: false,\r\n    delayedRequest: null,\r\n    message: null\r\n};\r\n\r\nconst userReducer: Reducer<UserState> = (\r\n    state = initialState,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT:\r\n            return action.payload[PERSISTENCE_ACTION_KEY].user\r\n                ? ({\r\n                    ...initialState,\r\n                    ...action.payload[PERSISTENCE_ACTION_KEY].user\r\n                })\r\n                : initialState;\r\n        case USER_LOGIN_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                isLoginDialogOpen: true,\r\n                message: action.payload?.alert\r\n            };\r\n        case USER_LOGIN_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                isLoginDialogOpen: false,\r\n                message: undefined\r\n            };\r\n        case USER_SET_PASSWORD_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                isSetPasswordDialogOpen: true,\r\n                setPasswordToken: action.payload.token\r\n            };\r\n        case USER_SET_PASSWORD_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                isSetPasswordDialogOpen: false,\r\n                message: undefined\r\n            };\r\n        case USER_CLEAR:\r\n            return initialState;\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case USER_FETCH: {\r\n                    const response = action.payload.response;\r\n                    return {\r\n                        ...response,\r\n                        isLoginDialogOpen: !response.isAuthenticated,\r\n                        tokenReceivedTime: new Date().getTime()\r\n                    };\r\n                }\r\n                case USER_REFRESH:\r\n                    const response = action.payload.response;\r\n                    return {\r\n                        ...response,\r\n                        isLoginDialogOpen: state.isLoginDialogOpen,\r\n                        tokenReceivedTime: new Date().getTime()\r\n                    };\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        case USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET:\r\n            return {\r\n                ...state,\r\n                delayedRequest: action.payload.request\r\n            };\r\n        case USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR:\r\n            return {\r\n                ...state,\r\n                delayedRequest: null\r\n            };\r\n        case REQUEST_ERROR: {\r\n            switch (action.payload.label) {\r\n                case USER_FETCH: {\r\n                    if (action.payload.response.status === 401) {\r\n                        return {\r\n                            ...state,\r\n                            message: USER_ERRORS_INVALID_LOGIN\r\n                        };\r\n                    }\r\n                    return state;\r\n                }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default userReducer;","/* config.json */\r\nexport const getInitConfigUrl = () => \"config.json\";\r\nexport const getAppConfigUrl = () => \"appConfig.json\";\r\n\r\n/* hub */\r\nexport const getHubMinimalInfoUrl = () => \"hub/minimalInfo\";\r\n\r\n/* node */\r\nexport const getNodeUrl = (nodeId: number) => `nodes/${nodeId}`;\r\nexport const getNodeCatalogUrl = (nodeId: number) => `nodes/${nodeId}/catalog`;\r\n\r\n/* cache */\r\nexport const getClearMemoryCacheUrl = () => \"MemoryCache/Clear\";\r\nexport const getDataflowsCacheListUrl = (nodeId: number) => `DataflowCache/DataflowData/Nodes/${nodeId}`;\r\nexport const getDataflowsCacheUpdateUrl = (nodeId: number, cacheId: string) => `DataflowCache/DataflowData/${cacheId}/Nodes/${nodeId}`;\r\nexport const getDataflowsCreateCacheUrl = (nodeId: number) => `DataflowCache/DataflowData/Nodes/${nodeId}`;\r\nexport const getDataflowsClearCacheUrl = (nodeId: number, cacheId: string) => `DataflowCache/Clear/${cacheId}/Nodes/${nodeId}`;\r\nexport const getDataflowsClearAllCacheUrl = (nodeId: number) => `DataflowCache/ClearAll/Nodes/${nodeId}`;\r\nexport const getClearNodeCatalogMemoryCacheUrl = (nodeId: number) => `MemoryCache/Clear/CatalogTree/Nodes/${nodeId}`;\r\n\r\n/* templates */\r\nexport const getNodeTemplatesUrl = (nodeId: number) => `nodes/${nodeId}/templates`;\r\nexport const getCreateTemplateUrl = (nodeId: number) => `nodes/${nodeId}/templates`;\r\nexport const getDeleteTemplateUrl = (nodeId: number, id: number) => `nodes/${nodeId}/templates/${id}`;\r\n\r\n/* views */\r\nexport const getViewsUrl = () => `views`;\r\nexport const getCreateViewUrl = (nodeId: number) => `nodes/${nodeId}/views`;\r\nexport const getDeleteViewUrl = (nodeId: number, id: number) => `nodes/${nodeId}/views/${id}`;\r\n\r\n/* dataset */\r\nexport const getDatasetUrl = (nodeId: number, datasetId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/data`;\r\nexport const getDatasetStructureUrl = (nodeId: number, datasetId: string, viewId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/structure${viewId ? `/${viewId}` : \"\"}`;\r\nexport const getDatasetStructureCodelistUrl = (nodeId: number, datasetId: string, dimensionId: string, isFull: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/column/${dimensionId}/${isFull ? \"full\" : \"partial\"}/values`;\r\nexport const getDatasetStructureDynamicCodelistUrl = (nodeId: number, datasetId: string, dimensionId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/PartialCodelists/${dimensionId}`;\r\nexport const getDatasetStructureCodelistsUrl = (nodeId: number, datasetId: string, isFull: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/columns/${isFull ? \"full\" : \"partial\"}/values`;\r\nexport const getDatasetDownloadUrl = (nodeId: number, datasetId: string, format: string, zipped?: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/${zipped === true ? \"downloadZip\" : \"download\"}/${format}`;\r\n\r\n/* config */\r\nexport const getHubConfigGetUrl = () => \"hub/config\";\r\nexport const getHubConfigPutUrl = () => \"hub\";\r\nexport const getNodesConfigUrl = () => \"nodes/config\";\r\nexport const getNodesOrderPutUrl = () => \"nodes/order\";\r\nexport const getNodeConfigGetUrl = (nodeId: number) => `nodes/${nodeId}/config`;\r\nexport const getNodesConfigPostUrl = () => 'nodes';\r\nexport const getNodesConfigPutUrl = (nodeId: number) => `nodes/${nodeId}`;\r\nexport const getNodeDeleteUrl = (nodeId: number, force?: boolean) => `nodes/${nodeId}${force ? \"/true\" : \"\"}`;\r\n\r\n/* log */\r\nexport const getQueryLog = (limit: number) => `tracing/limit/${limit}`;\r\n\r\n/* files */\r\nexport const getFileUploadUrl = () => 'File/Upload';\r\n\r\n/* authentication */\r\nexport const getTokenUrl = () => 'auth/token';\r\nexport const getRefreshTokenUrl = () => 'auth/refreshToken';\r\n\r\n/* users management */\r\nexport const getUsersConfigGetUrl = () => \"users\";\r\nexport const getUserConfigGetUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserConfigPostUrl = () => \"users/register\";\r\nexport const getUserConfigPutUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserDeleteUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserSendResetPasswordMailUrl = () => 'Users/RecoveryPassword';\r\nexport const getUserResetPasswordUrl = () => 'Users/ResetPassword';\r\nexport const getUserChangePasswordUrl = () => 'Users/ChangePassword';\r\n\r\n/* Geometry */\r\nexport const getGeometryUrl = () => `Geometry`;\r\n\r\n/* permissions */\r\nexport const getNodePermissionsConfigGetUrl = (nodeId: number) => `Users/Permissions/Nodes/${nodeId}`;\r\nexport const getNodePermissionsConfigPutUrl = (nodeId: number) => `Users/Permissions/Nodes/${nodeId}`;\r\n\r\n/* dashboards */\r\nexport const getUserDashboardsUrl = () => \"Dashboards\";\r\nexport const getDashboardsUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getDeleteDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getCreateDashboardUrl = () => `Dashboards/`;\r\nexport const getUpdateDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getHubDashboardsUrl = () => \"Dashboards/Hub\";\r\nexport const getNodeDashboardsUrl = (nodeId: number) => `Dashboards/Nodes/${nodeId}`;\r\nexport const getAddHubDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}/Hub`;\r\nexport const getRemoveHubDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}/Hub`;\r\nexport const getOrderHubDashboardsUrl = () => 'Dashboards/Order/Hub';\r\nexport const getAddNodeDashboardUrl = (nodeId: number, dashboardId: number) => `Dashboards/${dashboardId}/Nodes/${nodeId}`;\r\nexport const getRemoveNodeDashboardUrl = (nodeId: number, dashboardId: number) => `Dashboards/${dashboardId}/Nodes/${nodeId}`;\r\nexport const getOrderNodeDashboardsUrl = (nodeId: number) => `Dashboards/Order/Nodes/${nodeId}`;","import {initRequest, RequestMethod} from '../../middlewares/request/requestActions';\r\nimport {\r\n    getRefreshTokenUrl,\r\n    getTokenUrl,\r\n    getUserChangePasswordUrl,\r\n    getUserResetPasswordUrl,\r\n    getUserSendResetPasswordMailUrl\r\n} from '../../serverApi/urls';\r\n\r\nexport const USER_FETCH = 'USER_FETCH';\r\nexport const USER_REFRESH = 'USER_REFRESH';\r\nexport const USER_CLEAR = 'USER_CLEAR';\r\nexport const USER_LOGIN_FORM_SHOW = 'USER_LOGIN_FORM_SHOW';\r\nexport const USER_LOGIN_FORM_HIDE = 'USER_LOGIN_FORM_HIDE';\r\nexport const USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET = 'USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET';\r\nexport const USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR = 'USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR';\r\nexport const USER_SET_PASSWORD_FORM_SHOW = 'USER_SET_PASSWORD_FORM_SHOW';\r\nexport const USER_SET_PASSWORD_FORM_HIDE = 'USER_SET_PASSWORD_FORM_HIDE';\r\nexport const USER_RESET_PASSWORD_EMAIL_SEND = 'USER_RESET_PASSWORD_EMAIL_SEND';\r\nexport const USER_PASSWORD_CHANGE = 'USER_PASSWORD_CHANGE';\r\nexport const USER_PASSWORD_SET = 'USER_PASSWORD_SET';\r\n\r\nexport const fetchUser = (email: string, password: string) => initRequest(\r\n    USER_FETCH,\r\n    getTokenUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        Email: email,\r\n        Password: btoa(password)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userSelect.messages.fetchUser.start\")\r\n    })\r\n);\r\n\r\nexport const refreshUser = () => initRequest(\r\n    USER_REFRESH,\r\n    getRefreshTokenUrl(),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"middlewares.user.messages.refreshUser.start\")\r\n    })\r\n);\r\n\r\nexport const clearUser = () => ({\r\n    type: USER_CLEAR\r\n});\r\n\r\nexport const showUserLoginForm = (alert: string) => ({\r\n    type: USER_LOGIN_FORM_SHOW,\r\n    payload: {\r\n        alert\r\n    }\r\n});\r\n\r\nexport const hideUserLoginForm = () => ({\r\n    type: USER_LOGIN_FORM_HIDE\r\n});\r\n\r\nexport const setUserDelayedRequestWhenTokenExpired = (request: object) => ({\r\n    type: USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET,\r\n    payload: {\r\n        request\r\n    }\r\n});\r\n\r\nexport const clearUserDelayedRequestWhenTokenExpired = () => ({\r\n    type: USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR\r\n});\r\n\r\nexport const hideUserSetPasswordForm = () => ({\r\n    type: USER_SET_PASSWORD_FORM_HIDE\r\n});\r\n\r\nexport const sendUserResetPasswordEmail = (email: string) => initRequest(\r\n    USER_RESET_PASSWORD_EMAIL_SEND,\r\n    getUserSendResetPasswordMailUrl(),\r\n    RequestMethod.POST,\r\n    email,\r\n    t => ({\r\n        onStart: t(\"components.userRecoverPassword.messages.submit.start\")\r\n    }),\r\n    undefined,\r\n    undefined,\r\n    undefined,\r\n    undefined,\r\n    \"application/json\"\r\n);\r\n\r\nexport const changeUserPassword = (oldPassword: string, newPassword: string) => initRequest(\r\n    USER_PASSWORD_CHANGE,\r\n    getUserChangePasswordUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        oldPassword: btoa(oldPassword),\r\n        newPassword: btoa(newPassword)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userChangePasswordForm.messages.submit.start\")\r\n    })\r\n);\r\n\r\nexport const setUserPassword = (email: string, token: string, password: string) => initRequest(\r\n    USER_PASSWORD_SET,\r\n    getUserResetPasswordUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        username: email,\r\n        token,\r\n        password: btoa(password)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userSetPasswordForm.messages.submit.start\")\r\n    })\r\n);\r\n\r\nexport const showUserSetPasswordForm = (token: string) => ({\r\n    type: USER_SET_PASSWORD_FORM_SHOW,\r\n    payload: {\r\n        token\r\n    }\r\n});\r\n","import React, {Fragment} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {DialogActions} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst SettingsDialog = ({title, children, onSubmit, onClose, open, maxWidth, hasSubmit, noMinHeight}) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth={maxWidth || \"md\"}\r\n      fullWidth\r\n      onClose={onClose}\r\n    >\r\n      <DialogTitle>\r\n        {title}\r\n      </DialogTitle>\r\n      <DialogContent\r\n        style={{\r\n          minHeight: noMinHeight ? undefined : 456,\r\n          paddingBottom: noMinHeight ? 16 : undefined\r\n        }}\r\n      >\r\n        {children}\r\n      </DialogContent>\r\n      <DialogActions>\r\n        {hasSubmit\r\n          ? (\r\n            <Fragment>\r\n              <Button onClick={onClose}>\r\n                {t(\"commons.confirm.cancel\")}\r\n              </Button>\r\n              <Button\r\n                onClick={onSubmit}\r\n              >\r\n                {t(\"commons.confirm.submit\")}\r\n              </Button>\r\n            </Fragment>\r\n          )\r\n          : (\r\n            <Button onClick={onClose}>\r\n              {t(\"commons.confirm.close\")}\r\n            </Button>\r\n          )}\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default SettingsDialog;\r\n","import React, {forwardRef, Fragment, useImperativeHandle} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {sendUserResetPasswordEmail} from \"../../../state/user/userActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit}, ref) => {\r\n\r\n  const {register, errors, handleSubmit} = useForm();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        onSubmit(val);\r\n        f(val);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            style={{marginBottom: 8}}\r\n            name=\"email\"\r\n            label={t(\"components.userLoginDialog.recoverPasswordModal.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  sendConfig: config => dispatch(sendUserResetPasswordEmail(config.email))\r\n});\r\n\r\nconst UserRecoverPasswordForm = ({config, sendConfig, userErrors}, ref) => {\r\n\r\n  return (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>))}\r\n      <Form\r\n        ref={ref}\r\n        onSubmit={sendConfig}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserRecoverPasswordForm);\r\n","export const USER_ERRORS_INVALID_LOGIN = \"InvalidLogin\";\r\n\r\nexport const getUserErrorsTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    InvalidLogin: t(\"errors.user.invalidLogin\"),\r\n    PasswordRequiresDigit: t(\"errors.user.passwordRequiresDigit\"),\r\n    PasswordTooShort: t(\"errors.user.passwordTooShort\"),\r\n    PasswordRequiresNonAlphanumeric: t(\"errors.user.passwordRequiresNonAlphanumeric\"),\r\n    PasswordRequiresUpper: t(\"errors.user.passwordRequiresUpper\"),\r\n    PasswordRequiresLower: t(\"errors.user.passwordRequiresLower\"),\r\n    InvalidEmail: t(\"errors.user.invalidEmail\")\r\n  });\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};\r\n","import React, {Fragment, useRef, useState} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {DialogActions, withStyles} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport {useForm} from \"react-hook-form\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport UserRecoverPasswordForm from \"./user-recover-password-form\";\r\nimport {getUserErrorsTranslations} from \"../../constants/getUserErrorsTranslations\";\r\n\r\nconst styles = theme => ({\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  recoverPassword: {\r\n    textDecoration: \"underline\",\r\n    color: theme.palette.secondary.main,\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\nconst UserLoginDialog = ({open, onSubmit, onHide, onRegister, classes, alert}) => {\r\n\r\n  const {register, errors, handleSubmit} = useForm();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isRecoverPasswordModalOpen, setIsRecoverPasswordModalOpen] = useState(false);\r\n\r\n  const recoverPasswordFormRef = useRef();\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n      onClose={onHide}\r\n    >\r\n      <DialogTitle>\r\n        {t(\"components.userLoginDialog.title\")}\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        {alert && (\r\n          <Alert severity=\"error\">{getUserErrorsTranslations(t)[alert]}</Alert>\r\n        )}\r\n        <FormControl fullWidth className={alert ? classes.field : undefined}>\r\n          <TextField\r\n            name=\"email\"\r\n            label={t(\"components.userLoginDialog.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n        <FormControl fullWidth className={classes.field}>\r\n          <TextField\r\n            name=\"password\"\r\n            type=\"password\"\r\n            label={t(\"components.userLoginDialog.fields.password\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.password}\r\n            helperText={\r\n              <Fragment>\r\n                {errors.password?.message}\r\n                <span\r\n                  onClick={() => setIsRecoverPasswordModalOpen(true)}\r\n                  className={classes.recoverPassword}\r\n                  style={{\r\n                    marginLeft: errors.password?.message ? 2 : 0\r\n                  }}>\r\n                  {t(\"components.userLoginDialog.recoverPassword\")}\r\n                </span>\r\n              </Fragment>\r\n            }\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onHide}>\r\n          {t(\"commons.confirm.cancel\")}\r\n        </Button>\r\n        <Button onClick={onRegister}>\r\n          {t(\"components.userLoginDialog.register\")}\r\n        </Button>\r\n        <Button onClick={handleSubmit(onSubmit)}>\r\n          {t(\"components.userLoginDialog.login\")}\r\n        </Button>\r\n      </DialogActions>\r\n      <SettingsDialog\r\n        title={t(\"components.userLoginDialog.recoverPasswordModal.title\")}\r\n        maxWidth={\"xs\"}\r\n        open={isRecoverPasswordModalOpen}\r\n        onClose={() => {\r\n          if (recoverPasswordFormRef.current) {\r\n            recoverPasswordFormRef.current.cancel(() => {\r\n              setIsRecoverPasswordModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsRecoverPasswordModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (recoverPasswordFormRef.current) {\r\n            recoverPasswordFormRef.current.submit(() => {\r\n              setIsRecoverPasswordModalOpen(false);\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n        noMinHeight\r\n      >\r\n        <UserRecoverPasswordForm ref={recoverPasswordFormRef}/>\r\n      </SettingsDialog>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(UserLoginDialog);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getUserConfigGetUrl,\r\n    getUserConfigPostUrl,\r\n    getUserConfigPutUrl,\r\n    getUserDeleteUrl,\r\n    getUsersConfigGetUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const USERS_CONFIG_USERS_FETCH = \"usersConfig/fetchUsers\";\r\nexport const USERS_CONFIG_USERS_CLEAR = \"usersConfig/clearUsers\";\r\nexport const USERS_CONFIG_USER_FETCH = \"usersConfig/fetchUser\";\r\nexport const USERS_CONFIG_USER_CLEAR = \"usersConfig/clearUser\";\r\nexport const USERS_CONFIG_USER_DELETE = \"usersConfig/deleteUser\";\r\nexport const USERS_CONFIG_USER_CREATE = \"usersConfig/createUser\";\r\nexport const USERS_CONFIG_USER_EDIT = \"usersConfig/editUser\";\r\nexport const USER_CONFIG_FORM_SHOW = \"usersConfig/showForm\";\r\nexport const USER_CONFIG_FORM_HIDE = \"usersConfig/hideForm\";\r\n\r\nexport const fetchUsersConfigUsers = () => initRequest(\r\n    USERS_CONFIG_USERS_FETCH,\r\n    getUsersConfigGetUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.fetchUsers.start\")\r\n    })\r\n);\r\n\r\nexport const clearUsersConfigUsers = () => ({\r\n    type: USERS_CONFIG_USERS_CLEAR\r\n});\r\n\r\nexport const fetchUsersConfigUser = (userId: number) => initRequest(\r\n    USERS_CONFIG_USER_FETCH,\r\n    getUserConfigGetUrl(userId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.fetchUser.start\")\r\n    })\r\n);\r\n\r\nexport const clearUsersConfigUser = () => ({\r\n    type: USERS_CONFIG_USER_CLEAR\r\n});\r\n\r\nexport const deleteUsersConfigUser = (userId: number) => initRequest(\r\n    USERS_CONFIG_USER_DELETE,\r\n    getUserDeleteUrl(userId),\r\n    RequestMethod.DELETE,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.deleteUser.start\")\r\n    }),\r\n    {\r\n        userId\r\n    }\r\n);\r\n\r\nexport const sendUsersConfigUserCreate = (user: any, isAnonymous: boolean) => initRequest(\r\n    USERS_CONFIG_USER_CREATE,\r\n    getUserConfigPostUrl(),\r\n    RequestMethod.POST,\r\n    user,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.sendUserCreate.start\")\r\n    }),\r\n    {\r\n        isAnonymous\r\n    }\r\n);\r\n\r\nexport const sendUsersConfigUserEdit = (user: any) => initRequest(\r\n    USERS_CONFIG_USER_EDIT,\r\n    getUserConfigPutUrl(user.userId),\r\n    RequestMethod.PUT,\r\n    user,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.sendUserEdit.start\")\r\n    })\r\n);\r\n\r\nexport const showUserConfigForm = (userId: number) => ({\r\n    type: USER_CONFIG_FORM_SHOW,\r\n    payload: {\r\n        userId\r\n    }\r\n});\r\n\r\nexport const hideUserConfigForm = () => ({\r\n    type: USER_CONFIG_FORM_HIDE\r\n});","import React from 'react';\r\nimport {sanitize} from \"dompurify\";\r\nimport Box from \"@material-ui/core/Box\";\r\n\r\nconst SanitizedHTML = props =>\r\n  <Box\r\n    {...props}\r\n    html={undefined}\r\n    dangerouslySetInnerHTML={{__html: sanitize(props.html)}}\r\n  />;\r\n\r\nexport default SanitizedHTML;","import _ from \"lodash\";\r\n\r\nexport const validateI18nObj = obj =>\r\n  obj !== undefined && obj !== null &&\r\n  _(obj)\r\n    .pickBy(val => val !== undefined && val !== null && val.length > 0)\r\n    .keys()\r\n    .value().length > 0;\r\n\r\nexport const localizeI18nObj = (obj, prefLang, langs) => {\r\n\r\n  if (obj === null || obj === undefined || obj === {}) {\r\n    return null\r\n  }\r\n  if (typeof (obj) === \"string\") {\r\n    return obj\r\n  }\r\n\r\n  if (obj[prefLang]) {\r\n    return obj[prefLang];\r\n  }\r\n\r\n  for (let code of langs) {\r\n    if (obj[code]) {\r\n      return obj[code];\r\n    }\r\n  }\r\n\r\n  return obj[Object.keys(obj)[0]];\r\n};\r\n\r\nexport const getI18nObjCustomFilterAndSearch = (language, languages) => (str, row, {field}) =>\r\n  localizeI18nObj(row[field], language, languages).toLowerCase().includes(str.toLowerCase());","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUsersConfigUser,\r\n  fetchUsersConfigUser,\r\n  sendUsersConfigUserCreate,\r\n  sendUsersConfigUserEdit,\r\n} from \"../../../../state/usersConfig/usersConfigActions\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport {getUserErrorsTranslations} from \"../../../../constants/getUserErrorsTranslations\";\r\nimport SanitizedHTML from \"../../../sanitized-html\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport {localizeI18nObj} from \"../../../../utils/i18n\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  },\r\n  disclaimerLink: {\r\n    marginLeft: theme.spacing(1),\r\n    color: theme.palette.secondary.main,\r\n    textDecoration: \"underline\"\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit, onCancel, isAnonymous, hub, types, languages, language}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      isActive: true,\r\n      type: \"null\",\r\n      disclaimerAccepted: isAnonymous ? false : undefined,\r\n      ...config\r\n    }\r\n  });\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showPasswordConfirm, setShowPasswordConfirm] = useState(false);\r\n  const [isDisclaimerModalOpen, setIsDisclaimerModalOpen] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          type: val.type !== \"null\" ? val.type : null,\r\n          disclaimerAccetped: undefined\r\n        };\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  useEffect(() => {\r\n\r\n    register(\"type\");\r\n\r\n    if (isAnonymous) {\r\n      register({\r\n          name: \"disclaimerAccepted\"\r\n        },\r\n        {\r\n          validate: val => val || t(\"scenes.usersSettings.userSettings.validation.mustAcceptDisclaimer\")\r\n        });\r\n    } else {\r\n      register(\"isActive\");\r\n    }\r\n\r\n  }, [isAnonymous, register, t]);\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={6}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            disabled={!!config}\r\n            name=\"email\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.email\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      {!config && (\r\n        <Grid item xs={6}>\r\n          <FormControl fullWidth>\r\n            <TextField\r\n              disabled={!!config}\r\n              name=\"emailConfirm\"\r\n              label={t(\"scenes.usersSettings.userSettings.fields.emailConfirm\")}\r\n              inputRef={\r\n                register({\r\n                  required: t(\"commons.validation.required\"),\r\n                  validate: val =>\r\n                    val === watch('email') ||\r\n                    t(\"scenes.usersSettings.userSettings.validation.emailsMustBeEqual\")\r\n                })\r\n              }\r\n              error={!!errors.emailConfirm}\r\n              helperText={errors.emailConfirm?.message}\r\n              variant=\"outlined\"\r\n              required\r\n            />\r\n          </FormControl>\r\n        </Grid>\r\n      )}\r\n      {!isAnonymous && (\r\n        <Grid item xs={12}>\r\n          <FormControl fullWidth>\r\n            <FormControlLabel\r\n              label={t(\"scenes.usersSettings.userSettings.fields.isActive.label\")}\r\n              control={\r\n                <Checkbox\r\n                  name=\"isActive\"\r\n                  required\r\n                  checked={watch('isActive')}\r\n                  onChange={(e, value) => setValue('isActive', value)}\r\n                />\r\n              }\r\n            />\r\n          </FormControl>\r\n        </Grid>\r\n      )}\r\n      {types && types.length > 0 && (\r\n        <Grid item xs={12}>\r\n          <FormControl fullWidth>\r\n            <TextField\r\n              name=\"type\"\r\n              select\r\n              label={t(\"scenes.usersSettings.userSettings.fields.type.label\")}\r\n              variant=\"outlined\"\r\n              onChange={e => setValue('type', e.target.value)}\r\n              value={watch(\"type\") || ''}\r\n              helperText={errors.type?.message}\r\n              error={!!errors.type}\r\n            >\r\n              <MenuItem value=\"null\">\r\n                <i>{t(\"scenes.usersSettings.userSettings.fields.type.values.empty\")}</i>\r\n              </MenuItem>\r\n              {types.map(({id, label}) =>\r\n                <MenuItem value={id} key={id}>\r\n                  {localizeI18nObj(label, language, languages)}\r\n                </MenuItem>\r\n              )}\r\n            </TextField>\r\n          </FormControl>\r\n        </Grid>\r\n      )}\r\n      <Grid item xs={6}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"firstName\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.firstName\")}\r\n            error={!!errors.firstName}\r\n            helperText={errors.firstName?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={6}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"lastName\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.lastName\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.lastName}\r\n            helperText={errors.lastName?.message}\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"organization\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.organization\")}\r\n            error={!!errors.organization}\r\n            helperText={errors.organization?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      {!config && (\r\n        <Fragment>\r\n          <Grid item xs={6}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"password\"\r\n                label={t(\"scenes.usersSettings.userSettings.fields.password\")}\r\n                error={!!errors.password}\r\n                helperText={errors.password?.message}\r\n                variant=\"outlined\"\r\n                required\r\n                type={showPassword ? undefined : \"password\"}\r\n                inputRef={register({required: t(\"commons.validation.required\")})}\r\n                InputProps={{\r\n                  endAdornment: (\r\n                    <InputAdornment position=\"end\">\r\n                      <IconButton\r\n                        onClick={() => setShowPassword(!showPassword)}\r\n                      >\r\n                        {showPassword ? <Visibility/> : <VisibilityOff/>}\r\n                      </IconButton>\r\n                    </InputAdornment>\r\n                  )\r\n                }}\r\n                inputProps={{\r\n                  autoComplete: \"new-password\"\r\n                }}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={6}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"passwordConfirm\"\r\n                label={t(\"scenes.usersSettings.userSettings.fields.passwordConfirm\")}\r\n                error={!!errors.passwordConfirm}\r\n                helperText={errors.passwordConfirm?.message}\r\n                variant=\"outlined\"\r\n                required\r\n                type={showPasswordConfirm ? undefined : \"password\"}\r\n                inputRef={\r\n                  register({\r\n                    required: t(\"commons.validation.required\"),\r\n                    validate: val =>\r\n                      val === watch('password') ||\r\n                      t(\"scenes.usersSettings.userSettings.validation.passwordsMustBeEqual\")\r\n                  })\r\n                }\r\n                InputProps={{\r\n                  endAdornment: (\r\n                    <InputAdornment position=\"end\">\r\n                      <IconButton\r\n                        onClick={() => setShowPasswordConfirm(!showPasswordConfirm)}\r\n                      >\r\n                        {showPasswordConfirm ? <Visibility/> : <VisibilityOff/>}\r\n                      </IconButton>\r\n                    </InputAdornment>\r\n                  )\r\n                }}\r\n                inputProps={{\r\n                  autoComplete: \"new-password\"\r\n                }}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          {isAnonymous && (\r\n            <Grid item xs={12}>\r\n              <FormControl fullWidth error={!!errors.disclaimerAccepted}>\r\n                <FormControlLabel\r\n                  label={\r\n                    <Fragment>\r\n                      {t(\"scenes.usersSettings.userSettings.fields.disclaimerAccepted.label\")}\r\n                      <span\r\n                        onClick={() => setIsDisclaimerModalOpen(true)}\r\n                        className={classes.disclaimerLink}\r\n                      >\r\n                        {t(\"scenes.usersSettings.userSettings.fields.disclaimerAccepted.link\")}\r\n                      </span>\r\n                    </Fragment>\r\n                  }\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"disclaimerAccepted\"\r\n                      required\r\n                      checked={watch('disclaimerAccepted')}\r\n                      onChange={(e, value) => setValue('disclaimerAccepted', value)}\r\n                    />\r\n                  }\r\n                />\r\n                {errors.disclaimerAccepted?.message && (\r\n                  <FormHelperText id=\"my-helper-text\">\r\n                    {errors.disclaimerAccepted?.message}\r\n                  </FormHelperText>\r\n                )}\r\n              </FormControl>\r\n            </Grid>\r\n          )}\r\n          <Dialog\r\n            open={isDisclaimerModalOpen}\r\n            fullWidth\r\n            maxWidth=\"md\"\r\n            onClose={() => setIsDisclaimerModalOpen(false)}\r\n          >\r\n            <DialogTitle>\r\n              {t(\"scenes.usersSettings.userSettings.disclaimerModal.title\")}\r\n            </DialogTitle>\r\n            <DialogContent>\r\n              <SanitizedHTML html={hub.hub.disclaimer} style={{maxHeight: 460}}/>\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={() => setIsDisclaimerModalOpen(false)}>\r\n                {t(\"commons.confirm.cancel\")}\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n        </Fragment>\r\n      )}\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors,\r\n  hub: state.hub,\r\n  appConfig: state.appConfig,\r\n  languages: state.app.languages,\r\n  language: state.app.language\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchUsersConfigUser(nodeId)),\r\n  sendConfigCreate: (config, isAnonymous) => dispatch(sendUsersConfigUserCreate(config, isAnonymous)),\r\n  sendConfig: config => dispatch(sendUsersConfigUserEdit(config)),\r\n  clearConfig: () => dispatch(clearUsersConfigUser())\r\n});\r\n\r\nconst UserSettingsForm = ({config, userId, fetchConfig, sendConfigCreate, sendConfig, clearConfig, userErrors, isAnonymous, hub, appConfig, languages, language}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(userId >= 0);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(userId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, userId]);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (userId === -1 || config) && (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map((str, index) =>\r\n          <Alert\r\n            severity=\"error\"\r\n            style={{\r\n              marginBottom: index + 1 < userErrors.length ? 8 : 16\r\n            }}\r\n          >\r\n            {getUserErrorsTranslations(t)[str]}\r\n          </Alert>\r\n        ))}\r\n      <Form\r\n        config={userId === -1 ? undefined : config}\r\n        ref={ref}\r\n        onSubmit={\r\n          userId === -1\r\n            ? (config) => sendConfigCreate(config, isAnonymous)\r\n            : sendConfig\r\n        }\r\n        onCancel={clearConfig}\r\n        isAnonymous={isAnonymous}\r\n        hub={hub}\r\n        types={appConfig?.user?.typeOptions}\r\n        languages={languages}\r\n        language={language}\r\n      />\r\n    </Fragment>\r\n\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserSettingsForm);\r\n","import React, {Component, forwardRef, Fragment} from 'react';\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\n\r\nclass ButtonSelect extends Component {\r\n\r\n  state = {\r\n    anchorEl: null\r\n  };\r\n\r\n  setAnchorEl = (el) => {\r\n    this.setState({\r\n      anchorEl: el\r\n    });\r\n  };\r\n\r\n  handleMenu = (event) => {\r\n    this.setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setAnchorEl(null);\r\n  };\r\n\r\n  render() {\r\n\r\n    const {children, icon, value, color, tooltip, disabled, selectedIdx, onChange} = this.props;\r\n    const {anchorEl} = this.state;\r\n\r\n    const open = Boolean(anchorEl);\r\n\r\n    const Item = forwardRef(({c, isSelected}, ref) =>\r\n      <MenuItem\r\n        ref={ref}\r\n        onClick={() => {\r\n          if (c.props?.onClick) {\r\n            c.props.onClick();\r\n          }\r\n          if (onChange) {\r\n            onChange(c.props[\"data-value\"]);\r\n          }\r\n          this.handleClose();\r\n        }}\r\n        style={{background: isSelected ? \"#fff9e5\" : \"white\"}}\r\n      >\r\n        {c}\r\n      </MenuItem>);\r\n\r\n    return (\r\n      <Fragment>\r\n        <Tooltip title={tooltip || \"\"}>\r\n          <span>\r\n            {value\r\n              ? (\r\n                <Button\r\n                  color={color || \"inherit\"}\r\n                  onClick={this.handleMenu}\r\n                  startIcon={icon}\r\n                  endIcon={<ArrowDropDownIcon/>}\r\n                  disabled={disabled}\r\n                >\r\n                  {value}\r\n                </Button>\r\n              )\r\n              : <IconButton color={color || \"inherit\"} onClick={this.handleMenu} disabled={disabled}>{icon}</IconButton>\r\n            }\r\n          </span>\r\n        </Tooltip>\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          anchorOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          keepMounted\r\n          transformOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          open={open}\r\n          onClose={this.handleClose}\r\n        >\r\n          {children.length\r\n            ? children.filter(c => c).map((c, i) => c !== null ? <Item c={c} key={i} isSelected={i === selectedIdx}/> : null)\r\n            : <Item c={children}/>\r\n          }\r\n        </Menu>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ButtonSelect;","import React, {forwardRef, Fragment, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\nimport {changeUserPassword} from \"../../../state/user/userActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch} = useForm();\r\n\r\n  const [showOldPassword, setShowOldPassword] = useState(false);\r\n  const [showNewPassword, setShowNewPassword] = useState(false);\r\n  const [showNewPasswordConfirm, setShowNewPasswordConfirm] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        onSubmit(val);\r\n        f(val);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"oldPassword\"\r\n            label={t(\"components.userSelect.changePasswordModal.fields.oldPassword\")}\r\n            error={!!errors.oldPassword}\r\n            helperText={errors.oldPassword?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showOldPassword ? undefined : \"password\"}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowOldPassword(!showOldPassword)}\r\n                  >\r\n                    {showOldPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"newPassword\"\r\n            label={t(\"components.userSelect.changePasswordModal.fields.newPassword\")}\r\n            error={!!errors.newPassword}\r\n            helperText={errors.newPassword?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showNewPassword ? undefined : \"password\"}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowNewPassword(!showNewPassword)}\r\n                  >\r\n                    {showNewPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n            inputProps={{\r\n              autoComplete: \"new-password\"\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"newPasswordConfirm\"\r\n            label={t(\"components.userSelect.changePasswordModal.fields.newPasswordConfirm\")}\r\n            error={!!errors.newPasswordConfirm}\r\n            helperText={errors.newPasswordConfirm?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showNewPasswordConfirm ? undefined : \"password\"}\r\n            inputRef={\r\n              register({\r\n                required: t(\"commons.validation.required\"),\r\n                validate: val =>\r\n                  val === watch('newPassword') ||\r\n                  t(\"components.userSelect.changePasswordModal.validation.newPasswordMustBeEqual\")\r\n              })}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowNewPasswordConfirm(!showNewPasswordConfirm)}\r\n                  >\r\n                    {showNewPasswordConfirm ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n            inputProps={{\r\n              autoComplete: \"new-password\"\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  sendConfig: config => dispatch(changeUserPassword(config.oldPassword, config.newPassword))\r\n});\r\n\r\nconst UserChangePasswordForm = ({config, sendConfig, userErrors}, ref) => {\r\n\r\n  return (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>))}\r\n      <Form\r\n        ref={ref}\r\n        onSubmit={sendConfig}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserChangePasswordForm);\r\n","import React, {Fragment, useRef, useState} from 'react';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUser,\r\n  fetchUser,\r\n  hideUserLoginForm,\r\n  showUserLoginForm\r\n} from \"../../state/user/userActions\";\r\nimport UserLoginDialog from \"../user-login-dialog\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport UserSettingsForm from \"../settings-select/users-settings-form/user-settings-form\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport ButtonSelect from \"../button-select\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport UserChangePasswordForm from \"./user-change-password-form\";\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onLogin: (email, password) => dispatch(fetchUser(email, password)),\r\n  onLogout: () => dispatch(clearUser()),\r\n  onLoginFormShow: () => dispatch(showUserLoginForm()),\r\n  onLoginFormHide: () => dispatch(hideUserLoginForm()),\r\n});\r\n\r\nconst styles = () => ({\r\n  email: {\r\n    cursor: \"initial\",\r\n    color: \"gray\"\r\n  }\r\n});\r\n\r\nconst UserSelect = ({classes, user, onLogin, onLogout, onLoginFormShow, onLoginFormHide}) => {\r\n\r\n  const [isChangePasswordModalOpen, setIsChangePasswordModalOpen] = useState(false);\r\n  const [isRegisterModalOpen, setIsRegisterModalOpen] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const registerFormRef = useRef();\r\n  const changePasswordFormRef = useRef();\r\n\r\n  return (\r\n    <Fragment>\r\n      {user.isAuthenticated\r\n        ? (\r\n          <Tooltip title={user.email}>\r\n            <ButtonSelect value=\"\" icon={<AccountCircleIcon/>}>\r\n              <div className={classes.email}>\r\n                {user.email}\r\n              </div>\r\n              <div onClick={() => setIsChangePasswordModalOpen(true)}>\r\n                {t(\"components.userSelect.changePassword\")}\r\n              </div>\r\n              <div onClick={onLogout}>\r\n                {t(\"components.userSelect.logout\")}\r\n              </div>\r\n            </ButtonSelect>\r\n          </Tooltip>\r\n        )\r\n        : (\r\n          <Button color=\"inherit\" onClick={onLoginFormShow}>\r\n            {t(\"components.userSelect.login\")}\r\n          </Button>\r\n        )}\r\n      <UserLoginDialog open={user.isLoginDialogOpen}\r\n                       onSubmit={({email, password}) => onLogin(email, password)}\r\n                       onRegister={() => setIsRegisterModalOpen(true)}\r\n                       onHide={onLoginFormHide} alert={user.message}/>\r\n      <SettingsDialog\r\n        title={t(\"components.userSelect.registerModal.title\")}\r\n        maxWidth={\"md\"}\r\n        open={isRegisterModalOpen}\r\n        onClose={() => {\r\n          if (registerFormRef.current) {\r\n            registerFormRef.current.cancel(() => {\r\n              setIsRegisterModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsRegisterModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (registerFormRef.current) {\r\n            registerFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <UserSettingsForm ref={registerFormRef} userId={-1} isAnonymous/>\r\n      </SettingsDialog>\r\n      <SettingsDialog\r\n        title={t(\"components.userSelect.changePasswordModal.title\")}\r\n        maxWidth={\"xs\"}\r\n        open={isChangePasswordModalOpen}\r\n        onClose={() => {\r\n          if (changePasswordFormRef.current) {\r\n            changePasswordFormRef.current.cancel(() => {\r\n              setIsChangePasswordModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsChangePasswordModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (changePasswordFormRef.current) {\r\n            changePasswordFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n        noMinHeight\r\n      >\r\n        <UserChangePasswordForm ref={changePasswordFormRef}/>\r\n      </SettingsDialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(UserSelect);","export const goToDatasets = (nodeCode, categoryPath) =>\r\n  window.open(`./#/${window.language}/${nodeCode.toLowerCase()}/${categoryPath.join(\"/\")}`, '_self');\r\n\r\nexport const goToData = (nodeCode, categoryPath, datasetId, viewId, a11y) =>\r\n  window.open(\r\n    `./#/${window.language}/${nodeCode.toLowerCase()}/${categoryPath.length > 0 ? categoryPath.join(\"/\") + \"/\" : \"\"}` +\r\n    `${datasetId}${(viewId || a11y) ? '?' : ''}${viewId ? `view=${viewId}` : \"\"}${a11y ? \"accessible=true\" : \"\"}`,\r\n    '_self'\r\n  );\r\n\r\n// filters = c1/c2,c3/c4\r\nexport const goToDatasetsSearch = (nodeCode, query, filters) => {\r\n  window.open(\r\n    `./#/${window.language}/${nodeCode.toLowerCase()}/search?q=${encodeURIComponent(query)}` +\r\n    (filters && filters.length > 0 ? `&c=${encodeURIComponent(filters.map(f => encodeURIComponent(f.join(\"/\"))).join(\"//\"))}` : ''),\r\n    '_self'\r\n  );\r\n};\r\n\r\nexport const goToNode = nodeCode => window.open(`./#/${window.language}/${nodeCode}`, '_self');\r\nexport const goToHome = noLanguage => window.open(`./#/${noLanguage ? \"\" : window.language}`, '_self');\r\n\r\nexport const goToHubDashboards = () => window.open(`./#/${window.language}/dashboards`, '_self');\r\nexport const goToNodeDashboards = nodeCode => window.open(`./#/${window.language}/${nodeCode.toLowerCase()}/dashboards`, '_self');\r\nexport const goToDashboard = dashboardId => window.open(`./#/${window.language}/dashboards/${dashboardId}`, '_self');","import React, {Component, Fragment} from 'react';\r\nimport TreeView from '@material-ui/lab/TreeView';\r\nimport TreeItem from '@material-ui/lab/TreeItem';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport InfoOutlinedIcon from '@material-ui/icons/InfoOutlined';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {Link, withStyles} from \"@material-ui/core\";\r\nimport {goToDatasets} from \"../../links\";\r\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\r\nimport ListIcon from '@material-ui/icons/List';\r\nimport FolderIcon from '@material-ui/icons/Folder';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\n\r\nconst styles = () => ({\r\n  nodeIcon: {\r\n    marginTop: 5\r\n  },\r\n  selectedItem: {\r\n    background: \"rgba(0, 41, 90, 0.2) !important\"\r\n  }\r\n});\r\n\r\nclass CategoriesTree extends Component {\r\n\r\n  state = {\r\n    expanded: this.props.selectedCategoryPath || []\r\n  };\r\n\r\n  onExpand = expanded => this.setState({expanded});\r\n\r\n  render() {\r\n\r\n    const {classes, node, catalog, selectedCategoryPath = [], onClose, t} = this.props;\r\n    const {expanded} = this.state;\r\n\r\n    const getTreeItems = (tree, prevPath) =>\r\n      tree.map((cat, i) =>\r\n        <TreeItem\r\n          key={i}\r\n          nodeId={cat.id}\r\n          label={\r\n            <Grid spacing={1} container alignItems=\"center\">\r\n              <Grid item>\r\n                {(expanded.includes(cat.id))\r\n                  ? <FolderOpenIcon className={classes.nodeIcon}/>\r\n                  : <FolderIcon className={classes.nodeIcon}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                {cat.label}\r\n              </Grid>\r\n              {cat.hasAnnotation && (\r\n                <Grid item>\r\n                  <IconButton\r\n                    size=\"small\"\r\n                    onClick={this.onDialogOpen}\r\n                  >\r\n                    <InfoOutlinedIcon/>\r\n                  </IconButton>\r\n                </Grid>\r\n              )}\r\n            </Grid>\r\n          }\r\n          /* TODO: inefficente */\r\n          classes={{\r\n            label: selectedCategoryPath.includes(cat.id) ? classes.selectedItem : null\r\n          }}\r\n        >\r\n          {(\r\n            (cat.datasetIdentifiers && cat.datasetIdentifiers.length > 0) ||\r\n            (cat.childrenCategories && cat.childrenCategories.length > 0)\r\n          ) && (\r\n            <Fragment>\r\n              {(cat.datasetIdentifiers && cat.datasetIdentifiers.length > 0) && (\r\n                <TreeItem\r\n                  nodeId={cat.id + \"-results\"}\r\n                  label={\r\n                    <Link onClick={() => {\r\n                      onClose();\r\n                      goToDatasets(node.code.toLowerCase(), [...prevPath, cat.id]);\r\n                    }}>\r\n                      <Grid spacing={1} container alignItems=\"center\">\r\n                        <Grid item>\r\n                          <ListIcon className={classes.nodeIcon}/>\r\n                        </Grid>\r\n                        <Grid item>\r\n                          <i>{t(\"components.categoriesTree.goToData\", {datasetsCount: cat.datasetIdentifiers.length})}</i>\r\n                        </Grid>\r\n                      </Grid>\r\n                    </Link>\r\n                  }\r\n                />\r\n              )}\r\n              {cat.childrenCategories && cat.childrenCategories.length > 0 &&\r\n              getTreeItems(cat.childrenCategories, [...prevPath, cat.id])}\r\n            </Fragment>\r\n          )}\r\n        </TreeItem>\r\n      );\r\n\r\n    const getCategorySchemeTree = ({id, label, categories}) =>\r\n      <TreeView\r\n        defaultCollapseIcon={<ExpandMoreIcon/>}\r\n        defaultExpandIcon={<ChevronRightIcon/>}\r\n        expanded={expanded}\r\n        onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n        key={id}\r\n      >\r\n        {getTreeItems([{id, label, childrenCategories: categories}], [])}\r\n      </TreeView>;\r\n\r\n    return (\r\n      <Fragment>\r\n        {catalog.categoryGroups.length > 0 && (\r\n          catalog.categoryGroups.length > 1\r\n            ? (\r\n              <Fragment>\r\n                {catalog.categoryGroups.map(getCategorySchemeTree)}\r\n              </Fragment>\r\n            )\r\n            : (\r\n              <TreeView\r\n                defaultCollapseIcon={<ExpandMoreIcon/>}\r\n                defaultExpandIcon={<ChevronRightIcon/>}\r\n                expanded={expanded}\r\n                onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n              >\r\n                {getTreeItems(catalog.categoryGroups[0].categories, [])}\r\n              </TreeView>\r\n            )\r\n        )}\r\n        {catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0 && (\r\n          <TreeView\r\n            defaultCollapseIcon={<ExpandMoreIcon/>}\r\n            defaultExpandIcon={<ChevronRightIcon/>}\r\n            expanded={expanded}\r\n            onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n          >\r\n            <TreeItem\r\n              key={\"uncategorized\"}\r\n              nodeId={\"uncategorized\"}\r\n              label={\r\n                <Grid spacing={1} container alignItems=\"center\">\r\n                  <Grid item>\r\n                    {(expanded.includes(\"uncategorized\")\r\n                        ? <FolderOpenIcon className={classes.nodeIcon}/>\r\n                        : <FolderIcon className={classes.nodeIcon}/>\r\n                    )}\r\n                  </Grid>\r\n                  <Grid item>\r\n                    {t(\"commons.catalog.uncategorized\")}\r\n                  </Grid>\r\n                </Grid>\r\n              }\r\n              /* TODO: inefficente */\r\n              classes={{\r\n                content: selectedCategoryPath.includes(\"uncategorized\") ? classes.selectedItem : null\r\n              }}\r\n            >\r\n              <TreeItem\r\n                nodeId={\"uncategorized-results\"}\r\n                label={\r\n                  <Link onClick={() => {\r\n                    onClose();\r\n                    goToDatasets(node.code.toLowerCase(), [\"uncategorized\"]);\r\n                  }}>\r\n                    <Grid spacing={1} container alignItems=\"center\">\r\n                      <Grid item>\r\n                        <ListIcon className={classes.nodeIcon}/>\r\n                      </Grid>\r\n                      <Grid item>\r\n                        <i>{t(\"components.categoriesTree.goToData\", {datasetsCount: catalog.uncategorizedDatasets.length})}</i>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Link>\r\n                }\r\n              />\r\n            </TreeItem>\r\n          </TreeView>\r\n        )}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(CategoriesTree);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getAddHubDashboardUrl,\r\n    getHubConfigGetUrl,\r\n    getHubConfigPutUrl,\r\n    getHubDashboardsUrl,\r\n    getOrderHubDashboardsUrl,\r\n    getRemoveHubDashboardUrl,\r\n    getUserDashboardsUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const HUB_CONFIG_FETCH = \"hubConfig/fetch\";\r\nexport const HUB_CONFIG_SEND = \"hubConfig/send\";\r\nexport const HUB_CONFIG_CLEAR = \"hubConfig/clear\";\r\nexport const HUB_CONFIG_DASHBOARDS_FETCH = \"hubConfig/dashboards/fetch\";\r\nexport const HUB_CONFIG_DASHBOARDS_FETCH_ALL = \"hubConfig/dashboards/fetchAll\";\r\nexport const HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD = \"hubConfig/dashboards/addDashboard\";\r\nexport const HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE = \"hubConfig/dashboards/removeDashboard\";\r\nexport const HUB_CONFIG_DASHBOARDS_ORDERS_SEND = \"hubConfig/dashboards/sendOrders\";\r\nexport const HUB_CONFIG_DASHBOARDS_CLEAR = \"hubConfig/dashboards/clear\";\r\nexport const HUB_CONFIG_DASHBOARDS_CLEAR_ALL = \"hubConfig/dashboards/clearAll\";\r\nexport const HUB_CONFIG_CLOSE = \"hubConfig/close\";\r\n\r\nexport const fetchHubConfig = () => initRequest(\r\n    HUB_CONFIG_FETCH,\r\n    getHubConfigGetUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchConfig.start\")\r\n    })\r\n);\r\n\r\nexport const sendHubConfig = (config: any) => initRequest(\r\n  HUB_CONFIG_SEND,\r\n  getHubConfigPutUrl(),\r\n    RequestMethod.PUT,\r\n    config,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.sendConfig.start\")\r\n    })\r\n);\r\n\r\nexport const clearHubConfig = () => ({\r\n    type: HUB_CONFIG_CLEAR\r\n});\r\n\r\nexport const fetchHubConfigDashboards = () => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_FETCH,\r\n    getHubDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const fetchAllHubConfigDashboards = () => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_FETCH_ALL,\r\n    getUserDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchAllDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const addHubConfigDashboardsDashboard = (dashboardId: number) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n    getAddHubDashboardUrl(dashboardId),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.addDashboard.start\")\r\n    })\r\n);\r\n\r\nexport const removeHubConfigDashboardsDashboard = (dashboardId: number) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n    getRemoveHubDashboardUrl(dashboardId),\r\n    RequestMethod.DELETE,\r\n    null,\r\n    t => ({\r\n        onStart:t(\"scenes.appSettings.messages.removeDashboard.start\")\r\n    })\r\n);\r\n\r\nexport const sendHubConfigDashboardsOrders = (orderedDashboardsIds: number[]) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n    getOrderHubDashboardsUrl(),\r\n    RequestMethod.POST,\r\n    orderedDashboardsIds,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.sendDashboardsOrders.start\")\r\n    })\r\n)\r\n\r\nexport const clearHubConfigDashboards = () => ({\r\n    type: HUB_CONFIG_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const clearAllHubConfigDashboards = () => ({\r\n    type: HUB_CONFIG_DASHBOARDS_CLEAR_ALL\r\n});\r\n\r\nexport const closeHubConfig = () => ({\r\n    type: HUB_CONFIG_CLOSE\r\n});","export const SPINNER_MESSAGE_ADD = \"spinner/addMessage\";\r\nexport const SPINNER_MESSAGE_REMOVE = \"spinner/removeMessage\";\r\nexport const SPINNER_TIMEOUT_SET = \"spinner/setTimeout\";\r\nexport const SPINNER_TIMEOUT_CLEAR = \"spinner/clearTimeout\";\r\nexport const SPINNER_FLUSH = \"spinner/flush\";\r\n\r\nexport const addSpinnerMessage = (uid: any, message: any) => ({\r\n  type: SPINNER_MESSAGE_ADD,\r\n  payload: {\r\n    uid,\r\n    message\r\n  }\r\n});\r\n\r\nexport const markSpinnerMessage = (uid: any, isError?: boolean) => ({\r\n  type: SPINNER_MESSAGE_REMOVE,\r\n  payload: {\r\n    uid,\r\n    isError\r\n  }\r\n});\r\n\r\nexport const setSpinnerTimeout = (timeout: any) => ({\r\n  type: SPINNER_TIMEOUT_SET,\r\n  payload: {\r\n    timeout\r\n  }\r\n});\r\n\r\nexport const clearSpinnerTimeout = () => ({\r\n  type: SPINNER_TIMEOUT_CLEAR\r\n});\r\n\r\nexport const flushSpinner = () => ({\r\n  type: SPINNER_FLUSH\r\n});\r\n\r\n\r\n","import React, {Fragment, useState} from 'react';\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport CancelIcon from \"@material-ui/icons/Cancel\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport PublishIcon from '@material-ui/icons/Publish';\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport {connect} from \"react-redux\";\r\nimport {getFileUploadUrl} from \"../../serverApi/urls\";\r\nimport {compose} from \"redux\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  startAdornment: {\r\n    marginRight: theme.spacing(2)\r\n  },\r\n  fileInput: {\r\n    display: \"none\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL,\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  addSpinnerMessage: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  markSpinnerMessage: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\nconst FileInput = ({label, value, onChange, classes, baseURL, error, helperText, required, addSpinnerMessage, markSpinnerMessage, user}) => {\r\n\r\n  const [id] = useState(uuidv4());\r\n  const [fileName, setFileName] = useState(value?.substring(value.lastIndexOf('/') + 1) || '');\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Fragment>\r\n      <input\r\n        accept=\"image/*, video/*\"\r\n        className={classes.fileInput}\r\n        id={id}\r\n        type=\"file\"\r\n        onChange={e => {\r\n          const file = e.target.files[0];\r\n\r\n          let fileFormData = new FormData();\r\n          fileFormData.append('files', file);\r\n\r\n          const uuid = uuidv4();\r\n\r\n          addSpinnerMessage(uuid, t(\"components.fileInput.messages.upload.start\"));\r\n\r\n          fetch(baseURL + getFileUploadUrl(), {\r\n            method: 'POST',\r\n            body: fileFormData,\r\n            headers: {\r\n              \"Authorization\": user.token ? `bearer ${user.token}` : undefined\r\n            },\r\n            credentials: 'include'\r\n          })\r\n            .then(res => res.json())\r\n            .then(res => {\r\n              markSpinnerMessage(uuid);\r\n              const filePath = res[0];\r\n              onChange(filePath);\r\n              setFileName(filePath.substring(filePath.lastIndexOf('/') + 1));\r\n            })\r\n            .catch(() => {\r\n              markSpinnerMessage(uuid, true);\r\n              window.error.show(t(\"components.fileInput.messages.upload.error\"));\r\n            });\r\n        }}\r\n      />\r\n      <TextField\r\n        variant=\"outlined\"\r\n        label={label}\r\n        value={fileName}\r\n        InputProps={{\r\n          startAdornment: (\r\n            <InputAdornment className={classes.startAdornment} position=\"start\">\r\n              <label htmlFor={id}>\r\n                <Button startIcon={<PublishIcon/>} variant=\"outlined\" disabled={!!value}\r\n                        title=\"Upload new file\" component=\"span\">\r\n                  {t(\"components.fileInput.upload\")}\r\n                </Button>\r\n              </label>\r\n            </InputAdornment>\r\n          ),\r\n          endAdornment:\r\n            value && (\r\n              <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  title= {t(\"components.fileInput.reset\")}\r\n                  onClick={() => {\r\n                    setFileName('');\r\n                    onChange('');\r\n                  }}\r\n                >\r\n                  <CancelIcon/>\r\n                </IconButton>\r\n              </InputAdornment>\r\n            ),\r\n        }}\r\n        error={error}\r\n        required={required}\r\n        helperText={helperText}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(FileInput);","import React from 'react';\r\nimport MaterialTable from \"material-table\";\r\nimport _ from 'lodash';\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst CustomMaterialTable = props => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  // these props are meant to be used for customizing material table all spread the app\r\n  const customProps = {\r\n    localization: {\r\n      body: {\r\n        emptyDataSourceMessage: t(\"components.customMaterialTable.empty\"),\r\n      },\r\n      header: {\r\n        actions: \"\"\r\n      },\r\n      toolbar: {\r\n        searchPlaceholder: t(\"components.customMaterialTable.search.placeholder\"),\r\n        searchTooltip: t(\"components.customMaterialTable.search.tooltip\")\r\n      }\r\n    }\r\n  };\r\n\r\n  // props passed to this component are merged with and can override the custom props\r\n  const mergedProps = _.merge(customProps, props);\r\n\r\n  return <MaterialTable {...mergedProps}/>;\r\n};\r\n\r\nexport default CustomMaterialTable;\r\n","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {compose} from \"redux\";\r\nimport {Box, Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport ArrowDropUpIcon from \"@material-ui/icons/ArrowDropUp\";\r\nimport ArrowDropDownIcon from \"@material-ui/icons/ArrowDropDown\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../utils/i18n\";\r\nimport {MTableToolbar} from \"material-table\";\r\nimport \"./style.css\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  languages: state.app.languages,\r\n  defaultLanguage: state.app.language\r\n});\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst DashboardsManager = ({\r\n                             classes,\r\n                             defaultLanguage,\r\n                             languages,\r\n                             dashboards,\r\n                             allDashboards,\r\n                             fetchDashboards,\r\n                             fetchAllDashboards,\r\n                             addDashboard,\r\n                             removeDashboard,\r\n                             sendDashboardsOrders,\r\n                             clearDashboards,\r\n                             clearAllDashboards\r\n                           }, ref) => {\r\n\r\n  const [needFetch, setNeedFetch] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    if (needFetch) {\r\n      setNeedFetch(false);\r\n      fetchDashboards();\r\n    }\r\n  }, [dashboards, needFetch, setNeedFetch, fetchDashboards]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    destroy(f) {\r\n      clearDashboards();\r\n      if (f) {\r\n        f();\r\n      }\r\n    }\r\n  }));\r\n\r\n  const orderedDashboardsIds = (dashboards || []).map(({dashboardId}) => dashboardId);\r\n\r\n  const moveUp = rowIndex =>\r\n    sendDashboardsOrders([\r\n      ...orderedDashboardsIds.slice(0, rowIndex - 1),\r\n      orderedDashboardsIds[rowIndex],\r\n      orderedDashboardsIds[rowIndex - 1],\r\n      ...orderedDashboardsIds.slice(rowIndex + 1)\r\n    ]);\r\n\r\n  const moveDown = rowIndex =>\r\n    sendDashboardsOrders([\r\n      ...orderedDashboardsIds.slice(0, rowIndex),\r\n      orderedDashboardsIds[rowIndex + 1],\r\n      orderedDashboardsIds[rowIndex],\r\n      ...orderedDashboardsIds.slice(rowIndex + 2)\r\n    ]);\r\n\r\n  return dashboards !== null && (\r\n    <Fragment>\r\n      <Dialog\r\n        open={allDashboards !== null}\r\n        disableEscapeKeyDown\r\n        disableBackdropClick\r\n        maxWidth=\"md\"\r\n        fullWidth\r\n        onClose={() => {\r\n          clearAllDashboards();\r\n        }}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardsManager.modals.addDashboard.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{minHeight: 456}}>\r\n          {allDashboards !== null && (\r\n            <CustomMaterialTable\r\n              components={{\r\n                Container: Box\r\n              }}\r\n              columns={[\r\n                {\r\n                  field: \"title\",\r\n                  title: t(\"components.dashboardsManager.modals.addDashboard.table.columns.dashboardTitle\"),\r\n                  render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n                  customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n                }\r\n              ]}\r\n              data={allDashboards}\r\n              actions={[\r\n                ({dashboardId}) => {\r\n                  const assigned = !!dashboards.find(dashboard => dashboard.dashboardId === dashboardId)\r\n                  return ({\r\n                    icon: AddIcon,\r\n                    tooltip:\r\n                      assigned\r\n                        ? t(\"components.dashboardsManager.modals.addDashboard.table.actions.addDashboard.tooltip.assigned\")\r\n                        : t(\"components.dashboardsManager.modals.addDashboard.table.actions.addDashboard.tooltip.notAssigned\"),\r\n                    onClick: (_, {dashboardId}) => addDashboard(dashboardId),\r\n                    disabled: assigned\r\n                  });\r\n                }\r\n              ]}\r\n              options={{\r\n                paging: false,\r\n                draggable: true,\r\n                actionsColumnIndex: 2,\r\n                searchFieldAlignment: \"left\",\r\n                maxBodyHeight: 400,\r\n                showTitle: false\r\n              }}\r\n              icons={tableIcons}\r\n            />\r\n          )}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => clearAllDashboards()}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n      <FormControlLabel\r\n        label={t(\"components.dashboardsManager.fields.showHubDashboards.label\")}\r\n        control={\r\n          <Checkbox\r\n            name=\"showHubDashboards\"\r\n            checked\r\n            disabled\r\n          />\r\n        }\r\n      />\r\n      <Box className=\"dashboards-manager__table\">\r\n        <CustomMaterialTable\r\n          title=\"\"\r\n          components={{\r\n            Container: Box,\r\n            Toolbar: props =>\r\n              <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n                <Grid item>\r\n                  <MTableToolbar {...props} />\r\n                </Grid>\r\n                <Grid item>\r\n                  <Button\r\n                    size=\"small\"\r\n                    startIcon={<AddIcon/>}\r\n                    onClick={() => {\r\n                      fetchAllDashboards();\r\n                    }}>\r\n                    {t(\"components.dashboardsManager.addDashboard\")}\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n          }}\r\n          columns={[\r\n            {\r\n              field: \"title\",\r\n              title: t(\"components.dashboardsManager.table.columns.dashboardTitle\"),\r\n              render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n              customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n            }\r\n          ]}\r\n          data={dashboards}\r\n          actions={[\r\n            ({tableData}) => ({\r\n              icon: ArrowDropUpIcon,\r\n              tooltip: t(\"components.dashboardsManager.table.actions.dashboardOrderMoveUp\"),\r\n              onClick: (_, {tableData}) => moveUp(tableData.id), // tableData.id is the rowIndex\r\n              disabled: tableData.id === 0\r\n            }),\r\n            ({tableData}) => ({\r\n              icon: ArrowDropDownIcon,\r\n              tooltip: t(\"components.dashboardsManager.table.actions.dashboardOrderMoveDown\"),\r\n              onClick: (_, {tableData}) => moveDown(tableData.id), // tableData.id is the rowIndex\r\n              disabled: tableData.id === dashboards.length - 1\r\n            }),\r\n            {\r\n              icon: DeleteIcon,\r\n              tooltip: t(\"components.dashboardsManager.table.actions.removeDashboard\"),\r\n              onClick: (_, {dashboardId}) => removeDashboard(dashboardId)\r\n            }\r\n          ]}\r\n          options={{\r\n            paging: false,\r\n            draggable: true,\r\n            actionsColumnIndex: 2,\r\n            searchFieldAlignment: \"left\",\r\n            maxBodyHeight: 320\r\n          }}\r\n          icons={tableIcons}\r\n        />\r\n      </Box>\r\n    </Fragment>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, null, null, {forwardRef: true}),\r\n  forwardRef\r\n)(DashboardsManager);","export const INIT = \"INIT\";\r\n\r\nexport const init = (baseURL: string, supportedLanguages: string[], defaultLanguage: string, appConfig: object) => ({\r\n    type: INIT,\r\n    payload: {\r\n        baseURL,\r\n        supportedLanguages,\r\n        defaultLanguage,\r\n        appConfig\r\n    }\r\n});\r\n","import {INIT} from \"../../state/rootActions\";\r\nimport {REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {HUB_CONFIG_SEND} from \"../../state/hubConfig/hubConfigActions\";\r\n\r\nexport const PERSISTENCE_LOCAL_STORAGE_KEY = \"state\";\r\nexport const PERSISTENCE_ACTION_KEY = \"persistentState\";\r\n\r\nconst persistenceMiddleware = ({getState}) => next => action => {\r\n\r\n  // when init action is dispatched\r\n  if (action.type === INIT) {\r\n    if (!action.payload) {\r\n      action.payload = {};\r\n    }\r\n    // attach persistent state to the action\r\n    action.payload[PERSISTENCE_ACTION_KEY] = JSON.parse(localStorage.getItem(PERSISTENCE_LOCAL_STORAGE_KEY) || \"{}\");\r\n  }\r\n\r\n  const result = next(action);\r\n\r\n  const state = getState();\r\n\r\n  // any time an action is dispatched, update persistent state (localStorage is fast)\r\n  localStorage.setItem(\r\n    PERSISTENCE_LOCAL_STORAGE_KEY,\r\n    JSON.stringify({\r\n      user: {\r\n        ...state.user,\r\n        isSetPasswordDialogOpen: undefined\r\n      },\r\n      app: {\r\n        language:\r\n          action.type === REQUEST_SUCCESS &&\r\n          action.payload.label === HUB_CONFIG_SEND &&\r\n          !action.payload.data.supportedLanguages.includes(state.app.language)\r\n            ? action.payload.data.defaultLanguage\r\n            : state.app.language\r\n      }\r\n    })\r\n  );\r\n\r\n  return result;\r\n};\r\n\r\nexport default persistenceMiddleware;","import {UserPermissions, UserRoles, UserState} from '../state/user/userReducer';\r\n\r\ntype UserChecker = (user: UserState, nodeId?: number) => boolean;\r\ntype UserNodeChecker = (user: UserState, nodeId: number) => boolean;\r\n\r\nconst getPermissionStr = (permission: UserPermissions, nodeId: number) => `${permission}_SingleNode_${nodeId}`;\r\n\r\nexport const canDisplayAppSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canCreateNode: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canSortNodes: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayNodesSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageCache}_SingleNode`)) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageTemplate}_SingleNode`)) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageConfig}_SingleNode`))\r\n    );\r\n\r\nexport const canDisplayUsersSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayCacheSettingForm: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageCache, nodeId))\r\n    );\r\n\r\nexport const canDisplayTemplatesSettingsForm: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n    );\r\n\r\nexport const canSaveTemplate: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n    );\r\n\r\nexport const canEditNode: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n    );\r\n\r\nexport const canDisplayUserViews: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canShare: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canSaveAsView: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canClearServerCache: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canGetQueryLog: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayPermissionsSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canManagePersonalDashboards: UserChecker = user =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageConfig}_SingleNode`))\r\n    );\r\n\r\nexport const canManageAppDashboards: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canManageNodeDashboards: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n  );\r\n\r\nexport const canDeleteNodes: UserChecker = user =>\r\n  user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canViewTimesLog: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n  );\r\n\r\nexport const canViewTemplateOrAnnotationIcon: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n  );","import React, {useEffect, useState} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport {connect} from \"react-redux\";\r\nimport CountryLanguage from 'country-language';\r\n\r\nconst CUSTOM_LANG_TO_COUNTRY = {\r\n  en: \"gb\"\r\n};\r\n\r\nconst I18nInputAdornmentSelect = ({value, onChange, languages}) => {\r\n\r\n  const [langToCountry, setLangToCountry] = useState(null);\r\n\r\n  useEffect(() => {\r\n\r\n    let res = {};\r\n\r\n    languages.forEach(langCode =>\r\n      CountryLanguage.getLanguageCountries(langCode, (err, countries) => {\r\n        if (!err) {\r\n          res[langCode] =\r\n            CUSTOM_LANG_TO_COUNTRY[langCode] ||\r\n            countries.find(({code_2}) => code_2.toLowerCase() === langCode)?.code_2.toLowerCase() ||\r\n            countries[0].code_2.toLowerCase();\r\n        }\r\n      }));\r\n\r\n    setLangToCountry(res);\r\n\r\n  }, [languages]);\r\n\r\n  return langToCountry && (\r\n    <ButtonSelect value={<span className={`flag-icon flag-icon-${langToCountry[value]}`}/>}\r\n                  onChange={onChange}>\r\n      {languages.map(lang =>\r\n        <span key={lang} className={`flag-icon flag-icon-${langToCountry[lang]}`} data-value={lang}/>\r\n      )}\r\n    </ButtonSelect>\r\n  );\r\n};\r\n\r\nexport default connect(state => ({\r\n  languages: state.app.languages\r\n}))(I18nInputAdornmentSelect);","import React, {useState} from 'react';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst Component = ({\r\n                     textFieldProps,\r\n                     defaultLanguage,\r\n                     languages,\r\n                     children\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n\r\n  return (\r\n    <TextField\r\n      {...textFieldProps}\r\n      value={\r\n        textFieldProps.value && textFieldProps.value[language]\r\n          ? textFieldProps.value[language]\r\n          : \"\"\r\n      }\r\n      onChange={({target}) => {\r\n        const res = {};\r\n        languages.forEach(lang => {\r\n          if (textFieldProps.value[lang]) {\r\n            res[lang] = textFieldProps.value[lang];\r\n          }\r\n        });\r\n        res[language] = target.value;\r\n        textFieldProps.onChange(res);\r\n      }}\r\n      InputProps={{\r\n        startAdornment: (\r\n          <InputAdornment position=\"start\">\r\n            <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n          </InputAdornment>\r\n        )\r\n      }}\r\n    >\r\n      {textFieldProps.children}\r\n    </TextField>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nTextField = props =>\r\n  <ConnectedComponent textFieldProps={props}/>;\r\n\r\nexport default I18nTextField;","import React, {Fragment} from 'react';\r\nimport CKEditor from 'ckeditor4-react';\r\nimport './style.css'\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  preToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nclass HtmlEditor extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = HtmlEditor.getInitState(props);\r\n    this.handleEditorChange = this.handleEditorChange.bind(this);\r\n  }\r\n\r\n  static getInitState(props) {\r\n    return {\r\n      value: props ? (props.value || '') : ''\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromProps(props) {\r\n    if (props.value !== null && props.value !== undefined) {\r\n      return {\r\n        value: props.value\r\n      };\r\n\r\n    } else {\r\n      return HtmlEditor.getInitState(props);\r\n    }\r\n  }\r\n\r\n  handleEditorChange(event) {\r\n    const data = event.editor.getData();\r\n    if (this.props.onChange) {\r\n      this.props.onChange(data);\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      value\r\n    } = this.state;\r\n\r\n    const {\r\n      disabled,\r\n    } = this.props;\r\n\r\n    return (\r\n      <Fragment>\r\n        {/* <Grid container className={classes.preToolbar}>\r\n          <Grid item>\r\n            <I18nInputAdornmentSelect/>\r\n          </Grid>\r\n        </Grid>*/}\r\n        <CKEditor\r\n          data={value}\r\n          config={{\r\n            defaultLanguage: 'en',\r\n            language: 'en',\r\n            toolbar: [\r\n              {name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike']},\r\n              {name: 'format', items: ['RemoveFormat']},\r\n              {name: 'colors', items: ['TextColor', 'BGColor']},\r\n              {name: 'insert', items: ['Table']},\r\n              {name: 'links', items: ['Link', 'Unlink']},\r\n              {name: 'paragraph', items: ['NumberedList', 'BulletedList']},\r\n              {name: 'indent', items: ['Outdent', 'Indent']},\r\n              {\r\n                name: 'justify',\r\n                items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']\r\n              },\r\n              {name: 'clipboard', items: ['Cut', 'Copy', 'Paste']},\r\n              {name: 'history', items: ['Undo', 'Redo']}\r\n            ]\r\n          }}\r\n          readOnly={disabled ? disabled : false}\r\n          onChange={this.handleEditorChange}\r\n          onBeforeLoad={(CKEDITOR) => (CKEDITOR.disableAutoInline = true)} // needed to fix \"Error code: editor-element-conflict.\"\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(HtmlEditor);\r\n","import React, {Fragment, useState} from 'react';\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport HtmlEditor from \"../html-editor\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nconst Component = ({\r\n                     htmlEditorProps,\r\n                     defaultLanguage,\r\n                     languages\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid container justify=\"flex-end\" style={{marginBottom: 4}}>\r\n        <Grid item>\r\n          <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n        </Grid>\r\n      </Grid>\r\n      <HtmlEditor\r\n        {...htmlEditorProps}\r\n        value={\r\n          htmlEditorProps.value && htmlEditorProps.value[language]\r\n            ? htmlEditorProps.value[language]\r\n            : \"\"\r\n        }\r\n        onChange={val => {\r\n          const res = {};\r\n          languages.forEach(lang => {\r\n            if (htmlEditorProps.value && htmlEditorProps.value[lang]) {\r\n              res[lang] = htmlEditorProps.value[lang];\r\n            }\r\n          });\r\n          res[language] = val;\r\n          htmlEditorProps.onChange(res);\r\n        }}\r\n\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nHtmlEditor = props =>\r\n  <ConnectedComponent htmlEditorProps={props}/>;\r\n\r\nexport default I18nHtmlEditor;","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {\r\n  addHubConfigDashboardsDashboard,\r\n  clearAllHubConfigDashboards,\r\n  clearHubConfig,\r\n  clearHubConfigDashboards,\r\n  closeHubConfig,\r\n  fetchAllHubConfigDashboards,\r\n  fetchHubConfig,\r\n  fetchHubConfigDashboards,\r\n  removeHubConfigDashboardsDashboard,\r\n  sendHubConfig,\r\n  sendHubConfigDashboardsOrders\r\n} from \"../../../state/hubConfig/hubConfigActions\";\r\nimport {connect} from \"react-redux\";\r\nimport FileInput from \"../../file-input\";\r\nimport DashboardsManager from \"../../dashboards-manager\";\r\nimport {canManageAppDashboards} from \"../../../utils/user\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nTextField from \"../../i18n-text-field\";\r\nimport {validateI18nObj} from \"../../../utils/i18n\";\r\nimport I18nHtmlEditor from \"../../i18n-html-editor\";\r\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  disclaimerLabel: {\r\n    fontSize: \"1rem\",\r\n    marginTop: theme.spacing(3)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.hubConfig.hub,\r\n  user: state.user,\r\n  dashboards: state.hubConfig.hubDashboards,\r\n  allDashboards: state.hubConfig.allDashboards\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  clearConfig: () => dispatch(clearHubConfig()),\r\n  fetchConfig: () => dispatch(fetchHubConfig()),\r\n  sendConfig: config => dispatch(sendHubConfig(config)),\r\n  fetchDashboards: () => dispatch(fetchHubConfigDashboards()),\r\n  fetchAllDashboards: () => dispatch(fetchAllHubConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearHubConfigDashboards()),\r\n  clearAllDashboards: () => dispatch(clearAllHubConfigDashboards()),\r\n  addDashboard: dashboardId => dispatch(addHubConfigDashboardsDashboard(dashboardId)),\r\n  removeDashboard: dashboardId => dispatch(removeHubConfigDashboardsDashboard(dashboardId)),\r\n  sendDashboardsOrders: orderedDashboarIds => dispatch(sendHubConfigDashboardsOrders(orderedDashboarIds)),\r\n  onClose: () => dispatch(closeHubConfig())\r\n});\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({\r\n                                                        classes,\r\n                                                        config,\r\n                                                        onSubmit,\r\n                                                        onCancel,\r\n                                                        user,\r\n                                                        dashboards,\r\n                                                        allDashboards,\r\n                                                        fetchDashboards,\r\n                                                        fetchAllDashboards,\r\n                                                        clearDashboards,\r\n                                                        clearAllDashboards,\r\n                                                        addDashboard,\r\n                                                        removeDashboard,\r\n                                                        sendDashboardsOrders\r\n                                                      }, ref) => {\r\n\r\n  const [tab, setTab] = useState(\"general\");\r\n  const dashboardsManagerRef = React.createRef();\r\n  const {t} = useTranslation();\r\n\r\n  const configExtras = config.extras ? JSON.parse(config.extras) : {};\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      ...config,\r\n      pageSize: configExtras.PageSize\r\n    }\r\n  });\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          pageSize: undefined\r\n        };\r\n\r\n        data.extras = JSON.stringify({\r\n          ...JSON.parse(data.extras || \"{}\"),\r\n          PageSize: val.pageSize\r\n        });\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n        if (dashboardsManagerRef.current) {\r\n          dashboardsManagerRef.current.destroy();\r\n        }\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n      if (dashboardsManagerRef.current) {\r\n        dashboardsManagerRef.current.destroy();\r\n      }\r\n    }\r\n  }));\r\n\r\n  /* custom register */\r\n  useEffect(() => {\r\n    register({\r\n      name: 'title'\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({name: 'slogan'});\r\n    register({\r\n      name: 'supportedLanguages'\r\n    }, {\r\n      validate: val => val.length > 0 || t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: 'defaultLanguage'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: 'maxObservationsAfterCriteria'\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      min: {\r\n        value: 1,\r\n        message: t(\"commons.validation.positiveInteger\")\r\n      }\r\n    })\r\n    register({\r\n      name: \"maxCells\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      min: {\r\n        value: 1,\r\n        message: t(\"commons.validation.positiveInteger\")\r\n      }\r\n    })\r\n    register({name: 'backgroundMediaURL'});\r\n    register({name: 'logoURL'});\r\n    register({name: 'description'});\r\n    register({\r\n      name: 'pageSize'\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: \"disclaimer\"\r\n    });\r\n  }, [register, t]);\r\n\r\n  const defaultLanguage = watch('defaultLanguage');\r\n  const supportedLanguages = watch('supportedLanguages');\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <Tabs\r\n        value={tab}\r\n        onChange={(_, tab) => {\r\n          setTab(tab)\r\n        }}\r\n      >\r\n        <Tab value=\"general\" label={t(\"scenes.appSettings.tabs.general\")}/>\r\n        <Tab value=\"infos\" label={t(\"scenes.appSettings.tabs.information\")}/>\r\n        <Tab value=\"users\" label={t(\"scenes.appSettings.tabs.users\")}/>\r\n        {canManageAppDashboards(user) && (<Tab value=\"dashboards\" label={t(\"scenes.appSettings.tabs.dashboards\")}/>)}\r\n      </Tabs>\r\n      <div className={classes.tabContent}>\r\n        {tab === \"general\" && (\r\n          <Fragment>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"title\"\r\n                label={t(\"scenes.appSettings.fields.title.label\")}\r\n                required\r\n                error={!!errors.title}\r\n                helperText={errors.title?.message}\r\n                variant=\"outlined\"\r\n                value={watch('title') || {}}\r\n                onChange={value => setValue('title', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"slogan\"\r\n                label={t(\"scenes.appSettings.fields.slogan.label\")}\r\n                variant=\"outlined\"\r\n                value={watch('slogan') || {}}\r\n                onChange={value => setValue('slogan', value)}\r\n              />\r\n            </FormControl>\r\n            <Autocomplete\r\n              multiple\r\n              variant=\"outlined\"\r\n              freeSolo\r\n              options={[]}\r\n              value={supportedLanguages || []}\r\n              renderTags={(value, getTagProps) =>\r\n                value.map((option, index) => (\r\n                  <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n                ))\r\n              }\r\n              required\r\n              onChange={(e, val) => {\r\n                setValue('supportedLanguages', val);\r\n                if (defaultLanguage && !val.includes(defaultLanguage)) {\r\n                  setValue('defaultLanguage', \"\");\r\n                }\r\n              }}\r\n              renderInput={params => (\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    label={t(\"scenes.appSettings.fields.supportedLanguages.label\")}\r\n                    {...params}\r\n                    variant=\"outlined\"\r\n                    placeholder={t(\"scenes.appSettings.fields.supportedLanguages.placeholder\")}\r\n                    error={!!errors.supportedLanguages}\r\n                    helperText={\r\n                      errors.supportedLanguages?.message || (\r\n                        <Fragment>\r\n                          {t(\"scenes.appSettings.fields.supportedLanguages.helper.text\")}\r\n                          <a\r\n                            href=\"https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes\"\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            style={{marginLeft: 4}}\r\n                          >\r\n                            {t(\"scenes.appSettings.fields.supportedLanguages.helper.linkText\")}\r\n                          </a>\r\n                        </Fragment>\r\n                      )}\r\n                  />\r\n                </FormControl>\r\n              )}\r\n            />\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"defaultLanguage\"\r\n                select\r\n                required\r\n                label={t(\"scenes.nodeSettings.fields.defaultLanguage.label\")}\r\n                onChange={e => setValue('defaultLanguage', e.target.value)}\r\n                value={watch(\"defaultLanguage\") || ''}\r\n                error={!!errors.defaultLanguage}\r\n                helperText={errors.defaultLanguage?.message || t(\"scenes.nodeSettings.fields.defaultLanguage.helper\")}\r\n                variant=\"outlined\"\r\n              >\r\n                {supportedLanguages.map((val, index) =>\r\n                  <MenuItem key={index} value={val}>{val}</MenuItem>\r\n                )}\r\n              </TextField>\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"maxObservationsAfterCriteria\"\r\n                label={t(\"scenes.appSettings.fields.maxObservationsAfterCriteria.label\")}\r\n                required\r\n                type=\"number\"\r\n                error={!!errors.maxObservationsAfterCriteria}\r\n                helperText={errors.maxObservationsAfterCriteria?.message}\r\n                variant=\"outlined\"\r\n                value={watch('maxObservationsAfterCriteria') || ''}\r\n                onChange={({target}) => setValue('maxObservationsAfterCriteria', target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"maxCells\"\r\n                label={t(\"scenes.appSettings.fields.maxCells.label\")}\r\n                required\r\n                error={!!errors.maxCells}\r\n                helperText={errors.maxCells?.message}\r\n                variant=\"outlined\"\r\n                type=\"number\"\r\n                value={watch('maxCells') || ''}\r\n                onChange={({target}) => setValue('maxCells', target.value)}\r\n              />\r\n            </FormControl>\r\n            {/*<FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"pageSize\"\r\n                label={t(\"scenes.appSettings.fields.pageSize.label\")}\r\n                variant=\"outlined\"\r\n                type=\"number\"\r\n                error={!!errors.pageSize}\r\n                helperText={errors.pageSize?.message}\r\n                value={watch('pageSize') || ''}\r\n                onChange={({target}) => setValue('pageSize', Number(target.value))}\r\n              />\r\n            </FormControl>*/}\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.appSettings.fields.backgroundMediaURL.label\")}\r\n                value={watch('backgroundMediaURL')}\r\n                onChange={value => setValue('backgroundMediaURL', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.appSettings.fields.logoURL.label\")}\r\n                value={watch('logoURL')}\r\n                onChange={value => setValue('logoURL', value)}\r\n              />\r\n            </FormControl>\r\n          </Fragment>\r\n        )}\r\n        {tab === \"infos\" && (\r\n          <I18nHtmlEditor\r\n            value={watch('description')}\r\n            onChange={val => setValue('description', val)}\r\n          />\r\n        )}\r\n        {tab === \"users\" && (\r\n          <Fragment>\r\n            {/* <Autocomplete\r\n              multiple\r\n              variant=\"outlined\"\r\n              freeSolo\r\n              options={[]}\r\n              value={watch('userTypes') || []}\r\n              renderTags={(value, getTagProps) =>\r\n                value.map((option, index) => (\r\n                  <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n                ))\r\n              }\r\n              required\r\n              onChange={(e, val) => setValue('userTypes', val)}\r\n              renderInput={params => (\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    label={t(\"scenes.appSettings.fields.userTypes.label\")}\r\n                    {...params}\r\n                    variant=\"outlined\"\r\n                    placeholder={t(\"scenes.appSettings.fields.userTypes.placeholder\")}\r\n                    error={!!errors.userTypes}\r\n                    helperText={errors.userTypes?.message}\r\n                  />\r\n                </FormControl>\r\n              )}\r\n            />*/}\r\n            <div className={classes.disclaimerLabel}>\r\n              {t(\"scenes.appSettings.fields.disclaimer.label\")}:\r\n            </div>\r\n            <I18nHtmlEditor\r\n              value={watch('disclaimer')}\r\n              onChange={val => setValue('disclaimer', val)}\r\n            />\r\n          </Fragment>\r\n        )}\r\n        {canManageAppDashboards(user) && tab === \"dashboards\" && (\r\n          <DashboardsManager\r\n            dashboards={dashboards}\r\n            allDashboards={allDashboards}\r\n            fetchDashboards={fetchDashboards}\r\n            fetchAllDashboards={fetchAllDashboards}\r\n            clearDashboards={clearDashboards}\r\n            clearAllDashboards={clearAllDashboards}\r\n            addDashboard={addDashboard}\r\n            removeDashboard={removeDashboard}\r\n            sendDashboardsOrders={sendDashboardsOrders}\r\n            ref={dashboardsManagerRef}\r\n          />\r\n        )}\r\n      </div>\r\n    </Box>\r\n  );\r\n});\r\n\r\nconst AppSettingsForm = ({\r\n                           config,\r\n                           fetchConfig,\r\n                           sendConfig,\r\n                           clearConfig,\r\n                           user,\r\n                           dashboards,\r\n                           allDashboards,\r\n                           fetchDashboards,\r\n                           fetchAllDashboards,\r\n                           clearDashboards,\r\n                           clearAllDashboards,\r\n                           addDashboard,\r\n                           removeDashboard,\r\n                           sendDashboardsOrders,\r\n                           onClose\r\n                         }, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  return (config &&\r\n    <Form\r\n      config={config}\r\n      ref={ref}\r\n      onSubmit={sendConfig}\r\n      onCancel={() => {\r\n        clearConfig();\r\n        onClose();\r\n      }}\r\n      user={user}\r\n      dashboards={dashboards}\r\n      allDashboards={allDashboards}\r\n      fetchDashboards={fetchDashboards}\r\n      fetchAllDashboards={fetchAllDashboards}\r\n      clearDashboards={clearDashboards}\r\n      clearAllDashboards={clearAllDashboards}\r\n      addDashboard={addDashboard}\r\n      removeDashboard={removeDashboard}\r\n      sendDashboardsOrders={sendDashboardsOrders}\r\n    />);\r\n\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(AppSettingsForm);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getAddNodeDashboardUrl,\r\n    getNodeConfigGetUrl,\r\n    getNodeDashboardsUrl,\r\n    getNodeDeleteUrl,\r\n    getNodesConfigPostUrl,\r\n    getNodesConfigPutUrl,\r\n    getNodesConfigUrl,\r\n    getNodesOrderPutUrl,\r\n    getOrderNodeDashboardsUrl,\r\n    getRemoveNodeDashboardUrl,\r\n    getUserDashboardsUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const NODES_CONFIG_NODES_FETCH = \"nodesConfig/fetchNodes\";\r\nexport const NODES_CONFIG_NODES_CLEAR = \"nodesConfig/clearNodes\";\r\nexport const NODES_CONFIG_NODE_FETCH = \"nodesConfig/fetchNode\";\r\nexport const NODES_CONFIG_NODE_CLEAR = \"nodesConfig/clearNode\";\r\nexport const NODES_CONFIG_NODES_ORDER_SEND = \"nodesConfig/sendNodesOrder\";\r\nexport const NODES_CONFIG_NODE_DELETE = \"nodesConfig/deleteNode\";\r\nexport const NODES_CONFIG_NODE_CREATE = \"nodesConfig/createNode\";\r\nexport const NODES_CONFIG_NODE_EDIT = \"nodesConfig/editNode\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_FETCH = \"nodesConfig/nodeDashboards/fetch\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL = \"nodesConfig/nodeDashboards/fetchAll\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD = \"nodesConfig/nodeDashboards/addDashboard\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE = \"nodesConfig/nodeDashboards/removeDashboard\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND = \"nodesConfig/nodeDashboards/sendOrders\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_CLEAR = \"nodesConfig/nodeDashboards/clear\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL = \"nodesConfig/nodeDashboards/clearAll\";\r\nexport const NODES_CONFIG_CLOSE = \"nodesConfig/close\";\r\n\r\nexport const fetchNodesConfigNodes = () => initRequest(\r\n    NODES_CONFIG_NODES_FETCH,\r\n    getNodesConfigUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchNodes.start\")\r\n    })\r\n);\r\n\r\nexport const clearNodesConfigNodes = () => ({\r\n  type: NODES_CONFIG_NODES_CLEAR\r\n});\r\n\r\nexport const sendNodesConfigNodesOrder = (orderedIds: number[]) => initRequest(\r\n  NODES_CONFIG_NODES_ORDER_SEND,\r\n  getNodesOrderPutUrl(),\r\n  RequestMethod.PUT,\r\n  orderedIds,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.sendNodesOrder.start\")\r\n  })\r\n);\r\n\r\nexport const deleteNodesConfigNode = (nodeId: number) => initRequest(\r\n  NODES_CONFIG_NODE_DELETE,\r\n  getNodeDeleteUrl(nodeId),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.deleteNode.start\")\r\n  }),\r\n  {\r\n      nodeId,\r\n      onForce: () => initRequest(\r\n          NODES_CONFIG_NODE_DELETE,\r\n          getNodeDeleteUrl(nodeId, true),\r\n          RequestMethod.DELETE,\r\n          undefined,\r\n          t => ({\r\n              onStart: t(\"scenes.nodesSettings.messages.deleteNode.start\")\r\n          }),\r\n          {\r\n              nodeId\r\n          }\r\n      )\r\n  }\r\n);\r\n\r\nexport const fetchNodesConfigNode = (nodeId: number) => initRequest(\r\n  NODES_CONFIG_NODE_FETCH,\r\n  getNodeConfigGetUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.fetchNode.start\")\r\n  })\r\n);\r\n\r\nexport const clearNodesConfigNode = () => ({\r\n  type: NODES_CONFIG_NODE_CLEAR\r\n});\r\n\r\nexport const sendNodesConfigNodeCreate = (node: any) => initRequest(\r\n  NODES_CONFIG_NODE_CREATE,\r\n  getNodesConfigPostUrl(),\r\n  RequestMethod.POST,\r\n  node,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.sendNodeCreate.start\")\r\n  })\r\n);\r\n\r\nexport const sendNodesConfigNodeEdit = (node: any) => initRequest(\r\n    NODES_CONFIG_NODE_EDIT,\r\n    getNodesConfigPutUrl(node.nodeId),\r\n    RequestMethod.PUT,\r\n    node,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.sendNodeEdit.start\")\r\n    }),\r\n    {\r\n        nodeId: node.nodeId\r\n    }\r\n);\r\n\r\nexport const fetchNodesConfigNodeDashboards = (nodeId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_FETCH,\r\n    getNodeDashboardsUrl(nodeId),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchNodeDashboards.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const fetchAllNodeConfigDashboards = () => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL,\r\n    getUserDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchAllDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const addNodesConfigDashboardsNodeDashboard = (nodeId: number, dashboardId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n    getAddNodeDashboardUrl(nodeId, dashboardId),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.addNodeDashboard.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const removeNodesConfigDashboardsNodeDashboard = (nodeId: number, dashboardId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n    getRemoveNodeDashboardUrl(nodeId, dashboardId),\r\n    RequestMethod.DELETE,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.removeNodeDashboard.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const sendNodesConfigDashboardsNodeOrders = (nodeId: number, orderedDashboardsIds: number[]) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n    getOrderNodeDashboardsUrl(nodeId),\r\n    RequestMethod.POST,\r\n    orderedDashboardsIds,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.sendNodeDashboardsOrders.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n)\r\n\r\nexport const clearNodesConfigNodeDashboards = () => ({\r\n    type: NODES_CONFIG_NODE_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const clearAllNodesConfigNodeDashboards = () => ({\r\n    type: NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL\r\n});\r\n\r\nexport const closeNodesConfig = () => ({\r\n    type: NODES_CONFIG_CLOSE\r\n});","import _ from \"lodash\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"../components/label-format-selector/constants\";\r\n\r\nexport const TIME_PERIOD_DIMENSION_KEY = \"TIME_PERIOD\";\r\nexport const FREQ_DIMENSION_KEY = \"FREQ\";\r\n\r\nconst MAX_COL_COUNT = 10000;\r\nconst MAX_ROW_COUNT = 10000;\r\n\r\nconst toUpperCaseFirst = string => (string !== null && string.length > 0)\r\n  ? string[0].toUpperCase() + string.slice(1)\r\n  : string;\r\n\r\nexport const getDimensionLabelFromJsonStat = (jsonStat, dimension, format) => {\r\n  const name = toUpperCaseFirst(jsonStat.dimension[dimension].label);\r\n  const id = dimension;\r\n\r\n  return (name || id);\r\n};\r\n\r\nexport const getDimensionValueLabelFromJsonStat = (jsonStat, dimension, value, format) => {\r\n  const name = toUpperCaseFirst(jsonStat.dimension[dimension].category.label[value]);\r\n  const id = value;\r\n\r\n  if (dimension === TIME_PERIOD_DIMENSION_KEY) {\r\n    return name;\r\n  }\r\n\r\n  switch (format) {\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME:\r\n      return name;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID:\r\n      return id;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH:\r\n      return `[${id}] ${name}`;\r\n    default:\r\n      return name;\r\n  }\r\n};\r\n\r\nexport const getDataIdxFromCoordinatesArray = (dimensions, size) => {\r\n  let dataIdx = 0;\r\n  let multiplier = 1;\r\n\r\n  // row-major order algorithm\r\n  for (let i = 0; i < dimensions.length; i++) {\r\n    multiplier *= (i > 0) ? size[dimensions.length - i] : 1;\r\n    dataIdx += multiplier * dimensions[dimensions.length - i - 1];\r\n  }\r\n\r\n  return dataIdx;\r\n};\r\n\r\nexport const getCoordinatesArrayFromDataIdx = (dataIdx, size) => {\r\n  const coordinates = new Array(size.length);\r\n\r\n  // reverse row-major order algorithm\r\n  let offset = dataIdx;\r\n  for (let i = size.length - 1; i >= 0; i--) {\r\n    const dimensionSize = size[i];\r\n    coordinates[i] = dimensionSize > 0 ? (offset % dimensionSize) : 0;\r\n    offset = dimensionSize > 0 ? Math.floor(offset / dimensionSize) : 0;\r\n  }\r\n\r\n  return coordinates;\r\n};\r\n\r\nexport const getJsonStatTableSize = (jsonStat, layout) => {\r\n  if (jsonStat) {\r\n    let count = 1;\r\n\r\n    if (!layout) {\r\n      jsonStat.size.forEach(el => count *= el);\r\n\r\n    } else {\r\n      let colCount = 1;\r\n      layout.cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n      let rowCount = 1;\r\n      layout.rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n      layout.sections.forEach(section => rowCount *= jsonStat.size[jsonStat.id.indexOf(section)]);\r\n      count = colCount * rowCount;\r\n    }\r\n\r\n    return count;\r\n\r\n  } else {\r\n    return 0\r\n  }\r\n};\r\n\r\nexport const getFilterTreeFromJsonStat = (layout, jsonStat) => {\r\n  const filters = (layout?.primaryDim || []).concat((layout?.secondaryDim || [])).concat(layout?.filters || []);\r\n\r\n  let paths = [];\r\n  Object.keys(jsonStat.value).forEach(key => {\r\n    const coordinates = getCoordinatesArrayFromDataIdx(key, jsonStat.size);\r\n    const path = [];\r\n    filters.forEach(dim => {\r\n      const dimValueIdx = coordinates[jsonStat.id.indexOf(dim)];\r\n      path.push(jsonStat.dimension[dim].category.index[dimValueIdx]);\r\n    });\r\n    paths.push(path);\r\n  });\r\n\r\n  const tree = {};\r\n  paths.forEach(path => {\r\n    let currentLevel = tree;\r\n    path.forEach(elem => {\r\n      if (!currentLevel[elem]) {\r\n        currentLevel[elem] = {};\r\n      }\r\n      currentLevel = currentLevel[elem];\r\n    });\r\n  });\r\n\r\n  return tree\r\n};\r\n\r\nexport const getInitialFiltersValue = (jsonStat, layout, filterTree) => {\r\n  const primaryDim = layout.primaryDim?.[0] || null;\r\n  const secondaryDim = layout.secondaryDim?.[0] || null;\r\n  const filters = layout.filters || [];\r\n\r\n  let selectedPrimaryDim = null;\r\n  let selectedSecondaryDim = null;\r\n\r\n  if (filters.length === 0) {\r\n    return {}\r\n  }\r\n\r\n  let root = filterTree;\r\n  if (primaryDim) {\r\n    selectedPrimaryDim = Object.keys(root).find(primDimKey =>\r\n      layout.primaryDimValues.includes(primDimKey) && (!secondaryDim || Object.keys(root[primDimKey]).find(secDimKey =>\r\n        layout.secondaryDimValues.includes(secDimKey))));\r\n    root = root[selectedPrimaryDim];\r\n    if (secondaryDim) {\r\n      selectedSecondaryDim = Object.keys(root).find(secDimKey =>\r\n        layout.secondaryDimValues.includes(secDimKey));\r\n      root = root[selectedSecondaryDim];\r\n    }\r\n  }\r\n\r\n  const filtersValue = {};\r\n\r\n  let iter = root;\r\n  layout.filters.forEach(dim => {\r\n    const selectableValues = Object.keys(iter);\r\n    const allValues = jsonStat.dimension[dim].category.index;\r\n    if (dim === TIME_PERIOD_DIMENSION_KEY) {\r\n      allValues.reverse();\r\n    }\r\n    const selectedVal = allValues.find(dimVal => selectableValues.includes(dimVal));\r\n    filtersValue[dim] = selectedVal;\r\n    iter = iter[selectedVal];\r\n  });\r\n\r\n  return filtersValue;\r\n}\r\n\r\nexport const getInitialTableLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null;\r\n  }\r\n\r\n  let dimensions = [...jsonStat.id];\r\n\r\n  let rows = dimensions.filter(dim => dim === TIME_PERIOD_DIMENSION_KEY);\r\n  dimensions = dimensions.filter(dim => !rows.includes(dim));\r\n\r\n  let territoryDim = (jsonStat.role?.geo || []).length > 0 ? jsonStat.role.geo[0] : null;\r\n\r\n  let cols = territoryDim ? [territoryDim] : [];\r\n  dimensions = dimensions.filter(dim => !cols.includes(dim));\r\n\r\n  let filters = dimensions.filter(dim => jsonStat.size[jsonStat.id.indexOf(dim)] === 1);\r\n  dimensions = dimensions.filter(dim => !filters.includes(dim));\r\n\r\n  if (dimensions.includes(FREQ_DIMENSION_KEY)) {\r\n    rows = [FREQ_DIMENSION_KEY, ...rows];\r\n    dimensions = dimensions.filter(dim => !rows.includes(dim));\r\n  }\r\n\r\n  if (rows.length === 1 && jsonStat.size[jsonStat.id.indexOf(rows[0])] === 1 && cols.length === 1) {\r\n    filters = filters.concat(rows);\r\n    rows = [...cols];\r\n    cols = [];\r\n  }\r\n\r\n  let colCount = 1;\r\n  cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  let rowCount = 1;\r\n  rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n\r\n  dimensions.forEach(dim => {\r\n    const newColCount = colCount * jsonStat.size[jsonStat.id.indexOf(dim)];\r\n\r\n    if (newColCount > MAX_COL_COUNT) {\r\n      const newRowCount = rowCount * jsonStat.size[jsonStat.id.indexOf(dim)];\r\n\r\n      if (newRowCount > MAX_ROW_COUNT) {\r\n        filters.push(dim);\r\n\r\n      } else {\r\n        rows = [dim].concat(rows);\r\n        rowCount = newRowCount;\r\n      }\r\n\r\n    } else {\r\n      cols.push(dim);\r\n      colCount = newColCount;\r\n    }\r\n  });\r\n\r\n  return {\r\n    rows: rows,\r\n    cols: cols,\r\n    sections: [],\r\n    filters: filters\r\n  }\r\n};\r\n\r\nexport const getInitialChartLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null\r\n  }\r\n\r\n  let primaryDim = jsonStat.id.find(dim => dim === TIME_PERIOD_DIMENSION_KEY);\r\n  if (!primaryDim) {\r\n    primaryDim = jsonStat.id[0];\r\n  }\r\n  const filters = jsonStat.id.filter(dim => dim !== primaryDim);\r\n\r\n  return {\r\n    primaryDim: [primaryDim],\r\n    primaryDimValues: jsonStat.dimension[primaryDim].category.index,\r\n    secondaryDim: [],\r\n    secondaryDimValues: [],\r\n    filters: filters\r\n  }\r\n};\r\n\r\nexport const getInitialMapLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null\r\n  }\r\n\r\n  let territoryDim = (jsonStat.role?.geo || []).length > 0 ? jsonStat.role.geo[0] : null;\r\n\r\n  if (!territoryDim) {\r\n    return null\r\n  }\r\n\r\n  return {\r\n    territoryDim: territoryDim,\r\n    filters: jsonStat.id.filter(dim => dim !== territoryDim)\r\n  }\r\n};\r\n\r\nconst getFilteredLayout = (initialLayout, jsonStat) => {\r\n  if (!initialLayout) {\r\n    return null\r\n  }\r\n\r\n  const layout = _.cloneDeep(initialLayout);\r\n  const dimArraysKey = [\"rows\", \"cols\", \"filters\", \"sections\", \"primaryDim\", \"secondaryDim\", \"territoryDim\"];\r\n\r\n  if (layout.territoryDim) {\r\n    layout.territoryDim = [layout.territoryDim];\r\n  }\r\n\r\n  const primaryDim = layout?.primaryDim?.[0] || null;\r\n  const secondaryDim = layout?.secondaryDim?.[0] || null;\r\n\r\n  // removing dimensions from layout not present in jsonStat\r\n  for (let key in layout) {\r\n    if (layout.hasOwnProperty(key)) {\r\n      if (dimArraysKey.includes(key)) {\r\n        layout[key] = (layout[key] || []).filter(dim => jsonStat.id.includes(dim));\r\n      }\r\n    }\r\n  }\r\n\r\n  // adding missing dimensions to layout\r\n  jsonStat.id.forEach(dim => {\r\n    let found = false;\r\n    for (let key in layout) {\r\n      if (layout.hasOwnProperty(key)) {\r\n        if (!found && dimArraysKey.includes(key)) {\r\n          found = layout[key].includes(dim);\r\n        }\r\n      }\r\n    }\r\n    if (!found) {\r\n      layout.filters.push(dim);\r\n      if (layout.filtersValue) {\r\n        layout.filtersValue[dim] = jsonStat.dimension[dim].category.index[0];\r\n      }\r\n    }\r\n  });\r\n\r\n  // checking selected filtersValue\r\n  if (layout.filtersValue) {\r\n    for (let dim in layout.filtersValue) {\r\n      if (layout.filtersValue.hasOwnProperty(dim)) {\r\n        if (!layout.filters.includes(dim)) {\r\n          layout.filtersValue[dim] = undefined;\r\n        } else if (!jsonStat.dimension[dim].category.index.includes(layout.filtersValue[dim])) {\r\n          layout.filtersValue[dim] = jsonStat.dimension[dim].category.index[0];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // checking selected primaryDimValues\r\n  if (primaryDim) {\r\n    if (layout.primaryDimValues.length === 0) {\r\n      layout.primaryDimValues = jsonStat.dimension[primaryDim].category.index;\r\n    }\r\n    layout.primaryDimValues = layout.primaryDimValues.filter(value =>\r\n      jsonStat.dimension[primaryDim].category.index.includes(value));\r\n  }\r\n\r\n  // checking selected secondaryDimValues\r\n  if (secondaryDim) {\r\n    if (layout.secondaryDimValues.length === 0) {\r\n      layout.secondaryDimValues = jsonStat.dimension[secondaryDim].category.index;\r\n    }\r\n    layout.secondaryDimValues = layout.secondaryDimValues.filter(value =>\r\n      jsonStat.dimension[secondaryDim].category.index.includes(value));\r\n  }\r\n\r\n  if (layout.territoryDim) {\r\n    layout.territoryDim = layout.territoryDim[0];\r\n  }\r\n\r\n  return layout\r\n};\r\n\r\nexport const getFilteredTableLayout = (initialLayout, jsonStat) => {\r\n  if (!initialLayout) {\r\n    return null\r\n  }\r\n  const layout = {\r\n    rows: [],\r\n    cols: [],\r\n    sections: [],\r\n    filters: [],\r\n    ...initialLayout,\r\n  };\r\n\r\n  return getFilteredLayout(layout, jsonStat);\r\n};\r\n\r\nexport const getFilteredMapLayout = (initialLayout, jsonStat) => {\r\n  if (!initialLayout) {\r\n    return null\r\n  }\r\n  const layout = {\r\n    territoryDim: \"\",\r\n    filters: [],\r\n    ...initialLayout,\r\n  };\r\n\r\n  return getFilteredLayout(layout, jsonStat);\r\n};\r\n\r\nexport const getFilteredChartLayout = (initialLayout, jsonStat) => {\r\n  if (!initialLayout) {\r\n    return null\r\n  }\r\n  const layout = {\r\n    primaryDim: [],\r\n    primaryDimValues: [],\r\n    secondaryDim: [],\r\n    secondaryDimValues: [],\r\n    filters: [],\r\n    ...initialLayout,\r\n  };\r\n\r\n  return getFilteredLayout(layout, jsonStat);\r\n};\r\n\r\nexport const getUpdatedLayout = (dimension, value, jsonStat, layout, filterTree) => {\r\n  let newLayout = _.cloneDeep(layout);\r\n  const primaryDim = newLayout.primaryDim?.[0] || null;\r\n  const secondaryDim = newLayout.secondaryDim?.[0] || null;\r\n\r\n  if (primaryDim && dimension === primaryDim) {\r\n    newLayout.primaryDimValues = value;\r\n    if (secondaryDim) {\r\n      const allSecondaryDimValues = getDimensionFilterValues(secondaryDim, jsonStat, newLayout, filterTree);\r\n      newLayout.secondaryDimValues = newLayout.secondaryDimValues.filter(val => allSecondaryDimValues.includes(val));\r\n    }\r\n    newLayout.filtersValue = getInitialFiltersValue(jsonStat, newLayout, filterTree);\r\n\r\n  } else if (secondaryDim && dimension === secondaryDim) {\r\n    newLayout.secondaryDimValues = value;\r\n    newLayout.filtersValue = getInitialFiltersValue(jsonStat, newLayout, filterTree);\r\n\r\n  } else {\r\n    newLayout.filtersValue[dimension] = value;\r\n\r\n    const filters = newLayout.filters || [];\r\n    const selectedIdx = filters.indexOf(dimension);\r\n    if (selectedIdx < (filters.length - 1)) {\r\n      newLayout.filters.slice(selectedIdx + 1).forEach(dim => {\r\n        const selectableValues = getDimensionFilterValues(dim, jsonStat, newLayout, filterTree);\r\n        const allValues = jsonStat.dimension[dim].category.index;\r\n        if (dim === TIME_PERIOD_DIMENSION_KEY) {\r\n          allValues.reverse();\r\n        }\r\n        newLayout.filtersValue[dim] = allValues.find(dimVal => selectableValues.includes(dimVal));\r\n      });\r\n    }\r\n  }\r\n\r\n  return newLayout\r\n};\r\n\r\nexport const getDimensionFilterValues = (dimension, jsonStat, layout, filterTree, withLabels = false) => {\r\n  const primaryDim = layout.primaryDim?.[0] || null;\r\n  const secondaryDim = layout.secondaryDim?.[0] || null;\r\n  const filters = (layout?.primaryDim || []).concat((layout?.secondaryDim || [])).concat(layout?.filters || []);\r\n  const dimensionIdx = filters.indexOf(dimension);\r\n  const prevFilters = filters.slice(0, dimensionIdx);\r\n\r\n  let data = {};\r\n  if (dimensionIdx > 0) {\r\n    let iter = filterTree;\r\n    if (primaryDim) {\r\n      (layout.primaryDimValues || []).forEach(primDimVal => {\r\n        if (secondaryDim && dimension !== secondaryDim) {\r\n          (layout.secondaryDimValues || []).forEach(secDimVal => {\r\n            iter = filterTree[primDimVal][secDimVal];\r\n            prevFilters.slice(2).forEach(val => {\r\n              iter = (iter || {})[layout.filtersValue[val]];\r\n            });\r\n            data = {...data, ...iter};\r\n          });\r\n        } else {\r\n          iter = filterTree[primDimVal];\r\n          prevFilters.slice(1).forEach(val => {\r\n            iter = (iter || {})[layout.filtersValue[val]];\r\n          });\r\n          data = {...data, ...iter};\r\n        }\r\n      });\r\n    } else {\r\n      prevFilters.forEach(val => {\r\n        iter = iter[layout.filtersValue[val]];\r\n      });\r\n      data = {...data, ...iter};\r\n    }\r\n  } else {\r\n    data = filterTree;\r\n  }\r\n\r\n  const availableValue = Object.keys(data);\r\n  const ret = [];\r\n  jsonStat.dimension[dimension].category.index.forEach(val => {\r\n    if (availableValue.includes(val)) {\r\n      ret.push(withLabels\r\n        ? {\r\n          id: val,\r\n          label: jsonStat.dimension[dimension].category.label[val]\r\n        }\r\n        : val\r\n      );\r\n    }\r\n  });\r\n\r\n  return ret;\r\n}\r\n\r\nexport const getDimensionValuesIndexesMap = jsonStat => {\r\n  const indexesMap = {};\r\n\r\n  jsonStat.id.forEach(dim => {\r\n    indexesMap[dim] = {};\r\n    jsonStat.dimension[dim].category.index.forEach((dimValue, idx) => indexesMap[dim][dimValue] = idx);\r\n  });\r\n\r\n  return indexesMap;\r\n};\r\n\r\nexport const getAttributeObjects = (attributeList, attributeObj, hiddenAttributes) => {\r\n  const attributes = [];\r\n  const ids = [];\r\n  let hasAsterisk = false;\r\n\r\n  try {\r\n    (attributeList || []).forEach((attr, idx) => {\r\n      if (attr !== null && !(hiddenAttributes || []).includes(attributeObj[idx].id)) {\r\n        const valueId = attributeObj[idx].values[attr].id;\r\n        const valueLabel = attributeObj[idx].values[attr].name;\r\n\r\n        attributes.push({\r\n          id: attributeObj[idx].id,\r\n          label: attributeObj[idx].name,\r\n          valueId: valueId,\r\n          valueLabel: valueLabel\r\n        });\r\n\r\n        if (valueId !== valueLabel && valueId.length <= 5) {\r\n          ids.push(valueId);\r\n        } else {\r\n          hasAsterisk = true;\r\n        }\r\n      }\r\n    });\r\n\r\n    if (hasAsterisk) {\r\n      ids.push(\"(*)\");\r\n    }\r\n\r\n    return (attributes.length > 0 && ids.length > 0)\r\n      ? {\r\n        attributes,\r\n        ids\r\n      }\r\n      : null\r\n\r\n  } catch (error) {\r\n    return -1\r\n  }\r\n};\r\n\r\nexport const getDimensionAttributeMap = (jsonStat, hiddenAttributes, getIdsHtmlString) => {\r\n  if (!jsonStat) {\r\n    return null;\r\n  }\r\n\r\n  const series = (jsonStat?.extension?.attributes?.series || []);\r\n  const seriesIndexes = (jsonStat?.extension?.attributes?.index?.series || []);\r\n  const dimensionAttributesMap = {};\r\n\r\n  jsonStat.id.forEach(dim => dimensionAttributesMap[dim] = {});\r\n  if (series && series.length > 0 && seriesIndexes && seriesIndexes.length > 0) {\r\n    seriesIndexes\r\n      .filter(({coordinates}) => (coordinates || []).filter(c => c !== null).length === 1)\r\n      .forEach(index => {\r\n        const dimIdx = index.coordinates.findIndex(el => el !== null);\r\n        const dim = jsonStat.id[dimIdx];\r\n        const dimValueIdx = index.coordinates.find(el => el !== null);\r\n        const dimValue = jsonStat.dimension[dim].category.index[dimValueIdx];\r\n\r\n        const attributeObjects = getAttributeObjects(index.attributes, series, hiddenAttributes);\r\n        if (attributeObjects !== null && attributeObjects !== -1) {\r\n          dimensionAttributesMap[dim][dimValue] = {\r\n            attributes: attributeObjects.attributes,\r\n            ids: attributeObjects.ids,\r\n            htmlString: getIdsHtmlString\r\n              ? getIdsHtmlString(attributeObjects.ids, dim, dimValue)\r\n              : null\r\n          };\r\n        }\r\n      });\r\n  }\r\n\r\n  return dimensionAttributesMap;\r\n};","export const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME = \"LABEL_FORMAT_SELECTOR_FORMAT_NAME\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID = \"LABEL_FORMAT_SELECTOR_FORMAT_ID\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH = \"LABEL_FORMAT_SELECTOR_FORMAT_BOTH\";","import moment from \"moment\";\r\nimport {FREQ_DIMENSION_KEY, TIME_PERIOD_DIMENSION_KEY} from \"./jsonStat\";\r\n\r\nexport const CRITERIA_FILTER_TYPE_CODES = \"CodeValues\";\r\nexport const CRITERIA_FILTER_TYPE_STRING = \"StringValues\";\r\nexport const CRITERIA_FILTER_TYPE_RANGE = \"TimeRange\";\r\nexport const CRITERIA_FILTER_TYPE_PERIODS = \"TimePeriod\";\r\n\r\nexport const FREQ_ANNUAL = \"A\";\r\nexport const FREQ_SEMESTER = \"S\";\r\nexport const FREQ_QUARTERLY = \"Q\";\r\nexport const FREQ_MONTHLY = \"M\";\r\nconst frequencies = [FREQ_MONTHLY, FREQ_QUARTERLY, FREQ_SEMESTER, FREQ_ANNUAL];\r\n\r\nexport const getDimensionCriteria = (criteria, dimensionId) => (criteria || []).find(({id}) => id === dimensionId) || null;\r\n\r\nconst getMinAndMax = timePeriodCodelist => {\r\n  let min = moment().add(-20, 'y').format(\"YYYY\") + \"-01-01\";\r\n  let max = moment().add(10, 'y').format(\"YYYY\") + \"-12-31\";\r\n\r\n  return {\r\n    min: timePeriodCodelist.values && timePeriodCodelist.values[0] && timePeriodCodelist.values[0].id\r\n      ? moment(timePeriodCodelist.values[0].id).format(\"YYYY-MM-DD\")\r\n      : min,\r\n    max: timePeriodCodelist.values && timePeriodCodelist.values[1] && timePeriodCodelist.values[1].id\r\n      ? moment(timePeriodCodelist.values[1].id).format(\"YYYY-MM-DD\")\r\n      : max,\r\n    missingRange: (!timePeriodCodelist.values || timePeriodCodelist.values.length !== 2)\r\n  }\r\n};\r\n\r\nexport const getTimePeriod = (initialTimePeriod, criteria, timePeriodCodelist, freqCodelist) => {\r\n\r\n  const minAndMax = timePeriodCodelist\r\n    ? getMinAndMax(timePeriodCodelist)\r\n    : {\r\n      min: initialTimePeriod.minDate,\r\n      max: initialTimePeriod.maxDate,\r\n      missingRange: initialTimePeriod.missingRange,\r\n    };\r\n\r\n  let freq = initialTimePeriod.freq;\r\n  if (freqCodelist !== null) {\r\n    freq = (frequencies.find(freq => (freqCodelist.values || []).map(({id}) => id).includes(freq)) || null);\r\n  }\r\n\r\n  return {\r\n    freq: freq,\r\n    selectorType: (criteria?.[TIME_PERIOD_DIMENSION_KEY]?.type || CRITERIA_FILTER_TYPE_RANGE),\r\n    minDate: minAndMax.min,\r\n    maxDate: minAndMax.max,\r\n    fromDate: (criteria?.[TIME_PERIOD_DIMENSION_KEY]?.from || minAndMax.min),\r\n    toDate: (criteria?.[TIME_PERIOD_DIMENSION_KEY]?.to || minAndMax.max),\r\n    periods: (criteria?.[TIME_PERIOD_DIMENSION_KEY]?.period || null),\r\n    missingRange: minAndMax.missingRange\r\n  }\r\n};\r\n\r\nexport const getFreq = criteria => {\r\n  const freqValues = (criteria && criteria[FREQ_DIMENSION_KEY])\r\n    ? (criteria[FREQ_DIMENSION_KEY].filterValues || [])\r\n    : [];\r\n  return (frequencies.find(freq => freqValues.includes(freq)) || null)\r\n};\r\n\r\nexport const getCriteriaArrayFromObject = criteriaObj => {\r\n  const criteriaArr = [];\r\n  Object.keys(criteriaObj).forEach(key => {\r\n    if (criteriaObj[key] !== null && criteriaObj[key] !== undefined) {\r\n      criteriaArr.push(criteriaObj[key])\r\n    }\r\n  });\r\n\r\n  return criteriaArr;\r\n};\r\n\r\nexport const getCriteriaObjectFromArray = criteriaArr => {\r\n  let criteriaObj = {};\r\n  (criteriaArr || []).forEach((dimensionCriteria) => {\r\n    criteriaObj = {\r\n      ...criteriaObj,\r\n      [dimensionCriteria.id]: dimensionCriteria\r\n    }\r\n  });\r\n\r\n  return criteriaObj;\r\n};","import React from \"react\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport withTheme from \"@material-ui/core/styles/withTheme\";\r\n\r\nconst InfoTooltip = ({children, theme}) => {\r\n\r\n  return children\r\n    ? (\r\n      <Tooltip title={children} placement=\"top\">\r\n        <IconButton\r\n          aria-label=\"info\"\r\n          style={{\r\n            color: theme.palette.primary.main,\r\n            padding: 0,\r\n            transform: \"translateY(-1px)\"\r\n          }}\r\n        >\r\n          <InfoIcon fontSize=\"small\"/>\r\n        </IconButton>\r\n      </Tooltip>\r\n    )\r\n    : (\r\n      <IconButton\r\n        aria-label=\"info\"\r\n        style={{\r\n          color: theme.palette.primary.main,\r\n          padding: 0,\r\n          transform: \"translateY(-1px)\"\r\n        }}\r\n      >\r\n        <InfoIcon fontSize=\"small\"/>\r\n      </IconButton>\r\n    );\r\n};\r\n\r\nexport default withTheme(InfoTooltip);","import React, {Fragment} from 'react';\r\nimport InfoTooltip from \"../info-tooltip\";\r\n\r\nconst FormLabelWithTooltip = ({children, tooltip, tooltipOnRight}) => {\r\n\r\n  const Tooltip = () =>\r\n    <span\r\n      style={{\r\n        pointerEvents: \"auto\",\r\n        marginLeft: tooltipOnRight ? 10 : null,\r\n        marginRight: !tooltipOnRight ? 10 : null,\r\n      }}\r\n    >\r\n        <InfoTooltip>\r\n          {tooltip}\r\n        </InfoTooltip>\r\n     </span>;\r\n\r\n  return (\r\n    <Fragment>\r\n      {!tooltipOnRight && <Tooltip/>}\r\n      <span style={{pointerEvents: \"none\"}}>\r\n        {children}\r\n      </span>\r\n      {tooltipOnRight && <Tooltip/>}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default FormLabelWithTooltip;","export const downloadFormats = t => ({\r\n  genericdata: {\r\n    label: t ? t(\"commons.downloadFormat.genericdata\") : \"genericdata\",\r\n    extension: \"xml\"\r\n  },\r\n  genericdata20: {\r\n    label: t ? t(\"commons.downloadFormat.genericdata20\") : \"genericdata20\",\r\n    extension: \"xml\"\r\n  },\r\n  compactdata: {\r\n    label: t ? t(\"commons.downloadFormat.compactdata\") : \"compactdata\",\r\n    extension: \"xml\"\r\n  },\r\n  structurespecificdata: {\r\n    label: t ? t(\"commons.downloadFormat.structurespecificdata\") : \"structurespecificdata\",\r\n    extension: \"xml\"\r\n  },\r\n  jsondata: {\r\n    label: t ? t(\"commons.downloadFormat.jsondata\") : \"jsondata\",\r\n    extension: \"json\"\r\n  },\r\n  csv: {\r\n    label: t ? t(\"commons.downloadFormat.csv\") : \"csv\",\r\n    extension: \"csv\"\r\n  }\r\n});\r\n\r\nexport const isDownloadFormatValid = format => downloadFormats()?.[format] !== undefined\r\n\r\nexport const getDownloadFormatLabels = t => {\r\n  const labels = [];\r\n\r\n  for (let format in downloadFormats) {\r\n    if (downloadFormats.hasOwnProperty(format)) {\r\n      labels.push(downloadFormats(t)[format].label);\r\n    }\r\n  }\r\n\r\n  return labels;\r\n};\r\n\r\nexport const getDownloadFormatLabelFromFormat = (format, t) => downloadFormats(t)[format]?.label;\r\n\r\nexport const getDownloadFormatExtensionFromFormat = (format, t) => downloadFormats(t)[format]?.extension;\r\n\r\nexport const exportChartJpeg = (canvasId, fileName) => {\r\n  const canvas = document.getElementById(canvasId);\r\n\r\n  const link = document.createElement(\"a\");\r\n  link.download = fileName;\r\n  link.target = \"_blank\";\r\n  link.href = canvas.toDataURL(\"image/jpeg\");\r\n\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport {useForm} from 'react-hook-form'\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport {compose} from \"redux\";\r\nimport validator from \"validator\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearNodesConfigNode,\r\n  fetchNodesConfigNode,\r\n  sendNodesConfigNodeCreate,\r\n  sendNodesConfigNodeEdit\r\n} from \"../../../../state/nodesConfig/nodesConfigActions\";\r\nimport {\r\n  ALL_FULL,\r\n  ALL_PARTIAL,\r\n  STEP_BY_STEP_DYNAMIC,\r\n  STEP_BY_STEP_FULL,\r\n  STEP_BY_STEP_PARTIAL\r\n} from \"../../../../state/dataset/datasetActions\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport FileInput from \"../../../file-input\";\r\nimport FormLabelWithTooltip from \"../../../form-label-with-tooltip\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nTextField from \"../../../i18n-text-field\";\r\nimport {validateI18nObj} from \"../../../../utils/i18n\";\r\nimport I18nHtmlEditor from \"../../../i18n-html-editor\";\r\nimport {downloadFormats} from \"../../../../utils/download\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit, onCancel}, ref) => {\r\n\r\n  const [tab, setTab] = useState(\"general\");\r\n  const [mustChangeTabOnErrors, setMustChangeTabOnErrors] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      active: false,\r\n      ...config,\r\n      annotationConfig:\r\n        config?.extras?.find(({key}) => key === \"AnnotationConfig\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"AnnotationConfig\").value)\r\n          : {\r\n            \"ORDER\": \"ORDER\",\r\n            \"ORDER_CATEGORY\": \"ORDER\",\r\n            \"ORDER_CODELIST\": \"ORDER\",\r\n            \"NOT_DISPLAYED\": \"NOT_DISPLAYED\",\r\n            \"DEFAULT\": \"DEFAULT\",\r\n            \"LAYOUT_ROW\": \"LAYOUT_ROW\",\r\n            \"LAYOUT_COLUMN\": \"LAYOUT_COLUMN\",\r\n            \"LAYOUT_FILTER\": \"LAYOUT_FILTER\",\r\n            \"LAYOUT_ROW_SECTION\": \"LAYOUT_ROW_SECTION\",\r\n            \"LAYOUT_CHART_PRIMARY_DIM\": \"LAYOUT_CHART_PRIMARY_DIM\",\r\n            \"LAYOUT_CHART_SECONDARY_DIM\": \"LAYOUT_CHART_SECONDARY_DIM\",\r\n            \"LAYOUT_CHART_FILTER\": \"LAYOUT_CHART_FILTER\",\r\n            \"CRITERIA_SELECTION\": \"CRITERIA_SELECTION\",\r\n            \"ATTACHED_DATA_FILES\": \"ATTACHED_DATA_FILES\",\r\n            \"LAYOUT_DECIMAL_SEPARATOR\": \"LAYOUT_DECIMAL_SEPARATOR\",\r\n            \"LAYOUT_NUMBER_OF_DECIMALS\": \"LAYOUT_NUMBER_OF_DECIMALS\",\r\n            \"LAYOUT_EMPTY_CELL_PLACEHOLDER\": \"LAYOUT_EMPTY_CELL_PLACEHOLDER\",\r\n            \"DATAFLOW_NOTES\": \"DATAFLOW_NOTES\",\r\n            \"DATAFLOW_SOURCE\": \"DATAFLOW_SOURCE\",\r\n            \"METADATA_URL\": \"METADATA_URL\",\r\n            \"KEYWORDS\": \"KEYWORDS\",\r\n            \"DEFAULT_VIEW\": \"DEFAULT_VIEW\",\r\n            \"GEO_ID\": \"GEO_ID\",\r\n            \"LAST_UPDATE\": \"LAST_UPDATE\",\r\n            \"VIRTUAL_DATAFLOW_NODE\": \"VIRTUAL_DATAFLOW_NODE\",\r\n            \"DATAFLOW_CATALOG_TYPE\": \"DATAFLOW_CATALOG_TYPE\"\r\n          },\r\n      showCategoryLevels: config?.showCategoryLevels || 1,\r\n      decimalNumber: config?.decimalNumber || 1,\r\n      decimalSeparator: config?.decimalSeparator || {en: \",\"},\r\n      catalogNavigationMode: config?.catalogNavigationMode || \"List\",\r\n      hiddenAttributes:\r\n        config?.extras?.find(({key}) => key === \"HiddenAttributes\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"HiddenAttributes\").value)\r\n          : [],\r\n      pageSize:\r\n        config?.extras?.find(({key}) => key === \"PageSize\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"PageSize\").value)\r\n          : \"\",\r\n      restDataResponseXml:\r\n        config?.extras?.find(({key}) => key === \"RestDataResponseXml\") && (\r\n          config.extras.find(({key}) => key === \"RestDataResponseXml\").value === \"false\" ||\r\n          config.extras.find(({key}) => key === \"RestDataResponseXml\").value === \"true\"\r\n        )\r\n          ? config.extras.find(({key}) => key === \"RestDataResponseXml\").value\r\n          : \"\",\r\n      downloadFormats:\r\n        config?.extras?.find(({key}) => key === \"DownloadFormats\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"DownloadFormats\").value)\r\n          : [],\r\n      supportPostFilters:\r\n        config?.extras?.find(({key}) => key === \"SupportPostFilters\") && (\r\n          config.extras.find(({key}) => key === \"SupportPostFilters\").value === \"false\" ||\r\n          config.extras.find(({key}) => key === \"SupportPostFilters\").value === \"true\"\r\n        )\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"SupportPostFilters\").value)\r\n          : false,\r\n      enableEndpointV20:\r\n        config?.extras?.find(({key}) => key === \"EnableEndPointV20\") && (\r\n          config.extras.find(({key}) => key === \"EnableEndPointV20\").value === \"false\" ||\r\n          config.extras.find(({key}) => key === \"EnableEndPointV20\").value === \"true\"\r\n        )\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"EnableEndPointV20\").value)\r\n          : false,\r\n      endpointV20:\r\n        config?.extras?.find(({key}) => key === \"EndPointV20\")\r\n          ? config.extras.find(({key}) => key === \"EndPointV20\").value || \"\"\r\n          : \"\",\r\n    }\r\n  });\r\n\r\n  const enableHttpAuth = watch(\"enableHttpAuth\");\r\n  const enableProxy = watch(\"enableProxy\");\r\n  const enableEndpointV20 = watch(\"enableEndpointV20\");\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      setMustChangeTabOnErrors(true);\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          type: \"SDMX-REST\",\r\n          annotationConfig: undefined,\r\n          restDataResponseXml: undefined,\r\n          optimizeCallWithSoap: undefined,\r\n          namespaceV20: undefined,\r\n          namespaceV21: undefined,\r\n          hiddenAttributes: undefined,\r\n          pageSize: undefined,\r\n          downloadFormats: undefined,\r\n          enableEndpointV20: undefined,\r\n          endpointV20: undefined\r\n        };\r\n\r\n        if (data.extras?.find(({key}) => key === \"AnnotationConfig\")) {\r\n          data.extras.find(({key}) => key === \"AnnotationConfig\").value = JSON.stringify(val.annotationConfig)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"AnnotationConfig\",\r\n            value: JSON.stringify(val.annotationConfig),\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"RestDataResponseXml\")) {\r\n          data.extras.find(({key}) => key === \"RestDataResponseXml\").value = val.restDataResponseXml\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"RestDataResponseXml\",\r\n            value: val.restDataResponseXml,\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"SupportPostFilters\")) {\r\n          data.extras.find(({key}) => key === \"SupportPostFilters\").value = JSON.stringify(val.supportPostFilters)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"SupportPostFilters\",\r\n            value: JSON.stringify(val.supportPostFilters),\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"HiddenAttributes\")) {\r\n          data.extras.find(({key}) => key === \"HiddenAttributes\").value = JSON.stringify(val.hiddenAttributes)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"HiddenAttributes\",\r\n            value: JSON.stringify(val.hiddenAttributes),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"PageSize\")) {\r\n          data.extras.find(({key}) => key === \"PageSize\").value = JSON.stringify(val.pageSize)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"PageSize\",\r\n            value: JSON.stringify(val.pageSize),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"DownloadFormats\")) {\r\n          data.extras.find(({key}) => key === \"DownloadFormats\").value = JSON.stringify(val.downloadFormats)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"DownloadFormats\",\r\n            value: JSON.stringify(val.downloadFormats),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"EnableEndPointV20\")) {\r\n          data.extras.find(({key}) => key === \"EnableEndPointV20\").value = JSON.stringify(val.enableEndpointV20)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"EnableEndPointV20\",\r\n            value: JSON.stringify(val.enableEndpointV20),\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"EndPointV20\")) {\r\n          data.extras.find(({key}) => key === \"EndPointV20\").value = val.endpointV20\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"EndPointV20\",\r\n            value: val.endpointV20 || \"\",\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  /* custom register */\r\n  useEffect(() => {\r\n\r\n    register({\r\n      name: \"code\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n    });\r\n    register({\r\n      name: \"title\"\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({\r\n      name: \"agency\"\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    })\r\n    register({name: 'active'});\r\n    register({name: 'default'});\r\n    register({name: \"slogan\"});\r\n    register({name: 'backgroundMediaURL'});\r\n    register({name: 'logo'});\r\n    register({name: 'description'});\r\n    register({\r\n      name: 'criteriaSelectionMode'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"endPoint\"\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"supportPostFilters\"\r\n    });\r\n    register({\r\n      name: \"enableEndpointV20\"\r\n    });\r\n    register({name: 'enableHttpAuth'});\r\n    register({name: 'enableProxy'});\r\n    register({name: 'annotationConfig.ORDER'});\r\n    register({name: 'annotationConfig.ORDER_CATEGORY'});\r\n    register({name: 'annotationConfig.ORDER_CODELIST'});\r\n    register({name: 'annotationConfig.NOT_DISPLAYED'});\r\n    register({name: 'annotationConfig.DEFAULT'});\r\n    register({name: 'annotationConfig.LAYOUT_ROW'});\r\n    register({name: 'annotationConfig.LAYOUT_COLUMN'});\r\n    register({name: 'annotationConfig.LAYOUT_FILTER'});\r\n    register({name: 'annotationConfig.LAYOUT_ROW_SECTION'});\r\n    register({name: 'annotationConfig.LAYOUT_CHART_PRIMARY_DIM'});\r\n    register({name: 'annotationConfig.LAYOUT_CHART_SECONDARY_DIM'});\r\n    register({name: 'annotationConfig.LAYOUT_CHART_FILTER'});\r\n    register({name: 'annotationConfig.CRITERIA_SELECTION'});\r\n    register({name: 'annotationConfig.ATTACHED_DATA_FILES'});\r\n    register({name: 'annotationConfig.LAYOUT_DECIMAL_SEPARATOR'});\r\n    register({name: 'annotationConfig.LAYOUT_NUMBER_OF_DECIMALS'});\r\n    register({name: 'annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER'});\r\n    register({name: 'annotationConfig.DATAFLOW_NOTES'});\r\n    register({name: 'annotationConfig.DATAFLOW_SOURCE'});\r\n    register({name: 'annotationConfig.METADATA_URL'});\r\n    register({name: 'annotationConfig.KEYWORDS'});\r\n    register({name: 'annotationConfig.DEFAULT_VIEW'});\r\n    register({name: 'annotationConfig.GEO_ID'});\r\n    register({name: 'annotationConfig.LAST_UPDATE'});\r\n    register({name: 'annotationConfig.VIRTUAL_DATAFLOW_NODE'});\r\n    register({name: 'annotationConfig.DATAFLOW_CATALOG_TYPE'});\r\n    register({\r\n      name: \"ttlCatalog\"\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: \"ttlDataflow\"\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({name: 'showDataflowUncategorized'});\r\n    register({\r\n      name: 'showCategoryLevels'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"decimalNumber\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: 'decimalSeparator'\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({name: 'labelDimensionTerritorials'});\r\n    register({name: 'labelDimensionTemporals'});\r\n    register({name: 'categorySchemaExcludes'});\r\n    register({\r\n      name: 'catalogNavigationMode'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({name: 'hiddenAttributes'});\r\n    register({\r\n      name: 'pageSize'\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: 'restDataResponseXml'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({name: 'downloadFormats'});\r\n  }, [register, t]);\r\n\r\n  /* register enableHttpAuth fieldset */\r\n  useEffect(() => {\r\n\r\n    if (enableHttpAuth) {\r\n      register({\r\n        name: \"authHttpUsername\"\r\n      }, {\r\n        required: t(\"commons.validation.required\")\r\n      });\r\n      register({\r\n        name: \"authHttpPassword\"\r\n      });\r\n      register({\r\n        name: \"authHttpDomain\"\r\n      });\r\n    }\r\n\r\n  }, [register, enableHttpAuth, t]);\r\n\r\n  /* register enableProxy fieldset */\r\n  useEffect(() => {\r\n\r\n    if (enableProxy) {\r\n      register({\r\n        name: \"proxyAddress\"\r\n      }, {\r\n        required: t(\"commons.validation.required\")\r\n      });\r\n      register({\r\n        name: \"proxyPort\"\r\n      }, {\r\n        required: t(\"commons.validation.required\"),\r\n        validate: val => validator.isPort(val) || t(\"scenes.nodeSettings.fields.proxyPort.validation\")\r\n      });\r\n      register({name: \"proxyUsername\"});\r\n      register({name: \"proxyPassword\"});\r\n    }\r\n  }, [register, enableProxy, t]);\r\n\r\n  useEffect(() => {\r\n    if (enableEndpointV20) {\r\n      register({\r\n        name: \"endpointV20\"\r\n      }, {\r\n        required: t(\"commons.validation.required\")\r\n      });\r\n    }\r\n  }, [enableEndpointV20, register, t]);\r\n\r\n  /* switch to first tab with errors */\r\n  if (Object.keys(errors).length > 0 && mustChangeTabOnErrors) {\r\n\r\n    setMustChangeTabOnErrors(false);\r\n\r\n    const firstFieldWithErrors = Object.keys(errors)[0];\r\n    if (firstFieldWithErrors === \"code\" || firstFieldWithErrors === \"agency\" || firstFieldWithErrors === \"title\" || firstFieldWithErrors === \"slogan\") {\r\n      if (tab !== \"general\") {\r\n        setTab(\"general\")\r\n      }\r\n    } else if (\r\n      firstFieldWithErrors === \"showCategoryLevels\" ||\r\n      firstFieldWithErrors === \"decimalNumber\" ||\r\n      firstFieldWithErrors === \"decimalSeparator\" ||\r\n      firstFieldWithErrors === \"labelDimensionTerritorials\" ||\r\n      firstFieldWithErrors === \"labelDimensionTemporals\" ||\r\n      firstFieldWithErrors === \"categorySchemaExcludes\" ||\r\n      firstFieldWithErrors === \"catalogNavigationMode\" ||\r\n      firstFieldWithErrors === \"hiddenAttributes\" ||\r\n      firstFieldWithErrors === \"pageSize\" ||\r\n      firstFieldWithErrors === \"downloadFormats\"\r\n    ) {\r\n\r\n      if (tab !== \"view\") {\r\n        setTab(\"view\")\r\n      }\r\n\r\n    } else if (firstFieldWithErrors) {\r\n\r\n      if (tab !== \"endpoint\") {\r\n        setTab(\"endpoint\");\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <Tabs\r\n        value={tab}\r\n        onChange={(_, tab) => setTab(tab)}\r\n      >\r\n        <Tab value=\"general\" label={t(\"scenes.nodeSettings.tabs.general.label\")}/>\r\n        <Tab value=\"infos\" label={t(\"scenes.nodeSettings.tabs.information.label\")}/>\r\n        <Tab value=\"endpoint\" label={t(\"scenes.nodeSettings.tabs.endpoint.label\")}/>\r\n        <Tab value=\"annotations\" label={t(\"scenes.nodeSettings.tabs.annotations.label\")}/>\r\n        <Tab value=\"view\" label={t(\"scenes.nodeSettings.tabs.view.label\")}/>\r\n        <Tab value=\"cache\" label={t(\"scenes.nodeSettings.tabs.cache.label\")}/>\r\n      </Tabs>\r\n      <div className={classes.tabContent}>\r\n        <Box style={tab !== \"general\" ? {display: \"none\"} : undefined}>\r\n          <Fragment>\r\n            <Grid container spacing={3}>\r\n              <Grid item xs={3}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    disabled={!!config}\r\n                    name=\"code\"\r\n                    variant=\"outlined\"\r\n                    label={\r\n                      <FormLabelWithTooltip tooltip={t(\"scenes.nodeSettings.fields.code.tooltip\")}>\r\n                        {t(\"scenes.nodeSettings.fields.code.label\")}\r\n                      </FormLabelWithTooltip>\r\n                    }\r\n                    required\r\n                    error={!!errors.code}\r\n                    helperText={errors.code?.message}\r\n                    value={watch('code') || \"\"}\r\n                    onChange={({target}) => setValue('code', (target.value || \"\").toUpperCase())}\r\n                    inputProps={{\r\n                      style: {textTransform: \"uppercase\"}\r\n                    }}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <I18nTextField\r\n                    name=\"title\"\r\n                    label={t(\"scenes.nodeSettings.fields.title.label\")}\r\n                    required\r\n                    error={!!errors.title}\r\n                    helperText={errors.title?.message}\r\n                    variant=\"outlined\"\r\n                    value={watch('title') || {}}\r\n                    onChange={value => setValue('title', value)}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={3}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    name=\"agency\"\r\n                    label={t(\"scenes.nodeSettings.fields.agency.label\")}\r\n                    required\r\n                    error={!!errors.agency}\r\n                    helperText={errors.agency?.message}\r\n                    variant=\"outlined\"\r\n                    value={watch('agency') || \"\"}\r\n                    onChange={({target}) => setValue('agency', target.value)}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FormControlLabel\r\n                label={\r\n                  <FormLabelWithTooltip\r\n                    tooltip={t(\"scenes.nodeSettings.fields.active.tooltip\")}\r\n                    tooltipOnRight\r\n                  >\r\n                    {t(\"scenes.nodeSettings.fields.active.label\")}\r\n                  </FormLabelWithTooltip>\r\n                }\r\n                control={\r\n                  <Checkbox\r\n                    name=\"active\"\r\n                    required\r\n                    checked={watch('active')}\r\n                    onChange={(e, value) => setValue('active', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FormControlLabel\r\n                label={t(\"scenes.nodeSettings.fields.default.label\")}\r\n                control={\r\n                  <Checkbox\r\n                    name=\"default\"\r\n                    required\r\n                    checked={watch('default')}\r\n                    onChange={(e, value) => setValue('default', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"slogan\"\r\n                label={t(\"scenes.nodeSettings.fields.slogan.label\")}\r\n                variant=\"outlined\"\r\n                value={watch('slogan') || {}}\r\n                onChange={value => setValue('slogan', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.nodeSettings.fields.backgroundMediaURL.label\")}\r\n                value={watch('backgroundMediaURL')}\r\n                onChange={value => setValue('backgroundMediaURL', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.nodeSettings.fields.logo.label\")}\r\n                value={watch('logo')}\r\n                onChange={value => setValue('logo', value)}\r\n              />\r\n            </FormControl>\r\n          </Fragment>\r\n        </Box>\r\n        <Box style={tab !== \"infos\" ? {display: \"none\"} : undefined}>\r\n          <I18nHtmlEditor\r\n            value={watch('description')}\r\n            onChange={val => setValue('description', val)}\r\n          />\r\n        </Box>\r\n        <Box style={tab !== \"endpoint\" ? {display: \"none\"} : undefined}>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={12}>\r\n                <FormControl fullWidth>\r\n                  <TextField\r\n                    name=\"type\"\r\n                    select\r\n                    label={t(\"scenes.nodeSettings.fields.type.label\")}\r\n                    value=\"SDMX-REST\"\r\n                    variant=\"outlined\"\r\n                  >\r\n                    <MenuItem value=\"SDMX-REST\">SDMX-REST</MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item sm={12}>\r\n                <FormControl fullWidth>\r\n                  <TextField\r\n                    name=\"criteriaSelectionMode\"\r\n                    select\r\n                    label={\r\n                      <FormLabelWithTooltip\r\n                        tooltip={t(\"scenes.nodeSettings.fields.criteriaSelectionMode.tooltip\")}\r\n                      >\r\n                        {t(\"scenes.nodeSettings.fields.criteriaSelectionMode.label\")}\r\n                      </FormLabelWithTooltip>\r\n                    }\r\n                    variant=\"outlined\"\r\n                    onChange={e => setValue('criteriaSelectionMode', e.target.value)}\r\n                    value={watch(\"criteriaSelectionMode\") || ''}\r\n                    helperText={errors.criteriaSelectionMode?.message}\r\n                    error={!!errors.criteriaSelectionMode}\r\n                  >\r\n                    <MenuItem value={ALL_FULL}>ALL_FULL</MenuItem>\r\n                    <MenuItem value={ALL_PARTIAL}>ALL_PARTIAL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_FULL}>STEP_BY_STEP_FULL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_PARTIAL}>STEP_BY_STEP_PARTIAL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_DYNAMIC}>STEP_BY_STEP_DYNAMIC</MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n          </Paper>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"endPoint\"\r\n                label={t(\"scenes.nodeSettings.fields.endPoint.label\")}\r\n                required\r\n                error={!!errors.endPoint}\r\n                helperText={errors.endPoint?.message}\r\n                variant=\"outlined\"\r\n                value={watch('endPoint') || \"\"}\r\n                onChange={({target}) => setValue('endPoint', target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                select\r\n                label={t(\"scenes.nodeSettings.fields.responseFormat.label\")}\r\n                value={watch(\"restDataResponseXml\") || \"\"}\r\n                required\r\n                variant=\"outlined\"\r\n                error={!!errors.restDataResponseXml}\r\n                helperText={errors.restDataResponseXml?.message}\r\n                onChange={({target}) => setValue('restDataResponseXml', target.value)}\r\n              >\r\n                <MenuItem value=\"true\">XML</MenuItem>\r\n                <MenuItem value=\"false\">JSON</MenuItem>\r\n              </TextField>\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FormControlLabel\r\n                label={t(\"scenes.nodeSettings.fields.supportPostFilters.label\")}\r\n                control={\r\n                  <Checkbox\r\n                    name=\"supportPostFilters\"\r\n                    required\r\n                    checked={watch('supportPostFilters') || false}\r\n                    onChange={(e, value) => setValue('supportPostFilters', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FormControlLabel\r\n                label={\r\n                  <FormLabelWithTooltip\r\n                    tooltip={t(\"scenes.nodeSettings.fields.enableEndpointV20.tooltip\")}\r\n                  >\r\n                    {t(\"scenes.nodeSettings.fields.enableEndpointV20.label\")}\r\n                  </FormLabelWithTooltip>\r\n                }\r\n                control={\r\n                  <Checkbox\r\n                    name=\"enableEndpointV20\"\r\n                    required\r\n                    checked={enableEndpointV20}\r\n                    onChange={(e, value) => setValue('enableEndpointV20', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n            {enableEndpointV20 && (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  name=\"endpointV20\"\r\n                  label={t(\"scenes.nodeSettings.fields.endpointV20.label\")}\r\n                  required\r\n                  error={!!errors.endpointV20}\r\n                  helperText={errors.endpointV20?.message}\r\n                  variant=\"outlined\"\r\n                  value={watch('endpointV20') || \"\"}\r\n                  onChange={({target}) => setValue('endpointV20', target.value)}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          </Paper>\r\n          {/*<Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label=\"SOAP endpoint\"\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"optimizeCallWithSoap\"\r\n                      checked={watch('optimizeCallWithSoap')}\r\n                      onChange={(e, value) => setValue('optimizeCallWithSoap', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {optimizeCallWithSoap && (\r\n                <Fragment>\r\n                  <Grid item sm={8}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"namespaceV20\"\r\n                        label=\"Endpoint V20\"\r\n                        required\r\n                        inputRef={register({\r\n                          required: REQUIRED_MESSAGE\r\n                        })}\r\n                        error={!!errors.namespaceV20}\r\n                        helperText={errors.namespaceV20?.message}\r\n                        variant=\"outlined\"\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}></Grid>\r\n                  <Grid item sm={8}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"namespaceV21\"\r\n                        label=\"Endpoint V21\"\r\n                        required\r\n                        inputRef={register({\r\n                          required: REQUIRED_MESSAGE\r\n                        })}\r\n                        error={!!errors.namespaceV21}\r\n                        helperText={errors.namespaceV21?.message}\r\n                        variant=\"outlined\"\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>*/}\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label={t(\"scenes.nodeSettings.fields.enableHttpAuth.label\")}\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"enableHttpAuth\"\r\n                      checked={enableHttpAuth || false}\r\n                      onChange={(e, value) => setValue('enableHttpAuth', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {enableHttpAuth && (\r\n                <Fragment>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpUsername\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpUsername.label\")}\r\n                        required\r\n                        error={!!errors.authHttpUsername}\r\n                        helperText={errors.authHttpUsername?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpUsername') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpUsername', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpPassword\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpPassword.label\")}\r\n                        type=\"password\"\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpPassword') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpPassword', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}/>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpDomain\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpDomain.label\")}\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpDomain') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpDomain', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label={t(\"scenes.nodeSettings.fields.enableProxy.label\")}\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"enableProxy\"\r\n                      checked={enableProxy || false}\r\n                      onChange={(e, value) => setValue('enableProxy', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {enableProxy && (\r\n                <Fragment>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyAddress\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyAddress.label\")}\r\n                        required\r\n                        error={!!errors.proxyAddress}\r\n                        helperText={errors.proxyAddress?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyAddress') || \"\"}\r\n                        onChange={({target}) => setValue('proxyAddress', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyPort\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyPort.label\")}\r\n                        required\r\n                        error={!!errors.proxyPort}\r\n                        helperText={errors.proxyPort?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyPort') || \"\"}\r\n                        onChange={({target}) => setValue('proxyPort', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}/>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyUsername\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyUsername.label\")}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyUsername') || \"\"}\r\n                        onChange={({target}) => setValue('proxyUsername', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyPassword\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyPassword.label\")}\r\n                        type=\"password\"\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyPassword') || \"\"}\r\n                        onChange={e => setValue('proxyPassword', e.target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>\r\n        </Box>\r\n        <Box style={tab !== \"annotations\" ? {display: \"none\"} : undefined}>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER_CATEGORY\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER_CATEGORY.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER_CATEGORY') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER_CATEGORY', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER_CODELIST\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER_CODELIST.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER_CODELIST') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER_CODELIST', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.NOT_DISPLAYED\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.NOT_DISPLAYED.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.NOT_DISPLAYED') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.NOT_DISPLAYED', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DEFAULT\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DEFAULT.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DEFAULT') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DEFAULT', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_ROW\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_ROW.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_ROW') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_ROW', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_COLUMN\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_COLUMN.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_COLUMN') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_COLUMN', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_FILTER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_FILTER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_FILTER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_FILTER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_ROW_SECTION\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_ROW_SECTION.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_ROW_SECTION') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_ROW_SECTION', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_CHART_PRIMARY_DIM\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_CHART_PRIMARY_DIM.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_CHART_PRIMARY_DIM') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_CHART_PRIMARY_DIM', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_CHART_SECONDARY_DIM\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_CHART_SECONDARY_DIM.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_CHART_SECONDARY_DIM') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_CHART_SECONDARY_DIM', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_CHART_FILTER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_CHART_FILTER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_CHART_FILTER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_CHART_FILTER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.CRITERIA_SELECTION\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.CRITERIA_SELECTION.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.CRITERIA_SELECTION') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.CRITERIA_SELECTION', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ATTACHED_DATA_FILES\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ATTACHED_DATA_FILES.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ATTACHED_DATA_FILES') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ATTACHED_DATA_FILES', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_DECIMAL_SEPARATOR\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_DECIMAL_SEPARATOR.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_DECIMAL_SEPARATOR') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_DECIMAL_SEPARATOR', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_NUMBER_OF_DECIMALS\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_NUMBER_OF_DECIMALS.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_NUMBER_OF_DECIMALS') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_NUMBER_OF_DECIMALS', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_EMPTY_CELL_PLACEHOLDER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_NOTES\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_NOTES.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_NOTES') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_NOTES', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_SOURCE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_SOURCE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_SOURCE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_SOURCE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.METADATA_URL\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.METADATA_URL.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.METADATA_URL') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.METADATA_URL', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.KEYWORDS\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.KEYWORDS.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.KEYWORDS') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.KEYWORDS', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DEFAULT_VIEW\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DEFAULT_VIEW.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DEFAULT_VIEW') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DEFAULT_VIEW', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.GEO_ID\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.GEO_ID.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.GEO_ID') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.GEO_ID', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAST_UPDATE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAST_UPDATE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAST_UPDATE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAST_UPDATE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.VIRTUAL_DATAFLOW_NODE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.VIRTUAL_DATAFLOW_NODE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.VIRTUAL_DATAFLOW_NODE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.VIRTUAL_DATAFLOW_NODE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_CATALOG_TYPE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_CATALOG_TYPE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_CATALOG_TYPE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_CATALOG_TYPE', target.value)}\r\n            />\r\n          </FormControl>\r\n        </Box>\r\n        <Box style={tab !== \"cache\" ? {display: \"none\"} : undefined}>\r\n\r\n\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"ttlCatalog\"\r\n              variant=\"outlined\"\r\n              helperText={errors.ttlCatalog?.message}\r\n              label={\r\n                <FormLabelWithTooltip\r\n                  tooltip={t(\"scenes.nodeSettings.fields.catalogCacheValidity.tooltip\")}>\r\n                  {t(\"scenes.nodeSettings.fields.catalogCacheValidity.label\")}\r\n                </FormLabelWithTooltip>\r\n              }\r\n              error={!!errors.ttlCatalog}\r\n              value={watch('ttlCatalog') || \"\"}\r\n              onChange={({target}) => setValue('ttlCatalog', target.value)}\r\n            />\r\n          </FormControl>\r\n\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"ttlDataflow\"\r\n              variant=\"outlined\"\r\n              helperText={errors.ttlDataflow?.message}\r\n              label={\r\n                <FormLabelWithTooltip\r\n                  tooltip={t(\"scenes.nodeSettings.fields.dataflowCacheValidity.tooltip\")}>\r\n                  {t(\"scenes.nodeSettings.fields.dataflowCacheValidity.label\")}\r\n                </FormLabelWithTooltip>\r\n              }\r\n              error={!!errors.ttlDataflow}\r\n              value={watch('ttlDataflow') || \"\"}\r\n              onChange={({target}) => setValue('ttlDataflow', target.value)}\r\n            />\r\n          </FormControl>\r\n\r\n\r\n        </Box>\r\n        <Box style={tab !== \"view\" ? {display: \"none\"} : undefined}>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <FormControlLabel\r\n              label={t(\"scenes.nodeSettings.fields.showDataflowUncategorized.label\")}\r\n              control={\r\n                <Checkbox\r\n                  name=\"showDataflowUncategorized\"\r\n                  required\r\n                  checked={watch('showDataflowUncategorized') || false}\r\n                  onChange={(e, value) => setValue('showDataflowUncategorized', value)}\r\n                />\r\n              }\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"showCategoryLevels\"\r\n              select\r\n              required\r\n              label={t(\"scenes.nodeSettings.fields.showCategoryLevels.label\")}\r\n              onChange={e => setValue('showCategoryLevels', e.target.value)}\r\n              value={watch(\"showCategoryLevels\") || ''}\r\n              error={!!errors.showCategoryLevels}\r\n              helperText={errors.showCategoryLevels?.message}\r\n              variant=\"outlined\"\r\n            >\r\n              <MenuItem value={1}>1</MenuItem>\r\n              <MenuItem value={5}>5</MenuItem>\r\n            </TextField>\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"decimalNumber\"\r\n              label={t(\"scenes.nodeSettings.fields.decimalNumber.label\")}\r\n              variant=\"outlined\"\r\n              required\r\n              type=\"number\"\r\n              error={!!errors.decimalNumber}\r\n              helperText={errors.decimalNumber?.message}\r\n              value={watch('decimalNumber') || ''}\r\n              onChange={({target}) => setValue('decimalNumber', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <I18nTextField\r\n              name=\"decimalSeparator\"\r\n              select\r\n              required\r\n              label={t(\"scenes.nodeSettings.fields.decimalSeparator.label\")}\r\n              onChange={value => setValue('decimalSeparator', value)}\r\n              value={watch(\"decimalSeparator\") || ''}\r\n              helper={t(\"scenes.nodeSettings.fields.decimalSeparator.helper\")}\r\n              error={!!errors.decimalSeparator}\r\n              helperText={errors.decimalSeparator?.message}\r\n              variant=\"outlined\"\r\n            >\r\n              <MenuItem value=\".\">Dot</MenuItem>\r\n              <MenuItem value=\",\">Comma</MenuItem>\r\n            </I18nTextField>\r\n          </FormControl>\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('labelDimensionTerritorials') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('labelDimensionTerritorials', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.labelDimensionTerritorials.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.labelDimensionTerritorials.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('labelDimensionTemporals') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('labelDimensionTemporals', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.labelDimensionTemporals.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.labelDimensionTemporals.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('categorySchemaExcludes') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('categorySchemaExcludes', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.categorySchemaExcludes.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.categorySchemaExcludes.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              select\r\n              label={t(\"scenes.nodeSettings.fields.catalogNavigationMode.label\")}\r\n              onChange={e => setValue('catalogNavigationMode', e.target.value)}\r\n              value={watch(\"catalogNavigationMode\") || ''}\r\n              required\r\n              variant=\"outlined\"\r\n              error={!!errors.catalogNavigationMode}\r\n              helperText={errors.catalogNavigationMode?.message}\r\n            >\r\n              <MenuItem\r\n                value=\"Card\">{t(\"scenes.nodeSettings.fields.catalogNavigationMode.values.card\")}</MenuItem>\r\n              <MenuItem\r\n                value=\"List\">{t(\"scenes.nodeSettings.fields.catalogNavigationMode.values.list\")}</MenuItem>\r\n            </TextField>\r\n          </FormControl>\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('hiddenAttributes') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('hiddenAttributes', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.hiddenAttributes.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.hiddenAttributes.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          {/*<FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"pageSize\"\r\n              label={t(\"scenes.nodeSettings.fields.pageSize.label\")}\r\n              variant=\"outlined\"\r\n              type=\"number\"\r\n              value={watch('pageSize') || \"\"}\r\n              onChange={({target}) => setValue('pageSize', Number(target.value))}\r\n            />\r\n          </FormControl>*/}\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            options={Object.keys(downloadFormats(t))}\r\n            getOptionLabel={option => downloadFormats(t)[option].label}\r\n            value={watch('downloadFormats') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip\r\n                  variant=\"outlined\"\r\n                  label={downloadFormats(t)[option].label}\r\n                  {...getTagProps({index})}\r\n                />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('downloadFormats', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.downloadFormats.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.downloadFormats.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n        </Box>\r\n      </div>\r\n    </Box>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodesConfig.node\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchNodesConfigNode(nodeId)),\r\n  sendConfigCreate: config => dispatch(sendNodesConfigNodeCreate(config)),\r\n  sendConfig: config => dispatch(sendNodesConfigNodeEdit(config)),\r\n  clearConfig: () => dispatch(clearNodesConfigNode())\r\n});\r\n\r\nconst NodeSettingsForm = ({config, nodeId, fetchConfig, sendConfigCreate, sendConfig, clearConfig}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(nodeId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, nodeId]);\r\n\r\n  return ((nodeId === null || config) && (\r\n    <Form\r\n      config={nodeId === null ? undefined : config}\r\n      ref={ref}\r\n      onSubmit={nodeId === null ? sendConfigCreate : sendConfig}\r\n      onCancel={clearConfig}\r\n    />\r\n  ));\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(NodeSettingsForm);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  getCreateTemplateUrl,\r\n  getCreateViewUrl,\r\n  getDatasetDownloadUrl,\r\n  getDatasetStructureCodelistsUrl,\r\n  getDatasetStructureCodelistUrl,\r\n  getDatasetStructureDynamicCodelistUrl,\r\n  getDatasetStructureUrl,\r\n  getDatasetUrl,\r\n  getGeometryUrl\r\n} from \"../../serverApi/urls\";\r\nimport {getCriteriaArrayFromObject} from \"../../utils/criteria\";\r\n\r\nexport const DATASET_STRUCTURE_FETCH_ENABLE = \"dataset/structure/fetch/enable\";\r\nexport const DATASET_STRUCTURE_FETCH = \"dataset/structure/fetch\";\r\nexport const DATASET_FETCH_ENABLE = \"dataset/fetch/enable\";\r\nexport const DATASET_FETCH = \"dataset/fetch\";\r\nexport const DATASET_ACCESSIBLE_FETCH = \"dataset/accessible/fetch\";\r\nexport const DATASET_CRITERIA_LENGTH_WARNING_SHOW = \"dataset/criteria/length/warning/show\";\r\nexport const DATASET_CRITERIA_LENGTH_WARNING_HIDE = \"dataset/criteria/length/warning/hide\";\r\nexport const DATASET_CRITERIA_SHOW = \"dataset/criteria/show\";\r\nexport const DATASET_CRITERIA_HIDE = \"dataset/criteria/hide\";\r\nexport const DATASET_CRITERIA_ALERT_HIDE = \"dataset/criteria/alert/hide\";\r\nexport const DATASET_STRUCTURE_CODELIST_FETCH = \"dataset/structure/codelist/fetch\";\r\nexport const DATASET_STRUCTURE_CODELISTS_FETCH = \"dataset/structure/codelists/fetch\";\r\nexport const DATASET_STRUCTURE_CODELIST_CRITERIA_SET = \"dataset/structure/codelist/criteria/set\";\r\nexport const DATASET_STRUCTURE_CODELIST_TIME_PERIOD_SET = \"dataset/structure/codelist/timePeriod/set\";\r\n\r\nexport const DATASET_STATE_BACKUP = \"dataset/state/backup\";\r\nexport const DATASET_STATE_RESET = \"dataset/state/reset\";\r\n\r\nexport const DATASET_VIEWER_SET = \"dataset/viewer/set\";\r\n\r\nexport const DATASET_TABLE_LAYOUT_SUBMIT = \"dataset/table/layout/submit\";\r\nexport const DATASET_TABLE_FILTERS_TREE_SUBMIT = \"dataset/table/filters/tree/submit\";\r\nexport const DATASET_MAP_LAYOUT_SUBMIT = \"dataset/map/layout/submit\";\r\nexport const DATASET_CHART_LAYOUT_SUBMIT = \"dataset/chart/layout/submit\";\r\nexport const DATASET_CHART_FILTERS_TREE_SUBMIT = \"dataset/chart/filters/tree/submit\";\r\n\r\nexport const DATASET_LABEL_FORMAT_SET = \"dataset/label/format/set\";\r\nexport const DATASET_CHART_STACKED_SET = \"dataset/chart/stacked/set\";\r\nexport const DATASET_CHART_LEGEND_POSITION_SET = \"dataset/chart/legend/position/set\";\r\nexport const DATASET_CHART_COLORS_SET = \"dataset/chart/colors/set\";\r\nexport const DATASET_MAP_DETAIL_LEVEL_SET = \"dataset/map/detail/level/set\";\r\n\r\nexport const DATASET_DOWNLOAD_SUBMIT = \"dataset/download/submit\";\r\nexport const DATASET_DOWNLOAD_WARNING_HIDE = \"dataset/download/warning/hide\";\r\n\r\nexport const DATASET_VIEW_TEMPLATE_SHOW = \"dataset/view/template/show\";\r\nexport const DATASET_VIEW_TEMPLATE_HIDE = \"dataset/view/template/hide\";\r\nexport const DATASET_VIEW_TEMPLATE_SUBMIT = \"dataset/view/template/submit\";\r\nexport const DATASET_VIEW_ERROR_HIDE = \"dataset/view/error/hide\";\r\n\r\nexport const DATASET_UNAVAILABLE_VIEW_WARNING_HIDE = \"dataset/unavailable/view/warning/hide\";\r\n\r\nexport const DATASET_HTML_GENERATING_TIME_SET = \"dataset/html/generating/time/set\";\r\n\r\nexport const DATASET_TERRITORY_FETCH = \"dataset/territory/fetch\";\r\n\r\nexport const ALL_FULL = \"FullAll\"\r\nexport const ALL_PARTIAL = \"PartialAll\"\r\nexport const STEP_BY_STEP_FULL = \"FullStep\"\r\nexport const STEP_BY_STEP_PARTIAL = \"PartialStep\"\r\nexport const STEP_BY_STEP_DYNAMIC = \"Dynamic\"\r\n\r\nexport const CRITERIA_SELECTION_MODE_STEP_BY_STEP = \"stepByStep\"\r\nexport const CRITERIA_SELECTION_MODE_ALL = \"all\"\r\n\r\nexport const CRITERIA_SELECTION_TYPE_FULL = \"full\"\r\nexport const CRITERIA_SELECTION_TYPE_PARTIAL = \"partial\"\r\nexport const CRITERIA_SELECTION_TYPE_DYNAMIC = \"dynamic\"\r\n\r\nconst ENDPOINT_STRING_LENGTH = 100;\r\nconst MAX_CRITERIA_STRING_LENGTH = 2000;\r\n\r\nexport const enableDatasetStructureFetch = (nodeCode: string, categoryPath: string[], datasetId: string, viewId: string) => ({\r\n  type: DATASET_STRUCTURE_FETCH_ENABLE,\r\n  payload: {\r\n    datasetId: datasetId,\r\n    nodeCode: nodeCode,\r\n    categoryPath: categoryPath,\r\n    viewId: viewId\r\n  }\r\n});\r\n\r\nexport const fetchDatasetStructure = (nodeId: number, datasetId: string, viewId: string, isAccessible: boolean, defaultLanguage: string, languages: string[]) => initRequest(\r\n  DATASET_STRUCTURE_FETCH,\r\n  getDatasetStructureUrl(nodeId, datasetId, viewId),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDatasetStructure\")\r\n  }),\r\n  {\r\n    viewId: viewId,\r\n    isAccessible: isAccessible,\r\n    defaultLanguage: defaultLanguage,\r\n    languages: languages\r\n  }\r\n);\r\n\r\nexport const enableDatasetFetch = () => ({\r\n  type: DATASET_FETCH_ENABLE\r\n});\r\n\r\nexport const fetchDataset = (nodeId: number, datasetId: string, criteria: any, datasetTitle: string, checkCriteriaLength: boolean, tableLayout: any, chartLayout: any, mapLayout: any, maxAllowedCells: number, hasAnnotationLayout: boolean) => {\r\n  return (checkCriteriaLength && ((JSON.stringify(criteria).length + ENDPOINT_STRING_LENGTH) > MAX_CRITERIA_STRING_LENGTH))\r\n    ? {\r\n      type: DATASET_CRITERIA_LENGTH_WARNING_SHOW\r\n    }\r\n    : initRequest(\r\n      DATASET_FETCH,\r\n      getDatasetUrl(nodeId, datasetId),\r\n      RequestMethod.POST,\r\n      getCriteriaArrayFromObject(criteria),\r\n      t => ({\r\n        onStart: t(\"scenes.dataset.actions.fetchingDataset\", {title: datasetTitle})\r\n      }),\r\n      {\r\n        tableLayout: tableLayout,\r\n        chartLayout: chartLayout,\r\n        mapLayout: mapLayout,\r\n        maxAllowedCells: maxAllowedCells,\r\n        hasAnnotationLayout: hasAnnotationLayout\r\n      },\r\n      \"\",\r\n      (statusCode: number) => statusCode === 413\r\n    );\r\n};\r\n\r\nexport const fetchAccessibleDataset = (nodeId: number, datasetId: string, criteria: any, datasetTitle: string) => initRequest(\r\n  DATASET_ACCESSIBLE_FETCH,\r\n  getDatasetDownloadUrl(nodeId, datasetId, \"csv\"),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.fetchingDataset\", {title: datasetTitle})\r\n  })\r\n);\r\n\r\nexport const hideDatasetCriteriaLengthWarning = () => ({\r\n  type: DATASET_CRITERIA_LENGTH_WARNING_HIDE\r\n});\r\n\r\nexport const showDatasetCriteria = () => ({\r\n  type: DATASET_CRITERIA_SHOW\r\n});\r\n\r\nexport const hideDatasetCriteria = () => ({\r\n  type: DATASET_CRITERIA_HIDE\r\n});\r\n\r\nexport const hideDatasetCriteriaAlert = () => ({\r\n  type: DATASET_CRITERIA_ALERT_HIDE\r\n});\r\n\r\nexport const fetchDatasetStructureCodelist = (nodeId: number, datasetId: string, dimensionId: string, type: string, criteria: any) => {\r\n\r\n  let flatCriteria = getCriteriaArrayFromObject(criteria);\r\n  // @ts-ignore\r\n  flatCriteria = flatCriteria.filter(({id}) => id !== dimensionId)\r\n\r\n  return type === CRITERIA_SELECTION_TYPE_DYNAMIC\r\n    ? (\r\n      initRequest(\r\n        DATASET_STRUCTURE_CODELIST_FETCH,\r\n        getDatasetStructureDynamicCodelistUrl(nodeId, datasetId, dimensionId),\r\n        RequestMethod.POST,\r\n        flatCriteria,\r\n        t => ({\r\n          onStart: t(\"scenes.dataset.actions.fetchingCodelist\")\r\n        })\r\n      )\r\n    )\r\n    : (\r\n      initRequest(\r\n        DATASET_STRUCTURE_CODELIST_FETCH,\r\n        getDatasetStructureCodelistUrl(nodeId, datasetId, dimensionId, type === CRITERIA_SELECTION_TYPE_FULL),\r\n        undefined,\r\n        undefined,\r\n        t => ({\r\n          onStart: t(\"scenes.dataset.actions.fetchingCodelist\")\r\n        })\r\n      )\r\n    );\r\n};\r\n\r\nexport const fetchDatasetStructureCodelists = (nodeId: number, datasetId: string, type: string) => initRequest(\r\n  DATASET_STRUCTURE_CODELISTS_FETCH,\r\n  getDatasetStructureCodelistsUrl(nodeId, datasetId, type === CRITERIA_SELECTION_TYPE_FULL),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.fetchingCodelists\")\r\n  })\r\n);\r\n\r\nexport const setDatasetStructureCodelistCriteria = (criteria: any) => ({\r\n  type: DATASET_STRUCTURE_CODELIST_CRITERIA_SET,\r\n  criteria\r\n});\r\n\r\nexport const setDatasetStructureCodelistTimePeriod = (timePeriod: any) => ({\r\n  type: DATASET_STRUCTURE_CODELIST_TIME_PERIOD_SET,\r\n  timePeriod\r\n});\r\n\r\nexport const backupDatasetState = () => ({\r\n  type: DATASET_STATE_BACKUP\r\n});\r\n\r\nexport const resetDatasetState = () => ({\r\n  type: DATASET_STATE_RESET\r\n});\r\n\r\nexport const setDatasetViewer = (viewerIdx: number) => ({\r\n  type: DATASET_VIEWER_SET,\r\n  viewerIdx\r\n});\r\n\r\nexport const submitDatasetTableLayout = (layout: any) => ({\r\n  type: DATASET_TABLE_LAYOUT_SUBMIT,\r\n  layout\r\n});\r\n\r\nexport const submitDatasetTableFilterTree = (filterTree: any) => ({\r\n  type: DATASET_TABLE_FILTERS_TREE_SUBMIT,\r\n  filterTree\r\n});\r\n\r\nexport const submitDatasetMapLayout = (layout: any) => ({\r\n  type: DATASET_MAP_LAYOUT_SUBMIT,\r\n  layout\r\n});\r\n\r\nexport const submitDatasetChartLayout = (layout: any) => ({\r\n  type: DATASET_CHART_LAYOUT_SUBMIT,\r\n  layout\r\n});\r\n\r\nexport const submitDatasetChartFilterTree = (filterTree: any) => ({\r\n  type: DATASET_CHART_FILTERS_TREE_SUBMIT,\r\n  filterTree\r\n});\r\n\r\nexport const setDatasetLabelFormat = (labelFormat: string) => ({\r\n  type: DATASET_LABEL_FORMAT_SET,\r\n  labelFormat\r\n});\r\n\r\nexport const setDatasetChartStacked = (stacked: string) => ({\r\n  type: DATASET_CHART_STACKED_SET,\r\n  stacked\r\n});\r\n\r\nexport const setDatasetChartLegendPosition = (legendPosition: string) => ({\r\n  type: DATASET_CHART_LEGEND_POSITION_SET,\r\n  legendPosition\r\n});\r\n\r\nexport const setDatasetChartColors = (colors: string) => ({\r\n  type: DATASET_CHART_COLORS_SET,\r\n  colors\r\n});\r\n\r\nexport const setDatasetMapDetailLevel = (detailLevel: number) => ({\r\n  type: DATASET_MAP_DETAIL_LEVEL_SET,\r\n  detailLevel\r\n});\r\n\r\nexport const submitDatasetDownload = (nodeId: number, datasetId: string, datasetTitle: string, criteria: any, format: string, extension: string, zipped?: boolean) => initRequest(\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  getDatasetDownloadUrl(nodeId, datasetId, format, zipped),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.downloadingDataset\")\r\n  }),\r\n  {\r\n    fileSave: {\r\n      name: `${datasetTitle}.${extension}`,\r\n      type: \"text/plain;charset=utf-8\"\r\n    }\r\n  },\r\n  \"\",\r\n  (statusCode: number) => statusCode === 406,\r\n  undefined,\r\n  undefined,\r\n  format === \"jsondata\"\r\n);\r\n\r\nexport const hideDatasetDownloadWarning = () => ({\r\n  type: DATASET_DOWNLOAD_WARNING_HIDE\r\n});\r\n\r\nexport const showDatasetViewTemplate = (isView: boolean) => ({\r\n  type: DATASET_VIEW_TEMPLATE_SHOW,\r\n  isView\r\n});\r\n\r\nexport const hideDatasetViewTemplate = (isView: boolean) => ({\r\n  type: DATASET_VIEW_TEMPLATE_HIDE,\r\n  isView\r\n});\r\n\r\nexport const submitDatasetViewTemplate = (nodeId: number, viewTemplate: any, isView: boolean) => initRequest(\r\n  DATASET_VIEW_TEMPLATE_SUBMIT,\r\n  isView\r\n    ? getCreateViewUrl(nodeId)\r\n    : getCreateTemplateUrl(nodeId),\r\n  RequestMethod.POST,\r\n  viewTemplate,\r\n  t => ({\r\n    onStart: isView\r\n      ? t(\"scenes.dataset.actions.savingView\")\r\n      : t(\"scenes.dataset.actions.savingTemplate\")\r\n  }),\r\n  {\r\n    isView: isView\r\n  },\r\n  \"\",\r\n  (statusCode: number) => statusCode === 409,\r\n);\r\n\r\nexport const hideDatasetViewError = () => ({\r\n  type: DATASET_VIEW_ERROR_HIDE\r\n});\r\n\r\nexport const hideDatasetUnavailableViewWarning = () => ({\r\n  type: DATASET_UNAVAILABLE_VIEW_WARNING_HIDE\r\n});\r\n\r\nexport const setDatasetHtmlGeneratingTime = (time: number) => ({\r\n  type: DATASET_HTML_GENERATING_TIME_SET,\r\n  time\r\n});\r\n\r\n\r\nexport const fetchDatasetGeometries = (idList: string[], t: any) => initRequest(\r\n  DATASET_TERRITORY_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dataset.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    t\r\n  }\r\n);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getClearNodeCatalogMemoryCacheUrl,\r\n    getDataflowsCacheListUrl,\r\n    getDataflowsCacheUpdateUrl,\r\n    getDataflowsClearAllCacheUrl,\r\n    getDataflowsClearCacheUrl,\r\n    getDataflowsCreateCacheUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const DATAFLOW_CACHE_FETCH = \"cache/fetch\";\r\nexport const DATAFLOW_CACHE_CLEAR = \"cache/clear\";\r\nexport const DATAFLOW_CACHE_UPDATE = \"cache/update\";\r\nexport const DATAFLOW_CACHE_CREATE = \"cache/create\";\r\nexport const DATAFLOW_CACHE_DELETE = \"cache/delete\";\r\nexport const DATAFLOW_CACHE_DELETE_ALL = \"cache/deleteAll\";\r\nexport const DATAFLOW_CACHE_DELETE_CATALOG = \"cache/deleteCatalog\";\r\n\r\n\r\nexport const fetchDataflowCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_FETCH,\r\n  getDataflowsCacheListUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.cacheSettings.messages.fetchDataflowCache.start\")\r\n  })\r\n);\r\n\r\nexport const updateDataflowCache = (nodeId: number, cacheId: string, ttl: number) => initRequest(\r\n  DATAFLOW_CACHE_UPDATE,\r\n  getDataflowsCacheUpdateUrl(nodeId, cacheId),\r\n  RequestMethod.PUT,\r\n  {ttl: ttl},\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.updateDataflowCache.start\")\r\n  }),\r\n  {\r\n    ttl: ttl,\r\n    nodeId: nodeId,\r\n    cacheId: cacheId\r\n  }\r\n);\r\n\r\nexport const createDataflowCache = (nodeId: number, data:any) => initRequest(\r\n    DATAFLOW_CACHE_CREATE,\r\n    getDataflowsCreateCacheUrl(nodeId),\r\n    RequestMethod.POST,\r\n    data,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.cacheSettings.messages.createDataflowCache.start\")\r\n    }),\r\n    {\r\n      oldData: data,\r\n    }\r\n);\r\n\r\nexport const deleteDataflowCache = (nodeId: number, cacheId: string) => initRequest(\r\n  DATAFLOW_CACHE_DELETE,\r\n  getDataflowsClearCacheUrl(nodeId, cacheId),\r\n  RequestMethod.POST,\r\n  {},\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteDataflowCache.start\")\r\n  }),\r\n  {\r\n    nodeId: nodeId,\r\n    cacheId: cacheId\r\n  }\r\n);\r\n\r\nexport const clearDataflowCache = () => ({\r\n  type: DATAFLOW_CACHE_CLEAR\r\n});\r\n\r\nexport const deleteAllDataflowCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_DELETE_ALL,\r\n  getDataflowsClearAllCacheUrl(nodeId),\r\n  RequestMethod.POST,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteAllDataflowCache.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n\r\nexport const deleteCatalogCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_DELETE_CATALOG,\r\n  getClearNodeCatalogMemoryCacheUrl(nodeId),\r\n  RequestMethod.POST,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteCatalogCache.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n","import React, {forwardRef, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport CheckIcon from \"@material-ui/icons/Check\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport ArrowUpwardIcon from \"@material-ui/icons/ArrowUpward\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {\r\n  clearDataflowCache,\r\n  createDataflowCache,\r\n  deleteAllDataflowCache,\r\n  deleteCatalogCache,\r\n  deleteDataflowCache,\r\n  fetchDataflowCache,\r\n  updateDataflowCache\r\n} from \"../../../../state/cache/cacheActions\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport {Checkbox, withStyles, withTheme} from \"@material-ui/core\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\n\r\n\r\nconst tableIcons = {\r\n  Delete: forwardRef((props, ref) => <DeleteIcon {...props} ref={ref}/>),\r\n  Edit: forwardRef((props, ref) => <EditIcon {...props} ref={ref}/>),\r\n  Check: forwardRef((props, ref) => <CheckIcon {...props} ref={ref}/>),\r\n  Clear: forwardRef((props, ref) => <ClearIcon {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <ClearIcon {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpwardIcon {...props} ref={ref}/>),\r\n  Search: forwardRef((props, ref) => <SearchIcon {...props} ref={ref}/>),\r\n  Add: forwardRef((props, ref) => <AddIcon {...props} ref={ref}/>)\r\n};\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.cacheConfig\r\n});\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchCache: nodeId => dispatch(fetchDataflowCache(nodeId)),\r\n  clearCache: () => dispatch(clearDataflowCache()),\r\n  updateCache: (nodeId, cacheId, ttl) => dispatch(updateDataflowCache(nodeId, cacheId, ttl)),\r\n  createCache: (nodeId, data) => dispatch(createDataflowCache(nodeId, data)),\r\n  deleteFromCache: (nodeId, cacheId) => dispatch(deleteDataflowCache(nodeId, cacheId)),\r\n  deleteAllFromCache: (nodeId) => dispatch(deleteAllDataflowCache(nodeId)),\r\n  deleteCatalogCache: (nodeId) => dispatch(deleteCatalogCache(nodeId))\r\n});\r\n\r\n\r\nconst SECONDS_PER_DAY = 86400;\r\nconst SECONDS_PER_HOUR = 3600;\r\n\r\n\r\n/**\r\n * Convert seconds to HH:MM:SS\r\n * If seconds exceeds 24 hours, hours will be greater than 24 (30:05:10)\r\n *\r\n * @param {number} seconds\r\n * @returns {string}\r\n */\r\nconst secondsToHms = (totalSeconds) => {\r\n\r\n  if (!totalSeconds) {\r\n    return \"0 s\";\r\n  }\r\n\r\n  var days = Math.floor(totalSeconds / SECONDS_PER_DAY);\r\n  var hours = Math.floor((totalSeconds - (days * SECONDS_PER_DAY)) / SECONDS_PER_HOUR);\r\n  var minutes = Math.floor((totalSeconds - (days * SECONDS_PER_DAY) - (hours * SECONDS_PER_HOUR)) / 60);\r\n  var seconds = totalSeconds - (days * SECONDS_PER_DAY) - (hours * SECONDS_PER_HOUR) - (minutes * 60);\r\n\r\n  // round seconds\r\n  seconds = Math.round(seconds * 100) / 100\r\n\r\n  return wellFormattedTimeString(days, hours, minutes, seconds);\r\n};\r\n\r\nconst wellFormattedTimeString = (days, hours, mins, sec) => {\r\n  var result = \"\";\r\n  result += (days > 0 ? days + \"d \" : \"\"); // hide days if 0\r\n  result += (hours < 10 ? \" \" + hours : hours) + \"h \";\r\n  result += (mins < 10 ? \" \" + mins : mins) + \"m \";\r\n\r\n  if (days === 0) { // truncate if days is greater than zero\r\n    result += (sec < 10 ? \" \" + sec : sec) + \"s\";\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nconst CacheSettingsForm = ({classes, config, nodeId, fetchCache, createCache, updateCache, clearCache, deleteFromCache, deleteAllFromCache, deleteCatalogCache}, ref) => {\r\n//const CacheSettingsForm = compose(withStyles(styles), forwardRef)(({classes, config, nodeId, fetchCache, updateCache, clearCache, deleteFromCache}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null && (!config || config.length === 0));\r\n  const [hideEmptyDataflowCache, setEmptyDataflowCacheHidden] = useState(true);\r\n  const [emptyRowsCounter, setEmptyRowsCounter] = useState(0);\r\n  const [rowsCounter, setRowsCounter] = useState(0);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (!config || config.length === 0) {\r\n      setRowsCounter(0);\r\n      setEmptyRowsCounter(0);\r\n      return;\r\n    }\r\n    setRowsCounter(config.length);\r\n    setEmptyRowsCounter(config.filter(val => val?.cacheSize === 0).length);\r\n  }, [config]);\r\n\r\n  useEffect(() => {\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchCache(nodeId);\r\n    }\r\n\r\n\r\n  }, [config, fetchCache, nodeId, needConfig, setNeedConfig]);\r\n  /*\r\n      const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n          defaultValues: {\r\n              ...config\r\n          }\r\n      });\r\n  */\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      f();\r\n    },\r\n    cancel(f) {\r\n      clearCache();\r\n      f();\r\n    }\r\n  }));\r\n\r\n\r\n  return (\r\n\r\n    <Grid container>\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n\r\n            <Grid container spacing={2}>\r\n\r\n\r\n              <Grid item xs={4}>\r\n                <FormControl fullWidth>\r\n                  <Button container style={{marginRight: 24}} size=\"large\" variant=\"contained\"\r\n                          color=\"primary\" onClick={() => deleteCatalogCache(nodeId)}>\r\n                    {t(\"scenes.nodeSettings.cacheSettings.deleteCatalogCache\")}\r\n                  </Button>\r\n                </FormControl>\r\n              </Grid>\r\n              {/* <Grid item xs={4}>\r\n                                <FormControl fullWidth>\r\n                                    <Button size=\"large\" variant=\"contained\" color=\"primary\"\r\n                                            onClick={window.notImplemented.show}>\r\n                                        Refresh catalog cache\r\n                                    </Button>\r\n                                </FormControl>\r\n                            </Grid>\r\n                            <Grid item xs={4}/>*/}\r\n            </Grid>\r\n          </Paper>\r\n\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={1}>\r\n              <Grid item xs={4}>\r\n                <FormControl fullWidth>\r\n                  <Button container style={{marginRight: 24}} size=\"large\" variant=\"contained\"\r\n                          color=\"primary\" onClick={() => deleteAllFromCache(nodeId)}>\r\n                    {t(\"scenes.nodeSettings.cacheSettings.deleteAllDataflowCache\")}\r\n                  </Button>\r\n                </FormControl>\r\n              </Grid>\r\n              {/*<Grid item xs={4} >*/}\r\n              {/*    <FormControl fullWidth>*/}\r\n              {/*        <Button disabled size=\"large\" variant=\"contained\" color=\"primary\"*/}\r\n              {/*                onClick={window.notImplemented.show}>*/}\r\n              {/*            Refresh dataflow cache*/}\r\n              {/*        </Button>*/}\r\n              {/*    </FormControl>*/}\r\n              {/*</Grid>*/}\r\n              <Grid item xs={4}/>\r\n              <Grid item xs={4}/>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.nodeSettings.cacheSettings.hideEmptyEntries\")}\r\n                    control={\r\n                      <Checkbox\r\n                        name=\"active\"\r\n                        required\r\n                        disabled={emptyRowsCounter === 0 || rowsCounter === 0}\r\n                        checked={hideEmptyDataflowCache}\r\n                        onChange={(e, value) => setEmptyDataflowCacheHidden(value)}\r\n                      />\r\n                    }\r\n                  />\r\n                  {/*<FormHelperText>*/}\r\n                  {/*    { (!hideEmptyDataflowCache? \"Hide\" : \"Show\") + \" cache entries which size is 0 Kb.\" }*/}\r\n                  {/*</FormHelperText>*/}\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <CustomMaterialTable\r\n                components={{\r\n                  Container: Box\r\n                }}\r\n                icons={tableIcons}\r\n                columns={[\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowTitle\"),\r\n                    field: \"title\",\r\n                    editable: 'never'\r\n                  },\r\n                  /*{title: \"Title\", field: \"dataflowId\", editable: 'never'},*/\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowValidity\"),\r\n                    field: \"ttl\",\r\n                    type: \"numeric\",\r\n                    editable: 'onUpdate',\r\n                    render: rowData => secondsToHms(rowData.ttl)\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowFiles\"),\r\n                    field: \"cachedDataflow\",\r\n                    type: \"numeric\",\r\n                    editable: 'never'\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowSize\"),\r\n                    field: \"cacheSize\",\r\n                    type: \"numeric\",\r\n                    editable: 'never',\r\n                    render: rowData => rowData.cacheSize + \" Kb\"\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowAccess\"),\r\n                    field: \"cachedDataAccess\",\r\n                    type: \"numeric\",\r\n                    editable: 'never'\r\n                  }\r\n\r\n                ]}\r\n                data={config?.filter(val => !hideEmptyDataflowCache || val.cacheSize > 0) || []}\r\n                editable={{\r\n                  onRowUpdate: (newData, oldData) =>\r\n                    new Promise((resolve, reject) => {\r\n                      if (newData.ttl < 0) { // invalid ttl\r\n                        reject();\r\n                        return;\r\n                      }\r\n\r\n                      if (newData.ttl === oldData.ttl) { //no update is needed here\r\n                        resolve();\r\n                        return;\r\n                      }\r\n\r\n                      const dataUpdate = [...config];\r\n                      const index = oldData.tableData.id;\r\n                      dataUpdate[index] = newData;\r\n\r\n                      if (!newData.id || newData.id === '00000000-0000-0000-0000-000000000000') {\r\n                        createCache(nodeId, newData);\r\n                      } else {\r\n                        updateCache(nodeId, newData.id, newData.ttl)\r\n                      }\r\n\r\n\r\n                      // config([...dataUpdate]);\r\n\r\n                      resolve();\r\n                    }),\r\n                  onRowDelete: oldData =>\r\n                    new Promise((resolve, reject) => {\r\n                      const dataDelete = [...config];\r\n                      const index = oldData.tableData.id;\r\n                      dataDelete.splice(index, 1);\r\n\r\n                      //data does not exists. no need to make a server call\r\n                      if (!oldData.id || oldData.id === '00000000-0000-0000-0000-000000000000') {\r\n                        resolve();\r\n                        return;\r\n                      }\r\n\r\n                      deleteFromCache(nodeId, oldData.id)\r\n                      //setCacheConfig([...dataDelete]);\r\n\r\n                      resolve();\r\n                    }),\r\n                }}\r\n                /*actions={[\r\n                  {\r\n                    icon: EditIcon,\r\n                    tooltip: 'Edit node',\r\n                    onClick: (_, {id}) => {window.notImplemented.show();}\r\n                  },\r\n                  {\r\n                    icon: DeleteIcon,\r\n                    tooltip: 'Delete node',\r\n                    onClick: (_, {id}) => {window.notImplemented.show();}\r\n                  }]}\r\n                 */\r\n                options={{\r\n                  paging: false,\r\n                  draggable: true,\r\n                  actionsColumnIndex: -1,\r\n                  searchFieldAlignment: \"left\",\r\n                  //maxBodyHeight: 400,\r\n                  showTitle: false\r\n                }}\r\n                localization={{\r\n                  body: {\r\n                    editRow: {\r\n                      deleteText: t(\"scenes.nodesSettings.cacheSettings.modals.deleteDataflowCache.title\")\r\n                    },\r\n                    editTooltip: t(\"scenes.nodeSettings.cacheSettings.table.actions.editRow\"),\r\n                    deleteTooltip: t(\"scenes.nodeSettings.cacheSettings.table.actions.deleteRow\")\r\n                  }\r\n                }}\r\n              />\r\n            </Grid>\r\n\r\n          </Paper>\r\n\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n\r\n\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), withTheme, compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}),\r\n  forwardRef))(CacheSettingsForm);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getDeleteTemplateUrl, getNodeTemplatesUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_TEMPLATES_CONFIG_FETCH = \"nodeTemplatesConfig/fetch\";\r\nexport const NODE_TEMPLATES_CONFIG_CLEAR = \"nodeTemplatesConfig/clear\";\r\nexport const NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE = \"nodeTemplatesConfig/deleteTemplate\";\r\n\r\nexport const fetchNodeTemplatesConfig = (nodeId: number) => initRequest(\r\n  NODE_TEMPLATES_CONFIG_FETCH,\r\n  getNodeTemplatesUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.templatesSettings.fetchConfig.start\")\r\n  })\r\n);\r\n\r\nexport const clearNodeTemplatesConfig = () => ({\r\n  type: NODE_TEMPLATES_CONFIG_CLEAR\r\n});\r\n\r\nexport const deleteNodeTemplatesConfigTemplate = (nodeId: number, id: number) => initRequest(\r\n  NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE,\r\n  getDeleteTemplateUrl(nodeId, id),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.templatesSettings.deleteTemplate.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {Visibility} from \"@material-ui/icons\";\r\nimport {\r\n  clearNodeTemplatesConfig,\r\n  deleteNodeTemplatesConfigTemplate,\r\n  fetchNodeTemplatesConfig\r\n} from \"../../../../state/noteTemplatesConfig/nodeTemplatesConfigActions\";\r\nimport {goToData} from \"../../../../links\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  templates: state.nodeTemplatesConfig.templates\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchTemplates: nodeId => dispatch(fetchNodeTemplatesConfig(nodeId)),\r\n  deleteTemplate: (nodeId, id) => dispatch(deleteNodeTemplatesConfigTemplate(nodeId, id)),\r\n  clearTemplates: () => dispatch(clearNodeTemplatesConfig())\r\n});\r\n\r\nconst TemplatesSettingsForm = ({\r\n                                 classes,\r\n                                 defaultLanguage,\r\n                                 languages,\r\n                                 nodes,\r\n                                 nodeId,\r\n                                 defaultNodeOpen,\r\n                                 templates,\r\n                                 fetchTemplates,\r\n                                 deleteTemplate,\r\n                                 clearTemplates,\r\n                                 onTemplatesClose\r\n                               }, ref) => {\r\n\r\n  const [needTemplates, setNeedTemplates] = useState(true);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needTemplates) {\r\n      setNeedTemplates(false);\r\n      fetchTemplates(nodeId);\r\n    }\r\n  }, [templates, needTemplates, setNeedTemplates, fetchTemplates, nodeId]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearTemplates();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [deleteTemplateId, setDeleteTemplateId] = useState(null);\r\n\r\n  return templates && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"datasetId\",\r\n            title: t(\"scenes.nodeSettings.templatesSettings.table.columns.datasetId\")\r\n          },\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.nodeSettings.templatesSettings.table.columns.templateName\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          }\r\n        ]}\r\n        data={templates}\r\n        actions={[\r\n          {\r\n            icon: Visibility,\r\n            tooltip: t(\"scenes.nodeSettings.templatesSettings.table.actions.viewData\"),\r\n            onClick: (_, {nodeId, datasetId}) => {\r\n              const nodeCode = nodes.find(node => node.nodeId === nodeId).code.toLowerCase();\r\n              return (window.location.href.toLowerCase().includes(nodeCode) && window.location.href.toLowerCase().includes(datasetId.toLowerCase()))\r\n                ? onTemplatesClose()\r\n                : goToData(nodeCode, [], datasetId)\r\n            }\r\n\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.nodeSettings.templatesSettings.table.actions.deleteTemplate\"),\r\n            onClick: (_, {viewTemplateId}) => setDeleteTemplateId(viewTemplateId)\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 3,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteTemplateId !== null}\r\n      >\r\n        <DialogTitle> {t(\"scenes.nodeSettings.templatesSettings.modals.deleteTemplate.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.nodeSettings.templatesSettings.modals.deleteTemplate.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setDeleteTemplateId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteTemplate(nodeId, deleteTemplateId);\r\n            setDeleteTemplateId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(TemplatesSettingsForm);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearNodePermissionsConfig,\r\n  fetchNodePermissionsConfig,\r\n  sendNodePermissionsConfig\r\n} from \"../../../../state/nodePermissionsConfig/nodePermissionsConfigActions\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport {useForm} from \"react-hook-form\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst PERMISSIONS = [\r\n  \"ManageCache\",\r\n  \"ManageTemplate\",\r\n  \"ManageConfig\"\r\n];\r\n\r\nconst getPermissionsTranslations = t => ({\r\n  ManageCache: t(\"scenes.nodeSettings.permissions.table.columns.manageCache\"),\r\n  ManageTemplate: t(\"scenes.nodeSettings.permissions.table.columns.manageTemplate\"),\r\n  ManageConfig: t(\"scenes.nodeSettings.permissions.table.columns.manageConfig\")\r\n});\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, nodeId, onSubmit, onCancel}, ref) => {\r\n\r\n  const {register, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      config: config?.map((user, index) => {\r\n        let res = {...user};\r\n        PERMISSIONS.forEach(p => {\r\n          res[p] = config[index].permission.includes(`${p}_SingleNode_${nodeId}`) === true;\r\n        });\r\n        return res;\r\n      })\r\n    }\r\n  });\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    if (config) {\r\n      config.forEach((user, index) =>\r\n        PERMISSIONS.forEach(p =>\r\n          register({name: `config[${index}].${p}`})))\r\n    }\r\n  }, [register, config]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n\r\n        const data = val.config.map((userVal, index) => {\r\n          let res = {\r\n            userId: config[index].userId,\r\n            nodePermissions: []\r\n          };\r\n          PERMISSIONS.forEach(p => {\r\n            if (userVal[p] === true) {\r\n              res.nodePermissions.push(p);\r\n            }\r\n          });\r\n          res.tableData = undefined;\r\n          return res;\r\n        });\r\n\r\n        onSubmit(nodeId, data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return config && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"firstName\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userFirstName\")\r\n          },\r\n          {\r\n            field: \"lastName\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userLastName\")\r\n          },\r\n          {\r\n            field: \"organization\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userOrganization\")\r\n          },\r\n          {\r\n            field: \"email\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userEmail\")\r\n          },\r\n          ...PERMISSIONS.map(p => ({\r\n            title: getPermissionsTranslations(t)[p],\r\n            render: ({tableData}) =>\r\n              <Grid container justify=\"center\">\r\n                <Grid item>\r\n                  <Checkbox\r\n                    checked={watch(`config[${tableData.id}].${p}`)}\r\n                    onChange={(ev, value) => setValue(`config[${tableData.id}].${p}`, value)}\r\n                  />\r\n                </Grid>\r\n              </Grid>\r\n          }))\r\n        ]}\r\n        data={config}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          searchFieldAlignment: \"left\",\r\n          maxBodyHeight: 400,\r\n          showTitle: false\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n    </Fragment>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodePermissionsConfig.permissions\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchNodePermissionsConfig(nodeId)),\r\n  sendConfig: (nodeId, config) => dispatch(sendNodePermissionsConfig(nodeId, config)),\r\n  clearConfig: () => dispatch(clearNodePermissionsConfig())\r\n});\r\n\r\nconst PermissionsSettingsForm = ({config, nodeId, fetchConfig, sendConfig, clearConfig}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(nodeId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, nodeId]);\r\n\r\n  return ((nodeId === null || config) && (\r\n    <Form\r\n      nodeId={nodeId}\r\n      config={nodeId === null ? undefined : config}\r\n      ref={ref}\r\n      onSubmit={sendConfig}\r\n      onCancel={clearConfig}\r\n    />\r\n  ));\r\n};\r\n\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(PermissionsSettingsForm);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getNodePermissionsConfigGetUrl, getNodePermissionsConfigPutUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_PERMISSIONS_CONFIG_FETCH = \"nodePermissionsConfig/fetch\";\r\nexport const NODE_PERMISSIONS_CONFIG_CLEAR = \"nodePermissionsConfig/clear\";\r\nexport const NODE_PERMISSIONS_CONFIG_SEND = \"nodePermissionsConfig/send\";\r\n\r\nexport const fetchNodePermissionsConfig = (nodeId: number) => initRequest(\r\n    NODE_PERMISSIONS_CONFIG_FETCH,\r\n    getNodePermissionsConfigGetUrl(nodeId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.permissionsSettings.fetchConfig.start\")\r\n    })\r\n);\r\n\r\nexport const sendNodePermissionsConfig = (nodeId: number, config: any) => initRequest(\r\n    NODE_PERMISSIONS_CONFIG_SEND,\r\n    getNodePermissionsConfigPutUrl(nodeId),\r\n    RequestMethod.PUT,\r\n    config,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.permissionsSettings.sendConfig.start\")\r\n    })\r\n);\r\n\r\nexport const clearNodePermissionsConfig = () => ({\r\n    type: NODE_PERMISSIONS_CONFIG_CLEAR\r\n});\r\n","import React, {forwardRef} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport DashboardsManager from \"../../../dashboards-manager\";\r\nimport {\r\n  addNodesConfigDashboardsNodeDashboard,\r\n  clearAllNodesConfigNodeDashboards,\r\n  clearNodesConfigNodeDashboards,\r\n  fetchAllNodeConfigDashboards,\r\n  fetchNodesConfigNodeDashboards,\r\n  removeNodesConfigDashboardsNodeDashboard,\r\n  sendNodesConfigDashboardsNodeOrders\r\n} from \"../../../../state/nodesConfig/nodesConfigActions\";\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.hubConfig.hub,\r\n  user: state.user,\r\n  dashboards: state.nodesConfig.nodeDashboards,\r\n  allDashboards: state.nodesConfig.allDashboards\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboards: nodeId => dispatch(fetchNodesConfigNodeDashboards(nodeId)),\r\n  fetchAllDashboards: () => dispatch(fetchAllNodeConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearNodesConfigNodeDashboards()),\r\n  clearAllDashboards: () => dispatch(clearAllNodesConfigNodeDashboards()),\r\n  addDashboard: (nodeId, dashboardId) => dispatch(addNodesConfigDashboardsNodeDashboard(nodeId, dashboardId)),\r\n  removeDashboard: (nodeId, dashboardId) => dispatch(removeNodesConfigDashboardsNodeDashboard(nodeId, dashboardId)),\r\n  sendDashboardsOrders: (nodeId, dashboardsIds) => dispatch(sendNodesConfigDashboardsNodeOrders(nodeId, dashboardsIds))\r\n});\r\n\r\nconst DashboardsSettingsForm = ({\r\n                                  dashboards,\r\n                                  allDashboards,\r\n                                  fetchDashboards,\r\n                                  fetchAllDashboards,\r\n                                  clearDashboards,\r\n                                  clearAllDashboards,\r\n                                  addDashboard,\r\n                                  removeDashboard,\r\n                                  sendDashboardsOrders,\r\n                                  nodeId\r\n                                }, ref) =>\r\n  <DashboardsManager\r\n    dashboards={dashboards}\r\n    allDashboards={allDashboards}\r\n    fetchDashboards={() => fetchDashboards(nodeId)}\r\n    fetchAllDashboards={fetchAllDashboards}\r\n    clearDashboards={clearDashboards}\r\n    clearAllDashboards={clearAllDashboards}\r\n    addDashboard={dashboardId => addDashboard(nodeId, dashboardId)}\r\n    removeDashboard={dashboardId => removeDashboard(nodeId, dashboardId)}\r\n    sendDashboardsOrders={dashboardsIds => sendDashboardsOrders(nodeId, dashboardsIds)}\r\n    ref={ref}\r\n  />;\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(DashboardsSettingsForm);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useRef, useState} from 'react';\r\nimport NodeSettingsForm from \"./node-settings-form\";\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport SettingsDialog from \"../../settings-dialog\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {\r\n  clearNodesConfigNodes,\r\n  closeNodesConfig,\r\n  deleteNodesConfigNode,\r\n  fetchNodesConfigNodes,\r\n  sendNodesConfigNodesOrder\r\n} from \"../../../state/nodesConfig/nodesConfigActions\";\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {compose} from \"redux\";\r\nimport CacheSettingsForm from \"./cache-setting-form/index\";\r\nimport TemplatesSettingsForm from \"./templates-settings-form\";\r\nimport {\r\n  canCreateNode,\r\n  canDeleteNodes,\r\n  canDisplayCacheSettingForm,\r\n  canDisplayPermissionsSettingsForm,\r\n  canDisplayTemplatesSettingsForm,\r\n  canEditNode,\r\n  canManageNodeDashboards,\r\n  canSortNodes\r\n} from \"../../../utils/user\";\r\nimport PermissionsSettingsForm from \"./permissions-settings-form\";\r\nimport PersonIcon from '@material-ui/icons/Person';\r\nimport DashboardIcon from \"@material-ui/icons/Dashboard\";\r\nimport DashboardsSettingsForm from \"./dashboards-settings-form\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../utils/i18n\";\r\nimport \"./style.css\";\r\nimport {MTableToolbar} from \"material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodesConfig.nodes,\r\n  user: state.user,\r\n  language: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: () => dispatch(fetchNodesConfigNodes()),\r\n  sendOrders: orderedIds => dispatch(sendNodesConfigNodesOrder(orderedIds)),\r\n  deleteNode: nodeId => dispatch(deleteNodesConfigNode(nodeId)),\r\n  clearConfig: () => dispatch(clearNodesConfigNodes()),\r\n  onClose: () => dispatch(closeNodesConfig())\r\n});\r\n\r\nconst NodesSettingsForm = ({\r\n                             classes,\r\n                             defaultNodeOpen,\r\n                             config,\r\n                             fetchConfig,\r\n                             sendOrders,\r\n                             deleteNode,\r\n                             clearConfig,\r\n                             nodes,\r\n                             user,\r\n                             onClose,\r\n                             language,\r\n                             languages,\r\n                             onNodesClose\r\n                           }, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearConfig();\r\n      onClose();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [isNodeFormVisible, setNodeFormVisibility] = useState(defaultNodeOpen || false);\r\n  const [nodeFormNodeId, setNodeFormNodeId] = useState(null);\r\n  const [nodeDeleteFormNodeId, setNodeDeleteFormNodeId] = useState(null);\r\n  const [cacheFormNodeId, setCacheFormNodeId] = useState(null);\r\n  const [isCacheFormVisible, setCacheFormVisibility] = useState(false);\r\n  const [templatesNodeId, setTemplatesNodeId] = useState(null);\r\n  const [permissionsNodeId, setPermissionsNodeId] = useState(null);\r\n  const [dashboardsNodeId, setDashboardsNodeId] = useState(null);\r\n\r\n  const nodeFormRef = useRef();\r\n  const cacheFormRef = useRef();\r\n  const templatesRef = useRef();\r\n  const permissionsRef = useRef();\r\n  const dashboardsRef = useRef();\r\n\r\n  const allowedNodes = (config || []).filter(({nodeId}) =>\r\n    canCreateNode(user) ||\r\n    canSortNodes(user) ||\r\n    canDisplayCacheSettingForm(user, nodeId) ||\r\n    canDisplayTemplatesSettingsForm(user, nodeId) ||\r\n    canDisplayPermissionsSettingsForm(user) ||\r\n    canEditNode(user, nodeId) ||\r\n    canDeleteNodes(user)\r\n  );\r\n  const orderedNodes = (allowedNodes || []).sort((a, b) => a.order - b.order)\r\n  const orderedNodesIds = orderedNodes.map(({nodeId}) => nodeId);\r\n\r\n  const moveUp = rowIndex =>\r\n    sendOrders([\r\n      ...orderedNodesIds.slice(0, rowIndex - 1),\r\n      orderedNodesIds[rowIndex],\r\n      orderedNodesIds[rowIndex - 1],\r\n      ...orderedNodesIds.slice(rowIndex + 1)\r\n    ]);\r\n\r\n  const moveDown = rowIndex =>\r\n    sendOrders([\r\n      ...orderedNodesIds.slice(0, rowIndex),\r\n      orderedNodesIds[rowIndex + 1],\r\n      orderedNodesIds[rowIndex],\r\n      ...orderedNodesIds.slice(rowIndex + 2)\r\n    ]);\r\n\r\n  return config && (\r\n    <Fragment>\r\n      <Box className=\"nodes-settings-form__table\">\r\n        <CustomMaterialTable\r\n          components={{\r\n            Container: Box,\r\n            Toolbar: props =>\r\n              <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n                <Grid item>\r\n                  <MTableToolbar {...props} />\r\n                </Grid>\r\n                {canCreateNode(user) && (\r\n                  <Grid item>\r\n                    <Button\r\n                      size=\"small\"\r\n                      startIcon={<AddIcon/>}\r\n                      onClick={() => {\r\n                        setNodeFormNodeId(null);\r\n                        setNodeFormVisibility(true);\r\n                        setCacheFormVisibility(false);\r\n                      }}>\r\n                      {t(\"scenes.nodesSettings.createNode\")}\r\n                    </Button>\r\n                  </Grid>\r\n                )}\r\n              </Grid>\r\n          }}\r\n          columns={[\r\n            {\r\n              field: \"code\",\r\n              title: t(\"scenes.nodesSettings.table.columns.nodeCode\")\r\n            },\r\n            {\r\n              field: \"title\",\r\n              title: t(\"scenes.nodesSettings.table.columns.nodeName\"),\r\n              render: ({title}) => localizeI18nObj(title, language, languages),\r\n              customFilterAndSearch: getI18nObjCustomFilterAndSearch(language, languages)\r\n            },\r\n            {\r\n              field: \"active\",\r\n              title: t(\"scenes.nodesSettings.table.columns.isNodeActive.title\"),\r\n              render: ({active}) =>\r\n                active\r\n                  ? t(\"scenes.nodesSettings.table.columns.isNodeActive.values.true\")\r\n                  : t(\"scenes.nodesSettings.table.columns.isNodeActive.values.false\")\r\n            },\r\n            {\r\n              field: \"default\",\r\n              title: t(\"scenes.nodesSettings.table.columns.isNodeDefault.title\"),\r\n              render: node =>\r\n                node.default\r\n                  ? t(\"scenes.nodesSettings.table.columns.isNodeDefault.values.true\")\r\n                  : t(\"scenes.nodesSettings.table.columns.isNodeDefault.values.false\")\r\n            }\r\n          ]}\r\n          data={orderedNodes}\r\n          actions={[\r\n            ({tableData}) =>\r\n              canSortNodes(user)\r\n                ? {\r\n                  icon: ArrowDropUpIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeOrderMoveUp\"),\r\n                  onClick: (_, {tableData}) => moveUp(tableData.id), // tableData.id is the rowIndex\r\n                  disabled: tableData.id === 0\r\n                }\r\n                : null,\r\n            ({tableData}) =>\r\n              canSortNodes(user)\r\n                ? {\r\n                  icon: ArrowDropDownIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeOrderMoveDown\"),\r\n                  onClick: (_, {tableData}) => moveDown(tableData.id), // tableData.id is the rowIndex\r\n                  disabled: tableData.id === config.length - 1\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canDisplayCacheSettingForm(user, nodeId)\r\n                ? {\r\n                  icon: () =>\r\n                    <div className={classes.buttonAction}>\r\n                      {t(\"scenes.nodesSettings.table.actions.nodeDataflowsCache.label\")}\r\n                    </div>,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeDataflowsCache.tooltip\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setCacheFormNodeId(nodeId);\r\n                    setNodeFormVisibility(false);\r\n                    setCacheFormVisibility(true);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canDisplayTemplatesSettingsForm(user, nodeId)\r\n                ? {\r\n                  icon: () =>\r\n                    <div className={classes.buttonAction}>\r\n                      {t(\"scenes.nodesSettings.table.actions.nodeTemplates.label\")}\r\n                    </div>,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeTemplates.tooltip\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setTemplatesNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            () =>\r\n              canDisplayPermissionsSettingsForm(user)\r\n                ? {\r\n                  icon: PersonIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodePermissions\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setPermissionsNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canManageNodeDashboards(user, nodeId)\r\n                ? {\r\n                  icon: DashboardIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeDashboards\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setDashboardsNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canEditNode(user, nodeId)\r\n                ? {\r\n                  icon: EditIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.editNode\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setNodeFormNodeId(nodeId);\r\n                    setNodeFormVisibility(true);\r\n                    setCacheFormVisibility(false);\r\n                  }\r\n                }\r\n                : null,\r\n            () =>\r\n              canDeleteNodes(user)\r\n                ? {\r\n                  icon: DeleteIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.deleteNode\"),\r\n                  onClick: (_, {nodeId}) => setNodeDeleteFormNodeId(nodeId)\r\n                }\r\n                : null\r\n          ]}\r\n          options={{\r\n            paging: false,\r\n            draggable: true,\r\n            actionsColumnIndex: 4,\r\n            searchFieldAlignment: \"left\",\r\n            maxBodyHeight: 400,\r\n            showTitle: false\r\n          }}\r\n          icons={tableIcons}\r\n        />\r\n      </Box>\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.editNode\")}\r\n        open={isNodeFormVisible}\r\n        onClose={() => {\r\n          if (nodeFormRef.current) {\r\n            nodeFormRef.current.cancel(() => {\r\n              setNodeFormVisibility(false);\r\n              setNodeFormNodeId(null);\r\n            });\r\n          } else {\r\n            setNodeFormVisibility(false);\r\n            setNodeFormNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (nodeFormRef.current) {\r\n            nodeFormRef.current.submit(() => {\r\n              setNodeFormVisibility(false);\r\n              setNodeFormNodeId(null);\r\n            });\r\n          } else {\r\n            setNodeFormVisibility(false);\r\n            setNodeFormNodeId(null);\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <NodeSettingsForm ref={nodeFormRef} nodeId={nodeFormNodeId}/>\r\n\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeCache\", {nodeCode: config.find(node => node.nodeId === cacheFormNodeId)?.code})}\r\n        open={isCacheFormVisible}\r\n        onClose={() => {\r\n          if (cacheFormRef.current) {\r\n            cacheFormRef.current.cancel(() => {\r\n              setCacheFormVisibility(false);\r\n              setCacheFormNodeId(null);\r\n            });\r\n          } else {\r\n            setCacheFormVisibility(false);\r\n            setCacheFormNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (cacheFormRef.current) {\r\n            cacheFormRef.current.submit(() => {\r\n              setCacheFormVisibility(false);\r\n              setCacheFormNodeId(null);\r\n            });\r\n          } else {\r\n            setCacheFormVisibility(false);\r\n            setCacheFormNodeId(null);\r\n          }\r\n        }}\r\n        false\r\n      >\r\n        <CacheSettingsForm ref={cacheFormRef} nodeId={cacheFormNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeTemplates\", {nodeCode: config.find(node => node.nodeId === templatesNodeId)?.code})}\r\n        open={templatesNodeId !== null}\r\n        onClose={() => {\r\n          if (templatesRef.current) {\r\n            templatesRef.current.cancel(() => setTemplatesNodeId(null));\r\n          } else {\r\n            setTemplatesNodeId(null);\r\n          }\r\n        }}\r\n        maxWidth=\"md\"\r\n      >\r\n        <TemplatesSettingsForm\r\n          ref={templatesRef}\r\n          nodeId={templatesNodeId}\r\n          nodes={config}\r\n          onTemplatesClose={() => {\r\n            setTemplatesNodeId(null);\r\n            onNodesClose();\r\n          }}\r\n        />\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodePermissions\", {nodeCode: config.find(node => node.nodeId === permissionsNodeId)?.code})}\r\n        open={permissionsNodeId !== null}\r\n        onClose={() => {\r\n          if (permissionsRef.current) {\r\n            permissionsRef.current.cancel(() => {\r\n              setPermissionsNodeId(null);\r\n            });\r\n          } else {\r\n            setPermissionsNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (permissionsRef.current) {\r\n            permissionsRef.current.submit(() => {\r\n              setPermissionsNodeId(null);\r\n            });\r\n          } else {\r\n            setPermissionsNodeId(null);\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <PermissionsSettingsForm ref={permissionsRef} nodeId={permissionsNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeDashboards\", {nodeCode: config.find(node => node.nodeId === dashboardsNodeId)?.code})}\r\n        open={dashboardsNodeId !== null}\r\n        onClose={() => {\r\n          if (dashboardsRef.current) {\r\n            dashboardsRef.current.destroy(() => {\r\n              setDashboardsNodeId(null);\r\n            });\r\n          } else {\r\n            setDashboardsNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (dashboardsRef.current) {\r\n            dashboardsRef.current.destroy(() => {\r\n              setDashboardsNodeId(null);\r\n            });\r\n          } else {\r\n            setDashboardsNodeId(null);\r\n          }\r\n        }}\r\n      >\r\n        <DashboardsSettingsForm ref={dashboardsRef} nodeId={dashboardsNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={nodeDeleteFormNodeId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.nodesSettings.modals.nodeDelete.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.nodesSettings.modals.nodeDelete.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setNodeDeleteFormNodeId(null);\r\n            setCacheFormNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteNode(nodeDeleteFormNodeId);\r\n            setNodeDeleteFormNodeId(null);\r\n            setCacheFormNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(NodesSettingsForm);","import React, {forwardRef, useEffect, useImperativeHandle, useRef, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport SettingsDialog from \"../../settings-dialog\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {compose} from \"redux\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport UserSettingsForm from \"./user-settings-form\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUsersConfigUsers,\r\n  deleteUsersConfigUser,\r\n  fetchUsersConfigUsers,\r\n  hideUserConfigForm,\r\n  showUserConfigForm\r\n} from \"../../../state/usersConfig/usersConfigActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {MTableToolbar} from \"material-table\";\r\nimport \"./style.css\";\r\nimport {localizeI18nObj} from \"../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.users,\r\n  userErrors: state.usersConfig.userErrors,\r\n  userId: state.usersConfig.userId,\r\n  appConfig: state.appConfig,\r\n  languages: state.app.languages,\r\n  language: state.app.language\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: () => dispatch(fetchUsersConfigUsers()),\r\n  deleteUser: userId => dispatch(deleteUsersConfigUser(userId)),\r\n  clearConfig: () => dispatch(clearUsersConfigUsers()),\r\n  onUserFormShow: userId => dispatch(showUserConfigForm(userId)),\r\n  onUserFormHide: () => dispatch(hideUserConfigForm())\r\n});\r\n\r\nconst UsersSettingsForm = ({classes, config, fetchConfig, deleteUser, clearConfig, users, userErrors, userId, onUserFormShow, onUserFormHide, appConfig, languages, language}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearConfig();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [userDeleteFormUserId, setUserDeleteFormUserId] = useState(null);\r\n\r\n  const userFormRef = useRef();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return config && (\r\n    <div className=\"users-settings-form__table\">\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n          Toolbar: props =>\r\n            <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n              <Grid item>\r\n                <MTableToolbar {...props} />\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  size=\"small\"\r\n                  startIcon={<AddIcon/>}\r\n                  onClick={() => onUserFormShow(-1)}>\r\n                  {t(\"scenes.usersSettings.createUser\")}\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n        }}\r\n        columns={[\r\n          {field: \"firstName\", title: t(\"scenes.usersSettings.table.columns.userFirstName\")},\r\n          {field: \"lastName\", title: t(\"scenes.usersSettings.table.columns.userLastName\")},\r\n          {\r\n            field: \"type\",\r\n            title: t(\"scenes.usersSettings.table.columns.type\"),\r\n            render: ({type}) => localizeI18nObj(appConfig?.user?.typeOptions?.find(({id}) => type === id)?.label, language, languages)\r\n          },\r\n          {field: \"organization\", title: t(\"scenes.usersSettings.table.columns.userOrganization\")},\r\n          {field: \"email\", title: t(\"scenes.usersSettings.table.columns.userEmail\")},\r\n          {\r\n            field: \"isActive\",\r\n            title: t(\"scenes.usersSettings.table.columns.isActive.title\"),\r\n            render: ({isActive}) =>\r\n              isActive\r\n                ? t(\"scenes.usersSettings.table.columns.isActive.values.true\")\r\n                : t(\"scenes.usersSettings.table.columns.isActive.values.false\")\r\n          }\r\n        ]}\r\n        data={config}\r\n        actions={[\r\n          {\r\n            icon: EditIcon,\r\n            tooltip: t(\"scenes.usersSettings.table.actions.editUser\"),\r\n            onClick: (_, {userId}) => {\r\n              onUserFormShow(userId);\r\n            }\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.usersSettings.table.actions.deleteUser\"),\r\n            onClick: (_, {userId}) => {\r\n              setUserDeleteFormUserId(userId);\r\n            }\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 5,\r\n          searchFieldAlignment: \"left\",\r\n          maxBodyHeight: 400,\r\n          showTitle: false\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n      <SettingsDialog\r\n        title={\r\n          userId === -1\r\n            ? t(\"scenes.usersSettings.modals.createUser\")\r\n            : t(\"scenes.usersSettings.modals.editUser\")\r\n        }\r\n        maxWidth={\"sm\"}\r\n        open={userId !== null || userErrors !== null}\r\n        onClose={() => {\r\n          if (userFormRef.current) {\r\n            userFormRef.current.cancel(() => {\r\n              onUserFormHide();\r\n            });\r\n          } else {\r\n            onUserFormHide();\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (userFormRef.current) {\r\n            userFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <UserSettingsForm ref={userFormRef} userId={userId}/>\r\n      </SettingsDialog>\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={userDeleteFormUserId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.usersSettings.modals.deleteUser.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.usersSettings.modals.deleteUser.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setUserDeleteFormUserId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteUser(userDeleteFormUserId);\r\n            setUserDeleteFormUserId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}),\r\n  forwardRef\r\n)(UsersSettingsForm);","import React, {Fragment} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport AppSettingsForm from \"./app-settings-form\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport NodesSettingsForm from \"./nodes-settings-form\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {clearMemoryCache, downloadQueryLog} from \"./actions\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport Input from \"@material-ui/core/Input\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport UsersSettingsForm from \"./users-settings-form\";\r\nimport {\r\n  canDisplayAppSettingsForm,\r\n  canDisplayNodesSettingsForm,\r\n  canDisplayUsersSettingsForm,\r\n  canGetQueryLog\r\n} from \"../../utils/user\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  option: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onLogDownload: limit => dispatch(downloadQueryLog(limit)),\r\n  onCacheClear: () => dispatch(clearMemoryCache())\r\n});\r\n\r\nclass SettingsSelect extends React.Component {\r\n\r\n  state = {\r\n    isAppOpen: false,\r\n    isNodesOpen: false,\r\n    isUsersOpen: false,\r\n    appSettingsRef: React.createRef(),\r\n    nodesSettingsRef: React.createRef(),\r\n    usersSettingsRef: React.createRef(),\r\n    isLogDownloadOpen: false,\r\n    logLimit: 5,\r\n  };\r\n\r\n  onAppOpen = () => this.setState({\r\n    ...this.state,\r\n    isAppOpen: true\r\n  });\r\n\r\n  onAppClose = showSnackbar => this.setState({\r\n    ...this.state,\r\n    isAppOpen: false,\r\n    isAppSubmitSnackbarVisible: showSnackbar || false\r\n  });\r\n\r\n  onNodesOpen = () => this.setState({\r\n    ...this.state,\r\n    isNodesOpen: true\r\n  });\r\n\r\n  onNodesClose = () => this.setState({\r\n    ...this.state,\r\n    isNodesOpen: false\r\n  });\r\n\r\n  onUsersOpen = () => this.setState({\r\n    ...this.state,\r\n    isUsersOpen: true\r\n  });\r\n\r\n  onUsersClose = () => this.setState({\r\n    ...this.state,\r\n    isUsersOpen: false\r\n  });\r\n\r\n  onLogDownloadOpen = () => this.setState({\r\n    ...this.state,\r\n    isLogDownloadOpen: true\r\n  });\r\n\r\n  onLogDownloadClose = () => this.setState({\r\n    ...this.state,\r\n    isLogDownloadOpen: false,\r\n    logLimit: 5\r\n  });\r\n\r\n  onLogLimitSet = logLimit => {\r\n    if (!isNaN(logLimit)) {\r\n      this.setState({\r\n        ...this.state,\r\n        logLimit: logLimit\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      onLogDownload,\r\n      nodes,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {\r\n      isAppOpen,\r\n      isNodesOpen,\r\n      isUsersOpen,\r\n      appSettingsRef,\r\n      nodesSettingsRef,\r\n      usersSettingsRef,\r\n      isLogDownloadOpen,\r\n      logLimit\r\n    } = this.state;\r\n\r\n    return (\r\n      <Fragment>\r\n        <ButtonSelect value=\"\" icon={<SettingsIcon/>}>\r\n          {canDisplayAppSettingsForm(user) && (\r\n            <div onClick={this.onAppOpen} className={classes.option}>{t(\"components.header.settings.app\")}</div>\r\n          )}\r\n          {canDisplayUsersSettingsForm(user) && (\r\n            <div onClick={this.onUsersOpen} className={classes.option}>{t(\"components.header.settings.users\")}</div>\r\n          )}\r\n          {canDisplayNodesSettingsForm(user) && (\r\n            <div onClick={this.onNodesOpen} className={classes.option}>{t(\"components.header.settings.nodes\")}</div>\r\n          )}\r\n          {canGetQueryLog(user) && (\r\n            <div onClick={this.onLogDownloadOpen}\r\n                 className={classes.option}>{t(\"components.header.settings.queriesLog\")}</div>\r\n          )}\r\n          {/*{canClearServerCache(user) && (\r\n            <div onClick={onCacheClear}\r\n                 className={classes.option}>{t(\"components.header.settings.clearServerCache\")}</div>\r\n          )}*/}\r\n        </ButtonSelect>\r\n        <SettingsDialog\r\n          title={t(\"scenes.appSettings.title\")}\r\n          open={isAppOpen}\r\n          onClose={() => {\r\n            if (appSettingsRef.current) {\r\n              appSettingsRef.current.cancel(() => this.onAppClose());\r\n            } else {\r\n              this.onAppClose();\r\n            }\r\n          }}\r\n          onSubmit={() => {\r\n            if (appSettingsRef.current) {\r\n              appSettingsRef.current.submit(() => {\r\n                this.onAppClose();\r\n              });\r\n            } else {\r\n              this.onAppClose();\r\n            }\r\n          }}\r\n          hasSubmit\r\n        >\r\n          <AppSettingsForm ref={appSettingsRef}/>\r\n        </SettingsDialog>\r\n        <SettingsDialog\r\n          title={t(\"scenes.nodesSettings.title\")}\r\n          open={isNodesOpen}\r\n          onClose={() => {\r\n            if (nodesSettingsRef.current) {\r\n              nodesSettingsRef.current.cancel(() => this.onNodesClose());\r\n            } else {\r\n              this.onNodesClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <NodesSettingsForm ref={nodesSettingsRef} nodes={nodes} onNodesClose={this.onNodesClose}/>\r\n        </SettingsDialog>\r\n\r\n        <SettingsDialog\r\n          title={t(\"scenes.usersSettings.title\")}\r\n          open={isUsersOpen}\r\n          onClose={() => {\r\n            if (usersSettingsRef.current) {\r\n              usersSettingsRef.current.cancel(() => this.onUsersClose());\r\n            } else {\r\n              this.onUsersClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <UsersSettingsForm ref={usersSettingsRef}/>\r\n        </SettingsDialog>\r\n\r\n        <Dialog\r\n          open={isLogDownloadOpen}\r\n          onClose={this.onLogDownloadClose}\r\n        >\r\n          <DialogContent>\r\n            <Grid container spacing={2} style={{width: 400}}>\r\n              <Grid item xs={12}>\r\n                <div>{t(\"components.header.settings.queriesLogModal.content\")}:</div>\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <Input\r\n                  value={logLimit}\r\n                  onChange={ev => this.onLogLimitSet(ev.target.value)}\r\n                  style={{width: \"100%\"}}\r\n                />\r\n              </Grid>\r\n            </Grid>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={this.onLogDownloadClose}>\r\n              {t(\"commons.confirm.cancel\")}\r\n            </Button>\r\n            <Button\r\n              autoFocus\r\n              onClick={() => {\r\n                this.onLogDownloadClose()\r\n                onLogDownload(logLimit);\r\n              }}\r\n              color=\"primary\">\r\n              {t(\"commons.confirm.download\")}\r\n            </Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(SettingsSelect);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getClearMemoryCacheUrl, getQueryLog} from \"../../serverApi/urls\";\r\n\r\nexport const QUERY_LOG_DOWNLOAD = \"query/log/download\";\r\nexport const MEMORY_CACHE_CLEAR = \"memory/cache/clear\";\r\n\r\nexport const downloadQueryLog = limit => initRequest(\r\n  QUERY_LOG_DOWNLOAD,\r\n  getQueryLog(limit),\r\n  RequestMethod.GET,\r\n  null,\r\n  null,\r\n  {\r\n    fileSave: {\r\n      name: \"sdmx-query-log.txt\",\r\n      type: \"text/plain;charset=utf-8\"\r\n    },\r\n    stringifyResponse: true\r\n  }\r\n);\r\n\r\nexport const clearMemoryCache = () => initRequest(\r\n  MEMORY_CACHE_CLEAR,\r\n  getClearMemoryCacheUrl(),\r\n  RequestMethod.POST,\r\n  null,\r\n  t => ({\r\n    onStart: t(\"components.header.settings.clearServerCacheAction.messages.clear.start\")\r\n  })\r\n);\r\n","import React, {useRef} from 'react';\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\n\r\nconst styles = theme => ({\r\n  button: {\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: \"#f5f5f5\",\r\n    borderColor: theme.palette.primary.main,\r\n    borderWidth: 1,\r\n    position: \"relative\",\r\n    height: 35,\r\n  },\r\n  icon: {\r\n    width: theme.spacing(6),\r\n    height: 35,\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    position: 'absolute',\r\n    width: `calc(100% - ${theme.spacing(6)})`,\r\n    left: theme.spacing(6)\r\n  },\r\n  inputInput: {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n  }\r\n});\r\n\r\nconst SearchInput = ({classes, query = \"\", onSubmit}) => {\r\n\r\n  const input = useRef(null);\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <div className={classes.button} style={{width: 320}}>\r\n      <label htmlFor=\"search-input\" style={{display: \"none\"}}>\r\n        {t(\"components.searchInput.label\")}\r\n      </label>\r\n      <TextField\r\n        id=\"search-input\"\r\n        fullWidth\r\n        size=\"small\"\r\n        variant=\"outlined\"\r\n        placeholder={t(\"components.searchInput.placeholder\")}\r\n        defaultValue={query}\r\n        InputProps={{\r\n          startAdornment:\r\n            <InputAdornment position=\"start\">\r\n              <SearchIcon/>\r\n            </InputAdornment>,\r\n          inputRef: input,\r\n        }}\r\n        onKeyDown={\r\n          e => {\r\n            if (e.key === \"Enter\" && input.current.value && input.current.value.length > 0) {\r\n              e.preventDefault();\r\n              onSubmit(input.current.value);\r\n            }\r\n          }\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(SearchInput);","import React, {useState} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {fade, withStyles} from \"@material-ui/core\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport SearchInput from \"../search-input\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  button: {\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.15),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.25),\r\n    },\r\n    position: \"relative\",\r\n    height: 35,\r\n  },\r\n  icon: {\r\n    width: theme.spacing(6),\r\n    height: 35,\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    position: 'absolute',\r\n    width: `calc(100% - ${theme.spacing(6)})`,\r\n    left: theme.spacing(6)\r\n  },\r\n  inputInput: {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n  }\r\n});\r\n\r\nconst SearchDialog = ({classes, dialogTop, modalWidth, query, onSubmit}) => {\r\n\r\n  const [uuid] = useState(uuidv4());\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  return (\r\n    <div>\r\n      <IconButton color=\"inherit\" onClick={() => setIsOpen(true)}>\r\n        <SearchIcon/>\r\n      </IconButton>\r\n      <Dialog\r\n        open={isOpen}\r\n        onClose={() => setIsOpen(false)}\r\n        onRendered={() => $(`#search-dialog__dialog__${uuid} input`).focus()}\r\n        PaperProps={{\r\n          style: {\r\n            position: \"absolute\",\r\n            top: dialogTop,\r\n            height: 40\r\n          }\r\n        }}\r\n      >\r\n        <div id={`search-dialog__dialog__${uuid}`}>\r\n          <SearchInput\r\n            query={query}\r\n            onSubmit={value => {\r\n              setIsOpen(false);\r\n              onSubmit(value);\r\n            }}\r\n          />\r\n        </div>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(SearchDialog);","export const DASHBOARD_ELEM_TYPE_KEY = \"type\";\r\nexport const DASHBOARD_ELEM_VALUE_KEY = \"value\";\r\nexport const DASHBOARD_ELEM_WIDTH_KEY = \"widthPercentage\";\r\nexport const DASHBOARD_ELEM_SHOW_TITLE_KEY = \"showTitle\";\r\nexport const DASHBOARD_ELEM_ENABLE_FILTERS_KEY = \"enableFilters\";\r\nexport const DASHBOARD_ELEM_FILTER_DIMENSION_KEY = \"filterDimension\";\r\n\r\nexport const DASHBOARD_ELEM_TYPE_VALUE_VIEW = \"view\";\r\nexport const DASHBOARD_ELEM_TYPE_VALUE_TEXT = \"text\";\r\n\r\nexport const emptyDashboardElem = {\r\n  [DASHBOARD_ELEM_TYPE_KEY]: null,\r\n  [DASHBOARD_ELEM_VALUE_KEY]: null,\r\n  [DASHBOARD_ELEM_WIDTH_KEY]: 100,\r\n  [DASHBOARD_ELEM_SHOW_TITLE_KEY]: true,\r\n  [DASHBOARD_ELEM_ENABLE_FILTERS_KEY]: false,\r\n  [DASHBOARD_ELEM_FILTER_DIMENSION_KEY]: null\r\n};\r\n\r\nexport const getViewIdxFromRowAndCol = (rowIdx, colIdx) => `${rowIdx}+${colIdx}`;\r\n\r\nexport const getFilterDimensionId = (layout, filterDimensionIds) => {\r\n  const dimArraysKey = [\"rows\", \"cols\", \"filters\", \"sections\", \"primaryDim\", \"secondaryDim\", \"territoryDim\"];\r\n  let viewDims = [];\r\n\r\n  dimArraysKey.forEach(key => viewDims = viewDims.concat(layout[key] || []));\r\n\r\n  return (filterDimensionIds.find(dimId => viewDims.includes(dimId)) || null);\r\n};","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  getCreateDashboardUrl,\r\n  getDashboardsUrl,\r\n  getDatasetUrl,\r\n  getDeleteDashboardUrl,\r\n  getDeleteViewUrl,\r\n  getGeometryUrl,\r\n  getUpdateDashboardUrl,\r\n  getUserDashboardsUrl,\r\n  getViewsUrl\r\n} from \"../../serverApi/urls\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY\r\n} from \"../../utils/dashboards\";\r\nimport {getCriteriaArrayFromObject} from \"../../utils/criteria\";\r\nimport _ from \"lodash\"\r\nimport filters from \"../../dummy/filters.json\";\r\n\r\nexport const OTHER_CONFIG_VIEWS_FETCH = \"otherConfig/fetchViews\";\r\nexport const OTHER_CONFIG_VIEWS_CLEAR = \"otherConfig/clearViews\";\r\nexport const OTHER_CONFIG_VIEW_DELETE = \"otherConfig/deleteView\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARDS_FETCH = \"otherConfig/fetchDashboards\";\r\nexport const OTHER_CONFIG_DASHBOARDS_CLEAR = \"otherConfig/clearDashboards\";\r\nexport const OTHER_CONFIG_DASHBOARDS_CLOSE = \"otherConfig/closeDashboards\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_CREATE = \"otherConfig/dashboard/create\";\r\nexport const OTHER_CONFIG_DASHBOARD_UPDATE = \"otherConfig/dashboard/update\";\r\nexport const OTHER_CONFIG_DASHBOARD_CHANGE = \"otherConfig/dashboard/change\";\r\nexport const OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT = \"otherConfig/dashboard/create/submit\";\r\nexport const OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT = \"otherConfig/dashboard/update/submit\";\r\nexport const OTHER_CONFIG_DASHBOARD_HIDE = \"otherConfig/dashboard/hide\";\r\nexport const OTHER_CONFIG_DASHBOARD_DELETE = \"otherConfig/dashboard/create\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_VIEWS_FETCH = \"otherConfig/dashboard/views/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR = \"otherConfig/dashboard/views/clear\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_DATASET_FETCH = \"otherConfig/dashboard/dataset/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_DATASET_FILTER_SET = \"otherConfig/dashboard/dataset/filter/set\";\r\nexport const OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH = \"otherConfig/dashboard/map/geometry/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_DATASET_CLEAR = \"otherConfig/dashboard/dataset/clear\";\r\n\r\nexport const fetchOtherConfigViews = () => initRequest(\r\n  OTHER_CONFIG_VIEWS_FETCH,\r\n  getViewsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.viewsConfig.messages.fetchViews.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigViews = () => ({\r\n  type: OTHER_CONFIG_VIEWS_CLEAR\r\n});\r\n\r\nexport const deleteOtherConfigView = (nodeId: number, id: number) => initRequest(\r\n  OTHER_CONFIG_VIEW_DELETE,\r\n  getDeleteViewUrl(nodeId, id),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.viewsConfig.messages.deleteView.start\")\r\n  })\r\n);\r\n\r\nexport const fetchOtherConfigDashboards = () => initRequest(\r\n  OTHER_CONFIG_DASHBOARDS_FETCH,\r\n  getUserDashboardsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboards.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigDashboards = () => ({\r\n  type: OTHER_CONFIG_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const closeOtherConfigDashboard = () => ({\r\n  type: OTHER_CONFIG_DASHBOARDS_CLOSE\r\n});\r\n\r\nexport const createOtherConfigDashboard = (dashboard: any) => ({\r\n  type: OTHER_CONFIG_DASHBOARD_CREATE,\r\n  payload: {\r\n    dashboard: dashboard\r\n  }\r\n});\r\n\r\nexport const updateOtherConfigDashboard = (dashboardId: number) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_UPDATE,\r\n  getDashboardsUrl(dashboardId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboard.start\")\r\n  })\r\n);\r\n\r\nexport const changeOtherConfigDashboard = (dashboard: any) => ({\r\n  type: OTHER_CONFIG_DASHBOARD_CHANGE,\r\n  payload: {\r\n    dashboard: dashboard\r\n  }\r\n});\r\n\r\nconst getNewDashboard = (dashboard: any, dashboardId?: number) => {\r\n  const newDashboard = _.cloneDeep(dashboard);\r\n  const ids: string[] = [];\r\n\r\n  newDashboard.dashboardConfig.forEach((row: any, rowIdx: number) => {\r\n    row.forEach((col: any, colIdx: number) => {\r\n      const type = col[DASHBOARD_ELEM_TYPE_KEY];\r\n      const value = col[DASHBOARD_ELEM_VALUE_KEY];\r\n      const filterDimension = col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY]\r\n\r\n      if (type === DASHBOARD_ELEM_TYPE_VALUE_VIEW && value !== null && value !== undefined && !ids.includes(value)) {\r\n        ids.push(value)\r\n      }\r\n      if (filterDimension === \"\") {\r\n        newDashboard.dashboardConfig[rowIdx][colIdx].filterDimension = null;\r\n      }\r\n    });\r\n  });\r\n\r\n  let newFilterLevels = {};\r\n  filters.labels.forEach((label: string) => {\r\n    newFilterLevels = {\r\n      ...newFilterLevels,\r\n      [label]: (newDashboard.filterLevels[label] || false)\r\n    }\r\n  });\r\n\r\n  return {\r\n    dashboardId: dashboardId,\r\n    title: newDashboard.title,\r\n    dashboardConfig: JSON.stringify(newDashboard.dashboardConfig),\r\n    viewIds: ids,\r\n    filterLevels: JSON.stringify(newFilterLevels)\r\n  }\r\n};\r\n\r\nexport const submitOtherConfigDashboardCreate = (dashboard: any) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT,\r\n  getCreateDashboardUrl(),\r\n  RequestMethod.POST,\r\n  getNewDashboard(dashboard),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.submitDashboardCreate.start\")\r\n  })\r\n);\r\n\r\nexport const submitOtherConfigDashboardUpdate = (dashboardId: number, dashboard: any) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  getUpdateDashboardUrl(dashboardId),\r\n  RequestMethod.PUT,\r\n  getNewDashboard(dashboard, dashboardId),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.submitDashboardUpdate.start\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId\r\n  }\r\n);\r\n\r\nexport const deleteOtherConfigDashboard = (dashboardId: number) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_DELETE,\r\n  getDeleteDashboardUrl(dashboardId),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.deleteDashboard.start\")\r\n  })\r\n);\r\n\r\nexport const hideOtherConfigDashboard = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_HIDE\r\n});\r\n\r\nexport const fetchOtherConfigDashboardViews = () => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_FETCH,\r\n  getViewsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboardViews.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigDashboardViews = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR\r\n});\r\n\r\nexport const fetchOtherConfigDashboardsDataset = (nodeId: number, datasetId: string, criteria: any, requestIds: string[]) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_DATASET_FETCH,\r\n  getDatasetUrl(nodeId, datasetId),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDataset\")\r\n  }),\r\n  {\r\n    requestIds: requestIds,\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const setOtherConfigDashboardsDatasetFilter = (viewIdx: string, dimension: string, value: string) => ({\r\n  type: OTHER_CONFIG_DASHBOARD_DATASET_FILTER_SET,\r\n  payload: {\r\n    viewIdx,\r\n    dimension,\r\n    value\r\n  }\r\n});\r\n\r\nexport const fetchOtherConfigDashboardsMapGeometries = (viewIdx: string, idList: string[], t: any) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dashboard.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    viewIdx: viewIdx,\r\n    t: t\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const clearOtherConfigDashboardsDataset = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_DATASET_CLEAR\r\n});","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {Visibility} from \"@material-ui/icons\";\r\nimport {\r\n  clearOtherConfigViews,\r\n  deleteOtherConfigView,\r\n  fetchOtherConfigViews\r\n} from \"../../../state/otherConfig/otherConfigActions\";\r\nimport {goToData} from \"../../../links\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  views: state.otherConfig.views\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchViews: () => dispatch(fetchOtherConfigViews()),\r\n  clearViews: () => dispatch(clearOtherConfigViews()),\r\n  deleteView: (nodeId, id) => dispatch(deleteOtherConfigView(nodeId, id))\r\n});\r\n\r\nconst ViewsSettingsForm = ({\r\n                             classes,\r\n                             defaultLanguage,\r\n                             languages,\r\n                             views,\r\n                             fetchViews,\r\n                             clearViews,\r\n                             deleteView,\r\n                             nodes,\r\n                             onViewsClose\r\n                           }, ref) => {\r\n\r\n  const [needViews, setNeedViews] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needViews) {\r\n      setNeedViews(false);\r\n      fetchViews();\r\n    }\r\n  }, [views, needViews, setNeedViews, fetchViews]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearViews();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [deleteViewId, setDeleteViewId] = useState(null);\r\n  const [deleteViewNodeId, setDeleteViewNodeId] = useState(null);\r\n\r\n  return nodes && views && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"nodeId\",\r\n            title: t(\"scenes.viewsSettings.table.columns.viewNodeId\"),\r\n            render: ({nodeId}) => nodes.find(node => node.nodeId === nodeId).code,\r\n            customFilterAndSearch: (str, {nodeId}) =>\r\n              nodes.find(node => node.nodeId === nodeId).code.toLowerCase()\r\n                .includes(str.toLowerCase())\r\n          },\r\n          {field: \"datasetId\", title: t(\"scenes.viewsSettings.table.columns.viewDatasetId\")},\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.viewsSettings.table.columns.viewTitle\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          },\r\n        ]}\r\n        data={views}\r\n        actions={[\r\n          {\r\n            icon: Visibility,\r\n            tooltip: t(\"scenes.viewsSettings.table.actions.viewView\"),\r\n            onClick: (_, {nodeId, datasetId, viewTemplateId}) => window.location.href.toLowerCase().includes(`view=${viewTemplateId}`)\r\n              ? onViewsClose()\r\n              : goToData(nodes.find(node => node.nodeId === nodeId).code, [], datasetId, viewTemplateId)\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.viewsSettings.table.actions.deleteView\"),\r\n            onClick: (_, {nodeId, viewTemplateId}) => {\r\n              setDeleteViewId(viewTemplateId);\r\n              setDeleteViewNodeId(nodeId);\r\n            }\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 3,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteViewId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.viewsSettings.modals.deleteView.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.viewsSettings.modals.deleteView.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setDeleteViewId(null);\r\n            setDeleteViewNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteView(deleteViewNodeId, deleteViewId);\r\n            setDeleteViewId(null);\r\n            setDeleteViewNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(ViewsSettingsForm);","const $ = window.jQuery;\r\n\r\n/* https://stackoverflow.com/questions/986937/how-can-i-get-the-browsers-scrollbar-sizes */\r\nexport function getScrollBarWidth() {\r\n  const temp = $('<div>').css({visibility: 'hidden', width: 100, overflow: 'scroll'}).appendTo('body');\r\n  const widthWithScroll = $('<div>').css({width: '100%'}).appendTo(temp).outerWidth();\r\n  temp.remove();\r\n  return 100 - widthWithScroll;\r\n}\r\n\r\nexport function getTextWidth(text, element) {\r\n  if (typeof (text) === \"string\" && text.length > 0) {\r\n    element.innerText = text;\r\n    return element.offsetWidth;\r\n  } else {\r\n    return 0;\r\n  }\r\n}\r\n","import React, {Fragment} from 'react';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport \"./style.css\";\r\n\r\nexport const SORT_DIRECTION_ASC = 'SORT_DIRECTION_ASC';\r\nexport const SORT_DIRECTION_DESC = 'SORT_DIRECTION_DESC';\r\n\r\nconst SortButtons = ({\r\n                       value,\r\n                       onChange\r\n                     }) =>\r\n  <Fragment>\r\n    <div className=\"infinite-scroll-table__header__sort-buttons__icon-container\">\r\n      <IconButton\r\n        onClick={() => onChange(value !== SORT_DIRECTION_ASC ? SORT_DIRECTION_ASC : SORT_DIRECTION_DESC)}\r\n        style={{padding: 4, top: -4}}\r\n      >\r\n        {\r\n          value === SORT_DIRECTION_ASC\r\n            ? <ArrowUpwardIcon className=\"infinite-scroll-table__header__icon\"/>\r\n            : <ArrowDownwardIcon className=\"infinite-scroll-table__header__icon\"/>\r\n        }\r\n      </IconButton>\r\n    </div>\r\n  </Fragment>;\r\n\r\nexport default SortButtons;\r\n","export const DEFAULT_TABLE_HEIGHT = 340;\r\nexport const ROW_HEIGHT = 40;\r\nexport const TABLE_TOTAL_BORDER = 2;\r\n\r\nexport const ACTIONS_GUTTER = 4;\r\nexport const ACTION_WIDTH = 24;\r\nexport const CELL_PADDING = 8;\r\nexport const CHECKBOX_WIDTH = 40;\r\nexport const COL_WIDTH_SAFE = 4;\r\nexport const HEADER_CELL_PADDING = 8;\r\nexport const HEADER_CELL_GUTTER = 4;\r\nexport const HEADER_CELL_CONTROLS_GUTTER = 4;\r\nexport const FILTER_BUTTON_WIDTH = 16;\r\nexport const SORT_BUTTON_WIDTH = 16;\r\n\r\nexport const DATA_INDEX_ACTIONS_OBJS = \"_actions\";\r\nexport const DATA_INDEX_FIXED_ACTIONS_OBJS = \"_fixedActions\";\r\nexport const DATA_INDEX_CHECKED = \"_checked\";\r\nexport const DATA_INDEX_RENDERED = \"__rendered\";\r\nexport const DATA_INDEX_ORIGINAL_ROW = \"__originalRow\";\r\nexport const DATA_INDEX_ORIGINAL_TRANSLATED_ROW = \"__originalTranslatedRow\";\r\n\r\nexport const RESIZE_TIMEOUT = 1000;\r\nexport const PAGINATION_TIMEOUT = 500;\r\nexport const VIEW_INDEXES_UPDATE_TIMEOUT = 200;\r\n\r\nexport const MAX_PAGE_SIZE = 200;\r\n\r\nexport const DEFAULT_PAGE_SIZE = Math.floor(MAX_PAGE_SIZE / 3) * 3;\r\nexport const DEFAULT_PAGE_NUM = 1;\r\n\r\nexport const TABLE_PLACEHOLDER_BGCOLOR = \"#fafafa\";\r\n","export const getIndexesFromPaginationParams = (pageSize, pageNum) => ({\r\n  startIdx: pageSize * (pageNum - 1),\r\n  stopIdx: (pageSize * pageNum) - 1\r\n});\r\n\r\nexport const getPaginationParamsFromIndexes = (startIdx, stopIdx, maxIdx) => {\r\n\r\n  const minPageSize = stopIdx - startIdx + 1;\r\n  const maxPageSize = maxIdx + 1;\r\n\r\n  const pageNumForMinPageSize = (stopIdx + 1) / minPageSize;\r\n\r\n  if (Number.isInteger(pageNumForMinPageSize)) {\r\n    return ({\r\n      pageSize: minPageSize,\r\n      pageNum: pageNumForMinPageSize\r\n    });\r\n  } else {\r\n\r\n    for (let pageSize = minPageSize + 1; pageSize <= maxPageSize; pageSize++) {\r\n\r\n      const minPageNum = Math.ceil((stopIdx + 1) / pageSize);\r\n      const maxPageNum = Math.floor((startIdx / pageSize) + 1);\r\n\r\n      for (let pageNum = minPageNum; pageNum <= maxPageNum; pageNum++) {\r\n\r\n        const indexes = getIndexesFromPaginationParams(pageSize, pageNum);\r\n\r\n        if (indexes.startIdx <= startIdx && stopIdx <= indexes.stopIdx) {\r\n          return ({\r\n            pageSize,\r\n            pageNum\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n","import React from 'react';\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst AUTO_SEARCH_INPUT_TIMEOUT = 500;\r\n\r\nclass AutoSearchInput extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      tempValue: props.value || \"\",\r\n      value: props.value || \"\",\r\n      timeout: null\r\n    };\r\n    this.onChange = this.onChange.bind(this);\r\n    this.onClear = this.onClear.bind(this);\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, state) {\r\n\r\n    if (nextProps.value !== undefined && (nextProps.value !== state.value)) {\r\n      if (state.timeout) {\r\n        clearTimeout(state.timeout)\r\n      }\r\n      return ({\r\n        tempValue: null,\r\n        value: nextProps.value\r\n      });\r\n    } else {\r\n      return null;\r\n    }\r\n\r\n  }\r\n\r\n  onClear() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n    this.setState({\r\n      tempValue: null,\r\n      value: \"\",\r\n      timeout: null\r\n    });\r\n    this.props.onSearch(\"\");\r\n  }\r\n\r\n  onChange(value) {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n    this.setState({\r\n      tempValue: value,\r\n      timeout: setTimeout(\r\n        () => {\r\n          this.setState({\r\n            tempValue: null,\r\n            value\r\n          });\r\n          this.props.onSearch(value);\r\n        },\r\n        AUTO_SEARCH_INPUT_TIMEOUT\r\n      ),\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      t,\r\n      placeholder\r\n    } = this.props;\r\n\r\n    const {\r\n      tempValue,\r\n      value\r\n    } = this.state;\r\n\r\n    return (\r\n      <TextField\r\n        value={tempValue !== null ? tempValue : value}\r\n        placeholder={placeholder || (t(\"components.autoSearchInput.placeholder\") + \"...\")}\r\n        onChange={({target}) => this.onChange(target.value)}\r\n        InputProps={{\r\n          startAdornment: (\r\n            <InputAdornment position=\"start\">\r\n              <SearchIcon/>\r\n            </InputAdornment>\r\n          ),\r\n          endAdornment: (\r\n            <InputAdornment position=\"end\">\r\n              <IconButton\r\n                disabled={!value || value.length === 0}\r\n                onClick={this.onClear}\r\n                style={{padding: 6}}\r\n              >\r\n                <ClearIcon fontSize=\"small\"/>\r\n              </IconButton>\r\n            </InputAdornment>\r\n          )\r\n        }}\r\n        style={{width: \"100%\"}}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default withTranslation()(AutoSearchInput);\r\n","import React, {Fragment} from \"react\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport AutoSearchInput from \"../../auto-search-input\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nconst PreHeader = ({\r\n                     t,\r\n                     searchText,\r\n                     onSearch,\r\n                     selectedRowCount,\r\n                     tableActions,\r\n                     renderTableAction,\r\n                     leftActions,\r\n                     rightActions\r\n                   }) =>\r\n  <Grid container style={{marginBottom: 4}}>\r\n    <Grid item xs={6}>\r\n      <Grid container justify=\"space-between\">\r\n        <Grid item>\r\n          {leftActions}\r\n        </Grid>\r\n        <Grid item>\r\n          <Grid container justify=\"flex-end\">\r\n            {tableActions && selectedRowCount > 0 && (\r\n              <Fragment>\r\n                <Grid item style={{padding: \"14px 16px 14px 8px\"}}>\r\n                  {selectedRowCount > 1\r\n                    ? t(\"components.infiniteScrollTable.preHeader.selectedCount_plural\", {selectedRowCount})\r\n                    : t(\"components.infiniteScrollTable.preHeader.selectedCount\", {selectedRowCount})\r\n                  }\r\n                </Grid>\r\n                {tableActions.map((action, index) =>\r\n                  <Grid item key={index}>\r\n                    {renderTableAction(action)}\r\n                  </Grid>\r\n                )}\r\n              </Fragment>\r\n            )}\r\n            {rightActions && (\r\n              <Grid item>\r\n                {rightActions}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n    <Grid item xs={6} style={{padding: \"8px 0\"}}>\r\n      <AutoSearchInput\r\n        value={searchText}\r\n        onSearch={onSearch}\r\n      />\r\n    </Grid>\r\n\r\n  </Grid>;\r\n\r\nexport default withTranslation()(PreHeader);\r\n","import React from \"react\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\n\r\nconst Footer = ({\r\n                  t,\r\n                  isLoading,\r\n                  isHidden,\r\n                  rowNumStart,\r\n                  rowNumEnd,\r\n                  rowCount\r\n                }) =>\r\n  <Grid container justify=\"flex-end\" style={{marginTop: 8}}>\r\n    <Grid item>\r\n      {!isHidden\r\n        ? (\r\n          isLoading\r\n            ? (\r\n              <CircularProgress\r\n                size=\"small\"\r\n                className=\"infinite-scroll-table__footer__spinner\"\r\n                style={{\r\n                  fontSize: 10,\r\n                  width: 13,\r\n                  height: 13,\r\n                  marginRight: 2\r\n                }}\r\n              />\r\n            )\r\n            : t(\"components.infiniteScrollTable.footer.rowCount\", {rowNumStart, rowNumEnd, rowCount})\r\n        )\r\n        : <span/>\r\n      }\r\n    </Grid>\r\n  </Grid>;\r\n\r\nexport default withTranslation()(Footer);\r\n","import React from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"relative\",\r\n    height: \"100%\"\r\n  },\r\n  text: {\r\n    fontStyle: \"italic\",\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%)\"\r\n  },\r\n  image: {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -100%)\",\r\n    paddingBottom: 16\r\n  }\r\n});\r\n\r\nconst CustomEmpty = ({\r\n  t,\r\n                       classes,\r\n                       text,\r\n                       textStyle,\r\n                       width,\r\n                       backgroundColor,\r\n                       color,\r\n                       image\r\n                     }) =>\r\n  <div className={classes.root} style={{width: width || \"100%\", backgroundColor, color}}>\r\n    <div style={{width: width || \"100%\"}}>\r\n      {image && (\r\n        <div className={classes.image}>\r\n          {image}\r\n        </div>\r\n      )}\r\n      <div className={classes.text} style={{...textStyle}}>\r\n        {text || t(\"components.customEmpty.placeholder\")}\r\n      </div>\r\n    </div>\r\n  </div>;\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(CustomEmpty);\r\n","import React, {Fragment, useState} from 'react';\r\nimport \"./style.css\";\r\nimport AutoSearchInput from \"../../auto-search-input\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Popover from \"@material-ui/core/Popover\";\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\n\r\nconst FilterButton = ({\r\n                        value,\r\n                        onChange,\r\n                        options\r\n                      }) => {\r\n\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n\r\n  const handleOpen = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <div className=\"infinite-scroll-table__header__filter-button__icon-container\">\r\n        <IconButton\r\n          onClick={handleOpen}\r\n          style={{padding: 4, top: -4}}\r\n        >\r\n          <FilterListIcon className=\"infinite-scroll-table__header__icon\"/>\r\n        </IconButton>\r\n      </div>\r\n\r\n      <Popover\r\n        open={Boolean(anchorEl)}\r\n        anchorEl={anchorEl}\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'center',\r\n        }}\r\n        transformOrigin={{\r\n          vertical: 'top',\r\n          horizontal: 'center',\r\n        }}\r\n        onClose={handleClose}\r\n      >\r\n        {options && options.length\r\n          ? (\r\n            options.map((option, index) =>\r\n              <Grid\r\n                container\r\n                className=\"infinite-scroll-table__header__filter-button__option\"\r\n                key={index}\r\n              >\r\n                <Grid item>\r\n                  <Checkbox\r\n                    checked={(value || []).find(val => val === option.value) !== undefined}\r\n                    onChange={({target}) => target.checked\r\n                      ? onChange([...(value || []), option.value])\r\n                      : onChange((value || []).filter(val => val !== option.value))\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item>\r\n                  <div style={{height: 42, lineHeight: \"42px\", marginRight: 16}}>\r\n                    {option.text}\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n          )\r\n          : (\r\n            <div style={{padding: 8}}>\r\n              <AutoSearchInput onSearch={onChange} value={value}/>\r\n            </div>\r\n          )\r\n        }\r\n      </Popover>\r\n\r\n    </Fragment>\r\n  )\r\n};\r\n\r\nexport default FilterButton;\r\n","import React, {Component, Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport \"./style.css\";\r\nimport {getScrollBarWidth, getTextWidth} from \"../../utils/style\";\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport SortButtons, {SORT_DIRECTION_ASC, SORT_DIRECTION_DESC} from './sort-buttons';\r\nimport _ from \"lodash\";\r\nimport {FixedSizeList} from \"react-window\";\r\nimport {\r\n  ACTION_WIDTH,\r\n  ACTIONS_GUTTER,\r\n  CELL_PADDING,\r\n  CHECKBOX_WIDTH,\r\n  COL_WIDTH_SAFE,\r\n  DATA_INDEX_ACTIONS_OBJS,\r\n  DATA_INDEX_CHECKED,\r\n  DATA_INDEX_FIXED_ACTIONS_OBJS,\r\n  DATA_INDEX_ORIGINAL_ROW,\r\n  DATA_INDEX_ORIGINAL_TRANSLATED_ROW,\r\n  DATA_INDEX_RENDERED,\r\n  DEFAULT_PAGE_NUM,\r\n  DEFAULT_PAGE_SIZE,\r\n  DEFAULT_TABLE_HEIGHT,\r\n  FILTER_BUTTON_WIDTH,\r\n  HEADER_CELL_CONTROLS_GUTTER,\r\n  HEADER_CELL_GUTTER,\r\n  HEADER_CELL_PADDING,\r\n  MAX_PAGE_SIZE,\r\n  PAGINATION_TIMEOUT,\r\n  RESIZE_TIMEOUT,\r\n  ROW_HEIGHT,\r\n  SORT_BUTTON_WIDTH,\r\n  TABLE_TOTAL_BORDER,\r\n  VIEW_INDEXES_UPDATE_TIMEOUT\r\n} from \"./contants\";\r\nimport {getIndexesFromPaginationParams, getPaginationParamsFromIndexes} from \"./utils\";\r\nimport PreHeader from \"./pre-header\";\r\nimport Footer from \"./footer\";\r\nimport {withSize} from \"react-sizeme\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport FilterButton from \"./filter-button\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nexport const numberStringSorter = (a, b) => Number(a) - Number(b);\r\n\r\nclass InfiniteScrollTable extends Component {\r\n\r\n  constructor(props) {\r\n\r\n    super(props);\r\n\r\n    this.onSearchTextChange = this.onSearchTextChange.bind(this);\r\n    this.onFiltersChange = this.onFiltersChange.bind(this);\r\n    this.onSortChange = this.onSortChange.bind(this);\r\n    this.getSelectedRowKeys = this.getSelectedRowKeys.bind(this);\r\n    this.onRowSelectionChange = this.onRowSelectionChange.bind(this);\r\n    this.getCols = this.getCols.bind(this);\r\n    this.getNormalizedTableActions = this.getNormalizedTableActions.bind(this);\r\n    this.renderActions = this.renderActions.bind(this);\r\n    this.renderGridRow = this.renderGridRow.bind(this);\r\n    this.renderFixedActions = this.renderFixedActions.bind(this);\r\n    this.renderHeaderCells = this.renderHeaderCells.bind(this);\r\n    this.renderCheckboxTitle = this.renderCheckboxTitle.bind(this);\r\n    this.renderCheckbox = this.renderCheckbox.bind(this);\r\n    this.getPopulatedRows = this.getPopulatedRows.bind(this);\r\n    this.getColWidths = this.getColWidths.bind(this);\r\n    this.getQueriedRows = this.getQueriedRows.bind(this);\r\n    this.getRenderedRows = this.getRenderedRows.bind(this);\r\n    this.onRenderedRowsChange = this.onRenderedRowsChange.bind(this);\r\n\r\n    this.state = {\r\n      uuid: uuidv4(),\r\n\r\n      gridKeyForRefresh: uuidv4(),\r\n      scrollTop: 0,\r\n      scrollLeft: 0,\r\n\r\n      gridScrollbarWidth: getScrollBarWidth(),\r\n\r\n      searchText: \"\",\r\n      sortCol: null,\r\n      sortByDesc: false,\r\n      filters: {},\r\n\r\n      selectedRowKeys:\r\n        props.rowSelection && props.rowSelection.selectedRowKeys\r\n          ? props.rowSelection.selectedRowKeys\r\n          : [],\r\n\r\n      cols: null,\r\n\r\n      populatedRows: null,\r\n\r\n      colWidths: null,\r\n\r\n      renderedRows: null,\r\n\r\n      queriedRows: null,\r\n\r\n      isResizing: false,\r\n      resizeTimeout: null,\r\n\r\n      pageSize: null,\r\n      pageNum: null,\r\n      pageRequestTimeout: null,\r\n\r\n      isPaginating: props.isPaginated,\r\n      pageRequestParams: null,\r\n\r\n      viewStartIdx: null,\r\n      viewEndIdx: null,\r\n      viewIndexesUpdateTimeout: null,\r\n\r\n      doNotCallOnChangeOnNextRenderedRowsChange: false\r\n    };\r\n\r\n    if (props.isPaginated) {\r\n      this.state.pageRequestParams = {\r\n        pageSize: DEFAULT_PAGE_SIZE,\r\n        pageNum: DEFAULT_PAGE_NUM,\r\n        filters: this.state.filters,\r\n        searchText: this.state.searchText,\r\n        sortCol: this.state.sortCol,\r\n        sortByDesc: this.state.sortByDesc\r\n      };\r\n    }\r\n\r\n    if (props.onChange && props.isPaginated) {\r\n      props.onChange(this.state.pageRequestParams);\r\n    }\r\n  }\r\n\r\n  static isValuePassingSearchText(value, searchText) {\r\n    return String(value).toLowerCase().includes(searchText.toLowerCase())\r\n  }\r\n\r\n  static defaultSorter = (a, b, isDesc) => {\r\n\r\n    const normalize = val => typeof (val) === \"string\" ? val.toLowerCase() : Number(val);\r\n    const _a = normalize(a);\r\n    const _b = normalize(b);\r\n\r\n    return (isDesc ? (_b < _a) : (_a < _b)) ? -1 : 1\r\n  };\r\n\r\n  static isArrayPropertyChangedLazy(prevProp, prop) {\r\n    return (\r\n      (prevProp !== prop) ||\r\n      ((prevProp === null || prevProp === undefined) && prop !== null && prop !== undefined) ||\r\n      (prevProp && prop && prevProp.length !== prop.length)\r\n    );\r\n  }\r\n\r\n  /* === Hooks === */\r\n\r\n  getPopulatedRows(rows) {\r\n\r\n    const {\r\n      defaultLanguage,\r\n      languages,\r\n      multilangStrDataIndexes,\r\n      actions,\r\n      fixedActions,\r\n      altActions,\r\n      getIsAltRow\r\n    } = this.props;\r\n\r\n    const getActionsObjs = (actions, row) =>\r\n      (actions || [])\r\n        .filter(action => action !== null)\r\n        .map(action => typeof (action) === \"function\" ? action(row) : action)\r\n        .filter(action => action !== null)\r\n        .map(action => ({...action, row}));\r\n\r\n    return (rows !== null && rows !== undefined)\r\n      ? rows.map(row => {\r\n\r\n        const populatedRow = {...row};\r\n\r\n        populatedRow[DATA_INDEX_ORIGINAL_ROW] = {...populatedRow};\r\n\r\n        if (multilangStrDataIndexes) {\r\n          for (let dataIndex of multilangStrDataIndexes) {\r\n            populatedRow[dataIndex] = localizeI18nObj(populatedRow[dataIndex], defaultLanguage, languages);\r\n          }\r\n        }\r\n\r\n        populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW] = {...populatedRow};\r\n\r\n        populatedRow[DATA_INDEX_FIXED_ACTIONS_OBJS] =\r\n          fixedActions\r\n            ? getActionsObjs(fixedActions, populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW])\r\n            : null;\r\n\r\n        populatedRow[DATA_INDEX_ACTIONS_OBJS] =\r\n          (actions || altActions)\r\n            ? getActionsObjs(\r\n            (getIsAltRow && getIsAltRow(populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW])) ? altActions : actions,\r\n            populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW]\r\n            )\r\n            : null;\r\n\r\n        return populatedRow;\r\n\r\n      })\r\n      : null;\r\n  }\r\n\r\n  getColWidths(rows, cols) {\r\n\r\n    const {\r\n      size\r\n    } = this.props;\r\n\r\n    const {\r\n      gridScrollbarWidth\r\n    } = this.state;\r\n\r\n    if (cols === null) {\r\n      return null;\r\n    }\r\n\r\n    const getTextWidthEl = $('<span>').css({visibility: 'hidden', position: 'absolute'}).appendTo('body').get(0);\r\n\r\n    let colWidths = cols.map(col => {\r\n\r\n      let colWidth = 0;\r\n\r\n      const colTitleWidth =\r\n        getTextWidth(col.title, getTextWidthEl) +\r\n        ((!col.noFilter || !col.noSort) ? HEADER_CELL_GUTTER : 0) +\r\n        (col.noFilter ? 0 : FILTER_BUTTON_WIDTH) +\r\n        (col.noSort ? 0 : SORT_BUTTON_WIDTH) +\r\n        ((!col.noFilter && !col.noSort) ? HEADER_CELL_CONTROLS_GUTTER : 0) +\r\n        CELL_PADDING * 2 + COL_WIDTH_SAFE;\r\n\r\n      if (col.width) {\r\n\r\n        colWidth = Math.max(colTitleWidth, col.width);\r\n\r\n      } else if ((col.widthToContent || col.minWidthToContent) && rows.length > 0) {\r\n\r\n        colWidth = Math.max(\r\n          colTitleWidth,\r\n          ...rows.map(row =>\r\n            getTextWidth(\r\n              col.renderText\r\n                ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][col.dataIndex])\r\n                : row[col.dataIndex],\r\n              getTextWidthEl\r\n            ) +\r\n            (CELL_PADDING * 2) +\r\n            COL_WIDTH_SAFE\r\n          )\r\n        );\r\n\r\n      } else if (col.minWidth) {\r\n\r\n        colWidth = Math.max(colTitleWidth, col.minWidth);\r\n\r\n      } else {\r\n\r\n        colWidth = colTitleWidth;\r\n\r\n      }\r\n\r\n      return colWidth;\r\n    });\r\n\r\n    $(getTextWidthEl).remove();\r\n\r\n    const isVariableSizeCol = col => !col.width && (rows.length > 0 ? !col.widthToContent : true);\r\n    const variableSizeCols = cols.filter(isVariableSizeCol);\r\n\r\n    let colWidthsSum = 0;\r\n    colWidths.forEach(width => colWidthsSum += width);\r\n\r\n    const availableWidth = size.width - colWidthsSum -\r\n      ((rows !== null && this.getIsVerticalScrollbarVisible(rows.length)) ? gridScrollbarWidth : 0) -\r\n      TABLE_TOTAL_BORDER;\r\n\r\n    if (variableSizeCols.length > 0 && availableWidth > 0) {\r\n\r\n      const widthToAdd = availableWidth / variableSizeCols.length;\r\n\r\n      colWidths = colWidths.map((colWidth, colIndex) =>\r\n        isVariableSizeCol(cols[colIndex])\r\n          ? colWidth + widthToAdd\r\n          : colWidth\r\n      );\r\n    }\r\n\r\n    return colWidths;\r\n  }\r\n\r\n  getRenderedRows(rows, cols, colsWidths, selectedRowKeys) {\r\n\r\n    const {\r\n      rowSelection,\r\n      tableActions,\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    return rows !== null\r\n      ? rows.map(row => {\r\n\r\n        const resRow = {...row};\r\n\r\n        if (rowSelection || tableActions) {\r\n          resRow[DATA_INDEX_CHECKED] = selectedRowKeys.includes(getRowKey(row))\r\n        }\r\n\r\n        return ({\r\n          ...resRow,\r\n          [DATA_INDEX_RENDERED]: this.renderGridRow(resRow, cols, colsWidths)\r\n        });\r\n      })\r\n      : null;\r\n  }\r\n\r\n  getQueriedRows(rows, cols, filters, searchText, sortCol, sortByDesc) {\r\n\r\n    const {\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    if (isPaginated) {\r\n      return rows;\r\n    } else {\r\n      let queriedRows = this.getFilteredGridRows(rows, cols, filters);\r\n      queriedRows = this.getSearchTextFilteredGridRows(queriedRows, cols, searchText);\r\n      return this.getSortedGridRows(queriedRows, cols, sortCol, sortByDesc);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    const {\r\n      data,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    if (data !== null) {\r\n      const cols = this.getCols();\r\n      const populatedRows = this.getPopulatedRows(data);\r\n      const colWidths = this.getColWidths(populatedRows, cols);\r\n      const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, this.getSelectedRowKeys());\r\n      const queriedRows = this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc, isPaginated);\r\n\r\n      this.setState({\r\n        cols,\r\n        populatedRows,\r\n        colWidths,\r\n        renderedRows,\r\n        queriedRows\r\n      });\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n\r\n    const {\r\n      isPaginated,\r\n      rowSelection,\r\n      data\r\n    } = this.props;\r\n\r\n    const {\r\n      uuid,\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc,\r\n      scrollLeft,\r\n      scrollTop,\r\n      resizeTimeout,\r\n      colWidths,\r\n      cols,\r\n      pageSize,\r\n      pageNum,\r\n      pageRequestParams\r\n    } = this.state;\r\n\r\n    if (InfiniteScrollTable.isArrayPropertyChangedLazy(prevProps.data, data)) { // todo: check for lang change\r\n\r\n      let newCols = null;\r\n      let newPopulatedRows = null;\r\n      let newColWidths = null;\r\n      let newRenderedRows = null;\r\n      let newQueriedRows = null;\r\n      let newScrollTop = null;\r\n\r\n      if (data !== null) {\r\n\r\n        newCols = this.getCols();\r\n        newPopulatedRows = this.getPopulatedRows(this.props.data);\r\n\r\n        newColWidths =\r\n          colWidths !== null && cols !== null && (\r\n            (prevProps.data === null && data === null) ||\r\n            ((prevProps.data !== null && prevProps.data.length === 0) && (data !== null && data.length === 0))\r\n          )\r\n            ? colWidths\r\n            : this.getColWidths(newPopulatedRows, newCols);\r\n        newRenderedRows = this.getRenderedRows(newPopulatedRows, newCols, newColWidths, this.getSelectedRowKeys());\r\n        newQueriedRows = this.getQueriedRows(\r\n          newRenderedRows,\r\n          newCols,\r\n          filters,\r\n          searchText,\r\n          sortCol,\r\n          sortByDesc\r\n        );\r\n      } else {\r\n\r\n        const $grid = $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid`);\r\n        if ($grid) {\r\n          newScrollTop = $grid.scrollTop();\r\n        }\r\n      }\r\n\r\n      this.setState({\r\n        cols: newCols,\r\n        populatedRows: newPopulatedRows,\r\n        colWidths: newColWidths,\r\n        renderedRows: newRenderedRows,\r\n        queriedRows: newQueriedRows,\r\n        pageNum: isPaginated && pageRequestParams ? pageRequestParams.pageNum : pageNum,\r\n        pageSize: isPaginated && pageRequestParams ? pageRequestParams.pageSize : pageSize,\r\n        isPaginating: false,\r\n        pageRequestParams: null,\r\n        scrollTop: newScrollTop,\r\n        selectedRowKeys: this.getSelectedRowKeys()\r\n      });\r\n\r\n    } else if (\r\n      rowSelection &&\r\n      InfiniteScrollTable.isArrayPropertyChangedLazy(\r\n        prevProps.rowSelection.selectedRowKeys,\r\n        rowSelection.selectedRowKeys\r\n      )\r\n    ) {\r\n\r\n      this.setState({\r\n        selectedRowKeys: rowSelection.selectedRowKeys,\r\n      });\r\n      this.updateRenderedRows(rowSelection.selectedRowKeys);\r\n\r\n    } else if (prevProps.size && this.props.size && prevProps.size.width !== this.props.size.width) {\r\n\r\n      if (resizeTimeout) {\r\n        clearTimeout(resizeTimeout);\r\n      }\r\n\r\n      let newScrollTop = null;\r\n      const $grid = $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid`);\r\n      if ($grid) {\r\n        newScrollTop = $grid.scrollTop();\r\n      }\r\n\r\n      this.setState({\r\n        isResizing: true,\r\n        scrollTop: newScrollTop || scrollTop,\r\n        resizeTimeout: setTimeout(\r\n          () => {\r\n            this.setState(state => {\r\n\r\n              const {\r\n                populatedRows,\r\n                cols\r\n              } = state;\r\n\r\n              const colWidths = this.getColWidths(populatedRows, cols);\r\n              const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, this.getSelectedRowKeys());\r\n              const queriedRows = this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc);\r\n\r\n              return {\r\n                gridKeyForRefresh: uuidv4(),\r\n                isResizing: false,\r\n                resizeTimeout: null,\r\n                colWidths,\r\n                renderedRows,\r\n                queriedRows\r\n              };\r\n            });\r\n          },\r\n          RESIZE_TIMEOUT\r\n        )\r\n      });\r\n    }\r\n\r\n    const $grid =\r\n      $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid:not(.infinite-scroll-table__grid--with-event-handlers)`);\r\n\r\n    if ($grid.length) {\r\n\r\n      const _this = this;\r\n\r\n      $grid\r\n        .scrollLeft(scrollLeft)\r\n        .addClass('infinite-scroll-table__grid--with-event-handlers')\r\n        .on('scroll', function () {\r\n          const newScrollLeft = $(this).scrollLeft();\r\n          if (newScrollLeft !== _this.state.scrollLeft) {\r\n            $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__header`).scrollLeft(newScrollLeft);\r\n            _this.setState({\r\n              scrollLeft: newScrollLeft\r\n            });\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n\r\n    const {\r\n      uuid,\r\n      resizeTimeout,\r\n      pageRequestTimeout,\r\n      viewIndexesUpdateTimeout\r\n    } = this.state;\r\n\r\n    const $grid =\r\n      $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid--with-event-handlers`);\r\n\r\n    if ($grid.length) {\r\n      $grid.off('scroll');\r\n    }\r\n\r\n    if (resizeTimeout) {\r\n      clearTimeout(resizeTimeout);\r\n    }\r\n\r\n    if (pageRequestTimeout) {\r\n      clearTimeout(pageRequestTimeout);\r\n    }\r\n\r\n    if (viewIndexesUpdateTimeout) {\r\n      clearTimeout(viewIndexesUpdateTimeout);\r\n    }\r\n\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n    if (this.state.gridKeyForRefresh === nextState.gridKeyForRefresh && this.state.scrollLeft !== nextState.scrollLeft) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  /* === Event handlers === */\r\n\r\n  updateRenderedRows(selectedRowKeys) {\r\n\r\n    const {\r\n      populatedRows,\r\n      cols,\r\n      colWidths,\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, selectedRowKeys);\r\n\r\n    this.setState({\r\n      renderedRows,\r\n      queriedRows: this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc)\r\n    });\r\n  }\r\n\r\n  applyQueryChange(filters, searchText, sortCol, sortByDesc) {\r\n\r\n    const {\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      renderedRows,\r\n      cols,\r\n      queriedRows\r\n    } = this.state;\r\n\r\n    this.setState({\r\n      scrollTop: 0,\r\n      gridKeyForRefresh: uuidv4(),\r\n      queriedRows: isPaginated\r\n        ? queriedRows\r\n        : this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc)\r\n    });\r\n  }\r\n\r\n  onFiltersChange(dataIndex, value) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated,\r\n    } = this.props;\r\n\r\n    const {\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const newFilters = this.state.filters;\r\n\r\n    if (value !== null && value.length > 0) {\r\n      newFilters[dataIndex] = value;\r\n    } else {\r\n      delete newFilters[dataIndex];\r\n    }\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText,\r\n      filters: newFilters,\r\n      sortCol,\r\n      sortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      filters: newFilters,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n\r\n    this.applyQueryChange(newFilters, searchText, sortCol, sortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onSearchTextChange(value) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const newSearchText = value;\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText: newSearchText,\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      searchText: newSearchText,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n    this.applyQueryChange(filters, newSearchText, sortCol, sortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onSortChange(colDataIndex, direction) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      searchText,\r\n      filters\r\n    } = this.state;\r\n\r\n    const newSortCol = direction ? colDataIndex : null;\r\n    const newSortByDesc = direction === SORT_DIRECTION_DESC;\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText,\r\n      filters,\r\n      sortCol: newSortCol,\r\n      sortByDesc: newSortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      sortCol: newSortCol,\r\n      sortByDesc: newSortByDesc,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n\r\n    this.applyQueryChange(filters, searchText, newSortCol, newSortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onRowSelectionChange(rowKey, selected) {\r\n\r\n    const {\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc,\r\n      filters,\r\n    } = this.state;\r\n\r\n    const {\r\n      rowSelection,\r\n      getRowKey,\r\n      getIsDisabledRow\r\n    } = this.props;\r\n\r\n    if (rowSelection && (rowSelection.onSelect || rowSelection.onSelectAll)) {\r\n\r\n      if (rowKey !== null && rowSelection.onSelect) {\r\n        rowSelection.onSelect(rowKey, selected);\r\n      }\r\n\r\n      if (rowKey === null && rowSelection.onSelectAll) {\r\n        rowSelection.onSelectAll(\r\n          selected,\r\n          {\r\n            searchText,\r\n            sortCol,\r\n            sortByDesc,\r\n            filters\r\n          }\r\n        );\r\n      }\r\n\r\n    } else {\r\n\r\n      const {\r\n        selectedRowKeys,\r\n        queriedRows\r\n      } = this.state;\r\n\r\n      let newSelectedRowKeys = null;\r\n\r\n      if (rowKey !== null) {\r\n        newSelectedRowKeys =\r\n          selected\r\n            ? [...selectedRowKeys, rowKey]\r\n            : selectedRowKeys.filter(selRowKey => selRowKey !== rowKey);\r\n      } else {\r\n        newSelectedRowKeys =\r\n          selected\r\n            ? queriedRows.map(row => row[DATA_INDEX_ORIGINAL_ROW]).filter(row => !getIsDisabledRow || !getIsDisabledRow(row)).map(row => getRowKey(row))\r\n            : [];\r\n      }\r\n\r\n      if (rowSelection && rowSelection.onChange) {\r\n        rowSelection.onChange(newSelectedRowKeys);\r\n      }\r\n\r\n      this.setState({\r\n        selectedRowKeys: newSelectedRowKeys,\r\n      });\r\n      this.updateRenderedRows(newSelectedRowKeys);\r\n    }\r\n  }\r\n\r\n  /* === Getters === */\r\n\r\n  getCols() {\r\n\r\n    const {\r\n      columns,\r\n      rowSelection\r\n    } = this.props;\r\n\r\n    if (columns === null) {\r\n      return null;\r\n    } else {\r\n\r\n      let res = columns.filter(col => col !== null);\r\n\r\n      if (rowSelection || this.getNormalizedTableActions().length > 0) {\r\n\r\n        res = [\r\n          {\r\n            dataIndex: DATA_INDEX_CHECKED,\r\n            render: this.renderCheckbox,\r\n            titleRender: this.renderCheckboxTitle,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            width: CHECKBOX_WIDTH,\r\n            renderText: () => \"\"\r\n          },\r\n          ...res\r\n        ];\r\n      }\r\n\r\n      if (this.getNormalizedFixedActions().length > 0) {\r\n        res = [\r\n          ...res,\r\n          {\r\n            dataIndex: DATA_INDEX_FIXED_ACTIONS_OBJS,\r\n            render: this.renderFixedActions,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            disableOnRowClickForCell: true,\r\n            renderText: () => \"\",\r\n            width: this.getNormalizedFixedActions().length * (ACTION_WIDTH + ACTIONS_GUTTER) - ACTIONS_GUTTER + COL_WIDTH_SAFE + 2 * CELL_PADDING\r\n          }\r\n        ];\r\n      }\r\n\r\n      if (this.getNormalizedActions().length > 0 || this.getNormalizedAltActions().length > 0) {\r\n        res = [\r\n          ...res,\r\n          {\r\n            dataIndex: DATA_INDEX_ACTIONS_OBJS,\r\n            render: this.renderActions,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            disableOnRowClickForCell: true,\r\n            renderText: () => \"\",\r\n            width: Math.max(this.getNormalizedActions().length, this.getNormalizedAltActions().length) * (ACTION_WIDTH + ACTIONS_GUTTER) - ACTIONS_GUTTER + COL_WIDTH_SAFE + 2 * CELL_PADDING\r\n          }\r\n        ];\r\n      }\r\n\r\n      return res;\r\n    }\r\n  }\r\n\r\n  getNormalizedTableActions() {\r\n\r\n    const {\r\n      tableActions\r\n    } = this.props;\r\n\r\n    return (tableActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedActions() {\r\n\r\n    const {\r\n      actions\r\n    } = this.props;\r\n\r\n    return (actions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedAltActions() {\r\n\r\n    const {\r\n      altActions\r\n    } = this.props;\r\n\r\n    return (altActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedFixedActions() {\r\n\r\n    const {\r\n      fixedActions\r\n    } = this.props;\r\n\r\n    return (fixedActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getSelectedRowKeys() {\r\n\r\n    const {\r\n      rowSelection\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return rowSelection && rowSelection.selectedRowKeys\r\n      ? rowSelection.selectedRowKeys\r\n      : selectedRowKeys;\r\n  }\r\n\r\n  /* === Data manipulation === */\r\n\r\n  getFilteredGridRows(rows, cols, filters) {\r\n\r\n    return Object.keys(filters).length > 0\r\n      ? rows.filter(row => {\r\n\r\n        for (let dataIndex in filters) {\r\n          if (filters.hasOwnProperty(dataIndex)) {\r\n\r\n            const col = cols.find(col => col.dataIndex === dataIndex);\r\n\r\n            const testPassed =\r\n              col.withValuesFilter\r\n                ? filters[dataIndex].includes(row[dataIndex])\r\n                : (\r\n                  InfiniteScrollTable.isValuePassingSearchText(\r\n                    col.renderText\r\n                      ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][dataIndex])\r\n                      : row[dataIndex],\r\n                    filters[dataIndex]\r\n                  )\r\n                );\r\n\r\n            if (!testPassed) {\r\n              return false;\r\n            }\r\n\r\n          }\r\n        }\r\n\r\n        return true;\r\n\r\n      })\r\n      : rows;\r\n  }\r\n\r\n  getSearchTextFilteredGridRows(rows, cols, searchText) {\r\n\r\n    return searchText !== null\r\n      ? (\r\n        rows !== null\r\n          ? rows.filter(row => {\r\n            for (let col of cols) {\r\n              if (!col.noSearchText && typeof (row[col.dataIndex]) !== 'boolean' &&\r\n                InfiniteScrollTable.isValuePassingSearchText(\r\n                  col.renderText\r\n                    ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][col.dataIndex])\r\n                    : row[col.dataIndex],\r\n                  searchText\r\n                )) {\r\n                return true;\r\n              }\r\n            }\r\n            return false;\r\n          })\r\n          : null\r\n      )\r\n      : rows;\r\n  }\r\n\r\n  getSortedGridRows(rows, cols, sortCol, sortByDesc) {\r\n\r\n    const column = sortCol !== null ? cols.find(col => col.dataIndex === sortCol) : null;\r\n\r\n    return column\r\n      ? rows.sort((a, b) => {\r\n        const _a =\r\n          column.renderText\r\n            ? column.renderText(a[DATA_INDEX_ORIGINAL_ROW][column.dataIndex])\r\n            : a[column.dataIndex];\r\n        const _b =\r\n          column.renderText\r\n            ? column.renderText(b[DATA_INDEX_ORIGINAL_ROW][column.dataIndex])\r\n            : b[column.dataIndex];\r\n        return (\r\n          column.sorter\r\n            ? column.sorter(_a, _b) * (sortByDesc ? -1 : 1)\r\n            : InfiniteScrollTable.defaultSorter(_a, _b, sortByDesc)\r\n        );\r\n      })\r\n      : rows;\r\n  }\r\n\r\n  /* === Rendering ==== */\r\n\r\n  renderGridRow(row, cols, colWidths) {\r\n\r\n    const {\r\n      onRowClick,\r\n      getIsDisabledRow,\r\n      getRowStyle\r\n    } = this.props;\r\n\r\n    return (\r\n      <div className=\"infinite-scroll-table__grid__row\" style={{width: \"100%\", height: ROW_HEIGHT}}>\r\n        {cols.map((col, colIndex) => {\r\n          const cellData = row[col.dataIndex];\r\n          const isRowClickDisabled =\r\n            !onRowClick || col.disableOnRowClickForCell ||\r\n            (getIsDisabledRow && getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW]));\r\n          let colLeftAttr = 0;\r\n          cols\r\n            .slice(0, colIndex)\r\n            .map((_, index) => index)\r\n            .forEach(index => colLeftAttr += colWidths[index]);\r\n          const rowStyle = getRowStyle ? getRowStyle(row[DATA_INDEX_ORIGINAL_ROW]) : null;\r\n          return (\r\n            <Tooltip key={colIndex} title={col.renderText ? col.renderText(cellData) : cellData}>\r\n              <div\r\n                className={\r\n                  'infinite-scroll-table__grid__cell' +\r\n                  (getIsDisabledRow && getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW])\r\n                    ? ' infinite-scroll-table__grid__cell--disabled'\r\n                    : '')\r\n                }\r\n                style={{\r\n                  position: \"absolute\",\r\n                  width: colWidths[colIndex],\r\n                  height: ROW_HEIGHT,\r\n                  lineHeight: `${ROW_HEIGHT - CELL_PADDING - CELL_PADDING}px`,\r\n                  top: 0,\r\n                  left: colLeftAttr,\r\n                  cursor: !isRowClickDisabled ? \"pointer\" : null,\r\n                  ...rowStyle\r\n                }}\r\n                onClick={!isRowClickDisabled ? () => onRowClick(row[DATA_INDEX_ORIGINAL_TRANSLATED_ROW]) : null}\r\n              >\r\n                {col.render\r\n                  ? col.render(cellData, row[DATA_INDEX_ORIGINAL_ROW])\r\n                  : cellData\r\n                }\r\n              </div>\r\n            </Tooltip>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderHeaderCells(cols, columnWidths, rows) {\r\n\r\n    const {\r\n      data\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    return (cols || []).map((col, index) =>\r\n      <div\r\n        key={index}\r\n        className=\"infinite-scroll-table__header__cell\"\r\n        style={{\r\n          width: columnWidths[index],\r\n          height: ROW_HEIGHT,\r\n          padding: HEADER_CELL_PADDING\r\n        }}\r\n      >\r\n        <Grid container justify=\"space-between\">\r\n          {(col.title || col.titleRender) && (\r\n            <Grid item style={{marginRight: (!col.noFilter || !col.noSort) ? HEADER_CELL_GUTTER : 0}}>\r\n              <div\r\n                style={{\r\n                  height: (ROW_HEIGHT - (2 * HEADER_CELL_PADDING)),\r\n                  lineHeight: `${(ROW_HEIGHT - (2 * HEADER_CELL_PADDING))}px`,\r\n                  textAlign: \"center\"\r\n                }}\r\n              >\r\n                {col.titleRender ? col.titleRender(rows) : col.title}\r\n              </div>\r\n            </Grid>\r\n          )}\r\n          {(!col.noFilter || !col.noSort)\r\n            ? (\r\n              <Grid item>\r\n                <Grid container>\r\n                  {!col.noSort && (\r\n                    <Grid item style={{marginRight: !col.noFilter ? HEADER_CELL_CONTROLS_GUTTER : 0}}>\r\n                      <SortButtons\r\n                        value={\r\n                          col.dataIndex === sortCol\r\n                            ? (sortByDesc ? SORT_DIRECTION_DESC : SORT_DIRECTION_ASC)\r\n                            : null\r\n                        }\r\n                        onChange={value => this.onSortChange(col.dataIndex, value)}\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                  {!col.noFilter && (\r\n                    <Grid item>\r\n                      <FilterButton\r\n                        value={filters[col.dataIndex]}\r\n                        onChange={value => this.onFiltersChange(col.dataIndex, value)}\r\n                        options={\r\n                          col.withValuesFilter\r\n                            ? (\r\n                              _.uniq(\r\n                                (data || []).map(row => row[col.dataIndex])\r\n                              ).map(option => ({\r\n                                value: option,\r\n                                text: col.renderText\r\n                                  ? col.renderText(option)\r\n                                  : option\r\n                              })).sort((a, b) =>\r\n                                col.sorter\r\n                                  ? col.sorter(a.text, b.text)\r\n                                  : InfiniteScrollTable.defaultSorter(a.text, b.text)\r\n                              )\r\n                            )\r\n                            : null\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n            : <span/>\r\n          }\r\n        </Grid>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderFixedActions(actions) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return (\r\n      <Grid container>\r\n        {(actions || []).map((action, index) =>\r\n          <Grid item key={index} style={{marginLeft: index === 0 ? 0 : ACTIONS_GUTTER}}>\r\n            <Tooltip title={action.title}>\r\n              <IconButton\r\n                {...action}\r\n                key={index}\r\n                size=\"small\"\r\n                onClick={\r\n                  e => {\r\n                    e.stopPropagation();\r\n                    action.onClick(\r\n                      action.row,\r\n                      () => this.setState({\r\n                        selectedRowKeys: selectedRowKeys.filter(key => key !== getRowKey(action.row))\r\n                      })\r\n                    );\r\n                  }}\r\n              >\r\n                {action.icon}\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  renderActions(actions) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return (\r\n      <Grid\r\n        container\r\n        className=\"infinite-scroll-table__grid__cell__actions-container\"\r\n        justify=\"flex-end\"\r\n      >\r\n        {(actions || []).map((action, index) =>\r\n          <Grid item key={index} style={{marginLeft: index === 0 ? 0 : ACTIONS_GUTTER}}>\r\n            <Tooltip title={action.title}>\r\n              <IconButton\r\n                className={`infinite-scroll-table__grid__cell__action ${action.className || \"\"}`}\r\n                style={{\r\n                  width: ACTION_WIDTH,\r\n                  height: ACTION_WIDTH,\r\n                  padding: 0\r\n                }}\r\n                disabled={action.disabled}\r\n                onClick={\r\n                  e => {\r\n                    e.stopPropagation();\r\n                    action.onClick(\r\n                      action.row,\r\n                      () => this.setState({\r\n                        selectedRowKeys: selectedRowKeys.filter(key => key !== getRowKey(action.row))\r\n                      })\r\n                    );\r\n                  }}\r\n              >\r\n                {action.icon}\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  renderTableAction(action, rows) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    return (\r\n      <Button\r\n        type=\"primary\"\r\n        className={action.className}\r\n        startIcon={action.icon}\r\n        title={action.title}\r\n        disabled={action.disabled}\r\n        onClick={\r\n          e => {\r\n            e.stopPropagation();\r\n            action.onClick(\r\n              rows.filter(row => this.getSelectedRowKeys().includes(getRowKey(row[DATA_INDEX_ORIGINAL_ROW]))),\r\n              () => this.onRowSelectionChange(null, false)\r\n            )\r\n          }}\r\n      >\r\n        {action.title}\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  renderCheckbox(checked, row) {\r\n    const {\r\n      getRowKey,\r\n      rowSelection,\r\n      getIsDisabledRow,\r\n      isCheckDisabled\r\n    } = this.props;\r\n\r\n    const checkboxProps =\r\n      rowSelection && rowSelection.getCheckboxProps\r\n        ? rowSelection.getCheckboxProps(row)\r\n        : ({\r\n          disabled: (isCheckDisabled || (getIsDisabledRow && getIsDisabledRow(row)))\r\n        });\r\n\r\n    return (\r\n      <Checkbox\r\n        checked={checked}\r\n        onChange={e => {\r\n          e.stopPropagation();\r\n          this.onRowSelectionChange(getRowKey(row), !checked)\r\n        }}\r\n        style={{padding: 0}}\r\n        {...checkboxProps}\r\n      />\r\n    );\r\n  }\r\n\r\n  renderCheckboxTitle(rows) {\r\n    const {\r\n      getRowKey,\r\n      getIsDisabledRow,\r\n      isCheckDisabled\r\n    } = this.props;\r\n\r\n    const selectedRowKeys = this.getSelectedRowKeys();\r\n\r\n    const checked =\r\n      rows !== null &&\r\n      rows.length > 0 &&\r\n      rows\r\n        .filter(row => !getIsDisabledRow || !getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW]))\r\n        .map(row => getRowKey(row[DATA_INDEX_ORIGINAL_ROW]))\r\n        .filter(rowKey => !selectedRowKeys.includes(rowKey))\r\n        .length === 0;\r\n\r\n    return (\r\n      <Checkbox\r\n        checked={checked}\r\n        onChange={() => this.onRowSelectionChange(null, !checked)}\r\n        style={{padding: 0}}\r\n        disabled={isCheckDisabled}\r\n      />\r\n    );\r\n  }\r\n\r\n  onRenderedRowsChange(viewStartIdx, viewEndIdx, overscanStartIdx, overscanEndIdx) {\r\n\r\n    const {\r\n      onChange,\r\n      rowCount,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      pageRequestTimeout,\r\n      pageSize,\r\n      pageNum,\r\n      isPaginating,\r\n      viewIndexesUpdateTimeout,\r\n      doNotCallOnChangeOnNextRenderedRowsChange\r\n    } = this.state;\r\n\r\n    if (viewIndexesUpdateTimeout) {\r\n      clearTimeout(viewIndexesUpdateTimeout);\r\n    }\r\n\r\n    this.setState({\r\n      viewIndexesUpdateTimeout: setTimeout(\r\n        () => this.setState({\r\n          viewStartIdx,\r\n          viewEndIdx,\r\n          viewIndexesUpdateTimeout: null\r\n        }),\r\n        VIEW_INDEXES_UPDATE_TIMEOUT\r\n      )\r\n    });\r\n\r\n    if (isPaginated && !doNotCallOnChangeOnNextRenderedRowsChange) {\r\n\r\n      const currentPageIndexes = getIndexesFromPaginationParams(\r\n        pageSize || DEFAULT_PAGE_SIZE,\r\n        pageNum || DEFAULT_PAGE_NUM\r\n      );\r\n\r\n      if (\r\n        isPaginating ||\r\n        (overscanStartIdx < currentPageIndexes.startIdx || overscanEndIdx > currentPageIndexes.stopIdx)\r\n      ) {\r\n\r\n        if (pageRequestTimeout !== null) {\r\n          clearTimeout(pageRequestTimeout);\r\n        }\r\n\r\n        const safePageSize = MAX_PAGE_SIZE / 2; // getPaginationParamsFromIndexes can double the size of a page\r\n        const pageRowsThird = Math.floor(safePageSize / 3);\r\n        const newPaginationParams =\r\n          getPaginationParamsFromIndexes(\r\n            Math.max(overscanStartIdx - pageRowsThird, 0),\r\n            Math.min(overscanStartIdx + 2 * pageRowsThird - 1, rowCount - 1),\r\n            rowCount\r\n          );\r\n\r\n        const newPageRequestParams = {\r\n          pageSize: newPaginationParams.pageSize,\r\n          pageNum: newPaginationParams.pageNum,\r\n          filters: this.state.filters,\r\n          searchText: this.state.searchText,\r\n          sortCol: this.state.sortCol,\r\n          sortByDesc: this.state.sortByDesc\r\n        };\r\n\r\n        this.setState({\r\n          isPaginating: true,\r\n          pageRequestTimeout: setTimeout(\r\n            () => {\r\n              onChange(newPageRequestParams);\r\n              this.setState({\r\n                pageRequestParams: newPageRequestParams\r\n              })\r\n            },\r\n            PAGINATION_TIMEOUT\r\n          )\r\n        });\r\n      }\r\n    } else if (isPaginated) {\r\n      this.setState({\r\n        doNotCallOnChangeOnNextRenderedRowsChange: false\r\n      });\r\n    }\r\n  }\r\n\r\n  getIsVerticalScrollbarVisible(rowNum) {\r\n\r\n    const {\r\n      height = DEFAULT_TABLE_HEIGHT\r\n    } = this.props;\r\n\r\n    return rowNum * ROW_HEIGHT > height;\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      t,\r\n      size,\r\n      leftActions,\r\n      rightActions,\r\n      showHeader = true,\r\n      rowCount,\r\n      isPaginated = false,\r\n      height = DEFAULT_TABLE_HEIGHT,\r\n      selectedRowCount,\r\n      autoSearch = true\r\n    } = this.props;\r\n\r\n    const {\r\n      uuid,\r\n      cols,\r\n      gridKeyForRefresh,\r\n      scrollTop,\r\n      gridScrollbarWidth,\r\n      populatedRows,\r\n      queriedRows,\r\n      isResizing,\r\n      colWidths,\r\n      pageSize,\r\n      pageNum,\r\n      isPaginating,\r\n      viewStartIdx,\r\n      viewEndIdx,\r\n      viewIndexesUpdateTimeout,\r\n      searchText\r\n    } = this.state;\r\n\r\n    const currentPageIndexes = getIndexesFromPaginationParams(\r\n      pageSize || DEFAULT_PAGE_SIZE,\r\n      pageNum || DEFAULT_PAGE_NUM\r\n    );\r\n\r\n    return (\r\n      <div className={`infinite-scroll-table infinite-scroll-table__${uuid}`}>\r\n        <PreHeader\r\n          searchText={searchText}\r\n          autoSearch={autoSearch}\r\n          onSearch={this.onSearchTextChange}\r\n          selectedRowCount={selectedRowCount ? selectedRowCount : this.getSelectedRowKeys().length}\r\n          tableActions={this.getNormalizedTableActions()}\r\n          renderTableAction={action => this.renderTableAction(action, populatedRows)}\r\n          leftActions={leftActions}\r\n          rightActions={rightActions}\r\n        />\r\n        <Fragment>\r\n          {showHeader && (\r\n            isResizing\r\n              ? <div className=\"infinite-scroll-table__header-placeholder\" style={{height: ROW_HEIGHT}}/>\r\n              : (\r\n                <div className=\"infinite-scroll-table__header\" style={{height: ROW_HEIGHT}}>\r\n                  {queriedRows !== null\r\n                    ? (\r\n                      <Fragment>\r\n                        <div className=\"infinite-scroll-table__header__cells-container\">\r\n                          {this.renderHeaderCells(cols, colWidths, queriedRows)}\r\n                        </div>\r\n                        <div\r\n                          className=\"infinite-scroll-table__header__scrollbar-padding\"\r\n                          style={{width: gridScrollbarWidth, height: ROW_HEIGHT}}\r\n                        >\r\n                        </div>\r\n                      </Fragment>\r\n                    )\r\n                    : (\r\n                      <div\r\n                        className=\"infinite-scroll-table__header-placeholder\"\r\n                        style={{height: ROW_HEIGHT, width: size.width}}\r\n                      />\r\n                    )\r\n                  }\r\n                </div>\r\n              )\r\n          )}\r\n          {isResizing || queriedRows === null || queriedRows.length === 0\r\n            ? (\r\n              <div style={{height}} className=\"infinite-scroll-table__grid-container-placeholder\">\r\n                <CustomEmpty\r\n                  width={(!isResizing && queriedRows !== null) ? _.sum(colWidths) : undefined}\r\n                  text={\r\n                    isResizing\r\n                      ? t(\"components.infiniteScrollTable.resizing\") + \"...\"\r\n                      : (\r\n                        queriedRows === null\r\n                          ? t(\"components.infiniteScrollTable.updating\") + \"...\"\r\n                          : undefined\r\n                      )}\r\n                  image={isResizing\r\n                    ? <CircularProgress/>\r\n                    : <span/>\r\n                  }\r\n                />\r\n              </div>\r\n            )\r\n            : (\r\n              <div className=\"infinite-scroll-table__grid-container\" style={{position: \"relative\", height}}>\r\n                {isPaginating && (\r\n                  <div\r\n                    style={{\r\n                      position: \"absolute\",\r\n                      width: Math.min(_.sum(colWidths), size.width),\r\n                      height,\r\n                    }}\r\n                  >\r\n                    <CustomEmpty\r\n                      text={t(\"components.infiniteScrollTable.updating\") + \"...\"}\r\n                    />\r\n                  </div>\r\n                )}\r\n                <FixedSizeList\r\n                  className=\"infinite-scroll-table__grid\"\r\n                  key={gridKeyForRefresh}\r\n                  width={size.width}\r\n                  height={height}\r\n                  itemSize={ROW_HEIGHT}\r\n                  itemCount={rowCount || queriedRows.length}\r\n                  initialScrollOffset={scrollTop}\r\n                  onItemsRendered={\r\n                    ({visibleStartIndex, visibleStopIndex, overscanStartIndex, overscanStopIndex}) =>\r\n                      this.onRenderedRowsChange(\r\n                        visibleStartIndex,\r\n                        visibleStopIndex,\r\n                        overscanStartIndex,\r\n                        overscanStopIndex\r\n                      )\r\n                  }\r\n                >\r\n                  {({index, style}) =>\r\n                    <div\r\n                      style={{...style, width: _.sum(colWidths)}}\r\n                      className={`infinite-scroll-table__grid__row infinite-scroll-table__grid__row--${index % 2 ? 'odd' : 'even'}`}\r\n                    >\r\n                      {\r\n                        !isPaginated ||\r\n                        (\r\n                          !isPaginating &&\r\n                          currentPageIndexes.startIdx <= index &&\r\n                          index <= currentPageIndexes.stopIdx &&\r\n                          (index - currentPageIndexes.startIdx < queriedRows.length)\r\n                        )\r\n                          ? (\r\n                            queriedRows[\r\n                              isPaginated\r\n                                ? (index - currentPageIndexes.startIdx)\r\n                                : index\r\n                              ][DATA_INDEX_RENDERED]\r\n                          )\r\n                          : <span/>\r\n                      }\r\n                    </div>\r\n                  }\r\n                </FixedSizeList>\r\n              </div>\r\n            )}\r\n          <Footer\r\n            isHidden={queriedRows === null || queriedRows.length === 0}\r\n            isLoading={isPaginating || viewIndexesUpdateTimeout}\r\n            rowNumStart={viewStartIdx + 1}\r\n            rowNumEnd={viewEndIdx + 1}\r\n            rowCount={rowCount || (queriedRows ? queriedRows.length : null)}\r\n          />\r\n        </Fragment>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withSize(),\r\n  withTranslation(),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(InfiniteScrollTable);\r\n","import React from 'react';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\n\r\nconst iconStyle = {\r\n  cursor: 'pointer'\r\n};\r\n\r\n/* Based on https://ant.design/components/form/#components-form-demo-customized-form-controls */\r\nclass Selector extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      value: null\r\n    };\r\n    this.callOnChange = this.callOnChange.bind(this);\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, state) {\r\n    if (nextProps.value !== state.value) {\r\n      return {\r\n        value: nextProps.value\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  callOnChange(value) {\r\n    if (this.props.onChange) {\r\n      this.props.onChange(value);\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      disabled,\r\n      detailTitle,\r\n      selectTitle,\r\n      resetTitle,\r\n      onDetail,\r\n      onSelect,\r\n      onReset,\r\n      render,\r\n      variant,\r\n      className\r\n    } = this.props;\r\n\r\n    const {\r\n      value\r\n    } = this.state;\r\n\r\n    return (\r\n      <TextField\r\n        value={render ? render(value) : value}\r\n        onChange={f => f}\r\n        variant={variant || \"outlined\"}\r\n        InputProps={{\r\n          readOnly: true,\r\n          endAdornment: disabled\r\n            ? undefined\r\n            : value !== null\r\n              ? resetTitle\r\n                ? (\r\n                  <Tooltip title={resetTitle}>\r\n                    <CloseIcon onClick={onReset} style={iconStyle}/>\r\n                  </Tooltip>\r\n                )\r\n                : <CloseIcon onClick={onReset} style={iconStyle}/>\r\n              : selectTitle\r\n                ? (\r\n                  <Tooltip title={selectTitle}>\r\n                    <AddIcon onClick={onSelect} style={iconStyle}/>\r\n                  </Tooltip>\r\n                )\r\n                : <AddIcon onClick={onSelect} style={iconStyle}/>,\r\n          startAdornment: (onDetail && value !== null)\r\n            ? detailTitle\r\n              ? (\r\n                <Tooltip title={detailTitle}>\r\n                  <VisibilityIcon onClick={onDetail} style={iconStyle}/>\r\n                </Tooltip>\r\n              )\r\n              : <VisibilityIcon onClick={onDetail} style={iconStyle}/>\r\n            : undefined\r\n        }}\r\n        className={className}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Selector;\r\n","import React, {useState} from 'react';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport _ from \"lodash\";\r\n\r\nconst ON_CHANGE_TIMEOUT = 500;\r\n\r\nconst getInitialInternalValue = (value, languages) => {\r\n  const emptyValue = {};\r\n  languages.forEach(lang => emptyValue[lang] = \"\");\r\n\r\n  return _.merge(emptyValue, value)\r\n};\r\n\r\nconst Component = ({\r\n                     textFieldProps,\r\n                     defaultLanguage,\r\n                     languages\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n  const [internalValue, setInternalValue] = useState(getInitialInternalValue(textFieldProps.value, languages));\r\n  const [timeoutId, setTimeoutId] = useState(null);\r\n\r\n  const callOnChange = value => {\r\n    if (textFieldProps.onChange) {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId)\r\n      }\r\n      setTimeoutId(setTimeout(\r\n        () => {\r\n          textFieldProps.onChange(value);\r\n        },\r\n        ON_CHANGE_TIMEOUT\r\n      ));\r\n    }\r\n  };\r\n\r\n  const setValueForLanguage = value => {\r\n    let newInternalValue = _.cloneDeep(internalValue);\r\n    newInternalValue[language] = value;\r\n\r\n    setInternalValue(newInternalValue);\r\n    callOnChange(newInternalValue);\r\n  };\r\n\r\n  return (\r\n    <TextField\r\n      {...textFieldProps}\r\n      value={(internalValue && internalValue[language])\r\n        ? internalValue[language]\r\n        : \"\"\r\n      }\r\n      onChange={({target}) => setValueForLanguage(target.value)}\r\n      InputProps={{\r\n        startAdornment: (\r\n          <InputAdornment position=\"start\">\r\n            <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n          </InputAdornment>\r\n        )\r\n      }}\r\n    >\r\n      {textFieldProps.children}\r\n    </TextField>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nDelayedTextField = props =>\r\n  <ConnectedComponent textFieldProps={props}/>;\r\n\r\nexport default I18nDelayedTextField;","export const getDashboardDynamicFilterLabelTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    Region: t('dashboards.dynamicFilterLabels.region'),\r\n    Province: t('dashboards.dynamicFilterLabels.province'),\r\n    Municipality: t('dashboards.dynamicFilterLabels.municipality'),\r\n  });\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};","import React, {Fragment, useState} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport _ from \"lodash\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport Selector from \"../selector\";\r\nimport {\r\n  DASHBOARD_ELEM_ENABLE_FILTERS_KEY,\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_SHOW_TITLE_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_TEXT,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  DASHBOARD_ELEM_WIDTH_KEY,\r\n  emptyDashboardElem\r\n} from \"../../utils/dashboards\";\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport I18nDelayedTextField from \"../i18n-delayed-text-field\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nHtmlEditor from \"../i18n-html-editor\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport filters from \"../../dummy/filters.json\";\r\nimport {getDashboardDynamicFilterLabelTranslations} from \"../../constants/getDashboardDynamicFilterLabelTranslations\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst MAX_VIEW_PER_ROW = 4;\r\n\r\nconst ROW_ACTION_WIDTH = 48;\r\nconst COL_ACTION_WIDTH = 48;\r\nconst VIEW_ACTION_WIDTH = 48;\r\n\r\nconst styles = theme => ({\r\n  filterLevels: {\r\n    fontSize: 16\r\n  },\r\n  rowContainer: {\r\n    width: \"100%\",\r\n    marginTop: 8\r\n  },\r\n  row: {\r\n    width: `calc(100% - ${2 * ROW_ACTION_WIDTH}px)`,\r\n    height: 164,\r\n    display: \"inline-block\"\r\n  },\r\n  rowActions: {\r\n    width: (2 * ROW_ACTION_WIDTH),\r\n    display: \"inline-block\",\r\n    margin: \"5px 0\"\r\n  },\r\n  rowAction: {\r\n    width: ROW_ACTION_WIDTH\r\n  },\r\n  colContainer: {\r\n    border: \"1px solid rgba(0, 0, 0, 0.2)\",\r\n    marginRight: 8,\r\n    padding: 16,\r\n    height: \"100%\",\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  col: {\r\n    width: `calc(100% - ${COL_ACTION_WIDTH}px)`,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  colActions: {\r\n    width: COL_ACTION_WIDTH,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  viewContainer: {\r\n    width: \"100%\"\r\n  },\r\n  view: {\r\n    width: `calc(100% - ${VIEW_ACTION_WIDTH + 4}px)`,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  viewAction: {\r\n    width: VIEW_ACTION_WIDTH,\r\n    marginLeft: 4,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  input: {\r\n    width: \"100%\",\r\n    \"& > div\": {\r\n      width: \"100%\"\r\n    },\r\n    \"& input\": {\r\n      padding: 10,\r\n      height: 20\r\n    },\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  dynamicViewInput: {\r\n    marginLeft: 16,\r\n    \"& input\": {\r\n      padding: 10,\r\n      height: 20\r\n    }\r\n  },\r\n  htmlInput: {\r\n    \"& > div\": {\r\n      height: 130\r\n    }\r\n  },\r\n  formLabel: {\r\n    marginLeft: 0,\r\n    marginRight: 0\r\n  }\r\n});\r\n\r\nconst getStrippedHtmlText = html => {\r\n  const $span = $('<span>').get(0);\r\n\r\n  $span.innerHTML = html;\r\n  const text = $span.textContent || $span.innerText || \"\";\r\n\r\n  $($span).remove();\r\n\r\n  return text;\r\n}\r\n\r\nconst DashboardBuilderCol = ({\r\n                               t,\r\n                               classes,\r\n                               defaultLanguage,\r\n                               languages,\r\n                               dashboard,\r\n                               rowIdx,\r\n                               colIdx,\r\n                               col,\r\n                               onColRemove,\r\n                               onTypeReset,\r\n                               fetchViews,\r\n                               onViewReset,\r\n                               onTextEdit,\r\n                               onShowTitleChange,\r\n                               onEnableFiltersChange,\r\n                               onFilterDimensionChange\r\n                             }) =>\r\n  <div\r\n    className={classes.colContainer}\r\n    style={{width: `calc(${col[DASHBOARD_ELEM_WIDTH_KEY]}% - ${2 * 4}px)`}}\r\n  >\r\n    <div className={classes.col}>\r\n      {col[DASHBOARD_ELEM_TYPE_KEY] === null\r\n        ? (\r\n          <Grid container justify=\"center\" style={{margin: \"47px 0\"}}>\r\n            <Grid item>\r\n              <Button onClick={() => fetchViews(rowIdx, colIdx)}>\r\n                {t(\"components.dashboardBuilder.actions.addView\")}\r\n              </Button>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button onClick={() => onTextEdit(rowIdx, colIdx, \"\")}>\r\n                {t(\"components.dashboardBuilder.actions.addText\")}\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        )\r\n        : (\r\n          <div className={classes.viewContainer}>\r\n            <div className={classes.view}>\r\n              {col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW\r\n                ? (\r\n                  <Grid container>\r\n                    <Grid item xs={12} style={{marginBottom: 8}}>\r\n                      <Selector\r\n                        value={col[DASHBOARD_ELEM_VALUE_KEY] ? dashboard.views[col[DASHBOARD_ELEM_VALUE_KEY]] : null}\r\n                        render={view => view?.title ? localizeI18nObj(view.title, defaultLanguage, languages) : \"\"}\r\n                        variant=\"standard\"\r\n                        className={classes.input}\r\n                        selectTitle={t(\"components.dashboardBuilder.actions.selectView\")}\r\n                        onSelect={() => fetchViews(rowIdx, colIdx)}\r\n                        resetTitle={t(\"components.dashboardBuilder.actions.deselectView\")}\r\n                        onReset={() => onViewReset(rowIdx, colIdx, col[DASHBOARD_ELEM_VALUE_KEY])}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={12}>\r\n                      <Grid container>\r\n                        <Grid item style={{marginRight: 8}}>\r\n                          <FormControlLabel\r\n                            className={classes.formLabel}\r\n                            label={t(\"components.dashboardBuilder.actions.showTitle\")}\r\n                            control={\r\n                              <Checkbox\r\n                                style={{padding: 5}}\r\n                                checked={col[DASHBOARD_ELEM_SHOW_TITLE_KEY]}\r\n                                onChange={(ev, checked) => onShowTitleChange(rowIdx, colIdx, checked)}\r\n                              />\r\n                            }\r\n                          />\r\n                        </Grid>\r\n                        <Grid item>\r\n                          <FormControlLabel\r\n                            className={classes.formLabel}\r\n                            label={t(\"components.dashboardBuilder.actions.enableFilters\")}\r\n                            control={\r\n                              <Checkbox\r\n                                style={{padding: 5}}\r\n                                checked={col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY]}\r\n                                onChange={(ev, checked) => onEnableFiltersChange(rowIdx, colIdx, checked)}\r\n                              />\r\n                            }\r\n                          />\r\n                        </Grid>\r\n                      </Grid>\r\n                    </Grid>\r\n                    <Grid item xs={12} style={{marginTop: 8}}>\r\n                      <FormControlLabel\r\n                        className={classes.formLabel}\r\n                        style={{marginLeft: 8}}\r\n                        label={t(\"components.dashboardBuilder.filterDimension.label\") + \":\"}\r\n                        labelPlacement=\"start\"\r\n                        control={\r\n                          <TextField\r\n                            value={col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || \"\"}\r\n                            placeholder={t(\"components.dashboardBuilder.filterDimension.noOne\")}\r\n                            className={classes.dynamicViewInput}\r\n                            variant=\"outlined\"\r\n                            onChange={({target}) => onFilterDimensionChange(rowIdx, colIdx, target.value)}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  </Grid>\r\n                )\r\n                : (\r\n                  <TextField\r\n                    value={getStrippedHtmlText(localizeI18nObj(col[DASHBOARD_ELEM_VALUE_KEY], defaultLanguage, languages) || \"\")}\r\n                    className={`${classes.input} ${classes.htmlInput}`}\r\n                    multiline\r\n                    rows={5}\r\n                    InputProps={{\r\n                      readOnly: true,\r\n                      endAdornment: (\r\n                        <Tooltip title={t(\"components.dashboardBuilder.actions.editText\")}>\r\n                          <EditIcon\r\n                            style={{cursor: \"pointer\", marginLeft: 4}}\r\n                            onClick={() => onTextEdit(rowIdx, colIdx, col[DASHBOARD_ELEM_VALUE_KEY])}\r\n                          />\r\n                        </Tooltip>\r\n                      )\r\n                    }}\r\n                  />\r\n                )\r\n              }\r\n            </div>\r\n            <Tooltip title={t(\"components.dashboardBuilder.actions.resetColumn\")}>\r\n              <IconButton\r\n                className={classes.viewAction}\r\n                onClick={() => onTypeReset(rowIdx, colIdx)}\r\n              >\r\n                <CloseIcon/>\r\n              </IconButton>\r\n            </Tooltip>\r\n          </div>\r\n        )\r\n      }\r\n    </div>\r\n    <Tooltip title={t(\"components.dashboardBuilder.actions.removeColumn\")}>\r\n      <span>\r\n        <IconButton\r\n          className={classes.colActions}\r\n          onClick={() => onColRemove(rowIdx, colIdx)}\r\n          disabled={dashboard.dashboardConfig[rowIdx].length === 1}\r\n        >\r\n          <DeleteIcon/>\r\n        </IconButton>\r\n      </span>\r\n    </Tooltip>\r\n  </div>;\r\n\r\nconst DashboardBuilderRow = ({\r\n                               t,\r\n                               classes,\r\n                               defaultLanguage,\r\n                               languages,\r\n                               dashboard,\r\n                               row,\r\n                               rowIdx,\r\n                               onRowRemove,\r\n                               onColAdd,\r\n                               onColRemove,\r\n                               onTypeReset,\r\n                               fetchViews,\r\n                               onViewReset,\r\n                               onTextEdit,\r\n                               onShowTitleChange,\r\n                               onEnableFiltersChange,\r\n                               onFilterDimensionChange\r\n                             }) =>\r\n  <div className={classes.rowContainer}>\r\n    <div className={classes.row}>\r\n      {row.map((col, idx) =>\r\n        <DashboardBuilderCol\r\n          key={idx}\r\n          t={t}\r\n          classes={classes}\r\n          defaultLanguage={defaultLanguage}\r\n          languages={languages}\r\n          dashboard={dashboard}\r\n          rowIdx={rowIdx}\r\n          colIdx={idx}\r\n          col={col}\r\n          onColRemove={onColRemove}\r\n          onTypeReset={onTypeReset}\r\n          fetchViews={fetchViews}\r\n          onViewReset={onViewReset}\r\n          onTextEdit={onTextEdit}\r\n          onShowTitleChange={onShowTitleChange}\r\n          onEnableFiltersChange={onEnableFiltersChange}\r\n          onFilterDimensionChange={onFilterDimensionChange}\r\n        />\r\n      )}\r\n    </div>\r\n    <div className={classes.rowActions}>\r\n      <Tooltip title={t(\"components.dashboardBuilder.actions.addColumn\")}>\r\n        <span>\r\n          <IconButton\r\n            className={classes.rowAction}\r\n            onClick={() => onColAdd(rowIdx)}\r\n            disabled={row.length === MAX_VIEW_PER_ROW}\r\n          >\r\n            <AddIcon/>\r\n          </IconButton>\r\n        </span>\r\n      </Tooltip>\r\n      <Tooltip title={t(\"components.dashboardBuilder.actions.removeRow\")}>\r\n        <IconButton\r\n          className={classes.rowAction}\r\n          onClick={() => onRowRemove(rowIdx)}\r\n        >\r\n          <DeleteIcon/>\r\n        </IconButton>\r\n      </Tooltip>\r\n    </div>\r\n  </div>;\r\n\r\nfunction DashboardBuilder(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    nodes,\r\n    dashboard,\r\n    onChange,\r\n    views,\r\n    fetchViews,\r\n    onViewsHide\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [selectedRowIdx, setSelectedRowIdx] = useState(null);\r\n  const [selectedColIdx, setSelectedColIdx] = useState(null);\r\n\r\n  const [isEditTextVisible, setEditTextVisibility] = useState(false);\r\n  const [tempTextValue, setTempTextValue] = useState(null);\r\n\r\n  const handleRowAdd = () => {\r\n    const newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig.push([emptyDashboardElem]);\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleRowRemove = rowIdx => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig = newDashboard.dashboardConfig.filter((_, idx) => idx !== rowIdx);\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleColAdd = rowIdx => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx].push(emptyDashboardElem)\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].map(col => ({\r\n      ...col,\r\n      [DASHBOARD_ELEM_WIDTH_KEY]: Math.floor(100 / newDashboard.dashboardConfig[rowIdx].length)\r\n    }));\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleColRemove = (rowIdx, colIdx) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].filter((_, idx) => idx !== colIdx);\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].map(col => ({\r\n      ...col,\r\n      [DASHBOARD_ELEM_WIDTH_KEY]: (100 / newDashboard.dashboardConfig[rowIdx].length)\r\n    }));\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleTypeReset = (rowIdx, colIdx) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = null;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = null;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleViewSet = (rowIdx, colIdx, view) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = DASHBOARD_ELEM_TYPE_VALUE_VIEW;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = view.viewTemplateId;\r\n    newDashboard.views[view.viewTemplateId] = view;\r\n    onChange(newDashboard);\r\n    onViewsHide();\r\n  };\r\n\r\n  const handleViewReset = (rowIdx, colIdx, viewId) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = null;\r\n    onChange(newDashboard);\r\n    onViewsHide();\r\n  };\r\n\r\n  const handleEditTextShow = (rowIdx, colIdx, text) => {\r\n    setSelectedRowIdx(rowIdx);\r\n    setSelectedColIdx(colIdx);\r\n    setTempTextValue(text);\r\n    setEditTextVisibility(true);\r\n  };\r\n\r\n  const handleEditTextHide = () => {\r\n    setSelectedRowIdx(null);\r\n    setSelectedColIdx(null);\r\n    setTempTextValue(null);\r\n    setEditTextVisibility(false);\r\n  };\r\n\r\n  const handleTextChange = (rowIdx, colIdx, text) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = DASHBOARD_ELEM_TYPE_VALUE_TEXT;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = text;\r\n    onChange(newDashboard);\r\n    setEditTextVisibility(false);\r\n  };\r\n\r\n  const handleShowTitleChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_SHOW_TITLE_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleEnableFiltersChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_ENABLE_FILTERS_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleFilterDimensionChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_FILTER_DIMENSION_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      {dashboard && (\r\n        <Grid container spacing={1}>\r\n          <Grid item xs={12}>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nDelayedTextField\r\n                label={t(\"components.dashboardBuilder.title\")}\r\n                value={dashboard.title}\r\n                variant=\"outlined\"\r\n                required\r\n                onChange={value => onChange({...dashboard, title: value})}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Grid container>\r\n              <Grid item className={classes.filterLevels} style={{marginRight: 16, lineHeight: \"34px\"}}>\r\n                {t(\"components.dashboardBuilder.filterLevels\")}:\r\n              </Grid>\r\n              <Grid item>\r\n                <Grid container>\r\n                  {filters.labels.map((label, idx) =>\r\n                    <Grid item key={idx} style={{marginRight: 8}}>\r\n                      <FormControlLabel\r\n                        className={classes.formLabel}\r\n                        label={getDashboardDynamicFilterLabelTranslations(t)[label]}\r\n                        control={\r\n                          <Checkbox\r\n                            style={{padding: 5}}\r\n                            checked={!!dashboard.filterLevels[label]}\r\n                            onChange={(ev, checked) => onChange({\r\n                              ...dashboard,\r\n                              filterLevels: {\r\n                                ...dashboard.filterLevels,\r\n                                [label]: checked\r\n                              }\r\n                            })}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            {(dashboard.dashboardConfig || []).map((row, idx) =>\r\n              <DashboardBuilderRow\r\n                key={idx}\r\n                t={t}\r\n                classes={classes}\r\n                defaultLanguage={defaultLanguage}\r\n                languages={languages}\r\n                dashboard={dashboard}\r\n                row={row}\r\n                rowIdx={idx}\r\n                onRowRemove={handleRowRemove}\r\n                onColAdd={handleColAdd}\r\n                onColRemove={handleColRemove}\r\n                onTypeReset={handleTypeReset}\r\n                fetchViews={(rowIdx, colIdx) => {\r\n                  fetchViews();\r\n                  setSelectedRowIdx(rowIdx);\r\n                  setSelectedColIdx(colIdx);\r\n                }}\r\n                onViewReset={handleViewReset}\r\n                onTextEdit={handleEditTextShow}\r\n                onShowTitleChange={handleShowTitleChange}\r\n                onEnableFiltersChange={handleEnableFiltersChange}\r\n                onFilterDimensionChange={handleFilterDimensionChange}\r\n              />\r\n            )}\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Grid container justify=\"center\">\r\n              <Button endIcon={<AddIcon/>} onClick={handleRowAdd}>\r\n                {t(\"components.dashboardBuilder.actions.addRow\")}\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n      )}\r\n\r\n      <Dialog\r\n        open={views !== null && views !== undefined}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={onViewsHide}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.views.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <InfiniteScrollTable\r\n            data={(views || [])}\r\n            getRowKey={({viewTemplateId}) => viewTemplateId}\r\n            columns={[\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.node\"),\r\n                dataIndex: 'nodeId',\r\n                render: (_, {nodeId}) => nodes.find(node => node.nodeId === nodeId).code,\r\n                renderText: nodeId => nodes.find(node => node.nodeId === nodeId).code,\r\n                minWidthToContent: true\r\n              },\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.datasetId\"),\r\n                dataIndex: 'datasetId',\r\n                minWidthToContent: true\r\n              },\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.name\"),\r\n                dataIndex: 'title',\r\n                minWidthToContent: true\r\n              }\r\n            ]}\r\n            multilangStrDataIndexes={[\"title\"]}\r\n            onRowClick={({__originalRow: view}) => {\r\n              handleViewSet(selectedRowIdx, selectedColIdx, view);\r\n              setSelectedRowIdx(null);\r\n              setSelectedColIdx(null);\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              onViewsHide();\r\n              setSelectedRowIdx(null);\r\n              setSelectedColIdx(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isEditTextVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={handleEditTextHide}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.text.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <I18nHtmlEditor\r\n            value={tempTextValue}\r\n            onChange={setTempTextValue}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleEditTextHide}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => handleTextChange(selectedRowIdx, selectedColIdx, tempTextValue)}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(DashboardBuilder);","import React from 'react';\r\n\r\n/* Calls a function right after the WrappedComponent has been mounted and updated (if props changed) */\r\nclass Call extends React.Component {\r\n\r\n  componentDidMount() {\r\n    /* children has been mounted */\r\n    if (this.props.disabled === undefined || !this.props.disabled) {\r\n      this.props.cb(this.props.cbParam);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate({cb, cbParam, disabled}) {\r\n    /* children has been updated */\r\n    if (\r\n      (this.props.disabled === undefined || !this.props.disabled)\r\n      &&\r\n      (\r\n        JSON.stringify(cbParam) !== JSON.stringify(this.props.cbParam)\r\n        ||\r\n        (this.props.disabled !== undefined && disabled === true && this.props.disabled === false)\r\n      )\r\n    ) {\r\n      this.props.cb(this.props.cbParam);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default Call;\r\n","import React from \"react\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  cardTitle: {\r\n    fontSize: 17,\r\n    fontWeight: \"bold\"\r\n  },\r\n  datasetAttributesCard: {\r\n    background: \"#F5F5F5\"\r\n  },\r\n  datasetAttributes: {\r\n    margin: 0,\r\n    padding: \"0 16px 16px\"\r\n  },\r\n  seriesAttributes: {\r\n    margin: 0,\r\n    padding: \"0 0 16px\"\r\n  },\r\n  attributeGroup: {\r\n    margin: 0,\r\n    padding: \"0 16px\"\r\n  }\r\n});\r\n\r\nconst Attribute = ({attribute, list}) =>\r\n  <Grid item xs={12}>\r\n    {`${list ? \"- \" : \"\"}${attribute.id}: ${attribute.value}`}\r\n  </Grid>;\r\n\r\nfunction AttributeList(props) {\r\n\r\n  const {\r\n    classes,\r\n    datasetAttributes,\r\n    otherAttributes\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {datasetAttributes.length > 0 && (\r\n        <Card variant=\"outlined\" className={classes.datasetAttributesCard}>\r\n          <CardHeader\r\n            title={\r\n              <div className={classes.cardTitle}>\r\n                {t(\"components.attributeList.datasetInformation.title\")}:\r\n              </div>\r\n            }\r\n            disableTypography\r\n          />\r\n          <Grid container spacing={2} className={classes.datasetAttributes}>\r\n            {datasetAttributes.map((attribute, idx) =>\r\n              <Attribute\r\n                key={idx}\r\n                attribute={attribute}\r\n              />\r\n            )}\r\n          </Grid>\r\n        </Card>\r\n      )}\r\n      {otherAttributes.length > 0 && (\r\n        <Card variant=\"outlined\" style={{marginTop: 16}}>\r\n          <CardHeader\r\n            title={\r\n              <div className={classes.cardTitle}>\r\n                {t(\"components.attributeList.seriesInformation.title\")}:\r\n              </div>\r\n            }\r\n            disableTypography\r\n          />\r\n          <Grid container spacing={2} className={classes.seriesAttributes}>\r\n            {otherAttributes.map(({dims, attributes}, idx) =>\r\n              <Grid\r\n                container\r\n                key={idx}\r\n                spacing={2}\r\n                className={classes.attributeGroup}\r\n                style={{background: idx % 2 ? \"#FFFFFF\" : \"#F5F5F5\"}}\r\n              >\r\n                <Grid item xs={12}>\r\n                  {dims.map(({id, value}, idx) =>\r\n                    <div key={idx} style={{display: \"inline-block\", marginRight: 8}}>\r\n                      <b>{id}</b>: <i>{value}</i>{idx < dims.length - 1 ? \",\" : \"\"}\r\n                    </div>\r\n                  )}\r\n                </Grid>\r\n                {attributes.map((attribute, idx) =>\r\n                  <Attribute\r\n                    key={idx}\r\n                    attribute={attribute}\r\n                    list\r\n                  />\r\n                )}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(AttributeList)","export const numberFormatter = (new Intl.NumberFormat()).format;\r\n\r\nexport const DECIMAL_SEPARATOR_DEFAULT = \",\";\r\nexport const DECIMAL_PLACES_DEFAULT = 2;\r\nexport const TABLE_EMPTY_CHAR_DEFAULT = \"\";\r\n\r\nconst getFormattedInt = (value, separator) => {\r\n  let str = value + \"\";\r\n  let subStrs = [];\r\n\r\n  while (str.length > 3) {\r\n    subStrs.push(str.slice(-3));\r\n    str = str.slice(0, -3)\r\n    subStrs.push((separator || \".\"));\r\n  }\r\n  if (str.length > 0) {\r\n    subStrs.push(str);\r\n  } else {\r\n    subStrs.pop()\r\n  }\r\n  subStrs.reverse();\r\n\r\n  let ret = \"\";\r\n  subStrs.forEach(subStr => ret += subStr);\r\n\r\n  return ret;\r\n};\r\n\r\nexport const getFormattedValue = (value, decimalSeparator, decimalPlaces, emptyChar) => {\r\n\r\n  if (value === null || value === undefined || (typeof value === \"string\" && value.length === 0)) {\r\n    return (emptyChar || TABLE_EMPTY_CHAR_DEFAULT);\r\n  }\r\n\r\n  if (isNaN(value)) {\r\n    return value;\r\n  }\r\n\r\n  const intSeparator = decimalSeparator === \".\" ? \",\" : \".\";\r\n\r\n  if (Number.isInteger(value)) {\r\n    return getFormattedInt(value, intSeparator);\r\n  }\r\n\r\n  const int = Math.floor(value);\r\n\r\n  if (decimalPlaces === 0 || DECIMAL_PLACES_DEFAULT === 0) {\r\n    return getFormattedInt(int, intSeparator);\r\n  }\r\n\r\n  const decimal = (value - int).toFixed(decimalPlaces || DECIMAL_PLACES_DEFAULT).slice(2);\r\n\r\n  return getFormattedInt(int, intSeparator) + (decimalSeparator || DECIMAL_SEPARATOR_DEFAULT) + decimal;\r\n}","import _ from \"lodash\"\r\n\r\nexport function getMaxTreeDepth(tree, childrenKey) {\r\n\r\n  const recursive = node =>\r\n    node\r\n      ? 1 + Math.max(...(node[childrenKey] || []).map(recursive), 0)\r\n      : 0;\r\n\r\n  return tree\r\n    ? Math.max(...tree.map(recursive), 0)\r\n    : 0;\r\n}\r\n\r\nexport function getNodesAtDepth(tree, childrenKey, depth) {\r\n\r\n  const res = [];\r\n\r\n  const recursive = (subTree, currDepth) =>\r\n    subTree\r\n      ? (\r\n        subTree.map(node => {\r\n          if (depth === currDepth) {\r\n            res.push(_.cloneDeep(node));\r\n          }\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            recursive(node[childrenKey], currDepth + 1);\r\n          }\r\n          return null;\r\n        })\r\n      )\r\n      : [];\r\n\r\n  recursive(tree, 1);\r\n\r\n  return res;\r\n}\r\n\r\nexport function getTreeFromArray(arr, parentKey, childrenKey) {\r\n  const mappedArr = {};\r\n  const tree = [];\r\n\r\n  // first map the nodes of the array to an object -> create a hash table.\r\n  arr.forEach(el => {\r\n    el[childrenKey] = [];\r\n    mappedArr[el.id] = el;\r\n  });\r\n\r\n  arr.forEach(el => {\r\n    if (el[parentKey]) {\r\n      // if the element is not at the root level, add it to its parent array of children.\r\n      mappedArr[el[parentKey]][childrenKey].push(el);\r\n    } else {\r\n      // if the element is at the root level, add it to first level elements array.\r\n      tree.push(el);\r\n    }\r\n  });\r\n\r\n  return tree;\r\n}\r\n\r\nexport function getNode(tree, childrenKey, test) {\r\n\r\n  if (!(tree !== null && tree.length)) return null;\r\n\r\n  const foundNodes = tree.filter(test);\r\n\r\n  if (foundNodes.length) {\r\n    return foundNodes[0];\r\n  } else {\r\n    const foundNodesInChild =\r\n      tree\r\n        .filter(node => node[childrenKey])\r\n        .map(node => getNode(node[childrenKey], childrenKey, test))\r\n        .filter(result => result !== null);\r\n\r\n    if (foundNodesInChild.length) {\r\n      return foundNodesInChild[0];\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getNodes(tree, childrenKey, test) {\r\n\r\n  const res = [];\r\n\r\n  const recursive = subTree =>\r\n    subTree\r\n      ? (\r\n        subTree.map(node => {\r\n          if (test && test(node)) {\r\n            res.push(_.cloneDeep(node));\r\n          }\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            recursive(node[childrenKey]);\r\n          }\r\n          return null;\r\n        })\r\n      )\r\n      : [];\r\n\r\n  recursive(tree);\r\n\r\n  return res;\r\n}","export const FETCH_DATASET_ASYNC_HANDLER_INIT = \"fetch/dataset/async/handler/init\"\r\nexport const FETCH_DATASET_ASYNC_HANDLER_SUCCESS = \"fetch/dataset/async/handler/success\"\r\nexport const FETCH_DATASET_ASYNC_HANDLER_ERROR = \"fetch/dataset/async/handler/error\"\r\n\r\nexport const initFetchDatasetAsyncHandler = () => ({\r\n  type: FETCH_DATASET_ASYNC_HANDLER_INIT\r\n});\r\n\r\nexport const successFetchDatasetAsyncHandler = (\r\n  response,\r\n  statusCode,\r\n  responseHeaders,\r\n  cellCount,\r\n  isTooBigData,\r\n  isEmptyData,\r\n  isPartialData,\r\n  isResponseNotValid,\r\n  tableLayout,\r\n  tableFilterTree,\r\n  mapLayout,\r\n  mapFilterTree,\r\n  chartLayout,\r\n  chartFilterTree,\r\n  worker\r\n) => ({\r\n  type: FETCH_DATASET_ASYNC_HANDLER_SUCCESS,\r\n  payload: {\r\n    response,\r\n    statusCode,\r\n    responseHeaders,\r\n    cellCount,\r\n    isTooBigData,\r\n    isEmptyData,\r\n    isPartialData,\r\n    isResponseNotValid,\r\n    tableLayout,\r\n    tableFilterTree,\r\n    mapLayout,\r\n    mapFilterTree,\r\n    chartLayout,\r\n    chartFilterTree,\r\n    worker\r\n  }\r\n});\r\n\r\nexport const errorFetchDatasetAsyncHandler = statusCode => ({\r\n  type: FETCH_DATASET_ASYNC_HANDLER_ERROR,\r\n  payload: {\r\n    statusCode\r\n  }\r\n});","export const getNutsLevelTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    0: t(\"nutsLevel0\"),\r\n    1: t(\"nutsLevel1\"),\r\n    2: t(\"nutsLevel2\"),\r\n    3: t(\"nutsLevel3\"),\r\n    4: t(\"nutsLevel4\"),\r\n    5: t(\"nutsLevel5\"),\r\n    6: t(\"nutsLevel6\"),\r\n    7: t(\"nutsLevel7\"),\r\n    8: t(\"nutsLevel8\"),\r\n    9: t(\"nutsLevel9\")\r\n  })\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};","import React, {Component, createRef, Fragment} from 'react';\r\nimport ChartJs from 'chart.js';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {getFormattedValue} from \"../../utils/formatters\";\r\nimport {\r\n  getDataIdxFromCoordinatesArray,\r\n  getDimensionValueLabelFromJsonStat,\r\n  getDimensionValuesIndexesMap,\r\n  TIME_PERIOD_DIMENSION_KEY\r\n} from \"../../utils/jsonStat\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport _ from \"lodash\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport \"chartjs-plugin-zoom\"\r\n\r\nexport const CHART_LEGEND_POSITION_TOP = \"top\";\r\nexport const CHART_LEGEND_POSITION_RIGHT = \"right\";\r\nexport const CHART_LEGEND_POSITION_BOTTOM = \"bottom\";\r\nexport const CHART_LEGEND_POSITION_lEFT = \"left\";\r\n\r\nexport const CHART_LEGEND_POSITION_DEFAULT = CHART_LEGEND_POSITION_TOP;\r\n\r\nconst DEFAULT_LEGEND_POSITION = CHART_LEGEND_POSITION_TOP;\r\nconst DEFAULT_STACKED = false;\r\nconst DEFAULT_COLORS = {};\r\nconst defaultColorArr = [\r\n  \"rgba(30, 136, 229, 0.3)\",\r\n  \"rgba(194, 24, 91, 0.3)\",\r\n  \"rgba(253, 216, 53, 0.3)\",\r\n  \"rgba(14, 157, 89, 0.3)\",\r\n  \"rgba(240, 98, 146, 0.3)\",\r\n  \"rgba(255, 112, 67, 0.3)\",\r\n  \"rgba(139, 195, 74, 0.3)\",\r\n  \"rgba(0, 188, 212, 0.3)\",\r\n  \"rgba(234, 63, 77, 0.3)\",\r\n  \"rgba(170, 71, 188, 0.3)\",\r\n  \"rgba(38, 166, 154, 0.3)\",\r\n  \"rgba(255, 152, 0, 0.3)\"\r\n];\r\n\r\nconst getChartType = type => {\r\n  switch (type) {\r\n    case \"area\":\r\n      return \"line\"\r\n    case \"pyramid\":\r\n      return \"horizontalBar\"\r\n    default:\r\n      return type\r\n  }\r\n};\r\n\r\nconst isBarChart = type => (type === \"bar\" || type === \"horizontalBar\" || type === \"pyramid\");\r\n\r\nconst isLineChart = type => (type === \"line\" || type === \"area\");\r\n\r\nconst isBarOrLineChart = type => (isBarChart(type) || isLineChart(type));\r\n\r\nconst getOptions = (chartType, data, decimalSeparator, decimalPlaces, legendPosition, stacked, disableMouseWheel) => {\r\n\r\n  let max = 0;\r\n  data.datasets.forEach(dataset => dataset.data.forEach(value => max = Math.max(max, Math.abs(value))));\r\n  max += Math.floor(max / 100 * 20);\r\n\r\n  return {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    scales: isBarOrLineChart(chartType)\r\n      ? {\r\n        xAxes: [{\r\n          gridLines: {\r\n            display: chartType !== \"bar\"\r\n          },\r\n          ticks: {\r\n            beginAtZero: (chartType === \"horizontalBar\" || chartType === \"pyramid\"),\r\n            callback: value => {\r\n              if (chartType === \"horizontalBar\" || chartType === \"pyramid\") {\r\n                if (chartType === \"pyramid\" && data.datasets.length === 2 && value < 0) {\r\n                  return getFormattedValue(-value, decimalSeparator, decimalPlaces)\r\n                } else {\r\n                  return getFormattedValue(value, decimalSeparator, decimalPlaces)\r\n                }\r\n              } else {\r\n                return value\r\n              }\r\n            },\r\n            max: chartType === \"pyramid\" ? max : undefined,\r\n            min: chartType === \"pyramid\" ? -(max) : undefined,\r\n          },\r\n          stacked: (chartType === \"pyramid\" || (isBarChart(chartType) && stacked))\r\n        }],\r\n        yAxes: [{\r\n          gridLines: {\r\n            display: (chartType !== \"horizontalBar\" && chartType !== \"pyramid\")\r\n          },\r\n          ticks: {\r\n            beginAtZero: (chartType !== \"horizontalBar\" && chartType !== \"pyramid\"),\r\n            callback: value => (chartType !== \"horizontalBar\" && chartType !== \"pyramid\")\r\n              ? getFormattedValue(value, decimalSeparator, decimalPlaces)\r\n              : value\r\n          },\r\n          stacked: (chartType === \"pyramid\" || (isBarChart(chartType) && stacked))\r\n        }]\r\n      }\r\n      : {},\r\n    legend: {\r\n      display: (!isBarOrLineChart(chartType) || (data.datasets || []).length > 1),\r\n      position: legendPosition\r\n    },\r\n    tooltips: {\r\n      enabled: true,\r\n      mode: \"index\",\r\n      callbacks: {\r\n        title: (tooltipItem, data) => (data.labels[tooltipItem[0].index] || ''),\r\n        label: (tooltipItem, data) => {\r\n          const getValue = () => {\r\n            let value = dataset.data[tooltipItem.index];\r\n            if (!value) {\r\n              return null;\r\n            }\r\n            value = getFormattedValue(value, decimalSeparator, decimalPlaces);\r\n            if (chartType === \"pyramid\" && data.datasets.length === 2 && tooltipItem.datasetIndex === 0 && value[0] === \"-\") {\r\n              return value.slice(1)\r\n            } else {\r\n              return value\r\n            }\r\n          };\r\n          const dataset = data.datasets[tooltipItem.datasetIndex];\r\n          const value = getValue();\r\n          return value ? `${dataset.label}: ${getValue()}` : null\r\n        }\r\n      }\r\n    },\r\n    plugins: disableMouseWheel\r\n      ? {}\r\n      : {\r\n        zoom: {\r\n          pan: {\r\n            enabled: isBarOrLineChart(chartType),\r\n            mode: () => (chartType === \"horizontalBar\" || chartType === \"pyramid\") ? \"x\" : \"y\"\r\n          },\r\n          zoom: {\r\n            enabled: isBarOrLineChart(chartType),\r\n            mode: () => (chartType === \"horizontalBar\" || chartType === \"pyramid\") ? \"x\" : \"y\"\r\n          }\r\n        }\r\n      }\r\n  }\r\n};\r\n\r\nconst getData = (chartType, jsonStat, layout, removeEmptyValues, labelFormat, colors) => {\r\n\r\n  const {\r\n    primaryDim: primaryDimArr,\r\n    primaryDimValues,\r\n    secondaryDim: secondaryDimArr,\r\n    secondaryDimValues,\r\n    filtersValue\r\n  } = layout;\r\n\r\n  const primaryDim = primaryDimArr[0];\r\n  const secondaryDim = secondaryDimArr[0];\r\n\r\n  const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n  const valorizedDataMap = {};\r\n  secondaryDimValues.forEach(secondaryDimValue => {\r\n    valorizedDataMap[secondaryDimValue] = new Array(primaryDimValues.length).fill(false);\r\n  });\r\n  const valorizedDataArr = new Array(primaryDimValues.length).fill(false);\r\n\r\n  const datasets = [];\r\n\r\n  if (secondaryDimValues && secondaryDimValues.length > 0) {\r\n    secondaryDimValues.forEach((secondaryDimValue, secDimIdx) => {\r\n      const data = [];\r\n      primaryDimValues.forEach((primaryDimValue, primDimIdx) => {\r\n        const dimValueArray = jsonStat.id.map(dim => {\r\n          if (dim === primaryDim) {\r\n            return primaryDimValue;\r\n          } else if (dim === secondaryDim) {\r\n            return secondaryDimValue;\r\n          } else {\r\n            return filtersValue[dim];\r\n          }\r\n        });\r\n        const valueIdx = getDataIdxFromCoordinatesArray(\r\n          dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n          jsonStat.size\r\n        );\r\n        const value = jsonStat.value[valueIdx];\r\n        if (value) {\r\n          if (chartType === \"pyramid\" && secondaryDimValues.length === 2 && secDimIdx === 0) {\r\n            data.push(-value);\r\n          } else {\r\n            data.push(value);\r\n          }\r\n          valorizedDataMap[secondaryDimValue][primDimIdx] = true;\r\n        } else {\r\n          data.push(null);\r\n        }\r\n      });\r\n      datasets.push({\r\n        label: getDimensionValueLabelFromJsonStat(jsonStat, secondaryDim, secondaryDimValue, labelFormat),\r\n        data: data\r\n      });\r\n    });\r\n\r\n  } else {\r\n    const data = [];\r\n    primaryDimValues.forEach((primaryDimValue, primDimIdx) => {\r\n      const dimValueArray = jsonStat.id.map(dim => {\r\n        if (dim === primaryDim) {\r\n          return primaryDimValue;\r\n        } else {\r\n          return filtersValue[dim];\r\n        }\r\n      });\r\n      const valueIdx = getDataIdxFromCoordinatesArray(\r\n        dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n        jsonStat.size\r\n      );\r\n      const value = jsonStat.value[valueIdx];\r\n      if (value) {\r\n        data.push(value);\r\n        valorizedDataArr[primDimIdx] = true;\r\n      } else {\r\n        data.push(null);\r\n      }\r\n    });\r\n    datasets.push({\r\n      label: \"\",\r\n      data: data\r\n    });\r\n  }\r\n\r\n  const labels = [];\r\n\r\n  const valorizedValues = (secondaryDimValues && secondaryDimValues.length > 0)\r\n    ? new Array(primaryDimValues.length)\r\n    : [...valorizedDataArr];\r\n\r\n  if (removeEmptyValues) {\r\n    if (secondaryDimValues && secondaryDimValues.length > 0) {\r\n      primaryDimValues.forEach((_, idx) => {\r\n        let found = false;\r\n        secondaryDimValues.forEach(secDim => {\r\n          if (!found && valorizedDataMap[secDim][idx] === true) {\r\n            found = true;\r\n          }\r\n        });\r\n        valorizedValues[idx] = found;\r\n      });\r\n    }\r\n\r\n    datasets.forEach(dataset => dataset.data = dataset.data.filter((_, idx) => valorizedValues[idx]));\r\n\r\n    primaryDimValues.forEach((value, idx) => {\r\n      if (valorizedValues[idx]) {\r\n        labels.push(getDimensionValueLabelFromJsonStat(jsonStat, primaryDim, value, labelFormat));\r\n      }\r\n    });\r\n\r\n  } else {\r\n    primaryDimValues.forEach(value => {\r\n      labels.push(getDimensionValueLabelFromJsonStat(jsonStat, primaryDim, value, labelFormat));\r\n    });\r\n  }\r\n\r\n  const getCorrespondingIndexInFilteredArray = (array, n) => {\r\n    let count = 0;\r\n    let res = 0;\r\n    let lastIdx = 0;\r\n    let found = false;\r\n\r\n    array.forEach((el, idx) => {\r\n      if (el === true) {\r\n        count++;\r\n        lastIdx = idx;\r\n        if (count === n + 1) {\r\n          res = idx;\r\n          found = true;\r\n        }\r\n      }\r\n    });\r\n\r\n    return found ? res : (lastIdx + 1);\r\n  };\r\n\r\n  const getColor = (datasetIdx, valIdx) => {\r\n    const colorIdx = (isBarOrLineChart(chartType) || chartType === \"radar\") ? datasetIdx : valIdx;\r\n    let color = defaultColorArr[colorIdx % defaultColorArr.length];\r\n\r\n    const idx = removeEmptyValues ? getCorrespondingIndexInFilteredArray(valorizedValues, valIdx) : valIdx;\r\n    if (!isBarOrLineChart(chartType) && chartType !== \"radar\") {\r\n      color = colors?.[primaryDim]?.[primaryDimValues[idx]] || color;\r\n    } else {\r\n      color = colors?.[primaryDim]?.[primaryDimValues[idx]] ||\r\n        colors?.[secondaryDim]?.[secondaryDimValues[datasetIdx]] ||\r\n        color;\r\n    }\r\n\r\n    return color\r\n  };\r\n\r\n  return {\r\n    labels: labels,\r\n    datasets: datasets.map((dataset, datasetIdx) => ({\r\n      ...dataset,\r\n      borderWidth: 1,\r\n      lineTension: chartType === \"area\" ? 0 : undefined,\r\n      fill: (chartType === \"area\" || chartType === \"radar\"),\r\n      backgroundColor: datasets[datasetIdx].data.map((_, idx) => getColor(datasetIdx, idx)),\r\n      borderColor: datasets[datasetIdx].data.map((_, idx) => getColor(datasetIdx, idx))\r\n    }))\r\n  };\r\n};\r\n\r\nconst getDefaultRemoveEmptyValues = (type, {primaryDim}) => !((type === \"line\" || type === \"area\") && primaryDim[0] === TIME_PERIOD_DIMENSION_KEY);\r\n\r\nclass Chart extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.chartRef = createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    const {\r\n      jsonStat,\r\n      type,\r\n      layout,\r\n      removeEmptyValues = getDefaultRemoveEmptyValues(type, layout),\r\n      labelFormat,\r\n      decimalSeparator,\r\n      decimalPlaces,\r\n      legendPosition = DEFAULT_LEGEND_POSITION,\r\n      stacked = DEFAULT_STACKED,\r\n      colors = DEFAULT_COLORS,\r\n      disableMouseWheel = false\r\n    } = this.props;\r\n\r\n    ChartJs.defaults.global.defaultFontFamily = \"'Roboto', 'Helvetica', 'Arial', sans-serif\";\r\n\r\n    const data = getData(type, jsonStat, layout, removeEmptyValues, labelFormat, colors);\r\n    this.myChart = new ChartJs(this.chartRef.current, {\r\n      type: getChartType(type),\r\n      options: getOptions(type, data, decimalSeparator, decimalPlaces, legendPosition, stacked, disableMouseWheel),\r\n      data: data,\r\n      plugins: [\r\n        {\r\n          beforeDraw: function (chart) {\r\n            const ctx = chart.chart.ctx;\r\n            ctx.fillStyle = \"white\";\r\n            ctx.fillRect(0, 0, chart.chart.width, chart.chart.height);\r\n          }\r\n        }\r\n      ]\r\n    });\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const {\r\n      jsonStat,\r\n      type,\r\n      layout,\r\n      removeEmptyValues = getDefaultRemoveEmptyValues(type, layout),\r\n      labelFormat,\r\n      decimalSeparator,\r\n      decimalPlaces,\r\n      legendPosition = DEFAULT_LEGEND_POSITION,\r\n      stacked = DEFAULT_STACKED,\r\n      colors = DEFAULT_COLORS,\r\n      disableMouseWheel = false\r\n    } = this.props;\r\n\r\n    if (\r\n      prevProps.jsonStat !== jsonStat ||\r\n      prevProps.type !== type ||\r\n      !_.isEqual(prevProps.layout, layout) ||\r\n      prevProps.labelFormat !== labelFormat ||\r\n      prevProps.legendPosition !== legendPosition ||\r\n      prevProps.stacked !== stacked ||\r\n      !_.isEqual(prevProps.colors, colors)\r\n    ) {\r\n      const data = getData(type, jsonStat, layout, removeEmptyValues, labelFormat, colors);\r\n      this.myChart.config.type = getChartType(type);\r\n      this.myChart.options = getOptions(type, data, decimalSeparator, decimalPlaces, legendPosition, stacked, disableMouseWheel);\r\n      this.myChart.data = data;\r\n      this.myChart.update();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      t,\r\n      chartId = `cart__${uuidv4()}`,\r\n      type,\r\n      layout\r\n    } = this.props;\r\n\r\n    const hideChart = (type === \"pyramid\" && ((layout.secondaryDim || []).length !== 1 || (layout.secondaryDimValues || []).length !== 2));\r\n\r\n    return (\r\n      <Fragment>\r\n        {hideChart && (\r\n          <CustomEmpty text={t(\"components.chart.pyramid.invalidSecondaryDimension\")}/>\r\n        )}\r\n        <canvas\r\n          id={chartId}\r\n          ref={this.chartRef}\r\n          style={{\r\n            display: hideChart ? \"none\" : \"block\"\r\n          }}\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withTranslation()(Chart);","import {Reducer} from \"@reduxjs/toolkit\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  ALL_FULL,\r\n  ALL_PARTIAL,\r\n  CRITERIA_SELECTION_MODE_ALL,\r\n  CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n  CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n  CRITERIA_SELECTION_TYPE_FULL,\r\n  CRITERIA_SELECTION_TYPE_PARTIAL,\r\n  DATASET_ACCESSIBLE_FETCH,\r\n  DATASET_CHART_COLORS_SET,\r\n  DATASET_CHART_FILTERS_TREE_SUBMIT,\r\n  DATASET_CHART_LAYOUT_SUBMIT,\r\n  DATASET_CHART_LEGEND_POSITION_SET,\r\n  DATASET_CHART_STACKED_SET,\r\n  DATASET_CRITERIA_ALERT_HIDE,\r\n  DATASET_CRITERIA_HIDE,\r\n  DATASET_CRITERIA_LENGTH_WARNING_HIDE,\r\n  DATASET_CRITERIA_LENGTH_WARNING_SHOW,\r\n  DATASET_CRITERIA_SHOW,\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  DATASET_DOWNLOAD_WARNING_HIDE,\r\n  DATASET_FETCH_ENABLE,\r\n  DATASET_HTML_GENERATING_TIME_SET,\r\n  DATASET_LABEL_FORMAT_SET,\r\n  DATASET_MAP_DETAIL_LEVEL_SET,\r\n  DATASET_MAP_LAYOUT_SUBMIT,\r\n  DATASET_STATE_BACKUP,\r\n  DATASET_STATE_RESET,\r\n  DATASET_STRUCTURE_CODELIST_CRITERIA_SET,\r\n  DATASET_STRUCTURE_CODELIST_FETCH,\r\n  DATASET_STRUCTURE_CODELIST_TIME_PERIOD_SET,\r\n  DATASET_STRUCTURE_CODELISTS_FETCH,\r\n  DATASET_STRUCTURE_FETCH,\r\n  DATASET_STRUCTURE_FETCH_ENABLE,\r\n  DATASET_TABLE_FILTERS_TREE_SUBMIT,\r\n  DATASET_TABLE_LAYOUT_SUBMIT,\r\n  DATASET_TERRITORY_FETCH,\r\n  DATASET_UNAVAILABLE_VIEW_WARNING_HIDE,\r\n  DATASET_VIEW_ERROR_HIDE,\r\n  DATASET_VIEW_TEMPLATE_HIDE,\r\n  DATASET_VIEW_TEMPLATE_SHOW,\r\n  DATASET_VIEW_TEMPLATE_SUBMIT,\r\n  DATASET_VIEWER_SET,\r\n  STEP_BY_STEP_FULL,\r\n  STEP_BY_STEP_PARTIAL\r\n} from \"./datasetActions\";\r\nimport {getTreeFromArray} from \"../../utils/tree\";\r\nimport {FREQ_DIMENSION_KEY, TIME_PERIOD_DIMENSION_KEY} from \"../../utils/jsonStat\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../../components/label-format-selector/constants\";\r\nimport {getViewerIdxFromType, getViewerTypeFromIdx} from \"../../components/data-viewer\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  FETCH_DATASET_ASYNC_HANDLER_ERROR,\r\n  FETCH_DATASET_ASYNC_HANDLER_INIT,\r\n  FETCH_DATASET_ASYNC_HANDLER_SUCCESS\r\n} from \"../../middlewares/fetchDatasetAsyncHandler/actions\";\r\nimport {\r\n  CRITERIA_FILTER_TYPE_CODES,\r\n  CRITERIA_FILTER_TYPE_PERIODS,\r\n  CRITERIA_FILTER_TYPE_RANGE,\r\n  getCriteriaArrayFromObject,\r\n  getCriteriaObjectFromArray,\r\n  getFreq,\r\n  getTimePeriod\r\n} from \"../../utils/criteria\";\r\nimport _ from \"lodash\";\r\nimport {getNutsLevelTranslations} from \"../../constants/getNutsLevelTranslations\";\r\nimport {CHART_LEGEND_POSITION_DEFAULT} from \"../../components/chart\";\r\nimport {TABLE_EMPTY_CHAR_DEFAULT} from \"../../utils/formatters\";\r\n\r\nexport const GENERATING_HTML_TIME_KEY = \"generatingHtml\";\r\nexport const OBSERVATION_COUNT_KEY = \"observationCount\";\r\nexport const SERVER_TIMINGS_KEY = \"serverTimings\";\r\n\r\nconst MAX_ALLOWED_CELLS = 1000000;\r\n\r\ntype TimePeriod = {\r\n  selectorType: string,\r\n  freq: string | null,\r\n  minDate: string | null,\r\n  maxDate: string | null,\r\n  fromDate: string | null,\r\n  toDate: string | null,\r\n  periods: number | null,\r\n  missingRange: boolean\r\n};\r\n\r\nconst initialTimePeriod = {\r\n  selectorType: CRITERIA_FILTER_TYPE_RANGE,\r\n  freq: null,\r\n  minDate: null,\r\n  maxDate: null,\r\n  fromDate: null,\r\n  toDate: null,\r\n  periods: null,\r\n  missingRange: false\r\n};\r\n\r\ntype DatasetState = {\r\n  datasetId: string | null,\r\n  nodeCode: string | null\r\n  categoryPath: string[] | null,\r\n  viewId: string | null,\r\n  dataset: any | null,\r\n  accessibleDataset: string | null,\r\n  isPartialData: boolean,\r\n  isEmptyData: boolean,\r\n  isTooBigData: boolean,\r\n  isCriteriaVisible: boolean,\r\n  isCriteriaAlertVisible: boolean,\r\n  dimensions: any[] | null,\r\n  mode: string | null,\r\n  type: string | null,\r\n  viewerIdx: number,\r\n  view: any | null,\r\n  template: any | null,\r\n  hasViewLayout: boolean,\r\n  hasTemplateLayout: boolean,\r\n  hasAnnotationLayout: boolean,\r\n  tableLayout: any | null,\r\n  mapLayout: any | null,\r\n  chartLayout: any | null,\r\n  tableFilterTree: any | null,\r\n  mapFilterTree: any | null,\r\n  chartFilterTree: any | null,\r\n  labelFormat: string | null,\r\n  criteria: object,\r\n  initialCriteria: any | null,\r\n  decimalSeparator: string | null,\r\n  decimalPlaces: number | null\r\n  tableEmptyChar: string,\r\n  chartStacked: boolean,\r\n  chartLegendPosition: string,\r\n  chartColors: any,\r\n  mapDetailLevel: number | null,\r\n  enableCriteria: boolean,\r\n  enableLayout: boolean,\r\n  maxAllowedCells: number,\r\n  codes: any[] | null,\r\n  isCodesFlat: boolean,\r\n  codelists: any[] | null,\r\n  areCodelistsFlat: boolean[],\r\n  codelistsLength: number[] | null,\r\n  timePeriod: TimePeriod,\r\n  timings: any | null,\r\n  isFetchStructureDisabled: boolean,\r\n  isFetchDatasetDisabled: boolean,\r\n  isDownloadWarningVisible: boolean,\r\n  isUnavailableViewWarningVisible: boolean,\r\n  isCriteriaLengthWarningVisible: boolean,\r\n  geometries: any | null,\r\n  geometryDetailLevels: any | null,\r\n  backup: any | null,\r\n  isViewVisible: boolean,\r\n  isViewErrorVisible: boolean,\r\n  viewErrorMessage: string | null,\r\n  isTemplateVisible: boolean\r\n};\r\n\r\nconst initialState = {\r\n  datasetId: null,\r\n  nodeCode: null,\r\n  categoryPath: null,\r\n  viewId: null,\r\n  dataset: null,\r\n  accessibleDataset: null,\r\n  isPartialData: false,\r\n  isEmptyData: false,\r\n  isTooBigData: false,\r\n  isCriteriaVisible: false,\r\n  isCriteriaAlertVisible: false,\r\n  dimensions: null,\r\n  mode: null,\r\n  type: null,\r\n  viewerIdx: 0,\r\n  view: null,\r\n  template: null,\r\n  hasViewLayout: false,\r\n  hasTemplateLayout: false,\r\n  hasAnnotationLayout: false,\r\n  tableLayout: null,\r\n  mapLayout: null,\r\n  chartLayout: null,\r\n  tableFilterTree: null,\r\n  mapFilterTree: null,\r\n  chartFilterTree: null,\r\n  labelFormat: null,\r\n  criteria: {},\r\n  initialCriteria: null,\r\n  decimalSeparator: null,\r\n  decimalPlaces: null,\r\n  tableEmptyChar: TABLE_EMPTY_CHAR_DEFAULT,\r\n  chartStacked: false,\r\n  chartLegendPosition: CHART_LEGEND_POSITION_DEFAULT,\r\n  chartColors: {},\r\n  mapDetailLevel: null,\r\n  enableCriteria: true,\r\n  enableLayout: true,\r\n  maxAllowedCells: MAX_ALLOWED_CELLS,\r\n  codes: null,\r\n  isCodesFlat: false,\r\n  codelists: null,\r\n  areCodelistsFlat: [],\r\n  codelistsLength: null,\r\n  timePeriod: initialTimePeriod,\r\n  timings: null,\r\n  isFetchStructureDisabled: true,\r\n  isFetchDatasetDisabled: true,\r\n  isDownloadWarningVisible: false,\r\n  isUnavailableViewWarningVisible: false,\r\n  isCriteriaLengthWarningVisible: false,\r\n  geometries: null,\r\n  geometryDetailLevels: null,\r\n  backup: null,\r\n  isViewVisible: false,\r\n  isViewErrorVisible: false,\r\n  viewErrorMessage: null,\r\n  isTemplateVisible: false\r\n};\r\n\r\nconst datasetReducer: Reducer<DatasetState> = (\r\n  state = initialState,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case DATASET_STATE_BACKUP: {\r\n      return {\r\n        ...initialState,\r\n        backup: {\r\n          viewId: state.viewId,\r\n          datasetId: state.datasetId,\r\n          nodeCode: state.nodeCode,\r\n          categoryPath: state.categoryPath,\r\n          template: {\r\n            defaultView: getViewerTypeFromIdx(state.viewerIdx),\r\n            criteria: getCriteriaArrayFromObject(state.criteria),\r\n            layouts: JSON.stringify({\r\n              labelFormat: state.labelFormat,\r\n              tableLayout: state.tableLayout,\r\n              mapLayout: state.mapLayout,\r\n              chartLayout: state.chartLayout,\r\n              tableEmptyChar: state.tableEmptyChar,\r\n              chartStacked: state.chartStacked,\r\n              chartLegendPosition: state.chartLegendPosition,\r\n              chartColors: state.chartColors,\r\n              mapDetailLevel: state.mapDetailLevel\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n    case DATASET_STATE_RESET: {\r\n      return {\r\n        ...initialState,\r\n        backup: state.backup\r\n      }\r\n    }\r\n    case DATASET_STRUCTURE_FETCH_ENABLE: {\r\n      return {\r\n        ...state,\r\n        isFetchStructureDisabled: false,\r\n        datasetId: action.payload.datasetId,\r\n        nodeCode: action.payload.nodeCode,\r\n        categoryPath: action.payload.categoryPath,\r\n        viewId: (action.payload.viewId || null)\r\n      }\r\n    }\r\n    case DATASET_FETCH_ENABLE: {\r\n      return {\r\n        ...state,\r\n        isFetchDatasetDisabled: false\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_SHOW: {\r\n      return {\r\n        ...state,\r\n        isCriteriaVisible: true\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaVisible: false,\r\n        criteria: state.initialCriteria,\r\n        codes: null,\r\n        isCodesFlat: false,\r\n        codelists: null,\r\n        areCodelistsFlat: [],\r\n        timePeriod: initialTimePeriod\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_ALERT_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaAlertVisible: false\r\n      }\r\n    }\r\n    case DATASET_STRUCTURE_CODELIST_CRITERIA_SET: {\r\n      return {\r\n        ...state,\r\n        criteria: action.criteria,\r\n        timePeriod: {\r\n          ...state.timePeriod,\r\n          freq: action.criteria[FREQ_DIMENSION_KEY]\r\n            ? getFreq(action.criteria)\r\n            : state.timePeriod.freq\r\n        }\r\n      }\r\n    }\r\n    case DATASET_STRUCTURE_CODELIST_TIME_PERIOD_SET: {\r\n      let newCriteria = _.cloneDeep(state.criteria);\r\n      const type = (action.timePeriod.selectorType || CRITERIA_FILTER_TYPE_RANGE);\r\n\r\n      newCriteria = {\r\n        ...newCriteria,\r\n        [TIME_PERIOD_DIMENSION_KEY]: (type === CRITERIA_FILTER_TYPE_PERIODS && action.timePeriod.periods === null)\r\n          ? undefined\r\n          : {\r\n            id: TIME_PERIOD_DIMENSION_KEY,\r\n            type: type,\r\n            filterValues: null,\r\n            period: type === CRITERIA_FILTER_TYPE_PERIODS ? action.timePeriod.periods : null,\r\n            from: type === CRITERIA_FILTER_TYPE_RANGE ? action.timePeriod.fromDate : null,\r\n            to: type === CRITERIA_FILTER_TYPE_RANGE ? action.timePeriod.toDate : null\r\n          }\r\n      };\r\n\r\n      return {\r\n        ...state,\r\n        timePeriod: action.timePeriod,\r\n        criteria: newCriteria\r\n      }\r\n    }\r\n    case DATASET_VIEWER_SET: {\r\n      return {\r\n        ...state,\r\n        viewerIdx: action.viewerIdx\r\n      }\r\n    }\r\n    case DATASET_TABLE_LAYOUT_SUBMIT: {\r\n      return {\r\n        ...state,\r\n        tableLayout: action.layout\r\n      }\r\n    }\r\n    case DATASET_TABLE_FILTERS_TREE_SUBMIT: {\r\n      return {\r\n        ...state,\r\n        tableFilterTree: action.filterTree\r\n      }\r\n    }\r\n    case DATASET_MAP_LAYOUT_SUBMIT: {\r\n      return {\r\n        ...state,\r\n        mapLayout: action.layout\r\n      }\r\n    }\r\n    case DATASET_CHART_LAYOUT_SUBMIT: {\r\n      return {\r\n        ...state,\r\n        chartLayout: action.layout\r\n      }\r\n    }\r\n    case DATASET_CHART_FILTERS_TREE_SUBMIT: {\r\n      return {\r\n        ...state,\r\n        chartFilterTree: action.filterTree\r\n      }\r\n    }\r\n    case DATASET_LABEL_FORMAT_SET: {\r\n      return {\r\n        ...state,\r\n        labelFormat: action.labelFormat\r\n      }\r\n    }\r\n    case DATASET_CHART_STACKED_SET: {\r\n      return {\r\n        ...state,\r\n        chartStacked: action.stacked\r\n      }\r\n    }\r\n    case DATASET_CHART_LEGEND_POSITION_SET: {\r\n      return {\r\n        ...state,\r\n        chartLegendPosition: action.legendPosition\r\n      }\r\n    }\r\n    case DATASET_CHART_COLORS_SET: {\r\n      return {\r\n        ...state,\r\n        chartColors: action.colors\r\n      }\r\n    }\r\n    case DATASET_MAP_DETAIL_LEVEL_SET: {\r\n      return {\r\n        ...state,\r\n        mapDetailLevel: action.detailLevel\r\n      }\r\n    }\r\n    case DATASET_DOWNLOAD_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isDownloadWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_UNAVAILABLE_VIEW_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isUnavailableViewWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_LENGTH_WARNING_SHOW: {\r\n      return {\r\n        ...state,\r\n        isCriteriaLengthWarningVisible: true,\r\n        isFetchDatasetDisabled: true\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_LENGTH_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaLengthWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_HTML_GENERATING_TIME_SET: {\r\n      return {\r\n        ...state,\r\n        timings: {\r\n          ...state.timings,\r\n          [GENERATING_HTML_TIME_KEY]: action.time\r\n        }\r\n      }\r\n    }\r\n    case FETCH_DATASET_ASYNC_HANDLER_INIT: {\r\n      return {\r\n        ...state,\r\n        dataset: null,\r\n        isFetchDatasetDisabled: true\r\n      }\r\n    }\r\n    case FETCH_DATASET_ASYNC_HANDLER_SUCCESS: {\r\n      if (action.payload.worker) {\r\n        action.payload.worker.terminate();\r\n      }\r\n      return {\r\n        ...state,\r\n        dataset: (action.payload.response?.id || \"\").length !== 0 ? action.payload.response : null,\r\n\r\n        isTooBigData: action.payload.isTooBigData,\r\n        isEmptyData: action.payload.isEmptyData,\r\n        isPartialData: action.payload.isPartialData,\r\n\r\n        isCriteriaVisible: action.payload.isResponseNotValid,\r\n        isCriteriaAlertVisible: action.payload.isResponseNotValid,\r\n\r\n        tableLayout: action.payload.tableLayout,\r\n        mapLayout: action.payload.mapLayout,\r\n        chartLayout: action.payload.chartLayout,\r\n\r\n        tableFilterTree: action.payload.tableFilterTree,\r\n        mapFilterTree: action.payload.mapFilterTree,\r\n        chartFilterTree: action.payload.chartFilterTree,\r\n\r\n        initialCriteria: action.payload.isResponseNotValid ? state.initialCriteria : state.criteria,\r\n\r\n        codes: action.payload.isResponseNotValid ? state.codes : null,\r\n        isCodesFlat: action.payload.isResponseNotValid ? state.isCodesFlat : false,\r\n        codelists: action.payload.isResponseNotValid ? state.codelists : null,\r\n        areCodelistsFlat: action.payload.isResponseNotValid ? state.areCodelistsFlat : [],\r\n        // timePeriod: action.payload.isResponseNotValid\r\n        //   ? initialTimePeriod\r\n        //   : state.timePeriod,\r\n        isCriteriaLengthWarningVisible: false,\r\n        timings: {\r\n          [OBSERVATION_COUNT_KEY]: action.payload.response?.value ? Object.keys(action.payload.response.value).length : null,\r\n          [SERVER_TIMINGS_KEY]: action.payload.responseHeaders.backendtimers\r\n            ? JSON.parse(action.payload.responseHeaders.backendtimers)\r\n            : null\r\n        }\r\n      }\r\n    }\r\n    case FETCH_DATASET_ASYNC_HANDLER_ERROR: {\r\n      const isPayloadTooLarge = action.payload.statusCode === 413\r\n      return {\r\n        ...state,\r\n        dataset: null,\r\n        accessibleDataset: null,\r\n        isPartialData: false,\r\n        isEmptyData: false,\r\n        isTooBigData: isPayloadTooLarge,\r\n        isCriteriaAlertVisible: isPayloadTooLarge\r\n      }\r\n    }\r\n    case DATASET_VIEW_TEMPLATE_SHOW: {\r\n      return {\r\n        ...state,\r\n        isViewVisible: action.isView ? true : state.isViewVisible,\r\n        isTemplateVisible: !action.isView ? true : state.isTemplateVisible\r\n      }\r\n    }\r\n    case DATASET_VIEW_TEMPLATE_HIDE: {\r\n      return {\r\n        ...state,\r\n        isViewVisible: action.isView ? false : state.isViewVisible,\r\n        isTemplateVisible: !action.isView ? false : state.isTemplateVisible\r\n      }\r\n    }\r\n    case DATASET_VIEW_ERROR_HIDE: {\r\n      return {\r\n        ...state,\r\n        isViewErrorVisible: false,\r\n        viewErrorMessage: null\r\n      }\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          return {\r\n            ...state,\r\n            isFetchStructureDisabled: true\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n          return {\r\n            ...state,\r\n            codes: null,\r\n            isCodesFlat: false\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          const criteriaView = action.payload.response.criteriaView;\r\n\r\n          const VIEW_KEY = \"view\";\r\n          const TEMPLATE_KEY = \"template\";\r\n\r\n          let viewTemplate = action.payload.response[VIEW_KEY]\r\n            ? action.payload.response[VIEW_KEY]\r\n            : action.payload.response[TEMPLATE_KEY]\r\n              ? action.payload.response[TEMPLATE_KEY]\r\n              : null;\r\n\r\n          const hasBackup = state.backup !== null && (\r\n            state.backup.nodeCode === state.nodeCode &&\r\n            (state.backup.categoryPath || []).join() === (state.categoryPath || []).join() &&\r\n            state.backup.datasetId === state.datasetId &&\r\n            (state.backup.viewId || \"\") === (state.viewId || \"\")\r\n          );\r\n\r\n          if (hasBackup) {\r\n            viewTemplate = {\r\n              ...viewTemplate,\r\n              ...state.backup?.template\r\n            }\r\n          }\r\n\r\n          let viewTemplateLayouts = viewTemplate\r\n            ? JSON.parse(viewTemplate.layouts)\r\n            : null;\r\n\r\n          if (action.payload.response[VIEW_KEY]) {\r\n            if (action.payload.response[TEMPLATE_KEY]) {\r\n              const templateLayouts = JSON.parse(action.payload.response[TEMPLATE_KEY].layouts);\r\n\r\n              viewTemplate = {\r\n                ...viewTemplate,\r\n                enableCriteria: action.payload.response[TEMPLATE_KEY].enableCriteria,\r\n                enableLayout: action.payload.response[TEMPLATE_KEY].enableLayout,\r\n                decimalNumber: action.payload.response[TEMPLATE_KEY].decimalNumber,\r\n                decimalSeparator: action.payload.response[TEMPLATE_KEY].decimalSeparator,\r\n              }\r\n              viewTemplateLayouts = {\r\n                ...viewTemplateLayouts,\r\n                tableLayout: (viewTemplateLayouts.tableLayout || templateLayouts.tableLayout),\r\n                tableEmptyChar: templateLayouts.tableEmptyChar,\r\n                mapLayout: (viewTemplateLayouts.mapLayout || templateLayouts.mapLayout),\r\n                chartLayout: (viewTemplateLayouts.chartLayout || templateLayouts.chartLayout)\r\n              }\r\n\r\n            } else {\r\n              viewTemplate = {\r\n                ...viewTemplate,\r\n                enableCriteria: true,\r\n                enableLayout: true\r\n              }\r\n            }\r\n          }\r\n\r\n          const tableLayout = viewTemplateLayouts?.tableLayout\r\n            ? viewTemplateLayouts.tableLayout\r\n            : action.payload.response.layout\r\n              ? action.payload.response.layout\r\n              : null;\r\n\r\n          const mapLayout = viewTemplateLayouts?.mapLayout\r\n            ? viewTemplateLayouts.mapLayout\r\n            : null;\r\n\r\n          const chartLayout = viewTemplateLayouts?.chartLayout\r\n            ? viewTemplateLayouts.chartLayout\r\n            : action.payload.response.layoutChart\r\n              ? {\r\n                ...action.payload.response.layoutChart,\r\n                filters: undefined\r\n              }\r\n              : null;\r\n\r\n          let structureCriteria = viewTemplate\r\n            ? viewTemplate.criteria\r\n            : (action.payload.response.filters && action.payload.response.filters.filterData)\r\n              ? action.payload.response.filters.filterData\r\n              : null;\r\n\r\n          const criteria = getCriteriaObjectFromArray(structureCriteria);\r\n\r\n          return {\r\n            ...state,\r\n            backup: null,\r\n            hasViewLayout: !!action.payload.response[VIEW_KEY],\r\n            hasTemplateLayout: !!action.payload.response[TEMPLATE_KEY],\r\n            hasAnnotationLayout: !!action.payload.response.layout,\r\n            view: action.payload.response[VIEW_KEY]\r\n              ? {\r\n                ...action.payload.response[VIEW_KEY],\r\n                layouts: JSON.parse(action.payload.response[VIEW_KEY].layouts)\r\n              }\r\n              : null,\r\n            template: action.payload.response[TEMPLATE_KEY]\r\n              ? {\r\n                ...action.payload.response[TEMPLATE_KEY],\r\n                layouts: JSON.parse(action.payload.response[TEMPLATE_KEY].layouts)\r\n              }\r\n              : null,\r\n            dimensions: action.payload.response.criteria,\r\n            mode: (criteriaView === ALL_FULL || criteriaView === ALL_PARTIAL)\r\n              ? CRITERIA_SELECTION_MODE_ALL\r\n              : CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n            type: (criteriaView === ALL_FULL || criteriaView === STEP_BY_STEP_FULL)\r\n              ? CRITERIA_SELECTION_TYPE_FULL\r\n              : (criteriaView === ALL_PARTIAL || criteriaView === STEP_BY_STEP_PARTIAL)\r\n                ? CRITERIA_SELECTION_TYPE_PARTIAL\r\n                : CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n            codelistsLength: state.codelistsLength ? state.codelistsLength : action.payload.response.criteria.map(() => null),\r\n            isCriteriaVisible: (tableLayout === null && chartLayout === null && mapLayout === null && structureCriteria === null),\r\n            viewerIdx: viewTemplate ? getViewerIdxFromType(viewTemplate.defaultView) : 0,\r\n            isUnavailableViewWarningVisible: (!!action.payload.extra?.viewId && !action.payload.response?.[VIEW_KEY]),\r\n            tableLayout: tableLayout,\r\n            mapLayout: mapLayout,\r\n            chartLayout: chartLayout,\r\n            labelFormat: (viewTemplateLayouts?.labelFormat || LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME),\r\n            criteria: criteria,\r\n            initialCriteria: criteria,\r\n            decimalSeparator: (Object.keys(viewTemplate?.decimalSeparator || {}).length > 0)\r\n              ? localizeI18nObj(viewTemplate.decimalSeparator, action.payload.extra.defaultlanguage, action.payload.extra.languages)\r\n              : action.payload.response.decimalSeparator,\r\n            decimalPlaces: (viewTemplate?.decimalNumber || action.payload.response.decimalPlaces),\r\n            tableEmptyChar: (viewTemplateLayouts?.tableEmptyChar || action.payload.response.emptyCellPlaceHolder || state.tableEmptyChar),\r\n            chartStacked: (viewTemplateLayouts?.chartStacked || state.chartStacked),\r\n            chartLegendPosition: (viewTemplateLayouts?.chartLegendPosition || state.chartLegendPosition),\r\n            chartColors: (viewTemplateLayouts?.chartColors || state.chartColors),\r\n            mapDetailLevel: (viewTemplateLayouts?.mapDetailLevel || state.chartColors),\r\n            enableCriteria: viewTemplate?.enableCriteria !== false,\r\n            enableLayout: viewTemplate?.enableLayout !== false,\r\n            isFetchDatasetDisabled: !(action.payload.extra.isAccessible || !!tableLayout || !!chartLayout || !!mapLayout || !!structureCriteria),\r\n            maxAllowedCells: (action.payload.response.maxTableCells || MAX_ALLOWED_CELLS)\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n\r\n          const dimensionCodelist = action.payload.response.criteria[0] || {};\r\n\r\n          let flatCodes = dimensionCodelist.values ? dimensionCodelist.values : [];\r\n          const codelistIdx = dimensionCodelist.id ? (state.dimensions || []).map(({id}: any) => id).indexOf(dimensionCodelist.id) : -1;\r\n\r\n          const newCodelistsLength = state.codelistsLength ? [...state.codelistsLength] : [];\r\n          if (codelistIdx >= 0 && dimensionCodelist.id !== TIME_PERIOD_DIMENSION_KEY) {\r\n            newCodelistsLength[codelistIdx] = flatCodes.length;\r\n          }\r\n\r\n          let isCodesFlat = true;\r\n          flatCodes.forEach((item: any) => {\r\n            if (isCodesFlat && item.parentId !== null && item.parentId !== undefined) {\r\n              isCodesFlat = false;\r\n            }\r\n          });\r\n\r\n          let newCriteria = _.cloneDeep(state.criteria);\r\n          if (dimensionCodelist.id !== TIME_PERIOD_DIMENSION_KEY && flatCodes.length === 1) {\r\n            newCriteria = {\r\n              ...newCriteria,\r\n              [dimensionCodelist.id]: {\r\n                id: dimensionCodelist.id,\r\n                type: CRITERIA_FILTER_TYPE_CODES,\r\n                filterValues: [flatCodes[0].id],\r\n              }\r\n            }\r\n          }\r\n\r\n          return {\r\n            ...state,\r\n            codes: getTreeFromArray((flatCodes || []), \"parentId\", \"children\"),\r\n            isCodesFlat: isCodesFlat,\r\n            timePeriod: getTimePeriod(\r\n              state.timePeriod,\r\n              state.criteria,\r\n              dimensionCodelist.id === TIME_PERIOD_DIMENSION_KEY ? dimensionCodelist : null,\r\n              dimensionCodelist.id === FREQ_DIMENSION_KEY ? dimensionCodelist : null\r\n            ),\r\n            codelistsLength: newCodelistsLength,\r\n            criteria: newCriteria\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELISTS_FETCH: {\r\n\r\n          const dimensionCodelists = (state.dimensions || []).map(({id: dimensionId}) => {\r\n            const found = action.payload.response.criteria.find((criteria: any) => criteria.id === dimensionId);\r\n            return {\r\n              id: dimensionId,\r\n              values: (found?.values || [])\r\n            }\r\n          });\r\n\r\n          const flatCodelists = dimensionCodelists ? dimensionCodelists.map(({values}: any) => (values || [])) : [];\r\n\r\n          let areCodelistsFlat = flatCodelists.map(() => true);\r\n          flatCodelists.forEach((codelist: any, idx: number) => {\r\n            codelist.forEach((item: any) => {\r\n              if (areCodelistsFlat[idx] && item.parentId !== null && item.parentId !== undefined) {\r\n                areCodelistsFlat[idx] = false;\r\n              }\r\n            })\r\n          })\r\n\r\n          const timePeriodIdx = (state.dimensions || []).map(({id}: any) => id).indexOf(TIME_PERIOD_DIMENSION_KEY);\r\n          const freqIdx = (state.dimensions || []).map(({id}: any) => id).indexOf(FREQ_DIMENSION_KEY);\r\n\r\n          let newCriteria = _.cloneDeep(state.criteria);\r\n          dimensionCodelists.forEach((dimensionCodelist, idx) => {\r\n            if (dimensionCodelist.id !== TIME_PERIOD_DIMENSION_KEY && flatCodelists[idx].length === 1) {\r\n              newCriteria = {\r\n                ...newCriteria,\r\n                [dimensionCodelist.id]: {\r\n                  id: dimensionCodelist.id,\r\n                  type: CRITERIA_FILTER_TYPE_CODES,\r\n                  filterValues: [flatCodelists[idx][0].id],\r\n                }\r\n              }\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            codelists: flatCodelists.map((flatCodes: any) => getTreeFromArray((flatCodes || []), \"parentId\", \"children\")),\r\n            areCodelistsFlat: areCodelistsFlat,\r\n            timePeriod: getTimePeriod(\r\n              state.timePeriod,\r\n              state.criteria,\r\n              dimensionCodelists[timePeriodIdx],\r\n              dimensionCodelists[freqIdx]\r\n            ),\r\n            codelistsLength: flatCodelists.map((codelist: any, idx: number) => idx !== timePeriodIdx ? codelist.length : null),\r\n            criteria: newCriteria\r\n          }\r\n        }\r\n        case DATASET_ACCESSIBLE_FETCH: {\r\n          return {\r\n            ...state,\r\n            accessibleDataset: action.payload.response\r\n          }\r\n        }\r\n        case DATASET_TERRITORY_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any) => val.nutsLevel)\r\n            .reduce((acc: any, level: any) => {\r\n              if (!acc[level]) {\r\n                // @ts-ignore\r\n                const label = getNutsLevelTranslations(action.payload.extra.t)[level];\r\n                acc[level] = {level: level, counter: 0, label: (label || `nutsLevel${level}`)};\r\n              }\r\n              acc[level].counter++;\r\n              return acc;\r\n            }, [])\r\n            .filter((v: any) => {\r\n              if (!v) {\r\n                return false\r\n              }\r\n              if (v.counter <= 1) {\r\n                console.log(\"hiding NUTS level \" + v.level + \" (size = \" + v.counter + \")\");\r\n              }\r\n              return v.counter > 1\r\n            })\r\n            .sort((a: any, b: any) => a.level - b.level);\r\n\r\n          return {\r\n            ...state,\r\n            geometries: action.payload.response,\r\n            geometryDetailLevels: detailLevels\r\n          }\r\n        }\r\n        case DATASET_VIEW_TEMPLATE_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            isViewVisible: false,\r\n            isTemplateVisible: false\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          return {\r\n            ...initialState,\r\n            enableCriteria: false,\r\n            enableLayout: false\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n          return {\r\n            ...state\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELISTS_FETCH: {\r\n          return {\r\n            ...state\r\n          }\r\n        }\r\n        case DATASET_DOWNLOAD_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            isDownloadWarningVisible: action.payload.statusCode === 406\r\n          }\r\n        }\r\n        case DATASET_VIEW_TEMPLATE_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            isViewErrorVisible: !!(action.payload.extra.isView && action.payload.statusCode === 409 && action.payload.response),\r\n            viewErrorMessage: action.payload.response\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\nexport default datasetReducer;","export const NSI_RESPONSE_DOWNLOAD_SIZE_KEY = \"nsiResponseDownloadSize\";\r\nexport const TOTAL_KEY = \"total\";\r\n\r\nexport const getTimingsLabelTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    nsiResponse: t(\"timings.nsiResponse\"),\r\n    nsiResponseDownload: t(\"timings.nsiResponseDownload\"),\r\n    [NSI_RESPONSE_DOWNLOAD_SIZE_KEY]: t(\"timings.nsiResponseDownloadSize\"),\r\n    jsonToJsonStat: t(\"timings.jsonToJsonStat\"),\r\n    xmlToJsonStat: t(\"timings.xmlToJsonStat\"),\r\n    others: t(\"timings.others\"),\r\n    [TOTAL_KEY]: t(\"timings.total\"),\r\n    cacheRead: t(\"timings.cacheRead\")\r\n  });\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};","import React, {Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {GENERATING_HTML_TIME_KEY, OBSERVATION_COUNT_KEY, SERVER_TIMINGS_KEY} from \"../../state/dataset/datasetReducer\";\r\nimport {\r\n  getTimingsLabelTranslations,\r\n  NSI_RESPONSE_DOWNLOAD_SIZE_KEY,\r\n  TOTAL_KEY\r\n} from \"../../constants/getTimingsLabelTranslation\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  divider: {\r\n    margin: \"16px 0\"\r\n  }\r\n});\r\n\r\nconst getRow = (label, value, isTitle) => (\r\n  <Grid\r\n    container\r\n    key={label}\r\n    justify=\"space-between\"\r\n    spacing={2}\r\n    style={{\r\n      height: isTitle ? 40 : undefined\r\n    }}\r\n  >\r\n    <Grid\r\n      item\r\n      style={isTitle\r\n        ? {\r\n          fontSize: 15,\r\n          fontWeight: \"bold\",\r\n          textDecoration: \"underline\"\r\n        }\r\n        : undefined\r\n      }\r\n    >\r\n      {label}\r\n    </Grid>\r\n    {value && (\r\n      <Grid item><b>{value}</b></Grid>\r\n    )}\r\n  </Grid>\r\n);\r\n\r\nconst DataViewerTimings = ({\r\n                             t,\r\n                             classes,\r\n                             timings\r\n                           }) => {\r\n  const rows = [];\r\n\r\n  if (timings) {\r\n    if (timings[GENERATING_HTML_TIME_KEY] !== null && timings[GENERATING_HTML_TIME_KEY] !== undefined) {\r\n      rows.push(getRow(t(\"timings.observationCount\"), timings[OBSERVATION_COUNT_KEY], true));\r\n      rows.push(<Divider className={classes.divider} key=\"divider1\"/>);\r\n    }\r\n\r\n    /** server side **/\r\n    if (timings[SERVER_TIMINGS_KEY]) {\r\n\r\n      rows.push(getRow(t(\"timings.serverTimings\"), null, true));\r\n\r\n      for (const key in timings[SERVER_TIMINGS_KEY]) {\r\n        if (timings[SERVER_TIMINGS_KEY].hasOwnProperty(key)) {\r\n          if (key !== TOTAL_KEY && key !== NSI_RESPONSE_DOWNLOAD_SIZE_KEY) {\r\n            rows.push(getRow(getTimingsLabelTranslations(t)[key], timings[SERVER_TIMINGS_KEY][key]))\r\n          }\r\n        }\r\n      }\r\n      rows.push(getRow(getTimingsLabelTranslations(t)[TOTAL_KEY], timings[SERVER_TIMINGS_KEY][TOTAL_KEY], true));\r\n      rows.push(<Divider className={classes.divider} key=\"divider2\"/>);\r\n\r\n      if (timings[SERVER_TIMINGS_KEY][NSI_RESPONSE_DOWNLOAD_SIZE_KEY]) {\r\n        rows.push(getRow(getTimingsLabelTranslations(t)[NSI_RESPONSE_DOWNLOAD_SIZE_KEY], timings[SERVER_TIMINGS_KEY][NSI_RESPONSE_DOWNLOAD_SIZE_KEY], true));\r\n        rows.push(<Divider className={classes.divider} key=\"divider3\"/>);\r\n      }\r\n    }\r\n\r\n    /** client side **/\r\n    if (timings[GENERATING_HTML_TIME_KEY] !== null && timings[GENERATING_HTML_TIME_KEY] !== undefined) {\r\n      rows.push(getRow(t(\"timings.clientTimings\"), null, true));\r\n      rows.push(getRow(t(\"timings.generatingHtml\"), `${timings[GENERATING_HTML_TIME_KEY]}ms`));\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      {rows}\r\n    </Fragment>\r\n  )\r\n}\r\n\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(DataViewerTimings)","import React from 'react';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport I18nTextField from \"../i18n-text-field\";\r\n\r\nconst ViewBuilder = ({\r\n                       t,\r\n                       view,\r\n                       onChange\r\n                     }) =>\r\n  <Grid container spacing={2}>\r\n    <Grid item xs={12}>\r\n      <FormControl fullWidth>\r\n        <I18nTextField\r\n          label={t(\"scenes.dataViewer.viewBuilder.form.title.label\")}\r\n          required\r\n          variant=\"outlined\"\r\n          value={view.title}\r\n          onChange={value => onChange({...view, title: value})}\r\n        />\r\n      </FormControl>\r\n    </Grid>\r\n  </Grid>\r\n\r\nexport default withTranslation()(ViewBuilder);","export const showGenericError = () => {\r\n  if (window && window.error) {\r\n    window.error.show(\"An error occurred while contacting the server.\");\r\n  } else {\r\n    console.error(\"An error occurred while contacting the server.\");\r\n  }\r\n};\r\n\r\nexport const showTranslatedGenericErrorFactory = t => () => {\r\n  if (window && window.error) {\r\n    window.error.show(t(\"errors.generic\"));\r\n  } else {\r\n    console.error(t(\"errors.generic\"));\r\n  }\r\n};\r\n\r\nexport const getCombinationArrays = arrays => {\r\n  if (!arrays || arrays.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  const ret = [];\r\n  const max = arrays.length - 1;\r\n\r\n  function helper(arr, i) {\r\n    for (let j = 0, l = arrays[i].length; j < l; j++) {\r\n      const a = arr.slice(0); // clone arr\r\n      a.push(arrays[i][j]);\r\n      if (i === max) {\r\n        ret.push(a);\r\n      } else {\r\n        helper(a, i + 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  helper([], 0);\r\n  return ret;\r\n};","import {\r\n  getAttributeObjects,\r\n  getCoordinatesArrayFromDataIdx,\r\n  getDataIdxFromCoordinatesArray,\r\n  getDimensionAttributeMap,\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat\r\n} from \"../../utils/jsonStat\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport {getFormattedValue} from \"../../utils/formatters\";\r\nimport _ from \"lodash\";\r\nimport {getCombinationArrays} from \"../../utils/other\";\r\n\r\nconst JSONSTAT_TABLE_PREVIEW_PLACEHOLDER = \"xxx\";\r\nconst JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR = '<svg height=\"6px\" width=\"6px\" fill=\"#00295a\"><path d=\"M 0 0 H 6 V 6 H 0 Z\"/></svg>';\r\n\r\nconst extendArr = (array, n) => {\r\n  let arrays = Array.apply(null, new Array(n / array.length));\r\n  arrays = arrays.map(() => array);\r\n  return [].concat.apply([], arrays);\r\n};\r\n\r\nconst getObj = (jsonStat, arr, length, isPreview) => {\r\n  const obj = {};\r\n  arr.forEach((el, idx) => {\r\n    const repCount = idx === 0\r\n      ? length / jsonStat.size[jsonStat.id.indexOf(el)]\r\n      : obj[arr[idx - 1]].repCount / jsonStat.size[jsonStat.id.indexOf(el)];\r\n\r\n    obj[el] = {\r\n      repCount: repCount,\r\n      ids: [],\r\n      labels: [],\r\n      indexesMap: {}\r\n    };\r\n    if (!isPreview) {\r\n      jsonStat.dimension[el].category.index.forEach((value, idx) => {\r\n        for (let j = 0; j < repCount; j++) {\r\n          obj[el].ids.push(value);\r\n          obj[el].labels.push(jsonStat.dimension[el].category.label[value]);\r\n          obj[el].indexesMap[value] = idx;\r\n        }\r\n      })\r\n    }\r\n  });\r\n  if (!isPreview) {\r\n    arr.forEach(el => {\r\n      if (obj[el].ids.length < length) {\r\n        obj[el].ids = extendArr(obj[el].ids, length);\r\n        obj[el].labels = extendArr(obj[el].labels, length);\r\n      }\r\n    });\r\n  }\r\n\r\n  return obj\r\n};\r\n\r\nconst getValorizedElCount = array => {\r\n  let count = 0;\r\n\r\n  array.forEach(el => {\r\n    if (el === true) {\r\n      count++;\r\n    }\r\n  });\r\n\r\n  return count;\r\n};\r\n\r\nconst getCorrespondingIndexInFilteredArray = (array, n) => {\r\n  let count = 0;\r\n  let res = 0;\r\n  let lastIdx = 0;\r\n  let found = false;\r\n\r\n  array.forEach((el, idx) => {\r\n    if (el === true) {\r\n      count++;\r\n      lastIdx = idx;\r\n      if (count === n + 1) {\r\n        res = idx;\r\n        found = true;\r\n      }\r\n    }\r\n  });\r\n\r\n  return found ? res : (lastIdx + 1);\r\n};\r\n\r\nconst getJsonStatLayoutObjects = (jsonStat, rows, cols, sections, filters, filtersValue, isPreview) => {\r\n\r\n  /** rows handling **/\r\n  let sectionRowCount = 1;\r\n  (rows || []).forEach(row => sectionRowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n  const rowsObj = (rows || []).length > 0\r\n    ? getObj(jsonStat, rows, sectionRowCount, isPreview)\r\n    : {};\r\n\r\n  /** cols handling **/\r\n  let colCount = 1;\r\n  (cols || []).forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  const colsObj = (cols || []).length > 0\r\n    ? getObj(jsonStat, cols, colCount, isPreview)\r\n    : {};\r\n\r\n  /** sections handling **/\r\n  const sectionArray = [];\r\n  (sections || []).forEach(section => sectionArray.push(jsonStat.dimension[section].category.index));\r\n  const combinations = sectionArray.length > 0\r\n    ? getCombinationArrays(sectionArray)\r\n    : [];\r\n\r\n  /** indexes map handling **/\r\n  const indexesMap = {};\r\n  rows.forEach(row => indexesMap[row] = rowsObj[row].indexesMap);\r\n  cols.forEach(col => indexesMap[col] = colsObj[col].indexesMap);\r\n  sections.forEach(section => {\r\n    indexesMap[section] = {};\r\n    jsonStat.dimension[section].category.index.forEach((val, idx) => indexesMap[section][val] = idx);\r\n  });\r\n  filters.forEach(filter => {\r\n    indexesMap[filter] = {};\r\n    jsonStat.dimension[filter].category.index.forEach((val, idx) => indexesMap[filter][val] = idx);\r\n  });\r\n\r\n  return {\r\n    sectionRowCount,\r\n    rowsObj,\r\n    colCount,\r\n    colsObj,\r\n    combinations,\r\n    indexesMap\r\n  }\r\n};\r\n\r\nconst getCellAttributeIdsElem = (ids, htmlElemId, isDataCell) => {\r\n  let idElems = \"\";\r\n  const astElem = ' <span class=\"ct-a\">(*)</span> ';\r\n\r\n  if (!ids || ids.length === 0) {\r\n    return \"\";\r\n\r\n  } else {\r\n    if (ids.length === 1 && ids[0].length <= 2) {\r\n      idElems = ` <span class=\"${ids[0] === \"(*)\" ? 'ct-a' : 'ct-c'}\">${ids[0]}</span> `;\r\n    } else {\r\n      idElems += astElem;\r\n    }\r\n  }\r\n\r\n  return ` <span id=\"${htmlElemId}\" class=\"ct ${isDataCell ? 'ctd' : 'ctsh'}\">${idElems}</span> `\r\n};\r\n\r\nexport const getJsonStatTableSupportStructures = (jsonStat, layout, isPreview, removeEmptyLines, hiddenAttributes) => {\r\n  const {\r\n    rows,\r\n    cols,\r\n    filters,\r\n    filtersValue,\r\n    sections\r\n  } = layout;\r\n\r\n  const {\r\n    sectionRowCount,\r\n    rowsObj,\r\n    colCount,\r\n    colsObj,\r\n    combinations,\r\n    indexesMap\r\n  } = getJsonStatLayoutObjects(jsonStat, rows, cols, sections, filters, filtersValue, isPreview);\r\n\r\n  /** empty rows & cols handling **/\r\n\r\n  let valorizedRowsPerSection = (combinations && combinations.length > 0)\r\n    ? combinations.map(() => [])\r\n    : [[]];\r\n  let valorizedCols = [];\r\n\r\n  if (removeEmptyLines) {\r\n    valorizedRowsPerSection = valorizedRowsPerSection.map(() => new Array(sectionRowCount).fill(false));\r\n    valorizedCols = new Array(colCount).fill(false);\r\n\r\n    const filterValueArray = jsonStat.id.map(dim => {\r\n      if (filtersValue[dim]) {\r\n        return indexesMap[dim][filtersValue[dim]]\r\n      } else {\r\n        return null\r\n      }\r\n    });\r\n    Object.keys(jsonStat.value).forEach(key => {\r\n      const coordinates = getCoordinatesArrayFromDataIdx(key, jsonStat.size);\r\n\r\n      let sectionIdx = 0;\r\n      if (sections.length > 0) {\r\n        const sectionValueArray = [];\r\n        coordinates.forEach((val, idx) => {\r\n          const dim = jsonStat.id[idx];\r\n          if (sections.includes(dim)) {\r\n            sectionValueArray.push(jsonStat.dimension[dim].category.index[val]);\r\n          }\r\n        });\r\n        sectionIdx = combinations.findIndex(combination => combination.join(\"+\") === sectionValueArray.join(\"+\"));\r\n      }\r\n\r\n      if (filterValueArray.filter((elem, idx) => elem !== null && elem !== coordinates[idx]).length === 0) {\r\n        let y = 0;\r\n        rows.forEach(row => {\r\n          const val = coordinates[jsonStat.id.indexOf(row)];\r\n          y += val * rowsObj[row].repCount;\r\n        });\r\n\r\n        let x = 0;\r\n        cols.forEach(col => {\r\n          const val = coordinates[jsonStat.id.indexOf(col)];\r\n          x += val * colsObj[col].repCount;\r\n        });\r\n\r\n        valorizedRowsPerSection[sectionIdx][y] = true;\r\n        valorizedCols[x] = true;\r\n      }\r\n    });\r\n\r\n  } else {\r\n    valorizedRowsPerSection = valorizedRowsPerSection.map(() => new Array(sectionRowCount).fill(true));\r\n    valorizedCols = new Array(colCount).fill(true);\r\n  }\r\n\r\n  let valorizedRows;\r\n  if (Array.prototype.flat) {\r\n    valorizedRows = valorizedRowsPerSection.flat();\r\n  } else {\r\n    valorizedRows = [];\r\n    valorizedRowsPerSection.forEach(section => valorizedRows = valorizedRows.concat(section));\r\n  }\r\n\r\n  /** dimension attributes handling **/\r\n  const dimensionAttributesMap = getDimensionAttributeMap(\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    (ids, dim, dimValue) => getCellAttributeIdsElem(ids, `${dim},${dimValue}`, false)\r\n  );\r\n\r\n  /** observation attributes handling **/\r\n  const observations = (jsonStat?.extension?.attributes?.observation || []);\r\n  const observationIndexes = (jsonStat?.extension?.attributes?.index?.observation || {});\r\n  const observationAttributesMap = _.cloneDeep(observationIndexes);\r\n\r\n  let hasAttributeObservationError = false;\r\n  for (let key in observationAttributesMap) {\r\n    if (observationAttributesMap.hasOwnProperty(key)) {\r\n      const attributeObjects = getAttributeObjects(observationAttributesMap[key], observations, hiddenAttributes);\r\n      if (attributeObjects !== null && attributeObjects !== -1) {\r\n        observationAttributesMap[key] = {\r\n          attributes: attributeObjects.attributes,\r\n          ids: attributeObjects.ids,\r\n          htmlString: getCellAttributeIdsElem(attributeObjects.ids, key, true)\r\n        };\r\n      } else if (attributeObjects === -1) {\r\n        hasAttributeObservationError = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    rows,\r\n    cols,\r\n    sections,\r\n    filters,\r\n    filtersValue,\r\n    colCount: getValorizedElCount(valorizedCols),\r\n    rowCount: getValorizedElCount(valorizedRows),\r\n    colsObj,\r\n    rowsObj,\r\n    combinations,\r\n    indexesMap,\r\n    valorizedCols,\r\n    valorizedRows,\r\n    valorizedRowsPerSection,\r\n    sectionsLength: valorizedRowsPerSection[0].length,\r\n    dimensionAttributesMap,\r\n    observationAttributesMap,\r\n    hasAttributeObservationError\r\n  }\r\n};\r\n\r\nconst getTableRightPadding = padding => padding\r\n  ? `<td class=\"c c-rb\" style=\"min-width: ${padding}px;\">`\r\n  : \"\";\r\n\r\nexport const getJsonStatTableHtml = (\r\n  jsonStat,\r\n  rows,\r\n  cols,\r\n  sections,\r\n  filters,\r\n  filtersValue,\r\n  colCount,\r\n  rowCount,\r\n  colsObj,\r\n  rowsObj,\r\n  combinations,\r\n  indexesMap,\r\n  valorizedCols,\r\n  valorizedRows,\r\n  valorizedRowsPerSection,\r\n  sectionsLength,\r\n  labelFormat,\r\n  fontSize,\r\n  decimalSeparator,\r\n  decimalPlaces,\r\n  emptyChar,\r\n  isPreview,\r\n  paginationParams,\r\n  dimensionAttributesMap,\r\n  observationAttributesMap,\r\n  onTimeSet\r\n) => {\r\n\r\n  /** pagination **/\r\n\r\n  const origColStart = paginationParams ? paginationParams.colStart : 0;\r\n  const origColEnd = paginationParams ? paginationParams.colEnd : colCount;\r\n\r\n  const rowStart = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedRows, paginationParams.rowStart)\r\n    : getCorrespondingIndexInFilteredArray(valorizedRows, 0);\r\n\r\n  const rowEnd = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedRows, paginationParams.rowEnd)\r\n    : getValorizedElCount(valorizedRows);\r\n\r\n  const colStart = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedCols, paginationParams.colStart)\r\n    : getCorrespondingIndexInFilteredArray(valorizedCols, 0);\r\n\r\n  const colEnd = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedCols, paginationParams.colEnd)\r\n    : getValorizedElCount(valorizedCols);\r\n\r\n  const t0 = performance.now();\r\n\r\n  /** HTML generating **/\r\n\r\n  let table = `<table id=\"${uuidv4()}\">`;\r\n\r\n  /** table head **/\r\n\r\n  table += '<thead>';\r\n\r\n  cols.forEach((col, idx) => {\r\n    table += `<tr data-row-key=\"h-${idx}\">`;\r\n    table += `<th class=\"c cf${fontSize} ch cl0\" colspan=\"${rows.length}\">${getDimensionLabelFromJsonStat(jsonStat, col, labelFormat)}</th>`;\r\n\r\n    if (!isPreview) {\r\n\r\n      let c = colStart;\r\n      let colVisited = origColStart;\r\n      while (colVisited < origColEnd) {\r\n\r\n        const cc = c;\r\n        let fullColSpan = colsObj[col].ids.slice(c, c + colsObj[col].repCount).filter(el => el === colsObj[col].ids[cc]).length;\r\n\r\n        let colSpan = valorizedCols.slice(c, c + fullColSpan).filter(el => el === true).length;\r\n\r\n        if (colVisited + colSpan > origColEnd) {\r\n          colSpan = origColEnd - colVisited;\r\n        }\r\n\r\n        if (colSpan > 0) {\r\n\r\n          const htmlString = (dimensionAttributesMap?.[col]?.[colsObj[col].ids[c]]?.htmlString || \"\");\r\n\r\n          table += (\r\n            `<th class=\"c cf${fontSize} csh ${htmlString.length > 0 ? 'ca' : ''}\" colspan=\"${colSpan}\">` +\r\n            getDimensionValueLabelFromJsonStat(jsonStat, col, colsObj[col].ids[c], labelFormat) +\r\n            htmlString +\r\n            `</th>`\r\n          );\r\n        }\r\n\r\n        c += fullColSpan;\r\n        colVisited += colSpan;\r\n      }\r\n\r\n    } else {\r\n      for (let c = 0; c < 3; c++) {\r\n        table += `<th class=\"c cf${fontSize} csh\" colspan=\"1\">${JSONSTAT_TABLE_PREVIEW_PLACEHOLDER}</th>`;\r\n      }\r\n    }\r\n\r\n    table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n    table += '</tr>';\r\n  });\r\n\r\n  if (rows.length > 0) {\r\n    table += `<tr data-row-key=\"hh\">`;\r\n    rows.forEach((row, idx) => table += `<th class=\"c cf${fontSize} ch cl${idx}\">${getDimensionLabelFromJsonStat(jsonStat, row, labelFormat)}</th>`);\r\n    if (!isPreview) {\r\n      table += `<th class=\"c cf${fontSize} csh\" colspan=\"${origColEnd - origColStart}\"/>`;\r\n    } else {\r\n      table += `<th class=\"c cf${fontSize} csh\" colspan=\"${cols.length > 0 ? 3 : 1}\"/>`;\r\n    }\r\n    table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n    table += '</tr>';\r\n  }\r\n\r\n  table += '</thead>';\r\n\r\n  /** table body **/\r\n\r\n  table += '<tbody id=\"body\">';\r\n\r\n  if (!isPreview) {\r\n\r\n    const sectionsStarts = [0];\r\n    valorizedRowsPerSection.forEach((valorizedRows, idx) => sectionsStarts.push(sectionsStarts[idx] + valorizedRows.length));\r\n\r\n    const subHeaderHandled = {};\r\n    rows.forEach(row => subHeaderHandled[row] = -1);\r\n\r\n    let currentSectionIdx = 0;\r\n    for (let i = 0; i < sectionsStarts.length; i++) {\r\n      if (rowStart >= sectionsStarts[i] && (i === sectionsStarts.length - 1 || rowStart < sectionsStarts[i + 1])) {\r\n        currentSectionIdx = i;\r\n      }\r\n    }\r\n\r\n    const getSectionRow = currentSectionIdx => {\r\n      let sectionRow = `<tr data-row-key=\"s-${currentSectionIdx}\" class=\"rs\">`;\r\n      let sectionLabel = \"\";\r\n      const currentSectionIdxClone = currentSectionIdx;\r\n      sections.forEach((section, idx) => {\r\n\r\n        const htmlString = (dimensionAttributesMap?.[section]?.[combinations[currentSectionIdxClone][idx]]?.htmlString || \"\");\r\n\r\n        sectionLabel += (\r\n          `<span class=\"${htmlString.length > 0 ? 'ca' : ''}\" style=\"display: inline-block;\">` +\r\n          `<span class=\"cs-d\">${getDimensionLabelFromJsonStat(jsonStat, section, labelFormat)}:</span> ${getDimensionValueLabelFromJsonStat(jsonStat, section, combinations[currentSectionIdxClone][idx], labelFormat)}` +\r\n          htmlString +\r\n          '</span>'\r\n        );\r\n        sectionLabel += idx < (sections.length - 1) ? `<span style=\"display: inline-block; margin: 0 8px\">${JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR}</span>` : '';\r\n      });\r\n\r\n      sectionRow += `<th class=\"c cf${fontSize} cs\" colspan=\"${origColEnd - origColStart + (rows.length || 1)}\">${sectionLabel}</th>`;\r\n\r\n      sectionRow += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n      sectionRow += '</tr>';\r\n\r\n      return sectionRow;\r\n    }\r\n\r\n    if (sections && sections.length > 0) {\r\n      table += getSectionRow(currentSectionIdx);\r\n    }\r\n\r\n    for (let r = rowStart; r < rowEnd; r++) {\r\n\r\n      if (sections && sections.length > 0) {\r\n        if (r > rowStart && sectionsStarts.indexOf(r) !== -1) {\r\n          currentSectionIdx = sectionsStarts.indexOf(r);\r\n          table += getSectionRow(currentSectionIdx);\r\n        }\r\n      }\r\n\r\n      if (valorizedRows[r] === true) {\r\n\r\n        table += `<tr data-row-key=\"r-${r}\">`;\r\n\r\n        let subHeader = \"\";\r\n\r\n        if (rows.length > 0) {\r\n          for (let rr = 0; rr < rows.length; rr++) {\r\n\r\n            const htmlString = (dimensionAttributesMap?.[rows[rr]]?.[rowsObj[rows[rr]].ids[r % sectionsLength]]?.htmlString || \"\");\r\n\r\n            if (r > subHeaderHandled[rows[rr]]) {\r\n\r\n              let rowSpan = valorizedRows.slice(r, r + (rowsObj[rows[rr]].repCount - (r % rowsObj[rows[rr]].repCount))).filter(el => el === true).length;\r\n              if (r + rowSpan > rowEnd) {\r\n                rowSpan = rowEnd - r;\r\n              }\r\n\r\n              subHeaderHandled[rows[rr]] = r + (rowsObj[rows[rr]].repCount - (r % rowsObj[rows[rr]].repCount)) - 1;\r\n\r\n              if (rowSpan > 0) {\r\n                subHeader += (\r\n                  `<th class=\"c cf${fontSize} csh cl${rr} ${htmlString.length > 0 ? 'ca' : ''}\" rowspan=\"${rowSpan}\">` +\r\n                  getDimensionValueLabelFromJsonStat(jsonStat, rows[rr], rowsObj[rows[rr]].ids[r % sectionsLength], labelFormat) +\r\n                  htmlString +\r\n                  `</th>`\r\n                );\r\n              }\r\n            }\r\n          }\r\n\r\n        } else {\r\n          subHeader += `<th class=\"c cf${fontSize} csh cl0\"/>`\r\n        }\r\n\r\n        table += subHeader;\r\n\r\n        const getDataCell = (c, currentSectionIdx) => {\r\n\r\n          const dataObj = {\r\n            ...filtersValue\r\n          };\r\n          rows.forEach(row => dataObj[row] = rowsObj[row].ids[r % sectionsLength]);\r\n          cols.forEach(col => dataObj[col] = colsObj[col].ids[c]);\r\n          sections.forEach((section, idx) => dataObj[section] = combinations[currentSectionIdx][idx]);\r\n\r\n          const dataIndexArr = jsonStat.id.map(dim => indexesMap[dim][dataObj[dim]]);\r\n\r\n          const dataIdx = getDataIdxFromCoordinatesArray(dataIndexArr, jsonStat.size);\r\n          const value = jsonStat.value[dataIdx];\r\n\r\n          const htmlString = (observationAttributesMap[dataIdx]?.htmlString || \"\");\r\n\r\n          return (\r\n            `<td id=\"${dataIdx}\" class=\"c cf${fontSize} ${htmlString.length > 0 ? 'ca' : ''}\">` +\r\n            htmlString +\r\n            getFormattedValue(value, decimalSeparator, decimalPlaces, emptyChar) +\r\n            `</td>`\r\n          );\r\n        }\r\n\r\n        if (valorizedRows[r] === true) {\r\n          for (let c = colStart; c < colEnd; c++) {\r\n            if (valorizedCols[c] === true) {\r\n              table += getDataCell(c, currentSectionIdx);\r\n            }\r\n          }\r\n\r\n        } else {\r\n          for (let c = colStart; c < colEnd; c++) {\r\n            table += getDataCell(c, currentSectionIdx);\r\n          }\r\n        }\r\n\r\n        table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n        table += '</tr>';\r\n      }\r\n\r\n    }\r\n\r\n    table += `<tr><td class=\"c c-bb\" colspan=\"${rows.length + (origColEnd - origColStart + (rows.length > 0 ? 0 : 1))}\"></td></tr>`;\r\n\r\n  } else {\r\n\r\n    if (sections && sections.length > 0) {\r\n      table += `<tr data-row-key=\"s-0\" class=\"rs\">`;\r\n      let sectionLabel = \"\";\r\n      sections.forEach((section, idx) => {\r\n        sectionLabel += `<span style=\"display: inline-block;\"><span class=\"cs-d\">${getDimensionLabelFromJsonStat(jsonStat, section, labelFormat)}:</span> ${JSONSTAT_TABLE_PREVIEW_PLACEHOLDER}</span>`;\r\n        sectionLabel += idx < (sections.length - 1) ? `<span style=\"display: inline-block; margin: 0 8px\">${JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR}</span>` : '';\r\n      });\r\n      table += `<th class=\"c cf${fontSize} cs\" colspan=\"${(rows.length || 1) + (cols.length > 0 ? 3 : 1)}\">${sectionLabel}</th>`;\r\n      table += getTableRightPadding(1);\r\n      table += '</tr>';\r\n    }\r\n    for (let r = 0; r < (rows.length > 0 ? 3 : 1); r++) {\r\n      table += `<tr data-row-key=\"r-${r}\">`;\r\n      if (rows.length > 0) {\r\n        for (let rr = 0; rr < rows.length; rr++) {\r\n          table += `<th class=\"c cf${fontSize} csh cl${rr}\">xxx</th>`;\r\n        }\r\n      } else {\r\n        table += `<th class=\"c cf${fontSize} csh cl0\">&nbsp;</th>`\r\n      }\r\n      for (let c = 0; c < (cols.length > 0 ? 3 : 1); c++) {\r\n        table += `<td class=\"c cf${fontSize}\"/>`;\r\n      }\r\n      table += getTableRightPadding(1);\r\n      table += '</tr>';\r\n    }\r\n    table += `<tr><td class=\"c c-bb\" colspan=\"${(rows.length || 1) + (cols.length > 0 ? 3 : 1)}\"></td></tr>`;\r\n  }\r\n\r\n  table += '</tbody>';\r\n\r\n  table += '</table>';\r\n\r\n  table += '<div id=\"jsonstat-table__tooltip\" class=\"ctt\"/>'\r\n\r\n  const t1 = performance.now();\r\n  if (!isPreview) {\r\n    onTimeSet(Math.round((t1 - t0) * 100) / 100);\r\n  }\r\n\r\n  return table;\r\n};","import React, {useCallback, useEffect, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport ArrowLeftIcon from '@material-ui/icons/ArrowLeft';\r\nimport ArrowRightIcon from '@material-ui/icons/ArrowRight';\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nlet timeoutID = null;\r\nconst SCROLLBARS_TIMEOUT = 100;\r\nlet intervalID = null;\r\nconst SCROLLBARS_INTERVAL = 200;\r\n\r\nlet isOnMouseDownOnSliderThumb = null;\r\n\r\nconst WHEEL_DELTA = 1;\r\n\r\nexport const SLIDER_WIDTH = 32;\r\nconst SLIDER_MARGIN = 4;\r\n\r\nconst SLIDER_RAIL_COLOR = \"#cfcfcf\";\r\nconst SLIDER_POINTER_COLOR = \"#808080\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sliderButton: {\r\n    width: SLIDER_WIDTH,\r\n    height: SLIDER_WIDTH,\r\n    padding: 0,\r\n    \"& svg\": {\r\n      width: SLIDER_WIDTH,\r\n      height: SLIDER_WIDTH,\r\n    }\r\n  },\r\n  horizontalSlider: {\r\n    color: SLIDER_POINTER_COLOR,\r\n    \"& span.MuiSlider-rail\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    },\r\n    \"& span.MuiSlider-track\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    }\r\n  },\r\n  verticalSlider: {\r\n    color: SLIDER_POINTER_COLOR,\r\n    \"& span.MuiSlider-rail\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    },\r\n    \"& span.MuiSlider-track\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    }\r\n  },\r\n  spinnerOverlay: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    position: \"absolute\",\r\n    top: 0,\r\n    left: 0\r\n  }\r\n});\r\n\r\nconst isEventInContainer = (ev, container) => {\r\n  const containerRect = container.getBoundingClientRect();\r\n  const BUFFER = 32;\r\n\r\n  return (\r\n    ev.clientY >= (containerRect.top - BUFFER) &&\r\n    ev.clientY <= (containerRect.bottom + BUFFER) &&\r\n    ev.clientX >= (containerRect.left - BUFFER) &&\r\n    ev.clientX <= (containerRect.right + BUFFER)\r\n  );\r\n};\r\n\r\nfunction CustomSlider(props) {\r\n  const {\r\n    uuid,\r\n    classes,\r\n    orientation,\r\n    value,\r\n    maxValue,\r\n    onChange,\r\n    onIncrement,\r\n    ticks,\r\n    isVerticalScrollbarVisible\r\n  } = props;\r\n\r\n  useEffect(() => {\r\n    const onMouseUp = () => {\r\n      clearInterval(intervalID);\r\n      isOnMouseDownOnSliderThumb = null;\r\n    }\r\n    window.addEventListener(\"mouseup\", onMouseUp);\r\n    return () => window.removeEventListener(\"mouseup\", onMouseUp);\r\n  }, []);\r\n\r\n  const handleChange = (value, ev, newValue, sliderId) => {\r\n    const step = Math.ceil(ticks / 10);\r\n\r\n    if (ev.type === \"mousedown\") {\r\n\r\n      isOnMouseDownOnSliderThumb = isEventInContainer(ev, $(`#${sliderId} span.MuiSlider-thumb`)[0]);\r\n\r\n      if (newValue < value) {\r\n        if ((value - step) > newValue) {\r\n          onIncrement(false, step, newValue);\r\n          clearInterval(intervalID);\r\n          intervalID = setInterval(\r\n            () => onIncrement(false, step, newValue),\r\n            SCROLLBARS_INTERVAL\r\n          );\r\n        } else {\r\n          onChange(newValue);\r\n        }\r\n      } else {\r\n        if ((value + step) < newValue) {\r\n          onIncrement(true, step, newValue);\r\n          clearInterval(intervalID);\r\n          intervalID = setInterval(\r\n            () => onIncrement(true, step, newValue),\r\n            SCROLLBARS_INTERVAL\r\n          );\r\n        } else {\r\n          onChange(newValue);\r\n        }\r\n      }\r\n\r\n    } else if (ev.type === \"mousemove\" && isOnMouseDownOnSliderThumb) {\r\n      onChange(newValue);\r\n    }\r\n  };\r\n\r\n  return orientation === \"vertical\"\r\n    ? (\r\n      <div style={{width: SLIDER_WIDTH, height: \"100%\", display: \"inline-block\", verticalAlign: \"top\"}}>\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          onMouseDown={() => {\r\n            if (value > 0) {\r\n              onIncrement(false, 1);\r\n              intervalID = setInterval(\r\n                () => onIncrement(false, 1),\r\n                SCROLLBARS_INTERVAL\r\n              );\r\n            }\r\n          }}\r\n          disabled={value === 0}\r\n        >\r\n          <ArrowDropUpIcon/>\r\n        </IconButton>\r\n        <Slider\r\n          id={`sliders__custom-sliders__vertical__${uuid}`}\r\n          orientation=\"vertical\"\r\n          value={ticks - value}\r\n          min={0}\r\n          max={ticks}\r\n          onChange={(ev, newValue) => {\r\n            const invertedValue = (ticks - newValue);\r\n            handleChange(value, ev, invertedValue, `sliders__custom-sliders__vertical__${uuid}`)\r\n          }}\r\n          track=\"inverted\"\r\n          className={classes.verticalSlider}\r\n          style={{\r\n            height: `calc(100% - ${SLIDER_WIDTH + SLIDER_WIDTH + SLIDER_MARGIN + SLIDER_MARGIN}px)`,\r\n            padding: \"0 15px\",\r\n            margin: `${SLIDER_MARGIN}px 0`\r\n          }}\r\n        />\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          onMouseDown={() => {\r\n            if (value < (maxValue - 1)) {\r\n              onIncrement(true, 1);\r\n              intervalID = setInterval(\r\n                () => onIncrement(true, 1),\r\n                SCROLLBARS_INTERVAL\r\n              );\r\n            }\r\n          }}\r\n          disabled={value >= (maxValue - 1)}\r\n        >\r\n          <ArrowDropDownIcon/>\r\n        </IconButton>\r\n      </div>\r\n    )\r\n    : (\r\n      <div style={{width: \"100%\", height: SLIDER_WIDTH, display: \"inline-block\", verticalAlign: \"middle\"}}>\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          style={{display: \"inline-block\", verticalAlign: \"middle\"}}\r\n          onMouseDown={() => {\r\n            onIncrement(false, 1);\r\n            intervalID = setInterval(\r\n              () => onIncrement(false, 1),\r\n              SCROLLBARS_INTERVAL\r\n            );\r\n          }}\r\n          disabled={value === 0}\r\n        >\r\n          <ArrowLeftIcon fontSize=\"small\"/>\r\n        </IconButton>\r\n        <Slider\r\n          id={`sliders__custom-sliders__horizontal__${uuid}`}\r\n          orientation=\"horizontal\"\r\n          value={value}\r\n          min={0}\r\n          max={ticks}\r\n          onChange={(ev, newValue) => handleChange(value, ev, newValue, `sliders__custom-sliders__horizontal__${uuid}`)}\r\n          className={classes.horizontalSlider}\r\n          style={{\r\n            width: `calc(100% - ${SLIDER_WIDTH + SLIDER_WIDTH + SLIDER_MARGIN + SLIDER_MARGIN + (isVerticalScrollbarVisible ? SLIDER_WIDTH : 0)}px)`,\r\n            padding: \"15px 0\",\r\n            display: \"inline-block\",\r\n            verticalAlign: \"middle\",\r\n            margin: `0 ${SLIDER_MARGIN}px`\r\n          }}\r\n        />\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          style={{display: \"inline-block\", verticalAlign: \"middle\"}}\r\n          onMouseDown={() => {\r\n            onIncrement(true, 1);\r\n            intervalID = setInterval(\r\n              () => onIncrement(true, 1),\r\n              SCROLLBARS_INTERVAL\r\n            );\r\n          }}\r\n          disabled={value >= (maxValue - 1)}\r\n        >\r\n          <ArrowRightIcon/>\r\n        </IconButton>\r\n        {isVerticalScrollbarVisible && (\r\n          <div style={{width: SLIDER_WIDTH, height: SLIDER_WIDTH, display: \"inline-block\", verticalAlign: \"middle\"}}/>\r\n        )}\r\n      </div>\r\n    )\r\n}\r\n\r\nfunction Scrollbars(props) {\r\n  const {\r\n    classes,\r\n    children,\r\n    verticalValue,\r\n    verticalMaxValue,\r\n    verticalTicks,\r\n    onVerticalScroll,\r\n    isVerticalScrollbarVisible,\r\n    horizontalValue,\r\n    horizontalMaxValue,\r\n    horizontalTicks,\r\n    onHorizontalScroll,\r\n    isHorizontalScrollbarVisible,\r\n    disableMouseWheel\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [row, setRow] = useState(verticalValue);\r\n  const [col, setCol] = useState(horizontalValue);\r\n\r\n  const [isPaginating, setIsPaginating] = useState(false);\r\n\r\n  const handleSliderScroll = (value, isVertical) => {\r\n    if (isVertical) {\r\n      setRow(value);\r\n      if (value !== row) {\r\n        setIsPaginating(true);\r\n      }\r\n    } else {\r\n      setCol(value);\r\n      if (value !== col) {\r\n        setIsPaginating(true);\r\n      }\r\n    }\r\n  };\r\n\r\n  const getIncrementedValue = (prevValue, delta, isIncrement, limit) => isIncrement\r\n    ? (prevValue + delta) > limit\r\n      ? limit\r\n      : (prevValue + delta)\r\n    : (prevValue - delta) < limit\r\n      ? limit\r\n      : (prevValue - delta);\r\n\r\n  const handleIncrement = (isIncrement, isVertical, delta, limit) => isVertical\r\n    ? setRow(prevRow => isIncrement\r\n      ? getIncrementedValue(prevRow, delta, isIncrement, (limit || (verticalMaxValue - 1)))\r\n      : getIncrementedValue(prevRow, delta, isIncrement, (limit || 0))\r\n    )\r\n    : setCol(prevCol => isIncrement\r\n      ? getIncrementedValue(prevCol, delta, isIncrement, (limit || (horizontalMaxValue - 1)))\r\n      : getIncrementedValue(prevCol, delta, isIncrement, (limit || 0))\r\n    );\r\n\r\n  const handleWheelScroll = useCallback(\r\n    ev => {\r\n      const isVertical = ev.wheelDeltaY !== 0;\r\n      const wheelDelta = isVertical\r\n        ? ev.wheelDeltaY > 0 ? -WHEEL_DELTA : WHEEL_DELTA\r\n        : ev.wheelDeltaX > 0 ? -WHEEL_DELTA : WHEEL_DELTA\r\n\r\n      const isBetween = (val, min, max) => (val >= min && val < max);\r\n\r\n      if (isVertical) {\r\n        setRow(prevRow => {\r\n          const newRow = isBetween(prevRow + wheelDelta, 0, verticalMaxValue) ? (prevRow + wheelDelta) : prevRow\r\n          return isVerticalScrollbarVisible\r\n            ? newRow\r\n            : prevRow\r\n        });\r\n      } else {\r\n        setCol(prevCol => {\r\n          const newCol = isBetween(prevCol + wheelDelta, 0, horizontalMaxValue) ? (prevCol + wheelDelta) : prevCol;\r\n          return isHorizontalScrollbarVisible\r\n            ? newCol\r\n            : prevCol\r\n        });\r\n      }\r\n    },\r\n    [isVerticalScrollbarVisible, isHorizontalScrollbarVisible, verticalMaxValue, horizontalMaxValue, setRow, setCol],\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!disableMouseWheel) {\r\n      document.getElementById(`scrollbars-container__${uuid}`).addEventListener(\"wheel\", handleWheelScroll);\r\n    }\r\n    return () => document.getElementById(`scrollbars-container__${uuid}`).removeEventListener(\"wheel\", handleWheelScroll);\r\n  }, [uuid, disableMouseWheel, handleWheelScroll]);\r\n\r\n  useEffect(() => {\r\n    if (timeoutID) {\r\n      clearTimeout(timeoutID);\r\n    }\r\n\r\n    timeoutID = setTimeout(\r\n      () => {\r\n        onVerticalScroll(row);\r\n        onHorizontalScroll(col);\r\n        setIsPaginating(false);\r\n      },\r\n      SCROLLBARS_TIMEOUT\r\n    );\r\n  }, [row, col, onVerticalScroll, onHorizontalScroll, setIsPaginating]);\r\n\r\n  useEffect(() => {\r\n    setRow(verticalValue);\r\n    setCol(horizontalValue);\r\n  }, [verticalValue, horizontalValue, setRow, setCol]);\r\n\r\n  return (\r\n    <div id={`scrollbars-container__${uuid}`} style={{width: \"100%\", height: \"100%\"}}>\r\n      <div style={{width: \"100%\", height: `calc(100% - ${isHorizontalScrollbarVisible ? SLIDER_WIDTH : 0}px)`}}>\r\n        <div\r\n          style={{\r\n            width: `calc(100% - ${isVerticalScrollbarVisible ? SLIDER_WIDTH : 0}px)`,\r\n            height: \"100%\",\r\n            display: \"inline-block\",\r\n            verticalAlign: \"top\",\r\n            position: \"relative\"\r\n          }}\r\n        >\r\n          <div className={classes.spinnerOverlay} style={{filter: isPaginating ? \"blur(1px)\" : \"\"}}>{children}</div>\r\n          {isPaginating && (\r\n            <div className={classes.spinnerOverlay}>\r\n              <CustomEmpty\r\n                text={t(\"components.table.scrollbars.loading\") + \"...\"}\r\n                textStyle={{fontWeight: \"bold\"}}\r\n                color=\"#ffffff\"\r\n                backgroundColor=\"rgba(0, 0, 0, 0.1)\"\r\n                image={<CircularProgress style={{color: \"#ffffff\"}}/>}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n        {isVerticalScrollbarVisible && (\r\n          <CustomSlider\r\n            uuid={uuid}\r\n            classes={classes}\r\n            orientation=\"vertical\"\r\n            value={row}\r\n            maxValue={verticalMaxValue}\r\n            onChange={value => handleSliderScroll(value, true)}\r\n            onIncrement={(isIncrement, delta, limit) => handleIncrement(isIncrement, true, delta, limit)}\r\n            ticks={verticalTicks}\r\n            isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n          />\r\n        )}\r\n      </div>\r\n      {\r\n        isHorizontalScrollbarVisible && (\r\n          <CustomSlider\r\n            uuid={uuid}\r\n            classes={classes}\r\n            orientation=\"horizontal\"\r\n            value={col}\r\n            maxValue={horizontalMaxValue}\r\n            onChange={value => handleSliderScroll(value, false)}\r\n            onIncrement={(isIncrement, delta, limit) => handleIncrement(isIncrement, false, delta, limit)}\r\n            ticks={horizontalTicks}\r\n            isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n          />\r\n        )\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(Scrollbars)","import React, {Fragment, useCallback, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {getJsonStatTableHtml} from \"./jsonStatTable\";\r\nimport \"./style.css\"\r\nimport {setDatasetHtmlGeneratingTime} from \"../../state/dataset/datasetActions\";\r\nimport Scrollbars, {SLIDER_WIDTH} from \"./Scrollbars\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport copy from \"copy-to-clipboard\";\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../label-format-selector/constants\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {sanitize} from \"dompurify\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nexport const JSONSTAT_TABLE_FONT_SIZE_SM = \"s\";\r\nexport const JSONSTAT_TABLE_FONT_SIZE_MD = \"m\";\r\nexport const JSONSTAT_TABLE_FONT_SIZE_LG = \"l\";\r\n\r\nconst COLS_PER_PAGE = 30;\r\nconst ROWS_PER_PAGE = 50;\r\n\r\nconst SLIDER_SAFETY_MARGIN_PERCENTAGE = 20;\r\n\r\nconst TABLE_RIGHT_PADDING_CELL_WIDTH = 100;\r\n\r\nlet isFirstRender = false;\r\nlet isTimeToUpdate = false;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  table: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onTimeSet: time => dispatch(setDatasetHtmlGeneratingTime(time)),\r\n  addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  removeSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError)),\r\n});\r\n\r\nconst isElementInContainer = (el, container, isVerticalScrollbarVisible, isHorizontalScrollbarVisible, checkOnlyVertical) => {\r\n  const containerRect = container.getBoundingClientRect();\r\n  const elementRect = el.getBoundingClientRect();\r\n\r\n  return (\r\n    elementRect.top >= containerRect.top &&\r\n    elementRect.bottom <= (containerRect.bottom - (isHorizontalScrollbarVisible ? SLIDER_WIDTH : 0)) &&\r\n    (checkOnlyVertical === true || (\r\n      elementRect.left >= containerRect.left &&\r\n      elementRect.right <= (containerRect.right - (isVerticalScrollbarVisible ? SLIDER_WIDTH : 0))\r\n    ))\r\n  );\r\n}\r\n\r\nconst getAttributesValueString = (valueId, valueLabel) => `${(valueLabel || valueId)}${(valueLabel !== valueId) ? ` [${valueId}]` : ''}`\r\n\r\nfunction JsonStatTable(props) {\r\n  const {\r\n    classes,\r\n    jsonStat,\r\n    layout,\r\n    labelFormat = LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME,\r\n    fontSize,\r\n    isFullscreen,\r\n    isPreview = false,\r\n    removeEmptyLines = !isPreview,\r\n    isPaginated = !isPreview,\r\n    isStickyHeader = true,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    hiddenAttributes,\r\n    addSpinner,\r\n    removeSpinner,\r\n    hideSpinner = false,\r\n    disableMouseWheel = false,\r\n    onTimeSet\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n  const [spinnerUuid] = useState(uuidv4());\r\n\r\n  const [tableSupportStructures, setTableSupportStructures] = useState(null);\r\n  const [htmlTable, setHtmlTable] = useState(\"\");\r\n\r\n  const [row, setRow] = useState(0);\r\n  const [col, setCol] = useState(0);\r\n\r\n  const [visibleRowCount, setVisibleRowCount] = useState(1);\r\n  const [visibleColCount, setVisibleColCount] = useState(1);\r\n\r\n  const [tableRightPadding, setTableRightPadding] = useState(0);\r\n\r\n  const [isHorizontalScrollbarVisible, setHorizontalScrollbarVisibility] = useState(null);\r\n  const [isVerticalScrollbarVisible, setVerticalScrollbarVisibility] = useState(null);\r\n\r\n  const [attributes, setAttributes] = useState(null);\r\n  const [isCopiedVisible, setCopiedVisibility] = useState(false);\r\n\r\n  const [worker] = useState(() => new Worker(\"./workers/getJsonStatTableSupportStructuresWorker.js\"));\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (worker) {\r\n        worker.terminate();\r\n      }\r\n    }\r\n  }, [worker]);\r\n\r\n  const handleStyle = useCallback(\r\n    (isFirstRender, isResizing) => {\r\n      if (!isPreview && tableSupportStructures) {\r\n\r\n        if (!isResizing) {\r\n\r\n          /** attribute's tooltip handling **/\r\n          const $tooltip = $(`.jsonstat-table__${uuid} #jsonstat-table__tooltip`);\r\n          $(`.jsonstat-table__${uuid} .ca .ct`)\r\n            .hover(\r\n              function () {\r\n                const $elem = $(this).get(0);\r\n                const rect = $elem.getBoundingClientRect();\r\n\r\n                const attributes = $elem.className.includes(\"ctd\")\r\n                  ? tableSupportStructures.observationAttributesMap[$elem.id].attributes\r\n                  : tableSupportStructures.dimensionAttributesMap[$elem.id.split(\",\")[0]][$elem.id.split(\",\")[1]].attributes;\r\n\r\n                const ATTRIBUTE_HEIGHT = 18;\r\n\r\n                attributes.forEach(({id, label, valueId, valueLabel}) => {\r\n                  $tooltip.append($(`<li class=\"cttt\"><b>${(label || id)}</b>: ${getAttributesValueString(valueId, valueLabel)}</li>`))\r\n                })\r\n\r\n                const left = rect.x < (window.innerWidth / 2)\r\n                  ? rect.left\r\n                  : rect.left - $tooltip.innerWidth();\r\n\r\n                $tooltip.css({\r\n                  visibility: \"visible\",\r\n                  top: rect.top - (ATTRIBUTE_HEIGHT * attributes.length) - 30,\r\n                  left: left\r\n                });\r\n              },\r\n              function () {\r\n                $tooltip.empty().css({visibility: \"hidden\"});\r\n              }\r\n            )\r\n            .click(\r\n              function () {\r\n                const $elem = $(this).get(0);\r\n\r\n                const attributes = $elem.className.includes(\"ctd\")\r\n                  ? tableSupportStructures.observationAttributesMap[$elem.id].attributes\r\n                  : tableSupportStructures.dimensionAttributesMap[$elem.id.split(\",\")[0]][$elem.id.split(\",\")[1]].attributes;\r\n\r\n                setAttributes(attributes);\r\n              }\r\n            );\r\n\r\n          /** header's height handling **/\r\n          const cell = $(`.jsonstat-table__${uuid} th.c:first`);\r\n          if ((cell.css(\"minWidth\") || \"\") === \"\" || (cell.css(\"minWidth\") || \"\") === \"0px\") {\r\n\r\n            const cellFontSize = cell.css(\"fontSize\")\r\n            const cellPaddingLeft = Number(cell.css(\"paddingLeft\").split(\"px\")[0])\r\n            const cellPaddingRight = Number(cell.css(\"paddingRight\").split(\"px\")[0])\r\n\r\n            const getTextWidthEl = $('<span>').css({\r\n              visibility: 'hidden',\r\n              position: 'absolute',\r\n              fontSize: cellFontSize\r\n            }).appendTo('body').get(0);\r\n\r\n            $(`.jsonstat-table__${uuid} table thead th`).each(function () {\r\n              const minWidth = getTextWidth($(this).text(), getTextWidthEl);\r\n              $(this).css({minWidth: ((minWidth / 2) + cellPaddingLeft + cellPaddingRight + 24)})\r\n            })\r\n\r\n            $(getTextWidthEl).remove();\r\n          }\r\n        }\r\n\r\n        if (!isPaginated) {\r\n\r\n          const stickyRowCount = (layout.cols.length + 1);\r\n          const stickyColCount = layout.rows.length;\r\n\r\n          if (isStickyHeader) {\r\n\r\n            /** header **/\r\n            const tops = [0];\r\n            const $headerRows = $(`.jsonstat-table__${uuid} thead tr`);\r\n            for (let i = 0; i < $headerRows.length; i++) {\r\n              tops.push(tops[i] + $headerRows[i].getBoundingClientRect().height);\r\n            }\r\n            for (let i = 0; i < (tops.length - 1); i++) {\r\n              $(`.jsonstat-table__${uuid} thead tr:nth-child(${i + 1}) th`).css(\"top\", tops[i]);\r\n            }\r\n\r\n            /** columns **/\r\n            const lefts = [0];\r\n            const $firstBodyRowThs = $(`.jsonstat-table__${uuid} tbody tr:not(.rs):first th`);\r\n            for (let i = 0; i < $firstBodyRowThs.length; i++) {\r\n              lefts.push(lefts[i] + $firstBodyRowThs[i].getBoundingClientRect().width);\r\n            }\r\n            for (let i = 0; i < (lefts.length - 1); i++) {\r\n              // the class \"clX\" is assigned during the html generation to the x-th column for each row, if this column have to be sticky\r\n              $(`.jsonstat-table__${uuid} th.cl${i}`).css(\"left\", lefts[i]);\r\n            }\r\n\r\n            /** sections **/\r\n            $(`.jsonstat-table__${uuid} .cs`).css({top: tops[tops.length - 1], left: 0});\r\n\r\n          } else {\r\n\r\n            if (!isFirstRender) {\r\n\r\n              /** header **/\r\n              for (let i = 0; i < stickyRowCount; i++) {\r\n                $(`.jsonstat-table__${uuid} thead tr:nth-child(${i + 1}) th`).css(\"top\", \"auto\");\r\n              }\r\n\r\n              /** columns **/\r\n              for (let i = 0; i < stickyColCount; i++) {\r\n                // the class \"clX\" is assigned during the html generation to the x-th column for each row, if this column have to be sticky\r\n                $(`.jsonstat-table__${uuid} th.cl${i}`).css(\"left\", \"auto\");\r\n              }\r\n\r\n              /** sections **/\r\n              $(`.jsonstat-table__${uuid} .cs`).css({top: \"auto\", left: \"auto\"});\r\n            }\r\n          }\r\n        }\r\n\r\n        removeSpinner(spinnerUuid);\r\n      }\r\n    },\r\n    [uuid, tableSupportStructures, layout, isPreview, isStickyHeader, isPaginated, removeSpinner, spinnerUuid]\r\n  );\r\n\r\n  const handleScrollbar = useCallback(\r\n    updateVisibleRowAndColCount => {\r\n      let $tableContainer = $(`.jsonstat-table__${uuid}`);\r\n\r\n      if ($tableContainer && tableSupportStructures) {\r\n\r\n        let isVerticalScrollbarVisible = null;\r\n        let isHorizontalScrollbarVisible = null;\r\n\r\n        const {rowCount, colCount} = tableSupportStructures;\r\n        const $table = $(`.jsonstat-table__${uuid} table`);\r\n\r\n        setVerticalScrollbarVisibility(prevIsVerticalScrollbarVisible => {\r\n          isVerticalScrollbarVisible = (row !== null && row !== undefined && row !== 0)\r\n            ? prevIsVerticalScrollbarVisible\r\n            : ((rowCount > ROWS_PER_PAGE) || (rowCount <= ROWS_PER_PAGE && $table.height() > $tableContainer.height()));\r\n          return isVerticalScrollbarVisible;\r\n        });\r\n\r\n        setHorizontalScrollbarVisibility(prevIsHorizontalScrollbarVisible => {\r\n          isHorizontalScrollbarVisible = (col !== null && col !== undefined && col !== 0)\r\n            ? prevIsHorizontalScrollbarVisible\r\n            : ((colCount > COLS_PER_PAGE) || (colCount <= COLS_PER_PAGE && ($table.width() - tableRightPadding) > $tableContainer.width()));\r\n          return isHorizontalScrollbarVisible;\r\n        });\r\n\r\n        let visibleColCount = 0;\r\n        $(`.jsonstat-table__${uuid} tbody tr:not(.rs):first td`).each((idx, el) => {\r\n          if (isElementInContainer(el, $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible)) {\r\n            visibleColCount++;\r\n          }\r\n        });\r\n        if (updateVisibleRowAndColCount) {\r\n          setVisibleColCount(visibleColCount);\r\n        }\r\n\r\n        let visibleRowCount = 0;\r\n        $(`.jsonstat-table__${uuid} tbody tr:not(.rs)`).each((idx, el) => {\r\n          if (isElementInContainer($(el).children(\"td\")[0], $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible)) {\r\n            visibleRowCount++;\r\n          }\r\n        });\r\n        $(`.jsonstat-table__${uuid} tbody tr.rs`).each((idx, el) => {\r\n          if (isElementInContainer(el, $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible, true)) {\r\n            visibleRowCount++;\r\n          }\r\n        });\r\n        if (updateVisibleRowAndColCount) {\r\n          setVisibleRowCount(visibleRowCount);\r\n        }\r\n      }\r\n    },\r\n    [uuid, tableSupportStructures, tableRightPadding, row, col]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (jsonStat && layout) {\r\n      isTimeToUpdate = false;\r\n      setTableSupportStructures(null);\r\n      setHtmlTable(\"\");\r\n\r\n      if (!hideSpinner && !isPreview) {\r\n        addSpinner(spinnerUuid, t(\"components.table.spinners.rendering\"));\r\n      }\r\n\r\n      worker.onmessage = event => {\r\n        isTimeToUpdate = true;\r\n        setTableSupportStructures(event.data);\r\n        if (event.data.hasAttributeObservationError) {\r\n          window.error.show(t(\"components.table.error.observationAttribute\"));\r\n        }\r\n      };\r\n      worker.onerror = () => {\r\n        setTableSupportStructures(null);\r\n        removeSpinner(spinnerUuid, true);\r\n      }\r\n      worker.postMessage({\r\n        jsonStat,\r\n        layout,\r\n        isPreview,\r\n        removeEmptyLines,\r\n        hiddenAttributes\r\n      });\r\n\r\n      setRow(0);\r\n      setCol(0);\r\n      isFirstRender = true;\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [jsonStat, layout, isPreview, removeEmptyLines, hideSpinner, addSpinner, removeSpinner, spinnerUuid, t]); // TODO: include \"hiddenAttributes\" in deps array\r\n\r\n  useEffect(() => {\r\n    if (isTimeToUpdate && tableSupportStructures) {\r\n      const func = () => {\r\n        handleStyle(false, true);\r\n        handleScrollbar(true);\r\n      }\r\n      window.addEventListener(\"resize\", func);\r\n      return () => window.removeEventListener(\"resize\", func);\r\n    }\r\n  }, [tableSupportStructures, handleStyle, handleScrollbar]);\r\n\r\n  useEffect(() => {\r\n    if (isTimeToUpdate && tableSupportStructures) {\r\n      const {\r\n        rows,\r\n        cols,\r\n        sections,\r\n        filters,\r\n        filtersValue,\r\n        colCount,\r\n        rowCount,\r\n        colsObj,\r\n        rowsObj,\r\n        combinations,\r\n        indexesMap,\r\n        valorizedCols,\r\n        valorizedRows,\r\n        valorizedRowsPerSection,\r\n        sectionsLength,\r\n        dimensionAttributesMap,\r\n        observationAttributesMap\r\n      } = tableSupportStructures;\r\n\r\n      const rowEnd = (row + ROWS_PER_PAGE) >= rowCount ? rowCount : (row + ROWS_PER_PAGE);\r\n      const colEnd = (col + COLS_PER_PAGE) >= colCount ? colCount : (col + COLS_PER_PAGE);\r\n\r\n      const tableRightPadding = (COLS_PER_PAGE - (colEnd - col)) * TABLE_RIGHT_PADDING_CELL_WIDTH;\r\n      setTableRightPadding(tableRightPadding);\r\n\r\n      setHtmlTable(getJsonStatTableHtml(\r\n        jsonStat,\r\n        rows,\r\n        cols,\r\n        sections,\r\n        filters,\r\n        filtersValue,\r\n        colCount,\r\n        rowCount,\r\n        colsObj,\r\n        rowsObj,\r\n        combinations,\r\n        indexesMap,\r\n        valorizedCols,\r\n        valorizedRows,\r\n        valorizedRowsPerSection,\r\n        sectionsLength,\r\n        labelFormat,\r\n        (fontSize || JSONSTAT_TABLE_FONT_SIZE_MD),\r\n        decimalSeparator,\r\n        decimalPlaces,\r\n        sanitize(emptyChar),\r\n        isPreview,\r\n        isPaginated\r\n          ? {\r\n            rowStart: row,\r\n            rowEnd: rowEnd,\r\n            colStart: col,\r\n            colEnd: colEnd,\r\n            tableRightPadding: !isPreview ? tableRightPadding : 1\r\n          }\r\n          : null,\r\n        dimensionAttributesMap,\r\n        observationAttributesMap,\r\n        onTimeSet\r\n      ));\r\n\r\n      $(`.jsonstat-table__${uuid}`).scrollTop(0).scrollLeft(0);\r\n    }\r\n  }, [uuid, tableSupportStructures, jsonStat, labelFormat, fontSize, isFullscreen, decimalSeparator, decimalPlaces, emptyChar, isPreview, isPaginated, onTimeSet, row, col]);\r\n\r\n  useEffect(() => {\r\n    if (isTimeToUpdate && htmlTable && htmlTable.length > 0) {\r\n      handleStyle(isFirstRender, false);\r\n      handleScrollbar(isFirstRender);\r\n\r\n      isFirstRender = false;\r\n    }\r\n  }, [htmlTable, handleStyle, handleScrollbar]);\r\n\r\n  return (\r\n    <Fragment>\r\n      {tableSupportStructures\r\n        ? (\r\n          <div className={classes.root}>\r\n            {isPaginated\r\n              ? (\r\n                <Scrollbars\r\n                  verticalValue={row}\r\n                  verticalMaxValue={tableSupportStructures.rowCount}\r\n                  verticalTicks={tableSupportStructures.rowCount - (visibleRowCount - Math.floor(visibleRowCount / 100 * SLIDER_SAFETY_MARGIN_PERCENTAGE))}\r\n                  onVerticalScroll={setRow}\r\n                  isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n                  horizontalValue={col}\r\n                  horizontalMaxValue={tableSupportStructures.colCount}\r\n                  horizontalTicks={tableSupportStructures.colCount - (visibleColCount - Math.floor(visibleColCount / 100 * SLIDER_SAFETY_MARGIN_PERCENTAGE))}\r\n                  onHorizontalScroll={setCol}\r\n                  isHorizontalScrollbarVisible={isHorizontalScrollbarVisible}\r\n                  disableMouseWheel={disableMouseWheel}\r\n                >\r\n                  <div\r\n                    className={`${classes.table} jsonstat-table jsonstat-table__${uuid}`}\r\n                    style={{overflow: \"hidden\"}}\r\n                    dangerouslySetInnerHTML={{__html: htmlTable}}\r\n                  />\r\n                </Scrollbars>\r\n              )\r\n              : (\r\n                <div\r\n                  className={`${classes.table} jsonstat-table jsonstat-table__${uuid}`}\r\n                  style={{overflow: \"auto\"}}\r\n                  dangerouslySetInnerHTML={{__html: htmlTable}}\r\n                />\r\n              )\r\n            }\r\n          </div>\r\n        )\r\n        : (\r\n          <CustomEmpty text={t(\"components.table.initializing\") + \"...\"}/>\r\n        )\r\n      }\r\n      <Snackbar\r\n        open={isCopiedVisible}\r\n        autoHideDuration={2000}\r\n        onClose={() => setCopiedVisibility(prevVal => !prevVal)}\r\n      >\r\n        <Alert severity=\"success\" onClose={() => setCopiedVisibility(prevVal => !prevVal)}>\r\n          {t(\"components.table.alerts.attributeCopied\")}\r\n        </Alert>\r\n      </Snackbar>\r\n      <Dialog\r\n        open={attributes !== null}\r\n        onClose={() => setAttributes(null)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.table.dialogs.observationAttributes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{width: 480}}>\r\n          <Grid container spacing={2}>\r\n            {(attributes || []).map(({id, label, valueId, valueLabel}, idx) =>\r\n              <Grid item key={idx} xs={12}>\r\n                <b>{label || id}</b>{`: ${getAttributesValueString(valueId, valueLabel)}`}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setAttributes(null)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n          <Button\r\n            color=\"primary\"\r\n            autoFocus\r\n            onClick={() => {\r\n              copy(attributes\r\n                .map(({id, label, valueId, valueLabel}) => `${(label || id)}: ${getAttributesValueString(valueId, valueLabel)}`)\r\n                .join(\", \")\r\n              );\r\n              setCopiedVisibility(prevVal => !prevVal)();\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.copy\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(null, mapDispatchToProps),\r\n  withStyles(styles)\r\n)(JsonStatTable);","import React, {Fragment, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport I18nTextField from \"../i18n-text-field\";\r\nimport JsonStatTable from \"../table\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\n\r\nconst styles = theme => ({\r\n  card: {\r\n    padding: theme.spacing(2)\r\n  },\r\n  viewer: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 16px - 64px)\",\r\n    marginTop: 16\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 48px)\",\r\n    paddingTop: 16\r\n  }\r\n});\r\n\r\nfunction TemplateBuilder(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    template,\r\n    onChange,\r\n    viewers,\r\n    jsonStat,\r\n    labelFormat,\r\n    tableLayout,\r\n    hiddenAttributes\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [tabId, setTabId] = useState(0);\r\n\r\n  return (\r\n    <Fragment>\r\n      <AppBar position=\"static\" color=\"default\">\r\n        <Tabs\r\n          value={tabId}\r\n          variant=\"scrollable\"\r\n          scrollButtons=\"auto\"\r\n          indicatorColor=\"primary\"\r\n          textColor=\"primary\"\r\n          onChange={(event, newValue) => setTabId(newValue)}\r\n        >\r\n          <Tab key={0} label={t(\"scenes.dataViewer.templateBuilder.tabs.options.label\")}/>\r\n          <Tab key={1} label={t(\"scenes.dataViewer.templateBuilder.tabs.table.label\")}/>\r\n          <Tab key={2} label={t(\"scenes.dataViewer.templateBuilder.tabs.chart.label\")}/>\r\n          <Tab key={3} label={t(\"scenes.dataViewer.templateBuilder.tabs.map.label\")}/>\r\n        </Tabs>\r\n      </AppBar>\r\n      <div className={classes.tabContent}>\r\n        {tabId === 0 && (\r\n          <Fragment>\r\n            <Card variant=\"outlined\">\r\n              <CardHeader\r\n                title={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.title\")}\r\n                titleTypographyProps={{variant: \"subtitle1\"}}\r\n              />\r\n              <Grid container spacing={3} className={classes.card}>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <I18nTextField\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.title\")}\r\n                      required\r\n                      variant=\"outlined\"\r\n                      value={template.title}\r\n                      onChange={value => onChange({...template, title: value})}\r\n                    />\r\n                  </FormControl>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <TextField\r\n                      select\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.defaultView\")}\r\n                      defaultValue=\"table\"\r\n                      value={template.defaultView}\r\n                      variant=\"outlined\"\r\n                      onChange={ev => onChange({...template, defaultView: ev.target.value})}\r\n                    >\r\n                      {viewers.map(({type, title}, idx) =>\r\n                        <MenuItem key={idx} value={type}>{title}</MenuItem>\r\n                      )}\r\n                    </TextField>\r\n                  </FormControl>\r\n                </Grid>\r\n                <Grid item xs={3}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.enableCriteria\")}\r\n                    className={classes.field}\r\n                    control={\r\n                      <Checkbox\r\n                        checked={template.enableCriteria}\r\n                        onChange={(ev, value) => onChange({...template, enableCriteria: value})}\r\n                      />\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={3}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.enableLayout\")}\r\n                    className={classes.field}\r\n                    control={\r\n                      <Checkbox\r\n                        checked={template.enableLayout}\r\n                        onChange={(ev, value) => onChange({...template, enableLayout: value})}\r\n                      />\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={3}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.enableVariation\") + \" (*)\"}\r\n                    className={classes.field}\r\n                    control={\r\n                      <Checkbox\r\n                        checked={true} // template.enableVariation\r\n                        onChange={(ev, value) => onChange({...template, enableVariation: value})}\r\n                        disabled\r\n                      />\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={3}/>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <TextField\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.decimalPlaces\")}\r\n                      value={template.decimalNumber}\r\n                      variant=\"outlined\"\r\n                      required\r\n                      onChange={ev => onChange({...template, decimalNumber: ev.target.value})}\r\n                    />\r\n                  </FormControl>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <I18nTextField\r\n                      select\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.decimalSeparator.label\")}\r\n                      value={template.decimalSeparator}\r\n                      defaultValue=\".\"\r\n                      variant=\"outlined\"\r\n                      required\r\n                      onChange={value => onChange({...template, decimalSeparator: value})}\r\n                    >\r\n                      <MenuItem value=\".\">\r\n                        {t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.decimalSeparator.values.dot\")}\r\n                      </MenuItem>\r\n                      <MenuItem value=\",\">\r\n                        {t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.decimalSeparator.values.comma\")}\r\n                      </MenuItem>\r\n                    </I18nTextField>\r\n                  </FormControl>\r\n                </Grid>\r\n              </Grid>\r\n            </Card>\r\n            <Card variant=\"outlined\" style={{marginTop: 16}}>\r\n              <CardHeader\r\n                title={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.table.title\")}\r\n                titleTypographyProps={{variant: \"subtitle1\"}}\r\n              />\r\n              <Grid container spacing={2} className={classes.card}>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <TextField\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.table.form.emptyCellPlaceholder\")}\r\n                      value={template.layouts.tableEmptyChar}\r\n                      variant=\"outlined\"\r\n                      required\r\n                      onChange={ev => onChange({\r\n                        ...template,\r\n                        layouts: {\r\n                          ...template.layouts,\r\n                          tableEmptyChar: ev.target.value\r\n                        }\r\n                      })}\r\n                    />\r\n                  </FormControl>\r\n                </Grid>\r\n                <Grid item xs={6}/>\r\n              </Grid>\r\n            </Card>\r\n            <div\r\n              style={{marginTop: 16}}>{\"(*): \" + t(\"scenes.dataViewer.templateBuilder.tabs.options.notImplemented\")}</div>\r\n          </Fragment>\r\n        )}\r\n        {tabId === 1 && (\r\n          <Fragment>\r\n            <Grid container spacing={2}>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    select\r\n                    label={t(\"scenes.dataViewer.templateBuilder.tabs.table.form.defaultLayout.label\")}\r\n                    value={template.layouts.tableDefaultLayout}\r\n                    variant=\"outlined\"\r\n                    onChange={ev => onChange({\r\n                      ...template,\r\n                      layouts: {\r\n                        ...template.layouts,\r\n                        tableDefaultLayout: ev.target.value,\r\n                        tableLayout: ev.target.value === \"custom\"\r\n                          ? tableLayout\r\n                          : null\r\n                      }\r\n                    })}\r\n                  >\r\n                    <MenuItem value=\"custom\">\r\n                      {t(\"scenes.dataViewer.templateBuilder.tabs.table.form.defaultLayout.values.custom\")}\r\n                    </MenuItem>\r\n                    <MenuItem value=\"default\">\r\n                      {t(\"scenes.dataViewer.templateBuilder.tabs.table.form.defaultLayout.values.default\")}\r\n                    </MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <div className={classes.viewer}>\r\n              {template.layouts.tableDefaultLayout === \"custom\"\r\n                ? (\r\n                  <JsonStatTable\r\n                    jsonStat={jsonStat}\r\n                    layout={tableLayout}\r\n                    labelFormat={labelFormat}\r\n                    decimalSeparator={localizeI18nObj(template.decimalSeparator, defaultLanguage, languages)}\r\n                    decimalPlaces={template.decimalNumber}\r\n                    emptyChar={template.layouts.tableEmptyChar}\r\n                    hiddenAttributes={hiddenAttributes}\r\n                  />\r\n                )\r\n                : (\r\n                  <CustomEmpty\r\n                    text={t(\"scenes.dataViewer.templateBuilder.tabs.table.form.defaultLayout.defaultPlaceholder\")}/>\r\n                )\r\n              }\r\n            </div>\r\n          </Fragment>\r\n        )}\r\n        {tabId === 2 && (\r\n          <CustomEmpty text={t(\"commons.notImplemented\")}/>\r\n        )}\r\n        {tabId === 3 && (\r\n          <CustomEmpty text={t(\"commons.notImplemented\")}/>\r\n        )}\r\n      </div>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(TemplateBuilder);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport ShareIcon from '@material-ui/icons/Share';\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {goToNode} from \"../../links\";\r\nimport HomeIcon from \"@material-ui/icons/Home\";\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport AccessTimeIcon from '@material-ui/icons/AccessTime';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport AttributeList from \"../attribute-list\";\r\nimport {\r\n  getDimensionAttributeMap,\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat\r\n} from \"../../utils/jsonStat\";\r\nimport {DECIMAL_PLACES_DEFAULT, DECIMAL_SEPARATOR_DEFAULT, TABLE_EMPTY_CHAR_DEFAULT} from \"../../utils/formatters\";\r\nimport {\r\n  canSaveAsView,\r\n  canSaveTemplate,\r\n  canShare,\r\n  canViewTemplateOrAnnotationIcon,\r\n  canViewTimesLog\r\n} from \"../../utils/user\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {validateI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  exportChartJpeg,\r\n  getDownloadFormatExtensionFromFormat,\r\n  getDownloadFormatLabelFromFormat,\r\n  isDownloadFormatValid\r\n} from \"../../utils/download\";\r\nimport DataViewerTimings from \"./Timings\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../label-format-selector/constants\";\r\nimport ViewBuilder from \"./ViewBuilder\";\r\nimport TemplateBuilder from \"./TemplateBuilder\";\r\nimport {getCriteriaArrayFromObject} from \"../../utils/criteria\";\r\nimport {\r\n  hideDatasetViewError,\r\n  hideDatasetViewTemplate,\r\n  showDatasetViewTemplate\r\n} from \"../../state/dataset/datasetActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px 0\"\r\n  },\r\n  titleContainer: {\r\n    marginRight: 8\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 500\r\n  },\r\n  subtitle: {\r\n    padding: \"0 12px 8px 48px\"\r\n  },\r\n  attributeIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontSize: 23,\r\n    fontWeight: \"bold\",\r\n    fontFamily: \"Do Hyeon\"\r\n  },\r\n  layoutIcon: {\r\n    width: 48,\r\n    height: 48,\r\n    padding: 12,\r\n    color: \"rgba(0, 0, 0, 0.54)\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user,\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  view: state.dataset.view,\r\n  template: state.dataset.template,\r\n  isViewVisible: state.dataset.isViewVisible,\r\n  isViewErrorVisible: state.dataset.isViewErrorVisible,\r\n  viewErrorMessage: state.dataset.viewErrorMessage,\r\n  isTemplateVisible: state.dataset.isTemplateVisible\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onViewTemplateShow: isView => dispatch(showDatasetViewTemplate(isView)),\r\n  onViewTemplateHide: isView => dispatch(hideDatasetViewTemplate(isView)),\r\n  onViewErrorHide: isView => dispatch(hideDatasetViewError(isView))\r\n});\r\n\r\nconst getEmptyViewTemplate = (viewTemplate, datasetId, tableEmptyChar, decimalPlaces, decimalSeparator, defaultLanguage) => ({\r\n  datasetId: datasetId,\r\n  type: \"\",\r\n  title: {},\r\n  defaultView: \"table\",\r\n  criteria: {},\r\n  layouts: {\r\n    labelFormat: LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME,\r\n    tableDefaultLayout: \"custom\",\r\n    tableLayout: {},\r\n    tableEmptyChar: (tableEmptyChar !== null && tableEmptyChar !== undefined) ? tableEmptyChar : TABLE_EMPTY_CHAR_DEFAULT,\r\n    mapLayout: {},\r\n    chartLayout: {}\r\n  },\r\n  decimalNumber: (decimalPlaces !== null && decimalPlaces !== undefined) ? decimalPlaces : DECIMAL_PLACES_DEFAULT,\r\n  decimalSeparator: {\r\n    [defaultLanguage]: (decimalSeparator || DECIMAL_SEPARATOR_DEFAULT)\r\n  },\r\n  enableCriteria: true,\r\n  enableLayout: true,\r\n  ...viewTemplate\r\n});\r\n\r\nfunction DataViewerHeader(props) {\r\n\r\n  const {\r\n    classes,\r\n    user,\r\n    defaultLanguage,\r\n    languages,\r\n    nodeId,\r\n    nodeCode,\r\n    nodeDownloadFormats,\r\n    datasetId,\r\n    datasetTitle,\r\n    viewId,\r\n    hasViewLayout,\r\n    hasTemplateLayout,\r\n    hasAnnotationLayout,\r\n    view: structureView,\r\n    template: structureTemplate,\r\n    notes,\r\n    attachedFiles,\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    labelFormat,\r\n    tableLayout,\r\n    chartLayout,\r\n    mapLayout,\r\n    criteria,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    tableEmptyChar,\r\n    chartStacked,\r\n    chartLegendPosition,\r\n    chartColors,\r\n    mapDetailLevel,\r\n    viewers,\r\n    viewerIdx,\r\n    isViewVisible,\r\n    isViewErrorVisible,\r\n    viewErrorMessage,\r\n    isTemplateVisible,\r\n    onViewTemplateShow,\r\n    onViewTemplateHide,\r\n    onViewTemplateSubmit,\r\n    onViewErrorHide,\r\n    onDownloadSubmit,\r\n    timings,\r\n    chartId,\r\n    mapId\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [initialView, setInitialView] = useState(null);\r\n  const [view, setView] = useState(null);\r\n\r\n  const [initialTemplate, setInitialTemplate] = useState(null);\r\n  const [template, setTemplate] = useState(null);\r\n\r\n  const [isAttributesVisible, setAttributesVisibility] = useState(false);\r\n  const [isNotesVisible, setNotesVisibility] = useState(false);\r\n  const [isTimingsVisible, setTimingsVisibility] = useState(false);\r\n\r\n  const [downloadFormats, setDownloadFormats] = useState([]);\r\n\r\n  const [isUpdatingView, setIsUpdatingView] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const actionsWidth = document.getElementById(\"dataset-viewer-header__actions\")\r\n      ? document.getElementById(\"dataset-viewer-header__actions\").offsetWidth\r\n      : 0;\r\n    document.getElementById(\"dataset-viewer-header__title\").setAttribute(\"style\", `width: calc(100% - ${actionsWidth}px - 8px)`);\r\n  });\r\n\r\n  useEffect(() => {\r\n    const template = getEmptyViewTemplate(structureTemplate, datasetId, tableEmptyChar, decimalPlaces, decimalSeparator, defaultLanguage);\r\n    setInitialTemplate(template);\r\n    setTemplate(template)\r\n    const view = getEmptyViewTemplate(structureView, datasetId, tableEmptyChar, decimalPlaces, decimalSeparator, defaultLanguage);\r\n    setInitialView(view);\r\n    setView(view);\r\n  }, [structureView, structureTemplate, datasetId, tableEmptyChar, decimalPlaces, decimalSeparator, defaultLanguage]);\r\n\r\n  useEffect(() => {\r\n    const newDownloadFormats = [];\r\n    (nodeDownloadFormats || []).forEach(format => {\r\n      if (isDownloadFormatValid(format)) {\r\n        newDownloadFormats.push({\r\n          label: getDownloadFormatLabelFromFormat(format, t),\r\n          format: format,\r\n          extension: getDownloadFormatExtensionFromFormat(format, t)\r\n        })\r\n      }\r\n    });\r\n    setDownloadFormats(newDownloadFormats);\r\n  }, [nodeDownloadFormats, t]);\r\n\r\n  const handleViewOpen = (defaultLanguage, isUpdate) => {\r\n    onViewTemplateShow(true);\r\n    setView({\r\n      ...initialView,\r\n      title: isUpdate\r\n        ? view.title\r\n        : {\r\n          [defaultLanguage]: datasetTitle\r\n        },\r\n      defaultView: viewers[viewerIdx].type,\r\n      criteria: criteria,\r\n      layouts: {\r\n        labelFormat: labelFormat,\r\n        tableLayout: viewerIdx === 0 ? tableLayout : undefined,\r\n        tableEmptyChar: viewerIdx === 0 ? tableEmptyChar : undefined,\r\n        mapLayout: viewerIdx === 1 ? mapLayout : undefined,\r\n        mapDetailLevel: viewerIdx === 1 ? mapDetailLevel : undefined,\r\n        chartLayout: viewerIdx >= 2 ? chartLayout : undefined,\r\n        chartStacked: viewerIdx >= 2 ? chartStacked : undefined,\r\n        chartLegendPosition: viewerIdx >= 2 ? chartLegendPosition : undefined,\r\n        chartColors: viewerIdx >= 2 ? chartColors : undefined\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleViewClose = () => {\r\n    onViewTemplateHide(true);\r\n    setView(initialView);\r\n  };\r\n\r\n  const handleViewSubmit = viewId => {\r\n    onViewTemplateSubmit({\r\n      type: \"view\",\r\n      viewTemplateId: viewId ? Number(viewId) : undefined,\r\n      datasetId: view.datasetId,\r\n      title: view.title,\r\n      defaultView: view.defaultView,\r\n      criteria: getCriteriaArrayFromObject(view.criteria),\r\n      layouts: JSON.stringify(view.layouts)\r\n    }, true);\r\n    setView(initialView);\r\n  };\r\n\r\n  const handleTemplateOpen = (defaultLanguage, isUpdate) => {\r\n    onViewTemplateShow(false);\r\n    setTemplate({\r\n      ...initialTemplate,\r\n      title: isUpdate\r\n        ? initialTemplate.title\r\n        : {\r\n          [defaultLanguage]: datasetTitle\r\n        },\r\n      criteria: criteria,\r\n      layouts: {\r\n        labelFormat: labelFormat,\r\n        tableLayout: tableLayout,\r\n        tableEmptyChar: tableEmptyChar,\r\n        mapLayout: mapLayout,\r\n        mapDetailLevel: mapDetailLevel,\r\n        chartLayout: chartLayout,\r\n        chartStacked: chartStacked,\r\n        chartLegendPosition: chartLegendPosition,\r\n        chartColors: chartColors\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleTemplateClose = () => {\r\n    onViewTemplateHide(false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const handleTemplateSubmit = () => {\r\n    onViewTemplateSubmit({\r\n      ...template,\r\n      type: \"template\",\r\n      criteria: getCriteriaArrayFromObject(template.criteria),\r\n      layouts: JSON.stringify(template.layouts)\r\n    }, false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const datasetAttributes = [];\r\n  const dataset = (jsonStat?.extension?.attributes?.dataSet || []);\r\n  const datasetIndexes = (jsonStat?.extension?.attributes?.index?.dataSet || []);\r\n\r\n  if (dataset && dataset.length > 0 && datasetIndexes && datasetIndexes.length > 0) {\r\n    (datasetIndexes || []).forEach((el, idx) => {\r\n      if (el !== null && !(hiddenAttributes || []).includes(dataset[idx].id)) {\r\n        datasetAttributes.push({\r\n          id: (dataset[idx].name || dataset[idx].id),\r\n          value: (dataset[idx].values[el].name || dataset[idx].values[el].id)\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  const otherAttributes = [];\r\n  const series = (jsonStat?.extension?.attributes?.series || []);\r\n  const seriesIndexes = (jsonStat?.extension?.attributes?.index?.series || []);\r\n\r\n  if (series && series.length > 0 && seriesIndexes && seriesIndexes.length > 0) {\r\n    seriesIndexes\r\n      .filter(({coordinates}) => (coordinates || []).filter(c => c !== null).length > 1)\r\n      .forEach(({coordinates, attributes}) => {\r\n        const dimsId = [];\r\n        const dimsValueId = [];\r\n        coordinates.forEach((el, idx) => {\r\n          if (el !== null) {\r\n            const dim = jsonStat.id[idx];\r\n            dimsId.push(dim);\r\n            dimsValueId.push(jsonStat.dimension[dim].category.index[el]);\r\n          }\r\n        });\r\n        const dims = dimsId.map((dim, idx) => ({\r\n          id: getDimensionLabelFromJsonStat(jsonStat, dim, labelFormat),\r\n          value: getDimensionValueLabelFromJsonStat(jsonStat, dim, dimsValueId[idx], labelFormat)\r\n        }));\r\n        const attrs = [];\r\n        attributes.forEach((attr, idx) => {\r\n          if (attr !== null && attr !== undefined && !(hiddenAttributes || []).includes(series[idx].id)) {\r\n            attrs.push({\r\n              id: (series[idx].name || series[idx].id),\r\n              value: (series[idx].values[attr].name || series[idx].values[attr].id)\r\n            })\r\n          }\r\n        });\r\n        if (dims.length > 0 && attrs.length > 0) {\r\n          otherAttributes.push({\r\n            dims: dims,\r\n            attributes: attrs\r\n          });\r\n        }\r\n      });\r\n  }\r\n\r\n  const currentFilters = (viewers[viewerIdx].key === 0 && tableLayout?.filters)\r\n    ? tableLayout.filters\r\n    : (viewers[viewerIdx].key === 1 && mapLayout?.filters)\r\n      ? mapLayout.filters\r\n      : (viewers[viewerIdx].key >= 2 && chartLayout?.filters)\r\n        ? chartLayout.filters\r\n        : [];\r\n\r\n  const subtitle = [];\r\n  if (jsonStat && currentFilters) {\r\n    currentFilters.forEach(filter => {\r\n      if (jsonStat.size[jsonStat.id.indexOf(filter)] === 1) {\r\n        subtitle.push({\r\n          dim: filter,\r\n          dimLabel: getDimensionLabelFromJsonStat(jsonStat, filter, labelFormat),\r\n          value: jsonStat.dimension[filter].category.index[0],\r\n          valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, filter, jsonStat.dimension[filter].category.index[0], labelFormat)\r\n        });\r\n      }\r\n    })\r\n  }\r\n\r\n  const dimensionAttributesMap = getDimensionAttributeMap(jsonStat, hiddenAttributes);\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid container className={classes.root}>\r\n        <Grid container justify=\"space-between\" alignItems=\"flex-start\">\r\n          <Grid item id=\"dataset-viewer-header__title\" className={classes.titleContainer}>\r\n            <Grid container alignItems=\"flex-start\">\r\n              <Grid item>\r\n                <Tooltip title={t(\"scenes.dataViewer.header.action.goHome.tooltip\")}>\r\n                  <IconButton color=\"primary\" onClick={() => goToNode(nodeCode)}>\r\n                    <HomeIcon/>\r\n                  </IconButton>\r\n                </Tooltip>\r\n              </Grid>\r\n              <Grid container style={{width: \"calc(100% - 48px)\"}}>\r\n                <Grid item className={classes.title}>\r\n                  <div style={{display: \"table\", minHeight: 48}}>\r\n                    <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n                      <span style={{marginRight: 4}}>{datasetTitle}</span>\r\n                      {notes && notes.length > 0 && (\r\n                        <Tooltip title={t(\"scenes.dataViewer.header.action.information.tooltip\")}>\r\n                          <IconButton id=\"dataset-attributes-btn\" onClick={() => setNotesVisibility(true)}>\r\n                            <InfoIcon/>\r\n                          </IconButton>\r\n                        </Tooltip>\r\n                      )}\r\n                      {datasetAttributes.concat(otherAttributes).length > 0 && (\r\n                        <Tooltip title={t(\"scenes.dataViewer.header.action.attributes.tooltip\")}>\r\n                          <IconButton id=\"dataset-attributes-btn\" onClick={() => setAttributesVisibility(true)}>\r\n                            <div className={classes.attributeIcon}>(*)</div>\r\n                          </IconButton>\r\n                        </Tooltip>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item id=\"dataset-viewer-header__actions\">\r\n            <Grid container alignItems=\"center\">\r\n              {(() => {\r\n                if (canViewTemplateOrAnnotationIcon(user, nodeId)) {\r\n\r\n                  let title = null;\r\n                  if (hasViewLayout) {\r\n                    title = t(\"scenes.dataViewer.header.action.hasViewLayout.tooltip\");\r\n                  } else if (hasTemplateLayout) {\r\n                    title = t(\"scenes.dataViewer.header.action.hasTemplateLayout.tooltip\");\r\n                  } else if (hasAnnotationLayout) {\r\n                    title = t(\"scenes.dataViewer.header.action.hasAnnotationLayout.tooltip\");\r\n                  }\r\n\r\n                  if (title) {\r\n                    return (\r\n                      <div className={classes.layoutIcon}>\r\n                        <Tooltip title={title}>\r\n                          <InfoIcon/>\r\n                        </Tooltip>\r\n                      </div>\r\n                    )\r\n                  }\r\n                }\r\n              })()}\r\n              {canViewTimesLog(user, nodeId) && (\r\n                <Grid item id=\"dataset-times-log-btn\">\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.timesLog.tooltip\")}>\r\n                    <div>\r\n                      <IconButton onClick={() => setTimingsVisibility(true)} disabled={timings === null}>\r\n                        <AccessTimeIcon/>\r\n                      </IconButton>\r\n                    </div>\r\n                  </Tooltip>\r\n                </Grid>\r\n              )}\r\n              {(canSaveAsView(user) || canSaveTemplate(user, nodeId)) && (\r\n                <Grid item id=\"dataset-save-btn\">\r\n                  <ButtonSelect\r\n                    icon={<SaveIcon/>}\r\n                    tooltip={t(\"scenes.dataViewer.header.action.save.tooltip\")}\r\n                    color=\"default\"\r\n                    disabled={!tableLayout && !chartLayout && !mapLayout}\r\n                  >\r\n                    {canSaveAsView(user) && (\r\n                      <div\r\n                        onClick={() => {\r\n                          handleViewOpen(defaultLanguage, false);\r\n                          setIsUpdatingView(false);\r\n                        }}\r\n                      >\r\n                        {t(\"scenes.dataViewer.header.action.save.values.createView\")}\r\n                      </div>\r\n                    )}\r\n                    {canSaveAsView(user) && hasViewLayout && viewId && (\r\n                      <div\r\n                        onClick={() => {\r\n                          handleViewOpen(defaultLanguage, true);\r\n                          setIsUpdatingView(true);\r\n                        }}\r\n                      >\r\n                        {t(\"scenes.dataViewer.header.action.save.values.updateView\")}\r\n                      </div>\r\n                    )}\r\n                    {canSaveTemplate(user, nodeId) && (\r\n                      <div onClick={() => handleTemplateOpen(defaultLanguage, hasTemplateLayout)}>\r\n                        {hasTemplateLayout\r\n                          ? t(\"scenes.dataViewer.header.action.save.values.updateTemplate\")\r\n                          : t(\"scenes.dataViewer.header.action.save.values.createTemplate\")\r\n                        }\r\n                      </div>\r\n                    )}\r\n                  </ButtonSelect>\r\n                </Grid>\r\n              )}\r\n              {canShare(user) && (\r\n                <Grid item id=\"dataset-share-btn\">\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.share.tooltip\")}>\r\n                    <IconButton onClick={window.notImplemented.show}>\r\n                      <ShareIcon/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                </Grid>\r\n              )}\r\n              <Grid item id=\"dataset-attachments-btn\">\r\n                <ButtonSelect\r\n                  icon={<AttachFileIcon/>}\r\n                  tooltip={t(\"scenes.dataViewer.header.action.attachments.tooltip\")}\r\n                  color=\"default\"\r\n                  onChange={({attachedFile}) => window.open(attachedFile.url)}\r\n                  disabled={!attachedFiles || attachedFiles.length === 0}\r\n                >\r\n                  {(attachedFiles || []).map((attachedFile, idx) => {\r\n                    const fileName = attachedFile.url.split(\"/\").pop();\r\n                    return (\r\n                      <div key={idx} data-value={{attachedFile}}>\r\n                        {`${fileName} (${attachedFile.format})`}\r\n                      </div>\r\n                    )\r\n                  })}\r\n                </ButtonSelect>\r\n              </Grid>\r\n              {(downloadFormats && downloadFormats.length > 0 && (\r\n                <Grid item id=\"dataset-export-btn\">\r\n                  <ButtonSelect\r\n                    icon={<GetAppIcon/>}\r\n                    tooltip={t(\"scenes.dataViewer.header.action.export.tooltip\")}\r\n                    color=\"default\"\r\n                    onChange={({format, extension}) => {\r\n                      if (format === \"png\" && viewerIdx === 1) {\r\n                        window.LMap.exportPng(mapId, `${datasetTitle}.png`);\r\n                      } else if (format === \"jpeg\" && viewerIdx >= 2) {\r\n                        exportChartJpeg(chartId, `${datasetTitle}.jpeg`);\r\n                      } else {\r\n                        onDownloadSubmit(format, extension);\r\n                      }\r\n                    }}\r\n                  >\r\n                    {(downloadFormats)\r\n                      .concat(viewerIdx === 1\r\n                        ? {format: \"png\", label: \"PNG\", extension: \"png\"}\r\n                        : viewerIdx >= 2\r\n                          ? {format: \"jpeg\", label: \"JPEG\", extension: \"jpeg\"}\r\n                          : []\r\n                      )\r\n                      .map(({format, label, extension}, idx) =>\r\n                        <div key={idx} data-value={{format, extension}}>\r\n                          {label}\r\n                        </div>\r\n                      )}\r\n                  </ButtonSelect>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n        <Grid item className={classes.subtitle} xs={12}>\r\n          {subtitle && dimensionAttributesMap && subtitle.map(({dim, dimLabel, value, valueLabel}, idx) =>\r\n            <div key={idx} style={{display: \"inline-block\", marginRight: 8}}>\r\n              <div style={{display: \"inline-block\"}}>\r\n                <b>{dimLabel}</b>: <i>{valueLabel}</i>\r\n              </div>\r\n              {dimensionAttributesMap[dim][value] && (\r\n                <div style={{display: \"inline-block\", marginLeft: 4}}>\r\n                  <Tooltip\r\n                    title={\r\n                      <div>\r\n                        {dimensionAttributesMap[dim][value].attributes.map(({id, label, valueId, valueLabel}, idx) => (\r\n                          <div\r\n                            key={idx}>{`${label || id}: ${valueLabel || valueId}${valueLabel !== valueId ? ` [${valueId}]` : ''}`}</div>\r\n                        ))}\r\n                      </div>\r\n                    }\r\n                    placement=\"top\"\r\n                  >\r\n                    <div>\r\n                      {`[${dimensionAttributesMap[dim][value].ids.join(\", \")}]`}\r\n                    </div>\r\n                  </Tooltip>\r\n                </div>\r\n              )}\r\n              <div style={{display: \"inline-block\"}}>\r\n                {idx < subtitle.length - 1 ? \",\" : \"\"}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <Dialog\r\n        open={isAttributesVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setAttributesVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.attributes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <AttributeList\r\n            datasetAttributes={datasetAttributes}\r\n            otherAttributes={otherAttributes}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setAttributesVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isTimingsVisible}\r\n        onClose={() => setTimingsVisibility(false)}\r\n      >\r\n        <DialogContent style={{width: 400}}>\r\n          <DataViewerTimings\r\n            timings={timings}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => setTimingsVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {initialView && (\r\n        <Fragment>\r\n          <Dialog\r\n            open={isViewVisible}\r\n            onClose={handleViewClose}\r\n          >\r\n            <DialogTitle>\r\n              {isUpdatingView\r\n                ? t(\"scenes.dataViewer.header.dialogs.view.title.update\")\r\n                : t(\"scenes.dataViewer.header.dialogs.view.title.create\")\r\n              }\r\n            </DialogTitle>\r\n            <DialogContent style={{width: 480}}>\r\n              <ViewBuilder\r\n                view={view}\r\n                onChange={setView}\r\n              />\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={handleViewClose}>\r\n                {t(\"commons.confirm.cancel\")}\r\n              </Button>\r\n              <Button\r\n                color=\"primary\"\r\n                autoFocus\r\n                onClick={() => handleViewSubmit(isUpdatingView ? viewId : null)}\r\n                disabled={!validateI18nObj(view.title)}\r\n              >\r\n                {t(\"commons.confirm.save\")}\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n          <Dialog\r\n            open={isViewErrorVisible}\r\n            maxWidth=\"md\"\r\n            onClose={onViewErrorHide}\r\n          >\r\n            <DialogTitle>\r\n              {t(\"scenes.dataViewer.header.dialogs.duplicateViewError.title\")}\r\n            </DialogTitle>\r\n            <DialogContent>\r\n              {viewErrorMessage && (\r\n                <Fragment>\r\n                  {t(\"scenes.dataViewer.header.dialogs.duplicateViewError.content\") + \": \"}\r\n                  <b>{Object.keys(viewErrorMessage).join(\", \")}</b>\r\n                </Fragment>\r\n              )}\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={onViewErrorHide}>\r\n                {t(\"commons.confirm.close\")}\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n        </Fragment>\r\n      )}\r\n\r\n      {initialTemplate && (\r\n        <Dialog\r\n          open={isTemplateVisible}\r\n          fullScreen\r\n          onClose={handleTemplateClose}\r\n        >\r\n          <DialogTitle>\r\n            {hasTemplateLayout\r\n              ? t(\"scenes.dataViewer.header.dialogs.template.title.update\")\r\n              : t(\"scenes.dataViewer.header.dialogs.template.title.create\")\r\n            }\r\n          </DialogTitle>\r\n          <DialogContent>\r\n            <TemplateBuilder\r\n              defaultLanguage={defaultLanguage}\r\n              languages={languages}\r\n              template={template}\r\n              onChange={setTemplate}\r\n              viewers={viewers}\r\n              jsonStat={jsonStat}\r\n              labelFormat={labelFormat}\r\n              tableLayout={tableLayout}\r\n              hiddenAttributes={hiddenAttributes}\r\n            />\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleTemplateClose}>\r\n              {t(\"commons.confirm.cancel\")}\r\n            </Button>\r\n            <Button\r\n              color=\"primary\"\r\n              autoFocus\r\n              onClick={handleTemplateSubmit}\r\n              disabled={(\r\n                !validateI18nObj(template.title) ||\r\n                !validateI18nObj(template.decimalSeparator) ||\r\n                !Number.isInteger(Number(template.decimalNumber)) || Number(template.decimalNumber) < 0 || Number(template.decimalNumber) > 20\r\n              )}\r\n            >\r\n              {t(\"commons.confirm.save\")}\r\n            </Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n      )}\r\n\r\n      <Dialog\r\n        open={isNotesVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setNotesVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.notes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          {notes}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setNotesVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(DataViewerHeader)","import React, {useState} from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport MenuList from \"@material-ui/core/MenuList\";\r\nimport BarChartIcon from '@material-ui/icons/BarChart';\r\nimport BottomNavigationAction from \"@material-ui/core/BottomNavigationAction\";\r\nimport BottomNavigation from \"@material-ui/core/BottomNavigation\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    textAlign: \"center\",\r\n    '& ul': {\r\n      padding: \"4px 0\",\r\n      outline: \"none\"\r\n    },\r\n    \"& .MuiBottomNavigation-root\": {\r\n      height: \"unset !important\",\r\n      outline: \"none\"\r\n    }\r\n  },\r\n  floatingMenuOption: {\r\n    width: 200,\r\n    color: \"gray\"\r\n  },\r\n  floatingMenuOptionSelected: {\r\n    color: theme.palette.primary.main\r\n  },\r\n  divider: {\r\n    margin: \"4px 0\"\r\n  },\r\n  categoryTitle: {\r\n    color: \"gray\",\r\n    fontSize: 11,\r\n    fontWeight: 500\r\n  },\r\n  referenceMetadataIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontSize: 22,\r\n    fontWeight: \"bold\",\r\n    display: \"table\"\r\n  },\r\n  iFrame: {\r\n    width: 960,\r\n    border: 0\r\n  },\r\n  navigationActionDisabled: {\r\n    color: \"rgba(0, 0, 0, 0.26) !important\",\r\n    \"& svg\": {\r\n      color: \"rgba(0, 0, 0, 0.26)\"\r\n    }\r\n  }\r\n});\r\n\r\nfunction DataViewerSideBar(props) {\r\n\r\n  const {\r\n    classes,\r\n    viewers,\r\n    selected,\r\n    isCriteriaDisabled,\r\n    isLayoutDisabled,\r\n    isTableDisabled,\r\n    isChartDisabled,\r\n    isMapDisabled,\r\n    referenceMetadataUrl,\r\n    onViewerSelect,\r\n    onCriteriaOpen,\r\n    onLayoutOpen\r\n  } = props;\r\n\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n\r\n  const [isRefMetaVisible, setRefMetaVisibility] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const handleViewerSelect = index => {\r\n    onViewerSelect(index);\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <MenuList>\r\n\r\n        <BottomNavigation onChange={onCriteriaOpen} showLabels>\r\n          <BottomNavigationAction\r\n            label={t(\"scenes.dataViewer.sidebar.criteria\")}\r\n            icon={<SettingsIcon/>}\r\n            className={isCriteriaDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isCriteriaDisabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation onChange={onLayoutOpen} showLabels>\r\n          <BottomNavigationAction\r\n            label={t(\"scenes.dataViewer.sidebar.layout\")}\r\n            icon={<EditIcon/>}\r\n            className={(isLayoutDisabled || selected === 1) ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isLayoutDisabled || selected === 1}\r\n          />\r\n        </BottomNavigation>\r\n\r\n        <Divider className={classes.divider}/>\r\n\r\n        {referenceMetadataUrl && (\r\n          <BottomNavigation\r\n            onChange={() => setRefMetaVisibility(true)}\r\n            showLabels style={{marginBottom: 8}}\r\n          >\r\n            <BottomNavigationAction\r\n              label={t(\"scenes.dataViewer.sidebar.referenceMetadata\")}\r\n              icon={\r\n                <div className={classes.referenceMetadataIcon}>\r\n                  <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n                    M\r\n                  </div>\r\n                </div>\r\n              }\r\n            />\r\n          </BottomNavigation>\r\n        )}\r\n\r\n        <BottomNavigation\r\n          value={selected === 0 ? 0 : null}\r\n          onChange={() => handleViewerSelect(0)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={viewers[0].title}\r\n            icon={viewers[0].icon}\r\n            className={isTableDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isTableDisabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation\r\n          value={selected >= 2 ? 0 : null}\r\n          onChange={({currentTarget}) => setAnchorEl(currentTarget)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={selected >= 2 ? viewers[selected].title : t(\"scenes.dataViewer.sidebar.chart\")}\r\n            icon={selected >= 2 ? viewers[selected].icon : <BarChartIcon/>}\r\n            className={isChartDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isChartDisabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation\r\n          value={selected === 1 ? 0 : null}\r\n          onChange={() => handleViewerSelect(1)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={viewers[1].title}\r\n            icon={viewers[1].icon}\r\n            className={isMapDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isMapDisabled}\r\n          />\r\n        </BottomNavigation>\r\n\r\n      </MenuList>\r\n\r\n      <Menu\r\n        anchorEl={anchorEl}\r\n        keepMounted\r\n        open={Boolean(anchorEl)}\r\n        onClose={() => setAnchorEl(null)}\r\n      >\r\n        {viewers\r\n          .slice(2)\r\n          .map(option => (\r\n            <MenuItem\r\n              className={`${classes.floatingMenuOption} ${selected === option.key ? classes.floatingMenuOptionSelected : ''}`}\r\n              key={option.key}\r\n              selected={selected === option.key}\r\n              onClick={() => handleViewerSelect(option.key)}\r\n            >\r\n              {option.icon}\r\n              <Typography style={{marginLeft: 8}}>{option.title}</Typography>\r\n            </MenuItem>\r\n          ))}\r\n      </Menu>\r\n\r\n      <Dialog\r\n        open={isRefMetaVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setRefMetaVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.sidebar.dialogs.referenceMetadata.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{height: 480}}>\r\n          <iframe\r\n            title={\"title\"}\r\n            src={referenceMetadataUrl}\r\n            style={{\r\n              border: 0,\r\n              width: \"100%\",\r\n              height: \"calc(100% - 6px)\"\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setRefMetaVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withStyles(styles)(DataViewerSideBar)","import React, {Fragment, useState} from 'react';\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    whiteSpace: \"nowrap\"\r\n  },\r\n  sheet: {\r\n    display: \"inline-block\",\r\n    marginRight: 8\r\n  }\r\n});\r\n\r\nfunction DataViewerFooter(props) {\r\n\r\n  const {\r\n    classes,\r\n    labels,\r\n    dataIdx,\r\n    setData\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isConfirmOpen, setConfirmVisibility] = useState(false);\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <div className={classes.root}>\r\n        {labels\r\n          .map((label, idx) => ({key: idx, label: label}))\r\n          .map(sheet => (\r\n            <div key={sheet.key} className={classes.sheet}>\r\n              <Chip\r\n                label={sheet.label}\r\n                color={sheet.key === dataIdx ? \"primary\" : undefined}\r\n                onClick={() => setData(sheet.key)}\r\n                deleteIcon={\r\n                  <Tooltip title={t(\"scenes.dataViewer.footer.worksheetDelete\")}>\r\n                    <CancelIcon/>\r\n                  </Tooltip>\r\n                }\r\n                onDelete={dataIdx === sheet.key\r\n                  ? undefined\r\n                  : () => setConfirmVisibility(true)\r\n                }\r\n              />\r\n            </div>\r\n          ))}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={isConfirmOpen}\r\n        onClose={() => setConfirmVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.footer.dialogs.worksheetDelete.title\")}\r\n        </DialogTitle>\r\n        <DialogActions>\r\n          <Button onClick={() => setConfirmVisibility(false)} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => setConfirmVisibility(false)} color=\"primary\" autoFocus>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(DataViewerFooter)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport {getDimensionAttributeMap, getDimensionFilterValues} from \"../../utils/jsonStat\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"../label-format-selector/constants\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  filter: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"bottom\",\r\n    minWidth: 120,\r\n    marginRight: 24,\r\n    marginBottom: 8\r\n  },\r\n  dialogContent: {\r\n    padding: \"8px !important\"\r\n  },\r\n  item: {\r\n    fontSize: 14\r\n  },\r\n  itemDisabled: {\r\n    pointerEvents: \"none\",\r\n    '& > svg': {\r\n      visibility: \"hidden\"\r\n    }\r\n  },\r\n  dimensionTitle: {\r\n    marginBottom: 4,\r\n    fontSize: 13,\r\n    color: theme.palette.primary.main\r\n  },\r\n  attributeId: {\r\n    cursor: \"default\",\r\n    fontSize: 13,\r\n    color: \"rgb(255, 255, 255)\",\r\n    backgroundColor: \"rgb(136, 136, 136)\",\r\n    borderRadius: 3,\r\n    padding: \"0 4px\"\r\n  },\r\n  attributeAst: {\r\n    cursor: \"default\",\r\n    fontSize: 15,\r\n    color: \"rgb(136, 136, 136)\",\r\n    fontFamily: \"Do Hyeon\"\r\n  }\r\n});\r\n\r\nconst getFormattedName = (id, name, labelFormat) => {\r\n  switch (labelFormat) {\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME:\r\n      return name;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID:\r\n      return id;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH:\r\n      return `[${id}] ${name}`;\r\n    default:\r\n      return name;\r\n  }\r\n};\r\n\r\nconst isMultiSelectDim = (dim, layout) => (layout?.primaryDim?.[0] === dim || layout?.secondaryDim?.[0] === dim);\r\n\r\nfunction DatasetFilters(props) {\r\n  const {\r\n    classes,\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    layout,\r\n    filterTree,\r\n    labelFormat,\r\n    onSelect\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [filters] = useState((layout?.primaryDim || []).concat((layout?.secondaryDim || [])).concat(layout?.filters || []));\r\n\r\n  const [visibleId, setVisibleId] = useState(null);\r\n  const [data, setData] = useState(null);\r\n\r\n  const [checkedKeys, setCheckedKeys] = useState(null);\r\n\r\n  const [dimensionAttributesMap, setDimensionAttributesMap] = useState(null);\r\n\r\n  useEffect(() => {\r\n    setDimensionAttributesMap(getDimensionAttributeMap(jsonStat, hiddenAttributes))\r\n  }, [jsonStat, hiddenAttributes]);\r\n\r\n  const handleFilterOpen = visibleIdx => {\r\n    setVisibleId(visibleIdx);\r\n    setData(getDimensionFilterValues(filters[visibleIdx], jsonStat, layout, filterTree, true));\r\n\r\n    const dim = filters[visibleIdx];\r\n    if (isMultiSelectDim(dim, layout)) {\r\n      if (checkedKeys === null && dim === layout?.primaryDim?.[0]) {\r\n        setCheckedKeys(layout.primaryDimValues);\r\n      } else if (checkedKeys === null && dim === layout?.secondaryDim?.[0]) {\r\n        setCheckedKeys(layout.secondaryDimValues);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleFilterClose = () => {\r\n    setVisibleId(null);\r\n    setCheckedKeys(null);\r\n    setData(null)\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.root}>\r\n        {(() => {\r\n          const getTextWidthEl = $('<span>').css({\r\n            visibility: 'hidden',\r\n            position: 'absolute',\r\n            fontSize: 16\r\n          }).appendTo('body').get(0);\r\n\r\n          const select = [];\r\n          filters.forEach((filter, idx) => {\r\n\r\n            const {\r\n              filtersValue\r\n            } = layout;\r\n\r\n            if (isMultiSelectDim(filter, layout) || jsonStat.size[jsonStat.id.indexOf(filter)] !== 1) {\r\n\r\n              const dimLabel = (jsonStat.dimension[filter].label || filter);\r\n              const minWidth = getTextWidth(dimLabel, getTextWidthEl) + 16;\r\n\r\n              select.push(\r\n                <div key={idx} className={classes.filter}>\r\n                  {isMultiSelectDim(filter, layout) && (\r\n                    <InputLabel className={classes.dimensionTitle}>\r\n                      {layout.primaryDim[0] === filter\r\n                        ? t(\"components.datasetFilters.primaryDim\")\r\n                        : t(\"components.datasetFilters.secondaryDim\")\r\n                      }\r\n                    </InputLabel>\r\n                  )}\r\n                  <FormControl style={{display: \"inline-block\", verticalAlign: \"bottom\"}}>\r\n                    <InputLabel>{dimLabel}</InputLabel>\r\n                    <Select\r\n                      open={false}\r\n                      style={{minWidth: minWidth}}\r\n                      value={isMultiSelectDim(filter, layout)\r\n                        ? layout.primaryDim[0] === filter\r\n                          ? layout.primaryDimValues\r\n                          : layout.secondaryDimValues\r\n                        : filtersValue[filter]\r\n                      }\r\n                      multiple={isMultiSelectDim(filter, layout)}\r\n                      renderValue={value => isMultiSelectDim(filter, layout)\r\n                        ? jsonStat.size[jsonStat.id.indexOf(filter)] !== 1\r\n                          ? value.length === 1\r\n                            ? t(\"components.datasetFilters.selectedCount\", {selected: value.length})\r\n                            : t(\"components.datasetFilters.selectedCount_plural\", {selected: value.length})\r\n                          : getFormattedName(value[0], jsonStat.dimension[filter].category.label[value[0]], labelFormat)\r\n                        : getFormattedName(value, jsonStat.dimension[filter].category.label[value], labelFormat)\r\n                      }\r\n                      className={`${classes.item} ${jsonStat.size[jsonStat.id.indexOf(filter)] === 1 ? classes.itemDisabled : \"\"}`}\r\n                      onOpen={() => jsonStat.size[jsonStat.id.indexOf(filter)] === 1\r\n                        ? null\r\n                        : handleFilterOpen(idx)\r\n                      }\r\n                    >\r\n                      {jsonStat.dimension[filter].category.index.map((el, idx) => (\r\n                        <MenuItem key={idx + el} value={el}>{el}</MenuItem>\r\n                      ))}\r\n                    </Select>\r\n                  </FormControl>\r\n                  {dimensionAttributesMap && dimensionAttributesMap[filter][filtersValue[filter]] && ( // TODO: attributi per dimensioni multiselezionabili\r\n                    <div style={{display: \"inline-block\", verticalAlign: \"bottom\", marginLeft: 8, marginBottom: 4}}>\r\n                      <Tooltip\r\n                        title={\r\n                          <div>\r\n                            {dimensionAttributesMap[filter][filtersValue[filter]].attributes.map(({id, label, valueId, valueLabel}, idx) => (\r\n                              <div\r\n                                key={idx}>{`${label || id}: ${valueLabel || valueId}${valueLabel !== valueId ? ` [${valueId}]` : ''}`}</div>\r\n                            ))}\r\n                          </div>\r\n                        }\r\n                        placement=\"top\"\r\n                      >\r\n                        {(() => {\r\n                          const ids = dimensionAttributesMap[filter][filtersValue[filter]].ids;\r\n                          if (ids && ids.length === 1 && ids[0].length <= 2) {\r\n                            return <div className={classes.attributeId}>{ids[0]}</div>\r\n                          } else {\r\n                            return <div className={classes.attributeAst}>(*)</div>\r\n                          }\r\n                        })()}\r\n                      </Tooltip>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )\r\n            }\r\n          });\r\n\r\n          $(getTextWidthEl).remove();\r\n\r\n          return select\r\n        })()}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={data !== null}\r\n        onClose={handleFilterClose}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent className={classes.dialogContent}>\r\n          {!isMultiSelectDim(filters[visibleId], layout)\r\n            ? (\r\n              <InfiniteScrollTable\r\n                data={data}\r\n                getRowKey={({id}) => id}\r\n                showHeader={false}\r\n                columns={[\r\n                  {\r\n                    title: \"\",\r\n                    dataIndex: 'label',\r\n                    render: (_, {id, label}) => getFormattedName(id, label, labelFormat),\r\n                    minWidth: 100\r\n                  }\r\n                ]}\r\n                onRowClick={rowData => {\r\n                  onSelect(filters[visibleId], rowData.id);\r\n                  handleFilterClose();\r\n                }}\r\n                getRowStyle={rowData => ({\r\n                  background: rowData.id === layout.filtersValue[filters[visibleId]]\r\n                    ? \"#fff9e5\"\r\n                    : undefined\r\n                })}\r\n              />\r\n            )\r\n            : (\r\n              <InfiniteScrollTable\r\n                data={data}\r\n                getRowKey={({id}) => id}\r\n                columns={[\r\n                  {\r\n                    title: t(\"components.datasetFilters.table.columns.label.title\"),\r\n                    dataIndex: 'label',\r\n                    render: (_, {id, label}) => getFormattedName(id, label, labelFormat),\r\n                    minWidth: 100,\r\n                    noFilter: true\r\n                  }\r\n                ]}\r\n                rowSelection={{\r\n                  selectedRowKeys: checkedKeys,\r\n                  onChange: checkedKeys => setCheckedKeys(data.map(({id}) => id).filter(key => checkedKeys.includes(key)))\r\n                }}\r\n              />\r\n            )\r\n          }\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleFilterClose} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          {isMultiSelectDim(filters[visibleId], layout) && (\r\n            <Button\r\n              onClick={() => {\r\n                onSelect(filters[visibleId], checkedKeys);\r\n                handleFilterClose();\r\n              }}\r\n              color=\"primary\"\r\n              disabled={(checkedKeys || []).length < 1}\r\n            >\r\n              {t(\"commons.confirm.confirm\")}\r\n            </Button>\r\n          )}\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles)\r\n)(DatasetFilters);","import React, {Fragment, useEffect, useState} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport TreeItem from \"@material-ui/lab/TreeItem\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\r\nimport TreeView from \"@material-ui/lab/TreeView\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport LibraryAddCheckIcon from \"@material-ui/icons/LibraryAddCheck\";\r\nimport FilterNoneIcon from \"@material-ui/icons/FilterNone\";\r\nimport HeightIcon from \"@material-ui/icons/Height\";\r\nimport VerticalAlignCenterIcon from \"@material-ui/icons/VerticalAlignCenter\";\r\nimport AutoSearchInput from \"../auto-search-input\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {getMaxTreeDepth, getNodesAtDepth} from \"../../utils/tree\";\r\nimport _ from \"lodash\"\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst TREE_PAGE_SIZE = 10;\r\n\r\nconst TREE_NODE_KEY_OF_LEVEL_PREFIX = \"TREE_NODE_KEY_OF_LEVEL_PREFIX_\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: \"100%\"\r\n  },\r\n  tree: {\r\n    overflow: \"auto\",\r\n    \"& .MuiTreeItem-label\": {\r\n      width: \"calc(100% - 19px)\"\r\n    }\r\n  },\r\n  treeActions: {\r\n    marginBottom: 6\r\n  },\r\n  treeNode: {\r\n    height: 34,\r\n    padding: \"2px 0\"\r\n  },\r\n  treeNodeCheckbox: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    padding: \"4px 8px\"\r\n  },\r\n  treeNodeLabel: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    fontSize: 14,\r\n    color: \"rgba(0, 0, 0, 0.65)\",\r\n    whiteSpace: \"nowrap\",\r\n    overflow: \"hidden\",\r\n    textOverflow: \"ellipsis\"\r\n  },\r\n  levelTreeNodeLabel: {\r\n    color: \"rgba(0, 0, 0, 0.85)\",\r\n    fontWeight: 500\r\n  },\r\n  treeNodeAction: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginLeft: 4,\r\n    \"& > button\": {\r\n      padding: 4\r\n    }\r\n  },\r\n  divider: {\r\n    margin: \"4px 0\"\r\n  },\r\n  showMoreNode: {\r\n    marginLeft: 10,\r\n    \"& i\": {\r\n      fontSize: 14\r\n    }\r\n  }\r\n});\r\n\r\nconst getKeys = (tree, childrenKey, getNodeKey, test) => {\r\n\r\n  const res = [];\r\n\r\n  const recursive = subTree =>\r\n    subTree\r\n      ? subTree.map(node => {\r\n        if (node[childrenKey] && node[childrenKey].length) {\r\n          recursive(node[childrenKey]);\r\n        }\r\n        if (!test || test(node)) {\r\n          res.push(getNodeKey(node));\r\n        }\r\n        return null;\r\n      })\r\n      : [];\r\n\r\n  recursive(tree);\r\n\r\n  return res;\r\n}\r\n\r\nconst getFilteredTree = (tree, childrenKey, labelKey, searchText, defaultLanguage, languages, isLabelNotMultilingual) => {\r\n\r\n  const filterNode = node => {\r\n    const search = searchText.toLowerCase();\r\n    return (\r\n      (node.id && node.id.toLowerCase().indexOf(search) >= 0) ||\r\n      (isLabelNotMultilingual && node[labelKey].toLowerCase().indexOf(search) >= 0) ||\r\n      (!isLabelNotMultilingual && localizeI18nObj(node[labelKey], defaultLanguage, languages).toLowerCase().indexOf(search) >= 0)\r\n    );\r\n  };\r\n\r\n  const recursive = subtree => subtree\r\n    ? ([\r\n      ...subtree\r\n        .map(node => ({...node}))\r\n        .filter(node => {\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            if (filterNode(node)) {\r\n              return true;\r\n            } else {\r\n              const filteredChildren = [...recursive(node[childrenKey], filterNode)];\r\n              if (filteredChildren.length) {\r\n                node[childrenKey] = filteredChildren;\r\n                return true;\r\n              } else {\r\n                return false;\r\n              }\r\n            }\r\n          } else {\r\n            return filterNode(node);\r\n          }\r\n        })\r\n    ])\r\n    : null;\r\n\r\n  return recursive(tree, filterNode);\r\n}\r\n\r\nconst handleHeight = (uuid, keys, withLevelSelector) => {\r\n\r\n  const actionHeight = $(`.enhanced-tree__${uuid} .enhanced-tree__actions`).css(\"height\");\r\n\r\n  let levelSelectorHeight = 0;\r\n  if (withLevelSelector) {\r\n    levelSelectorHeight = 32 + 16;\r\n    let found = false;\r\n    for (let i = 0; i < keys.length; i++) {\r\n      if (keys.find(key => key === TREE_NODE_KEY_OF_LEVEL_PREFIX + i) && !found) {\r\n        levelSelectorHeight += 32;\r\n      } else {\r\n        found = true\r\n      }\r\n    }\r\n  }\r\n\r\n  $(`.enhanced-tree__${uuid} .enhanced-tree__tree`).css(\"height\", `calc(100% - ${actionHeight} - ${levelSelectorHeight}px)`);\r\n}\r\n\r\nfunction EnhancedTree(props) {\r\n\r\n  const {\r\n    languages,\r\n    defaultLanguage,\r\n    classes,\r\n    tree,\r\n    getNodeKey,\r\n    childrenKey,\r\n    labelKey,\r\n    getNodeLabel,\r\n    checkable,\r\n    isCheckDisabled,\r\n    defaultExpandedKeys,\r\n    nodeActions,\r\n    withoutSearch,\r\n    withoutCheckControls,\r\n    withoutExpandControls,\r\n    withLevelSelector,\r\n    withoutPagination,\r\n    getIsCheckable,\r\n    isLabelNotMultilingual\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [searchText, setSearchText] = useState(\"\");\r\n\r\n  const [checkedKeys, setCheckedKeys] = useState(props.checkedKeys || []);\r\n  const [expandedKeys, setExpandedKeys] = useState(defaultExpandedKeys || []);\r\n  const [showMoreKeyClicks, setShowMoreKeyClicks] = useState({});\r\n\r\n  useEffect(() => {\r\n    handleHeight(uuid, [], withLevelSelector)\r\n  }, [uuid, withLevelSelector])\r\n\r\n  const handleCheck = (checkedNode, checked) => {\r\n\r\n    const newCheckedKeys = [...(props.checkedKeys || checkedKeys)];\r\n    checked\r\n      ? newCheckedKeys.push(getNodeKey(checkedNode))\r\n      : newCheckedKeys.splice((props.checkedKeys || checkedKeys).indexOf(getNodeKey(checkedNode)), 1);\r\n\r\n    setCheckedKeys(newCheckedKeys);\r\n    if (props.onCheck) {\r\n      props.onCheck(newCheckedKeys)\r\n    }\r\n  }\r\n\r\n  const handleLevelCheck = (checkedNode, checked) => {\r\n\r\n    const nodesAtDepth = getNodesAtDepth(filteredTree, childrenKey, checkedNode.level + 1)\r\n      .filter(node => getIsCheckable ? getIsCheckable(node) : true)\r\n      .map(node => getNodeKey(node));\r\n\r\n    let newCheckedKeys = [...(props.checkedKeys || checkedKeys)];\r\n    newCheckedKeys = checked\r\n      ? _.uniq(newCheckedKeys.concat(nodesAtDepth))\r\n      : newCheckedKeys.filter(key => !nodesAtDepth.includes(key));\r\n\r\n    setCheckedKeys(newCheckedKeys)\r\n    if (props.onCheck) {\r\n      props.onCheck(newCheckedKeys)\r\n    }\r\n  }\r\n\r\n  const handleExpand = expandedKeys => {\r\n    setExpandedKeys(expandedKeys);\r\n    if (props.onExpand) {\r\n      props.onExpand(expandedKeys)\r\n    }\r\n  }\r\n\r\n  const handleSearch = searchText => {\r\n    setSearchText(searchText)\r\n    setExpandedKeys((searchText && searchText.length > 0)\r\n      ? getKeys(filteredTree, childrenKey, getNodeKey)\r\n      : [] // TODO: quale dovrebbe essere il comportamento corretto?\r\n    )\r\n  }\r\n\r\n  const getShowMoreNode = parent => {\r\n\r\n    const key = `${parent ? getNodeKey(parent) : 'root'}`;\r\n\r\n    const remaining = (parent ? parent[childrenKey] : filteredTree.filter(node => node != null)).length - ((showMoreKeyClicks[key] || 0) + 1) * TREE_PAGE_SIZE;\r\n\r\n    return (\r\n      <TreeItem\r\n        key={`${key}_showMore`}\r\n        nodeId={`${key}_showMore`}\r\n        className={classes.showMoreNode}\r\n        label={\r\n          <i\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              setShowMoreKeyClicks({\r\n                ...showMoreKeyClicks,\r\n                [key]:\r\n                  showMoreKeyClicks[key]\r\n                    ? showMoreKeyClicks[key] + 1\r\n                    : 1\r\n              })\r\n            }}\r\n          >\r\n            {t(\"components.enhancedTree.showMore\", {more: Math.min(remaining, TREE_PAGE_SIZE), remaining: remaining})}\r\n          </i>\r\n        }\r\n      />\r\n    );\r\n  }\r\n\r\n  const getTreeNode = (node, getNodeKey, isLevelTree, checkable, checkedKeys, onCheck, getIsCheckable) => {\r\n\r\n    const actions = (nodeActions || [])\r\n      .filter(act => act)\r\n      .map(act => typeof (act) === \"function\" ? act(node) : act)\r\n      .filter(act => act);\r\n\r\n    const label = (getNodeLabel && !isLevelTree)\r\n      ? getNodeLabel(node)\r\n      : isLabelNotMultilingual\r\n        ? node[labelKey]\r\n        : localizeI18nObj(node[labelKey], defaultLanguage, languages);\r\n\r\n    return (\r\n      <TreeItem\r\n        key={getNodeKey(node)}\r\n        nodeId={getNodeKey(node)}\r\n        label={\r\n          <div className={classes.treeNode}>\r\n            {checkable && (\r\n              <Checkbox\r\n                className={classes.treeNodeCheckbox}\r\n                checked={!isLevelTree\r\n                  ? checkedKeys.includes(getNodeKey(node))\r\n                  : !getNodesAtDepth(filteredTree, childrenKey, node.level + 1).filter(node => getIsCheckable ? getIsCheckable(node) : true).map(node => getNodeKey(node)).some(val => checkedKeys.indexOf(val) === -1)}\r\n                onClick={event => {\r\n                  onCheck(node, event.target.checked);\r\n                  event.stopPropagation();\r\n                }}\r\n                disabled={isCheckDisabled || (getIsCheckable ? !getIsCheckable(node) : false)}\r\n              />\r\n            )}\r\n            <Tooltip title={label}>\r\n              <div\r\n                className={`${classes.treeNodeLabel} ${isLevelTree ? classes.levelTreeNodeLabel : \"\"}`}\r\n                style={{width: `calc(100% - ${(checkable ? 40 : 0) + ((actions && actions.length > 0) ? 4 + (32 * actions.length) : 0)}px)`}}\r\n              >\r\n                {label}\r\n              </div>\r\n            </Tooltip>\r\n            {!isLevelTree && (\r\n              <div className={classes.treeNodeAction}>\r\n                {actions\r\n                  .filter(action => (action !== null && action !== undefined))\r\n                  .map((action, idx) =>\r\n                    <Tooltip key={idx} title={action.title}>\r\n                      <IconButton\r\n                        onClick={event => {\r\n                          action.onClick(node);\r\n                          event.stopPropagation();\r\n                        }}\r\n                      >\r\n                        {action.icon}\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        }\r\n      >\r\n        {node[childrenKey]\r\n          ? node[childrenKey]\r\n            .filter((child, index) => withoutPagination || index < TREE_PAGE_SIZE * ((showMoreKeyClicks[getNodeKey(node)] || 0) + 1))\r\n            .map(child => getTreeNode(child, getNodeKey, isLevelTree, checkable, checkedKeys, onCheck, getIsCheckable))\r\n            .concat(!withoutPagination && node[childrenKey].length > TREE_PAGE_SIZE * ((showMoreKeyClicks[getNodeKey(node)] || 0) + 1)\r\n              ? [getShowMoreNode(node)]\r\n              : []\r\n            )\r\n          : null\r\n        }\r\n      </TreeItem>\r\n    )\r\n  };\r\n\r\n  const filteredTree = getFilteredTree(tree, childrenKey, labelKey, searchText, defaultLanguage, languages, isLabelNotMultilingual);\r\n\r\n  let levelTree = []\r\n  if (withLevelSelector) {\r\n    const maxTreeDepth = getMaxTreeDepth(filteredTree, childrenKey);\r\n    levelTree = [{\r\n      id: TREE_NODE_KEY_OF_LEVEL_PREFIX + 0,\r\n      [labelKey]: isLabelNotMultilingual\r\n        ? t(\"components.enhancedTree.levelSelector\", {level: 0})\r\n        : {\r\n          [defaultLanguage]: t(\"components.enhancedTree.levelSelector\", {level: 0})\r\n        },\r\n      level: 0,\r\n    }];\r\n    if (maxTreeDepth !== null && maxTreeDepth !== 0) {\r\n      [...Array(maxTreeDepth - 1)].forEach(() => {\r\n        let pointer = levelTree[0];\r\n        let counter = 0;\r\n        while (pointer[childrenKey]) {\r\n          pointer = pointer[childrenKey][0];\r\n          counter++;\r\n        }\r\n        pointer[childrenKey] = [\r\n          {\r\n            id: TREE_NODE_KEY_OF_LEVEL_PREFIX + Number(counter + 1),\r\n            [labelKey]: isLabelNotMultilingual\r\n              ? t(\"components.enhancedTree.levelSelector\", {level: counter + 1})\r\n              : {\r\n                [defaultLanguage]: t(\"components.enhancedTree.levelSelector\", {level: counter + 1})\r\n              },\r\n            level: counter + 1\r\n          }\r\n        ]\r\n      });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={`enhanced-tree enhanced-tree__${uuid} ${classes.root}`}>\r\n      <div className={`enhanced-tree__actions ${classes.treeActions}`}>\r\n        <Grid container justify=\"space-between\">\r\n          <Grid item xs={6}>\r\n            {!withoutCheckControls\r\n              ? (\r\n                <Fragment>\r\n                  <Tooltip title={t(\"components.enhancedTree.selectAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => {\r\n                        const newCheckedKeys = getKeys(filteredTree, childrenKey, getNodeKey, getIsCheckable);\r\n                        setCheckedKeys(newCheckedKeys)\r\n                        if (props.onCheck) {\r\n                          props.onCheck(newCheckedKeys)\r\n                        }\r\n                      }}\r\n                      disabled={isCheckDisabled}\r\n                    >\r\n                      <LibraryAddCheckIcon/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                  <Tooltip title={t(\"components.enhancedTree.deselectAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => {\r\n                        setCheckedKeys([])\r\n                        if (props.onCheck) {\r\n                          props.onCheck([])\r\n                        }\r\n                      }}\r\n                      disabled={isCheckDisabled}\r\n                    >\r\n                      <FilterNoneIcon style={{padding: 1}}/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                </Fragment>\r\n              )\r\n              : null\r\n            }\r\n            {!withoutExpandControls\r\n              ? (\r\n                <Fragment>\r\n                  <Tooltip title={t(\"components.enhancedTree.expandAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => handleExpand(getKeys(filteredTree, childrenKey, getNodeKey))}><HeightIcon/></IconButton>\r\n                  </Tooltip>\r\n                  <Tooltip title={t(\"components.enhancedTree.collapseAll.tooltip\")}>\r\n                    <IconButton onClick={() => handleExpand([])}><VerticalAlignCenterIcon/></IconButton>\r\n                  </Tooltip>\r\n                </Fragment>\r\n              )\r\n              : null\r\n            }\r\n          </Grid>\r\n          <Grid item xs={6} style={{padding: \"8px 0\"}}>\r\n            {!withoutSearch\r\n              ? (\r\n                <AutoSearchInput\r\n                  onSearch={handleSearch}\r\n                />\r\n              )\r\n              : null\r\n            }\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n      {withLevelSelector && getKeys(filteredTree, childrenKey, getNodeKey).length > 1 && (\r\n        <Fragment>\r\n          <TreeView\r\n            defaultCollapseIcon={<ExpandMoreIcon/>}\r\n            defaultExpandIcon={<ChevronRightIcon/>}\r\n            disableSelection\r\n            onNodeToggle={(ev, nodeIds) => handleHeight(uuid, nodeIds, withLevelSelector)}\r\n          >\r\n            {levelTree.map(node => getTreeNode(node, ({id}) => id, true, checkable, (props.checkedKeys || checkedKeys), handleLevelCheck, getIsCheckable))}\r\n          </TreeView>\r\n          <Divider className={classes.divider}/>\r\n        </Fragment>\r\n      )}\r\n      <div className={`enhanced-tree__tree ${classes.tree}`}>\r\n        {(filteredTree && filteredTree.length > 0)\r\n          ? (\r\n            <TreeView\r\n              defaultCollapseIcon={<ExpandMoreIcon/>}\r\n              defaultExpandIcon={<ChevronRightIcon/>}\r\n              disableSelection\r\n              expanded={expandedKeys}\r\n              onNodeToggle={(ev, nodeIds) => handleExpand(nodeIds)}\r\n            >\r\n              {filteredTree.map(node => getTreeNode(node, getNodeKey, false, checkable, (props.checkedKeys || checkedKeys), handleCheck, getIsCheckable))}\r\n            </TreeView>\r\n          )\r\n          : <CustomEmpty/>\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(EnhancedTree)","import React, {Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {DatePicker, MuiPickersUtilsProvider} from '@material-ui/pickers';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport moment from \"moment\";\r\nimport _ from \"lodash\"\r\nimport {\r\n  CRITERIA_FILTER_TYPE_PERIODS,\r\n  CRITERIA_FILTER_TYPE_RANGE,\r\n  FREQ_MONTHLY,\r\n  FREQ_QUARTERLY,\r\n  FREQ_SEMESTER\r\n} from \"../../utils/criteria\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Switch from '@material-ui/core/Switch';\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  selectContainer: {},\r\n  formControl: {\r\n    width: \"100%\"\r\n  },\r\n  timePeriodInput: {\r\n    width: \"100%\"\r\n  },\r\n  alert: {\r\n    marginTop: 8\r\n  },\r\n  typeSelectorContainer: {\r\n    marginTop: 8\r\n  },\r\n  typeSelectorLabel: {\r\n    height: 38,\r\n    lineHeight: \"38px\"\r\n  },\r\n  typeSelectorSwitch: {\r\n    \"& > span.MuiSwitch-switchBase\": {\r\n      color: \"#00295a\"\r\n    },\r\n    \"& > span.MuiSwitch-track\": {\r\n      background: \"#00295a\"\r\n    }\r\n  },\r\n  lastPeriodsLabel: {\r\n    height: 48,\r\n    lineHeight: \"48px\"\r\n  },\r\n  lastPeriodsInput: {\r\n    \"& input\": {\r\n      height: 20,\r\n      padding: 14\r\n    }\r\n  }\r\n});\r\n\r\nconst periods = year => ({\r\n  [FREQ_SEMESTER]: {\r\n    values: [\"S1\", \"S2\"],\r\n    S1: {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    S2: {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  [FREQ_QUARTERLY]: {\r\n    values: [\"Q1\", \"Q2\", \"Q3\", \"Q4\"],\r\n    Q1: {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-03`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q2: {\r\n      start: `${year}-04-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q3: {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-09`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q4: {\r\n      start: `${year}-10-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  [FREQ_MONTHLY]: {\r\n    values: [\"01\", \"02\", \"03\", \"04\", \"05\", \"06\", \"07\", \"08\", \"09\", \"10\", \"11\", \"12\"],\r\n    \"01\": {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-01`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"02\": {\r\n      start: `${year}-02-01`,\r\n      end: moment(`${year}-02`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"03\": {\r\n      start: `${year}-03-01`,\r\n      end: moment(`${year}-03`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"04\": {\r\n      start: `${year}-04-01`,\r\n      end: moment(`${year}-04`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"05\": {\r\n      start: `${year}-05-01`,\r\n      end: moment(`${year}-05`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"06\": {\r\n      start: `${year}-06-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"07\": {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-07`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"08\": {\r\n      start: `${year}-08-01`,\r\n      end: moment(`${year}-08`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"09\": {\r\n      start: `${year}-09-01`,\r\n      end: moment(`${year}-09`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"10\": {\r\n      start: `${year}-10-01`,\r\n      end: moment(`${year}-10`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"11\": {\r\n      start: `${year}-11-01`,\r\n      end: moment(`${year}-11`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"12\": {\r\n      start: `${year}-12-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  }\r\n});\r\n\r\nconst getYearsArray = (startYear, endYear) => {\r\n  const res = [];\r\n\r\n  if (startYear && endYear) {\r\n    const startYearNumeric = Number(startYear);\r\n    const endYearNumeric = Number(endYear);\r\n\r\n    for (let i = startYearNumeric; i <= endYearNumeric; i++) {\r\n      res.push(i + \"\");\r\n    }\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nconst getPeriod = (freq, date) => {\r\n  if (freq && date) {\r\n    const year = date.slice(0, 4);\r\n\r\n    if (periods(year)[freq]) {\r\n      const dateMoment = moment(date, \"YYYY-MM-DD\");\r\n\r\n      return periods(year)[freq].values.find(period => {\r\n        const start = moment(periods(year)[freq][period].start, \"YYYY-MM-DD\");\r\n        const end = moment(periods(year)[freq][period].end, \"YYYY-MM-DD\");\r\n\r\n        return dateMoment.isBetween(start, end, null, \"[]\");\r\n      });\r\n    }\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nconst getNewTimePeriodFromYear = (timePeriod, date, year, minYear, maxYear, period, minPeriod, maxPeriod, isFrom) => {\r\n  let newDate;\r\n\r\n  if (isFrom) {\r\n    if (year === minYear && period && minPeriod) {\r\n      if (moment((year + period), \"YYYY-MM-DD\").isSameOrAfter(moment(timePeriod.minDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].start;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][minPeriod].start;\r\n      }\r\n\r\n    } else if (year === maxYear && period && maxPeriod) {\r\n      if (moment((year + period), \"YYYY-MM-DD\").isSameOrBefore(moment(timePeriod.maxDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].start;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][maxPeriod].start;\r\n      }\r\n\r\n    } else {\r\n      newDate = period\r\n        ? periods(year)[timePeriod.freq][period].start\r\n        : year + \"-01-01\";\r\n    }\r\n\r\n  } else {\r\n    if (year === minYear && period && minPeriod) {\r\n      if (period && moment((year + period), \"YYYY-MM-DD\").isSameOrAfter(moment(timePeriod.minDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].end;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][minPeriod].end;\r\n      }\r\n\r\n    } else if (year === maxYear && period && maxPeriod) {\r\n      if (period && moment((year + period), \"YYYY-MM-DD\").isSameOrBefore(moment(timePeriod.maxDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].end;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][maxPeriod].end;\r\n      }\r\n\r\n    } else {\r\n      newDate = period\r\n        ? periods(year)[timePeriod.freq][period].end\r\n        : year + \"-12-31\";\r\n    }\r\n  }\r\n\r\n  return {\r\n    ...timePeriod,\r\n    fromDate: isFrom ? newDate : timePeriod.fromDate,\r\n    toDate: !isFrom ? newDate : timePeriod.toDate,\r\n  }\r\n};\r\n\r\nconst handleSetTimePeriod = (newTimePeriod, onSetTimePeriod, setCriteriaValidity) => {\r\n  onSetTimePeriod(newTimePeriod);\r\n  setCriteriaValidity(moment(newTimePeriod.fromDate, \"YYYY-MM-DD\").isSameOrBefore(moment(newTimePeriod.toDate, \"YYYY-MM-DD\")));\r\n};\r\n\r\nconst TimePeriod = ({\r\n                      t,\r\n                      classes,\r\n                      timePeriod,\r\n                      onSetTimePeriod,\r\n                      isCriteriaValid,\r\n                      setCriteriaValidity\r\n                    }) => {\r\n\r\n  const minYear = timePeriod.minDate ? moment(timePeriod.minDate).format(\"YYYY\") : null;\r\n  const maxYear = timePeriod.maxDate ? moment(timePeriod.maxDate).format(\"YYYY\") : null;\r\n  const fromYear = timePeriod.fromDate ? moment(timePeriod.fromDate).format(\"YYYY\") : null;\r\n  const toYear = timePeriod.toDate ? moment(timePeriod.toDate).format(\"YYYY\") : null;\r\n\r\n  const minPeriod = getPeriod(timePeriod.freq, timePeriod.minDate);\r\n  const maxPeriod = getPeriod(timePeriod.freq, timePeriod.maxDate);\r\n  const fromPeriod = getPeriod(timePeriod.freq, timePeriod.fromDate);\r\n  const toPeriod = getPeriod(timePeriod.freq, timePeriod.toDate);\r\n\r\n  const fromPeriods = periods(fromYear)[timePeriod.freq]\r\n    ? periods(fromYear)[timePeriod.freq].values.slice(\r\n      fromYear === minYear ? periods(fromYear)[timePeriod.freq].values.indexOf(minPeriod) : 0,\r\n      fromYear === maxYear ? periods(fromYear)[timePeriod.freq].values.indexOf(maxPeriod) + 1 : undefined\r\n    )\r\n    : [];\r\n  const toPeriods = periods(toYear)[timePeriod.freq]\r\n    ? periods(toYear)[timePeriod.freq].values.slice(\r\n      toYear === minYear ? periods(toYear)[timePeriod.freq].values.indexOf(minPeriod) : 0,\r\n      toYear === maxYear ? periods(toYear)[timePeriod.freq].values.indexOf(maxPeriod) + 1 : undefined\r\n    )\r\n    : [];\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid container spacing={3}>\r\n        <Grid item xs={12}>\r\n          {timePeriod.freq !== null && !timePeriod.missingRange && (\r\n            <Grid container spacing={2} justify=\"flex-end\">\r\n              <Grid item>\r\n                <div className={classes.typeSelectorLabel}>\r\n                  {t(\"components.criteria.timePeriod.typeSelector.selectRange\")}\r\n                </div>\r\n              </Grid>\r\n              <Grid item>\r\n                <Switch\r\n                  className={classes.typeSelectorSwitch}\r\n                  color=\"default\"\r\n                  checked={timePeriod.selectorType === CRITERIA_FILTER_TYPE_PERIODS}\r\n                  onChange={() => onSetTimePeriod({\r\n                    ...timePeriod,\r\n                    selectorType: timePeriod.selectorType === CRITERIA_FILTER_TYPE_PERIODS\r\n                      ? CRITERIA_FILTER_TYPE_RANGE\r\n                      : CRITERIA_FILTER_TYPE_PERIODS\r\n                  })}\r\n                />\r\n              </Grid>\r\n              <Grid item>\r\n                <div className={classes.typeSelectorLabel}>\r\n                  {t(\"components.criteria.timePeriod.typeSelector.selectLastPeriods\")}\r\n                </div>\r\n              </Grid>\r\n            </Grid>\r\n          )}\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          {timePeriod.selectorType === CRITERIA_FILTER_TYPE_RANGE\r\n            ? timePeriod.freq !== null\r\n              ? (\r\n                <Fragment>\r\n                  {!isCriteriaValid && (\r\n                    <Grid item xs={12} className={classes.alert}>\r\n                      <Alert severity=\"warning\">{t(\"components.criteria.timePeriod.alert.notValidRange\")}</Alert>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid container spacing={4}>\r\n                    <Grid item xs={12}>\r\n                      <Grid container spacing={2} className={classes.selectContainer}>\r\n                        <Grid item xs={12}>\r\n                          {t(\"components.criteria.timePeriod.start\")}\r\n                        </Grid>\r\n                        <Grid item xs={periods(fromYear)[timePeriod.freq] !== undefined ? 6 : 12}>\r\n                          {fromYear && minYear && toYear && (\r\n                            <FormControl className={classes.formControl}>\r\n                              <InputLabel>{t(\"components.criteria.timePeriod.year\")}</InputLabel>\r\n                              <Select\r\n                                value={fromYear}\r\n                                onChange={ev => {\r\n                                  const year = ev.target.value;\r\n                                  const newTimePeriod = getNewTimePeriodFromYear(timePeriod, timePeriod.fromDate, year, minYear, maxYear, fromPeriod, minPeriod, maxPeriod, true);\r\n                                  handleSetTimePeriod(newTimePeriod, onSetTimePeriod, setCriteriaValidity);\r\n                                }}\r\n                              >\r\n                                {getYearsArray(minYear, maxYear).map((year, idx) => (\r\n                                  <MenuItem key={idx} value={year}>{year}</MenuItem>\r\n                                ))}\r\n                              </Select>\r\n                            </FormControl>\r\n                          )}\r\n                        </Grid>\r\n                        {fromYear && periods(fromYear)[timePeriod.freq] !== undefined && fromPeriods && fromPeriod && (\r\n                          <Grid item xs={6}>\r\n                            <FormControl className={classes.formControl}>\r\n                              <InputLabel>{t(\"components.criteria.timePeriod.period\")}</InputLabel>\r\n                              <Select\r\n                                value={fromPeriod}\r\n                                onChange={ev => {\r\n                                  const period = ev.target.value;\r\n                                  const newTimePeriod = _.cloneDeep(timePeriod);\r\n                                  newTimePeriod.fromDate = periods(fromYear)[timePeriod.freq][period].start;\r\n                                  handleSetTimePeriod(newTimePeriod, onSetTimePeriod, setCriteriaValidity);\r\n                                }}\r\n                              >\r\n                                {fromPeriods.map((period, idx) => (\r\n                                  <MenuItem key={idx} value={period}>{period}</MenuItem>\r\n                                ))}\r\n                              </Select>\r\n                            </FormControl>\r\n                          </Grid>\r\n                        )}\r\n                      </Grid>\r\n                    </Grid>\r\n                    <Grid item xs={12}>\r\n                      <Grid container spacing={2} className={classes.selectContainer}>\r\n                        <Grid item xs={12}>\r\n                          {t(\"components.criteria.timePeriod.end\")}\r\n                        </Grid>\r\n                        <Grid item xs={periods(toYear)[timePeriod.freq] !== undefined ? 6 : 12}>\r\n                          {toYear && fromYear && maxYear && (\r\n                            <FormControl className={classes.formControl}>\r\n                              <InputLabel>{t(\"components.criteria.timePeriod.year\")}</InputLabel>\r\n                              <Select\r\n                                value={toYear}\r\n                                onChange={ev => {\r\n                                  const year = ev.target.value;\r\n                                  const newTimePeriod = getNewTimePeriodFromYear(timePeriod, timePeriod.toDate, year, minYear, maxYear, toPeriod, minPeriod, maxPeriod, false);\r\n                                  handleSetTimePeriod(newTimePeriod, onSetTimePeriod, setCriteriaValidity);\r\n                                }}\r\n                              >\r\n                                {getYearsArray(minYear, maxYear).map((year, idx) => (\r\n                                  <MenuItem key={idx} value={year}>{year}</MenuItem>\r\n                                ))}\r\n                              </Select>\r\n                            </FormControl>\r\n                          )}\r\n                        </Grid>\r\n                        {toYear && periods(toYear)[timePeriod.freq] !== undefined && toPeriods && toPeriod && (\r\n                          <Grid item xs={6}>\r\n                            <FormControl className={classes.formControl}>\r\n                              <InputLabel>{t(\"components.criteria.timePeriod.period\")}</InputLabel>\r\n                              <Select\r\n                                value={toPeriods.includes(toPeriod) ? toPeriod : toPeriods[toPeriods.length - 1]}\r\n                                onChange={ev => {\r\n                                  const period = ev.target.value;\r\n                                  const newTimePeriod = _.cloneDeep(timePeriod);\r\n                                  newTimePeriod.toDate = periods(toYear)[timePeriod.freq][period].end;\r\n                                  handleSetTimePeriod(newTimePeriod, onSetTimePeriod, setCriteriaValidity);\r\n                                }}\r\n                              >\r\n                                {toPeriods.map((period, idx) => (\r\n                                  <MenuItem key={idx} value={period}>{period}</MenuItem>\r\n                                ))}\r\n                              </Select>\r\n                            </FormControl>\r\n                          </Grid>\r\n                        )}\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Fragment>\r\n              )\r\n              : (\r\n                <Grid container spacing={3}>\r\n                  <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n                    <Grid item xs={6}>\r\n                      <DatePicker\r\n                        openTo=\"year\"\r\n                        format=\"yyyy-MM-dd\"\r\n                        label={t(\"components.criteria.timePeriod.from\")}\r\n                        views={[\"year\", \"month\", \"date\"]}\r\n                        clearable\r\n                        minDate={moment(timePeriod.minDate)}\r\n                        maxDate={moment(timePeriod.toDate)}\r\n                        value={moment(timePeriod.fromDate)}\r\n                        onChange={date => onSetTimePeriod({\r\n                          ...timePeriod,\r\n                          fromDate: date ? moment(date).format(\"YYYY-MM-DD\") : timePeriod.minDate\r\n                        })}\r\n                        className={classes.timePeriodInput}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <DatePicker\r\n                        openTo=\"year\"\r\n                        format=\"yyyy-MM-dd\"\r\n                        label={t(\"components.criteria.timePeriod.to\")}\r\n                        views={[\"year\", \"month\", \"date\"]}\r\n                        clearable\r\n                        minDate={moment(timePeriod.fromDate)}\r\n                        maxDate={moment(timePeriod.maxDate)}\r\n                        value={moment(timePeriod.toDate)}\r\n                        onChange={date => onSetTimePeriod({\r\n                          ...timePeriod,\r\n                          toDate: date ? moment(date).format(\"YYYY-MM-DD\") : timePeriod.maxDate\r\n                        })}\r\n                        className={classes.timePeriodInput}\r\n                      />\r\n                    </Grid>\r\n                  </MuiPickersUtilsProvider>\r\n                </Grid>\r\n              )\r\n            : (\r\n              <Grid container spacing={2} justify=\"center\">\r\n                <Grid item>\r\n                  <div className={classes.lastPeriodsLabel}>\r\n                    {t(\"components.criteria.timePeriod.selectLastPeriods.selectLast\")}\r\n                  </div>\r\n                </Grid>\r\n                <Grid item>\r\n                  <TextField\r\n                    value={timePeriod.periods || \"\"}\r\n                    placeholder={t(\"components.criteria.timePeriod.selectLastPeriods.noPeriodsSelected\")}\r\n                    type=\"number\"\r\n                    variant=\"outlined\"\r\n                    className={classes.lastPeriodsInput}\r\n                    style={{width: 400}}\r\n                    onChange={({target}) => {\r\n                      if (target.value === \"\") {\r\n                        onSetTimePeriod({\r\n                          ...timePeriod,\r\n                          periods: null\r\n                        })\r\n                      } else if (!isNaN(target.value) && Number(target.value) > 0) {\r\n                        onSetTimePeriod({\r\n                          ...timePeriod,\r\n                          periods: Number(target.value)\r\n                        })\r\n                      }\r\n                    }}\r\n                  />\r\n                </Grid>\r\n                <Grid item>\r\n                  <div className={classes.lastPeriodsLabel}>\r\n                    {t(\"components.criteria.timePeriod.selectLastPeriods.periods\")}\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n          }\r\n        </Grid>\r\n      </Grid>\r\n    </Fragment>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(TimePeriod)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Call from \"../../hocs/call\";\r\nimport {\r\n  CRITERIA_SELECTION_MODE_ALL,\r\n  CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n  CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n  fetchDatasetStructureCodelist,\r\n  fetchDatasetStructureCodelists,\r\n  setDatasetStructureCodelistCriteria,\r\n  setDatasetStructureCodelistTimePeriod\r\n} from \"../../state/dataset/datasetActions\";\r\nimport EnhancedTree from \"../enhanced-tree\";\r\nimport _ from \"lodash\"\r\nimport PlaylistAddCheckIcon from \"@material-ui/icons/PlaylistAddCheck\"\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport TimePeriod from \"./TimePeriod\";\r\nimport Typography from '@material-ui/core/Typography';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {TIME_PERIOD_DIMENSION_KEY} from \"../../utils/jsonStat\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {CRITERIA_FILTER_TYPE_CODES, CRITERIA_FILTER_TYPE_STRING} from \"../../utils/criteria\";\r\n\r\nconst CRITERIA_CONTAINER_HEIGHT = 380;\r\nconst CODELIST_INFO_HEIGHT = 40;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  criteriaContainer: {\r\n    width: \"100%\",\r\n    height: CRITERIA_CONTAINER_HEIGHT,\r\n    padding: 8\r\n  },\r\n  codelistInfo: {\r\n    width: \"100%\",\r\n    height: CODELIST_INFO_HEIGHT,\r\n    padding: \"8px 0\"\r\n  },\r\n  codelistContainer: {\r\n    width: \"100%\",\r\n    height: `calc(100% - ${CODELIST_INFO_HEIGHT}px)`,\r\n  },\r\n  emptyContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  timePeriodContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  treeActions: {\r\n    marginBottom: 8\r\n  },\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchCodelist: ({nodeId, datasetId, dimensionId, type, criteria}) => dispatch(fetchDatasetStructureCodelist(nodeId, datasetId, dimensionId, type, criteria)),\r\n  fetchCodelists: ({nodeId, datasetId, type}) => dispatch(fetchDatasetStructureCodelists(nodeId, datasetId, type)),\r\n  onSetCriteria: criteria => dispatch(setDatasetStructureCodelistCriteria(criteria)),\r\n  onSetTimePeriod: timePeriod => dispatch(setDatasetStructureCodelistTimePeriod(timePeriod)),\r\n});\r\n\r\nfunction Criteria(props) {\r\n  const {\r\n    t,\r\n    classes,\r\n    nodeId,\r\n    datasetId,\r\n    dimensions,\r\n    mode,\r\n    type,\r\n    codes,\r\n    isCodesFlat,\r\n    codelists,\r\n    areCodelistsFlat,\r\n    codelistsLength,\r\n    criteria,\r\n    timePeriod,\r\n    fetchCodelist,\r\n    fetchCodelists,\r\n    onSetCriteria,\r\n    onSetTimePeriod,\r\n    isCriteriaValid,\r\n    setCriteriaValidity\r\n  } = props;\r\n\r\n  const [tabId, setTabId] = useState(0);\r\n  const [isCallDisabled, setIsCallDisabled] = useState(false);\r\n\r\n  const [tmpCriteria, setTmpCriteria] = useState(null);\r\n  const [tmpTabId, setTmpTabId] = useState(null);\r\n\r\n  const handleTabChange = tabId => {\r\n\r\n    if (type === CRITERIA_SELECTION_TYPE_DYNAMIC && tabId < (dimensions.length - 1)) {\r\n      const newCriteria = _.cloneDeep(criteria);\r\n\r\n      const criteriaToRemove = dimensions\r\n        .map(({id}) => id)\r\n        .slice(tabId + 1)\r\n        .filter(dim => newCriteria[dim] !== null && newCriteria[dim] !== undefined);\r\n\r\n      if (criteriaToRemove.length > 0) {\r\n        criteriaToRemove.forEach(dim => newCriteria[dim] = undefined);\r\n        setTmpCriteria(newCriteria);\r\n        setTmpTabId(tabId);\r\n\r\n      } else {\r\n        setTabId(tabId);\r\n        setIsCallDisabled(false);\r\n      }\r\n\r\n    } else {\r\n      setTabId(tabId);\r\n      setIsCallDisabled(false);\r\n    }\r\n  };\r\n\r\n  const handleCheck = (checkedKeys, type) => {\r\n    const newCriteria = _.cloneDeep(criteria);\r\n    const dimensionId = dimensions[tabId].id;\r\n\r\n    newCriteria[dimensionId] = (checkedKeys || []).length > 0\r\n      ? {\r\n        id: dimensionId,\r\n        type: (type || CRITERIA_FILTER_TYPE_CODES),\r\n        filterValues: checkedKeys,\r\n        period: null,\r\n        from: null,\r\n        to: null\r\n      }\r\n      : undefined;\r\n\r\n    onSetCriteria(newCriteria);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (dimensions && isCallDisabled === false) {\r\n      setIsCallDisabled(true)\r\n    }\r\n  }, [dimensions, isCallDisabled]);\r\n\r\n  const checkedKeys = (criteria[dimensions[tabId].id]?.filterValues || []);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {dimensions && (\r\n        <Fragment>\r\n          <AppBar position=\"static\" color=\"default\">\r\n            <Tabs\r\n              value={tabId}\r\n              variant=\"scrollable\"\r\n              scrollButtons=\"auto\"\r\n              indicatorColor=\"primary\"\r\n              textColor=\"primary\"\r\n              onChange={(event, newValue) => handleTabChange(newValue)}\r\n            >\r\n              {(dimensions || []).map((dim, idx) => (\r\n                <Tab\r\n                  key={idx}\r\n                  label={\r\n                    <Tooltip title={dim.label || \"\"}>\r\n                      <span>\r\n                        {dim.id + (\r\n                          codelistsLength[idx]\r\n                            ? ` (${(criteria[dim.id]?.filterValues || []).length}/${codelistsLength[idx]})`\r\n                            : ''\r\n                        )}\r\n                      </span>\r\n                    </Tooltip>\r\n                  }\r\n                  disabled={!isCriteriaValid}\r\n                />\r\n              ))}\r\n            </Tabs>\r\n          </AppBar>\r\n          <div key={tabId} className={classes.criteriaContainer}>\r\n            <Call\r\n              cb={mode === CRITERIA_SELECTION_MODE_STEP_BY_STEP\r\n                ? fetchCodelist\r\n                : fetchCodelists\r\n              }\r\n              cbParam={{\r\n                nodeId,\r\n                datasetId,\r\n                dimensionId: dimensions[tabId].id,\r\n                mode,\r\n                type,\r\n                criteria\r\n              }}\r\n              disabled={!nodeId || !datasetId || !dimensions || (mode === CRITERIA_SELECTION_MODE_ALL && !!codelists) || isCallDisabled}\r\n            >\r\n              {(() => {\r\n                const data = mode === CRITERIA_SELECTION_MODE_STEP_BY_STEP\r\n                  ? codes\r\n                  : codelists?.[tabId];\r\n\r\n                const isCheckDisabled = ((data || []).length === 1 && (data[0].children || []).length === 0);\r\n\r\n                if (!data) {\r\n                  return (\r\n                    <div className={classes.emptyContainer}>\r\n                      <CustomEmpty/>\r\n                    </div>\r\n                  )\r\n\r\n                } else if (dimensions[tabId].id === TIME_PERIOD_DIMENSION_KEY) {\r\n                  return (\r\n                    <div className={classes.timePeriodContainer}>\r\n                      <TimePeriod\r\n                        timePeriod={timePeriod}\r\n                        onSetTimePeriod={onSetTimePeriod}\r\n                        isCriteriaValid={isCriteriaValid}\r\n                        setCriteriaValidity={setCriteriaValidity}\r\n                      />\r\n                    </div>\r\n                  )\r\n\r\n                } else {\r\n                  return (\r\n                    <Fragment>\r\n                      <Typography className={classes.codelistInfo}>\r\n                        {`${dimensions[tabId].label || dimensions[tabId].id}${dimensions[tabId]?.extra?.DataStructureRef ? ` (${dimensions[tabId].extra.DataStructureRef})` : \"\"}`}\r\n                      </Typography>\r\n                      <div className={classes.codelistContainer}>\r\n                        {(data.length === 0)\r\n                          ? (\r\n                            <Fragment>\r\n                              <div style={{margin: \"16px 0\"}}>\r\n                                {t(\"components.criteria.noCodelistAssociated.info\")}\r\n                              </div>\r\n                              <TextField\r\n                                value={checkedKeys[0] || \"\"}\r\n                                placeholder={t(\"components.criteria.noCodelistAssociated.noFilter\")}\r\n                                variant=\"outlined\"\r\n                                style={{width: \"100%\"}}\r\n                                onChange={({target}) => handleCheck([target.value], CRITERIA_FILTER_TYPE_STRING)}\r\n                              />\r\n                            </Fragment>\r\n                          )\r\n                          : (isCodesFlat === true || areCodelistsFlat?.[tabId] === true)\r\n                            ? (\r\n                              <InfiniteScrollTable\r\n                                data={data}\r\n                                getRowKey={({id}) => id}\r\n                                columns={[\r\n                                  {\r\n                                    title: t(\"components.criteria.table.columns.name.title\"),\r\n                                    dataIndex: 'name',\r\n                                    render: (_, {id, name}) => `[${id}] ${name}`,\r\n                                    minWidthToContent: true,\r\n                                    noFilter: true\r\n                                  }\r\n                                ]}\r\n                                rowSelection={{\r\n                                  selectedRowKeys: checkedKeys,\r\n                                  onChange: handleCheck,\r\n                                }}\r\n                                isCheckDisabled={isCheckDisabled}\r\n                                height={204}\r\n                              />\r\n                            )\r\n                            : (\r\n                              <EnhancedTree\r\n                                key={tabId}\r\n                                tree={data}\r\n                                getNodeKey={({id}) => id}\r\n                                childrenKey=\"children\"\r\n                                labelKey=\"name\"\r\n                                getNodeLabel={node => `[${node.id}] ${node.name}`}\r\n                                isLabelNotMultilingual\r\n                                checkable\r\n                                withLevelSelector\r\n                                checkedKeys={checkedKeys}\r\n                                getIsCheckable={node => node.isSelectable !== false}\r\n                                // defaultExpandedKeys={criteria[dimensions[tabId].id] || []}\r\n                                onCheck={handleCheck}\r\n                                isCheckDisabled={isCheckDisabled}\r\n                                nodeActions={[\r\n                                  node => (node.children && node.children.length > 0)\r\n                                    ? {\r\n                                      icon: <PlaylistAddCheckIcon/>,\r\n                                      title: t(\"components.criteria.tree.nodeActions.selectAll.title\"),\r\n                                      onClick: node => {\r\n                                        let newCheckedKeys = [...checkedKeys];\r\n                                        const childrenKeys = (node.children || []).filter(({isSelectable}) => isSelectable !== false).map(({id}) => id)\r\n                                        const unselectedChildrenKeys = childrenKeys.filter(key => !newCheckedKeys.includes(key))\r\n\r\n                                        newCheckedKeys = (unselectedChildrenKeys.length > 0)\r\n                                          ? newCheckedKeys.concat(childrenKeys)\r\n                                          : newCheckedKeys.filter(key => !childrenKeys.includes(key));\r\n                                        handleCheck(_.uniq(newCheckedKeys));\r\n                                      }\r\n                                    }\r\n                                    : null\r\n                                ]}\r\n                              />\r\n                            )\r\n                        }\r\n                      </div>\r\n                    </Fragment>\r\n                  )\r\n                }\r\n              })()}\r\n            </Call>\r\n          </div>\r\n\r\n          <Dialog\r\n            open={tmpCriteria !== null}\r\n            fullWidth\r\n            maxWidth=\"sm\"\r\n            onClose={() => setTmpCriteria(null)}\r\n          >\r\n            <DialogContent>\r\n              {t(\"components.criteria.dialogs.warning.losingFilters.title\")}\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button\r\n                onClick={() => {\r\n                  setTmpCriteria(null);\r\n                  setTmpTabId(null);\r\n                }}\r\n              >\r\n                cancel\r\n              </Button>\r\n              <Button\r\n                autoFocus\r\n                onClick={() => {\r\n                  setTmpCriteria(null);\r\n                  onSetCriteria(tmpCriteria);\r\n                  setTmpTabId(null);\r\n                  setTabId(tmpTabId);\r\n                  setIsCallDisabled(false);\r\n                }}\r\n                color=\"primary\"\r\n              >\r\n                ok\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n\r\n        </Fragment>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(null, mapDispatchToProps)\r\n)(Criteria)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport ViewCompactIcon from '@material-ui/icons/ViewCompact';\r\nimport ViewStreamIcon from '@material-ui/icons/ViewStream';\r\nimport ViewColumnIcon from '@material-ui/icons/ViewColumn';\r\nimport JsonStatTable from \"../table\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sectionContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(60% - 8px)\",\r\n    marginRight: 16\r\n  },\r\n  section: {\r\n    height: 216,\r\n    background: \"#eeeeee\"\r\n  },\r\n  sectionHeaderContainer: {\r\n    height: 48,\r\n    padding: \"16px 16px 0\"\r\n  },\r\n  sectionHeaderIcon: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginRight: 8\r\n  },\r\n  sectionHeaderTitle: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    height: 30,\r\n  },\r\n  sectionContentWrapper: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 48px)\",\r\n    padding: 16\r\n  },\r\n  draggingHover: {\r\n    border: \"1px dashed #999999\"\r\n  },\r\n  sectionContent: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\"\r\n  },\r\n  sectionItem: {\r\n    textAlign: \"center\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px\"\r\n  },\r\n  previewContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(40% - 8px)\"\r\n  },\r\n  divider: {\r\n    marginBottom: 16\r\n  }\r\n});\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n  userSelect: 'none',\r\n  height: 32,\r\n  marginBottom: 8,\r\n  ...draggableStyle\r\n});\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const [removed] = list.splice(startIndex, 1);\r\n  list.splice(endIndex, 0, removed);\r\n};\r\n\r\nconst move = (source, destination, droppableSource, droppableDestination) => {\r\n  const [removed] = source.splice(droppableSource.index, 1);\r\n  destination.splice(droppableDestination.index, 0, removed);\r\n};\r\n\r\nconst onDragEnd = (result, dimensions, setDimensions) => {\r\n\r\n  const {\r\n    source,\r\n    destination\r\n  } = result;\r\n\r\n  // dropped outside the list\r\n  if (!destination) {\r\n    return;\r\n  }\r\n\r\n  const newDimensions = JSON.parse(JSON.stringify(dimensions));\r\n\r\n  if (source.droppableId === destination.droppableId) {\r\n    reorder(\r\n      newDimensions[source.droppableId],\r\n      source.index,\r\n      destination.index\r\n    );\r\n\r\n  } else {\r\n    move(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source,\r\n      destination\r\n    );\r\n  }\r\n\r\n  setDimensions(newDimensions);\r\n};\r\n\r\nconst Section = ({\r\n                   classes,\r\n                   id,\r\n                   title,\r\n                   Icon,\r\n                   dimensions,\r\n                   jsonStat\r\n                 }) =>\r\n\r\n  <Card variant=\"outlined\" className={classes.section}>\r\n    <CardHeader\r\n      title={\r\n        <Fragment>\r\n          <div className={classes.sectionHeaderIcon}>{Icon}</div>\r\n          <Typography className={classes.sectionHeaderTitle} variant=\"button\">{title}</Typography>\r\n        </Fragment>\r\n      }\r\n      className={classes.sectionHeaderContainer}\r\n    />\r\n    <Droppable droppableId={id}>\r\n      {(provided, snapshot) => (\r\n        <div className={`${classes.sectionContentWrapper} ${snapshot.isDraggingOver ? classes.draggingHover : \"\"}`}>\r\n          <div ref={provided.innerRef} className={classes.sectionContent}>\r\n            {dimensions.map((item, idx) =>\r\n              <Draggable\r\n                key={idx}\r\n                index={idx}\r\n                draggableId={`${id}-${idx}`}\r\n              >\r\n                {(provided, snapshot) => (\r\n                  <div\r\n                    ref={provided.innerRef}\r\n                    {...provided.draggableProps}\r\n                    {...provided.dragHandleProps}\r\n                    style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\r\n                  >\r\n                    <Tooltip title={jsonStat.dimension[item].label}>\r\n                      <Paper className={classes.sectionItem}>\r\n                        {`${item} (${jsonStat.size[jsonStat.id.indexOf(item)]})`}\r\n                      </Paper>\r\n                    </Tooltip>\r\n                  </div>\r\n                )}\r\n              </Draggable>\r\n            )}\r\n            {provided.placeholder}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  </Card>;\r\n\r\nconst TableLayout = ({\r\n                       t,\r\n                       classes,\r\n                       jsonStat,\r\n                       layout,\r\n                       labelFormat,\r\n                       setLayout\r\n                     }) => {\r\n  const {\r\n    filters,\r\n    sections,\r\n    rows,\r\n    cols,\r\n  } = layout;\r\n\r\n  let colCount = 1;\r\n  cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  let rowCount = 1;\r\n  rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n  sections.forEach(section => rowCount *= jsonStat.size[jsonStat.id.indexOf(section)]);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider className={classes.divider}/>\r\n      <div className={classes.sectionContainer}>\r\n        <DragDropContext onDragEnd={result => onDragEnd(result, layout, setLayout)}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"filters\"\r\n                title={t(\"components.tableLayout.sections.filters\")}\r\n                Icon={<FilterListIcon/>}\r\n                dimensions={filters}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"sections\"\r\n                title={t(\"components.tableLayout.sections.sections\")}\r\n                Icon={<ViewCompactIcon/>}\r\n                dimensions={sections}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"rows\"\r\n                title={t(\"components.tableLayout.sections.rows\")}\r\n                Icon={<ViewStreamIcon/>}\r\n                dimensions={rows}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"cols\"\r\n                title={t(\"components.tableLayout.sections.columns\")}\r\n                Icon={<ViewColumnIcon/>}\r\n                dimensions={cols}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n        </DragDropContext>\r\n      </div>\r\n      <div className={`${classes.previewContainer}`}>\r\n        <JsonStatTable\r\n          jsonStat={jsonStat}\r\n          layout={layout}\r\n          labelFormat={labelFormat}\r\n          isPreview={true}\r\n        />\r\n        <Grid container spacing={1} style={{marginTop: 16}}>\r\n          <Grid item xs={12} style={{textAlign: \"end\"}}>\r\n            {t(\"components.tableLayout.rowCount\", {rowCount})}\r\n          </Grid>\r\n          <Grid item xs={12} style={{textAlign: \"end\"}}>\r\n            {t(\"components.tableLayout.colCount\", {colCount})}\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(TableLayout)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\n\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_SM = \"sm\";\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_MD = \"md\";\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_LG = \"lg\";\r\n\r\nconst styles = theme => ({\r\n  fontSizeIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontWeight: \"bold\",\r\n    display: \"table\"\r\n  },\r\n  fontSizeIconSm: {\r\n    fontSize: 14\r\n  },\r\n  fontSizeIconMd: {\r\n    fontSize: 16\r\n  },\r\n  fontSizeIconLg: {\r\n    fontSize: 20\r\n  },\r\n  fontSizeSelected: {\r\n    \"& div\": {\r\n      boxShadow: \"inset 0 -2px 0 0 rgba(0, 0, 0, .54)\"\r\n    }\r\n  }\r\n});\r\n\r\nconst getFontSizeIcon = styleClasses =>\r\n  <div className={styleClasses}>\r\n    <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n      A\r\n    </div>\r\n  </div>;\r\n\r\nconst FontSizeSelector = ({\r\n  t,\r\n                            classes,\r\n                            fontSize,\r\n                            setFontSize\r\n                          }) =>\r\n\r\n  <Fragment>\r\n    <Tooltip title={t(\"components.fontSizeSelector.small.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_SM ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_SM)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconSm}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n    <Tooltip title={t(\"components.fontSizeSelector.normal.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_MD ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_MD)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconMd}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n    <Tooltip title={t(\"components.fontSizeSelector.big.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_LG ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_LG)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconLg}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n  </Fragment>;\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(FontSizeSelector)","import React from 'react';\r\nimport SvgIcon from \"@material-ui/core/SvgIcon\";\r\n\r\nconst AreaIcon = ({props}) =>\r\n  <SvgIcon {...props}>\r\n    <path\r\n      d=\"M 2.00,20.00\r\n        C 2.00,20.00 22.00,20.00 22.00,20.00\r\n         22.00,20.00 22.00,4.08 22.00,4.08\r\n         21.58,4.28 20.69,5.19 20.32,5.56\r\n         20.32,5.56 18.08,7.69 18.08,7.69\r\n         17.82,7.95 16.82,8.94 16.56,9.04\r\n         16.40,9.10 16.17,9.09 16.00,9.09\r\n         16.00,9.09 13.60,9.09 13.60,9.09\r\n         12.89,9.10 12.65,9.63 12.24,10.15\r\n         12.24,10.15 10.54,12.29 10.54,12.29\r\n         9.99,12.99 9.88,13.43 8.96,13.44\r\n         8.96,13.44 6.80,13.44 6.80,13.44\r\n         6.64,13.44 6.39,13.43 6.24,13.48\r\n         5.89,13.62 5.26,14.58 5.01,14.91\r\n         5.01,14.91 2.85,17.70 2.85,17.70\r\n         2.41,18.27 2.00,18.60 2.00,19.34\r\n         2.00,19.34 2.00,20.00 2.00,20.00 Z\"\r\n    />\r\n  </SvgIcon>\r\n\r\nexport default AreaIcon;","import React from 'react';\r\nimport SvgIcon from \"@material-ui/core/SvgIcon\";\r\n\r\nconst RadarIcon = ({props}) =>\r\n  <SvgIcon {...props}>\r\n    <path\r\n      d=\"M 5.45,2.06\r\n        C 4.05,2.59 4.72,4.26 5.94,3.93\r\n         7.01,3.64 6.79,1.93 5.45,2.06 Z\r\n        M 6.63,3.58\r\n        C 6.15,4.17 5.87,4.17 5.15,4.17\r\n         5.15,4.17 3.38,9.39 3.38,9.39\r\n         4.30,9.96 4.21,10.35 3.97,11.26\r\n         3.97,11.26 8.60,13.82 8.60,13.82\r\n         8.86,13.51 9.06,13.31 9.49,13.25\r\n         10.18,13.17 10.85,13.82 10.74,14.51\r\n         10.67,15.02 10.26,15.18 10.30,15.60\r\n         10.33,15.84 10.80,16.61 10.94,16.88\r\n         10.94,16.88 12.64,19.93 12.64,19.93\r\n         13.46,19.75 13.75,19.67 14.32,20.42\r\n         14.32,20.42 18.75,17.86 18.75,17.86\r\n         18.75,17.86 18.57,17.17 18.57,17.17\r\n         18.46,16.16 19.27,15.82 20.13,15.89\r\n         20.13,15.89 21.01,11.85 21.01,11.85\r\n         19.99,11.66 19.57,10.89 20.13,9.98\r\n         19.75,9.53 18.96,9.04 18.45,8.70\r\n         18.27,8.57 17.87,8.28 17.67,8.24\r\n         17.39,8.19 17.18,8.37 16.88,8.42\r\n         16.34,8.49 16.01,8.19 15.69,7.81\r\n         15.08,8.14 14.97,8.41 14.51,8.90\r\n         14.37,9.04 14.10,9.29 14.05,9.49\r\n         13.96,9.83 14.32,10.00 14.39,10.47\r\n         14.48,11.07 13.93,11.74 13.33,11.78\r\n         13.33,11.78 12.44,11.66 12.44,11.66\r\n         12.02,10.78 11.80,10.17 12.84,9.59\r\n         12.48,9.10 11.99,8.73 11.56,8.31\r\n         11.56,8.31 8.80,5.55 8.80,5.55\r\n         8.25,5.00 7.28,3.88 6.63,3.58 Z\r\n        M 16.29,6.42\r\n        C 15.36,6.97 15.73,8.11 16.58,8.26\r\n         17.81,8.47 18.20,6.50 16.88,6.35\r\n         16.64,6.32 16.51,6.36 16.29,6.42 Z\r\n        M 2.69,9.56\r\n        C 2.37,9.73 2.14,9.90 2.04,10.28\r\n         1.85,11.05 2.66,11.67 3.38,11.39\r\n         4.35,11.00 4.12,9.25 2.69,9.56 Z\r\n        M 12.84,9.78\r\n        C 11.96,10.27 12.11,11.45 13.13,11.61\r\n         14.19,11.78 14.63,10.28 13.72,9.78\r\n         13.43,9.65 13.14,9.68 12.84,9.78 Z\r\n        M 20.72,9.75\r\n        C 19.47,10.30 20.12,11.94 21.31,11.61\r\n         22.01,11.42 22.20,10.54 21.74,10.02\r\n         21.45,9.70 21.11,9.68 20.72,9.75 Z\r\n        M 9.20,13.50\r\n        C 8.00,14.19 8.89,15.72 9.98,15.29\r\n         10.69,15.00 10.72,14.08 10.25,13.67\r\n         9.94,13.39 9.58,13.41 9.20,13.50 Z\r\n        M 19.44,16.06\r\n        C 18.03,16.65 18.89,18.33 20.03,17.90\r\n         21.09,17.51 20.76,15.85 19.44,16.06 Z\r\n        M 13.04,20.00\r\n        C 11.75,20.55 12.43,22.19 13.62,21.86\r\n         14.67,21.57 14.48,19.76 13.04,20.00 Z\"\r\n    />\r\n  </SvgIcon>\r\n\r\nexport default RadarIcon;","import React from 'react';\r\nimport SvgIcon from \"@material-ui/core/SvgIcon\";\r\n\r\nconst PolarIcon = ({props}) =>\r\n  <SvgIcon {...props}>\r\n    <path\r\n      d=\"M 6.86,2.40\r\n        C 6.86,2.40 7.42,4.56 7.42,4.56\r\n         7.42,4.56 8.60,9.12 8.60,9.12\r\n         8.60,9.12 9.80,13.76 9.80,13.76\r\n         10.70,13.13 12.27,11.48 13.14,10.64\r\n         13.14,10.64 13.96,9.92 13.96,9.92\r\n         13.96,9.92 16.33,7.60 16.33,7.60\r\n         16.33,7.60 18.45,5.60 18.45,5.60\r\n         17.96,4.94 16.81,4.14 16.08,3.71\r\n         14.05,2.52 11.91,1.99 9.55,2.00\r\n         8.86,2.00 7.50,2.17 6.86,2.40 Z\r\n        M 10.12,14.00\r\n        C 10.12,14.00 13.88,15.05 13.88,15.05\r\n         13.88,15.05 19.59,16.64 19.59,16.64\r\n         20.29,14.27 19.97,11.34 18.69,9.20\r\n         18.40,8.71 18.05,8.19 17.68,7.76\r\n         17.55,7.62 17.35,7.38 17.14,7.38\r\n         16.94,7.38 16.71,7.63 16.57,7.76\r\n         16.57,7.76 15.27,8.96 15.27,8.96\r\n         15.27,8.96 11.76,12.32 11.76,12.32\r\n         11.29,12.77 10.48,13.51 10.12,14.00 Z\r\n        M 5.22,12.64\r\n        C 5.22,12.64 9.47,13.84 9.47,13.84\r\n         9.47,13.84 8.72,10.72 8.72,10.72\r\n         8.67,10.50 8.54,9.80 8.36,9.69\r\n         8.13,9.55 7.49,9.90 7.27,10.02\r\n         6.29,10.55 5.43,11.54 5.22,12.64 Z\r\n        M 4.24,12.72\r\n        C 3.83,13.96 4.08,15.50 4.67,16.64\r\n         4.81,16.90 5.23,17.65 5.55,17.67\r\n         5.85,17.68 6.41,17.08 6.61,16.88\r\n         6.61,16.88 8.49,15.04 8.49,15.04\r\n         8.80,14.73 9.19,14.47 9.39,14.08\r\n         9.39,14.08 4.24,12.72 4.24,12.72 Z\r\n        M 9.96,14.32\r\n        C 9.96,14.32 10.46,16.24 10.46,16.24\r\n         10.46,16.24 11.34,19.68 11.34,19.68\r\n         11.34,19.68 11.92,22.00 11.92,22.00\r\n         13.94,21.55 15.70,20.27 16.81,18.56\r\n         17.22,17.94 17.65,17.15 17.71,16.40\r\n         17.71,16.40 15.27,15.74 15.27,15.74\r\n         15.27,15.74 12.33,14.93 12.33,14.93\r\n         12.33,14.93 9.96,14.32 9.96,14.32 Z\r\n        M 9.71,14.40\r\n        C 9.21,14.63 8.73,15.21 8.33,15.60\r\n         8.33,15.60 6.20,17.60 6.20,17.60\r\n         6.00,17.80 5.24,18.46 5.24,18.72\r\n         5.24,19.00 5.97,19.45 6.20,19.60\r\n         7.45,20.37 8.43,20.56 9.88,20.56\r\n         10.13,20.56 10.95,20.55 11.10,20.34\r\n         11.24,20.15 10.90,19.07 10.83,18.80\r\n         10.83,18.80 9.71,14.40 9.71,14.40 Z\"\r\n    />\r\n  </SvgIcon>\r\n\r\nexport default PolarIcon;","import React from 'react';\r\nimport SvgIcon from \"@material-ui/core/SvgIcon\";\r\n\r\nconst PyramidIcon = ({props}) =>\r\n  <SvgIcon {...props}>\r\n    <path\r\n      d=\"M 10.25,4.00\r\n        C 10.25,4.00 10.25,6.25 10.25,6.25\r\n         10.25,6.25 11.92,6.25 11.92,6.25\r\n         11.92,6.25 11.92,4.00 11.92,4.00\r\n         11.92,4.00 10.25,4.00 10.25,4.00 Z\r\n        M 12.75,4.00\r\n        C 12.75,4.00 12.75,6.25 12.75,6.25\r\n         12.75,6.25 14.42,6.25 14.42,6.25\r\n         14.42,6.25 14.42,4.00 14.42,4.00\r\n         14.42,4.00 12.75,4.00 12.75,4.00 Z\r\n        M 8.00,7.67\r\n        C 8.00,7.67 8.00,9.92 8.00,9.92\r\n         8.00,9.92 11.92,9.92 11.92,9.92\r\n         11.92,9.92 11.92,7.67 11.92,7.67\r\n         11.92,7.67 8.00,7.67 8.00,7.67 Z\r\n        M 12.75,7.67\r\n        C 12.75,7.67 12.75,9.92 12.75,9.92\r\n         12.75,9.92 17.08,9.92 17.08,9.92\r\n         17.08,9.92 17.08,7.67 17.08,7.67\r\n         17.08,7.67 12.75,7.67 12.75,7.67 Z\r\n        M 8.17,11.42\r\n        C 8.17,11.42 8.17,13.67 8.17,13.67\r\n         8.17,13.67 11.92,13.67 11.92,13.67\r\n         11.92,13.67 11.92,11.42 11.92,11.42\r\n         11.92,11.42 8.17,11.42 8.17,11.42 Z\r\n        M 12.75,11.42\r\n        C 12.75,11.42 12.75,13.67 12.75,13.67\r\n         12.75,13.67 19.58,13.67 19.58,13.67\r\n         19.58,13.67 19.58,11.42 19.58,11.42\r\n         19.58,11.42 12.75,11.42 12.75,11.42 Z\r\n        M 4.33,15.00\r\n        C 4.33,15.00 4.33,17.33 4.33,17.33\r\n         4.33,17.33 11.92,17.33 11.92,17.33\r\n         11.92,17.33 11.92,15.00 11.92,15.00\r\n         11.92,15.00 4.33,15.00 4.33,15.00 Z\r\n        M 12.75,15.00\r\n        C 12.75,15.00 12.75,17.33 12.75,17.33\r\n         12.75,17.33 22.00,17.33 22.00,17.33\r\n         22.00,17.33 22.00,15.00 22.00,15.00\r\n         22.00,15.00 12.75,15.00 12.75,15.00 Z\r\n        M 2.00,18.75\r\n        C 2.00,18.75 2.00,21.00 2.00,21.00\r\n         2.00,21.00 11.92,21.00 11.92,21.00\r\n         11.92,21.00 11.92,18.75 11.92,18.75\r\n         11.92,18.75 2.00,18.75 2.00,18.75 Z\r\n        M 12.75,18.75\r\n        C 12.75,18.75 12.75,21.00 12.75,21.00\r\n         12.75,21.00 21.17,21.00 21.17,21.00\r\n         21.17,21.00 21.17,18.75 21.17,18.75\r\n         21.17,18.75 12.75,18.75 12.75,18.75 Z\"\r\n    />\r\n  </SvgIcon>\r\n\r\nexport default PyramidIcon;","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport ViewCompactIcon from '@material-ui/icons/ViewCompact';\r\nimport ViewStreamIcon from '@material-ui/icons/ViewStream';\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sectionContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(60% - 8px)\",\r\n    marginRight: 16\r\n  },\r\n  section: {\r\n    background: \"#eeeeee\"\r\n  },\r\n  sectionLeft: {\r\n    height: 416\r\n  },\r\n  sectionRight: {\r\n    height: 200\r\n  },\r\n  sectionHeaderContainer: {\r\n    height: 48,\r\n    padding: \"16px 16px 0\"\r\n  },\r\n  sectionHeaderIcon: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginRight: 8\r\n  },\r\n  sectionHeaderTitle: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    height: 30,\r\n  },\r\n  sectionContentWrapper: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 48px)\",\r\n    padding: 16\r\n  },\r\n  draggingHover: {\r\n    border: \"1px dashed #999999\"\r\n  },\r\n  sectionContent: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\"\r\n  },\r\n  sectionItem: {\r\n    textAlign: \"center\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px\"\r\n  },\r\n  divider: {\r\n    marginBottom: 16\r\n  }\r\n});\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n  userSelect: 'none',\r\n  height: 32,\r\n  marginBottom: 8,\r\n  ...draggableStyle\r\n});\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const [removed] = list.splice(startIndex, 1);\r\n  list.splice(endIndex, 0, removed);\r\n};\r\n\r\nconst move = (source, destination, droppableSource, droppableDestination) => {\r\n  const [removed] = source.splice(droppableSource.index, 1);\r\n  destination.splice(droppableDestination.index, 0, removed);\r\n};\r\n\r\nconst swap = (sourceArr, destinationArr, droppableSource) => {\r\n  const [removedSrc] = sourceArr.splice(droppableSource.index, 1);\r\n  const [removedDst] = destinationArr.splice(0, 1, removedSrc);\r\n  sourceArr.splice(sourceArr.length, 0, removedDst);\r\n};\r\n\r\nconst onDragEnd = (result, dimensions, setDimensions) => {\r\n\r\n  const {\r\n    source,\r\n    destination\r\n  } = result;\r\n\r\n  // dropped outside the list\r\n  if (!destination) {\r\n    return;\r\n  }\r\n\r\n  const newDimensions = JSON.parse(JSON.stringify(dimensions));\r\n\r\n  if (source.droppableId === destination.droppableId) {\r\n    reorder(\r\n      newDimensions[source.droppableId],\r\n      source.index,\r\n      destination.index\r\n    );\r\n\r\n  } else if (\r\n    (source.droppableId === \"secondaryDim\" && destination.droppableId === \"filters\") ||\r\n    (source.droppableId === \"filters\" && destination.droppableId === \"secondaryDim\" && newDimensions[destination.droppableId].length === 0)\r\n  ) {\r\n    move(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source,\r\n      destination\r\n    );\r\n\r\n  } else {\r\n    swap(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source\r\n    );\r\n  }\r\n\r\n  setDimensions(newDimensions);\r\n};\r\n\r\nconst Section = ({\r\n                   classes,\r\n                   sectionClasses,\r\n                   id,\r\n                   title,\r\n                   Icon,\r\n                   dimensions,\r\n                   jsonStat\r\n                 }) =>\r\n\r\n  <Card variant=\"outlined\" className={`${classes.section} ${sectionClasses}`}>\r\n    <CardHeader\r\n      title={\r\n        <Fragment>\r\n          <div className={classes.sectionHeaderIcon}>{Icon}</div>\r\n          <Typography className={classes.sectionHeaderTitle} variant=\"button\">{title}</Typography>\r\n        </Fragment>\r\n      }\r\n      className={classes.sectionHeaderContainer}\r\n    />\r\n    <Droppable droppableId={id}>\r\n      {(provided, snapshot) => (\r\n        <div className={`${classes.sectionContentWrapper} ${snapshot.isDraggingOver ? classes.draggingHover : \"\"}`}>\r\n          <div ref={provided.innerRef} className={classes.sectionContent}>\r\n            {dimensions.map((item, idx) =>\r\n              <Draggable\r\n                key={idx}\r\n                index={idx}\r\n                draggableId={`${id}-${idx}`}\r\n                isDragDisabled={id === \"primaryDim\"}\r\n              >\r\n                {(provided, snapshot) => (\r\n                  <div\r\n                    ref={provided.innerRef}\r\n                    {...provided.draggableProps}\r\n                    {...provided.dragHandleProps}\r\n                    style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\r\n                  >\r\n                    <Paper\r\n                      className={classes.sectionItem}\r\n                    >\r\n                      {`${item} (${jsonStat.size[jsonStat.id.indexOf(item)]})`}\r\n                    </Paper>\r\n                  </div>\r\n                )}\r\n              </Draggable>\r\n            )}\r\n            {provided.placeholder}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  </Card>;\r\n\r\nconst ChartLayout = ({\r\n                       t,\r\n                       classes,\r\n                       jsonStat,\r\n                       layout,\r\n                       setLayout\r\n                     }) => {\r\n\r\n  const {\r\n    primaryDim,\r\n    secondaryDim,\r\n    filters\r\n  } = layout;\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider className={classes.divider}/>\r\n      <div className={classes.sectionContainer}>\r\n        <DragDropContext onDragEnd={result => onDragEnd(result, layout, setLayout)}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                sectionClasses={classes.sectionLeft}\r\n                id=\"filters\"\r\n                title={t(\"components.chartLayout.filters.title\")}\r\n                Icon={<FilterListIcon/>}\r\n                dimensions={filters}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Grid item xs={12} style={{paddingBottom: 8}}>\r\n                <Section\r\n                  classes={classes}\r\n                  sectionClasses={classes.sectionRight}\r\n                  id=\"primaryDim\"\r\n                  title={t(\"components.chartLayout.primaryDim.title\")}\r\n                  Icon={<ViewCompactIcon/>}\r\n                  dimensions={primaryDim}\r\n                  jsonStat={jsonStat}\r\n                />\r\n              </Grid>\r\n              <Grid item xs={12} style={{paddingTop: 8}}>\r\n                <Section\r\n                  classes={classes}\r\n                  sectionClasses={classes.sectionRight}\r\n                  id=\"secondaryDim\"\r\n                  title={t(\"components.chartLayout.secondaryDim.title\")}\r\n                  Icon={<ViewStreamIcon/>}\r\n                  dimensions={secondaryDim}\r\n                  jsonStat={jsonStat}\r\n                />\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        </DragDropContext>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ChartLayout)","import React, {useEffect, useState} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport \"./style.css\";\r\nimport {numberFormatter} from \"../../utils/formatters\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport Call from \"../../hocs/call/index\";\r\nimport {getDataIdxFromCoordinatesArray, getDimensionValuesIndexesMap} from \"../../utils/jsonStat\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  markSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\nfunction Map(props) {\r\n  const {\r\n    mapId = `map__${uuidv4()}`,\r\n    jsonStat,\r\n    layout,\r\n    onGeometryFetch,\r\n    geometries,\r\n    geometryDetailLevels,\r\n    hideSpinner,\r\n    isFullscreen,\r\n    addSpinner,\r\n    markSpinner,\r\n    detailLevel,\r\n    setDetailLevel,\r\n    isGeometryData = false\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [internalDetailLevel, setInternalDetailLevel] = useState(-1);\r\n\r\n  const [filteredGeometries, setFilteredGeometries] = useState(null);\r\n\r\n  const [spinnerUuid] = useState(uuidv4());\r\n\r\n  useEffect(() => {\r\n    window.dispatchEvent(new Event('resize'));\r\n  }, [isFullscreen]);\r\n\r\n  // select default detail level\r\n  useEffect(() => {\r\n    if (!geometryDetailLevels) {\r\n      return;\r\n    }\r\n\r\n    if (detailLevel && geometryDetailLevels.map(({level}) => level).includes(detailLevel)) {\r\n      setInternalDetailLevel(detailLevel);\r\n\r\n    } else {\r\n      if (geometryDetailLevels && geometryDetailLevels?.length > 0) {\r\n        const firstNotEmptyLevelIndex = geometryDetailLevels.findIndex(el => el);\r\n        setInternalDetailLevel(geometryDetailLevels[firstNotEmptyLevelIndex].level);\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      window.LMap.destroyMap(mapId)\r\n    }\r\n  }, [mapId, detailLevel, geometryDetailLevels]);\r\n\r\n  // init the map with filtered geometries\r\n  useEffect(() => {\r\n    if (!filteredGeometries || filteredGeometries.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const mapTranslations = {\r\n      configure: t(\"components.map.translation.configure\"),\r\n      opacity: t(\"components.map.translation.opacity\"),\r\n      from: t(\"components.map.translation.from\"),\r\n      to: t(\"components.map.translation.to\"),\r\n      cancel: t(\"components.map.translation.cancel\"),\r\n      apply: t(\"components.map.translation.apply\"),\r\n      classification: t(\"components.map.translation.classification\"),\r\n      equalInterval: t(\"components.map.translation.equalInterval\"),\r\n      naturalBreaks: t(\"components.map.translation.naturalBreaks\"),\r\n      quantile: t(\"components.map.translation.quantile\"),\r\n      numberOfClasses: t(\"components.map.translation.numberOfClasses\"),\r\n      startColor: t(\"components.map.translation.startColor\"),\r\n      endColor: t(\"components.map.translation.endColor\"),\r\n      preview: t(\"components.map.translation.preview\")\r\n    };\r\n\r\n    if (!hideSpinner) {\r\n      addSpinner(spinnerUuid, t(\"components.map.spinners.rendering\"));\r\n    }\r\n\r\n    const layerOptions = {\r\n      srid: \"EPSG:4326\",\r\n      legendSettings: {\r\n        paletteStartColor: \"#eff3ff\",\r\n        paletteEndColor: \"#2171b5\",\r\n        paletteCardinality: 9,\r\n        pointStartRadius: 1,\r\n        pointEndRadius: 9,\r\n        pointRadiusCardinality: 9,\r\n        opacity: 0.9,\r\n        classificationMethod: \"quantile\"\r\n      },\r\n      onDataRender: function () {\r\n        markSpinner(spinnerUuid);\r\n      },\r\n      borderColor: [128, 128, 128, 0.5],\r\n      valueFormatter: numberFormatter,\r\n      centerMarker:\r\n        isGeometryData\r\n          ? \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAABIAAAASABGyWs+AAAAB3RJTUUH5AEUBxoBYX/GhAAABKtJREFUWMPNlktslFUUx3/n+76ZKaXQYpkCBQr4JMZHfKOEBFdoIxFiWBgDWB+4cVHYkLDQDUYjgQIrA4iv4KIYQgmQslCjkIhEEoKAgYaIQsqMA50pM31M57v3uCiFduab6Uzd+F+e+7/n/O855557YQKYsfgN6juVhve+kWjrYXlg9mpqvro0EVdIOaTo+qOINaJuaDoijwGPgszD+nVuOi5YPwVyBeF3kLO43g2s1dielv8moGH9UdQNgzVzENaCrAIeBCYBYH3cdBysP7JlALgE8h0iX2L9a3gRYrvfrFxAdEMnNlKLM3TrRZBPgacK+IUCRqDAaUQ2+qnYD17dLGKfv12+gGjrYfAioHYpyBfA/MDd1sdJx5FCASP4C5EW1P6oboT47rUFBCdwmxMCaxtBPgkKbqxiFVxHcB3BqmJVgzzNQ/VjxG0UmwsM5eYbGlqPgBsCdB1Iy+gs6W3FTzbV6juL57JmUSPPzfJYUF/FQM7SkxkSLUzrbOA61v+l5tlVZE4fHLPoFRTPccH6tYizMj942BXWLWnS95fOl/qaMLlcjr+rMzw/v4bmRxpo/61bD5yJiW/GZENAV+KF92D83vFLIALIAmDhGGEKrz/TqBuX3S/1NeGCctxT7dHywlxZ9nBUA6qxELULho8xbg8ICE3A1BGLVZhTF9F3lzRRFQpuG6sQ8Rxee2Im0Slh8kRMBZrQsgQASt3o8lhVHp8zlXunTy45N6wqs+uq5KEZNZrXlB5QF7THoUzMrI0QcscfnJ4r1NeEynVbRIDQC5jRpkzWEHzT8pKnMDBk8s0G6A3iBwhQUK4DfXf0CJzvTnMjky0pQQRS/TkuJ/qHe/ku+oDr+cZgAaqAXgW6R0yuCBfjfXLobLzk6QXhp64evXJzQJyxwbpBrgYN3kABYnNx4ORoc84o27+/Quf5xJhrJiI4Muz6xOWkfnuqW4zNT5T8iheOI4XhCibhlKdXoKHJCiogK7h9G0QgPejLz109kurPae2kEKJWYomb/Jno0wNn4nx98pr09OVwxh50EJGPMP4fVNeROdWel7UARDd0AkxDnA5gSX6FFGVadYjpkxw1vTGS6X5JD5o7fZCH44jzKpAMehE9gmBy4FUlwe4FWQTcuVciw7VODfgkM7646X7EmqDAADlE9qImqV4kkBB4DRM7loMaUO0AjgdxBHAEHJFiwQFOgHQgLvFdawMJRQeRWB/ESYLuADJUjgwi21GbxA0XJRUV8M/2V0AtqD0GtFMxpB1xjiEOsV2rKxcwvGhBnCyqW4GuCqJ3IWxFbdYLlR7LJQXEtzWDNeCGLqC6BciWETyLyBYxuQsqLtc+WzNxAQCJtmYwQ4DuA/aPH1/2I84+dcPEy/iWl/camhyI9KO6GThXgnkOkc2o7dcSjVexgMSO5WAtOM5F0A+AVAAthciHWHMRxyVeovEqzwCQaHsZrEGsOQS6k7HPtQHZieN14HrEdo+f+ooFACS2vYSKa1BtAw6OWjqISBvWmNietypxWWQUl4BgUHFTwCZRve/2GNwEmnK98n9Cd/1NAA2tR5DBXjQ8eZFkM2i4+qSTvUWsyLj9X+NfjIrf5xSToJ0AAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDEtMjBUMDc6MjY6MDEtMDU6MDBgs6EoAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTAxLTIwVDA3OjI2OjAxLTA1OjAwEe4ZlAAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay1ydlN6UjFMS4iPJtsAAAAASUVORK5CYII=\"\r\n          : undefined,\r\n      centerMarkerText: isGeometryData ? \"test\" : undefined,\r\n      selectedCenterMarker:\r\n        isGeometryData\r\n          ? \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADIklEQVR4AbXXA3hrWRQF4Ixt27Zt27atcGzbto3YeUZt2zbiNau+PVVO0uzv+9+r97o4UsVT6z7iUa1D66s9q26pc6+6td6lGpK0OuMF05BVaEs6jR6h949/1vzzdjrHz1tonJ+Qgc6hbbbUulbZUuuct8ZDdqCnKJsGCISTnjODAcCmY/yUTy/SzpurnSoGSbj5KZRGUYKSGECQTWdvrXcLIeSbVxIIkgFAdXQWDYWQDrAdrSCITnveiNPp1Bcs2NHgxKZqBzZ9ZMYg6bQjSV+9Tmx8Op1J93+1GD8vKcXiwkZYc5rwtqscZ7yzHFuy4ebTh3hi5H1wxRxgI1oqNj/nZQs+dxegsy8AsVp7/HjGWIRt9a7pQqTwEWxKMQc4mNonBXjehHctOQiEwpipBoNhqH/Pw2Zqhxigk46gmANcSMGJ5kZc+54LVS09mKsKG3tw4PMLGWJSgDBdIRPgZsKYU58z4pnfUxGKRDFXBcMR3PBVBjaZ+lLellCA9625iLV0f+YnHOBiCikDvPZvJqJRzFlR/tA9P+WIASJ0lUyAo6hbOe7v/GwhOvr8mKuau/048Y2l4ovYS8fLBNiGCgljznrJjH9TKjFXfbGoClvrXOLtL6MdZAKsSt8SlCPh6ndcWFbcNO2jiPCL1txm7P/sAnEEgH7iJLS6zDww9h74xSn4srcc+NJTgKL6TrT3+tHMCSi9uhPPmYqx11O+6eaAwNjz30rnkpqON6FFBGFCIiMuecOOGz704YTXFmO3J7zDjTcXr5xoOW1Oca2GNyknJNEJz5qwjVZoPFmY7qS4l+RNyJvAcrxEuPq47sJF1BtHgH66nMRVUDrEWvR1HAF+5G1fh+ZlT7gflUoEqKSDxKtPNMRd5I8hQJDu21ztEF+8hEOsSz/EEOB3Nt5A4sWTugt7Ud4sAYpof+Wkk4wQl1LXNAF66Gr5s4B8iNXoeQorAkTpVTZeXbz1yQqxMXfHfykCmGiz5DYXHsXZL5r2POFZc9b2ekfeZhrnvmye3AOqGGIXg1115NOWY3c12E/kIVV87smvTTRu1ca0yah4638QYUyY6yhczwAAAABJRU5ErkJggg==\"\r\n          : undefined\r\n    };\r\n\r\n    const mapOptions = {\r\n      baseMap: \"osm\",\r\n      baseMapToGray: true,\r\n      onLoadingStart: function () {\r\n        console.log(\"Map creation - start\");\r\n      },\r\n      onLoadingFinish: function () {\r\n        console.log(\"Map creation - done\");\r\n      },\r\n      legendFontFamily: \"Roboto\"\r\n    };\r\n\r\n    window.LMap.initMap(mapId, mapOptions, mapTranslations);\r\n    window.LMap.addLayer(mapId, filteredGeometries, \"Dataset\", layerOptions);\r\n\r\n    return () => {\r\n      window.LMap.destroyMap(mapId)\r\n    }\r\n  }, [mapId, filteredGeometries, isGeometryData, spinnerUuid, hideSpinner, addSpinner, markSpinner, t]);\r\n\r\n  // check for missing geometry ids\r\n  useEffect(() => {\r\n    if (!geometries) {\r\n      return;\r\n    }\r\n\r\n    const geometryMap = {};\r\n    geometries.forEach(g => geometryMap[g.id] = g);\r\n\r\n    const missingGeometryList = [];\r\n    jsonStat.dimension[layout.territoryDim].category.index.forEach(geomId => {\r\n      if (!geometryMap[geomId]) {\r\n        const missingEntry = {id: geomId, label: jsonStat.dimension[layout.territoryDim].category.label[geomId]};\r\n        missingGeometryList.push(missingEntry);\r\n      }\r\n    });\r\n    console.log(\"missing ids\", missingGeometryList);\r\n  }, [jsonStat, geometries, layout.territoryDim])\r\n\r\n  useEffect(() => {\r\n    if (!geometries || !internalDetailLevel < 0) {\r\n      return;\r\n    }\r\n\r\n    const geometryMap = {};\r\n    geometries.forEach(g => geometryMap[g.id] = g);\r\n\r\n    const territoryDimName = layout?.territoryDim;\r\n    const dimensionFilterValues = jsonStat.dimension[territoryDimName].category.index;\r\n    const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n    const data = [];\r\n    let levelsCounter = {};\r\n    dimensionFilterValues.forEach(territoryDim => {\r\n      const dimValueArray = jsonStat.id.map(dim => {\r\n        if (dim === territoryDimName) {\r\n          return territoryDim;\r\n        } else {\r\n          return layout.filtersValue[dim];\r\n        }\r\n      });\r\n      const valueIdx = getDataIdxFromCoordinatesArray(\r\n        dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n        jsonStat.size\r\n      );\r\n      const valueId = jsonStat.value[valueIdx];\r\n      const geom = geometryMap[territoryDim];\r\n\r\n      if (valueId !== null && valueId !== undefined && geom && geom.nutsLevel === +internalDetailLevel) {\r\n        data.push({\r\n          \"value\": valueId,\r\n          \"identifier\": geom.uniqueId,\r\n          \"geometry\": geom.wkt,\r\n          \"label\": jsonStat.dimension[territoryDimName].category.label[territoryDim]\r\n        });\r\n      }\r\n      if (valueId && geom?.nutsLevel >= 0) {\r\n        if (!levelsCounter[geom.nutsLevel]) {\r\n          levelsCounter[geom.nutsLevel] = 0;\r\n        }\r\n        levelsCounter[geom.nutsLevel]++;\r\n      }\r\n    });\r\n\r\n    /*\r\n    // set the first not empty level\r\n    if(data.length === 0){\r\n      const firstNotEmpty = Object.entries(levelsCounter).filter((entry) => {return entry[1] > 1;});\r\n      if(firstNotEmpty?.length > 0){\r\n        setInternalDetailLevel(firstNotEmpty[0][0]);\r\n        return;\r\n      }\r\n    }\r\n    */\r\n\r\n    setFilteredGeometries(data);\r\n  }, [geometries, layout, internalDetailLevel, jsonStat]);\r\n\r\n  return (\r\n    layout?.territoryDim && jsonStat.dimension[layout.territoryDim]\r\n      ? (\r\n        <Call\r\n          cb={onGeometryFetch}\r\n          cbParam={[...jsonStat.dimension[layout.territoryDim].category.index]}\r\n          disabled={geometries !== null && geometries !== undefined && geometryDetailLevels !== null && geometryDetailLevels !== undefined}\r\n        >\r\n          {geometryDetailLevels && geometryDetailLevels.length > 1 && (\r\n            <div style={{float: \"left\", position: \"relative\", zIndex: 1}}>\r\n              <div style={{background: \"rgba(255, 255, 255, 0.7)\", margin: 8, padding: 8}}>\r\n                {(() => {\r\n                  const getTextWidthEl = $('<span>').css({\r\n                    visibility: 'hidden',\r\n                    position: 'absolute',\r\n                    fontSize: 16\r\n                  }).appendTo('body').get(0);\r\n\r\n                  const label = t(\"components.map.detailLevel\");\r\n                  const Component = (\r\n                    <FormControl>\r\n                      <InputLabel>{label}</InputLabel>\r\n                      <Select\r\n                        value={internalDetailLevel}\r\n                        style={{minWidth: (getTextWidth(label, getTextWidthEl) + 16)}}\r\n                        onChange={ev => setDetailLevel\r\n                          ? setDetailLevel(ev.target.value)\r\n                          : setInternalDetailLevel(ev.target.value)\r\n                        }\r\n                      >\r\n                        {geometryDetailLevels.map(val =>\r\n                          <MenuItem value={val.level} key={val.level}>{val.label}</MenuItem>\r\n                        )}\r\n                      </Select>\r\n                    </FormControl>\r\n                  );\r\n\r\n                  $(getTextWidthEl).remove();\r\n\r\n                  return Component\r\n                })()}\r\n              </div>\r\n            </div>\r\n          )}\r\n          {internalDetailLevel > 0 && filteredGeometries && filteredGeometries.length === 0 && (\r\n            <CustomEmpty\r\n              text={\r\n                t(\"components.map.noDataToDisplayFor\") +\r\n                \" \" +\r\n                ((geometryDetailLevels || []).find(lev => lev.level === +internalDetailLevel)?.label || \"\")\r\n              }\r\n            />\r\n          )}\r\n          <div id={mapId} style={{width: \"100%\", height: \"100%\", position: \"relative\", zIndex: 0}}/>\r\n        </Call>\r\n      )\r\n      : <CustomEmpty text={t(\"components.map.noTerritorialDim\")}/>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  connect(null, mapDispatchToProps)\r\n)(Map);\r\n","import React from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"./constants\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    margin: \"0 8px\"\r\n  },\r\n  label: {\r\n    color: \"rgba(0, 0, 0, 0.54)\",\r\n    fontSize: 13,\r\n    height: 40,\r\n    lineHeight: \"40px\",\r\n    marginRight: 8\r\n  },\r\n  formControl: {\r\n    margin: \"8px 0\"\r\n  },\r\n  select: {\r\n    \"& .MuiSelect-root.MuiSelect-select\": {\r\n      padding: \"2px 24px 3px 0\",\r\n      fontSize: 14\r\n    }\r\n  },\r\n  menuItem: {\r\n    fontSize: 14\r\n  }\r\n});\r\n\r\nconst LabelFormatSelector = ({\r\n                               t,\r\n                               classes,\r\n                               labelFormat,\r\n                               setLabelFormat\r\n                             }) =>\r\n  <Grid container className={classes.root}>\r\n    <Grid item className={classes.label}>\r\n      {t(\"components.labelFormatSelector.labelFormat.title\")}:\r\n    </Grid>\r\n    <Grid item>\r\n      <FormControl className={classes.formControl}>\r\n        <Select\r\n          className={classes.select}\r\n          value={(labelFormat || \"\")}\r\n          onChange={(ev) => setLabelFormat(ev.target.value)}\r\n        >\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.name\")}\r\n          </MenuItem>\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.id\")}\r\n          </MenuItem>\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.both\")}\r\n          </MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n    </Grid>\r\n  </Grid>\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(LabelFormatSelector)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {SketchPicker} from 'react-color';\r\nimport _ from \"lodash\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport Selector from \"../selector\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport Divider from \"@material-ui/core/Divider\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    padding: \"8px 8px 0 8px\"\r\n  },\r\n  title: {\r\n    width: \"calc(100% - 96px)\"\r\n  },\r\n  scrollableRows: {\r\n    height: \"calc(100% - 44px)\",\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\"\r\n  },\r\n  rows: {\r\n    marginBottom: 16\r\n  },\r\n  row: {},\r\n  rowDimension: {\r\n    fontSize: 14,\r\n    lineHeight: \"48px\",\r\n    whiteSpace: \"nowrap\",\r\n    overflow: \"hidden\",\r\n    textOverflow: \"ellipsis\"\r\n  },\r\n  item: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(100% - 96px)\"\r\n  },\r\n  itemLabel: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(50% - 8px)\",\r\n    height: 48,\r\n    lineHeight: \"48px\",\r\n    marginRight: 8,\r\n    fontSize: 14,\r\n    whiteSpace: \"nowrap\",\r\n    overflow: \"hidden\",\r\n    textOverflow: \"ellipsis\"\r\n  },\r\n  itemColor: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(50% - 8px)\",\r\n    height: 32,\r\n    marginRight: 8\r\n  },\r\n  rowActions: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: 96\r\n  },\r\n  selector: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst getClearedColors = (colors, jsonStat) => {\r\n  const newColors = {};\r\n\r\n  Object.keys(colors).forEach(dimKey => {\r\n    if (jsonStat.id.includes(dimKey)) {\r\n      Object.keys(colors[dimKey]).forEach(dimValKey => {\r\n        if (jsonStat.dimension[dimKey].category.index.includes(dimValKey)) {\r\n          if (colors[dimKey][dimValKey]) {\r\n            newColors[dimKey] = {...newColors[dimKey]};\r\n            newColors[dimKey][dimValKey] = colors[dimKey][dimValKey]\r\n          }\r\n        }\r\n      });\r\n    }\r\n  });\r\n\r\n  return newColors;\r\n};\r\n\r\nconst Row = ({\r\n               t,\r\n               classes,\r\n               jsonStat,\r\n               dimension,\r\n               items,\r\n               onColorEdit,\r\n               onColorRemove\r\n             }) =>\r\n\r\n  <div className={classes.row}>\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={4}>\r\n        <Tooltip title={jsonStat.dimension[dimension].label || dimension}>\r\n          <div className={classes.rowDimension}>\r\n            {jsonStat.dimension[dimension].label || dimension}\r\n          </div>\r\n        </Tooltip>\r\n      </Grid>\r\n      <Grid item xs={8}>\r\n        {Object.keys(items).map((item, idx) => (\r\n          <Fragment key={idx}>\r\n            <div className={classes.item}>\r\n              <Tooltip title={jsonStat.dimension[dimension].category.label[item] || item}>\r\n                <div className={classes.itemLabel}>\r\n                  {jsonStat.dimension[dimension].category.label[item] || item}\r\n                </div>\r\n              </Tooltip>\r\n              <div\r\n                className={classes.itemColor}\r\n                style={{\r\n                  background: items[item],\r\n                  border: `1px solid ${items[item]}`,\r\n                  borderRadius: \"4px\"\r\n                }}\r\n              />\r\n            </div>\r\n            <div className={classes.rowActions}>\r\n              <Tooltip title={t(\"scenes.dataViewer.chartSettings.colors.row.actions.edit\")}>\r\n                <IconButton onClick={() => onColorEdit(dimension, item, items[item])}>\r\n                  <EditIcon/>\r\n                </IconButton>\r\n              </Tooltip>\r\n              <Tooltip title={t(\"scenes.dataViewer.chartSettings.colors.row.actions.delete\")}>\r\n                <IconButton onClick={() => onColorRemove(dimension, item)}>\r\n                  <DeleteIcon/>\r\n                </IconButton>\r\n              </Tooltip>\r\n            </div>\r\n          </Fragment>\r\n        ))}\r\n      </Grid>\r\n    </Grid>\r\n  </div>;\r\n\r\nconst defaultColor = \"rgba(0, 0, 0, 0.1)\";\r\n\r\nfunction ChartSettingsColors(props) {\r\n  const {\r\n    t,\r\n    classes,\r\n    jsonStat,\r\n    colors: initialColors,\r\n    onColorsSet\r\n  } = props\r\n\r\n  const [colors, setColors] = useState(false);\r\n\r\n  const [isAddColorVisible, setAddColorVisibility] = useState(false);\r\n\r\n  const [newDim, setNewDim] = useState(null);\r\n  const [newDimVal, setNewDimVal] = useState(null);\r\n  const [newColor, setNewColor] = useState(defaultColor);\r\n\r\n  const [data, setData] = useState(null);\r\n  const [isDimension, setIsDimension] = useState(true);\r\n\r\n  const [isColorPickerVisible, setColorPickerVisibility] = useState(false);\r\n\r\n  const [tmpDim, setTmpDim] = useState(null);\r\n  const [tmpDimVal, setTmpDimVal] = useState(null);\r\n  const [tmpColor, setTmpColor] = useState(null);\r\n\r\n  useEffect(() => {\r\n    setColors(getClearedColors(initialColors, jsonStat));\r\n  }, [initialColors, jsonStat]);\r\n\r\n  const handleAddColorClose = () => {\r\n    setAddColorVisibility(false);\r\n\r\n    setNewDim(null);\r\n    setNewDimVal(null);\r\n    setNewColor(defaultColor);\r\n  };\r\n\r\n  const handleAddColorSubmit = () => {\r\n    setAddColorVisibility(false);\r\n\r\n    const newColors = _.cloneDeep(colors);\r\n    newColors[newDim] = {...newColors[newDim]};\r\n    newColors[newDim][newDimVal] = newColor\r\n    onColorsSet(newColors);\r\n\r\n    setNewDim(null);\r\n    setNewDimVal(null);\r\n    setNewColor(defaultColor);\r\n  };\r\n\r\n  const handleColorRemove = (dim, dimVal) => {\r\n    const newColors = _.cloneDeep(colors);\r\n    newColors[dim][dimVal] = undefined;\r\n    onColorsSet(getClearedColors(newColors, jsonStat));\r\n  };\r\n\r\n  const handleColorEdit = (dim, dimVal, color) => {\r\n    setTmpDim(dim);\r\n    setTmpDimVal(dimVal);\r\n    setTmpColor(color);\r\n    setColorPickerVisibility(true);\r\n  };\r\n\r\n  const handleColorPickerClose = () => {\r\n    setTmpDim(null);\r\n    setTmpDimVal(null);\r\n    setTmpColor(null);\r\n    setColorPickerVisibility(false);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.root}>\r\n        <div className={classes.title}>\r\n          <Grid item xs={12}>\r\n            <Grid container spacing={3} style={{margin: 0}}>\r\n              <Grid item xs={4}>\r\n                <Grid container justify=\"center\">\r\n                  {t(\"scenes.dataViewer.chartSettings.colors.dimension\")}\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item xs={4}>\r\n                <Grid container justify=\"center\">\r\n                  {t(\"scenes.dataViewer.chartSettings.colors.dimensionValue\")}\r\n                </Grid>\r\n              </Grid>\r\n              <Grid item xs={4}>\r\n                <Grid container justify=\"center\">\r\n                  {t(\"scenes.dataViewer.chartSettings.colors.color\")}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        </div>\r\n        <div className={classes.scrollableRows}>\r\n          <div className={classes.rows}>\r\n            {Object.keys(colors).map((dimension, idx) => (\r\n              <Fragment>\r\n                <Row\r\n                  key={idx}\r\n                  t={t}\r\n                  classes={classes}\r\n                  jsonStat={jsonStat}\r\n                  dimension={dimension}\r\n                  items={colors[dimension]}\r\n                  onColorEdit={handleColorEdit}\r\n                  onColorRemove={handleColorRemove}\r\n                />\r\n                <Divider/>\r\n              </Fragment>\r\n            ))}\r\n          </div>\r\n          <Grid container justify=\"center\">\r\n            <Button endIcon={<AddIcon/>} onClick={() => setAddColorVisibility(true)}>\r\n              {t(\"scenes.dataViewer.chartSettings.colors.actions.addColor\")}\r\n            </Button>\r\n          </Grid>\r\n        </div>\r\n      </div>\r\n\r\n      <Dialog\r\n        open={isAddColorVisible}\r\n        onClose={handleAddColorClose}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent>\r\n          <Grid container>\r\n            <Grid item xs={12}>\r\n              <Grid container spacing={2} style={{margin: 0}}>\r\n                <Grid item xs={4}>\r\n                  <Grid container justify=\"center\">\r\n                    {t(\"scenes.dataViewer.chartSettings.colors.dimension\")}\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                  <Grid container justify=\"center\">\r\n                    {t(\"scenes.dataViewer.chartSettings.colors.dimensionValue\")}\r\n                  </Grid>\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                  <Grid container justify=\"center\">\r\n                    {t(\"scenes.dataViewer.chartSettings.colors.color\")}\r\n                  </Grid>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <Grid container spacing={2}>\r\n                <Grid item xs={4}>\r\n                  <Selector\r\n                    value={newDim}\r\n                    render={dim => dim ? (jsonStat.dimension[dim].label || dim) : \"\"}\r\n                    selectTitle={t(\"scenes.dataViewer.chartSettings.colors.addColor.selectDimension\")}\r\n                    onSelect={() => {\r\n                      setIsDimension(true);\r\n                      setData(jsonStat.id.map(dim => ({\r\n                        id: dim,\r\n                        label: jsonStat.dimension[dim].label || dim\r\n                      })));\r\n                    }}\r\n                    resetTitle={t(\"scenes.dataViewer.chartSettings.colors.addColor.resetDimension\")}\r\n                    onReset={() => {\r\n                      setNewDim(null);\r\n                      setNewDimVal(null);\r\n                    }}\r\n                    className={classes.selector}\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                  {newDim && (\r\n                    <Selector\r\n                      value={newDimVal}\r\n                      render={dimVal => dimVal ? (jsonStat.dimension[newDim].category.label[dimVal] || dimVal) : \"\"}\r\n                      selectTitle={t(\"scenes.dataViewer.chartSettings.colors.addColor.selectDimensionValue\")}\r\n                      onSelect={() => {\r\n                        setIsDimension(false);\r\n                        setData(jsonStat.dimension[newDim].category.index.map(dimVal => ({\r\n                          id: dimVal,\r\n                          label: jsonStat.dimension[newDim].category.label[dimVal] || dimVal\r\n                        })));\r\n                      }}\r\n                      resetTitle={t(\"scenes.dataViewer.chartSettings.colors.addColor.resetDimensionValue\")}\r\n                      onReset={() => setNewDimVal(null)}\r\n                      className={classes.selector}\r\n                    />\r\n                  )}\r\n                </Grid>\r\n                <Grid item xs={4}>\r\n                  {newDimVal && (\r\n                    <div\r\n                      style={{\r\n                        width: \"100%\",\r\n                        height: \"100%\",\r\n                        background: newColor,\r\n                        border: `1px solid ${newColor}`,\r\n                        borderRadius: \"4px\"\r\n                      }}\r\n                      onClick={() => setColorPickerVisibility(true)}\r\n                    />\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleAddColorClose}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={handleAddColorSubmit} disabled={!newDim || !newDimVal || !newColor}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={data !== null}\r\n        onClose={() => setData(null)}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent>\r\n          <InfiniteScrollTable\r\n            data={data}\r\n            getRowKey={({id}) => id}\r\n            showHeader={false}\r\n            columns={[\r\n              {\r\n                title: \"\",\r\n                dataIndex: 'label',\r\n                render: (_, {label}) => label,\r\n                minWidth: 100\r\n              }\r\n            ]}\r\n            onRowClick={({id}) => {\r\n              if (isDimension) {\r\n                if (id !== newDim) {\r\n                  setNewDim(id);\r\n                  setNewDimVal(null);\r\n                }\r\n              } else {\r\n                if (id !== newDimVal) {\r\n                  setNewDimVal(id);\r\n                }\r\n              }\r\n              setData(null);\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setData(null)} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isColorPickerVisible}\r\n        onClose={handleColorPickerClose}\r\n        maxWidth=\"sm\"\r\n      >\r\n        <DialogContent style={{padding: 0}}>\r\n          <SketchPicker\r\n            color={tmpColor || newColor}\r\n            onChange={({rgb}) => {\r\n              const rgba = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, ${rgb.a})`;\r\n              if (tmpDim && tmpDimVal && tmpColor) {\r\n                setTmpColor(rgba);\r\n                const newColors = _.cloneDeep(colors);\r\n                newColors[tmpDim][tmpDimVal] = rgba;\r\n                onColorsSet(newColors);\r\n              } else {\r\n                setNewColor(rgba);\r\n              }\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleColorPickerClose}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ChartSettingsColors);","import React, {useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport {\r\n  CHART_LEGEND_POSITION_BOTTOM,\r\n  CHART_LEGEND_POSITION_lEFT,\r\n  CHART_LEGEND_POSITION_RIGHT,\r\n  CHART_LEGEND_POSITION_TOP\r\n} from \"../chart\";\r\nimport ChartSettingsColors from \"./Colors\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    padding: 4\r\n  },\r\n  tabs: {\r\n    marginBottom: 4\r\n  },\r\n  tabContent: {\r\n    height: 320\r\n  }\r\n});\r\n\r\nfunction ChartSettings(props) {\r\n  const {\r\n    t,\r\n    classes,\r\n    jsonStat,\r\n    isStacked,\r\n    onIsStackedSet,\r\n    legendPosition,\r\n    onLegendPositionSet,\r\n    colors,\r\n    onColorsSet\r\n  } = props;\r\n\r\n  const [tabId, setTabId] = useState(0);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <AppBar position=\"static\" color=\"default\" className={classes.tabs}>\r\n        <Tabs\r\n          value={tabId}\r\n          variant=\"scrollable\"\r\n          scrollButtons=\"auto\"\r\n          indicatorColor=\"primary\"\r\n          textColor=\"primary\"\r\n          onChange={(event, newValue) => setTabId(newValue)}\r\n        >\r\n          <Tab key={0} label={t(\"scenes.dataViewer.chartSettings.tabs.general\")}/>\r\n          <Tab key={1} label={t(\"scenes.dataViewer.chartSettings.tabs.colors\")}/>\r\n        </Tabs>\r\n      </AppBar>\r\n      <div className={classes.tabContent}>\r\n        {tabId === 0 && (\r\n          <Grid container spacing={3} style={{marginTop: 0}}>\r\n            <Grid item xs={12}>\r\n              <FormControlLabel\r\n                label={t(\"scenes.dataViewer.chartSettings.isStacked\")}\r\n                control={\r\n                  <Checkbox\r\n                    checked={isStacked}\r\n                    onChange={(e, value) => onIsStackedSet(value)}\r\n                  />\r\n                }\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <TextField\r\n                select\r\n                fullWidth\r\n                label={t(\"scenes.dataViewer.chartSettings.legendPosition.label\")}\r\n                value={legendPosition}\r\n                variant=\"outlined\"\r\n                onChange={ev => onLegendPositionSet(ev.target.value)}\r\n              >\r\n                <MenuItem value={CHART_LEGEND_POSITION_TOP}>\r\n                  {t(\"scenes.dataViewer.chartSettings.legendPosition.values.top\")}\r\n                </MenuItem>\r\n                <MenuItem value={CHART_LEGEND_POSITION_RIGHT}>\r\n                  {t(\"scenes.dataViewer.chartSettings.legendPosition.values.right\")}\r\n                </MenuItem>\r\n                <MenuItem value={CHART_LEGEND_POSITION_BOTTOM}>\r\n                  {t(\"scenes.dataViewer.chartSettings.legendPosition.values.bottom\")}\r\n                </MenuItem>\r\n                <MenuItem value={CHART_LEGEND_POSITION_lEFT}>\r\n                  {t(\"scenes.dataViewer.chartSettings.legendPosition.values.left\")}\r\n                </MenuItem>\r\n              </TextField>\r\n            </Grid>\r\n          </Grid>\r\n        )}\r\n        {tabId === 1 && (\r\n          <ChartSettingsColors\r\n            jsonStat={jsonStat}\r\n            colors={colors}\r\n            onColorsSet={onColorsSet}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ChartSettings);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport DataViewerHeader from \"./Header\";\r\nimport DataViewerSideBar from \"./Sidebar\";\r\nimport DataViewerFooter from \"./Footer\";\r\nimport DatasetFilters from \"../dataset-filters\";\r\nimport JsonStatTable, {\r\n  JSONSTAT_TABLE_FONT_SIZE_LG,\r\n  JSONSTAT_TABLE_FONT_SIZE_MD,\r\n  JSONSTAT_TABLE_FONT_SIZE_SM\r\n} from \"../table\";\r\nimport Criteria from \"../criteria\";\r\nimport TableLayout from \"../table-layout\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FontSizeSelector, {\r\n  FONT_SIZE_SELECTOR_FONT_SIZE_MD,\r\n  FONT_SIZE_SELECTOR_FONT_SIZE_SM\r\n} from \"../font-size-selector\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport \"./style.css\"\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport TableChartIcon from \"@material-ui/icons/TableChart\";\r\nimport MapIcon from \"@material-ui/icons/Map\";\r\nimport BarChartIcon from \"@material-ui/icons/BarChart\";\r\nimport TimelineIcon from \"@material-ui/icons/Timeline\";\r\nimport DonutLargeIcon from \"@material-ui/icons/DonutLarge\";\r\nimport PieChartIcon from \"@material-ui/icons/PieChart\";\r\nimport AreaIcon from \"../custom-icons/AreaIcon\";\r\nimport RadarIcon from \"../custom-icons/RadarIcon\";\r\nimport PolarIcon from \"../custom-icons/PolarIcon\";\r\nimport PyramidIcon from \"../custom-icons/PyramindIcon\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  enableDatasetFetch,\r\n  fetchAccessibleDataset,\r\n  fetchDataset,\r\n  fetchDatasetGeometries,\r\n  hideDatasetCriteria,\r\n  hideDatasetCriteriaAlert,\r\n  hideDatasetCriteriaLengthWarning,\r\n  hideDatasetDownloadWarning,\r\n  hideDatasetUnavailableViewWarning,\r\n  setDatasetChartColors,\r\n  setDatasetChartLegendPosition,\r\n  setDatasetChartStacked,\r\n  setDatasetLabelFormat,\r\n  setDatasetMapDetailLevel,\r\n  setDatasetViewer,\r\n  showDatasetCriteria,\r\n  submitDatasetChartFilterTree,\r\n  submitDatasetChartLayout,\r\n  submitDatasetDownload,\r\n  submitDatasetMapLayout,\r\n  submitDatasetTableFilterTree,\r\n  submitDatasetTableLayout,\r\n  submitDatasetViewTemplate\r\n} from \"../../state/dataset/datasetActions\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {\r\n  getDimensionFilterValues,\r\n  getFilterTreeFromJsonStat,\r\n  getInitialFiltersValue,\r\n  getJsonStatTableSize,\r\n  getUpdatedLayout\r\n} from \"../../utils/jsonStat\";\r\nimport {numberFormatter} from \"../../utils/formatters\";\r\nimport Call from \"../../hocs/call\";\r\nimport ChartLayout from \"../chart-layout\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Map from \"../map/index\";\r\nimport LabelFormatSelector from \"../label-format-selector\";\r\nimport Chart from \"../chart\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport ChartSettings from \"../chart-settings\";\r\n\r\nconst SIDEBAR_WIDTH = 80;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"absolute\",\r\n    width: \"100%\"\r\n  },\r\n  header: {\r\n    width: \"100%\"\r\n  },\r\n  page: {\r\n    width: \"100%\"\r\n  },\r\n  sidebar: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\",\r\n    width: SIDEBAR_WIDTH,\r\n    height: \"100%\",\r\n    overflow: \"auto\",\r\n    marginLeft: theme.spacing(2),\r\n    padding: \"0 8px\"\r\n  },\r\n  data: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\",\r\n    width: `calc(100% - ${SIDEBAR_WIDTH + theme.spacing(2) + theme.spacing(2) + theme.spacing(2)}px)`,\r\n    height: \"100%\",\r\n    marginLeft: theme.spacing(2),\r\n    marginRight: theme.spacing(2),\r\n    padding: theme.spacing(2)\r\n  },\r\n  viewerContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  filtersAndActions: {\r\n    width: \"100%\",\r\n    paddingBottom: theme.spacing(1)\r\n  },\r\n  filters: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\"\r\n  },\r\n  actions: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\"\r\n  },\r\n  action: {\r\n    height: 40,\r\n    \"& button\": {\r\n      padding: 8\r\n    }\r\n  },\r\n  viewer: {\r\n    width: \"100%\",\r\n    position: \"relative\"\r\n  },\r\n  attributes: {\r\n    width: \"100%\",\r\n    paddingTop: 12\r\n  },\r\n  footer: {\r\n    bottom: 0,\r\n    left: 0,\r\n    width: \"100%\",\r\n    overflowX: \"auto\",\r\n    overflowY: \"hidden\",\r\n    padding: theme.spacing(1)\r\n  },\r\n  warningAlert: {\r\n    width: \"100%\",\r\n    marginBottom: 16\r\n  },\r\n  criteriaContent: {\r\n    overflow: \"hidden !important\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = ({dataset}) => ({\r\n  dataset: dataset.dataset,\r\n  accessibleDataset: dataset.accessibleDataset,\r\n  isFetchDatasetDisabled: dataset.isFetchDatasetDisabled,\r\n  isCriteriaVisible: dataset.isCriteriaVisible,\r\n  isCriteriaAlertVisible: dataset.isCriteriaAlertVisible,\r\n  hasViewLayout: dataset.hasViewLayout,\r\n  hasTemplateLayout: dataset.hasTemplateLayout,\r\n  hasAnnotationLayout: dataset.hasAnnotationLayout,\r\n  dimensions: dataset.dimensions,\r\n  mode: dataset.mode,\r\n  type: dataset.type,\r\n  codelistsLength: dataset.codelistsLength,\r\n  viewerIdx: dataset.viewerIdx,\r\n  tableLayout: dataset.tableLayout,\r\n  mapLayout: dataset.mapLayout,\r\n  chartLayout: dataset.chartLayout,\r\n  tableFilterTree: dataset.tableFilterTree,\r\n  mapFilterTree: dataset.mapFilterTree,\r\n  chartFilterTree: dataset.chartFilterTree,\r\n  labelFormat: dataset.labelFormat,\r\n  criteria: dataset.criteria,\r\n  decimalSeparator: dataset.decimalSeparator,\r\n  decimalPlaces: dataset.decimalPlaces,\r\n  tableEmptyChar: dataset.tableEmptyChar,\r\n  chartStacked: dataset.chartStacked,\r\n  chartLegendPosition: dataset.chartLegendPosition,\r\n  chartColors: dataset.chartColors,\r\n  mapDetailLevel: dataset.mapDetailLevel,\r\n  enableCriteria: dataset.enableCriteria,\r\n  enableLayout: dataset.enableLayout,\r\n  maxAllowedCells: dataset.maxAllowedCells,\r\n  codes: dataset.codes,\r\n  isCodesFlat: dataset.isCodesFlat,\r\n  codelists: dataset.codelists,\r\n  areCodelistsFlat: dataset.areCodelistsFlat,\r\n  timePeriod: dataset.timePeriod,\r\n  geometries: dataset.geometries,\r\n  geometryDetailLevels: dataset.geometryDetailLevels,\r\n  isPartialData: dataset.isPartialData,\r\n  isEmptyData: dataset.isEmptyData,\r\n  isTooBigData: dataset.isTooBigData,\r\n  isDownloadWarningVisible: dataset.isDownloadWarningVisible,\r\n  isUnavailableViewWarningVisible: dataset.isUnavailableViewWarningVisible,\r\n  isCriteriaLengthWarningVisible: dataset.isCriteriaLengthWarningVisible,\r\n  timings: dataset.timings\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onDatasetFetch: ({nodeId, datasetId, criteria, datasetTitle, checkCriteriaLength, tableLayout, chartLayout, mapLayout, maxAllowedCells, hasAnnotationLayout}) =>\r\n    dispatch(fetchDataset(nodeId, datasetId, criteria, datasetTitle, checkCriteriaLength, tableLayout, chartLayout, mapLayout, maxAllowedCells, hasAnnotationLayout)),\r\n  onAccessibleDatasetFetch: ({nodeId, datasetId, criteria, datasetTitle}) => dispatch(fetchAccessibleDataset(nodeId, datasetId, criteria, datasetTitle)),\r\n  onFetchDatasetEnable: () => dispatch(enableDatasetFetch()),\r\n  onCriteriaShow: () => dispatch(showDatasetCriteria()),\r\n  onCriteriaHide: () => dispatch(hideDatasetCriteria()),\r\n  onCriteriaAlertHide: () => dispatch(hideDatasetCriteriaAlert()),\r\n  onViewerSet: viewerIdx => dispatch(setDatasetViewer(viewerIdx)),\r\n  onTableLayoutSet: layout => dispatch(submitDatasetTableLayout(layout)),\r\n  onTableFilterTreeSet: filterTree => dispatch(submitDatasetTableFilterTree(filterTree)),\r\n  onMapLayoutSet: layout => dispatch(submitDatasetMapLayout(layout)),\r\n  onChartLayoutSet: layout => dispatch(submitDatasetChartLayout(layout)),\r\n  onChartFilterTreeSet: filterTree => dispatch(submitDatasetChartFilterTree(filterTree)),\r\n  onLabelFormatSet: labelFormat => dispatch(setDatasetLabelFormat(labelFormat)),\r\n  onChartStackedSet: labelFormat => dispatch(setDatasetChartStacked(labelFormat)),\r\n  onChartLegendPositionSet: labelFormat => dispatch(setDatasetChartLegendPosition(labelFormat)),\r\n  onChartColorsSet: labelFormat => dispatch(setDatasetChartColors(labelFormat)),\r\n  onMapDetailLevelSet: detailLevel => dispatch(setDatasetMapDetailLevel(detailLevel)),\r\n  onDownloadSubmit: (nodeId, datasetId, datasetTitle, criteria, format, extension) =>\r\n    dispatch(submitDatasetDownload(nodeId, datasetId, datasetTitle, criteria, format, extension)),\r\n  onDownloadHide: () => dispatch(hideDatasetDownloadWarning()),\r\n  onViewTemplateSubmit: (nodeId, viewTemplate, isView) => dispatch(submitDatasetViewTemplate(nodeId, viewTemplate, isView)),\r\n  onUnavailableViewHide: () => dispatch(hideDatasetUnavailableViewWarning()),\r\n  onCriteriaLengthWarningHide: () => dispatch(hideDatasetCriteriaLengthWarning()),\r\n  onGeometryFetch: (idList, t) => dispatch(fetchDatasetGeometries(idList, t))\r\n});\r\n\r\nconst viewers = t => [\r\n  {\r\n    key: 0,\r\n    type: \"table\",\r\n    title: t ? t(\"scenes.dataViewers.viewers.table\") : \"\",\r\n    icon: <TableChartIcon/>\r\n  },\r\n  {\r\n    key: 1,\r\n    title: t ? t(\"scenes.dataViewers.viewers.map\") : \"\",\r\n    type: \"map\",\r\n    icon: <MapIcon/>\r\n  },\r\n  {\r\n    key: 2,\r\n    title: t ? t(\"scenes.dataViewers.viewers.verticalBar\") : \"\",\r\n    type: \"bar\",\r\n    icon: <BarChartIcon/>,\r\n    chartType: \"bar\"\r\n  },\r\n  {\r\n    key: 3,\r\n    title: t ? t(\"scenes.dataViewers.viewers.horizontalBar\") : \"\",\r\n    type: \"horizontalBar\",\r\n    icon: <BarChartIcon style={{transform: \"rotate(90deg)\"}}/>,\r\n    chartType: \"horizontalBar\"\r\n  },\r\n  {\r\n    key: 4,\r\n    title: t ? t(\"scenes.dataViewers.viewers.line\") : \"\",\r\n    type: \"line\",\r\n    icon: <TimelineIcon/>,\r\n    chartType: \"line\"\r\n  },\r\n  {\r\n    key: 5,\r\n    title: t ? t(\"scenes.dataViewers.viewers.area\") : \"\",\r\n    type: \"area\",\r\n    icon: <AreaIcon/>,\r\n    chartType: \"area\"\r\n  },\r\n  {\r\n    key: 6,\r\n    title: t ? t(\"scenes.dataViewers.viewers.doughnut\") : \"\",\r\n    type: \"doughnut\",\r\n    icon: <DonutLargeIcon/>,\r\n    chartType: \"doughnut\"\r\n  },\r\n  {\r\n    key: 7,\r\n    title: t ? t(\"scenes.dataViewers.viewers.pie\") : \"\",\r\n    type: \"pie\",\r\n    icon: <PieChartIcon/>,\r\n    chartType: \"pie\"\r\n  },\r\n  {\r\n    key: 8,\r\n    title: t ? t(\"scenes.dataViewers.viewers.radar\") : \"\",\r\n    type: \"radar\",\r\n    icon: <RadarIcon/>,\r\n    chartType: \"radar\"\r\n  },\r\n  {\r\n    key: 9,\r\n    title: t ? t(\"scenes.dataViewers.viewers.polarArea\") : \"\",\r\n    type: \"polarArea\",\r\n    icon: <PolarIcon/>,\r\n    chartType: \"polarArea\"\r\n  },\r\n  {\r\n    key: 10,\r\n    title: t ? t(\"scenes.dataViewers.viewers.pyramid\") : \"\",\r\n    type: \"pyramid\",\r\n    icon: <PyramidIcon/>,\r\n    chartType: \"pyramid\"\r\n  }\r\n];\r\n\r\nexport const getViewerIdxFromType = viewerType => {\r\n  if (!viewerType) {\r\n    return 0\r\n  }\r\n\r\n  const viewer = viewers().find(({type}) => type === viewerType);\r\n  return viewer\r\n    ? viewer.key\r\n    : 0\r\n};\r\n\r\nexport const getViewerTypeFromIdx = viewerIdx => viewers()[viewerIdx].type;\r\n\r\nconst handleStyle = () => {\r\n\r\n  const nodeHeaderHeight = document.getElementById(\"node-header\")\r\n    ? document.getElementById(\"node-header\").offsetHeight\r\n    : 0;\r\n  if (document.getElementById(\"data-viewer\")) {\r\n    document.getElementById(\"data-viewer\").setAttribute(\"style\", `height: calc(100% - ${nodeHeaderHeight}px); top: ${nodeHeaderHeight}px`);\r\n  }\r\n\r\n  const headerHeight = document.getElementById(\"data-viewer__header\")\r\n    ? document.getElementById(\"data-viewer__header\").offsetHeight\r\n    : 0;\r\n  const footerHeight = document.getElementById(\"data-viewer__footer\")\r\n    ? document.getElementById(\"data-viewer__footer\").offsetHeight\r\n    : 0;\r\n  if (document.getElementById(\"data-viewer__page\")) {\r\n    document.getElementById(\"data-viewer__page\").setAttribute(\"style\", `height: calc(100% - ${headerHeight + footerHeight}px)`);\r\n  }\r\n\r\n  const actionsWidth = document.getElementById(\"data-viewer__page__viewer__actions\")\r\n    ? document.getElementById(\"data-viewer__page__viewer__actions\").offsetWidth + 5\r\n    : 0;\r\n  if (document.getElementById(\"data-viewer__page__viewer__filters\")) {\r\n    document.getElementById(\"data-viewer__page__viewer__filters\").setAttribute(\"style\", `width: calc(100% - ${actionsWidth}px)`);\r\n  }\r\n\r\n  const filtersAndActionsHeight = document.getElementById(\"data-viewer__page__viewer__filters-and-actions\")\r\n    ? document.getElementById(\"data-viewer__page__viewer__filters-and-actions\").offsetHeight\r\n    : 0;\r\n  if (document.getElementById(\"data-viewer__page__viewer__viewer\")) {\r\n    document.getElementById(\"data-viewer__page__viewer__viewer\").setAttribute(\"style\", `height: calc(100% - ${filtersAndActionsHeight}px)`);\r\n  }\r\n};\r\n\r\nfunction DataViewer(props) {\r\n  const {\r\n    classes,\r\n\r\n    nodeId,\r\n    nodeCode,\r\n    isAccessible,\r\n    datasetId,\r\n    datasetTitle,\r\n    viewId,\r\n    notes,\r\n    attachedFiles,\r\n    referenceMetadataUrl,\r\n    nodeExtras,\r\n    maxObservation,\r\n\r\n    dataset,\r\n    accessibleDataset,\r\n    isFetchDatasetDisabled,\r\n    isCriteriaVisible,\r\n    isCriteriaAlertVisible,\r\n    hasViewLayout,\r\n    hasTemplateLayout,\r\n    hasAnnotationLayout,\r\n    dimensions,\r\n    mode,\r\n    type,\r\n    codelistsLength,\r\n    viewerIdx,\r\n    tableLayout,\r\n    mapLayout,\r\n    chartLayout,\r\n    tableFilterTree,\r\n    mapFilterTree,\r\n    chartFilterTree,\r\n    labelFormat,\r\n    criteria,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    tableEmptyChar,\r\n    chartStacked,\r\n    chartLegendPosition,\r\n    chartColors,\r\n    mapDetailLevel,\r\n    enableCriteria,\r\n    enableLayout,\r\n    maxAllowedCells,\r\n    codes,\r\n    isCodesFlat,\r\n    codelists,\r\n    areCodelistsFlat,\r\n    timePeriod,\r\n    geometries,\r\n    geometryDetailLevels,\r\n    isPartialData,\r\n    isEmptyData,\r\n    isTooBigData,\r\n    isDownloadWarningVisible,\r\n    isUnavailableViewWarningVisible,\r\n    isCriteriaLengthWarningVisible,\r\n    timings,\r\n\r\n    onDatasetFetch,\r\n    onAccessibleDatasetFetch,\r\n    onFetchDatasetEnable,\r\n    onCriteriaShow,\r\n    onCriteriaHide,\r\n    onCriteriaAlertHide,\r\n    onViewerSet,\r\n    onTableLayoutSet,\r\n    onTableFilterTreeSet,\r\n    onMapLayoutSet,\r\n    onChartLayoutSet,\r\n    onChartFilterTreeSet,\r\n    onLabelFormatSet,\r\n    onChartStackedSet,\r\n    onChartLegendPositionSet,\r\n    onChartColorsSet,\r\n    onMapDetailLevelSet,\r\n    onDownloadSubmit,\r\n    onDownloadHide,\r\n    onViewTemplateSubmit,\r\n    onUnavailableViewHide,\r\n    onGeometryFetch,\r\n    onCriteriaLengthWarningHide\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [tmpTableLayout, setTmpTableLayout] = useState(null);\r\n  const [tmpChartLayout, setTmpChartLayout] = useState(null);\r\n\r\n  const [chartId] = useState(\"chart__\" + uuidv4());\r\n\r\n  const [mapId] = useState(\"map__\" + uuidv4());\r\n\r\n  const [isLayoutVisible, setLayoutVisibility] = useState(false);\r\n  const [isCriteriaValid, setCriteriaValidity] = useState(true);\r\n\r\n  const [isFullscreen, setFullscreen] = useState(false);\r\n  const [fontSize, setFontSize] = useState(FONT_SIZE_SELECTOR_FONT_SIZE_MD);\r\n\r\n  const [isChartSettingsVisible, setChartSettingsVisibility] = useState(false);\r\n  const [tmpChartStacked, setTmpChartStacked] = useState(null);\r\n  const [tmpChartLegendPosition, setTmpChartLegendPosition] = useState(null);\r\n  const [tmpChartColors, setTmpChartColors] = useState(null);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", handleStyle);\r\n    return () => window.removeEventListener(\"resize\", handleStyle)\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    handleStyle();\r\n  }, [dataset, viewerIdx, tableLayout, mapLayout, chartLayout, labelFormat]);\r\n\r\n  useEffect(() => {\r\n    setTmpTableLayout(tableLayout);\r\n  }, [tableLayout]);\r\n\r\n  useEffect(() => {\r\n    setTmpChartLayout(chartLayout);\r\n  }, [chartLayout]);\r\n\r\n  useEffect(() => {\r\n    setTmpChartStacked(chartStacked);\r\n  }, [chartStacked]);\r\n\r\n  useEffect(() => {\r\n    setTmpChartLegendPosition(chartLegendPosition);\r\n  }, [chartLegendPosition]);\r\n\r\n  useEffect(() => {\r\n    setTmpChartColors(chartColors);\r\n  }, [chartColors]);\r\n\r\n  const handleSetViewer = viewerIdx => {\r\n    onViewerSet(viewerIdx);\r\n  };\r\n\r\n  const handleSetData = dataIdx => {\r\n    // fetch new data\r\n  };\r\n\r\n  const handleLayoutOpen = () => {\r\n    setLayoutVisibility(true);\r\n  };\r\n\r\n  const handleLayoutClose = () => {\r\n    setLayoutVisibility(false);\r\n    setTmpTableLayout(tableLayout);\r\n    setTmpChartLayout(chartLayout);\r\n  };\r\n\r\n  const handleLayoutSubmit = () => {\r\n    setLayoutVisibility(false);\r\n\r\n    if (viewerIdx === 0) {\r\n      const newTableFilterTree = getFilterTreeFromJsonStat(tmpTableLayout, dataset);\r\n      onTableLayoutSet({\r\n        ...tmpTableLayout,\r\n        filtersValue: getInitialFiltersValue(dataset, tmpTableLayout, newTableFilterTree)\r\n      });\r\n      onTableFilterTreeSet(newTableFilterTree);\r\n\r\n    } else if (viewerIdx >= 2) {\r\n      const newPrimaryDim = tmpChartLayout.primaryDim[0];\r\n      const newSecondaryDim = tmpChartLayout.secondaryDim[0];\r\n      const prevPrimaryDim = chartLayout.primaryDim[0];\r\n      const prevSecondaryDim = chartLayout.secondaryDim[0];\r\n\r\n      const isSecondaryDimChanged = (\r\n        (!prevSecondaryDim && !!newSecondaryDim) ||\r\n        (!!prevSecondaryDim && !newSecondaryDim) ||\r\n        (!!prevSecondaryDim && !!newSecondaryDim && prevSecondaryDim !== newSecondaryDim)\r\n      );\r\n\r\n      const newChartFilterTree = getFilterTreeFromJsonStat(tmpChartLayout, dataset);\r\n      if (newPrimaryDim !== prevPrimaryDim) {\r\n        tmpChartLayout.primaryDimValues = dataset.dimension[newPrimaryDim].category.index;\r\n        tmpChartLayout.secondaryDimValues = newSecondaryDim\r\n          ? getDimensionFilterValues(newSecondaryDim, dataset, tmpChartLayout, newChartFilterTree)\r\n          : []\r\n      } else if (isSecondaryDimChanged) {\r\n        tmpChartLayout.secondaryDimValues = newSecondaryDim\r\n          ? getDimensionFilterValues(newSecondaryDim, dataset, tmpChartLayout, newChartFilterTree)\r\n          : []\r\n      }\r\n      onChartLayoutSet({\r\n        ...tmpChartLayout,\r\n        filtersValue: getInitialFiltersValue(dataset, tmpChartLayout, newChartFilterTree)\r\n      });\r\n      onChartFilterTreeSet(newChartFilterTree);\r\n    }\r\n  };\r\n\r\n  const handleCriteriaOpen = () => {\r\n    onCriteriaShow();\r\n  }\r\n\r\n  const handleCriteriaClose = () => {\r\n    onCriteriaHide();\r\n    setCriteriaValidity(true);\r\n  }\r\n\r\n  const handleCriteriaSubmit = () => {\r\n    onFetchDatasetEnable();\r\n  }\r\n\r\n  const handleFilterSelect = (dimension, value) => {\r\n    if (viewerIdx === 0) {\r\n      onTableLayoutSet(getUpdatedLayout(dimension, value, dataset, tableLayout, tableFilterTree));\r\n    } else if (viewerIdx === 1) {\r\n      onMapLayoutSet(getUpdatedLayout(dimension, value, dataset, mapLayout, mapFilterTree));\r\n    } else if (viewerIdx >= 2) {\r\n      onChartLayoutSet(getUpdatedLayout(dimension, value, dataset, chartLayout, chartFilterTree));\r\n    }\r\n  };\r\n\r\n  const handleFontSizeSelect = size => {\r\n    setFontSize(size);\r\n  };\r\n\r\n  const handleChartSettingsOpen = () => {\r\n    setChartSettingsVisibility(true);\r\n  };\r\n\r\n  const handleChartSettingsClose = () => {\r\n    setChartSettingsVisibility(false);\r\n    setTmpChartStacked(chartStacked);\r\n    setTmpChartLegendPosition(chartLegendPosition);\r\n    setTmpChartColors(chartColors);\r\n  };\r\n\r\n  const handleChartSettingsSubmit = () => {\r\n    setChartSettingsVisibility(false);\r\n    onChartStackedSet(tmpChartStacked);\r\n    onChartLegendPositionSet(tmpChartLegendPosition);\r\n    onChartColorsSet(tmpChartColors);\r\n  };\r\n\r\n  const handleFullscreen = () => {\r\n    !isFullscreen\r\n      ? document.getElementById(\"data-viewer__page__viewer\").classList.add(\"data-viewer__page__viewer--fullscreen\")\r\n      : document.getElementById(\"data-viewer__page__viewer\").classList.remove(\"data-viewer__page__viewer--fullscreen\");\r\n\r\n    setFullscreen(!isFullscreen);\r\n  };\r\n\r\n  return (\r\n    <div id=\"data-viewer\" className={classes.root}>\r\n      {isAccessible\r\n        ? (\r\n          <Call\r\n            cb={onAccessibleDatasetFetch}\r\n            cbParam={{nodeId, datasetId, criteria, datasetTitle}}\r\n            disabled={!nodeId || !datasetId || !criteria || !datasetTitle || isFetchDatasetDisabled}\r\n          >\r\n            <div style={{height: \"100%\", width: \"100%\", overflow: \"auto\", padding: 16}}>\r\n              <span>{accessibleDataset}</span>\r\n            </div>\r\n          </Call>\r\n        )\r\n        : (\r\n          <Fragment>\r\n            <Call\r\n              cb={onDatasetFetch}\r\n              cbParam={{\r\n                nodeId,\r\n                datasetId,\r\n                criteria,\r\n                datasetTitle,\r\n                checkCriteriaLength: false,\r\n                tableLayout,\r\n                chartLayout,\r\n                mapLayout,\r\n                maxAllowedCells,\r\n                hasAnnotationLayout\r\n              }}\r\n              disabled={!nodeId || !datasetId || !criteria || !datasetTitle || isFetchDatasetDisabled}\r\n            >\r\n              <div id=\"data-viewer__header\" className={classes.header}>\r\n                <DataViewerHeader\r\n                  nodeId={nodeId}\r\n                  nodeCode={nodeCode}\r\n                  nodeDownloadFormats={nodeExtras?.DownloadFormats}\r\n                  datasetId={datasetId}\r\n                  datasetTitle={datasetTitle}\r\n                  viewId={viewId}\r\n                  hasViewLayout={hasViewLayout}\r\n                  hasTemplateLayout={hasTemplateLayout}\r\n                  hasAnnotationLayout={hasAnnotationLayout}\r\n                  notes={notes}\r\n                  attachedFiles={attachedFiles}\r\n                  jsonStat={dataset}\r\n                  hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                  tableLayout={tableLayout}\r\n                  mapLayout={mapLayout}\r\n                  chartLayout={chartLayout}\r\n                  labelFormat={labelFormat}\r\n                  criteria={criteria}\r\n                  decimalSeparator={decimalSeparator}\r\n                  decimalPlaces={decimalPlaces}\r\n                  tableEmptyChar={tableEmptyChar}\r\n                  chartStacked={chartStacked}\r\n                  chartLegendPosition={chartLegendPosition}\r\n                  chartColors={chartColors}\r\n                  mapDetailLevel={mapDetailLevel}\r\n                  viewers={viewers(t)}\r\n                  viewerIdx={viewerIdx}\r\n                  onViewTemplateSubmit={(viewTemplate, isView) => onViewTemplateSubmit(nodeId, viewTemplate, isView)}\r\n                  onDownloadSubmit={(format, extension) => onDownloadSubmit(nodeId, datasetId, datasetTitle, criteria, format, extension)}\r\n                  timings={timings}\r\n                  chartId={chartId}\r\n                  mapId={mapId}\r\n                />\r\n              </div>\r\n              <div id=\"data-viewer__page\" className={classes.page}>\r\n                <Card className={classes.sidebar}>\r\n                  <DataViewerSideBar\r\n                    viewers={viewers(t)}\r\n                    selected={viewerIdx}\r\n                    isCriteriaDisabled={!enableCriteria}\r\n                    isLayoutDisabled={!enableLayout || !dataset || !(!!tableLayout || !!mapLayout || !!chartLayout)}\r\n                    isTableDisabled={!dataset || !tableLayout}\r\n                    isChartDisabled={!dataset || !chartLayout}\r\n                    isMapDisabled={!dataset || !mapLayout}\r\n                    referenceMetadataUrl={referenceMetadataUrl}\r\n                    onViewerSelect={handleSetViewer}\r\n                    onCriteriaOpen={handleCriteriaOpen}\r\n                    onLayoutOpen={handleLayoutOpen}\r\n                  />\r\n                </Card>\r\n                <Card className={classes.data}>\r\n                  <div id=\"data-viewer__page__viewer\" className={classes.viewerContainer}>\r\n                    <div id=\"data-viewer__page__viewer__filters-and-actions\" className={classes.filtersAndActions}>\r\n                      {dataset && (\r\n                        <Fragment>\r\n                          {dataset && isPartialData && (\r\n                            <Alert severity=\"warning\" className={classes.warningAlert}>\r\n                              {t(\"scenes.dataViewer.warnings.maxObservation.label\", {maxObservation: maxObservation ? numberFormatter(maxObservation) : \"\"})}\r\n                            </Alert>\r\n                          )}\r\n                          <div id=\"data-viewer__page__viewer__filters\" className={classes.filters}>\r\n                            {(() => {\r\n                              let layout, filterTree;\r\n\r\n                              if (viewerIdx === 0) {\r\n                                layout = tableLayout;\r\n                                filterTree = tableFilterTree;\r\n                              } else if (viewerIdx === 1) {\r\n                                layout = mapLayout;\r\n                                filterTree = mapFilterTree;\r\n                              } else {\r\n                                layout = chartLayout;\r\n                                filterTree = chartFilterTree;\r\n                              }\r\n\r\n                              return (\r\n                                <DatasetFilters\r\n                                  key={uuidv4()}\r\n                                  jsonStat={dataset}\r\n                                  hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                                  layout={layout}\r\n                                  filterTree={filterTree}\r\n                                  labelFormat={labelFormat}\r\n                                  onSelect={handleFilterSelect}\r\n                                />\r\n                              )\r\n                            })()}\r\n                          </div>\r\n                          <div id=\"data-viewer__page__viewer__actions\" className={classes.actions}>\r\n                            <Grid container>\r\n                              <Grid item className={classes.action}>\r\n                                <LabelFormatSelector\r\n                                  labelFormat={labelFormat}\r\n                                  setLabelFormat={labelFormat => onLabelFormatSet(labelFormat)}\r\n                                />\r\n                              </Grid>\r\n                              {viewerIdx >= 2 && (\r\n                                <Grid item className={classes.action}><Tooltip\r\n                                  title={t(\"scenes.dataViewer.actions.chartSettings\")}\r\n                                >\r\n                                  <IconButton onClick={handleChartSettingsOpen}>\r\n                                    <SettingsIcon/>\r\n                                  </IconButton>\r\n                                </Tooltip>\r\n                                </Grid>\r\n                              )}\r\n                              <Grid item className={classes.action}>\r\n                                <FontSizeSelector\r\n                                  fontSize={fontSize}\r\n                                  setFontSize={handleFontSizeSelect}\r\n                                />\r\n                              </Grid>\r\n                              <Grid item className={classes.action}>\r\n                                <Tooltip\r\n                                  title={isFullscreen\r\n                                    ? t(\"scenes.dataViewer.actions.fullscreen.exit\")\r\n                                    : t(\"scenes.dataViewer.actions.fullscreen.enter\")\r\n                                  }\r\n                                >\r\n                                  <IconButton onClick={handleFullscreen}>\r\n                                    {isFullscreen ? <FullscreenExitIcon/> : <FullscreenIcon/>}\r\n                                  </IconButton>\r\n                                </Tooltip>\r\n                              </Grid>\r\n                            </Grid>\r\n                          </div>\r\n                        </Fragment>\r\n                      )}\r\n                    </div>\r\n                    <div id=\"data-viewer__page__viewer__viewer\" className={classes.viewer}>\r\n                      {(() => {\r\n                        if (!dataset) {\r\n                          return isEmptyData\r\n                            ? <CustomEmpty text={t(\"scenes.dataViewer.errors.emptyData\")}/>\r\n                            : <CustomEmpty text={t(\"scenes.dataViewer.errors.applyCriteria\")}/>\r\n                        }\r\n                        if (viewerIdx === 0 && tableLayout) {\r\n                          return !isTooBigData\r\n                            ? (\r\n                              <JsonStatTable\r\n                                jsonStat={dataset}\r\n                                layout={tableLayout}\r\n                                isFullscreen={isFullscreen}\r\n                                labelFormat={labelFormat}\r\n                                fontSize={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_SM\r\n                                  ? JSONSTAT_TABLE_FONT_SIZE_SM\r\n                                  : fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_MD\r\n                                    ? JSONSTAT_TABLE_FONT_SIZE_MD\r\n                                    : JSONSTAT_TABLE_FONT_SIZE_LG\r\n                                }\r\n                                decimalSeparator={decimalSeparator}\r\n                                decimalPlaces={decimalPlaces}\r\n                                emptyChar={tableEmptyChar}\r\n                                hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                              />\r\n                            )\r\n                            : (\r\n                              <CustomEmpty\r\n                                text={t(\"scenes.dataViewer.errors.tooBigData\")}\r\n                              />\r\n                            )\r\n                        } else if (viewerIdx === 1 && mapLayout) {\r\n                          return (\r\n                            <Map\r\n                              mapId={mapId}\r\n                              jsonStat={dataset}\r\n                              layout={mapLayout}\r\n                              onGeometryFetch={idList => onGeometryFetch(idList, t)}\r\n                              geometries={geometries}\r\n                              geometryDetailLevels={geometryDetailLevels}\r\n                              detailLevel={mapDetailLevel}\r\n                              setDetailLevel={onMapDetailLevelSet}\r\n                              isFullscreen={isFullscreen}\r\n                            />\r\n                          )\r\n                        } else if (viewerIdx >= 2 && chartLayout) {\r\n                          return (\r\n                            <Chart\r\n                              chartId={chartId}\r\n                              type={viewers(t)[viewerIdx].chartType}\r\n                              jsonStat={dataset}\r\n                              layout={chartLayout}\r\n                              labelFormat={labelFormat}\r\n                              decimalSeparator={decimalSeparator}\r\n                              decimalPlaces={decimalPlaces}\r\n                              stacked={chartStacked}\r\n                              legendPosition={chartLegendPosition}\r\n                              colors={chartColors}\r\n                            />\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              </div>\r\n              <div id=\"data-viewer__footer\" className={classes.footer}>\r\n                <DataViewerFooter\r\n                  labels={dataset ? [datasetTitle] : []}\r\n                  dataIdx={0}\r\n                  setData={handleSetData}\r\n                />\r\n              </div>\r\n            </Call>\r\n\r\n            <Dialog\r\n              open={isCriteriaVisible}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleCriteriaClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.criteria.title\")}\r\n              </DialogTitle>\r\n              <DialogContent className={classes.criteriaContent}>\r\n                {dimensions && isCriteriaVisible && (\r\n                  <Fragment>\r\n\r\n                    <Criteria\r\n                      nodeId={nodeId}\r\n                      datasetId={datasetId}\r\n                      dimensions={dimensions}\r\n                      mode={mode}\r\n                      type={type}\r\n                      codes={codes}\r\n                      isCodesFlat={isCodesFlat}\r\n                      codelists={codelists}\r\n                      areCodelistsFlat={areCodelistsFlat}\r\n                      codelistsLength={codelistsLength}\r\n                      criteria={criteria}\r\n                      timePeriod={timePeriod}\r\n                      isCriteriaValid={isCriteriaValid}\r\n                      setCriteriaValidity={setCriteriaValidity}\r\n                    />\r\n\r\n                    <Dialog\r\n                      open={isCriteriaAlertVisible}\r\n                      fullWidth\r\n                      maxWidth=\"sm\"\r\n                      onClose={onCriteriaAlertHide}\r\n                    >\r\n                      {(() => {\r\n                        if (isEmptyData) {\r\n                          return (\r\n                            <DialogTitle>\r\n                              {t(\"scenes.dataViewer.errors.emptyData\")}\r\n                            </DialogTitle>\r\n                          )\r\n\r\n                        } else if (isTooBigData) {\r\n                          const count = getJsonStatTableSize(dataset);\r\n\r\n                          return (\r\n                            <Fragment>\r\n                              <DialogTitle>\r\n                                {t(\"scenes.dataViewer.dialogs.tooBigData.title\")}\r\n                              </DialogTitle>\r\n                              <DialogContent>\r\n                                {count !== 0 && (\r\n                                  <div style={{width: \"100%\", textAlign: \"end\"}}>\r\n                                    {t(\"scenes.dataViewer.dialogs.tooBigData.content.requestCells\")}: <b>{numberFormatter(count)}</b>\r\n                                  </div>\r\n                                )}\r\n                                <div style={{width: \"100%\", textAlign: \"end\"}}>\r\n                                  {t(\"scenes.dataViewer.dialogs.tooBigData.content.maxCells\")}: <b>{numberFormatter(maxAllowedCells)}</b>\r\n                                </div>\r\n                                <div style={{width: \"100%\", textAlign: \"end\", marginTop: 16}}>\r\n                                  {t(\"scenes.dataViewer.dialogs.tooBigData.content.applyCriteria\")}\r\n                                </div>\r\n                              </DialogContent>\r\n                            </Fragment>\r\n                          )\r\n\r\n                        } else {\r\n                          return (\r\n                            <DialogTitle>\r\n                              {t(\"scenes.dataViewer.errors.genericError\")}\r\n                            </DialogTitle>\r\n                          )\r\n                        }\r\n                      })()}\r\n                      <DialogActions>\r\n                        <Button autoFocus onClick={onCriteriaAlertHide} color=\"primary\">\r\n                          {t(\"commons.confirm.confirm\")}\r\n                        </Button>\r\n                      </DialogActions>\r\n                    </Dialog>\r\n\r\n                  </Fragment>\r\n                )}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleCriteriaClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button\r\n                  autoFocus\r\n                  color=\"primary\"\r\n                  onClick={handleCriteriaSubmit}\r\n                  disabled={!isCriteriaValid}\r\n                >\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isLayoutVisible && viewerIdx === 0}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleLayoutClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.tableLayout.title\")}\r\n              </DialogTitle>\r\n              <DialogContent>\r\n                <TableLayout\r\n                  jsonStat={dataset}\r\n                  layout={tmpTableLayout}\r\n                  labelFormat={labelFormat}\r\n                  setLayout={setTmpTableLayout}\r\n                />\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleLayoutClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button autoFocus onClick={handleLayoutSubmit} color=\"primary\">\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isLayoutVisible && viewerIdx >= 2}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleLayoutClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.chartLayout.title\")}\r\n              </DialogTitle>\r\n              <DialogContent>\r\n                <ChartLayout\r\n                  jsonStat={dataset}\r\n                  layout={tmpChartLayout}\r\n                  setLayout={setTmpChartLayout}\r\n                />\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleLayoutClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button autoFocus onClick={handleLayoutSubmit} color=\"primary\">\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isDownloadWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onDownloadHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.downloadFormat.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onDownloadHide}>\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isUnavailableViewWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onUnavailableViewHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.unavailableView.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onUnavailableViewHide}>\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isCriteriaLengthWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onCriteriaLengthWarningHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.tooLongQuery.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onCriteriaLengthWarningHide}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button\r\n                  onClick={() => onDatasetFetch({\r\n                    nodeId,\r\n                    datasetId,\r\n                    criteria,\r\n                    datasetTitle,\r\n                    checkCriteriaLength: false,\r\n                    tableLayout,\r\n                    chartLayout,\r\n                    mapLayout,\r\n                    maxAllowedCells,\r\n                    hasAnnotationLayout\r\n                  })}\r\n                >\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isChartSettingsVisible}\r\n              maxWidth=\"md\"\r\n              fullWidth\r\n              onClose={handleChartSettingsClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.chartSettings.title\")}\r\n              </DialogTitle>\r\n              <DialogContent>\r\n                <ChartSettings\r\n                  jsonStat={dataset}\r\n                  isStacked={tmpChartStacked}\r\n                  onIsStackedSet={setTmpChartStacked}\r\n                  legendPosition={tmpChartLegendPosition}\r\n                  onLegendPositionSet={setTmpChartLegendPosition}\r\n                  colors={tmpChartColors}\r\n                  onColorsSet={setTmpChartColors}\r\n                />\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleChartSettingsClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button autoFocus onClick={handleChartSettingsSubmit} color=\"primary\">\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n          </Fragment>\r\n        )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(DataViewer)","export const FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_INIT = \"fetch/dashboard/dataset/async/handler/init\"\r\nexport const FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_SUCCESS = \"fetch/dashboard/dataset/async/handler/success\"\r\nexport const FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_ERROR = \"fetch/dashboard/dataset/async/handler/error\"\r\n\r\nexport const initFetchDashboardDatasetAsyncHandler = dashboardId => ({\r\n  type: FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_INIT,\r\n  payload: {\r\n    dashboardId\r\n  }\r\n});\r\n\r\nexport const successFetchDashboardDatasetAsyncHandler = (dashboardId, dashboardJsonStats, dashboardLayouts, dashboardFilterTrees) => ({\r\n  type: FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_SUCCESS,\r\n  payload: {\r\n    dashboardId,\r\n    dashboardJsonStats,\r\n    dashboardLayouts,\r\n    dashboardFilterTrees\r\n  }\r\n});\r\n\r\nexport const errorFetchDashboardDatasetAsyncHandler = (dashboardId, requestIds) => ({\r\n  type: FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_ERROR,\r\n  payload: {\r\n    dashboardId,\r\n    requestIds\r\n  }\r\n});","import {Reducer} from \"redux\";\r\nimport {REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  DASHBOARDS_DASHBOARD_FETCH,\r\n  DASHBOARDS_DASHBOARDS_CLEAR,\r\n  DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET,\r\n  DASHBOARDS_DATASET_FILTER_SET,\r\n  DASHBOARDS_MAP_GEOMETRIES_FETCH\r\n} from \"./dashboardActions\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../utils/dashboards\";\r\nimport {getCriteriaObjectFromArray} from \"../../utils/criteria\";\r\nimport {getNutsLevelTranslations} from \"../../constants/getNutsLevelTranslations\";\r\nimport {\r\n  FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_ERROR,\r\n  FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_INIT,\r\n  FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_SUCCESS\r\n} from \"../../middlewares/fetchDashboardDatasetAsyncHandler/actions\";\r\nimport _ from \"lodash\";\r\nimport {getUpdatedLayout} from \"../../utils/jsonStat\";\r\n\r\nexport const DASHBOARD_VIEW_STATE_APPLY_FILTERS = \"DASHBOARD_VIEW_STATE_APPLY_FILTERS\"\r\nexport const DASHBOARD_VIEW_STATE_ERROR = \"DASHBOARD_VIEW_STATE_ERROR\"\r\nexport const DASHBOARD_VIEW_STATE_FETCHING = \"DASHBOARD_VIEW_STATE_FETCHING\"\r\nexport const DASHBOARD_VIEW_STATE_GENERATING_FILTER_TREE = \"DASHBOARD_VIEW_STATE_GENERATING_FILTER_TREE\"\r\n\r\ntype DashboardState = {\r\n  dashboards: any | null,\r\n  layouts: any | null,\r\n  isFetchDatasetDisabled: boolean,\r\n  jsonStats: any | null,\r\n  filterTrees: any | null,\r\n  maps: any | null\r\n}\r\n\r\nconst initialState = {\r\n  dashboards: null,\r\n  layouts: null,\r\n  isFetchDatasetDisabled: true,\r\n  jsonStats: null,\r\n  filterTrees: null,\r\n  maps: null\r\n};\r\n\r\nconst dashboardReducer: Reducer<DashboardState> = (\r\n  state = initialState,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case DASHBOARDS_DASHBOARDS_CLEAR: {\r\n      return initialState\r\n    }\r\n    case DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET: {\r\n      return {\r\n        ...state,\r\n        isFetchDatasetDisabled: action.payload.disabled\r\n      }\r\n    }\r\n    case FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_INIT: {\r\n      let currentDashboardJsonStats = _.cloneDeep(state.jsonStats?.[action.payload.dashboardId]);\r\n      let currentDashboardLayouts = _.cloneDeep(state.layouts?.[action.payload.dashboardId]);\r\n      let currentDashboardFilterTrees = _.cloneDeep(state.filterTrees?.[action.payload.dashboardId]);\r\n\r\n      state.dashboards[action.payload.dashboardId].dashboardConfig.forEach((row: any, rowIdx: number) => {\r\n        row.forEach((col: any, colIdx: number) => {\r\n          if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n            const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n            const isStaticView = (col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || \"\").length === 0;\r\n\r\n            const jsonStat = currentDashboardJsonStats?.[viewIdx];\r\n            currentDashboardJsonStats = {\r\n              ...currentDashboardJsonStats,\r\n              [viewIdx]: (isStaticView && jsonStat)\r\n                ? jsonStat\r\n                : DASHBOARD_VIEW_STATE_FETCHING\r\n            }\r\n\r\n            const layout = currentDashboardLayouts?.[viewIdx];\r\n            currentDashboardLayouts = {\r\n              ...currentDashboardLayouts,\r\n              [viewIdx]: (isStaticView && jsonStat)\r\n                ? layout\r\n                : null\r\n            }\r\n\r\n            const filterTree = currentDashboardFilterTrees?.[viewIdx];\r\n            currentDashboardFilterTrees = {\r\n              ...currentDashboardFilterTrees,\r\n              [viewIdx]: (isStaticView && jsonStat)\r\n                ? filterTree\r\n                : null\r\n            }\r\n          }\r\n        });\r\n      });\r\n\r\n      return {\r\n        ...state,\r\n        jsonStats: {\r\n          ...state.jsonStats,\r\n          [action.payload.dashboardId]: currentDashboardJsonStats\r\n        },\r\n        layouts: {\r\n          ...state.layouts,\r\n          [action.payload.dashboardId]: currentDashboardLayouts\r\n        },\r\n        filterTrees: {\r\n          ...state.filterTrees,\r\n          [action.payload.dashboardId]: currentDashboardFilterTrees\r\n        }\r\n      }\r\n    }\r\n    case FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_SUCCESS: {\r\n      return (state.jsonStats && state.layouts && state.filterTrees)\r\n        ? {\r\n          ...state,\r\n          jsonStats: {\r\n            ...state.jsonStats,\r\n            [action.payload.dashboardId]: action.payload.dashboardJsonStats\r\n          },\r\n          layouts: {\r\n            ...state.layouts,\r\n            [action.payload.dashboardId]: action.payload.dashboardLayouts\r\n          },\r\n          filterTrees: {\r\n            ...state.filterTrees,\r\n            [action.payload.dashboardId]: action.payload.dashboardFilterTrees\r\n          }\r\n        }\r\n        : {\r\n          ...state\r\n        }\r\n    }\r\n    case FETCH_DASHBOARD_DATASET_ASYNC_HANDLER_ERROR: {\r\n      const jsonStats = _.cloneDeep(state.jsonStats);\r\n      const layouts = _.cloneDeep(state.layouts);\r\n      const filterTrees = _.cloneDeep(state.filterTrees);\r\n\r\n      (action.payload.requestIds || []).forEach((id: string) => {\r\n        if (jsonStats) {\r\n          jsonStats[action.payload.dashboardId] = {\r\n            ...jsonStats[action.payload.dashboardId],\r\n            [id]: DASHBOARD_VIEW_STATE_ERROR\r\n          }\r\n        }\r\n        if (layouts) {\r\n          layouts[action.payload.dashboardId] = {\r\n            ...layouts[action.payload.dashboardId],\r\n            [id]: null\r\n          }\r\n        }\r\n        if (filterTrees) {\r\n          filterTrees[action.payload.dashboardId] = {\r\n            ...filterTrees[action.payload.dashboardId],\r\n            [id]: null\r\n          }\r\n        }\r\n      });\r\n\r\n      return {\r\n        ...state,\r\n        jsonStats: jsonStats,\r\n        layouts: layouts,\r\n        filterTrees: filterTrees\r\n      }\r\n    }\r\n    case DASHBOARDS_DATASET_FILTER_SET: {\r\n      return {\r\n        ...state,\r\n        layouts: {\r\n          ...state.layouts,\r\n          [action.payload.dashboardId]: {\r\n            ...state.layouts[action.payload.dashboardId],\r\n            [action.payload.viewIdx]: {\r\n              ...state.layouts[action.payload.dashboardId][action.payload.viewIdx],\r\n              layout: getUpdatedLayout(\r\n                action.payload.dimension,\r\n                action.payload.value,\r\n                state.jsonStats[action.payload.dashboardId][action.payload.viewIdx],\r\n                state.layouts[action.payload.dashboardId][action.payload.viewIdx].layout,\r\n                state.filterTrees[action.payload.dashboardId][action.payload.viewIdx]\r\n              )\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_MAP_GEOMETRIES_FETCH: {\r\n          return {\r\n            ...state,\r\n            maps: {\r\n              ...state.maps,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...state?.maps?.[action.payload.extra.dashboardId],\r\n                [action.payload.extra.viewIdx]: null\r\n              }\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DASHBOARD_FETCH: {\r\n          const views = _.cloneDeep(action.payload.response.views);\r\n          for (let key in views) {\r\n            if (views.hasOwnProperty(key)) {\r\n              views[key] = {\r\n                ...views[key],\r\n                datasetId: views[key].datasetId ? views[key].datasetId.split(\"+\").join(\",\") : undefined,\r\n                criteria: getCriteriaObjectFromArray(views[key].criteria),\r\n                layouts: JSON.parse(views[key].layouts)\r\n              }\r\n            }\r\n          }\r\n\r\n          return {\r\n            ...state,\r\n            dashboards: {\r\n              ...state.dashboards,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...action.payload.response,\r\n                dashboardConfig: action.payload.response?.dashboardConfig\r\n                  ? JSON.parse(action.payload.response.dashboardConfig)\r\n                  : {},\r\n                filterLevels: action.payload.response?.filterLevels\r\n                  ? JSON.parse(action.payload.response.filterLevels)\r\n                  : {},\r\n                views: views\r\n              }\r\n            }\r\n          }\r\n        }\r\n        case DASHBOARDS_MAP_GEOMETRIES_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any) => val.nutsLevel)\r\n            .reduce((acc: any, level: any) => {\r\n              if (!acc[level]) {\r\n                // @ts-ignore\r\n                const label = getNutsLevelTranslations(action.payload.extra.t)[level];\r\n                acc[level] = {level: level, counter: 0, label: (label || `nutsLevel${level}`)};\r\n              }\r\n              acc[level].counter++;\r\n              return acc;\r\n            }, [])\r\n            .filter((val: any) => !!val);\r\n\r\n          return {\r\n            ...state,\r\n            maps: {\r\n              ...state.maps,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...state.maps[action.payload.extra.dashboardId],\r\n                [action.payload.extra.viewIdx]: {\r\n                  geometries: action.payload.response,\r\n                  geometryDetailLevels: detailLevels\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\nexport default dashboardReducer;","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getDashboardsUrl, getDatasetDownloadUrl, getDatasetUrl, getGeometryUrl} from \"../../serverApi/urls\";\r\nimport {getCriteriaArrayFromObject} from \"../../utils/criteria\";\r\n\r\nexport const DASHBOARDS_DASHBOARD_FETCH = \"dashboards/dashboard/fetch\";\r\nexport const DASHBOARDS_DASHBOARDS_CLEAR = \"dashboards/dashboards/clear\";\r\nexport const DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET = \"dashboards/dataset/fetch/enableStatus/set\";\r\nexport const DASHBOARDS_DATASET_FETCH = \"dashboards/dataset/fetch\";\r\nexport const DASHBOARDS_DATASET_FILTER_SET = \"dashboards/dataset/filter/set\";\r\nexport const DASHBOARDS_MAP_GEOMETRIES_FETCH = \"dashboards/map/geometries/fetch\";\r\nexport const DASHBOARDS_DATASET_DOWNLOAD_SUBMIT = \"dashboards/map/geometries/fetch\";\r\n\r\nexport const fetchDashboardsDashboard = (dashboardId: number) => initRequest(\r\n  DASHBOARDS_DASHBOARD_FETCH,\r\n  getDashboardsUrl(dashboardId),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDashboard\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId\r\n  }\r\n);\r\n\r\nexport const clearDashboardsDashboards = () => ({\r\n  type: DASHBOARDS_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const setDashboardsDatasetFetchEnableStatus = (enabled: boolean) => ({\r\n  type: DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET,\r\n  payload: {\r\n    disabled: !enabled\r\n  }\r\n});\r\n\r\nexport const fetchDashboardsDataset = (dashboardId: number, nodeId: number, datasetId: string, criteria: any, requestIds: string[], worker: any) => initRequest(\r\n  DASHBOARDS_DATASET_FETCH,\r\n  getDatasetUrl(nodeId, datasetId),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDataset\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId,\r\n    requestIds: requestIds,\r\n    worker: worker\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const setDashboardsDatasetFilter = (dashboardId: number, viewIdx: string, dimension: string, value: string) => ({\r\n  type: DASHBOARDS_DATASET_FILTER_SET,\r\n  payload: {\r\n    dashboardId,\r\n    viewIdx,\r\n    dimension,\r\n    value\r\n  }\r\n});\r\n\r\nexport const fetchDashboardsMapGeometries = (dashboardId: number, viewIdx: string, idList: string[], t: any) => initRequest(\r\n  DASHBOARDS_MAP_GEOMETRIES_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dashboard.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    dashboardId: dashboardId,\r\n    viewIdx: viewIdx,\r\n    t: t\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const submitDashboardDatasetDownload = (nodeId: number, datasetId: string, viewTitle: string, criteria: any) => initRequest(\r\n  DASHBOARDS_DATASET_DOWNLOAD_SUBMIT,\r\n  getDatasetDownloadUrl(nodeId, datasetId, \"csv\"),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.downloadingDataset\")\r\n  }),\r\n  {\r\n    fileSave: {\r\n      name: `${viewTitle}.csv`,\r\n      type: \"text/plain;charset=utf-8\"\r\n    }\r\n  },\r\n  \"\",\r\n  (statusCode: number) => statusCode === 406\r\n);","import React, {Fragment, useEffect, useState} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {\r\n  DASHBOARD_ELEM_ENABLE_FILTERS_KEY,\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_SHOW_TITLE_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_TEXT,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  DASHBOARD_ELEM_WIDTH_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../utils/dashboards\";\r\nimport {getViewerIdxFromType} from \"../data-viewer\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport {exportChartJpeg} from \"../../utils/download\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {\r\n  DASHBOARD_VIEW_STATE_APPLY_FILTERS,\r\n  DASHBOARD_VIEW_STATE_ERROR,\r\n  DASHBOARD_VIEW_STATE_FETCHING\r\n} from \"../../state/dashboard/dashboardReducer\";\r\nimport {getDimensionLabelFromJsonStat, getDimensionValueLabelFromJsonStat} from \"../../utils/jsonStat\";\r\nimport DatasetFilters from \"../dataset-filters\";\r\nimport JsonStatTable from \"../table\";\r\nimport Map from \"../map\";\r\nimport Chart from \"../chart\";\r\nimport _ from \"lodash\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport \"./style.css\"\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport Card from \"@material-ui/core/Card\";\r\n\r\nconst styles = theme => ({\r\n  col: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\"\r\n  },\r\n  viewContainer: {\r\n    padding: 12,\r\n    height: 640,\r\n    width: \"100%\",\r\n    overflow: \"auto\"\r\n  },\r\n  viewCard: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    padding: 24\r\n  },\r\n  viewPlaceholder: {\r\n    height: \"100%\"\r\n  },\r\n  viewControllers: {\r\n    paddingBottom: 16\r\n  },\r\n  viewTitle: {\r\n    fontSize: 18,\r\n    marginBottom: 8\r\n  },\r\n  viewStaticFilters: {\r\n    marginBottom: 8\r\n  },\r\n  viewStaticFilter: {\r\n    display: \"inline-block\",\r\n    marginRight: 8\r\n  },\r\n  viewActiveFilters: {},\r\n  view: {\r\n    width: \"100%\",\r\n    position: \"relative\"\r\n  }\r\n});\r\n\r\nconst handleHeight = (uuid, viewIdx) => {\r\n  const controllersHeight = document.getElementById(`dashboard__view-container__${uuid}__controllers__${viewIdx}`)?.offsetHeight || 0;\r\n  const view = document.getElementById(`dashboard__view-container__${uuid}__view__${viewIdx}`);\r\n  if (view) {\r\n    view.setAttribute(\"style\", `height: calc(100% - ${controllersHeight}px)`);\r\n  }\r\n};\r\n\r\nfunction DashboardCol(props) {\r\n\r\n  const {\r\n    t,\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    dashboardId,\r\n    dashboard,\r\n    filterValue,\r\n    rowIdx,\r\n    colIdx,\r\n    dashboardElem,\r\n    jsonStat: externalJsonStat,\r\n    layout: externalLayoutObj,\r\n    filterTree: externalFilterTree,\r\n    map: externalMap,\r\n    onSelect,\r\n    fetchMapGeometries,\r\n    downloadCsv\r\n  } = props;\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [chartId] = useState(\"chart__\" + uuidv4());\r\n  const [mapId] = useState(\"map__\" + uuidv4());\r\n\r\n  const [jsonStat, setJsonStat] = useState(externalJsonStat);\r\n  const [layoutObj, setLayoutObj] = useState(externalLayoutObj);\r\n  const [filterTree, setFilterTree] = useState(externalFilterTree);\r\n  const [map, setMap] = useState(externalMap);\r\n\r\n  const [isFullscreen, setFullscreen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const func = () => handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n\r\n    window.addEventListener(\"resize\", func);\r\n    return () => window.removeEventListener(\"resize\", func)\r\n  }, [uuid, rowIdx, colIdx]);\r\n\r\n  useEffect(() => {\r\n    handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n  }, [uuid, rowIdx, colIdx, dashboardElem, jsonStat, layoutObj]);\r\n\r\n  useEffect(() => {\r\n    setJsonStat(prevJsonStat => {\r\n      if (_.isEqual(prevJsonStat, externalJsonStat)) {\r\n        return prevJsonStat\r\n      } else {\r\n        return externalJsonStat\r\n      }\r\n    });\r\n  }, [externalJsonStat]);\r\n\r\n  useEffect(() => {\r\n    setLayoutObj(prevLayoutObj => {\r\n      if (_.isEqual(prevLayoutObj, externalLayoutObj)) {\r\n        return prevLayoutObj\r\n      } else {\r\n        return externalLayoutObj\r\n      }\r\n    });\r\n  }, [externalLayoutObj]);\r\n\r\n  useEffect(() => {\r\n    setFilterTree(prevFilterTree => {\r\n      if (_.isEqual(prevFilterTree, externalFilterTree)) {\r\n        return prevFilterTree\r\n      } else {\r\n        return externalFilterTree\r\n      }\r\n    });\r\n  }, [externalFilterTree]);\r\n\r\n  useEffect(() => {\r\n    setMap(prevMaps => {\r\n      if (_.isEqual(prevMaps, externalMap)) {\r\n        return prevMaps\r\n      } else {\r\n        return externalMap\r\n      }\r\n    });\r\n  }, [externalMap]);\r\n\r\n  const handleFullscreen = () => {\r\n    !isFullscreen\r\n      ? document.getElementById(`dashboard__view-container__${uuid}__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`).classList.add(\"dashboard__view-container--fullscreen\")\r\n      : document.getElementById(`dashboard__view-container__${uuid}__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`).classList.remove(\"dashboard__view-container--fullscreen\");\r\n    handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n\r\n    setFullscreen(!isFullscreen);\r\n  };\r\n\r\n  const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n\r\n  const view = _.cloneDeep((dashboard.views || {})[dashboardElem[DASHBOARD_ELEM_VALUE_KEY]]);\r\n  const viewerIdx = view ? getViewerIdxFromType(view.defaultView) : null;\r\n\r\n  return (\r\n    <div className={classes.col} style={{width: `${dashboardElem[DASHBOARD_ELEM_WIDTH_KEY]}%`}}>\r\n      <div className={classes.viewContainer}>\r\n        <Card\r\n          id={`dashboard__view-container__${uuid}__${viewIdx}`}\r\n          className={classes.viewCard}\r\n        >\r\n          {(dashboardElem[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW && jsonStat && layoutObj) && (\r\n            <div style={{float: \"right\"}}>\r\n              <Tooltip title={t(\"components.dashboard.actions.download\")}>\r\n                <IconButton\r\n                  color=\"primary\"\r\n                  onClick={() => {\r\n                    if (viewerIdx === 0) {\r\n                      downloadCsv(view.nodeId, view.datasetId, localizeI18nObj(view.title, defaultLanguage, languages), view.criteria);\r\n                    } else if (viewerIdx === 1) {\r\n                      window.LMap.exportPng(mapId, `${localizeI18nObj(view.title, defaultLanguage, languages)}.png`)\r\n                    } else {\r\n                      exportChartJpeg(chartId, `${localizeI18nObj(view.title, defaultLanguage, languages)}.jpeg`);\r\n                    }\r\n                  }}\r\n                >\r\n                  <GetAppIcon/>\r\n                </IconButton>\r\n              </Tooltip>\r\n            </div>\r\n          )}\r\n          {(dashboardElem[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_TEXT || (jsonStat && layoutObj)) && (\r\n            <div style={{float: \"right\"}}>\r\n              <Tooltip\r\n                title={isFullscreen\r\n                  ? t(\"components.dashboard.actions.fullscreen.exit\")\r\n                  : t(\"components.dashboard.actions.fullscreen.enter\")\r\n                }\r\n              >\r\n                <IconButton\r\n                  color=\"primary\"\r\n                  onClick={handleFullscreen}\r\n                >\r\n                  {isFullscreen ? <FullscreenExitIcon/> : <FullscreenIcon/>}\r\n                </IconButton>\r\n              </Tooltip>\r\n            </div>\r\n          )}\r\n          {(() => {\r\n            if (dashboardElem[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_TEXT) {\r\n              return (\r\n                <SanitizedHTML\r\n                  html={localizeI18nObj(dashboardElem[DASHBOARD_ELEM_VALUE_KEY], defaultLanguage, languages)}/>\r\n              )\r\n\r\n            } else if (view === null || view === undefined) {\r\n              return (\r\n                <div className={classes.viewPlaceholder}>\r\n                  <CustomEmpty\r\n                    text={t(\"components.dashboard.missingView\")}\r\n                  />\r\n                </div>\r\n              )\r\n\r\n            } else if (jsonStat !== null && jsonStat !== undefined) {\r\n\r\n              if (jsonStat === DASHBOARD_VIEW_STATE_ERROR) {\r\n                return (\r\n                  <div className={classes.viewPlaceholder}>\r\n                    <CustomEmpty\r\n                      text={t(\"components.dashboard.fetchingDatasetError\")}\r\n                    />\r\n                  </div>\r\n                )\r\n\r\n              } else if (jsonStat === DASHBOARD_VIEW_STATE_APPLY_FILTERS) {\r\n                return (\r\n                  <div className={classes.viewPlaceholder}>\r\n                    <CustomEmpty\r\n                      text={t(\"components.dashboard.applyFilters\")}\r\n                    />\r\n                  </div>\r\n                )\r\n\r\n              } else if (jsonStat === DASHBOARD_VIEW_STATE_FETCHING) {\r\n                return (\r\n                  <div className={classes.viewPlaceholder}>\r\n                    <CustomEmpty\r\n                      text={t(\"components.dashboard.fetching\") + \"...\"}\r\n                      image={<CircularProgress/>}\r\n                    />\r\n                  </div>\r\n                )\r\n\r\n              } else if (jsonStat === \"\") {\r\n                return (\r\n                  <div className={classes.viewPlaceholder}>\r\n                    <CustomEmpty\r\n                      text={t(\"components.dashboard.emptyView\")}\r\n                    />\r\n                  </div>\r\n                )\r\n\r\n              } else if (layoutObj) {\r\n\r\n                const layout = {...layoutObj.layout};\r\n\r\n                const filter = dashboardElem[DASHBOARD_ELEM_FILTER_DIMENSION_KEY];\r\n                if (filter && filterValue) {\r\n                  if ((layout.filters || []).includes(filter)) {\r\n                    layout.filtersValue = {\r\n                      ...layout.filtersValue,\r\n                      [filter]: filterValue\r\n                    };\r\n                  } else if ((layout.primaryDim || []).includes(filter)) {\r\n                    layout.primaryDimValues = {\r\n                      ...layout.primaryDimValues,\r\n                      [filter]: filterValue\r\n                    };\r\n                  } else if ((layout.secondaryDim || []).includes(filter)) {\r\n                    layout.secondaryDimValues = {\r\n                      ...layout.secondaryDimValues,\r\n                      [filter]: filterValue\r\n                    };\r\n                  }\r\n                }\r\n\r\n                const staticFilters = [];\r\n                layout.filters.forEach(dim => {\r\n                  if (!dashboardElem[DASHBOARD_ELEM_ENABLE_FILTERS_KEY] || jsonStat.size[jsonStat.id.indexOf(dim)] === 1) {\r\n                    const value = !dashboardElem[DASHBOARD_ELEM_ENABLE_FILTERS_KEY]\r\n                      ? layout.filtersValue[dim]\r\n                      : jsonStat.dimension[dim].category.index[0];\r\n                    staticFilters.push({\r\n                      dim: dim,\r\n                      dimLabel: getDimensionLabelFromJsonStat(jsonStat, dim),\r\n                      value: value,\r\n                      valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, dim, value)\r\n                    });\r\n                  }\r\n                });\r\n\r\n                return (\r\n                  <Fragment>\r\n                    <div\r\n                      id={`dashboard__view-container__${uuid}__controllers__${viewIdx}`}\r\n                      className={classes.viewControllers}\r\n                    >\r\n                      {dashboardElem[DASHBOARD_ELEM_SHOW_TITLE_KEY] && (\r\n                        <div className={classes.viewTitle}>\r\n                          {localizeI18nObj(view.title, defaultLanguage, languages)}\r\n                        </div>\r\n                      )}\r\n                      <div className={classes.viewStaticFilters}>\r\n                        {staticFilters.map(({dim, dimLabel, value, valueLabel}, idx) =>\r\n                          <div key={idx} className={classes.viewStaticFilter}>\r\n                            <b>{(dimLabel || dim)}</b>: <i>{(valueLabel || value)}</i>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      {dashboardElem[DASHBOARD_ELEM_ENABLE_FILTERS_KEY] && filterTree && (\r\n                        <div className={classes.viewActiveFilters}>\r\n                          <DatasetFilters\r\n                            jsonStat={jsonStat}\r\n                            layout={layout}\r\n                            filterTree={filterTree}\r\n                            onSelect={(dimension, value) => onSelect(dashboardId, viewIdx, dimension, value)}\r\n                          />\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div\r\n                      id={`dashboard__view-container__${uuid}__view__${viewIdx}`}\r\n                      className={classes.view}\r\n                    >\r\n                      {(() => {\r\n                        const decimalSeparator = \",\"; // TODO\r\n                        const decimalPlaces = 2; // TODO\r\n\r\n                        if (viewerIdx === 0) {\r\n                          return (\r\n                            <JsonStatTable\r\n                              jsonStat={jsonStat}\r\n                              layout={layout}\r\n                              isFullscreen={isFullscreen}\r\n                              labelFormat={view.layouts.labelFormat}\r\n                              decimalSeparator={decimalSeparator}\r\n                              decimalPlaces={decimalPlaces}\r\n                              emptyChar={layoutObj.tableEmptyChar}\r\n                              hideSpinner\r\n                              disableMouseWheel\r\n                            />\r\n                          )\r\n                        } else if (viewerIdx === 1) {\r\n                          return (\r\n                            <Map\r\n                              mapId={mapId}\r\n                              jsonStat={jsonStat}\r\n                              layout={layout}\r\n                              detailLevel={layoutObj.mapDetailLevel}\r\n                              onGeometryFetch={idList => fetchMapGeometries(dashboardId, viewIdx, idList, t)}\r\n                              geometries={map?.geometries || null}\r\n                              geometryDetailLevels={map?.geometryDetailLevels || null}\r\n                              hideSpinner\r\n                            />\r\n                          )\r\n                        } else {\r\n                          return (\r\n                            <Chart\r\n                              chartId={chartId}\r\n                              type={view.defaultView}\r\n                              jsonStat={jsonStat}\r\n                              layout={layout}\r\n                              labelFormat={view.layouts.labelFormat}\r\n                              decimalSeparator={decimalSeparator}\r\n                              decimalPlaces={decimalPlaces}\r\n                              stacked={layoutObj.chartStacked}\r\n                              legendPosition={layoutObj.chartLegendPosition}\r\n                              colors={layoutObj.chartColors}\r\n                              disableMouseWheel\r\n                            />\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </div>\r\n                  </Fragment>\r\n                )\r\n              } else {\r\n                return <span/>\r\n              }\r\n            } else {\r\n              return <span/>\r\n            }\r\n          })()}\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nexport default compose(\r\n  withTranslation(),\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(DashboardCol);","import React from \"react\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {DASHBOARD_ELEM_FILTER_DIMENSION_KEY, getViewIdxFromRowAndCol} from \"../../utils/dashboards\";\r\nimport DashboardCol from \"./DashboardCol\";\r\n\r\nconst styles = theme => ({\r\n  row: {\r\n    width: \"100%\",\r\n    marginBottom: 8\r\n  }\r\n});\r\n\r\nconst DashboardRow = ({\r\n                        classes,\r\n                        dashboardId,\r\n                        dashboard,\r\n                        filterValue,\r\n                        row,\r\n                        rowIdx,\r\n                        jsonStats,\r\n                        layouts,\r\n                        filterTrees,\r\n                        onSelect,\r\n                        maps,\r\n                        fetchMapGeometries,\r\n                        downloadCsv\r\n                      }) =>\r\n\r\n  <div className={classes.row}>\r\n    {row.map((col, idx) => {\r\n      const viewIdx = getViewIdxFromRowAndCol(rowIdx, idx);\r\n      return (\r\n        <DashboardCol\r\n          key={idx}\r\n          dashboardId={dashboardId}\r\n          dashboard={dashboard}\r\n          filterValue={col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] ? filterValue : null}\r\n          rowIdx={rowIdx}\r\n          colIdx={idx}\r\n          dashboardElem={col}\r\n          jsonStat={jsonStats?.[viewIdx]}\r\n          layout={layouts?.[viewIdx]}\r\n          filterTree={filterTrees?.[viewIdx]}\r\n          map={maps?.[viewIdx]}\r\n          onSelect={onSelect}\r\n          fetchMapGeometries={fetchMapGeometries}\r\n          downloadCsv={downloadCsv}\r\n        />\r\n      )\r\n    })}\r\n  </div>;\r\n\r\nexport default withStyles(styles)(DashboardRow);","import React, {Fragment, useEffect, useState} from \"react\";\r\nimport _ from \"lodash\";\r\nimport \"./style.css\"\r\nimport DashboardRow from \"./DashboardRow\";\r\n\r\nfunction Dashboard(props) {\r\n  const {\r\n    dashboardId,\r\n    dashboard: externalDashboard,\r\n    filterValue,\r\n    jsonStats,\r\n    layouts,\r\n    filterTrees,\r\n    onFilterSet,\r\n    maps,\r\n    fetchMapGeometries,\r\n    downloadCsv\r\n  } = props;\r\n\r\n  const [dashboard, setDashboard] = useState(externalDashboard);\r\n\r\n  useEffect(() => {\r\n    setDashboard(prevLayoutObj => {\r\n      if (_.isEqual(prevLayoutObj, externalDashboard)) {\r\n        return prevLayoutObj\r\n      } else {\r\n        return externalDashboard\r\n      }\r\n    });\r\n  }, [externalDashboard]);\r\n\r\n  return (\r\n    <Fragment>\r\n      {(dashboard.dashboardConfig || []).map((row, idx) =>\r\n        <DashboardRow\r\n          key={idx}\r\n          dashboardId={dashboardId}\r\n          dashboard={dashboard}\r\n          filterValue={filterValue}\r\n          row={row}\r\n          rowIdx={idx}\r\n          jsonStats={jsonStats}\r\n          layouts={layouts}\r\n          filterTrees={filterTrees}\r\n          maps={maps}\r\n          onSelect={onFilterSet}\r\n          fetchMapGeometries={fetchMapGeometries}\r\n          downloadCsv={downloadCsv}\r\n        />\r\n      )}\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default Dashboard;","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport {\r\n  changeOtherConfigDashboard,\r\n  clearOtherConfigDashboards,\r\n  clearOtherConfigDashboardsDataset,\r\n  clearOtherConfigDashboardViews,\r\n  closeOtherConfigDashboard,\r\n  createOtherConfigDashboard,\r\n  deleteOtherConfigDashboard,\r\n  fetchOtherConfigDashboards,\r\n  fetchOtherConfigDashboardsDataset,\r\n  fetchOtherConfigDashboardsMapGeometries,\r\n  fetchOtherConfigDashboardViews,\r\n  hideOtherConfigDashboard,\r\n  setOtherConfigDashboardsDatasetFilter,\r\n  submitOtherConfigDashboardCreate,\r\n  submitOtherConfigDashboardUpdate,\r\n  updateOtherConfigDashboard\r\n} from \"../../../state/otherConfig/otherConfigActions\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {goToDashboard} from \"../../../links\";\r\nimport DashboardBuilder from \"../../dashboard-builder\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj, validateI18nObj} from \"../../../utils/i18n\";\r\nimport Call from \"../../../hocs/call\";\r\nimport Dashboard from \"../../dashboard\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../../utils/dashboards\";\r\nimport _ from \"lodash\"\r\nimport {MTableToolbar} from \"material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  previewDialog: {\r\n    \"& .MuiDialogTitle-root, & .MuiDialogContent-root, & .MuiDialogActions-root\": {\r\n      background: \"#f5f5f5\"\r\n    }\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  needDashboards: state.otherConfig.needDashboards,\r\n  dashboards: state.otherConfig.dashboards,\r\n  dashboard: state.otherConfig.dashboard,\r\n  dashboardViews: state.otherConfig.dashboardViews,\r\n  dashboardJsonStats: state.otherConfig.dashboardJsonStats,\r\n  dashboardLayouts: state.otherConfig.dashboardLayouts,\r\n  dashboardFilterTrees: state.otherConfig.dashboardFilterTrees,\r\n  dashboardMaps: state.otherConfig.dashboardMaps\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboards: () => dispatch(fetchOtherConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearOtherConfigDashboards()),\r\n  createDashboard: dashboard => dispatch(createOtherConfigDashboard(dashboard)),\r\n  updateDashboard: dashboardId => dispatch(updateOtherConfigDashboard(dashboardId)),\r\n  changeDashboard: dashboard => dispatch(changeOtherConfigDashboard(dashboard)),\r\n  submitDashboardCreate: dashboard => dispatch(submitOtherConfigDashboardCreate(dashboard)),\r\n  submitDashboardUpdate: (dashboardId, dashboard) => dispatch(submitOtherConfigDashboardUpdate(dashboardId, dashboard)),\r\n  deleteDashboard: dashboardId => dispatch(deleteOtherConfigDashboard(dashboardId)),\r\n  hideDashboard: () => dispatch(hideOtherConfigDashboard()),\r\n  fetchViews: () => dispatch(fetchOtherConfigDashboardViews()),\r\n  clearViews: () => dispatch(clearOtherConfigDashboardViews()),\r\n  onClose: () => dispatch(closeOtherConfigDashboard()),\r\n  fetchDataset: (nodeId, datasetId, criteria, requestIds) => dispatch(fetchOtherConfigDashboardsDataset(nodeId, datasetId, criteria, requestIds)),\r\n  onFilterSet: (dashboardId, viewIdx, dimension, value) => dispatch(setOtherConfigDashboardsDatasetFilter(viewIdx, dimension, value)),\r\n  fetchMapGeometries: (dashboardId, viewIdx, idList, t) => dispatch(fetchOtherConfigDashboardsMapGeometries(viewIdx, idList, t)),\r\n  clearDatasets: () => dispatch(clearOtherConfigDashboardsDataset()),\r\n});\r\n\r\nconst getStaticDashboard = dashboard => {\r\n  if (!dashboard) {\r\n    return null\r\n  }\r\n\r\n  const staticDashboard = _.cloneDeep(dashboard);\r\n  staticDashboard.dashboardConfig.forEach(row => {\r\n    row.forEach(col => {\r\n      col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] = null\r\n    });\r\n  });\r\n\r\n  return staticDashboard\r\n};\r\n\r\nconst initialDashboard = {\r\n  title: {},\r\n  dashboardConfig: [],\r\n  viewIds: [],\r\n  views: {},\r\n  filterLevels: {}\r\n};\r\n\r\nconst UserDashboardsSettingsForm = ({\r\n                                      classes,\r\n                                      defaultLanguage,\r\n                                      languages,\r\n                                      nodes,\r\n                                      needDashboards,\r\n                                      dashboards,\r\n                                      dashboard,\r\n                                      fetchDashboards,\r\n                                      clearDashboards,\r\n                                      createDashboard,\r\n                                      updateDashboard,\r\n                                      changeDashboard,\r\n                                      submitDashboardCreate,\r\n                                      submitDashboardUpdate,\r\n                                      deleteDashboard,\r\n                                      hideDashboard,\r\n                                      dashboardViews,\r\n                                      fetchViews,\r\n                                      clearViews,\r\n                                      onClose,\r\n                                      dashboardJsonStats,\r\n                                      dashboardLayouts,\r\n                                      dashboardFilterTrees,\r\n                                      onFilterSet,\r\n                                      dashboardMaps,\r\n                                      fetchDataset,\r\n                                      fetchMapGeometries,\r\n                                      clearDatasets,\r\n                                      onDashboardsClose\r\n                                    }, ref) => {\r\n\r\n  const [deleteDashboardId, setDeleteDashboardId] = useState(null);\r\n  const [updateDashboardId, setUpdateDashboardId] = useState(null);\r\n\r\n  const [isPreviewVisible, setPreviewVisibility] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    fetchDashboards();\r\n  }, [fetchDashboards]);\r\n\r\n  useEffect(() => {\r\n    if (needDashboards) {\r\n      fetchDashboards();\r\n    }\r\n  }, [dashboards, needDashboards, fetchDashboards]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearDashboards();\r\n      onClose();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const handleFetchDatasets = () => {\r\n\r\n    const requests = [];\r\n    dashboard.dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n\r\n          const view = dashboard.views[col[DASHBOARD_ELEM_VALUE_KEY]];\r\n\r\n          let newCriteria = view.criteria;\r\n\r\n          const request = requests.find(({nodeId, datasetId, criteria}) => {\r\n            return (\r\n              nodeId === view.nodeId &&\r\n              datasetId === view.datasetId &&\r\n              _.isEqual(criteria, newCriteria)\r\n            )\r\n          });\r\n\r\n          if (request === undefined) {\r\n            requests.push({\r\n              nodeId: view.nodeId,\r\n              datasetId: view.datasetId.split(\"+\").join(\",\"),\r\n              criteria: newCriteria,\r\n              requestIds: [getViewIdxFromRowAndCol(rowIdx, colIdx)]\r\n            });\r\n          } else {\r\n            request.requestIds.push(getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n          }\r\n        }\r\n      });\r\n    });\r\n    requests.forEach(({nodeId, datasetId, criteria, requestIds}) => fetchDataset(nodeId, datasetId, criteria, requestIds));\r\n  };\r\n\r\n  return dashboards && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n          Toolbar: props =>\r\n            <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n              <Grid item>\r\n                <MTableToolbar {...props} />\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  size=\"small\"\r\n                  startIcon={<AddIcon/>}\r\n                  onClick={() => createDashboard(initialDashboard)}\r\n                >\r\n                  {t(\"scenes.dashboardsSettings.createDashboard\")}\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.dashboardsSettings.table.columns.dashboardTitle\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          }\r\n        ]}\r\n        data={dashboards}\r\n        actions={[\r\n          {\r\n            icon: VisibilityIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.viewDashboard\"),\r\n            onClick: (_, {dashboardId}) => window.location.href.toLowerCase().includes(`/dashboards/${dashboardId}`)\r\n              ? onDashboardsClose()\r\n              : goToDashboard(dashboardId)\r\n          },\r\n          {\r\n            icon: EditIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.editDashboard\"),\r\n            onClick: (_, {dashboardId}) => {\r\n              updateDashboard(dashboardId);\r\n              setUpdateDashboardId(dashboardId);\r\n            }\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.deleteDashboard\"),\r\n            onClick: (_, {dashboardId}) => setDeleteDashboardId(dashboardId)\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 1,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteDashboardId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.dashboardsSettings.modals.deleteDashboard.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.dashboardsSettings.modals.deleteDashboard.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            autoFocus\r\n            onClick={() => setDeleteDashboardId(null)}\r\n          >\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button\r\n            onClick={() => {\r\n              deleteDashboard(deleteDashboardId);\r\n              setDeleteDashboardId(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={dashboard !== null}\r\n        fullScreen\r\n        onClose={hideDashboard}\r\n      >\r\n        <DialogTitle>\r\n          {updateDashboardId\r\n            ? t(\"scenes.dashboardsSettings.modals.updateDashboard.title\")\r\n            : t(\"scenes.dashboardsSettings.modals.createDashboard.title\")\r\n          }\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <DashboardBuilder\r\n            nodes={nodes}\r\n            dashboard={dashboard}\r\n            onChange={changeDashboard}\r\n            views={dashboardViews}\r\n            fetchViews={fetchViews}\r\n            onViewsHide={clearViews}\r\n            jsonStats={dashboardJsonStats}\r\n            fetchDataset={fetchDataset}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              hideDashboard();\r\n              setUpdateDashboardId(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n          <Button\r\n            onClick={() => setPreviewVisibility(true)}\r\n          >\r\n            {t(\"commons.confirm.preview\")}\r\n          </Button>\r\n          <Button\r\n            onClick={updateDashboardId\r\n              ? () => submitDashboardUpdate(updateDashboardId, dashboard)\r\n              : () => {\r\n                submitDashboardCreate(dashboard);\r\n                hideDashboard();\r\n              }\r\n            }\r\n            disabled={dashboard && !validateI18nObj(dashboard.title)}\r\n          >\r\n            {t(\"commons.confirm.save\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isPreviewVisible}\r\n        fullScreen\r\n        onClose={() => setPreviewVisibility(false)}\r\n        className={classes.previewDialog}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.preview.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Call cb={handleFetchDatasets}>\r\n            <Dashboard\r\n              dashboard={getStaticDashboard(dashboard)}\r\n              jsonStats={dashboardJsonStats}\r\n              layouts={dashboardLayouts}\r\n              filterTrees={dashboardFilterTrees}\r\n              onFilterSet={onFilterSet}\r\n              maps={dashboardMaps}\r\n              fetchMapGeometries={fetchMapGeometries}\r\n            />\r\n          </Call>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              setPreviewVisibility(false);\r\n              clearDatasets();\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserDashboardsSettingsForm);","import React, {Fragment} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport ViewsSettingsForm from \"./views-settings-form\";\r\nimport WorkIcon from '@material-ui/icons/Work';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {canDisplayUserViews, canManagePersonalDashboards} from \"../../utils/user\";\r\nimport UserDashboardsSettingsForm from \"./user-dashboards-settings-form\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  option: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nclass OtherSettingsSelect extends React.Component {\r\n\r\n  state = {\r\n    isViewsOpen: false,\r\n    isDashboardsOpen: false,\r\n    viewsSettigsRef: React.createRef(),\r\n    dashboardsSettingsRef: React.createRef()\r\n  };\r\n\r\n  onViewsOpen = () => this.setState({\r\n    ...this.state,\r\n    isViewsOpen: true\r\n  });\r\n\r\n  onViewsClose = () => this.setState({\r\n    ...this.state,\r\n    isViewsOpen: false\r\n  });\r\n\r\n  onDashboardsOpen = () => this.setState({\r\n    ...this.state,\r\n    isDashboardsOpen: true\r\n  });\r\n\r\n  onDashboardsClose = () => this.setState({\r\n    ...this.state,\r\n    isDashboardsOpen: false\r\n  });\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      nodes,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {\r\n      isViewsOpen,\r\n      isDashboardsOpen,\r\n      viewsSettigsRef,\r\n      dashboardsSettingsRef\r\n    } = this.state;\r\n\r\n    return (\r\n      <Fragment>\r\n        <ButtonSelect value=\"\" icon={<WorkIcon/>}>\r\n          {canDisplayUserViews(user) && (\r\n            <div onClick={this.onViewsOpen} className={classes.option}>\r\n              {t(\"components.header.otherSettings.views\")}\r\n            </div>\r\n          )}\r\n          {canManagePersonalDashboards(user) && (\r\n            <div onClick={this.onDashboardsOpen} className={classes.option}>\r\n              {t(\"components.header.otherSettings.dashboards\")}\r\n            </div>\r\n          )}\r\n        </ButtonSelect>\r\n        <SettingsDialog\r\n          title={t(\"scenes.viewsSettings.title\")}\r\n          open={isViewsOpen}\r\n          onClose={() => {\r\n            if (viewsSettigsRef.current) {\r\n              viewsSettigsRef.current.cancel(() => this.onViewsClose());\r\n            } else {\r\n              this.onViewsClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <ViewsSettingsForm\r\n            ref={viewsSettigsRef}\r\n            nodes={nodes}\r\n            onViewsClose={this.onViewsClose}\r\n          />\r\n        </SettingsDialog>\r\n        <SettingsDialog\r\n          title={t(\"scenes.dashboardsSettings.title\")}\r\n          open={isDashboardsOpen}\r\n          onClose={() => {\r\n            if (dashboardsSettingsRef.current) {\r\n              dashboardsSettingsRef.current.cancel(() => this.onDashboardsClose());\r\n            } else {\r\n              this.onDashboardsClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <UserDashboardsSettingsForm\r\n            ref={dashboardsSettingsRef}\r\n            nodes={nodes}\r\n            onDashboardsClose={this.onDashboardsClose}\r\n          />\r\n        </SettingsDialog>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps),\r\n  withTranslation()\r\n)(OtherSettingsSelect);","import React from 'react';\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport {useLocation} from \"react-router\";\r\nimport {backupDatasetState} from \"../../state/dataset/datasetActions\";\r\n\r\nconst mapStateToProps = state => ({\r\n  language: state.app.language\r\n});\r\nconst mapDispatchToProps = dispatch => ({\r\n  onDatasetBackup: () => dispatch(backupDatasetState())\r\n});\r\n\r\nconst AppLanguageSelect = ({language, onDatasetBackup}) => {\r\n\r\n  const location = useLocation();\r\n\r\n  return (\r\n    <I18nInputAdornmentSelect\r\n      value={language}\r\n      onChange={val => {\r\n        if (val !== language) {\r\n          onDatasetBackup();\r\n\r\n          const url = location.pathname.includes(language)\r\n            ? \"./#\" + location.pathname.replace(language, val) + location.search\r\n            : `./#/${val}`;\r\n          window.open(url, \"_self\");\r\n        }\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AppLanguageSelect);","import {Link, withStyles} from \"@material-ui/core\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport React, {Component} from \"react\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport UserSelect from \"../user-select\";\r\nimport Drawer from \"@material-ui/core/Drawer\";\r\nimport ChevronLeftIcon from \"@material-ui/icons/ChevronLeft\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport CategoriesTree from \"../categories-tree\";\r\nimport {withRouter} from \"react-router\";\r\nimport SettingsSelect from \"../settings-select\";\r\nimport SearchDialog from \"../search-dialog\";\r\nimport ButtonSelect from \"../button-select\";\r\nimport {goToDatasetsSearch, goToHome, goToNode, goToNodeDashboards} from \"../../links\";\r\nimport HomeIcon from '@material-ui/icons/Home';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport OtherSettingsSelect from \"../other-settings-select\";\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport {\r\n  canClearServerCache,\r\n  canDisplayAppSettingsForm,\r\n  canDisplayNodesSettingsForm,\r\n  canDisplayUsersSettingsForm,\r\n  canDisplayUserViews,\r\n  canGetQueryLog,\r\n  canManagePersonalDashboards\r\n} from \"../../utils/user\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport AppLanguageSelect from \"../app-language-select\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"fixed\",\r\n    width: \"100%\",\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n    display: 'none',\r\n    [theme.breakpoints.up('sm')]: {\r\n      display: 'block',\r\n    },\r\n    color: \"white\"\r\n  },\r\n  leftToolbar: {\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  leftContainer: {\r\n    width: 400\r\n  },\r\n  rightContainer: {\r\n    width: 400\r\n  },\r\n  drawer: {\r\n    minWidth: 448\r\n  },\r\n  drawerHeader: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    padding: theme.spacing(0, 1),\r\n    ...theme.mixins.toolbar,\r\n    justifyContent: 'flex-end',\r\n  },\r\n  drawerHeaderTitle: {\r\n    position: \"absolute\",\r\n    left: theme.spacing(2),\r\n  },\r\n  drawerCategories: {\r\n    margin: theme.spacing(2)\r\n  },\r\n  drawerCategoriesTitle: {\r\n    marginBottom: theme.spacing(2)\r\n  },\r\n  goToHome: {\r\n    margin: theme.spacing(2, 2, 0, 2)\r\n  },\r\n  centerContainer: {\r\n    width: \"calc(100% - 800px)\",\r\n    textAlign: \"center\"\r\n  },\r\n  sistanLogo: {\r\n    height: 32,\r\n    transform: \"translateY(3px)\"\r\n  }\r\n});\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL,\r\n  user: state.user,\r\n});\r\n\r\nclass NodeHeader extends Component {\r\n\r\n  state = {\r\n    isDrawerOpen: this.props.defaultTreeOpen || false\r\n  };\r\n\r\n  onDrawerOpen = () => {\r\n    this.setState({\r\n      isDrawerOpen: true\r\n    });\r\n  };\r\n\r\n  onDrawerClose = () => {\r\n    this.setState({\r\n      isDrawerOpen: false\r\n    });\r\n  };\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      selectedCategoryPath,\r\n      shortName,\r\n      title,\r\n      defaultAppConfigOpen,\r\n      defaultUsersConfigOpen,\r\n      defaultNodesConfigOpen,\r\n      defaultNodeConfigOpen,\r\n      nodes,\r\n      noNode,\r\n      catalog,\r\n      node,\r\n      query,\r\n      hub,\r\n      baseURL,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isDrawerOpen} = this.state;\r\n\r\n    return (\r\n      <div className={classes.root} id=\"node-header\">\r\n        <AppBar position=\"static\" color=\"primary\">\r\n          <Grid container justify=\"space-between\" alignItems=\"center\">\r\n            <Grid item className={classes.leftContainer}>\r\n              {!noNode && (\r\n                <Toolbar className={classes.leftToolbar}>\r\n                  <Grid container spacing={1} alignItems=\"center\">\r\n                    <Grid item>\r\n                      <IconButton\r\n                        className={classes.menuButton}\r\n                        edge=\"start\"\r\n                        color=\"inherit\"\r\n                        onClick={this.onDrawerOpen}\r\n                      >\r\n                        <MenuIcon/>\r\n                      </IconButton>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <div id=\"node-selector\">\r\n                        <ButtonSelect\r\n                          value={\r\n                            <Typography variant=\"h6\" color=\"inherit\">\r\n                              {shortName}\r\n                            </Typography>\r\n                          }\r\n                          onChange={code => goToNode(code.toLowerCase())}\r\n                        >\r\n                          {nodes.sort((a, b) => a.order - b.order).map(({code, name}, i) =>\r\n                              <span key={i} data-value={code}>\r\n                            {code} - {name}\r\n                          </span>\r\n                          )}\r\n                        </ButtonSelect>\r\n                      </div>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Toolbar>\r\n              )}\r\n            </Grid>\r\n            <Grid item className={classes.centerContainer}>\r\n              <Link onClick={goToHome} style={{cursor: \"pointer\"}}>\r\n                <Grid container spacing={2} alignItems=\"center\" justify=\"center\">\r\n                  {hub.logoURL && (\r\n                    <Grid item>\r\n                      <img src={baseURL + hub.logoURL} alt={hub.name}\r\n                           className={classes.sistanLogo}/>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid item>\r\n                    <Typography variant=\"h6\" color=\"secondary\">\r\n                      {hub.name}\r\n                    </Typography>\r\n                  </Grid>\r\n                </Grid>\r\n              </Link>\r\n            </Grid>\r\n            <Grid item className={classes.rightContainer}>\r\n              <Toolbar>\r\n                <Grid container justify=\"flex-end\" alignItems=\"center\" spacing={1}>\r\n                  {!noNode && (\r\n                    <div>\r\n                      <SearchDialog\r\n                        query={query}\r\n                        modalWidth={320}\r\n                        dialogTop={56}\r\n                        onSubmit={value => goToDatasetsSearch(node.code, value)}\r\n                      />\r\n                    </div>\r\n                  )}\r\n                  <Grid item id=\"language-btn\">\r\n                    <AppLanguageSelect/>\r\n                  </Grid>\r\n                  {!noNode && node && node.dashboards && node.dashboards.length > 0 && (\r\n                    <Grid item id=\"dashboards-btn\">\r\n                      <IconButton onClick={() => goToNodeDashboards(node.code)} color=\"inherit\">\r\n                        <DashboardIcon/>\r\n                      </IconButton>\r\n                    </Grid>\r\n                  )}\r\n                  {(canDisplayAppSettingsForm(user) ||\r\n                    canDisplayUsersSettingsForm(user) ||\r\n                    canDisplayNodesSettingsForm(user) ||\r\n                    canGetQueryLog(user) ||\r\n                    canClearServerCache(user)\r\n                  ) && (\r\n                    <Grid item id=\"admin-settings-btn\">\r\n                      <SettingsSelect\r\n                        defaultAppOpen={defaultAppConfigOpen}\r\n                        defaultNodesOpen={defaultNodesConfigOpen}\r\n                        defaultUsersOpen={defaultUsersConfigOpen}\r\n                        defaultNodeOpen={defaultNodeConfigOpen}\r\n                        nodes={nodes}\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                  {(canDisplayUserViews(user) || canManagePersonalDashboards(user)) && (\r\n                    <Grid item id=\"other-settings-btn\">\r\n                      <OtherSettingsSelect nodes={nodes}/>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid item id=\"user-settings-btn\">\r\n                    <UserSelect/>\r\n                  </Grid>\r\n                </Grid>\r\n              </Toolbar>\r\n            </Grid>\r\n          </Grid>\r\n        </AppBar>\r\n        {!noNode && (\r\n          <Drawer\r\n            anchor=\"left\"\r\n            open={isDrawerOpen}\r\n            classes={{\r\n              paper: classes.drawer\r\n            }}\r\n            onClose={this.onDrawerClose}\r\n          >\r\n            <div className={classes.drawerHeader}>\r\n              <Typography variant=\"h6\" className={classes.drawerHeaderTitle}>\r\n                {title}\r\n              </Typography>\r\n              <IconButton onClick={this.onDrawerClose}>\r\n                <ChevronLeftIcon/>\r\n              </IconButton>\r\n            </div>\r\n            <Divider/>\r\n            <div className={classes.goToHome}>\r\n              <Link underline=\"none\" onClick={() => goToNode(node.code)}\r\n                    style={{cursor: \"pointer\"}}>\r\n                <Grid container spacing={1}>\r\n                  <Grid item>\r\n                    <HomeIcon/>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <Typography>\r\n                      {t(\"components.header.drawer.backToNodeHome\")}\r\n                    </Typography>\r\n                  </Grid>\r\n                </Grid>\r\n              </Link>\r\n            </div>\r\n            {catalog && (\r\n              <div className={classes.drawerCategories}>\r\n                <div className={classes.drawerCategoriesTitle}>\r\n                  <Typography>\r\n                    {t(\"components.header.drawer.categoriesTitle\")}\r\n                  </Typography>\r\n                </div>\r\n                <CategoriesTree selectedCategoryPath={selectedCategoryPath} catalog={catalog}\r\n                                node={node}\r\n                                onClose={this.onDrawerClose}/>\r\n              </div>\r\n            )}\r\n          </Drawer>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps),\r\n  withRouter\r\n)(NodeHeader);","import Grid from \"@material-ui/core/Grid\";\r\nimport React from \"react\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  image: {\r\n    height: 20,\r\n    margin: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst Footer = ({classes, textOnly}) =>\r\n  <Grid container type=\"flex\" justify=\"center\" alignItems=\"center\">\r\n    <Grid item>\r\n      {textOnly\r\n        ? <span>ISTAT&nbsp;</span>\r\n        : (\r\n          <img src=\"images/istat/istat-logo-gray.png\" className={classes.image} alt=\"istat logo\"/>\r\n        )}\r\n    </Grid>\r\n    <Grid item>\r\n      Data Browser v1.0.1\r\n    </Grid>\r\n  </Grid>;\r\n\r\nexport default withStyles(styles)(Footer);","import React, {Component} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Hero from \"../hero\";\r\nimport CardsGrid from \"../cards-grid\";\r\nimport PageSection from \"../page-section\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Page from \"../page\";\r\nimport NodeHeader from \"../node-header\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport {goToHubDashboards, goToNode} from \"../../links\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Footer from \"../footer\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\n\r\nconst styles = theme => ({\r\n  appBar: {\r\n    transition: \"opacity 1s\",\r\n  },\r\n  toolbarButtons: {\r\n    marginLeft: \"auto\",\r\n    '& > *': {\r\n      marginRight: theme.spacing(1)\r\n    }\r\n  },\r\n  anchorContainer: {\r\n    position: \"relative\"\r\n  },\r\n  anchor: {\r\n    position: \"absolute\",\r\n    top: -theme.mixins.toolbar.minHeight\r\n  },\r\n  fullWidthContainer: {\r\n    backgroundColor: \"#f5f5f5\",\r\n    width: \"100%\"\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(3),\r\n    width: 1024,\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  footer: {\r\n    paddingTop: theme.spacing(4)\r\n  },\r\n  footerContent: {\r\n    paddingTop: theme.spacing(2)\r\n  },\r\n  nodesContainer: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  centerContainer: {\r\n    width: 316,\r\n    textAlign: \"center\"\r\n  },\r\n  sistanLogo: {\r\n    width: 32,\r\n    height: 32,\r\n    transform: \"translateY(3px)\"\r\n  },\r\n  leftContainer: {\r\n    width: \"calc((100% - 316px)/2)\"\r\n  },\r\n  rightContainer: {\r\n    width: \"calc((100% - 316px)/2)\"\r\n  },\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub,\r\n  baseURL: state.config.baseURL\r\n});\r\n\r\nclass Home extends Component {\r\n\r\n  info = React.createRef();\r\n  nodesRef = React.createRef();\r\n  dashboard = React.createRef();\r\n\r\n  state = {\r\n    isListMode: true,\r\n  };\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true,\r\n    });\r\n  }\r\n\r\n  /*  onListModeToggle = () => {\r\n      this.setState({isListMode: !this.state.isListMode});\r\n    };*/\r\n\r\n  render() {\r\n\r\n    const {classes, hub, baseURL, t} = this.props;\r\n    // const {isListMode} = this.state;\r\n\r\n    return (\r\n      <Page id=\"landing-page\">\r\n        <NodeHeader\r\n          noNode\r\n          defaultNodeConfigOpen={this.props.defaultNodeConfigOpen}\r\n          defaultAppConfigOpen={this.props.defaultAppConfigOpen}\r\n          defaultUserConfigOpen={this.props.defaultUserConfigOpen}\r\n          defaultNodesConfigOpen={this.props.defaultNodesConfigOpen}\r\n          hub={hub.hub}\r\n          nodes={hub.nodes}\r\n        />\r\n        <Hero\r\n          title={hub.hub.name}\r\n          slogan={hub.hub.slogan}\r\n          logo={hub.hub.logoURL && <img src={baseURL + hub.hub.logoURL} alt={hub.hub.name}/>}\r\n          background={\r\n            hub.hub.backgroundMediaURL\r\n              ? (hub.hub.backgroundMediaURL.match(/\\.(jpeg|jpg|gif|png|JPEG|JPG|GIF|PNG|svg|SVG)$/)\r\n                ? <img src={baseURL + hub.hub.backgroundMediaURL} alt={hub.hub.name}/>\r\n                : (\r\n                  <video autoPlay muted loop>\r\n                    <source src={baseURL + hub.hub.backgroundMediaURL}/>\r\n                  </video>\r\n                )\r\n              ) : <video autoPlay muted loop>\r\n                <source src=\"./videos/landing-background.mp4\"/>\r\n              </video>\r\n          }\r\n        >\r\n          {hub.hub.description && hub.hub.description.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.info)}>\r\n              {t(\"scenes.hub.informations\")}\r\n            </Button>\r\n          )}\r\n          <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                  onClick={() => this.scroll(this.nodesRef)}>\r\n            {t(\"scenes.hub.nodes\")}\r\n          </Button>\r\n          {hub.hub.dashboards && hub.hub.dashboards.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\" onClick={goToHubDashboards}>\r\n              {t(\"scenes.hub.dashboards\")}\r\n            </Button>\r\n          )}\r\n        </Hero>\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            {hub.hub.description && hub.hub.description.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.info}/>\r\n                <PageSection className={classes.section}\r\n                             sectiontitle={t(\"scenes.hub.informations\")}>\r\n                  <Box textAlign=\"justify\">\r\n                    <SanitizedHTML html={hub.hub.description}/>\r\n                  </Box>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n            <div className={classes.anchorContainer}>\r\n              <div className={classes.anchor} ref={this.nodesRef}/>\r\n              <PageSection className={classes.section} sectiontitle={t(\"scenes.hub.nodes\")}>\r\n                <Box className={classes.nodesContainer}>\r\n                  <CardsGrid\r\n                    list={hub.nodes.sort((a, b) => a.order - b.order).map(({code, name, backgroundMediaURL}) => ({\r\n                      code,\r\n                      id: code,\r\n                      label: name,\r\n                      image: backgroundMediaURL ? baseURL + backgroundMediaURL : \"./images/istat/istat-background.jpg\"\r\n                    }))}\r\n                    onClick={node => goToNode(node.code.toLowerCase())}\r\n                  />\r\n                </Box>\r\n              </PageSection>\r\n            </div>\r\n            <div className={classes.footer}>\r\n              <Divider/>\r\n              <div className={classes.footerContent}>\r\n                <Footer/>\r\n              </div>\r\n            </div>\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps)\r\n)(Home);","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getHubMinimalInfoUrl} from \"../../serverApi/urls\";\r\n\r\nexport const HUB_FETCH = \"hub/fetch\";\r\nexport const HUB_CLEAR = \"hub/clear\";\r\n\r\nexport const fetchHub = () => initRequest(\r\n  HUB_FETCH,\r\n  getHubMinimalInfoUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"domains.hub.messages.fetch.start\")\r\n  })\r\n);\r\n\r\nexport const clearHub = () => ({\r\n  type: HUB_CLEAR\r\n})","import React, {Fragment} from 'react';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {Link} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  list: {\r\n    paddingLeft: theme.spacing(1),\r\n    paddingRight: theme.spacing(1)\r\n  },\r\n  cardContainer: {\r\n    position: \"relative\"\r\n  },\r\n  card: {\r\n    height: \"100%\",\r\n    backgroundColor: theme.palette.background.default\r\n  },\r\n  item: {\r\n    padding: 0\r\n  },\r\n  link: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\nconst CategoriesLists = ({classes, categories, onClick}) => {\r\n\r\n  const rows = [];\r\n\r\n  const chunkSize = 3;\r\n\r\n  for (let i = 0; i < categories.length; i += chunkSize) {\r\n\r\n    const categoriesChunk = categories.slice(i, i + chunkSize);\r\n\r\n    /* first level */\r\n    rows.push(\r\n      <Grid key={i} container spacing={2}>\r\n        {categoriesChunk.map((rootCategory, i) =>\r\n          <Grid item key={i} xs={4}>\r\n            <Typography variant=\"h5\" className={classes.title} style={{fontSize: 20}}>\r\n              {rootCategory.datasetIdentifiers?.length > 0\r\n                ? (\r\n                  <Link onClick={() => onClick([rootCategory.id])} className={classes.link}>\r\n                    {rootCategory.label} ({rootCategory.datasetIdentifiers.length})\r\n                  </Link>\r\n                ) : rootCategory.label\r\n              }\r\n            </Typography>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n\r\n    const fontSizes = [18, 16, 15, 14];\r\n\r\n    /* recursively renders subtree of categories */\r\n    const Subtree = ({root, depth, fontSizes, parentPath = []}) =>\r\n      root.childrenCategories && (\r\n        <div className={classes.card}>\r\n          <List className={classes.list}>\r\n            {root.childrenCategories.map((child, i) =>\r\n              <Fragment key={i}>\r\n                <ListItem className={classes.item}>\r\n                  <ListItemText\r\n                    primary={\r\n                      <Typography style={{fontSize: fontSizes[0]}}>\r\n                        {child.datasetIdentifiers?.length > 0\r\n                          ? (\r\n                            <Link onClick={() => onClick([...parentPath, root.id, child.id])} className={classes.link}>\r\n                              {child.label} ({child.datasetIdentifiers.length})\r\n                            </Link>\r\n                          ) : child.label}\r\n                      </Typography>\r\n                    }\r\n                  />\r\n                </ListItem>\r\n                {/* recursion on subtree of child category */}\r\n                {depth > 1 && (\r\n                  <Subtree\r\n                    root={child}\r\n                    depth={depth - 1}\r\n                    fontSizes={fontSizes.slice(1)}\r\n                    parentPath={[...parentPath, root.id]}\r\n                  />\r\n                )}\r\n              </Fragment>\r\n            )}\r\n          </List>\r\n        </div>\r\n      );\r\n\r\n    /* 4 levels subtree */\r\n    rows.push(\r\n      <Grid key={i + 1} container spacing={2}>\r\n        {categoriesChunk.map((rootCategory, i) =>\r\n          <Grid item key={i} xs={4} className={classes.cardContainer}>\r\n            <Subtree root={rootCategory} depth={4} fontSizes={fontSizes}/>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  return rows;\r\n};\r\n\r\nexport default withStyles(styles)(CategoriesLists);\r\n","import React, {Component} from 'react';\r\nimport Hero from \"../hero\";\r\nimport CardsGrid from \"../cards-grid\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport PageSection from \"../page-section\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport NodeHeader from \"../node-header\";\r\nimport Page from \"../page\";\r\nimport {goToDatasets, goToNode, goToNodeDashboards} from \"../../links\";\r\nimport CategoriesLists from \"../../components/categories-lists\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\n\r\nconst styles = theme => ({\r\n  anchor: {\r\n    position: \"absolute\",\r\n    top: -theme.mixins.toolbar.minHeight\r\n  },\r\n  anchorContainer: {\r\n    position: \"relative\"\r\n  },\r\n  fullWidthContainer: {\r\n    backgroundColor: \"#f5f5f5\",\r\n    width: \"100%\",\r\n    minHeight: \"100%\"\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(3),\r\n    width: 1024,\r\n  },\r\n  categoriesContainer: {\r\n    paddingTop: theme.spacing(2)\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  categorySchemesTabs: {\r\n    marginBottom: theme.spacing(2)\r\n  },\r\n  nodesContainer: {\r\n    marginTop: theme.spacing(2)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL\r\n});\r\n\r\nclass Node extends Component {\r\n\r\n  state = {\r\n    configIsListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5,\r\n    isListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5,\r\n    categorySchemeTab: 0\r\n  };\r\n\r\n  info = React.createRef();\r\n  explore = React.createRef();\r\n  nodes = React.createRef();\r\n  dashboard = React.createRef();\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true\r\n    });\r\n  }\r\n\r\n  onListModeToggle = () => {\r\n    this.setState({isListMode: !this.state.isListMode});\r\n  };\r\n\r\n  setCategorySchemeTab = tab => {\r\n    this.setState({categorySchemeTab: tab});\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n\r\n    const configIsListMode = props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5;\r\n\r\n    if (configIsListMode !== state.configIsListMode) {\r\n      return {\r\n        ...state,\r\n        configIsListMode,\r\n        isListMode: configIsListMode\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      defaultTreeOpen,\r\n      defaultNodeConfigOpen,\r\n      defaultAppConfigOpen,\r\n      defaultUserConfigOpen,\r\n      defaultNodesConfigOpen,\r\n      node,\r\n      nodeCode,\r\n      hub,\r\n      catalog,\r\n      baseURL,\r\n      isDefault,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isListMode, categorySchemeTab} = this.state;\r\n\r\n    const nodeMinimalInfo = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n\r\n    const uncategorizedCategory = {\r\n      id: \"uncategorized\",\r\n      label: t(\"commons.catalog.uncategorized\"),\r\n      childrenCategories: [],\r\n      datasetIdentifiers: catalog?.uncategorizedDatasets.map(({identifier}) => identifier)\r\n    };\r\n\r\n    const categoriesForExplore =\r\n      catalog\r\n        ? (\r\n          catalog.categoryGroups.length > 1\r\n            ? (\r\n              categorySchemeTab === \"uncategorized\"\r\n                ? [uncategorizedCategory]\r\n                : catalog.categoryGroups[categorySchemeTab].categories.map(c => ({\r\n                  ...c,\r\n                  image: c.image ? baseURL + c.image : undefined\r\n                }))\r\n            )\r\n            : (\r\n              catalog.uncategorizedDatasets.length > 0\r\n                ? catalog.categoryGroups[0]?.categories.map(c => ({\r\n                ...c,\r\n                image: c.image ? baseURL + c.image : undefined\r\n              })).concat([uncategorizedCategory]) || [uncategorizedCategory]\r\n                : catalog.categoryGroups[0]?.categories.map(c => ({\r\n                ...c,\r\n                image: c.image ? baseURL + c.image : undefined\r\n              })) || []\r\n            ))\r\n        : [];\r\n\r\n    return (\r\n      <Page id={isDefault ? \"landing-page\" : null}>\r\n        <NodeHeader\r\n          hub={hub.hub}\r\n          nodes={hub.nodes}\r\n          catalog={catalog}\r\n          defaultTreeOpen={defaultTreeOpen}\r\n          shortName={nodeCode}\r\n          title={nodeMinimalInfo.name}\r\n          node={node}\r\n          defaultNodeConfigOpen={defaultNodeConfigOpen}\r\n          defaultAppConfigOpen={defaultAppConfigOpen}\r\n          defaultUserConfigOpen={defaultUserConfigOpen}\r\n          defaultNodesConfigOpen={defaultNodesConfigOpen}\r\n          nodeId={nodeMinimalInfo.nodeId}\r\n        />\r\n        <Hero\r\n          title={nodeMinimalInfo.name}\r\n          slogan={node && node.slogan}\r\n          logo={node && nodeMinimalInfo.logoURL &&\r\n          <img src={baseURL + nodeMinimalInfo.logoURL} alt={nodeMinimalInfo.name}/>}\r\n          background={\r\n            nodeMinimalInfo.backgroundMediaURL\r\n              ? (\r\n                nodeMinimalInfo.backgroundMediaURL.match(/\\.(jpeg|jpg|gif|png|JPEG|JPG|GIF|PNG|svg|SVG)$/)\r\n                  ?\r\n                  <img src={baseURL + nodeMinimalInfo.backgroundMediaURL} alt={nodeMinimalInfo.name}/>\r\n                  : (\r\n                    <video autoPlay muted loop>\r\n                      <source src={baseURL + nodeMinimalInfo.backgroundMediaURL}/>\r\n                    </video>\r\n                  )\r\n              )\r\n              : <img src=\"./images/istat/istat-background.jpg\" alt={nodeMinimalInfo.name}/>\r\n          }\r\n        >\r\n          {node && node.description && node.description.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.info)}>\r\n              {t(\"scenes.node.informations\")}\r\n            </Button>\r\n          )}\r\n          {catalog && categoriesForExplore.length > 0 && (\r\n            <Button id=\"explore-btn\" size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.explore)}>\r\n              {t(\"scenes.node.explore\")}\r\n            </Button>\r\n          )}\r\n          {nodeMinimalInfo.dashboards && nodeMinimalInfo.dashboards.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => goToNodeDashboards(nodeCode)}>\r\n              {t(\"scenes.node.dashboards\")}\r\n            </Button>\r\n          )}\r\n          {isDefault && (\r\n            <Button id=\"other-nodes-btn\" size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.nodes)}>\r\n              {t(\"scenes.node.otherNodes\")}\r\n            </Button>\r\n          )}\r\n        </Hero>\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            {node && node.description && node.description.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.info}/>\r\n                <PageSection className={classes.section}\r\n                             sectiontitle={t(\"scenes.node.informations\")}>\r\n                  <Box textAlign=\"justify\">\r\n                    <SanitizedHTML html={node.description}/>\r\n                  </Box>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n            {catalog && categoriesForExplore.length > 0 && (\r\n              <div id=\"explore-section\" className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.explore}/>\r\n                <PageSection className={classes.section} sectiontitle={t(\"scenes.node.explore\")}>\r\n                  <div className={classes.categoriesContainer}>\r\n                    {catalog.categoryGroups.length > 1 && (\r\n                      <Tabs\r\n                        value={categorySchemeTab}\r\n                        onChange={(_, tab) => this.setCategorySchemeTab(tab)}\r\n                        className={classes.categorySchemesTabs}\r\n                      >\r\n                        {catalog.categoryGroups.map(({label}, index) =>\r\n                          <Tab value={index} label={label} key={index}/>\r\n                        )}\r\n                        {catalog.uncategorizedDatasets?.length > 0 && (\r\n                          <Tab value=\"uncategorized\" label={t(\"commons.catalog.uncategorized\")}\r\n                               key=\"uncategorized\"/>\r\n                        )}\r\n                      </Tabs>\r\n                    )}\r\n                    {isListMode\r\n                      ? (\r\n                        <CategoriesLists\r\n                          categories={categoriesForExplore}\r\n                          onClick={\r\n                            categoryPath =>\r\n                              goToDatasets(\r\n                                node.code,\r\n                                categoryPath[0] === \"uncategorized\"\r\n                                  ? [\"uncategorized\"]\r\n                                  : catalog.categoryGroups.length > 1 ? [catalog.categoryGroups[categorySchemeTab].id, ...categoryPath] : categoryPath\r\n                              )\r\n                          }\r\n                        />\r\n                      )\r\n                      : (\r\n                        <CardsGrid\r\n                          squareImage\r\n                          list={categoriesForExplore}\r\n                          onClick={\r\n                            category =>\r\n                              goToDatasets(\r\n                                node.code,\r\n                                category.id === \"uncategorized\"\r\n                                  ? [\"uncategorized\"]\r\n                                  : catalog.categoryGroups.length > 1 ? [catalog.categoryGroups[categorySchemeTab].id, category.id] : [category.id]\r\n                              )\r\n                          }\r\n                        />\r\n                      )\r\n                    }\r\n                  </div>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n            {isDefault && (\r\n              <div id=\"other-nodes-section\" className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.nodes}/>\r\n                <PageSection className={classes.section} sectiontitle={t(\"scenes.node.otherNodes\")}>\r\n                  <Box className={classes.nodesContainer}>\r\n                    <CardsGrid\r\n                      list={hub.nodes.filter(n => n.code.toLowerCase() !== nodeCode.toLowerCase()).sort((a, b) => a.order - b.order).map(({code, name, backgroundMediaURL}) => ({\r\n                        code,\r\n                        id: code,\r\n                        label: name,\r\n                        image: backgroundMediaURL ? baseURL + backgroundMediaURL : \"./images/istat/istat-background.jpg\"\r\n                      }))}\r\n                      onClick={node => goToNode(node.code.toLowerCase())}\r\n                    />\r\n                  </Box>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps)\r\n)(Node);","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getNodeUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_FETCH = \"node/fetch\";\r\nexport const NODE_CLEAR = \"node/clear\";\r\n\r\nexport const fetchNode = (nodeId: number) =>\r\n  initRequest(\r\n    NODE_FETCH,\r\n    getNodeUrl(nodeId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n      onStart: t(\"domains.node.messages.fetch.start\")\r\n    })\r\n  );\r\n\r\nexport const clearNode = () => ({\r\n  type: NODE_CLEAR\r\n})","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getNodeCatalogUrl} from \"../../serverApi/urls\";\r\n\r\nexport const CATALOG_FETCH = \"catalog/fetch\";\r\nexport const CATALOG_CLEAR = \"catalog/clear\";\r\n\r\nexport const fetchCatalog = (nodeId: number) => initRequest(\r\n  CATALOG_FETCH,\r\n  getNodeCatalogUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"domains.catalog.messages.fetch.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n\r\nexport const clearCatalog = () => ({\r\n  type: CATALOG_CLEAR\r\n})","import React, {useState} from \"react\";\r\nimport TreeItem from \"@material-ui/lab/TreeItem\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport TreeView from \"@material-ui/lab/TreeView\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\r\nimport {goToDatasetsSearch} from \"../../links\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\n\r\nconst styles = () => ({\r\n  container: {\r\n    background: \"#F5F5F5\",\r\n    paddingTop: 8,\r\n    paddingBottom: 8\r\n  },\r\n  nodeIcon: {\r\n    marginTop: 5\r\n  },\r\n  item: {\r\n    background: \"none !important\"\r\n  },\r\n  resCount: {\r\n    fontWeight: \"bold\",\r\n    marginLeft: 4\r\n  },\r\n  checkbox: {\r\n    padding: 0,\r\n    transform: \"translateY(-2px)\"\r\n  }\r\n});\r\n\r\nfunction ResultTree(props) {\r\n  const {\r\n    classes,\r\n    catalog,\r\n    query,\r\n    node,\r\n    filters = [],\r\n    categoryGroupsWithCount,\r\n    uncategorizedDatasetsCount,\r\n    t\r\n  } = props;\r\n\r\n  const [expanded, setExpanded] = useState([]);\r\n\r\n  const getTreeItems = (tree, prevPath, noCheckbox = false) =>\r\n    tree.map((cat, i) => {\r\n\r\n      const selected = !!filters.find(filter => filter.includes(cat.id));\r\n\r\n      return (\r\n        <TreeItem\r\n          key={i}\r\n          nodeId={cat.id}\r\n          label={\r\n            <Grid spacing={1} container alignItems=\"flex-start\"\r\n                  style={{flexWrap: \"nowrap\", marginTop: 4}}>\r\n              {!noCheckbox && (\r\n                <Grid item>\r\n                  <label htmlFor={`result-tree__checkbox__${cat.id}`} style={{display: \"none\"}}>\r\n                    {cat.label}\r\n                  </label>\r\n                  <Checkbox\r\n                    id={`result-tree__checkbox__${cat.id}`}\r\n                    checked={selected}\r\n                    className={classes.checkbox}\r\n                    onClick={\r\n                      e => {\r\n                        goToDatasetsSearch(\r\n                          node.code,\r\n                          query,\r\n                          selected\r\n                            ? filters.filter(path => !path.includes(cat.id))\r\n                            : [...filters, [...prevPath, cat.id]]\r\n                        );\r\n                        e.stopPropagation();\r\n                      }}\r\n                  />\r\n                </Grid>\r\n              )}\r\n              <Grid item style={{width: \"100%\"}}>\r\n                {cat.label}\r\n                {!noCheckbox && (\r\n                  <span className={classes.resCount}> ({cat.count})</span>\r\n                )}\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n          classes={{\r\n            label: classes.item\r\n          }}\r\n        >\r\n          {cat.categories && cat.categories.length > 0 && getTreeItems(cat.categories, [...prevPath, cat.id])}\r\n        </TreeItem>\r\n      );\r\n    });\r\n\r\n  const uncategorizedSelected = !!filters.find(filter => filter.includes(\"uncategorized\"));\r\n\r\n  return (\r\n    <Box className={classes.container}>\r\n      {categoryGroupsWithCount.length > 0 && (\r\n        <TreeView\r\n          defaultCollapseIcon={<ExpandMoreIcon/>}\r\n          defaultExpandIcon={<ChevronRightIcon/>}\r\n          expanded={expanded}\r\n          onNodeToggle={(_, nodeIds) => setExpanded(nodeIds)}\r\n        >\r\n          {getTreeItems(\r\n            catalog.categoryGroups.length > 1\r\n              ? categoryGroupsWithCount\r\n              : categoryGroupsWithCount[0].categories,\r\n            [],\r\n            catalog.categoryGroups.length > 1\r\n          )}\r\n        </TreeView>\r\n      )}\r\n      {uncategorizedDatasetsCount > 0 && (\r\n        <TreeView\r\n          defaultCollapseIcon={<ExpandMoreIcon/>}\r\n          defaultExpandIcon={<ChevronRightIcon/>}\r\n          expanded={expanded}\r\n          onNodeToggle={(_, nodeIds) => setExpanded(nodeIds)}\r\n        >\r\n          <TreeItem\r\n            key={\"uncategorized\"}\r\n            nodeId={\"uncategorized\"}\r\n            label={\r\n              <Grid spacing={1} container alignItems=\"flex-start\" style={{flexWrap: \"nowrap\", marginTop: 4}}>\r\n                <Grid item>\r\n                  <label htmlFor=\"result-tree__checkbox__uncategorized\" style={{display: \"none\"}}>\r\n                    {t(\"commons.catalog.uncategorized\")}\r\n                  </label>\r\n                  <Checkbox\r\n                    id=\"result-tree__checkbox__uncategorized\"\r\n                    checked={uncategorizedSelected}\r\n                    className={classes.checkbox}\r\n                    onClick={\r\n                      e => {\r\n                        goToDatasetsSearch(\r\n                          node.code,\r\n                          query,\r\n                          uncategorizedSelected\r\n                            ? filters.filter(path => JSON.stringify(path) !== JSON.stringify([\"uncategorized\"]))\r\n                            : [...filters, [\"uncategorized\"]]\r\n                        );\r\n                        e.stopPropagation();\r\n                      }}\r\n                  />\r\n                </Grid>\r\n                <Grid style={{width: \"100%\"}} item>\r\n                  {t(\"commons.catalog.uncategorized\")} <span\r\n                  className={classes.resCount}>({uncategorizedDatasetsCount})</span>\r\n                </Grid>\r\n              </Grid>\r\n            }\r\n            classes={{label: classes.item}}\r\n          />\r\n        </TreeView>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ResultTree);","const getDownloadButtonStyle = extension => {\r\n\r\n  const styles = {\r\n    rdf: {\r\n      backgroundColor: \"#3f51b5\",\r\n      color: \"white\"\r\n    },\r\n    html: {backgroundColor: \"#00bcd4\"},\r\n    csv: {backgroundColor: \"#ffeb3b\"},\r\n    xml: {backgroundColor: \"#ff5722\"},\r\n    json: {backgroundColor: \"#ff9800\"},\r\n    xls: {backgroundColor: \"#4caf50\"}\r\n  };\r\n\r\n  return styles[extension] || {};\r\n};\r\n\r\nexport default getDownloadButtonStyle;","import React, {Fragment, useState} from \"react\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ExpandLessIcon from \"@material-ui/icons/ExpandLess\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport getDownloadButtonStyle from './getDownloadButtonStyle';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\n\r\nconst styles = () => ({\r\n  collapsedDescription: {\r\n    marginTop: 8,\r\n    height: 49,\r\n    overflow: \"hidden\"\r\n  },\r\n  expandedDescription: {\r\n    marginTop: 8\r\n  },\r\n  resultSource: {\r\n    fontSize: 14,\r\n    color: \"rgba(0, 0, 0, 0.54)\",\r\n  },\r\n  cardContent: {\r\n    padding: \"16px !important\"\r\n  },\r\n  description: {\r\n    \"& > p\": {\r\n      margin: 0\r\n    }\r\n  },\r\n  downloadChipDeleteIcon: {\r\n    backgroundColor: \"white\"\r\n  },\r\n  counterAvatar: {\r\n    width: 16,\r\n    height: 16,\r\n    marginLeft: -4,\r\n    marginRight: 4\r\n  }\r\n});\r\n\r\nconst DatasetCard = ({\r\n                       dataset,\r\n                       classes,\r\n                       isExpanded,\r\n                       onViewDataset,\r\n                       onExpand,\r\n                       onCollapse,\r\n                       xs\r\n                     }) => {\r\n\r\n  const [isDownloadModalOpen, setIsDownloadModalOpen] = useState(false);\r\n  const [downloadModal, setDownloadModal] = useState(null);\r\n  const {t} = useTranslation();\r\n\r\n  const groupedAttachments = [];\r\n  (dataset.attachedDataFiles || []).forEach(({format, url}) => {\r\n\r\n    const group = groupedAttachments.find(({extension}) => extension === format.toLowerCase());\r\n\r\n    if (!group) {\r\n      groupedAttachments.push({\r\n        extension: format.toLowerCase(),\r\n        urls: [url]\r\n      })\r\n    } else {\r\n      group.urls.push(url);\r\n    }\r\n  });\r\n\r\n  const headerContent =\r\n    <Fragment>\r\n      <Grid container justify=\"space-between\" spacing={2} alignItems=\"center\">\r\n        <Grid item>\r\n          <Typography variant=\"h6\">\r\n            {dataset.title}\r\n          </Typography>\r\n        </Grid>\r\n        {groupedAttachments.length > 0 && (\r\n          <Grid item>\r\n            <Grid container spacing={1}>\r\n              {groupedAttachments\r\n                .map((group, index) =>\r\n                  <Grid item key={index}>\r\n                    <Chip\r\n                      className={`download-btn--${group.extension.toLowerCase()}`}\r\n                      label={group.extension.toUpperCase()}\r\n                      deleteIcon={\r\n                        group.urls.length > 1\r\n                          ? (\r\n                            <Avatar style={{fontSize: 12, color: \"black\"}}\r\n                                    classes={{root: classes.counterAvatar}}>\r\n                              {group.urls.length}\r\n                            </Avatar>\r\n                          )\r\n                          : null\r\n                      }\r\n                      onDelete={\r\n                        group.urls.length > 1\r\n                          ? e => {\r\n                            e.stopPropagation();\r\n                            setIsDownloadModalOpen(true);\r\n                            setDownloadModal(group)\r\n                          }\r\n                          : null\r\n                      }\r\n                      size=\"small\"\r\n                      onClick={\r\n                        e => {\r\n                          e.stopPropagation();\r\n                          if (group.urls.length > 1) {\r\n                            setIsDownloadModalOpen(true);\r\n                            setDownloadModal(group)\r\n                          } else {\r\n                            window.open(group.urls[0], \"_blank\")\r\n                          }\r\n                        }\r\n                      }\r\n                      style={{\r\n                        cursor: \"pointer\",\r\n                        ...getDownloadButtonStyle(group.extension)\r\n                      }}\r\n                      classes={{\r\n                        deleteIconSmall: classes.downloadChipDeleteIcon\r\n                      }}\r\n                    />\r\n                  </Grid>\r\n                )}\r\n            </Grid>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n      {dataset.source && (\r\n        <Typography variant=\"body1\" className={classes.resultSource}>\r\n          {dataset.source}\r\n        </Typography>\r\n      )}\r\n    </Fragment>;\r\n\r\n  const header =\r\n    dataset.catalogType !== \"ONLY_FILE\"\r\n      ? (\r\n        <CardActionArea\r\n          onClick={onViewDataset}\r\n        >\r\n          {headerContent}\r\n        </CardActionArea>\r\n      )\r\n      : headerContent;\r\n\r\n  const description =\r\n    (\r\n      dataset.description ||\r\n      (dataset.keywords && dataset.keywords.length > 0)\r\n    ) && (\r\n      <Typography\r\n        component='div'\r\n        variant=\"body1\"\r\n        className={isExpanded ? classes.expandedDescription : classes.collapsedDescription}\r\n      >\r\n        <SanitizedHTML html={dataset.description} className={classes.description}/>\r\n        {dataset.keywords && dataset.keywords.length > 0 && (\r\n          <Grid container spacing={1}>\r\n            {dataset.keywords.map((keyword, index) =>\r\n              <Grid item key={index}>\r\n                <Chip\r\n                  label={keyword}\r\n                  size=\"small\"\r\n                />\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        )}\r\n      </Typography>\r\n    );\r\n\r\n  const expandIcon = <Grid container justify=\"flex-end\">\r\n    <Grid item>\r\n      <IconButton\r\n        onClick={isExpanded ? onCollapse : onExpand}\r\n      >\r\n        {isExpanded\r\n          ? <ExpandLessIcon/>\r\n          : <ExpandMoreIcon/>\r\n        }\r\n      </IconButton>\r\n    </Grid>\r\n  </Grid>;\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid item xs={xs}>\r\n        <Card>\r\n          <CardContent className={classes.cardContent}>\r\n            <Grid container>\r\n              <Grid item xs={12}>\r\n                {header}\r\n              </Grid>\r\n            </Grid>\r\n            {description}\r\n            {description && expandIcon}\r\n          </CardContent>\r\n        </Card>\r\n      </Grid>\r\n      <Dialog\r\n        open={!!isDownloadModalOpen}\r\n        disableEscapeKeyDown\r\n        disableBackdropClick\r\n        onClose={() => setIsDownloadModalOpen(false)}\r\n        onExited={() => setDownloadModal(null)}\r\n      >\r\n        <DialogContent>\r\n          <List>\r\n            {downloadModal?.urls.map((url, key) =>\r\n              <ListItem key={key}>\r\n                <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">{url}</a>\r\n              </ListItem>\r\n            )}\r\n          </List>\r\n          <DialogActions>\r\n            <Button onClick={() => setIsDownloadModalOpen(false)}>\r\n              {t(\"commons.confirm.close\")}\r\n            </Button>\r\n          </DialogActions>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(DatasetCard);","import React, {Component} from 'react';\r\nimport NodeHeader from \"../node-header\";\r\nimport {Link, withStyles} from \"@material-ui/core\";\r\nimport Page from \"../page\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {goToData, goToDatasets, goToNode} from \"../../links\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ListIcon from '@material-ui/icons/List';\r\nimport GridOnIcon from '@material-ui/icons/GridOn';\r\nimport Breadcrumbs from \"@material-ui/core/Breadcrumbs\";\r\nimport ResultTree from \"./ResultTree\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\nimport FolderIcon from \"@material-ui/icons/Folder\";\r\nimport DatasetCard from \"./DatasetCard\";\r\n\r\nconst styles = theme => ({\r\n  fullWidthContainer: {\r\n    width: \"100%\",\r\n    paddingTop: 64,\r\n    backgroundColor: \"#f5f5f5\",\r\n    minHeight: \"100%\"\r\n  },\r\n  container: {\r\n    width: 1024,\r\n  },\r\n  results: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  toolbar: {\r\n    marginTop: theme.spacing(2),\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  subCat: {\r\n    padding: theme.spacing(1)\r\n  },\r\n  row: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nclass Results extends Component {\r\n\r\n  state = {\r\n    expandedIndexes: [],\r\n    configIsListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .catalogNavigationMode === \"List\",\r\n    isListMode:\r\n      this.props.hub.nodes\r\n        .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n        .catalogNavigationMode === \"List\",\r\n    isA11yMode: false\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n\r\n    const configIsListMode = props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === props.nodeCode.toLowerCase())\r\n      .catalogNavigationMode === \"List\";\r\n\r\n    if (configIsListMode !== state.configIsListMode) {\r\n      return {\r\n        ...state,\r\n        configIsListMode,\r\n        isListMode: configIsListMode\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  expand = index =>\r\n    this.setState({\r\n      expandedIndexes: [...this.state.expandedIndexes, index]\r\n    });\r\n\r\n  collapse = index =>\r\n    this.setState({\r\n      expandedIndexes: [...this.state.expandedIndexes.filter(i => i !== index)]\r\n    });\r\n\r\n  onListModeToggle = () => {\r\n    this.setState({isListMode: !this.state.isListMode});\r\n  };\r\n\r\n  onA11yModeToggle = () => {\r\n    this.setState({isA11yMode: !this.state.isA11yMode});\r\n  };\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      query,\r\n      hub,\r\n      catalog,\r\n      node,\r\n      nodeCode,\r\n      categoryPath,\r\n      datasets,\r\n      subCategories,\r\n      filters,\r\n      categoryGroupsWithCount,\r\n      uncategorizedDatasetsCount,\r\n      t\r\n    } = this.props;\r\n\r\n    const {expandedIndexes, isListMode, isA11yMode} = this.state;\r\n\r\n    const nodeMinimalInfo = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n\r\n    let categoryPathLabels = [];\r\n    if (categoryPath) {\r\n      if (categoryPath[0] === \"uncategorized\") {\r\n        categoryPathLabels = [t(\"commons.catalog.uncategorized\")];\r\n      } else {\r\n\r\n        let category;\r\n\r\n        if (catalog.categoryGroups.length > 1) {\r\n          category = catalog.categoryGroups.find(({id}) => id === categoryPath[0]);\r\n        } else {\r\n          category = catalog.categoryGroups[0].categories.find(({id}) => id === categoryPath[0]);\r\n        }\r\n\r\n        categoryPathLabels.push(category.label);\r\n        for (let i = 1; i < categoryPath.length; i++) {\r\n          category = (category.childrenCategories || category.categories).find(({id}) => id === categoryPath[i]);\r\n          categoryPathLabels.push(category.label);\r\n        }\r\n      }\r\n    }\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          hub={hub.hub}\r\n          query={query}\r\n          nodes={hub.nodes}\r\n          catalog={catalog}\r\n          shortName={nodeMinimalInfo.code}\r\n          title={nodeMinimalInfo.name}\r\n          node={node}\r\n          nodeId={nodeMinimalInfo.nodeId}\r\n          selectedCategoryPath={categoryPath}\r\n        />\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            <Grid container justify=\"space-between\" alignItems=\"center\" className={classes.toolbar}>\r\n              <Grid item>\r\n                {query ?\r\n                  (\r\n                    <Typography variant={\"h5\"}>\r\n                      {t(\"scenes.results.searchTitle\", {query})}\r\n                    </Typography>\r\n                  )\r\n                  : (\r\n                    <Breadcrumbs>\r\n                      <Link underline=\"none\" onClick={() => goToNode(node.code)} style={{cursor: \"pointer\"}}>\r\n                        <Typography>\r\n                          {nodeCode.toUpperCase()}\r\n                        </Typography>\r\n                      </Link>\r\n                      {categoryPath.map((id, idx) => {\r\n                        if (idx >= (catalog && catalog.categoryGroups.length === 1 ? 0 : 1)) {\r\n                          return (\r\n                            <Link\r\n                              key={idx}\r\n                              underline=\"none\"\r\n                              onClick={\r\n                                idx >= (\r\n                                  catalog && catalog.categoryGroups.length === 1\r\n                                    ? 0\r\n                                    : 1\r\n                                )\r\n                                  ? () => goToDatasets(node.code, categoryPath.slice(0, idx + 1))\r\n                                  : null\r\n                              }\r\n                              style={idx < categoryPath.length - 1 ? {cursor: \"pointer\"} : undefined}\r\n                            >\r\n                              <Typography>\r\n                                {id === \"uncategorized\"\r\n                                  ? t(\"commons.catalog.uncategorized\")\r\n                                  : categoryPathLabels[idx]\r\n                                }\r\n                              </Typography>\r\n                            </Link>\r\n                          );\r\n                        } else {\r\n                          return (\r\n                            <Typography key=\"idx\" color=\"primary\">\r\n                              {id === \"uncategorized\"\r\n                                ? t(\"commons.catalog.uncategorized\")\r\n                                : categoryPathLabels[idx]\r\n                              }\r\n                            </Typography>\r\n                          );\r\n                        }\r\n                      })}\r\n                    </Breadcrumbs>\r\n                  )}\r\n              </Grid>\r\n              <Grid item>\r\n                <Grid container alignItems=\"center\" justify=\"flex-end\" spacing={1}>\r\n                  <Grid item>\r\n                    {datasets.length > 0 && (\r\n                      <IconButton onClick={this.onListModeToggle}>\r\n                        {isListMode\r\n                          ? <GridOnIcon/>\r\n                          : <ListIcon/>\r\n                        }\r\n                      </IconButton>\r\n                    )}\r\n                  </Grid>\r\n                 {/* <Grid item>\r\n                    <label htmlFor=\"results__a11y-mode-toggle\" style={{display: \"none\"}}>\r\n                      {t(\"scenes.results.a11yModeToggle.label\")}\r\n                    </label>\r\n                    <FormControlLabel\r\n                      label={t(\"scenes.results.a11yModeToggle.label\")}\r\n                      control={\r\n                        <Switch\r\n                          checked={isA11yMode}\r\n                          onChange={this.onA11yModeToggle}\r\n                          color=\"primary\"\r\n                          name=\"checkedB\"\r\n                          id=\"results__a11y-mode-toggle\"\r\n                        />\r\n                      }\r\n                    />\r\n                  </Grid>*/}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container spacing={2} className={classes.results}>\r\n              {query && (\r\n                <Grid item style={{width: 256, transform: \"translateX(-24px)\"}}>\r\n                  <ResultTree\r\n                    query={query} filters={filters} catalog={catalog} node={node}\r\n                    datasets={datasets}\r\n                    categoryGroupsWithCount={categoryGroupsWithCount}\r\n                    uncategorizedDatasetsCount={uncategorizedDatasetsCount}\r\n                  />\r\n                </Grid>\r\n              )}\r\n              <Grid item style={{width: query ? `calc(100% - 256px)` : \"100%\"}}>\r\n                {subCategories && subCategories.length\r\n                  ? (\r\n                    <Grid container spacing={2} className={classes.row}>\r\n                      {subCategories.map(({id, label, datasetIdentifiers}) =>\r\n                        <Grid item key={id}>\r\n                          <Card className={classes.subCat}>\r\n                            <CardActionArea\r\n                              onClick={() => goToDatasets(node.code.toLowerCase(), [...categoryPath, id])}>\r\n                              <Grid container spacing={1}>\r\n                                <Grid item>\r\n                                  <FolderIcon/>\r\n                                </Grid>\r\n                                <Grid item>\r\n                                  <Typography variant=\"body1\">\r\n                                    {label} {datasetIdentifiers && datasetIdentifiers.length ? `(${datasetIdentifiers.length})` : ''}\r\n                                  </Typography>\r\n                                </Grid>\r\n                              </Grid>\r\n                            </CardActionArea>\r\n                          </Card>\r\n                        </Grid>\r\n                      )}\r\n                    </Grid>\r\n                  )\r\n                  : null}\r\n                {query && datasets.length\r\n                  ? (\r\n                    <Typography variant=\"body1\" className={classes.row}>\r\n                      {datasets.length > 1\r\n                        ? t(\"scenes.results.datasetsCount.plural\", {datasetsCount: datasets.length})\r\n                        : t(\"scenes.results.datasetsCount.singular\", {datasetsCount: datasets.length})\r\n                      }:\r\n                    </Typography>\r\n                  ) : null\r\n                }\r\n                <Grid container spacing={2}>\r\n                  {datasets.length > 0\r\n                    ? datasets.map((dataset, i) =>\r\n                      <DatasetCard\r\n                        key={i}\r\n                        isExpanded={expandedIndexes.includes(i)}\r\n                        onViewDataset={() => goToData(\r\n                          node.code,\r\n                          dataset.categoryPath,\r\n                          dataset.identifier,\r\n                          undefined,\r\n                          isA11yMode\r\n                        )}\r\n                        dataset={dataset}\r\n                        onExpand={() => this.expand(i)}\r\n                        onCollapse={() => this.collapse(i)}\r\n                        xs={isListMode ? 12 : 4}\r\n                      />\r\n                    )\r\n                    : (\r\n                      (query || !subCategories || !subCategories.length)\r\n                        ? (\r\n                          <Grid container>\r\n                            <Grid item>\r\n                              {t(\"scenes.results.datasetsCount.none\")}\r\n                            </Grid>\r\n                          </Grid>\r\n                        )\r\n                        : null\r\n                    )}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(Results);","import React from 'react';\r\nimport NodeHeader from \"../node-header\";\r\nimport DataViewer from \"../data-viewer\";\r\nimport Page from \"../page\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = () => ({\r\n  fullWidthContainer: {\r\n    backgroundColor: \"#f5f5f5\",\r\n    width: \"100%\",\r\n    minHeight: \"100%\"\r\n  }\r\n});\r\n\r\nconst Data = ({\r\n                classes,\r\n                hub,\r\n                node,\r\n                catalog,\r\n                categoryPath,\r\n                isAccessible,\r\n                datasetId,\r\n                datasetTitle,\r\n                viewId,\r\n                notes,\r\n                attachedFiles,\r\n                referenceMetadataUrl\r\n              }) => {\r\n\r\n  const nodeExtras = {};\r\n  if (node?.extras) {\r\n    node.extras.map(({key, value}) => nodeExtras[key] = JSON.parse(value));\r\n  }\r\n\r\n  const hubExtras = JSON.parse(hub.hub.extras || \"{}\");\r\n\r\n  return (\r\n    <Page>\r\n      <NodeHeader\r\n        hub={hub.hub}\r\n        nodes={hub?.nodes}\r\n        catalog={catalog}\r\n        shortName={node?.code}\r\n        title={node?.name}\r\n        node={node}\r\n        nodeId={node?.nodeId}\r\n        selectedCategoryPath={categoryPath}\r\n      />\r\n      <div style={{paddingTop: 64}} className={classes.fullWidthContainer}>\r\n        <div style={{marginLeft: 16}}/>\r\n        <DataViewer\r\n          nodeId={node?.nodeId}\r\n          nodeCode={node?.code}\r\n          isAccessible={isAccessible}\r\n          datasetId={datasetId}\r\n          datasetTitle={datasetTitle}\r\n          viewId={viewId}\r\n          notes={notes}\r\n          attachedFiles={attachedFiles}\r\n          referenceMetadataUrl={referenceMetadataUrl}\r\n          hubExtras={hubExtras}\r\n          nodeExtras={nodeExtras}\r\n          maxObservation={hub?.hub?.maxObservationsAfterCriteria}\r\n        />\r\n      </div>\r\n    </Page>\r\n  )\r\n};\r\n\r\nexport default withStyles(styles)(Data);","import React, {useEffect} from 'react';\r\nimport Data from \"../components/data\";\r\nimport {connect} from \"react-redux\";\r\nimport {enableDatasetStructureFetch, fetchDatasetStructure, resetDatasetState} from \"../state/dataset/datasetActions\";\r\nimport Call from \"../hocs/call\";\r\n\r\nconst mapStateToProps = state => ({\r\n  dataset: state.dataset,\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onFetchStructureEnable: (nodeCode, categoryPath, datasetId, viewId) =>\r\n    dispatch(enableDatasetStructureFetch(nodeCode, categoryPath, datasetId, viewId)),\r\n  fetchStructure: ({nodeId, datasetId, viewId, isAccessible, defaultLanguage, languages}) =>\r\n    dispatch(fetchDatasetStructure(nodeId, datasetId, viewId, isAccessible, defaultLanguage, languages)),\r\n  onDatasetReset: () => dispatch(resetDatasetState())\r\n});\r\n\r\nconst DatasetDomain = ({\r\n                         dataset,\r\n                         defaultLanguage,\r\n                         languages,\r\n                         hub,\r\n                         node,\r\n                         nodeCode,\r\n                         catalog,\r\n                         categoryPath,\r\n                         isAccessible,\r\n                         datasetId,\r\n                         datasetTitle,\r\n                         notes,\r\n                         attachedFiles,\r\n                         referenceMetadataUrl,\r\n                         viewId,\r\n                         onFetchStructureEnable,\r\n                         fetchStructure,\r\n                         onDatasetReset\r\n                       }) => {\r\n\r\n  useEffect(() => {\r\n    if (hub && node && catalog && node.nodeId === catalog.nodeId && node.code.toLowerCase() === nodeCode.toLowerCase()) {\r\n      onFetchStructureEnable(nodeCode, categoryPath, datasetId, viewId);\r\n    }\r\n    return () => onDatasetReset();\r\n  }, [onDatasetReset, onFetchStructureEnable, hub, node, catalog, nodeCode, categoryPath, datasetId, datasetTitle, viewId]);\r\n\r\n  const isTheSameData = dataset !== null && (\r\n    nodeCode === dataset.nodeCode &&\r\n    (categoryPath || []).join() === (dataset.categoryPath || []).join() &&\r\n    datasetId === dataset.datasetId &&\r\n    (viewId || \"\") === (dataset?.viewId || \"\")\r\n  );\r\n\r\n  return (\r\n    <Call\r\n      cb={fetchStructure}\r\n      cbParam={{nodeId: node ? node.nodeId : null, datasetId, viewId, isAccessible, defaultLanguage, languages}}\r\n      disabled={!node || !node.nodeId || !datasetId || !dataset || dataset.isFetchStructureDisabled}\r\n    >\r\n      {isTheSameData && (\r\n        <Data\r\n          hub={hub}\r\n          node={node}\r\n          catalog={catalog}\r\n          categoryPath={categoryPath}\r\n          isAccessible={isAccessible}\r\n          datasetId={datasetId}\r\n          datasetTitle={datasetTitle}\r\n          viewId={viewId}\r\n          notes={notes}\r\n          attachedFiles={attachedFiles}\r\n          referenceMetadataUrl={referenceMetadataUrl}\r\n        />\r\n      )}\r\n    </Call>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DatasetDomain);","import React, {Fragment, useState} from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport {getNode, getNodes, getNodesAtDepth} from \"../../utils/tree\";\r\nimport {getDashboardDynamicFilterLabelTranslations} from \"../../constants/getDashboardDynamicFilterLabelTranslations\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  filter: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"bottom\",\r\n    marginRight: 16,\r\n    \"& label\": {\r\n      fontSize: 16\r\n    }\r\n  },\r\n  item: {\r\n    fontSize: 14\r\n  },\r\n  dialogContent: {\r\n    padding: \"8px !important\"\r\n  },\r\n});\r\n\r\nconst getLabelsMap = tree => {\r\n  const map = {};\r\n  getNodes(tree, \"children\", () => true).forEach(({id, name}) => map[id] = name);\r\n\r\n  return map;\r\n}\r\n\r\nfunction DashboardFilters(props) {\r\n  const {\r\n    classes,\r\n    filters,\r\n    selectValues,\r\n    setSelectValues,\r\n    lastValorizedIdx,\r\n    setLastValorizedIdx,\r\n    filterLevels,\r\n    onFilterApply\r\n  } = props;\r\n\r\n  const {\r\n    labels,\r\n    values\r\n  } = filters;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isApplyDisabled, setIsApplyDisable] = useState(false);\r\n\r\n  const [visibleId, setVisibleId] = useState(null);\r\n\r\n  const [labelsMap] = useState(getLabelsMap(values));\r\n\r\n  const handleFilterSelect = (dimension, value) => {\r\n    const newSelectedValues = {};\r\n    let found = false;\r\n    labels.forEach(label => {\r\n      if (!found) {\r\n        if (label !== dimension) {\r\n          newSelectedValues[label] = selectValues[label];\r\n        } else {\r\n          found = true;\r\n          newSelectedValues[label] = value;\r\n        }\r\n      } else {\r\n        newSelectedValues[label] = \"\";\r\n      }\r\n    })\r\n    setSelectValues(newSelectedValues);\r\n    setLastValorizedIdx(visibleId);\r\n    setVisibleId(null);\r\n    setIsApplyDisable(false);\r\n  };\r\n\r\n  let data = [];\r\n  if (visibleId !== null) {\r\n    data = visibleId === 0\r\n      ? values\r\n      : getNode(values, \"children\", ({id}) => id === selectValues[labels[visibleId - 1]]).children\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.root}>\r\n        {(() => {\r\n          const selects = [];\r\n\r\n          let lastLavorizableIdx = -1;\r\n          labels.forEach((label, idx) => {\r\n            if (filterLevels?.[labels[idx]] === true) {\r\n              lastLavorizableIdx = idx;\r\n            }\r\n          });\r\n\r\n          const getTextWidthEl = $('<span>').css({\r\n            visibility: 'hidden',\r\n            position: 'absolute',\r\n            fontSize: 16\r\n          }).appendTo('body').get(0);\r\n\r\n          for (let i = 0; i <= Math.min(lastValorizedIdx + 1, lastLavorizableIdx); i++) {\r\n            const label = labels[i];\r\n            const minWidth = getTextWidth(label, getTextWidthEl) + 32;\r\n\r\n            selects.push(\r\n              <div key={i} className={classes.filter}>\r\n                <FormControl style={{display: \"inline-block\", verticalAlign: \"bottom\"}}>\r\n                  <InputLabel>{getDashboardDynamicFilterLabelTranslations(t)[label]}</InputLabel>\r\n                  <Select\r\n                    open={false}\r\n                    style={{minWidth: minWidth}}\r\n                    value={selectValues[label] || \"\"}\r\n                    renderValue={value => labelsMap[value]}\r\n                    className={classes.item}\r\n                    onOpen={() => setVisibleId(i)}\r\n                  >\r\n                    {getNodesAtDepth(values, \"children\", (i + 1)).map(({id}, idx) =>\r\n                      <MenuItem key={idx} value={id}>{id}</MenuItem>\r\n                    )}\r\n                  </Select>\r\n                </FormControl>\r\n              </div>\r\n            );\r\n          }\r\n\r\n          $(getTextWidthEl).remove();\r\n\r\n          if (lastLavorizableIdx >= 0) {\r\n            selects.push(\r\n              <Button\r\n                key={labels.length}\r\n                onClick={() => {\r\n                  onFilterApply(selectValues[labels[lastValorizedIdx]]);\r\n                  setIsApplyDisable(true);\r\n                }}\r\n                disabled={isApplyDisabled || lastValorizedIdx < 0 || filterLevels?.[labels[lastValorizedIdx]] === false}\r\n              >\r\n                {t(\"commons.confirm.apply\")}\r\n              </Button>\r\n            );\r\n          }\r\n\r\n          return selects\r\n        })()}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={visibleId !== null}\r\n        onClose={() => setVisibleId(null)}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent className={classes.dialogContent}>\r\n          <InfiniteScrollTable\r\n            data={data}\r\n            getRowKey={({id}) => id}\r\n            showHeader={false}\r\n            columns={[\r\n              {\r\n                title: \"ID\",\r\n                dataIndex: \"id\",\r\n                minWidth: 100\r\n              },\r\n              {\r\n                title: \"Label\",\r\n                dataIndex: \"name\",\r\n                minWidth: 150\r\n              }\r\n            ]}\r\n            onRowClick={rowData => handleFilterSelect(labels[visibleId], rowData.id)}\r\n            getRowStyle={rowData => ({\r\n              background: rowData.id === selectValues[labels[visibleId]]\r\n                ? \"#fff9e5\"\r\n                : undefined\r\n            })}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setVisibleId(null)} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(DashboardFilters);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {\r\n  clearDashboardsDashboards,\r\n  fetchDashboardsDashboard,\r\n  fetchDashboardsDataset,\r\n  fetchDashboardsMapGeometries,\r\n  setDashboardsDatasetFetchEnableStatus,\r\n  setDashboardsDatasetFilter,\r\n  submitDashboardDatasetDownload\r\n} from \"../state/dashboard/dashboardActions\";\r\nimport Call from \"../hocs/call\";\r\nimport Dashboard from \"../components/dashboard\";\r\nimport filters from \"../dummy/filters.json\";\r\nimport DashboardFilters from \"../components/dashboard-filters\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../utils/dashboards\";\r\nimport _ from \"lodash\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport CustomEmpty from \"../components/custom-empty\";\r\nimport NodeHeader from \"../components/node-header\";\r\nimport {localizeI18nObj} from \"../utils/i18n\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {CRITERIA_FILTER_TYPE_CODES} from \"../utils/criteria\";\r\n\r\nconst styles = () => ({\r\n  root: {\r\n    backgroundColor: \"#f5f5f5\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n  },\r\n  fullWidthContainer: {\r\n    padding: 8,\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  commonsFilters: {\r\n    padding: \"16px 8px\"\r\n  },\r\n  dashboardHeader: {\r\n    padding: 8\r\n  },\r\n  dashboardTabs: {},\r\n  dashboardTitle: {\r\n    padding: \"8px 0\",\r\n    fontSize: 20,\r\n    fontWeight: 500\r\n  },\r\n  dashboard: {\r\n    overflow: \"auto\",\r\n    margin: \"0 8px\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub,\r\n  node: state.node,\r\n  nodeId: state.node?.nodeId,\r\n  catalog: state.catalog,\r\n  languages: state.app.languages,\r\n  defaultLanguage: state.app.language,\r\n  dashboards: state.dashboard.dashboards,\r\n  isFetchDatasetDisabled: state.dashboard.isFetchDatasetDisabled,\r\n  jsonStats: state.dashboard.jsonStats,\r\n  layouts: state.dashboard.layouts,\r\n  filterTrees: state.dashboard.filterTrees,\r\n  maps: state.dashboard.maps\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboard: dashboardId => dispatch(fetchDashboardsDashboard(dashboardId)),\r\n  clearDashboards: () => dispatch(clearDashboardsDashboards()),\r\n  setDatasetFetchEnableStatus: enabled => dispatch(setDashboardsDatasetFetchEnableStatus(enabled)),\r\n  fetchDataset: (dashboardId, nodeId, datasetId, criteria, requestIds, worker) =>\r\n    dispatch(fetchDashboardsDataset(dashboardId, nodeId, datasetId, criteria, requestIds, worker)),\r\n  onFilterSet: (dashboardId, viewIdx, dimension, value) => dispatch(setDashboardsDatasetFilter(dashboardId, viewIdx, dimension, value)),\r\n  fetchMapGeometries: (dashboardId, viewIdx, idList, t) => dispatch(fetchDashboardsMapGeometries(dashboardId, viewIdx, idList, t)),\r\n  downloadCsv: (nodeId, datasetId, viewTitle, criteria) => dispatch(submitDashboardDatasetDownload(nodeId, datasetId, viewTitle, criteria)),\r\n});\r\n\r\nconst handleHeight = () => {\r\n  const nodeHeaderHeight = document.getElementById(\"node-header\")\r\n    ? document.getElementById(\"node-header\").offsetHeight\r\n    : 0;\r\n  const dashboardsHeaderHeight = document.getElementById(\"dashboards-domain_header\")\r\n    ? document.getElementById(\"dashboards-domain_header\").offsetHeight\r\n    : 0;\r\n  const dashboardsFiltersHeight = document.getElementById(\"dashboards-domain_filters\")\r\n    ? document.getElementById(\"dashboards-domain_filters\").offsetHeight\r\n    : 0;\r\n\r\n  if (document.getElementById(\"dashboards-domain\")) {\r\n    document.getElementById(\"dashboards-domain\").setAttribute(\"style\", `padding-top: ${nodeHeaderHeight}px`);\r\n  }\r\n\r\n  if (document.getElementById(\"dashboards-domain_dashboards\")) {\r\n    document.getElementById(\"dashboards-domain_dashboards\").setAttribute(\"style\", `height: calc(100% - ${dashboardsFiltersHeight + dashboardsHeaderHeight}px)`);\r\n  }\r\n};\r\n\r\nconst getIsFilterEnabled = dashboard => {\r\n  if (!dashboard) {\r\n    return false\r\n  }\r\n\r\n  let hasDynamicView = false;\r\n  dashboard.dashboardConfig.forEach(row => {\r\n    row.forEach(col => {\r\n      if ((col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || \"\").length > 0) {\r\n        hasDynamicView = true;\r\n      }\r\n    });\r\n  });\r\n\r\n  let lastLavorizableIdx = -1;\r\n  filters.labels.forEach((label, idx) => {\r\n    if (dashboard?.filterLevels?.[filters.labels[idx]] === true) {\r\n      lastLavorizableIdx = idx;\r\n    }\r\n  });\r\n\r\n  return (hasDynamicView && lastLavorizableIdx >= 0)\r\n};\r\n\r\nfunction DashboardsDomain(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    hub,\r\n    node,\r\n    nodeId,\r\n    nodeCode,\r\n    catalog,\r\n    dashboardId,\r\n    dashboards,\r\n    isFetchDatasetDisabled,\r\n    jsonStats,\r\n    layouts,\r\n    filterTrees,\r\n    maps,\r\n    fetchDashboard,\r\n    clearDashboards,\r\n    setDatasetFetchEnableStatus,\r\n    fetchDataset,\r\n    onFilterSet,\r\n    fetchMapGeometries,\r\n    downloadCsv\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [filterValue, setFilterValue] = useState(\"\");\r\n  const [selectValues, setSelectValues] = useState({});\r\n  const [lastValorizedIdx, setLastValorizedIdx] = useState(-1);\r\n\r\n  const [allowedDashboards, setAllowedDashboards] = useState(null);\r\n\r\n  const [fetchedDashboards, setFetchedDashboards] = useState(null);\r\n\r\n  const [tabIdx, setTabIdx] = useState(0);\r\n\r\n  const [worker] = useState(() => new Worker(\"./workers/fetchDashboardDatasetAsyncHandlerWorker.js\"));\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (worker) {\r\n        worker.terminate();\r\n      }\r\n    }\r\n  }, [worker]);\r\n\r\n  // const {\r\n  //   labels\r\n  // } = filters;\r\n\r\n  useEffect(() => {\r\n    handleHeight();\r\n  }, [dashboards]);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", handleHeight);\r\n    return () => window.removeEventListener(\"resize\", handleHeight)\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (hub && (!nodeCode || (node && catalog && nodeId === catalog.nodeId && node.code.toLowerCase() === nodeCode.toLowerCase()))) {\r\n\r\n      const nodeDashboards = nodeId ? (hub.nodes.find(node => node.nodeId === nodeId).dashboards || []) : [];\r\n      const hubDashboards = (hub.hub.dashboards || []);\r\n\r\n      const newAllowedDashboards = dashboardId\r\n        ? [{id: dashboardId}]\r\n        : nodeId\r\n          ? hubDashboards.concat(nodeDashboards)\r\n          : hubDashboards\r\n      setAllowedDashboards(newAllowedDashboards);\r\n\r\n      const newFetchedDashboards = {};\r\n      newAllowedDashboards.forEach(({id}) => newFetchedDashboards[id] = {static: false, dynamic: false});\r\n      setFetchedDashboards(newFetchedDashboards);\r\n\r\n    } else {\r\n      clearDashboards();\r\n      setFilterValue(\"\");\r\n      setAllowedDashboards(null);\r\n    }\r\n\r\n    return () => {\r\n      clearDashboards();\r\n    }\r\n  }, [hub, nodeId, nodeCode, node, catalog, dashboardId, clearDashboards]);\r\n\r\n  const handleFilterApply = value => {\r\n    if (value !== filterValue) {\r\n      setFilterValue(value);\r\n      setDatasetFetchEnableStatus(true);\r\n\r\n      const newFetchedDashboard = _.cloneDeep(fetchedDashboards);\r\n      allowedDashboards.forEach(({id}) => newFetchedDashboard[id] = {...fetchedDashboards[id], dynamic: false});\r\n      setFetchedDashboards(newFetchedDashboard);\r\n    }\r\n  };\r\n\r\n  const handleFetchDatasets = ({dashboardId, fetchStatic, fetchDynamic, dynamicFilterValue}) => {\r\n\r\n    const newFetchedDashboards = _.cloneDeep(fetchedDashboards);\r\n    if (fetchStatic) {\r\n      newFetchedDashboards[dashboardId].static = true;\r\n    }\r\n    if (fetchDynamic && dynamicFilterValue) {\r\n      newFetchedDashboards[dashboardId].dynamic = true;\r\n    }\r\n    setFetchedDashboards(newFetchedDashboards);\r\n\r\n    const requests = [];\r\n    dashboards[dashboardId].dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n          const view = dashboards[dashboardId].views[col[DASHBOARD_ELEM_VALUE_KEY]];\r\n\r\n          if (view) {\r\n            let newCriteria = (view?.criteria || {});\r\n\r\n            let addRequest = false;\r\n\r\n            const filterDimension = col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY];\r\n\r\n            if (!filterDimension || filterDimension.length === 0) {\r\n              addRequest = fetchStatic;\r\n\r\n            } else {\r\n              if (fetchDynamic) {\r\n                addRequest = true;\r\n                if (dynamicFilterValue) {\r\n                  newCriteria = {\r\n                    ...newCriteria,\r\n                    [filterDimension]: {\r\n                      ...newCriteria[filterDimension],\r\n                      id: filterDimension,\r\n                      type: CRITERIA_FILTER_TYPE_CODES,\r\n                      filterValues: [dynamicFilterValue]\r\n                    }\r\n                  };\r\n                } else {\r\n                  newCriteria = {\r\n                    ...newCriteria,\r\n                    [filterDimension]: {\r\n                      ...newCriteria[filterDimension],\r\n                      id: filterDimension,\r\n                      type: CRITERIA_FILTER_TYPE_CODES,\r\n                      filterValues: [filters.defaultFilterValue]\r\n                    }\r\n                  };\r\n                }\r\n              }\r\n            }\r\n\r\n            if (addRequest) {\r\n              const request = requests.find(({nodeId, datasetId, criteria}) => {\r\n                return (\r\n                  nodeId === view.nodeId &&\r\n                  datasetId === view.datasetId &&\r\n                  _.isEqual(criteria, newCriteria)\r\n                )\r\n              });\r\n\r\n              if (request === undefined) {\r\n                requests.push({\r\n                  nodeId: view.nodeId,\r\n                  datasetId: view.datasetId,\r\n                  criteria: newCriteria,\r\n                  requestIds: [getViewIdxFromRowAndCol(rowIdx, colIdx)]\r\n                });\r\n              } else {\r\n                request.requestIds.push(getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n    requests.forEach(({nodeId, datasetId, criteria, requestIds}) => fetchDataset(dashboardId, nodeId, datasetId, criteria, requestIds, worker));\r\n  };\r\n\r\n  // const resetFilter = () => {\r\n  //   setFilterValue(\"\");\r\n  //   setSelectValues({});\r\n  //   setLastValorizedIdx(-1);\r\n  //   if (allowedDashboards) {\r\n  //     const newFetchedDashboards = {};\r\n  //     allowedDashboards.forEach(({id}) => newFetchedDashboards[id] = {static: fetchedDashboards[id].static, dynamic: false});\r\n  //     setFetchedDashboards(newFetchedDashboards);\r\n  //   }\r\n  // };\r\n\r\n  const currentDashboardId = dashboardId\r\n    ? dashboardId\r\n    : allowedDashboards?.[tabIdx]?.id\r\n      ? allowedDashboards[tabIdx].id\r\n      : null;\r\n\r\n  return (\r\n    <div key={dashboardId} className={classes.root}>\r\n      {hub && (\r\n        nodeId\r\n          ? (\r\n            <NodeHeader\r\n              hub={hub.hub}\r\n              nodes={hub.nodes}\r\n              node={node}\r\n              nodeId={nodeId}\r\n              shortName={node?.code}\r\n              title={node?.name}\r\n              catalog={catalog}\r\n              defaultNodeConfigOpen={props.defaultNodeConfigOpen}\r\n              defaultAppConfigOpen={props.defaultAppConfigOpen}\r\n              defaultUserConfigOpen={props.defaultUserConfigOpen}\r\n              defaultNodesConfigOpen={props.defaultNodesConfigOpen}\r\n            />\r\n          )\r\n          : (\r\n            <NodeHeader\r\n              noNode\r\n              hub={hub.hub}\r\n              nodes={hub.nodes}\r\n              defaultNodeConfigOpen={props.defaultNodeConfigOpen}\r\n              defaultAppConfigOpen={props.defaultAppConfigOpen}\r\n              defaultUserConfigOpen={props.defaultUserConfigOpen}\r\n              defaultNodesConfigOpen={props.defaultNodesConfigOpen}\r\n            />\r\n          )\r\n      )}\r\n      <div className={classes.fullWidthContainer} id=\"dashboards-domain\">\r\n        {currentDashboardId\r\n          ? (\r\n            <Call\r\n              cb={fetchDashboard}\r\n              cbParam={currentDashboardId}\r\n              disabled={dashboards !== null && dashboards[currentDashboardId] !== null && dashboards[currentDashboardId] !== undefined}\r\n            >\r\n              {(() => {\r\n                return (\r\n                  <Call\r\n                    cb={handleFetchDatasets}\r\n                    cbParam={{\r\n                      dashboardId: currentDashboardId,\r\n                      fetchStatic: true,\r\n                      fetchDynamic: !filterValue,\r\n                      dynamicFilterValue: null\r\n                    }}\r\n                    disabled={!dashboards || !dashboards[currentDashboardId] || !fetchedDashboards || fetchedDashboards[currentDashboardId].static === true}\r\n                  >\r\n                    <Fragment>\r\n                      <div id=\"dashboards-domain_filters\">\r\n                        {(() => {\r\n                          const isEnable = getIsFilterEnabled(dashboards?.[currentDashboardId]);\r\n                          const FilterComponent = (\r\n                            <DashboardFilters\r\n                              filters={filters}\r\n                              selectValues={selectValues}\r\n                              setSelectValues={setSelectValues}\r\n                              lastValorizedIdx={lastValorizedIdx}\r\n                              setLastValorizedIdx={setLastValorizedIdx}\r\n                              filterLevels={dashboards?.[currentDashboardId] ? dashboards[currentDashboardId].filterLevels : null}\r\n                              onFilterApply={filterValue => handleFilterApply(filterValue)}\r\n                            />\r\n                          );\r\n\r\n                          if (dashboardId) {\r\n                            return isEnable && (\r\n                              <div className={classes.commonsFilters}>\r\n                                {FilterComponent}\r\n                              </div>\r\n                            )\r\n                          } else {\r\n                            return (\r\n                              <div className={classes.commonsFilters} style={{height: 77}}>\r\n                                {FilterComponent}\r\n                              </div>\r\n                            )\r\n                          }\r\n                        })()}\r\n                      </div>\r\n                      {(() => {\r\n                        if (dashboards?.[currentDashboardId]) {\r\n\r\n                          let newFilterValue = filterValue;\r\n\r\n                          // if (lastValorizedIdx >= 0 && dashboards[currentDashboardId].filterLevels && dashboards[currentDashboardId].filterLevels?.[labels[lastValorizedIdx]] === false) {\r\n                          //   newFilterValue = \"\";\r\n                          //   resetFilter();\r\n                          // }\r\n\r\n                          return (\r\n                            <Call\r\n                              cb={handleFetchDatasets}\r\n                              cbParam={{\r\n                                dashboardId: currentDashboardId,\r\n                                fetchStatic: false,\r\n                                fetchDynamic: !!newFilterValue,\r\n                                dynamicFilterValue: newFilterValue\r\n                              }}\r\n                              disabled={isFetchDatasetDisabled || fetchedDashboards[currentDashboardId].dynamic === true || fetchedDashboards[currentDashboardId].static !== true}\r\n                            >\r\n                              <Fragment>\r\n                                <div id=\"dashboards-domain_header\" className={classes.dashboardHeader}>\r\n                                  {((allowedDashboards || []).length > 1)\r\n                                    ? (\r\n                                      <AppBar\r\n                                        position=\"static\"\r\n                                        color=\"default\"\r\n                                        className={classes.dashboardTabs}\r\n                                      >\r\n                                        <Tabs\r\n                                          value={tabIdx}\r\n                                          variant=\"scrollable\"\r\n                                          scrollButtons=\"auto\"\r\n                                          indicatorColor=\"primary\"\r\n                                          textColor=\"primary\"\r\n                                          onChange={(_, newValue) => setTabIdx(newValue)}\r\n                                        >\r\n                                          {allowedDashboards.map(({id, title}, idx) =>\r\n                                            <Tab key={idx} label={title}/>\r\n                                          )}\r\n                                        </Tabs>\r\n                                      </AppBar>\r\n                                    )\r\n                                    : (\r\n                                      <div className={classes.dashboardTitle}>\r\n                                        {localizeI18nObj(dashboards[currentDashboardId].title, defaultLanguage, languages)}\r\n                                      </div>\r\n                                    )\r\n                                  }\r\n                                </div>\r\n                                <div\r\n                                  id=\"dashboards-domain_dashboards\"\r\n                                  className={classes.dashboard}\r\n                                >\r\n                                  {dashboards[currentDashboardId] && (\r\n                                    <Dashboard\r\n                                      key={currentDashboardId}\r\n                                      dashboardId={currentDashboardId}\r\n                                      dashboard={dashboards[currentDashboardId]}\r\n                                      filterValue={filterValue}\r\n                                      jsonStats={jsonStats?.[currentDashboardId] || null}\r\n                                      layouts={layouts?.[currentDashboardId] || null}\r\n                                      filterTrees={filterTrees?.[currentDashboardId] || null}\r\n                                      maps={maps?.[currentDashboardId] || null}\r\n                                      onFilterSet={onFilterSet}\r\n                                      fetchMapGeometries={fetchMapGeometries}\r\n                                      downloadCsv={downloadCsv}\r\n                                    />\r\n                                  )}\r\n                                </div>\r\n                              </Fragment>\r\n                            </Call>\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </Fragment>\r\n                  </Call>\r\n                )\r\n              })()}\r\n            </Call>\r\n          )\r\n          : (\r\n            <CustomEmpty\r\n              text={nodeId\r\n                ? t(\"scenes.dashboard.noDashboard.node\")\r\n                : t(\"scenes.dashboard.noDashboard.hub\")\r\n              }\r\n            />\r\n          )\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withStyles(styles)\r\n)(DashboardsDomain);","import React, {useEffect} from 'react';\r\nimport {Route, Switch} from \"react-router\";\r\nimport Node from \"../components/node\";\r\nimport {fetchNode} from \"../state/node/nodeActions\";\r\nimport {fetchCatalog} from \"../state/catalog/catalogActions\";\r\nimport Results from \"../components/results\";\r\nimport DatasetDomain from \"./DatasetDomain\";\r\nimport {connect} from \"react-redux\";\r\nimport DashboardsDomain from \"./DashboardsDomain\";\r\nimport {goToNode} from \"../links\";\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub,\r\n  node: state.node,\r\n  catalog: state.catalog\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchNode: nodeId => dispatch(fetchNode(nodeId)),\r\n  fetchCatalog: nodeId => dispatch(fetchCatalog(nodeId))\r\n});\r\n\r\nconst NodeDomain = ({hub, nodeCode, node, catalog, isDefault, fetchNode, fetchCatalog}) => {\r\n\r\n  useEffect(() => {\r\n\r\n    // TODO: check if catalog is null\r\n    if (hub && (!node || nodeCode.toLowerCase() !== node.code.toLowerCase())) {\r\n      const nodeHavingCode = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n      if (nodeHavingCode) {\r\n        fetchNode(nodeHavingCode.nodeId);\r\n        fetchCatalog(nodeHavingCode.nodeId);\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [hub, nodeCode, node]);\r\n\r\n\r\n  const Recursive = ({path, match}) =>\r\n    <Switch>\r\n      <Route\r\n        exact\r\n        path={match.url}\r\n        render={({location}) => {\r\n\r\n          const viewParam = new URLSearchParams(location.search).get(\"view\");\r\n          const a11yParam = new URLSearchParams(location.search).get(\"accessible\");\r\n\r\n          // short url for categorized dataset\r\n          if (path.length === 1 && catalog.datasets[path[0]]) {\r\n            return (\r\n              <DatasetDomain\r\n                hub={hub}\r\n                node={node}\r\n                nodeCode={nodeCode}\r\n                catalog={catalog}\r\n                categoryPath={[]}\r\n                datasetId={path[0]}\r\n                datasetTitle={catalog.datasets[path[0]].title}\r\n                notes={catalog.datasets[path[0]]?.note}\r\n                attachedFiles={catalog.datasets[path[0]]?.attachedDataFiles}\r\n                referenceMetadataUrl={catalog.datasets[path[0]]?.referenceMetadata}\r\n                viewId={viewParam || undefined}\r\n                isAccessible={!!a11yParam}\r\n              />\r\n            );\r\n\r\n            // short url for uncategorized dataset\r\n          } else if (path.length === 1 && catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[0])) {\r\n\r\n            const dataset = catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[0]);\r\n\r\n            return (\r\n              <DatasetDomain\r\n                hub={hub}\r\n                node={node}\r\n                nodeCode={nodeCode}\r\n                catalog={catalog}\r\n                categoryPath={[]}\r\n                datasetId={path[0]}\r\n                datasetTitle={dataset.title}\r\n                notes={dataset?.note}\r\n                attachedFiles={dataset?.attachedDataFiles}\r\n                referenceMetadataUrl={dataset?.referenceMetadata}\r\n                viewId={viewParam || undefined}\r\n                isAccessible={!!a11yParam}\r\n              />\r\n            );\r\n          } else if (path.length > 0 && path[0] === \"uncategorized\" &&\r\n            catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0) {\r\n\r\n            if (path.length === 1) {\r\n              return (\r\n                <Results\r\n                  hub={hub}\r\n                  node={node}\r\n                  nodeCode={nodeCode}\r\n                  catalog={catalog}\r\n                  categoryPath={path}\r\n                  datasets={catalog.uncategorizedDatasets.map(ds => ({\r\n                    ...ds,\r\n                    categoryPath: path\r\n                  }))}\r\n                />\r\n              );\r\n\r\n            } else if (path.length === 2) {\r\n\r\n              const dataset = catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[1]);\r\n\r\n              if (dataset) {\r\n                return (\r\n                  <DatasetDomain\r\n                    hub={hub}\r\n                    node={node}\r\n                    nodeCode={nodeCode}\r\n                    catalog={catalog}\r\n                    categoryPath={path.slice(0, -1)}\r\n                    datasetId={dataset.identifier}\r\n                    datasetTitle={dataset.title}\r\n                    notes={dataset?.note}\r\n                    attachedFiles={dataset?.attachedDataFiles}\r\n                    referenceMetadataUrl={dataset?.referenceMetadata}\r\n                    isAccessible={!!a11yParam}\r\n                  />\r\n                );\r\n              }\r\n\r\n            }\r\n          } else if (catalog.categoryGroups.length > 0) {\r\n\r\n            const getDatasetsIdsAndSubcategoriesOrDatasetId = (categoryPath = [], categories = [], datasetsIds = []) => {\r\n\r\n              if (categoryPath.length > 0) {\r\n\r\n                if (categoryPath.length === 1) {\r\n\r\n                  const datasetId = datasetsIds.find(id => id === categoryPath[0]);\r\n\r\n                  if (datasetId) {\r\n                    return datasetId;\r\n                  } else {\r\n\r\n                    const lastCategory = categories.find(({id}) => id === categoryPath[0]);\r\n                    if (lastCategory) {\r\n                      return {\r\n                        datasetIds: lastCategory.datasetIdentifiers,\r\n                        subCategories: lastCategory.categories || lastCategory.childrenCategories\r\n                      }\r\n                    }\r\n\r\n                  }\r\n\r\n                } else {\r\n                  const nextCategory = categories.find(({id}) => id === categoryPath[0]);\r\n\r\n                  if (nextCategory) {\r\n                    return getDatasetsIdsAndSubcategoriesOrDatasetId(categoryPath.slice(1), nextCategory.categories || nextCategory.childrenCategories, nextCategory.datasetIdentifiers);\r\n                  }\r\n                }\r\n              }\r\n\r\n              return null;\r\n            };\r\n\r\n            const datasetsIdsOrDatasetId = getDatasetsIdsAndSubcategoriesOrDatasetId(\r\n              path,\r\n              catalog.categoryGroups.length === 1 ? catalog.categoryGroups[0].categories : catalog.categoryGroups,\r\n              []\r\n            );\r\n\r\n            if (datasetsIdsOrDatasetId?.datasetIds) {\r\n              return (\r\n                <Results\r\n                  hub={hub}\r\n                  node={node}\r\n                  nodeCode={nodeCode}\r\n                  catalog={catalog}\r\n                  categoryPath={path}\r\n                  datasets={datasetsIdsOrDatasetId.datasetIds.map(id => ({\r\n                    ...catalog.datasets[id],\r\n                    identifier: id,\r\n                    categoryPath: path\r\n                  }))} subCategories={datasetsIdsOrDatasetId.subCategories}\r\n                />\r\n              );\r\n\r\n            } else if (datasetsIdsOrDatasetId) {\r\n              return (\r\n                <DatasetDomain\r\n                  hub={hub}\r\n                  node={node}\r\n                  nodeCode={nodeCode}\r\n                  catalog={catalog}\r\n                  categoryPath={path.slice(0, -1)}\r\n                  datasetId={datasetsIdsOrDatasetId}\r\n                  datasetTitle={catalog.datasets[datasetsIdsOrDatasetId].title}\r\n                  notes={catalog.datasets[datasetsIdsOrDatasetId]?.note}\r\n                  attachedFiles={catalog.datasets[datasetsIdsOrDatasetId]?.attachedDataFiles}\r\n                  referenceMetadataUrl={catalog.datasets[datasetsIdsOrDatasetId]?.referenceMetadata}\r\n                  isAccessible={!!a11yParam}\r\n                />\r\n              );\r\n            } else {\r\n              goToNode(nodeCode);\r\n            }\r\n          }\r\n\r\n          goToNode(nodeCode);\r\n        }}\r\n      />\r\n      <Route\r\n        path={`${match.url}/:categoryId`}\r\n        render={({match}) => <Recursive match={match} path={[...path, match.params.categoryId]}/>}\r\n      />\r\n    </Switch>;\r\n\r\n  return (\r\n    <div style={{width: \"100%\", height: \"100%\"}} id={node?.code ? (\"node__\" + node.code) : null}>\r\n      <Switch>\r\n        <Route\r\n          exact\r\n          path={isDefault ? ['/:lang/:nodeCode', '/:lang'] : '/:lang/:nodeCode'}\r\n          render={props => (\r\n            <Node\r\n              {...props}\r\n              nodeCode={nodeCode}\r\n              hub={hub}\r\n              node={node}\r\n              catalog={catalog}\r\n              isDefault={isDefault}\r\n            />\r\n          )}\r\n        />\r\n        <Route\r\n          exact\r\n          path={['/:lang/:nodeCode/dashboards', '/:nodeCode/dashboards']}\r\n          render={() => (\r\n            <DashboardsDomain\r\n              nodeCode={nodeCode}\r\n            />\r\n          )}\r\n        />\r\n        {node && catalog && node.code.toLowerCase() === nodeCode.toLowerCase() && node.nodeId === catalog.nodeId && (\r\n          <Route\r\n            path='/:lang/:nodeCode/search'\r\n            render={({location}) => {\r\n              const query = new URLSearchParams(location.search).get(\"q\");\r\n              const filtersParams =\r\n                (new URLSearchParams(location.search).get(\"c\") || \"\")\r\n                  .split(\"//\").filter(str => str.length > 0).map(decodeURIComponent)\r\n                  .map(filter => filter.split(\"/\")).filter(path => path.length > 0);\r\n\r\n              let filters = [];\r\n              filtersParams.forEach(filter => filter.forEach(id => filters.push(id)));\r\n              filters = [...new Set(filters)]; // remove duplicates\r\n\r\n              if (query && query.length > 0) {\r\n\r\n                const testDSForQuery = ds =>\r\n                  (ds.title || \"\").toLowerCase().includes(query.toLowerCase()) ||\r\n                  !!ds.keywords?.find(keyword => keyword.toLowerCase().includes(query.toLowerCase()));\r\n\r\n                const testCatForFilters = cat => filters.length === 0 || filters.includes(cat.id);\r\n\r\n                const dssForCount = [];   // satisfy only query (necessary to display count numbers)\r\n                const dssForResults = []; // satisfy query and filters\r\n\r\n                if (catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0) {\r\n                  catalog.uncategorizedDatasets.forEach(ds => {\r\n\r\n                    ds.categoryPath = [\"uncategorized\"];\r\n\r\n                    if (testDSForQuery(ds)) {\r\n                      dssForCount.push(ds);\r\n                      if (filters.length === 0 || filters.includes(\"uncategorized\")) {\r\n                        dssForResults.push(ds);\r\n                      }\r\n                    }\r\n                  });\r\n                }\r\n\r\n                const searchRecursive = (categories, categoryPath, overrideCatSatisfyFilters = false) => {\r\n\r\n                  categories.forEach(c => {\r\n\r\n                    const catSatisfyFilters = overrideCatSatisfyFilters || testCatForFilters(c);\r\n\r\n                    c.datasetIdentifiers.forEach(id => {\r\n                      const ds = {\r\n                        ...catalog.datasets[id],\r\n                        identifier: id,\r\n                        categoryPath: [...categoryPath, c.id]\r\n                      };\r\n                      if (testDSForQuery(ds)) {\r\n                        dssForCount.push(ds);\r\n                        if (catSatisfyFilters) {\r\n                          dssForResults.push(ds);\r\n                        }\r\n                      }\r\n                    });\r\n\r\n                    searchRecursive(c.childrenCategories, [...categoryPath, c.id], catSatisfyFilters);\r\n                  });\r\n                };\r\n\r\n                if (catalog.categoryGroups.length > 1) {\r\n                  // with category schemes\r\n                  catalog.categoryGroups.forEach(group => searchRecursive(group.categories, [group.id]));\r\n                } else if (catalog.categoryGroups.length === 1) {\r\n                  // no category schemes\r\n                  searchRecursive(catalog.categoryGroups[0].categories, []);\r\n                }\r\n\r\n                const dssSatisfyQueryMap = {};\r\n                dssForCount.forEach(ds => dssSatisfyQueryMap[ds.identifier] = ds);\r\n\r\n                const recursiveCountAndFilterZero = tree => tree.map(node => {\r\n\r\n                  const children = recursiveCountAndFilterZero(node.childrenCategories || node.categories).filter(({count}) => count > 0);\r\n\r\n                  return ({\r\n                    ...node,\r\n                    childrenCategories: node.childrenCategories ? children : undefined,\r\n                    categories: node.categories ? children : undefined,\r\n                    count:\r\n                      children.reduce((acc, node) => acc + node.count, 0) +\r\n                      (node.datasetIdentifiers?.filter(dsId => dssSatisfyQueryMap[dsId] !== undefined).length || 0)\r\n                  });\r\n                }).filter(({count}) => count > 0);\r\n\r\n                const categoryGroupsWithCount = recursiveCountAndFilterZero(catalog.categoryGroups);\r\n\r\n                const uncategorizedDatasetsCount = catalog.uncategorizedDatasets.filter(({identifier}) => dssSatisfyQueryMap[identifier] !== undefined).length;\r\n\r\n                // remove duplicates from results ( O(2n) )\r\n                const resultsMap = {};\r\n                dssForResults.forEach(ds => resultsMap[ds.identifier] = ds);\r\n\r\n                return (\r\n                  <Results\r\n                    query={query}\r\n                    filters={filtersParams}\r\n                    filtered\r\n                    hub={hub}\r\n                    node={node}\r\n                    nodeCode={nodeCode}\r\n                    catalog={catalog}\r\n                    datasets={Object.keys(resultsMap).map(id => resultsMap[id])}\r\n                    categoryGroupsWithCount={categoryGroupsWithCount}\r\n                    uncategorizedDatasetsCount={uncategorizedDatasetsCount}\r\n                  />\r\n                );\r\n              } else {\r\n                goToNode(nodeCode);\r\n              }\r\n            }}\r\n          />\r\n        )}\r\n        {node && catalog && node.code.toLowerCase() === nodeCode.toLowerCase() && node.nodeId === catalog.nodeId && (\r\n          <Route\r\n            path='/:lang/:nodeCode/:path'\r\n            render={({match}) => (\r\n              <Recursive match={match} path={[match.params.path]}/>\r\n            )}\r\n          />\r\n        )}\r\n      </Switch>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(NodeDomain);","import {useEffect} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport {setAppLanguage} from \"../state/app/appActions\";\r\nimport {useLocation} from \"react-router\";\r\nimport {goToHome} from \"../links\";\r\n\r\nconst mapStateToProps = state => ({\r\n  appLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  node: state.node\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  setAppLanguage: (language, nodeId) => dispatch(setAppLanguage(language, nodeId)),\r\n});\r\n\r\nconst MultiLanguageDomain = ({language, languages, appLanguage, setAppLanguage, children, node}) => {\r\n\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    if (appLanguage !== language && languages.includes(language)) {\r\n      setAppLanguage(language, node ? node.nodeId : null);\r\n    } else if (language !== undefined && !languages.includes(language)) {\r\n      goToHome(true);\r\n    } else if (!languages.includes(language)) {\r\n      goToHome();\r\n    }\r\n  }, [language, languages, setAppLanguage, appLanguage, node, location.pathname]);\r\n\r\n  return (appLanguage === language && languages.includes(language))\r\n    ? children\r\n    : null;\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MultiLanguageDomain);\r\n","export const APP_LANGUAGE_SET = \"app/languageSet\";\r\n\r\nexport const setAppLanguage = (language: string, nodeId: number) => ({\r\n  type: APP_LANGUAGE_SET,\r\n  payload: {\r\n    language,\r\n    nodeId\r\n  }\r\n});\r\n","const DEFAULT_THEME = {\r\n  palette: {\r\n    text: {\r\n      primary: \"#00295a\"\r\n    },\r\n    primary: {\r\n      main: \"#00295a\",\r\n      light: \"#3b5187\",\r\n      dark: \"#000030\",\r\n      contrastText: \"#ffffff\"\r\n    },\r\n    secondary: {\r\n      main: \"#f8a81e\",\r\n      light: \"#ffd956\",\r\n      dark: \"#c07900\",\r\n      contrastText: \"#00295a\"\r\n    }\r\n  }\r\n};\r\n\r\nexport default DEFAULT_THEME;","import React, {useEffect, useState} from 'react';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\n\r\nconst NotImplementedSnackbar = ({t}) => {\r\n\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isInitialized) {\r\n      window.notImplemented = {\r\n        show: () => {\r\n          setIsOpen(true);\r\n        }\r\n      };\r\n      setIsInitialized(true);\r\n    }\r\n  }, [isInitialized]);\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{vertical: 'top', horizontal: 'center'}}\r\n      open={isOpen}\r\n      autoHideDuration={5000}\r\n      onClose={() => setIsOpen(false)}\r\n      ClickAwayListenerProps={{\r\n        onClickAway: () => {\r\n        }\r\n      }}\r\n    >\r\n      <Alert severity=\"warning\">{t(\"components.notImplementedSnackbar.label\")}</Alert>\r\n    </Snackbar>\r\n  );\r\n};\r\n\r\nexport default withTranslation()(NotImplementedSnackbar);","import React, {useEffect, useState} from 'react';\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\n\r\n\r\nconst ErrorSnackbar = () => {\r\n\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [message, setMessage] = useState(null);\r\n  const [isError, setIsError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (!isInitialized) {\r\n      window.error = {\r\n        show: (message, isError) => {\r\n          setIsVisible(true);\r\n          setMessage(message);\r\n          setIsError(isError !== undefined ? isError : true);\r\n        }\r\n      };\r\n      setIsInitialized(true);\r\n    }\r\n  }, [isInitialized]);\r\n\r\n  return (\r\n    <Snackbar\r\n      open={isVisible}\r\n      autoHideDuration={5000}\r\n      onClose={() => {\r\n        setIsVisible(false);\r\n      }}\r\n      onExited={() => {\r\n        setMessage(null);\r\n        setIsError(null);\r\n      }}\r\n      ClickAwayListenerProps={{\r\n        onClickAway: () => {\r\n        }\r\n      }}\r\n      anchorOrigin={{vertical: 'top', horizontal: 'center'}}\r\n    >\r\n      <Alert severity={isError ? \"error\" : \"success\"}>\r\n        <SanitizedHTML component=\"span\" html={message}/>\r\n      </Alert>\r\n    </Snackbar>\r\n  );\r\n};\r\n\r\nexport default ErrorSnackbar;","import React from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport {DialogActions} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {closeDeleteConflictModal} from \"../../state/delete-conflict-modal/deleteConflictModalActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst getObjectTranslation = t => ({\r\n  dashboard: t(\"components.deleteConflictModal.objectType.dashboard\"),\r\n  view: t(\"components.deleteConflictModal.objectType.view\"),\r\n  node: t(\"components.deleteConflictModal.objectType.node\"),\r\n});\r\n\r\nconst DeleteConflictModal = ({\r\n                               response,\r\n                               onClose,\r\n                               onForce\r\n                             }) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={!!response}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n      onClose={onClose}\r\n    >\r\n      <DialogTitle>\r\n        {t(\"components.deleteConflictModal.title\")}\r\n      </DialogTitle>\r\n      {response?.usedBy?.length > 0 && (\r\n        <DialogContent>\r\n          {onForce\r\n            ? <p>{t(\"components.deleteConflictModal.contentTitleWithForce\")}</p>\r\n            : <p>{t(\"components.deleteConflictModal.contentTitle\")}</p>\r\n          }\r\n          <div>\r\n            {response.usedBy.map(({type, title, id}, index) =>\r\n              <ul key={index}>{getObjectTranslation(t)[type]} {id} - {title}</ul>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      )}\r\n      <DialogActions>\r\n        <Button onClick={onClose}>\r\n          {t(\"commons.confirm.close\")}\r\n        </Button>\r\n        {onForce && (\r\n          <Button onClick={onForce}>\r\n            {t(\"components.deleteConflictModal.force\")}\r\n          </Button>\r\n        )}\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default connect(\r\n  state => ({\r\n    response: state.deleteConflictModal.response\r\n  }),\r\n  dispatch => ({\r\n    onClose: () => dispatch(closeDeleteConflictModal())\r\n  })\r\n)(DeleteConflictModal);","export const DELETE_CONFLICT_MODAL_CLOSE = \"deleteConflictModal/close\";\r\n\r\nexport const closeDeleteConflictModal = () => ({\r\n    type: DELETE_CONFLICT_MODAL_CLOSE\r\n});","import React, {forwardRef, Fragment, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\nimport {setUserPassword} from \"../../../state/user/userActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch} = useForm();\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showPasswordConfirm, setShowPasswordConfirm] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        onSubmit(val);\r\n        f(val);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"email\"\r\n            label={t(\"components.userSetPasswordDialog.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowPassword(!showPassword)}\r\n                  >\r\n                    {showPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"password\"\r\n            label={t(\"components.userSetPasswordDialog.fields.password\")}\r\n            error={!!errors.password}\r\n            helperText={errors.password?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showPassword ? undefined : \"password\"}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowPassword(!showPassword)}\r\n                  >\r\n                    {showPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n            inputProps={{\r\n              autoComplete: \"new-password\"\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"passwordConfirm\"\r\n            label={t(\"components.userSetPasswordDialog.fields.passwordConfirm\")}\r\n            error={!!errors.passwordConfirm}\r\n            helperText={errors.passwordConfirm?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showPasswordConfirm ? undefined : \"password\"}\r\n            inputRef={\r\n              register({\r\n                required: t(\"commons.validation.required\"),\r\n                validate: val =>\r\n                  val === watch('password') ||\r\n                  t(\"components.userSetPasswordDialog.validation.passwordMustBeEqual\")\r\n              })}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowPasswordConfirm(!showPasswordConfirm)}\r\n                  >\r\n                    {showPasswordConfirm ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n            inputProps={{\r\n              autoComplete: \"new-password\"\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  sendConfig: (token, config) => dispatch(setUserPassword(config.email, token, config.password)),\r\n});\r\n\r\nconst UserSetPasswordForm = ({config, token, sendConfig, userErrors}, ref) => {\r\n\r\n  return (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>)\r\n      )}\r\n      <Form\r\n        ref={ref}\r\n        onSubmit={config => sendConfig(token, config)}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserSetPasswordForm);\r\n","import React, {useRef} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport UserSetPasswordForm from \"./user-set-password-form\";\r\nimport {hideUserSetPasswordForm} from \"../../state/user/userActions\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onClose: () => dispatch(hideUserSetPasswordForm())\r\n});\r\n\r\nconst UserSetPasswordDialog = ({user, onClose}) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const setPasswordFormRef = useRef();\r\n\r\n  return (\r\n    <SettingsDialog\r\n      title={t(\"components.userSetPasswordDialog.title\")}\r\n      maxWidth={\"xs\"}\r\n      open={user.isSetPasswordDialogOpen || false}\r\n      onClose={() => {\r\n        if (setPasswordFormRef.current) {\r\n          setPasswordFormRef.current.cancel(() => {\r\n            onClose();\r\n          });\r\n        } else {\r\n          onClose();\r\n        }\r\n      }}\r\n      onSubmit={() => {\r\n        if (setPasswordFormRef.current) {\r\n          setPasswordFormRef.current.submit(() => {\r\n          });\r\n        }\r\n      }}\r\n      hasSubmit\r\n      noMinHeight\r\n    >\r\n      <UserSetPasswordForm ref={setPasswordFormRef} token={user.setPasswordToken}/>\r\n    </SettingsDialog>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserSetPasswordDialog);\r\n","import React, {useEffect, useState} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {withStyles, withTheme} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport \"./style.css\";\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\nimport {flushSpinner} from \"../../state/spinner/spinnerActions\";\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\n\r\nconst styles = theme => ({\r\n  container: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  overlay: {\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    zIndex: 2000\r\n  },\r\n  progressContainer: {\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\"\r\n  },\r\n  progress: {\r\n    width: 320,\r\n    maxWidth: \"50%\"\r\n  },\r\n  messagesContainer: {\r\n    position: \"relative\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    textAlign: \"center\"\r\n  },\r\n  messages: {\r\n    display: \"inline-block\",\r\n    marginTop: \"calc(50vh + 48px)\"\r\n  },\r\n  childrenContainer: {\r\n    position: \"absolute\",\r\n    top: 0,\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  messageRow: {\r\n    height: 32\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  messages: state.spinner.messages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  flushSpinner: () => dispatch(flushSpinner())\r\n});\r\n\r\nconst Spinner = ({classes, theme, children, messages, flushSpinner}) => {\r\n\r\n  const [isHandlerOn, setIsHandlerOn] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isHandlerOn) {\r\n      window.addEventListener('popstate', () => {\r\n        flushSpinner();\r\n      });\r\n      setIsHandlerOn(true);\r\n    }\r\n  }, [flushSpinner, isHandlerOn]);\r\n\r\n  return (\r\n    <Box className={classes.container}>\r\n      <Box\r\n        id=\"spinner\"\r\n        className={classes.overlay + \" \" + (messages.length === 0 ? \"invisible\" : \"\")}\r\n        style={{\r\n          background: \"rgba(0, 0, 0, 0.7)\",\r\n        }}\r\n      >\r\n        <Box className={classes.progressContainer}>\r\n          <LinearProgress className={classes.progress} color=\"secondary\"/>\r\n        </Box>\r\n        <Box className={classes.messagesContainer}>\r\n          <Box className={classes.messages}>\r\n            {messages.map(({uid, message, removed, isError}) =>\r\n              <Grid container key={uid}\r\n                    justify={messages.filter(({removed}) => removed).length > 0 ? \"space-between\" : \"center\"}\r\n                    className={classes.messageRow}\r\n                    spacing={2}>\r\n                <Grid item>\r\n                  <Typography color=\"secondary\">\r\n                    {message} {!removed && \"...\"}\r\n                  </Typography>\r\n                </Grid>\r\n                {removed && (\r\n                  <Grid item\r\n                        style={{color: isError ? theme.palette.error.main : theme.palette.success.main}}>\r\n                    {isError ? <CancelIcon fontSize=\"small\"/> : <CheckCircleIcon fontSize=\"small\"/>}\r\n                  </Grid>\r\n                )}\r\n              </Grid>\r\n            )}\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n      <Box className={classes.childrenContainer}\r\n           style={{overflow: messages.length > 0 ? \"hidden\" : \"initial\"}}>\r\n        {children}\r\n      </Box>\r\n    </Box>\r\n  )\r\n    ;\r\n};\r\n\r\nexport default compose(withStyles(styles), withTheme, connect(mapStateToProps, mapDispatchToProps))(Spinner);","import React from 'react';\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {goToHome} from \"../../links\";\r\n\r\nconst styles = theme => ({\r\n  container: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    height: \"100%\",\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    overflow: \"hidden\",\r\n    fontSize: 24\r\n  },\r\n  icon: {\r\n    marginBottom: theme.spacing(1),\r\n    fontSize: 38\r\n  },\r\n  goHome: {\r\n    marginTop: theme.spacing(2),\r\n    textDecoration: \"underline\",\r\n    cursor: \"pointer\",\r\n    color: theme.palette.secondary.main\r\n  }\r\n});\r\n\r\nclass ErrorBoundary extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {hasError: false};\r\n  }\r\n\r\n  componentDidCatch(error, info) {\r\n    this.setState({hasError: true});\r\n  }\r\n\r\n  render() {\r\n\r\n    const {classes} = this.props;\r\n\r\n    if (this.state.hasError) {\r\n\r\n      return (\r\n        <div className={classes.container} style={{color: \"white\"}}>\r\n          <div>\r\n            <Grid container justify=\"center\" className={classes.icon}>\r\n              <Grid item>\r\n                <ErrorOutlineIcon fontSize=\"inherit\"/>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container justify=\"center\">\r\n              <Grid item>\r\n                Something went wrong\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container justify=\"center\" className={classes.goHome}>\r\n              <Grid item>\r\n                <div onClick={() => {\r\n                  goToHome();\r\n                  window.location.reload();\r\n                }}>\r\n                  Go to home\r\n                </div>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </div>\r\n      );\r\n\r\n    } else {\r\n      return this.props.children;\r\n    }\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(ErrorBoundary);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {ThemeProvider} from \"@material-ui/core/styles\";\r\nimport {createMuiTheme, CssBaseline} from \"@material-ui/core\";\r\nimport colorString from \"color-string\";\r\nimport {withTheme} from \"@material-ui/styles\";\r\nimport _ from \"lodash\";\r\nimport DEFAULT_THEME from \"../../utils/defaultTheme\";\r\nimport NotImplementedSnackbar from \"../not-implemented-snackbar/NotImplementedSnackbar\";\r\nimport ErrorSnackbar from \"../error-snackbar/ErrorSnackbar\";\r\nimport DeleteConflictModal from \"../delete-conflict-modal\";\r\nimport UserSetPasswordDialog from \"../user-set-password-dialog\";\r\nimport Spinner from \"../spinner/Spinner\";\r\nimport ErrorBoundary from \"../error-boundary\";\r\nimport Helmet from \"react-helmet\";\r\n\r\n/*\r\n  custom.css can be used to apply colors in the mui theme.\r\n  any color in the following \"theme object\" can be changed:\r\n  https://material-ui.com/customization/default-theme/#default-theme\r\n\r\n  just put a css rule in custom.css like this:\r\n  .theme__palette-error-main { color: #FF0000 }\r\n\r\n  each selector must start with \".theme__\" and continue with the path in the \"theme object\"\r\n  the properties in the path must be separated by \"-\".\r\n  if the selector don't follow these rules, it will be discarded.\r\n  other rules different from color (e.g. fontSize) cannot be changed and will be discarded.\r\n\r\n  you can apply colors also for specific nodes, like this:\r\n  .theme__node__NODE_ID__palette-error-main { color: #FF0000 }\r\n\r\n  make sure NODE_ID is equal (case sensitive) to the id of the node and\r\n  make sure rules for specific nodes are written after general rules\r\n\r\n  e.g. this is correct, second rule will override first rule if NODE_ID is selected in the app:\r\n  .theme__palette-error-main { color: #FF0000 }\r\n  .theme__node__NODE_ID__palette-error-main { color: #FF0000 }\r\n\r\n  but THIS IS NOT CORRECT (second rule will always override first rule, even if NODE_ID is selected:\r\n  .theme__node__NODE_ID__palette-error-main { color: #FF0000 }\r\n  .theme__palette-error-main { color: #FF0000 }\r\n*/\r\n\r\nexport const CUSTOM_CSS_SELECTOR_PREFIX = \".theme__\";\r\nexport const CUSTOM_CSS_SELECTOR_NODE_PREFIX = \".theme__node__\"\r\nconst CUSTOM_CSS_SELECTOR_PATH_SPLIT_CHAR = \"-\";\r\n\r\nconst WithCustomTheme = ({children, getPath}) => {\r\n\r\n    const [theme, setTheme] = useState(undefined);\r\n\r\n    useEffect(() => {\r\n\r\n\r\n      fetch('./custom.css')\r\n        .then(response => response.text())\r\n        .then(css => {\r\n\r\n          const doc = document.implementation.createHTMLDocument(\"\");\r\n          const styleEl = document.createElement(\"style\");\r\n          styleEl.textContent = String(css);\r\n          doc.body.appendChild(styleEl);\r\n\r\n          const customTheme = {};\r\n\r\n          Object.values(styleEl.sheet.cssRules)\r\n            .filter(({selectorText, style}) =>\r\n              getPath(selectorText) &&\r\n              style[0] === \"color\" &&\r\n              style.color.length > 0 &&\r\n              colorString.get.rgb(style.color) !== null\r\n            )\r\n            .forEach(({selectorText, style}) => {\r\n\r\n              const path = getPath(selectorText).split(CUSTOM_CSS_SELECTOR_PATH_SPLIT_CHAR);\r\n\r\n              let pointer = customTheme;\r\n              path.forEach((prop, index) => {\r\n                if (index === path.length - 1) {\r\n                  pointer[prop] = colorString.to.rgb(colorString.get.rgb(style.color));\r\n                } else {\r\n                  if (!pointer[prop]) {\r\n                    pointer[prop] = {};\r\n                  }\r\n                  pointer = pointer[prop];\r\n                }\r\n              });\r\n            });\r\n\r\n          setTheme(createMuiTheme(_.merge(_.cloneDeep(DEFAULT_THEME), customTheme)));\r\n        });\r\n\r\n    }, [getPath])\r\n    return theme\r\n      ? (\r\n        <Fragment>\r\n          <Helmet>\r\n            {/* eslint-disable-next-line react/style-prop-object */}\r\n            <body style={\"background-color: \" + theme.palette.primary.main}/>\r\n          </Helmet>\r\n          <CssBaseline/>\r\n          <ThemeProvider theme={theme}>\r\n            <ErrorBoundary>\r\n              <Spinner>\r\n                <NotImplementedSnackbar/>\r\n                <ErrorSnackbar/>\r\n                <DeleteConflictModal/>\r\n                <UserSetPasswordDialog/>\r\n                {children}\r\n              </Spinner>\r\n            </ErrorBoundary>\r\n          </ThemeProvider>\r\n        </Fragment>\r\n      )\r\n      : null;\r\n  }\r\n;\r\n\r\nexport default withTheme(WithCustomTheme);","import React, {Fragment, useEffect} from 'react';\r\nimport {Route, Switch} from 'react-router';\r\nimport Home from '../components/home';\r\nimport {connect} from 'react-redux';\r\nimport {fetchHub} from '../state/hub/hubActions';\r\nimport NodeDomain from './NodeDomain';\r\nimport {HashRouter} from 'react-router-dom';\r\nimport DashboardsDomain from './DashboardsDomain';\r\nimport {goToHome} from '../links';\r\nimport Call from '../hocs/call';\r\nimport MultiLanguageDomain from './MultiLanguageDomain';\r\nimport {showUserSetPasswordForm} from '../state/user/userActions';\r\nimport WithCustomTheme, {\r\n  CUSTOM_CSS_SELECTOR_NODE_PREFIX,\r\n  CUSTOM_CSS_SELECTOR_PREFIX\r\n} from \"../components/with-custom-theme\";\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub,\r\n  defaultLanguage: state.app.language\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchHub: () => dispatch(fetchHub()),\r\n  onUserSetPasswordFormShow: token => dispatch(showUserSetPasswordForm(token))\r\n});\r\n\r\nconst WithCustomThemeForNode = ({children, nodeCode}) =>\r\n  <WithCustomTheme\r\n    getPath={selectorText => {\r\n      const prefix = CUSTOM_CSS_SELECTOR_NODE_PREFIX + nodeCode + \"__\";\r\n      if (selectorText.startsWith(prefix)) {\r\n        return selectorText.substr(prefix.length);\r\n      } else if (selectorText.startsWith(CUSTOM_CSS_SELECTOR_PREFIX) &&\r\n        !selectorText.startsWith(CUSTOM_CSS_SELECTOR_NODE_PREFIX)) {\r\n        return selectorText.substr(CUSTOM_CSS_SELECTOR_PREFIX.length);\r\n      } else {\r\n        return false;\r\n      }\r\n    }}\r\n  >\r\n    {children}\r\n  </WithCustomTheme>;\r\n\r\nconst WithCustomThemeNoNode = ({children}) =>\r\n  <WithCustomTheme\r\n    getPath={selectorText => {\r\n      if (selectorText.startsWith(CUSTOM_CSS_SELECTOR_PREFIX) &&\r\n        !selectorText.startsWith(CUSTOM_CSS_SELECTOR_NODE_PREFIX)) {\r\n        return selectorText.substr(CUSTOM_CSS_SELECTOR_PREFIX.length);\r\n      } else {\r\n        return false;\r\n      }\r\n    }}\r\n  >\r\n    {children}\r\n  </WithCustomTheme>;\r\n\r\nconst HubDomain = ({hub, fetchHub, onUserSetPasswordFormShow}) => {\r\n\r\n  useEffect(() => {\r\n    if (!hub) {\r\n      fetchHub();\r\n    }\r\n  }, [hub, fetchHub]);\r\n\r\n  const defaultNode = hub?.nodes.find(node => node.default === true);\r\n\r\n  return (\r\n    <Fragment>\r\n      {hub && (\r\n        <HashRouter>\r\n          <Switch>\r\n            <Route\r\n              path='/'\r\n              exact\r\n              render={props => {\r\n\r\n                if (defaultNode !== undefined) {\r\n                  return (\r\n                    <MultiLanguageDomain\r\n                      language={props.match.params.lang}>\r\n                      <WithCustomThemeForNode nodeCode={defaultNode.code}>\r\n                        <NodeDomain {...props}\r\n                                    nodeCode={defaultNode.code}\r\n                                    isDefault\r\n                        />\r\n                      </WithCustomThemeForNode>\r\n                    </MultiLanguageDomain>\r\n                  );\r\n                } else {\r\n                  return (\r\n                    <WithCustomThemeNoNode>\r\n                      <Home {...props}/>\r\n                    </WithCustomThemeNoNode>\r\n                  );\r\n                }\r\n              }}\r\n            />\r\n            <Route\r\n              path='/:lang'\r\n              exact\r\n              render={props => {\r\n\r\n                if (defaultNode !== undefined) {\r\n                  return (\r\n                    <MultiLanguageDomain\r\n                      language={props.match.params.lang}>\r\n                      <WithCustomThemeForNode nodeCode={defaultNode.code}>\r\n                        <NodeDomain {...props}\r\n                                    nodeCode={defaultNode.code}\r\n                                    isDefault\r\n                        />\r\n                      </WithCustomThemeForNode>\r\n                    </MultiLanguageDomain>\r\n                  );\r\n                } else {\r\n                  return (\r\n                    <MultiLanguageDomain language={props.match.params.lang}>\r\n                      <WithCustomThemeNoNode>\r\n                        <Home {...props}/>\r\n                      </WithCustomThemeNoNode>\r\n                    </MultiLanguageDomain>\r\n                  );\r\n                }\r\n              }}\r\n            />\r\n            <Route\r\n              path='/:lang/dashboards'\r\n              exact\r\n              render={props => (\r\n                <MultiLanguageDomain language={props.match.params.lang}>\r\n                  <WithCustomThemeNoNode>\r\n                    <DashboardsDomain {...props}/>\r\n                  </WithCustomThemeNoNode>\r\n                </MultiLanguageDomain>\r\n              )}\r\n            />\r\n            <Route\r\n              path='/:lang/dashboards/:dashboardId'\r\n              render={props => (\r\n                <MultiLanguageDomain language={props.match.params.lang}>\r\n                  <WithCustomThemeNoNode>\r\n                    <DashboardsDomain {...props}\r\n                                      dashboardId={props.match.params.dashboardId}/>\r\n                  </WithCustomThemeNoNode>\r\n                </MultiLanguageDomain>\r\n              )}\r\n            />\r\n            <Route\r\n              path='/:lang/resetPassword'\r\n              render={props => {\r\n                const tokenParam = new URLSearchParams(props.location.search).get('token');\r\n                if (tokenParam) {\r\n                  return (\r\n                    <MultiLanguageDomain language={props.match.params.lang}>\r\n                      <Call cb={onUserSetPasswordFormShow} cbParam={tokenParam}>\r\n                        <WithCustomThemeNoNode>\r\n                          <Home {...props}/>\r\n                        </WithCustomThemeNoNode>\r\n                      </Call>\r\n                    </MultiLanguageDomain>\r\n                  );\r\n                } else {\r\n                  goToHome();\r\n                }\r\n              }}\r\n            />\r\n            <Route\r\n              path='/:lang/:nodeCode'\r\n              render={props => {\r\n                const node = hub.nodes.find(({code}) =>\r\n                  code.toLowerCase() === props.match.params.nodeCode.toLowerCase()\r\n                );\r\n                if (node) {\r\n                  return (\r\n                    <MultiLanguageDomain language={props.match.params.lang}>\r\n                      <WithCustomThemeForNode nodeCode={node.code}>\r\n                        <NodeDomain {...props} nodeCode={props.match.params.nodeCode}/>\r\n                      </WithCustomThemeForNode>\r\n                    </MultiLanguageDomain>\r\n                  );\r\n                } else {\r\n                  goToHome();\r\n                }\r\n              }}\r\n            />\r\n          </Switch>\r\n        </HashRouter>\r\n      )}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(HubDomain);\r\n","import React, {Fragment} from 'react';\r\nimport HubDomain from \"./domains/HubDomain\";\r\nimport Helmet from \"react-helmet\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst App = ({language}) =>\r\n  <Fragment>\r\n    <Helmet>\r\n      <html lang={language}/>\r\n    </Helmet>\r\n    <HubDomain/>\r\n  </Fragment>;\r\n\r\nexport default connect(state => ({\r\n  language: state.app.language\r\n}))(App);","import {Reducer} from \"@reduxjs/toolkit\";\r\nimport {IHub} from \"../../model/IHub\";\r\nimport {IHubMinimalNode} from \"../../model/IHubMinimalNode\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {HUB_CLEAR, HUB_FETCH} from \"./hubActions\";\r\n\r\nexport type HubState = {\r\n  hub: IHub,\r\n  nodes: IHubMinimalNode[]\r\n} | null;\r\n\r\nconst hubReducer: Reducer<HubState> = (\r\n  state: HubState = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case HUB_CLEAR: {\r\n      return null;\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case HUB_FETCH: {\r\n          return ({\r\n            hub: action.payload.response.hub,\r\n            nodes: action.payload.response.nodes\r\n          });\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default hubReducer;","import {IHubNode} from \"../../model/IHubNode\";\r\nimport {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {NODE_CLEAR, NODE_FETCH} from \"./nodeActions\";\r\n\r\nexport type NodeState = IHubNode | null;\r\n\r\nconst nodeReducer: Reducer<NodeState> = (\r\n  state = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODE_CLEAR: {\r\n      return null;\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODE_FETCH: {\r\n          return action.payload.response;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodeReducer;","import {ICategoryProvider} from \"./ICategoryProvider\";\r\nimport {IFilter} from \"./IFilter\";\r\nimport {ICategoryGroup} from \"./ICategoryGroup\";\r\nimport {ICategory} from \"./ICategory\";\r\nimport {IDataset} from \"./IDataset\";\r\n\r\nexport class LocalCategoryProvider implements ICategoryProvider {\r\n\r\n  categoryGroups: Array<ICategoryGroup>;\r\n\r\n  datasets: Map<String, IDataset>;\r\n\r\n  uncategorizedDatasets: IDataset[];\r\n\r\n  nodeId: number;\r\n\r\n  constructor(categories: Array<ICategoryGroup>, datasets: Map<String, IDataset>, uncategorizedDatasets: IDataset[] = [], nodeId: number = -1) {\r\n    this.datasets = datasets || {};\r\n    this.categoryGroups = categories || [];\r\n    this.uncategorizedDatasets = uncategorizedDatasets || [];\r\n    this.nodeId = nodeId || -1;\r\n  }\r\n\r\n  searchCategories(filter?: IFilter): Array<ICategory> {\r\n\r\n    let result: Array<ICategory> = [];\r\n\r\n    let searchText: string;\r\n    if (filter) {\r\n      searchText = filter.text.toLowerCase();\r\n    }\r\n\r\n    this.categoryGroups.forEach(categ => {\r\n\r\n      if (!searchText) {\r\n        result.push(...categ.categories);\r\n      } else {\r\n        categ.categories.forEach(category => {\r\n          let matchFound: boolean = category.label.toLowerCase().indexOf(searchText) >= 0;\r\n\r\n          if (matchFound) {\r\n            result.push(category);\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  searchDataset(filter?: IFilter): IDataset[] {\r\n    return [];\r\n  }\r\n}","import {ReducersMapObject} from \"redux\";\r\nimport hubReducer from \"./hub/hubReducer\";\r\nimport nodeReducer from \"./node/nodeReducer\";\r\nimport catalogReducer from \"./catalog/catalogReducer\";\r\nimport datasetReducer from \"./dataset/datasetReducer\";\r\nimport appReducer from \"./app/appReducer\";\r\nimport hubConfigReducer from \"./hubConfig/hubConfigReducer\";\r\nimport spinnerReducer from \"./spinner/spinnerReducer\";\r\nimport configReducer from \"./config/configReducer\";\r\nimport nodesConfigReducer from \"./nodesConfig/nodesConfigReducer\";\r\nimport cacheReducer from \"./cache/cacheReducer\";\r\nimport otherConfigReducer from \"./otherConfig/otherConfigReducer\";\r\nimport nodeTemplatesConfigReducer from \"./noteTemplatesConfig/nodeTemplatesConfigReducer\";\r\nimport userReducer from './user/userReducer';\r\nimport usersConfigReducer from \"./usersConfig/usersConfigReducer\";\r\nimport dashboardReducer from \"./dashboard/dashboardReducer\";\r\nimport nodePermissionsConfigReducer from './nodePermissionsConfig/nodePermissionsConfigReducer';\r\nimport deleteConflictModalReducer from './delete-conflict-modal/deleteConflictModalReducer';\r\nimport appConfigReducer from './appConfig/appConfigReducer';\r\n\r\nconst rootReducer: ReducersMapObject = ({\r\n  spinner: spinnerReducer,\r\n  appConfig: appConfigReducer,\r\n  config: configReducer,\r\n  app: appReducer,\r\n  hub: hubReducer,\r\n  node: nodeReducer,\r\n  nodeTemplatesConfig: nodeTemplatesConfigReducer,\r\n  catalog: catalogReducer,\r\n  dataset: datasetReducer,\r\n  hubConfig: hubConfigReducer,\r\n  nodesConfig: nodesConfigReducer,\r\n  cacheConfig: cacheReducer,\r\n  otherConfig: otherConfigReducer,\r\n  user: userReducer,\r\n  usersConfig: usersConfigReducer,\r\n  dashboard: dashboardReducer,\r\n  nodePermissionsConfig: nodePermissionsConfigReducer,\r\n  deleteConflictModal: deleteConflictModalReducer\r\n});\r\n\r\nexport default rootReducer;","import {Reducer} from \"redux\";\r\nimport {\r\n  SPINNER_FLUSH,\r\n  SPINNER_MESSAGE_ADD,\r\n  SPINNER_MESSAGE_REMOVE,\r\n  SPINNER_TIMEOUT_CLEAR,\r\n  SPINNER_TIMEOUT_SET\r\n} from \"./spinnerActions\";\r\n\r\nexport type SpinnerState = {\r\n  messages: any[],\r\n  timeout: any\r\n};\r\n\r\nconst spinnerReducer: Reducer<SpinnerState> = (\r\n  state = {\r\n    messages: [],\r\n    timeout: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case SPINNER_MESSAGE_ADD: {\r\n      return {\r\n        ...state,\r\n        messages: [...state.messages, ({uid: action.payload.uid, message: action.payload.message, removed: false})]\r\n      };\r\n    }\r\n    case SPINNER_MESSAGE_REMOVE: {\r\n      return {\r\n        ...state,\r\n        messages: [\r\n          ...state.messages.map(message => message.uid !== action.payload.uid ? message : ({...message, removed: true, isError: action.payload.isError}))\r\n        ]\r\n      };\r\n    }\r\n    case SPINNER_TIMEOUT_SET: {\r\n      return {\r\n        ...state,\r\n        timeout: action.payload.timeout\r\n      };\r\n    }\r\n    case SPINNER_TIMEOUT_CLEAR: {\r\n      return {\r\n        ...state,\r\n        timeout: null\r\n      };\r\n    }\r\n    case SPINNER_FLUSH: {\r\n      if (state.timeout) {\r\n        clearTimeout(state.timeout);\r\n      }\r\n      return {\r\n        ...state,\r\n        timeout: null,\r\n        messages: []\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default spinnerReducer;","import {Reducer} from \"redux\";\r\nimport {INIT} from '../rootActions';\r\n\r\nexport type ConfigState = object | null;\r\n\r\nconst appConfigReducer: Reducer<ConfigState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT: {\r\n            return action.payload.appConfig;\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default appConfigReducer;","import {Reducer} from \"redux\";\r\nimport {INIT} from '../rootActions';\r\n\r\nexport type ConfigState = {\r\n  baseURL: string\r\n} | null;\r\n\r\nconst configReducer: Reducer<ConfigState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n  switch (action.type) {\r\n    case INIT: {\r\n      return {\r\n        baseURL: action.payload.baseURL\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default configReducer;","import {Reducer} from \"redux\";\r\nimport {APP_LANGUAGE_SET} from \"./appActions\";\r\nimport {INIT} from '../rootActions';\r\nimport {PERSISTENCE_ACTION_KEY} from '../../middlewares/persistence/middleware';\r\nimport _ from \"lodash\";\r\n\r\nexport type AppState = {\r\n    language: string,\r\n    languages: string[]\r\n} | null\r\n    ;\r\nconst appReducer: Reducer<AppState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT:\r\n            const initialState = {\r\n                language: action.payload.defaultLanguage,\r\n                languages: action.payload.supportedLanguages\r\n            };\r\n            return _.merge(initialState, action.payload[PERSISTENCE_ACTION_KEY].app) || initialState;\r\n        case APP_LANGUAGE_SET: {\r\n            return {\r\n                ...state,\r\n                language: action.payload.language\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default appReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {NODE_TEMPLATES_CONFIG_CLEAR, NODE_TEMPLATES_CONFIG_FETCH} from \"./nodeTemplatesConfigActions\";\r\n\r\nexport type NodesConfigState = {\r\n  templates: any[] | null\r\n};\r\n\r\nconst nodeTemplatesConfigReducer: Reducer<NodesConfigState> = (\r\n  state = {\r\n    templates: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODE_TEMPLATES_CONFIG_CLEAR: {\r\n      return {\r\n        ...state,\r\n        templates: null\r\n      };\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODE_TEMPLATES_CONFIG_FETCH: {\r\n          return {\r\n            ...state,\r\n            templates: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodeTemplatesConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {CATALOG_CLEAR, CATALOG_FETCH} from \"./catalogActions\";\r\nimport {ICategoryProvider} from \"../../model/ICategoryProvider\";\r\nimport {LocalCategoryProvider} from \"../../model/LocalCategoryProvider\";\r\n\r\nexport type CatalogState = ICategoryProvider | null;\r\n\r\nconst catalogReducer: Reducer<CatalogState> = (\r\n  state = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case CATALOG_CLEAR: {\r\n      return null;\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case CATALOG_FETCH: {\r\n          return new LocalCategoryProvider(\r\n            action.payload.response.categoryGroups,\r\n            action.payload.response.datasetMap,\r\n            action.payload.response.datasetUncategorized,\r\n            action.payload.extra.nodeId\r\n          );\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default catalogReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  HUB_CONFIG_CLEAR,\r\n  HUB_CONFIG_DASHBOARDS_CLEAR,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n  HUB_CONFIG_DASHBOARDS_FETCH,\r\n  HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n  HUB_CONFIG_FETCH,\r\n  HUB_CONFIG_SEND,\r\n  HUB_CONFIG_DASHBOARDS_CLEAR_ALL,\r\n  HUB_CONFIG_DASHBOARDS_FETCH_ALL\r\n} from \"./hubConfigActions\";\r\n\r\nexport type HubConfigState = {\r\n  hub: any | null,\r\n  hubDashboards: any[] | null,\r\n  allDashboards: any[] | null\r\n};\r\n\r\nconst hubConfigReducer: Reducer<HubConfigState> = (\r\n    state = {\r\n      hub: null,\r\n      hubDashboards: null,\r\n      allDashboards: null\r\n    },\r\n    action\r\n) => {\r\n  switch (action.type) {\r\n    case HUB_CONFIG_CLEAR: {\r\n      return {\r\n        ...state,\r\n        hub: null\r\n      };\r\n    }\r\n    case HUB_CONFIG_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        hubDashboards: null\r\n      };\r\n    }\r\n    case HUB_CONFIG_DASHBOARDS_CLEAR_ALL: {\r\n      return {\r\n        ...state,\r\n        allDashboards: null\r\n      };\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case HUB_CONFIG_FETCH: {\r\n          return {\r\n            ...state,\r\n            hub: action.payload.response[0]\r\n          }\r\n        }\r\n        case HUB_CONFIG_SEND: {\r\n          return {\r\n            ...state,\r\n            hub: null,\r\n            hubDashboards: null\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            hubDashboards: action.payload.response\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_FETCH_ALL: {\r\n          return {\r\n            ...state,\r\n            allDashboards: action.payload.response\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD:\r\n          return {\r\n            ...state,\r\n            allDashboards: null,\r\n            hubDashboards: null\r\n          };\r\n        case HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE:\r\n        case HUB_CONFIG_DASHBOARDS_ORDERS_SEND:\r\n          return {\r\n            ...state,\r\n            hubDashboards: null\r\n          }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default hubConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_START, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  NODES_CONFIG_NODE_CLEAR,\r\n  NODES_CONFIG_NODE_CREATE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_CLEAR,\r\n  NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_FETCH,\r\n  NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL,\r\n  NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n  NODES_CONFIG_NODE_EDIT,\r\n  NODES_CONFIG_NODE_FETCH,\r\n  NODES_CONFIG_NODES_CLEAR,\r\n  NODES_CONFIG_NODES_FETCH\r\n} from \"./nodesConfigActions\";\r\nimport {IHubNode} from \"../../model/IHubNode\";\r\n\r\nexport type NodesConfigState = {\r\n  nodes: IHubNode[] | null,\r\n  node: IHubNode | null,\r\n  nodeDashboards: any[] | null,\r\n  allDashboards: any[] | null\r\n};\r\n\r\nconst nodesConfigReducer: Reducer<NodesConfigState> = (\r\n  state = {\r\n    nodes: null,\r\n    node: null,\r\n    nodeDashboards: null,\r\n    allDashboards: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODES_CONFIG_NODES_CLEAR: {\r\n      return {\r\n        ...state,\r\n        nodes: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_CLEAR: {\r\n      return {\r\n        ...state,\r\n        node: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        nodeDashboards: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL: {\r\n      return {\r\n        ...state,\r\n        allDashboards: null\r\n      };\r\n    }\r\n    case REQUEST_START: {\r\n      switch (action.payload.label) {\r\n        case NODES_CONFIG_NODE_EDIT: {\r\n          return {\r\n            ...state,\r\n            node: null\r\n          };\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODES_CONFIG_NODES_FETCH: {\r\n          return {\r\n            ...state,\r\n            nodes: action.payload.response\r\n          };\r\n        }\r\n        case NODES_CONFIG_NODE_FETCH: {\r\n          return {\r\n            ...state,\r\n            node: action.payload.response\r\n          }\r\n        }\r\n        case NODES_CONFIG_NODE_CREATE:\r\n        case NODES_CONFIG_NODE_EDIT:\r\n          return {\r\n            ...state,\r\n            node: null\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_FETCH:\r\n          return {\r\n            ...state,\r\n            nodeDashboards: action.payload.response\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL:\r\n          return {\r\n            ...state,\r\n            allDashboards: action.payload.response\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD:\r\n          return {\r\n            ...state,\r\n            allDashboards: null,\r\n            nodeDashboards: null\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE:\r\n        case NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND:\r\n          return {\r\n            ...state,\r\n            nodeDashboards: null\r\n          }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodesConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {IDataflowCache} from \"../../model/IDataflowCache\";\r\nimport {\r\n  DATAFLOW_CACHE_CLEAR,\r\n  DATAFLOW_CACHE_CREATE,\r\n  DATAFLOW_CACHE_DELETE,\r\n  DATAFLOW_CACHE_FETCH,\r\n  DATAFLOW_CACHE_UPDATE\r\n} from \"./cacheActions\";\r\n\r\nexport type DataflowCacheState =  IDataflowCache[] | null;\r\n\r\nconst cacheReducer: Reducer<DataflowCacheState> = (\r\n  state =  null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DATAFLOW_CACHE_FETCH: {\r\n          return action.payload.response;\r\n        }\r\n        case DATAFLOW_CACHE_UPDATE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.id === action.payload.extra.cacheId && e.nodeId === action.payload.extra.nodeId) {\r\n                  e.ttl = action.payload.extra.ttl;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        case DATAFLOW_CACHE_CREATE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.dataflowId === action.payload.extra.oldData.dataflowId && e.nodeId === action.payload.extra.oldData.nodeId) {\r\n                  e.ttl = action.payload.response.ttl;\r\n                  e.id = action.payload.response.id;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        case DATAFLOW_CACHE_DELETE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.id === action.payload.extra.cacheId && e.nodeId === action.payload.extra.nodeId) {\r\n                  e.cacheSize = 0;\r\n                  e.cachedDataflow = 0;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DATAFLOW_CACHE_FETCH: {\r\n          return null;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case DATAFLOW_CACHE_CLEAR: {\r\n      return null;\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default cacheReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  OTHER_CONFIG_DASHBOARD_CHANGE,\r\n  OTHER_CONFIG_DASHBOARD_CREATE,\r\n  OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT,\r\n  OTHER_CONFIG_DASHBOARD_DATASET_CLEAR,\r\n  OTHER_CONFIG_DASHBOARD_DATASET_FETCH,\r\n  OTHER_CONFIG_DASHBOARD_DATASET_FILTER_SET,\r\n  OTHER_CONFIG_DASHBOARD_DELETE,\r\n  OTHER_CONFIG_DASHBOARD_HIDE,\r\n  OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR,\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_FETCH,\r\n  OTHER_CONFIG_DASHBOARDS_CLEAR,\r\n  OTHER_CONFIG_DASHBOARDS_FETCH,\r\n  OTHER_CONFIG_VIEW_DELETE,\r\n  OTHER_CONFIG_VIEWS_CLEAR,\r\n  OTHER_CONFIG_VIEWS_FETCH\r\n} from \"./otherConfigActions\";\r\nimport _ from \"lodash\"\r\nimport {DASHBOARD_VIEW_STATE_ERROR, DASHBOARD_VIEW_STATE_FETCHING} from \"../dashboard/dashboardReducer\";\r\nimport {\r\n  DASHBOARD_ELEM_ENABLE_FILTERS_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../utils/dashboards\";\r\nimport {\r\n  getFilteredChartLayout,\r\n  getFilteredMapLayout,\r\n  getFilteredTableLayout,\r\n  getFilterTreeFromJsonStat,\r\n  getUpdatedLayout\r\n} from \"../../utils/jsonStat\";\r\nimport {getNutsLevelTranslations} from \"../../constants/getNutsLevelTranslations\";\r\n\r\nexport type OtherConfigState = {\r\n  views: any[] | null,\r\n  needDashboards: boolean,\r\n  dashboards: any[] | null,\r\n  dashboard: any | null,\r\n  dashboardViews: any[] | null,\r\n  dashboardJsonStats: any,\r\n  dashboardLayouts: any,\r\n  dashboardFilterTrees: any,\r\n  dashboardMaps: any,\r\n};\r\n\r\nconst otherConfigReducer: Reducer<OtherConfigState> = (\r\n  state = {\r\n    views: null,\r\n    needDashboards: false,\r\n    dashboards: null,\r\n    dashboard: null,\r\n    dashboardViews: null,\r\n    dashboardJsonStats: null,\r\n    dashboardLayouts: null,\r\n    dashboardFilterTrees: null,\r\n    dashboardMaps: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case OTHER_CONFIG_VIEWS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        views: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboardViews: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboards: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_CREATE: {\r\n      return {\r\n        ...state,\r\n        dashboard: action.payload.dashboard\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_CHANGE: {\r\n      return {\r\n        ...state,\r\n        dashboard: action.payload.dashboard\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_HIDE: {\r\n      return {\r\n        ...state,\r\n        dashboard: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_DATASET_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboardJsonStats: null,\r\n        dashboardMaps: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_DATASET_FILTER_SET: {\r\n      return {\r\n        ...state,\r\n        dashboardLayouts: {\r\n          ...state.dashboardLayouts,\r\n          [action.payload.viewIdx]: {\r\n            ...state.dashboardLayouts[action.payload.viewIdx],\r\n            layout: getUpdatedLayout(\r\n              action.payload.dimension,\r\n              action.payload.value,\r\n              state.dashboardJsonStats[action.payload.viewIdx],\r\n              state.dashboardLayouts[action.payload.viewIdx].layout,\r\n              state.dashboardFilterTrees[action.payload.viewIdx]\r\n            )\r\n          }\r\n        }\r\n      }\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            needDashboards: false\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n          let layouts = _.cloneDeep(state.dashboardLayouts);\r\n          let filterTrees = _.cloneDeep(state.dashboardFilterTrees);\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: DASHBOARD_VIEW_STATE_FETCHING\r\n            };\r\n            layouts = {\r\n              ...layouts,\r\n              [id]: null\r\n            };\r\n            filterTrees = {\r\n              ...filterTrees,\r\n              [id]: null\r\n            };\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats,\r\n            dashboardLayouts: layouts,\r\n            dashboardFilterTrees: filterTrees\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_VIEWS_FETCH: {\r\n          return {\r\n            ...state,\r\n            views: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_VIEWS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboardViews: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        case OTHER_CONFIG_VIEW_DELETE: {\r\n          return {\r\n            ...state,\r\n            views: null\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboards: action.payload.response\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_UPDATE: {\r\n          return {\r\n            ...state,\r\n            dashboard: {\r\n              ...action.payload.response,\r\n              dashboardConfig: action.payload.response?.dashboardConfig\r\n                ? JSON.parse(action.payload.response.dashboardConfig)\r\n                : {},\r\n              filterLevels: action.payload.response?.filterLevels\r\n                ? JSON.parse(action.payload.response.filterLevels)\r\n                : {}\r\n            }\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DELETE:\r\n        case OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT:\r\n        case OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            needDashboards: true\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n          let layouts = _.cloneDeep(state.dashboardLayouts);\r\n          let filterTrees = _.cloneDeep(state.dashboardFilterTrees);\r\n\r\n          state.dashboard.dashboardConfig.forEach((row: any, rowIdx: number) => {\r\n            row.forEach((col: any, colIdx: number) => {\r\n              const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n              if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW && action.payload.extra.requestIds.includes(viewIdx)) {\r\n                const view = state.dashboard.views[col[DASHBOARD_ELEM_VALUE_KEY]];\r\n\r\n                if ((action.payload.response?.id || []).length === 0) {\r\n                  jsonStats[viewIdx] = \"\";\r\n                  layouts[viewIdx] = null;\r\n                  filterTrees[viewIdx] = null;\r\n\r\n                } else {\r\n                  const viewLayouts = JSON.parse(view.layouts);\r\n                  let viewLayout;\r\n                  if (viewLayouts.tableLayout) {\r\n                    viewLayout = getFilteredTableLayout(viewLayouts.tableLayout, action.payload.response);\r\n                  } else if (viewLayouts.mapLayout) {\r\n                    viewLayout = getFilteredMapLayout(viewLayouts.mapLayout, action.payload.response);\r\n                  } else {\r\n                    viewLayout = getFilteredChartLayout(viewLayouts.chartLayout, action.payload.response);\r\n                  }\r\n\r\n                  jsonStats[viewIdx] = action.payload.response;\r\n                  layouts[viewIdx] = {\r\n                    layout: viewLayout,\r\n                    tableEmptyChar: viewLayouts.tableEmptyChar,\r\n                    mapDetailLevel: viewLayouts.mapDetailLevel,\r\n                    chartStacked: viewLayouts.chartStacked,\r\n                    chartLegendPosition: viewLayouts.chartLegendPosition,\r\n                    chartColors: viewLayouts.chartColors\r\n                  };\r\n                  filterTrees[viewIdx] = col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY]\r\n                    ? getFilterTreeFromJsonStat(viewLayout, action.payload.response)\r\n                    : null;\r\n                }\r\n              }\r\n            });\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats,\r\n            dashboardLayouts: layouts,\r\n            dashboardFilterTrees: filterTrees\r\n          }\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any) => val.nutsLevel)\r\n            .reduce((acc: any, level: any) => {\r\n              if (!acc[level]) {\r\n                // @ts-ignore\r\n                const label = getNutsLevelTranslations(action.payload.extra.t)[level];\r\n                acc[level] = {level: level, counter: 0, label: (label || `nutsLevel${level}`)};\r\n              }\r\n              acc[level].counter++;\r\n              return acc;\r\n            }, [])\r\n            .filter((val: any) => !!val);\r\n\r\n          return {\r\n            ...state,\r\n            dashboardMaps: {\r\n              ...state.dashboardMaps,\r\n              [action.payload.extra.viewIdx]: {\r\n                geometries: action.payload.response,\r\n                geometryDetailLevels: detailLevels\r\n              }\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_ERROR:\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboards: action.payload.statusCode === 404 ? [] : null\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n          let layouts = _.cloneDeep(state.dashboardLayouts);\r\n          let filterTrees = _.cloneDeep(state.dashboardFilterTrees);\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: DASHBOARD_VIEW_STATE_ERROR\r\n            };\r\n            layouts = {\r\n              ...layouts,\r\n              [id]: null\r\n            };\r\n            filterTrees = {\r\n              ...filterTrees,\r\n              [id]: null\r\n            };\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats,\r\n            dashboardLayouts: layouts,\r\n            dashboardFilterTrees: filterTrees\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default otherConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_START, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    USERS_CONFIG_USER_CLEAR,\r\n    USERS_CONFIG_USER_CREATE,\r\n    USERS_CONFIG_USER_EDIT,\r\n    USERS_CONFIG_USER_FETCH,\r\n    USERS_CONFIG_USERS_CLEAR,\r\n    USERS_CONFIG_USERS_FETCH,\r\n    USER_CONFIG_FORM_SHOW, USER_CONFIG_FORM_HIDE\r\n} from \"./usersConfigActions\";\r\n\r\nexport type User = {\r\n\r\n};\r\n\r\nexport type UsersConfigState = {\r\n    users: User[] | null,\r\n    user: User | null,\r\n    userErrors: string[] | null,\r\n    userId: number | null,\r\n    isSetPasswordDialogOpen: boolean,\r\n    setPasswordToken: string | null\r\n};\r\n\r\nconst usersConfigReducer: Reducer<UsersConfigState> = (\r\n    state = {\r\n        users: null,\r\n        user: null,\r\n        userErrors: null,\r\n        userId: null,\r\n        isSetPasswordDialogOpen: false,\r\n        setPasswordToken: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case USER_CONFIG_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                userId: action.payload.userId\r\n            };\r\n        case USER_CONFIG_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                user: null,\r\n                userId: null,\r\n                userErrors: null\r\n            };\r\n        case USERS_CONFIG_USERS_CLEAR: {\r\n            return {\r\n                ...state,\r\n                users: null\r\n            };\r\n        }\r\n        case USERS_CONFIG_USER_CLEAR: {\r\n            return {\r\n                ...state,\r\n                user: null\r\n            };\r\n        }\r\n        case REQUEST_START: {\r\n            switch (action.payload.label) {\r\n                case USERS_CONFIG_USER_EDIT: {\r\n                    return {\r\n                        ...state,\r\n                        user: null\r\n                    };\r\n                }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case USERS_CONFIG_USERS_FETCH: {\r\n                    return {\r\n                        ...state,\r\n                        users: action.payload.response\r\n                    };\r\n                }\r\n                case USERS_CONFIG_USER_FETCH: {\r\n                    return {\r\n                        ...state,\r\n                        user: action.payload.response\r\n                    }\r\n                }\r\n                case USERS_CONFIG_USER_CREATE:\r\n                case USERS_CONFIG_USER_EDIT:\r\n                    if (action.payload.response.haveError) {\r\n                        return {\r\n                            ...state,\r\n                            userErrors: action.payload.response.errors\r\n                        };\r\n                    } else {\r\n                        return {\r\n                            ...state,\r\n                            user: null,\r\n                            userErrors: null,\r\n                            userId: null\r\n                        };\r\n                    }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default usersConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    NODE_PERMISSIONS_CONFIG_CLEAR,\r\n    NODE_PERMISSIONS_CONFIG_FETCH,\r\n    NODE_PERMISSIONS_CONFIG_SEND\r\n} from './nodePermissionsConfigActions';\r\n\r\nexport type NodePermissionsConfigState = {\r\n    permissions: any[] | null\r\n};\r\n\r\nconst nodePermissionsConfigReducer: Reducer<NodePermissionsConfigState> = (\r\n    state = {\r\n        permissions: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case NODE_PERMISSIONS_CONFIG_CLEAR: {\r\n            return {\r\n                ...state,\r\n                permissions: null\r\n            };\r\n        }\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case NODE_PERMISSIONS_CONFIG_FETCH: {\r\n                    return {\r\n                        state,\r\n                        permissions: action.payload.response\r\n                    };\r\n                }\r\n                case NODE_PERMISSIONS_CONFIG_SEND:\r\n                    return {permissions: null};\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default nodePermissionsConfigReducer;","import {Reducer} from 'redux';\r\nimport {REQUEST_ERROR, RequestMethod} from '../../middlewares/request/requestActions';\r\nimport {DELETE_CONFLICT_MODAL_CLOSE} from './deleteConflictModalActions';\r\n\r\ntype DeleteConflictModalState = {\r\n    response: any | null,\r\n    onForce: any | null\r\n};\r\n\r\nconst deleteConflictModalReducer: Reducer<DeleteConflictModalState> = (\r\n    state = {\r\n        response: null,\r\n        onForce: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case REQUEST_ERROR:\r\n            if (action.payload.statusCode === 409 && action.payload.method === RequestMethod.DELETE) {\r\n                return {\r\n                    ...state,\r\n                    response: action.payload.response,\r\n                    onForce: action.payload.extra?.onDeleteConflictForce || null\r\n                };\r\n            } else {\r\n                return state;\r\n            }\r\n        case DELETE_CONFLICT_MODAL_CLOSE:\r\n            return {\r\n                ...state,\r\n                response: null,\r\n                onForce: null\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default deleteConflictModalReducer;","import {\r\n  clearUser,\r\n  showUserLoginForm,\r\n  USER_PASSWORD_CHANGE, USER_PASSWORD_SET,\r\n  USER_REFRESH, USER_RESET_PASSWORD_EMAIL_SEND\r\n} from \"../../state/user/userActions\";\r\nimport {REQUEST_INIT, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {HUB_FETCH} from \"../../state/hub/hubActions\";\r\nimport {NODE_FETCH} from \"../../state/node/nodeActions\";\r\nimport {goToHome} from \"../../links\";\r\n\r\nconst userMiddlewareFactory = t => ({dispatch, getState}) => next => action => {\r\n\r\n  const state = getState();\r\n\r\n  let result;\r\n\r\n  // if a request is starting but auth token is expired\r\n  if (\r\n    action.type === REQUEST_INIT &&\r\n    action.payload.label !== HUB_FETCH &&\r\n    action.payload.label !== NODE_FETCH &&\r\n    action.payload.label !== USER_REFRESH &&\r\n    state.user.isAuthenticated &&\r\n    state.user.tokenReceivedTime !== null &&\r\n    state.user.tokenTTL !== null &&\r\n    new Date(new Date().getTime() - state.user.tokenReceivedTime).getMinutes()\r\n    >= state.user.tokenTTL - 1\r\n  ) {\r\n\r\n    /*\r\n      result = next(refreshUser()); // block current request dispatching, and replace it with token refresh request\r\n      dispatch(setUserDelayedRequestWhenTokenExpired(action)); // delay current (request) action\r\n    */\r\n\r\n    result = next(({type: \"NOP\"}));\r\n    if (window.error) {\r\n      window.error.show(t(\"middlewares.user.sessionExpired\"));\r\n    }\r\n    dispatch(clearUser());\r\n\r\n  } else {\r\n\r\n    result = next(action); // do nothing, continue action dispatching as normal\r\n\r\n  }\r\n\r\n  // if sent token is expired (in some cases it can happen, even if i checked expiration in the previous code)\r\n  if (action.payload?.extra?.responseHeaders && action.payload.extra.responseHeaders[\"token-expired\"]) {\r\n    /*\r\n      dispatch(clearUser()); // init user state\r\n      dispatch(showUserLoginForm(\"Authentication is expired. Please log in again.\")); // show login form with alert\r\n     */\r\n\r\n    if (window.error) {\r\n      window.error.show(t(\"middlewares.user.sessionExpired\"));\r\n    }\r\n    dispatch(clearUser());\r\n\r\n  }\r\n\r\n  // if token has been refreshed and delayed request is pending\r\n  if (action.type === REQUEST_SUCCESS && action.payload?.label === USER_REFRESH && state.user.delayedRequest) {\r\n    dispatch(state.user.delayedRequest); // dispatch pending (request) action\r\n  }\r\n\r\n  if (action.type === REQUEST_SUCCESS && (\r\n    action.payload.label === USER_PASSWORD_CHANGE ||\r\n    action.payload.label === USER_PASSWORD_SET\r\n  )) {\r\n    window.error.show(t(\"middlewares.user.passwordChangedLoginNecessary\"), false);\r\n    goToHome();\r\n    dispatch(showUserLoginForm());\r\n  } else if (action.type === REQUEST_INIT && action.payload.label === USER_RESET_PASSWORD_EMAIL_SEND) {\r\n    window.error.show(t(\"middlewares.user.resetPasswordEmailSent\"), false);\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport default userMiddlewareFactory;","import {errorRequest, REQUEST_INIT, RequestActionPayload, startRequest, successRequest} from './requestActions';\r\nimport axios, {AxiosResponse} from 'axios';\r\nimport {Middleware} from 'redux';\r\nimport {PayloadAction} from \"@reduxjs/toolkit\";\r\n\r\nconst requestMiddlewareFactory = (\r\n  options: {\r\n    onSuccess?: (requestAction: object, data?: any, extra?: any) => void,\r\n    onManagedServerError?: (requestAction: RequestActionPayload, statusCode: number, managedServerError: any) => void,\r\n    onGenericError?: (requestAction: RequestActionPayload, statusCode?: number) => void\r\n  }\r\n): Middleware =>\r\n  ({dispatch, getState}) => next => action => {\r\n\r\n    const handleSuccess = (requestAction: RequestActionPayload, response: AxiosResponse) => {\r\n\r\n      if (options.onSuccess) {\r\n        options.onSuccess(requestAction, response.data, {\r\n          responseHeaders: response.headers\r\n        });\r\n      }\r\n\r\n      dispatch(successRequest(requestAction, response.data, {\r\n        responseHeaders: response.headers,\r\n        status: response.status\r\n      }));\r\n    };\r\n\r\n    const handleManagedServerError = (requestAction: RequestActionPayload, response: AxiosResponse) => {\r\n\r\n      if (options.onManagedServerError && (!requestAction?.getHideErrorMessage || !requestAction.getHideErrorMessage(response?.status))) {\r\n        options.onManagedServerError(requestAction, response.status, response.data);\r\n      }\r\n\r\n      dispatch(errorRequest(requestAction, response.status, response.data, {responseHeaders: response.headers}));\r\n    };\r\n\r\n    const handleGenericError = (requestAction: RequestActionPayload, response?: AxiosResponse) => {\r\n\r\n      if (options.onGenericError && (!requestAction?.getHideErrorMessage || !requestAction.getHideErrorMessage(response?.status))) {\r\n        options.onGenericError(requestAction, response?.status);\r\n      }\r\n\r\n      dispatch(errorRequest(requestAction, response?.status, response?.data, {responseHeaders: response?.headers}));\r\n    };\r\n\r\n    const handleError = (requestAction: RequestActionPayload, response?: AxiosResponse) => {\r\n\r\n      if (response?.data) {\r\n\r\n        if (response.data.usedBy !== undefined) {\r\n          handleManagedServerError(requestAction, response);\r\n        } else {\r\n          handleGenericError(requestAction, response);\r\n        }\r\n      } else {\r\n        handleGenericError(requestAction, response);\r\n      }\r\n    };\r\n\r\n    const result = next(action);\r\n\r\n    if (action.type !== REQUEST_INIT) {\r\n      return result;\r\n    }\r\n\r\n    const requestAction: PayloadAction<RequestActionPayload> = action;\r\n\r\n    dispatch(startRequest(requestAction.payload));\r\n\r\n    let {\r\n      method,\r\n      url,\r\n      data,\r\n      baseURL,\r\n      contentType,\r\n      doNotTransformResponse\r\n    } = requestAction.payload;\r\n\r\n    const token = getState().user.token;\r\n\r\n    axios.request({\r\n      method,\r\n      url: ((baseURL && baseURL.length > 0) ? baseURL : getState().config.baseURL) + url,\r\n      data,\r\n      headers: {\r\n        \"UserLang\": getState().app.language,\r\n        \"Authorization\": token ? `bearer ${token}` : undefined,\r\n        \"Content-Type\": contentType || undefined\r\n      },\r\n      withCredentials: true,\r\n      transformResponse: doNotTransformResponse ? res => res : undefined\r\n    }).then((response: AxiosResponse) => {\r\n      if (response.status.toString()[0] === \"2\") {\r\n        handleSuccess(requestAction.payload, response);\r\n      } else {\r\n        handleError(requestAction.payload, response);\r\n      }\r\n    }).catch(error => {\r\n      console.log(error);\r\n      handleError(requestAction.payload, error.response);\r\n    });\r\n\r\n    return result;\r\n  };\r\n\r\nexport default requestMiddlewareFactory;\r\n","import {REQUEST_START, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {\r\n  fetchHubConfigDashboards,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n  HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n  HUB_CONFIG_SEND\r\n} from \"../../state/hubConfig/hubConfigActions\";\r\nimport {fetchHub} from \"../../state/hub/hubActions\";\r\nimport {\r\n  fetchNodesConfigNodeDashboards,\r\n  fetchNodesConfigNodes,\r\n  NODES_CONFIG_NODE_CREATE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n  NODES_CONFIG_NODE_DELETE,\r\n  NODES_CONFIG_NODE_EDIT,\r\n  NODES_CONFIG_NODES_ORDER_SEND\r\n} from \"../../state/nodesConfig/nodesConfigActions\";\r\nimport {\r\n  fetchUsersConfigUsers,\r\n  USERS_CONFIG_USER_CREATE,\r\n  USERS_CONFIG_USER_DELETE,\r\n  USERS_CONFIG_USER_EDIT,\r\n} from \"../../state/usersConfig/usersConfigActions\";\r\nimport {goToHome} from \"../../links\";\r\nimport {\r\n  fetchOtherConfigViews,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  OTHER_CONFIG_VIEW_DELETE\r\n} from \"../../state/otherConfig/otherConfigActions\";\r\nimport {\r\n  fetchNodeTemplatesConfig,\r\n  NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE\r\n} from \"../../state/noteTemplatesConfig/nodeTemplatesConfigActions\";\r\nimport {\r\n  DATAFLOW_CACHE_DELETE_ALL,\r\n  DATAFLOW_CACHE_DELETE_CATALOG,\r\n  fetchDataflowCache\r\n} from \"../../state/cache/cacheActions\";\r\nimport {fetchCatalog} from \"../../state/catalog/catalogActions\";\r\nimport {fetchNode} from \"../../state/node/nodeActions\";\r\nimport {clearDashboardsDashboards} from \"../../state/dashboard/dashboardActions\";\r\n\r\nconst configMiddleware = ({dispatch, getState}) => next => action => {\r\n\r\n  const state = getState();\r\n\r\n  const res = next(action);\r\n\r\n  if (action.type === REQUEST_START && action.payload.label === NODES_CONFIG_NODE_DELETE) {\r\n    if (state.node && state.node.nodeId === action.payload.extra?.nodeId) {\r\n      goToHome();\r\n    }\r\n  }\r\n\r\n  if (action.type === REQUEST_SUCCESS) {\r\n    switch (action.payload.label) {\r\n      case HUB_CONFIG_SEND: {\r\n        goToHome();\r\n        dispatch(fetchHub());\r\n        break;\r\n      }\r\n      case HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD:\r\n      case HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE:\r\n      case HUB_CONFIG_DASHBOARDS_ORDERS_SEND: {\r\n        dispatch(fetchHubConfigDashboards());\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD:\r\n      case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE:\r\n      case NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND: {\r\n        dispatch(fetchNodesConfigNodeDashboards(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODES_ORDER_SEND: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_EDIT: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        if (state.node && state.node.nodeId === action.payload.extra.nodeId) {\r\n          goToHome();\r\n          dispatch(fetchNode(action.payload.extra.nodeId));\r\n        }\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_CREATE:\r\n      case NODES_CONFIG_NODE_DELETE: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        break;\r\n      }\r\n      case USERS_CONFIG_USER_EDIT:\r\n      case USERS_CONFIG_USER_DELETE: {\r\n        if (!action.payload.response.haveError && !action.payload.extra?.isAnonymous) {\r\n          dispatch(fetchUsersConfigUsers());\r\n        }\r\n        break;\r\n      }\r\n      case USERS_CONFIG_USER_CREATE:\r\n        if (!action.payload.response.haveError && !action.payload.extra?.isAnonymous) {\r\n          dispatch(fetchUsersConfigUsers());\r\n        } else if (!action.payload.response.haveError && action.payload.extra?.isAnonymous) {\r\n          goToHome();\r\n          window.location.reload();\r\n        }\r\n        break;\r\n      case OTHER_CONFIG_VIEW_DELETE: {\r\n        dispatch(fetchOtherConfigViews());\r\n        break;\r\n      }\r\n      case NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE: {\r\n        dispatch(fetchNodeTemplatesConfig(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case DATAFLOW_CACHE_DELETE_ALL: {\r\n        dispatch(fetchDataflowCache(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case DATAFLOW_CACHE_DELETE_CATALOG: {\r\n        if (state.node && state.node.nodeId === action.payload.extra.nodeId) {\r\n          goToHome();\r\n          dispatch(fetchCatalog(action.payload.extra.nodeId));\r\n        }\r\n        break;\r\n      }\r\n      case OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT: {\r\n        if (state.dashboard.dashboards && state.dashboard.dashboards[action.payload.extra.dashboardId]) {\r\n          dispatch(clearDashboardsDashboards());\r\n        }\r\n        break;\r\n      }\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport default configMiddleware;","import {REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport FileSaver from \"file-saver\";\r\nimport {QUERY_LOG_DOWNLOAD} from \"../../components/settings-select/actions\";\r\nimport {DATASET_DOWNLOAD_SUBMIT} from \"../../state/dataset/datasetActions\";\r\nimport {DASHBOARDS_DATASET_DOWNLOAD_SUBMIT} from \"../../state/dashboard/dashboardActions\";\r\n\r\nconst fileSaveMiddleware = () => next => action => {\r\n\r\n  const result = next(action);\r\n\r\n  if (action.type === REQUEST_SUCCESS && action.payload.extra.fileSave) {\r\n    if (\r\n      action.payload.label === QUERY_LOG_DOWNLOAD ||\r\n      action.payload.label === DATASET_DOWNLOAD_SUBMIT ||\r\n      action.payload.label === DASHBOARDS_DATASET_DOWNLOAD_SUBMIT\r\n    ) {\r\n\r\n      let name = action.payload.extra.fileSave.name;\r\n\r\n      FileSaver.saveAs(\r\n        new Blob(\r\n          action.payload?.extra?.stringifyResponse\r\n            ? [JSON.stringify(action.payload.response, null, 2)]\r\n            : [action.payload.response],\r\n          {type: action.payload.extra.fileSave.type}\r\n        ),\r\n        name\r\n      )\r\n    }\r\n  }\r\n\r\n  return result;\r\n\r\n};\r\n\r\nexport default fileSaveMiddleware;\r\n","import {APP_LANGUAGE_SET} from \"../../state/app/appActions\";\r\nimport i18n from 'i18next';\r\nimport {INIT} from \"../../state/rootActions\";\r\nimport {PERSISTENCE_ACTION_KEY} from \"../persistence/middleware\";\r\nimport {clearHub} from \"../../state/hub/hubActions\";\r\nimport {clearNode} from \"../../state/node/nodeActions\";\r\nimport {clearCatalog} from \"../../state/catalog/catalogActions\";\r\n\r\nconst i18nMiddleware = ({getState, dispatch}) => next => action => {\r\n\r\n  const res = next(action);\r\n\r\n  window.language = getState().app.language;\r\n\r\n  if (action.type === APP_LANGUAGE_SET) {\r\n    i18n.changeLanguage(action.payload.language, () => {\r\n      dispatch(clearHub());\r\n      if (action.payload.nodeId) {\r\n        dispatch(clearCatalog());\r\n        dispatch(clearNode());\r\n      }\r\n    });\r\n  }\r\n\r\n  if (\r\n    action.type === INIT &&\r\n    action.payload[PERSISTENCE_ACTION_KEY]?.app?.language\r\n  ) {\r\n    if (getState().app.languages.includes(action.payload[PERSISTENCE_ACTION_KEY]?.app?.language)) {\r\n      window.language = action.payload[PERSISTENCE_ACTION_KEY].app.language;\r\n      i18n.changeLanguage(action.payload[PERSISTENCE_ACTION_KEY].app.language)\r\n    }\r\n  }\r\n\r\n  return res;\r\n\r\n};\r\n\r\nexport default i18nMiddleware;","import {REQUEST_ERROR, REQUEST_START, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {\r\n  addSpinnerMessage,\r\n  clearSpinnerTimeout,\r\n  flushSpinner,\r\n  markSpinnerMessage,\r\n  setSpinnerTimeout,\r\n  SPINNER_MESSAGE_ADD,\r\n  SPINNER_MESSAGE_REMOVE\r\n} from \"../../state/spinner/spinnerActions\";\r\n\r\nconst SPINNER_TIMEOUT = 1000;\r\n\r\nconst requestSpinnerMiddlewareFactory = t => ({dispatch, getState}) => next => action => {\r\n\r\n  if ((action.type === REQUEST_START || action.type === REQUEST_SUCCESS || action.type === REQUEST_ERROR) && action.payload.messages) {\r\n\r\n    const messages = action.payload.messages(t);\r\n\r\n    if (messages.onStart) {\r\n      if (action.type === REQUEST_START && !action.payload.hideSpinner) {\r\n        dispatch(addSpinnerMessage(action.payload.uuid, messages.onStart));\r\n      } else if (action.type === REQUEST_SUCCESS && !action.payload.response?.haveError) {\r\n        dispatch(markSpinnerMessage(action.payload.uuid));\r\n      } else if (action.type === REQUEST_ERROR || (action.type === REQUEST_SUCCESS && action.payload.response?.haveError)) {\r\n        dispatch(markSpinnerMessage(action.payload.uuid, true));\r\n      }\r\n    }\r\n  }\r\n\r\n  const result = next(action);\r\n\r\n  const spinnerState = getState().spinner;\r\n\r\n  if (action.type === SPINNER_MESSAGE_ADD) {\r\n    if (spinnerState.timeout) {\r\n      clearTimeout(spinnerState.timeout);\r\n      dispatch(clearSpinnerTimeout());\r\n    }\r\n  } else if (action.type === SPINNER_MESSAGE_REMOVE && !spinnerState.timeout && spinnerState.messages.length > 0 &&\r\n    spinnerState.messages.filter(({removed}) => !removed).length === 0\r\n  ) {\r\n    dispatch(setSpinnerTimeout(setTimeout(() => dispatch(flushSpinner()), SPINNER_TIMEOUT)));\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport default requestSpinnerMiddlewareFactory;","import {CATALOG_FETCH} from \"../../state/catalog/catalogActions\";\r\nimport {REQUEST_SUCCESS} from \"../request/requestActions\";\r\n\r\nconst feedbackMiddlewareFactory = t => ({getState}) => next => action => {\r\n\r\n  const res = next(action);\r\n\r\n  const state = getState();\r\n\r\n  if (\r\n    action.type === REQUEST_SUCCESS &&\r\n    action.payload.label === CATALOG_FETCH &&\r\n    (!state.catalog.uncategorizedDatasets || state.catalog.uncategorizedDatasets.length === 0) &&\r\n    (!state.catalog.datasets || Object.keys(state.catalog.datasets).length === 0)\r\n  ) {\r\n    window.error.show(t('middlewares.feedback.emptyCatalog'));\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport default feedbackMiddlewareFactory;","import {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {DATASET_FETCH} from \"../../state/dataset/datasetActions\";\r\nimport {errorFetchDatasetAsyncHandler, initFetchDatasetAsyncHandler, successFetchDatasetAsyncHandler} from \"./actions\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nconst fetchDatasetAsyncHandlerMiddlewareFactory = t => ({dispatch}) => next => action => {\r\n\r\n  const result = next(action);\r\n\r\n  if (action?.payload?.label === DATASET_FETCH) {\r\n\r\n    if (action.type === REQUEST_INIT) {\r\n      dispatch(initFetchDatasetAsyncHandler());\r\n\r\n    } else if (action.type === REQUEST_SUCCESS) {\r\n\r\n      const spinnerUuid = uuidv4();\r\n      dispatch(addSpinnerMessage(spinnerUuid, t(\"middlewares.fetchDatasetAsyncHandlerMiddlewareFactory.spinners.layoutHandling\")));\r\n\r\n      const myWorker = new Worker(\"./workers/fetchDatasetAsyncHandlerWorker.js\");\r\n      myWorker.onmessage = event => {\r\n        const {\r\n          cellCount,\r\n          isTooBigData,\r\n          isEmptyData,\r\n          isPartialData,\r\n          isResponseNotValid,\r\n          tableLayout,\r\n          mapLayout,\r\n          chartLayout,\r\n          tableFilterTree,\r\n          mapFilterTree,\r\n          chartFilterTree\r\n        } = event.data;\r\n        dispatch(successFetchDatasetAsyncHandler(\r\n          action.payload.response,\r\n          action.payload.extra.status,\r\n          action.payload.extra.responseHeaders,\r\n          cellCount,\r\n          isTooBigData,\r\n          isEmptyData,\r\n          isPartialData,\r\n          isResponseNotValid,\r\n          tableLayout,\r\n          tableFilterTree,\r\n          mapLayout,\r\n          mapFilterTree,\r\n          chartLayout,\r\n          chartFilterTree,\r\n          myWorker\r\n        ));\r\n        dispatch(markSpinnerMessage(spinnerUuid));\r\n      }\r\n      myWorker.onerror = () => {\r\n        dispatch(errorFetchDatasetAsyncHandler());\r\n        dispatch(markSpinnerMessage(spinnerUuid, true));\r\n        window.error.show(t(\"middlewares.fetchDatasetAsyncHandlerMiddlewareFactory.feedback.layoutHandlingError\"));\r\n      }\r\n      myWorker.postMessage({\r\n        response: action.payload.response,\r\n        extra: action.payload.extra\r\n      });\r\n\r\n    } else if (action.type === REQUEST_ERROR) {\r\n      dispatch(errorFetchDatasetAsyncHandler(action.payload.statusCode));\r\n    }\r\n  }\r\n\r\n  return result;\r\n\r\n};\r\n\r\nexport default fetchDatasetAsyncHandlerMiddlewareFactory;\r\n","import {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {\r\n  errorFetchDashboardDatasetAsyncHandler,\r\n  initFetchDashboardDatasetAsyncHandler,\r\n  successFetchDashboardDatasetAsyncHandler\r\n} from \"./actions\";\r\nimport {DASHBOARDS_DATASET_FETCH} from \"../../state/dashboard/dashboardActions\";\r\n\r\nconst fetchDashboardDatasetAsyncHandlerMiddlewareFactory = t => ({getState, dispatch}) => next => action => {\r\n\r\n  const result = next(action);\r\n\r\n  if (action?.payload?.label === DASHBOARDS_DATASET_FETCH) {\r\n\r\n    const {\r\n      dashboardId,\r\n      requestIds,\r\n      worker\r\n    } = action.payload.extra;\r\n\r\n    if (action.type === REQUEST_INIT) {\r\n      dispatch(initFetchDashboardDatasetAsyncHandler(dashboardId));\r\n\r\n    } else if (action.type === REQUEST_SUCCESS) {\r\n\r\n      const state = getState();\r\n\r\n      worker.onmessage = event => {\r\n        const {\r\n          dashboardId,\r\n          newDashboardJsonStats,\r\n          newDashboardLayouts,\r\n          newDashboardFilterTrees\r\n        } = event.data;\r\n        dispatch(successFetchDashboardDatasetAsyncHandler(dashboardId, newDashboardJsonStats, newDashboardLayouts, newDashboardFilterTrees));\r\n      };\r\n      worker.onerror = () => {\r\n        dispatch(errorFetchDashboardDatasetAsyncHandler(dashboardId, requestIds));\r\n        window.error.show(t(\"middlewares.fetchDatasetAsyncHandlerMiddlewareFactory.feedback.layoutHandlingError\"));\r\n      };\r\n      worker.postMessage({\r\n        dashboardId,\r\n        requestIds,\r\n        response: action.payload.response,\r\n        dashboard: state.dashboard.dashboards[dashboardId],\r\n        dashboardJsonStats: state.dashboard.jsonStats[dashboardId],\r\n        dashboardLayouts: state.dashboard.layouts[dashboardId],\r\n        dashboardFilterTrees: state.dashboard.filterTrees[dashboardId]\r\n      });\r\n\r\n    } else if (action.type === REQUEST_ERROR) {\r\n      dispatch(errorFetchDashboardDatasetAsyncHandler(dashboardId, requestIds));\r\n    }\r\n  }\r\n\r\n  return result;\r\n\r\n};\r\n\r\nexport default fetchDashboardDatasetAsyncHandlerMiddlewareFactory;\r\n","import {configureStore} from \"@reduxjs/toolkit\";\r\nimport rootReducer from \"./state/rootReducer\";\r\nimport userMiddlewareFactory from \"./middlewares/user/userMiddlewareFactory\";\r\nimport requestMiddlewareFactory from \"./middlewares/request/requestMiddlewareFactory\";\r\nimport {showGenericError, showTranslatedGenericErrorFactory} from \"./utils/other\";\r\nimport configMiddleware from \"./middlewares/config/configMiddleware\";\r\nimport fileSaveMiddleware from \"./middlewares/file-save/middleware\";\r\nimport persistenceMiddleware from \"./middlewares/persistence/middleware\";\r\nimport i18nMiddleware from \"./middlewares/i18n-middleware/middleware\";\r\nimport i18n from \"i18next\";\r\nimport {initReactI18next} from \"react-i18next\";\r\nimport {init as initAction} from \"./state/rootActions\";\r\nimport requestSpinnerMiddlewareFactory\r\n  from \"./middlewares/request-spinner/requestSpinnerMiddlewareFactory\";\r\nimport {getAppConfigUrl, getHubMinimalInfoUrl, getInitConfigUrl} from \"./serverApi/urls\";\r\nimport feedbackMiddlewareFactory from \"./middlewares/feedback/feedbackMiddleware\";\r\nimport fetchDatasetAsyncHandlerMiddlewareFactory\r\n  from \"./middlewares/fetchDatasetAsyncHandler/middlewareFactory\";\r\nimport fetchDashboardDatasetAsyncHandlerMiddlewareFactory\r\n  from \"./middlewares/fetchDashboardDatasetAsyncHandler/middlewareFactory\";\r\n\r\nconst getRandomParam = () => \"?random=\" + Math.floor(Math.random() * 16777215).toString(16);\r\n\r\nconst init = cb => {\r\n\r\n  fetch(`./${getInitConfigUrl()}${getRandomParam()}`)\r\n    .then(response => response.json())\r\n    .then(({baseURL}) => {\r\n      fetch(`./${getAppConfigUrl()}${getRandomParam()}`)\r\n        .then(response => response.json())\r\n        .then(config => {\r\n\r\n          fetch(`${baseURL}${getHubMinimalInfoUrl()}`)\r\n            .then(response => response.json())\r\n            .then(({hub}) => {\r\n\r\n              Promise.all(\r\n                [\"en\", ...hub.supportedLanguages].map(code =>\r\n                  fetch(`./i18n/${code}.json${getRandomParam()}`)\r\n                    .then(response =>\r\n                      response.headers.get(\"content-type\").indexOf(\"application/json\") !== -1\r\n                        ? response.json()\r\n                        : null\r\n                    )\r\n                    .catch(showGenericError)\r\n                )\r\n              )\r\n                .then(translations => {\r\n\r\n                  let resources = {};\r\n\r\n                  [\"en\", ...hub.supportedLanguages].forEach((code, idx) => {\r\n                    if (translations[idx]) {\r\n                      resources[code] = {translation: translations[idx]}\r\n                    }\r\n                  });\r\n\r\n                  let supportedAndTranslatedLanguages = Object.keys(resources);\r\n\r\n                  if (supportedAndTranslatedLanguages.length < 2) {\r\n                    alert(\"Unable to find translation file for at least one configured language. Please check app configuration and translations file.\");\r\n                  } else if (!hub.supportedLanguages.includes(\"en\")) {\r\n                    supportedAndTranslatedLanguages = supportedAndTranslatedLanguages.filter(lang => lang !== \"en\");\r\n                    delete resources[\"en\"];\r\n                  }\r\n\r\n                  const defaultLanguage =\r\n                    resources[hub.defaultLanguage]\r\n                      ? hub.defaultLanguage\r\n                      : supportedAndTranslatedLanguages[0];\r\n\r\n                  i18n\r\n                    .use(initReactI18next)\r\n                    .init({\r\n                      lng: defaultLanguage,\r\n                      resources,\r\n                      returnEmptyString: false,\r\n                      interpolation: {\r\n                        escapeValue: false\r\n                      }\r\n                    });\r\n\r\n                  const store = configureStore({\r\n                    reducer: rootReducer,\r\n                    middleware: [\r\n                      userMiddlewareFactory(i18n.t.bind(i18n)),\r\n                      requestMiddlewareFactory({\r\n                        onGenericError: showTranslatedGenericErrorFactory(i18n.t.bind(i18n))\r\n                      }),\r\n                      requestSpinnerMiddlewareFactory(i18n.t.bind(i18n)),\r\n                      fileSaveMiddleware,\r\n                      persistenceMiddleware,\r\n                      i18nMiddleware,\r\n                      configMiddleware,\r\n                      feedbackMiddlewareFactory(i18n.t.bind(i18n)),\r\n                      fetchDatasetAsyncHandlerMiddlewareFactory(i18n.t.bind(i18n)),\r\n                      fetchDashboardDatasetAsyncHandlerMiddlewareFactory(i18n.t.bind(i18n))\r\n                    ]\r\n                  });\r\n\r\n                  store.dispatch(initAction(baseURL, supportedAndTranslatedLanguages, defaultLanguage, config));\r\n\r\n                  cb(store);\r\n\r\n                })\r\n                .catch(showGenericError);\r\n            })\r\n            .catch(showGenericError);\r\n        })\r\n        .catch(showGenericError);\r\n    })\r\n    .catch(showGenericError);\r\n};\r\n\r\nexport default init;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport 'typeface-roboto';\r\nimport \"fontsource-do-hyeon\";\r\nimport \"./style.css\";\r\nimport 'flag-icon-css/css/flag-icon.css';\r\nimport {Provider} from 'react-redux'\r\nimport init from \"./init\";\r\n\r\ninit(store =>\r\n  ReactDOM.render(\r\n    <Provider store={store}>\r\n      <App/>\r\n    </Provider>,\r\n    document.getElementById('root')\r\n  ));\r\n"],"sourceRoot":""}