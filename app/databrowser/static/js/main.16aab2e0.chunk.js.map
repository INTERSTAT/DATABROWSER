{"version":3,"sources":["middlewares/request/requestActions.ts","components/not-implemented-snackbar/NotImplementedSnackbar.jsx","state/spinner/spinnerActions.ts","components/spinner/Spinner.jsx","components/error-snackbar/ErrorSnackbar.jsx","components/hero/index.jsx","components/cards-grid/index.jsx","components/page-section/index.jsx","components/page/index.jsx","state/user/userReducer.ts","serverApi/urls.ts","state/user/userActions.ts","components/settings-dialog/index.jsx","components/user-login-dialog/user-recover-password-form/index.jsx","components/user-login-dialog/index.jsx","state/usersConfig/usersConfigActions.ts","components/settings-select/users-settings-form/user-settings-form/index.jsx","components/button-select/index.jsx","components/user-select/user-change-password-form/index.jsx","components/user-select/index.jsx","links.js","components/categories-tree/index.jsx","state/hubConfig/hubConfigActions.ts","components/file-input/index.jsx","components/custom-material-table/index.jsx","utils/i18n.js","components/dashboards-manager/index.jsx","state/rootActions.ts","middlewares/persistence/middleware.js","utils/user.ts","components/i18n-input-adornment-select/index.jsx","components/i18n-text-field/index.jsx","components/html-editor/index.jsx","components/i18n-html-editor/index.jsx","components/settings-select/app-settings-form/index.jsx","state/nodesConfig/nodesConfigActions.ts","utils/datasets.js","components/info-tooltip/index.jsx","components/form-label-with-tooltip/index.jsx","utils/download.js","components/settings-select/nodes-settings-form/node-settings-form/index.jsx","state/dataset/datasetActions.ts","state/cache/cacheActions.ts","components/settings-select/nodes-settings-form/cache-setting-form/index.jsx","state/noteTemplatesConfig/nodeTemplatesConfigActions.ts","components/settings-select/nodes-settings-form/templates-settings-form/index.jsx","components/settings-select/nodes-settings-form/permissions-settings-form/index.jsx","state/nodePermissionsConfig/nodePermissionsConfigActions.ts","components/settings-select/nodes-settings-form/dashboards-settings-form/index.jsx","components/settings-select/nodes-settings-form/index.jsx","components/settings-select/users-settings-form/index.jsx","components/settings-select/index.jsx","components/settings-select/actions.js","components/search-input/index.jsx","components/search-dialog/index.jsx","utils/dashboards.js","state/otherConfig/otherConfigActions.ts","components/other-settings-select/views-settings-form/index.jsx","utils/style.js","components/infinite-scroll-table/sort-buttons/index.jsx","components/infinite-scroll-table/contants.js","components/infinite-scroll-table/utils.js","components/auto-search-input/index.jsx","components/infinite-scroll-table/pre-header/index.jsx","components/infinite-scroll-table/footer/index.jsx","components/custom-empty/index.jsx","components/infinite-scroll-table/filter-button/index.jsx","components/infinite-scroll-table/index.jsx","components/selector/index.jsx","components/i18n-delayed-text-field/index.jsx","constants/getDashboardDynamicFilterLabelTranslations.js","components/dashboard-builder/index.jsx","hocs/call/index.jsx","utils/jsonStat.js","components/label-format-selector/constants.js","utils/formatters.js","components/table/jsonStatTable.js","components/table/Scrollbars.jsx","components/table/index.jsx","utils/tree.js","state/dataset/datasetReducer.ts","middlewares/fetchDatasetAsyncHandler/actions.js","components/attribute-list/index.jsx","components/data-viewer/Header.jsx","components/data-viewer/Sidebar.jsx","components/data-viewer/Footer.jsx","components/dataset-filters/index.jsx","components/enhanced-tree/index.jsx","components/criteria/TimePeriod.jsx","components/criteria/index.jsx","components/table-layout/index.jsx","components/font-size-selector/index.jsx","components/chart-layout/index.jsx","components/map/index.jsx","components/label-format-selector/index.jsx","components/chart/index.jsx","components/data-viewer/index.jsx","state/dashboard/dashboardReducer.ts","state/dashboard/dashboardActions.ts","components/dashboard/index.jsx","components/other-settings-select/user-dashboards-settings-form/index.jsx","components/other-settings-select/index.jsx","components/app-language-select/index.jsx","components/node-header/index.jsx","components/footer/index.jsx","components/home/index.jsx","state/hub/hubActions.ts","components/categories-lists/index.jsx","components/node/index.jsx","state/node/nodeActions.ts","state/catalog/catalogActions.ts","components/results/ResultTree.jsx","components/results/index.jsx","components/data/index.jsx","domains/DatasetDomain.jsx","components/dashboard-filters/index.jsx","domains/DashboardsDomain.jsx","domains/MultiLanguageDomain.jsx","state/app/appActions.ts","domains/NodeDomain.jsx","domains/HubDomain.jsx","components/delete-conflict-modal/index.jsx","state/delete-conflict-modal/deleteConflictModalActions.ts","components/error-boundary/index.jsx","components/user-set-password-dialog/user-set-password-form/index.jsx","components/user-set-password-dialog/index.jsx","App.jsx","state/hub/hubReducer.ts","state/node/nodeReducer.ts","model/LocalCategoryProvider.ts","state/rootReducer.ts","state/spinner/spinnerReducer.ts","state/appConfig/appConfigReducer.ts","state/app/appReducer.ts","state/noteTemplatesConfig/nodeTemplatesConfigReducer.ts","state/catalog/catalogReducer.ts","state/hubConfig/hubConfigReducer.ts","state/nodesConfig/nodesConfigReducer.ts","state/cache/cacheReducer.ts","state/otherConfig/otherConfigReducer.ts","state/usersConfig/usersConfigReducer.ts","state/nodePermissionsConfig/nodePermissionsConfigReducer.ts","state/delete-conflict-modal/deleteConflictModalReducer.ts","middlewares/user/userMiddlewareFactory.js","middlewares/request/requestMiddlewareFactory.ts","utils/other.js","middlewares/config/configMiddleware.js","middlewares/file-save/middleware.js","middlewares/i18n-middleware/middleware.js","middlewares/request-spinner/requestSpinnerMiddlewareFactory.js","middlewares/feedback/feedbackMiddleware.js","middlewares/fetchDatasetAsyncHandler/middlewareFactory.js","init.js","utils/buildID/buildIDChecker.js","index.jsx"],"names":["RequestMethod","withTranslation","t","useState","isOpen","setIsOpen","isInitialized","setIsInitialized","useEffect","window","notImplemented","show","Snackbar","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","ClickAwayListenerProps","onClickAway","Alert","severity","addSpinnerMessage","uid","message","type","payload","markSpinnerMessage","isError","compose","withStyles","theme","container","width","height","overlay","position","zIndex","progressContainer","display","alignItems","justifyContent","progress","maxWidth","messagesContainer","textAlign","messages","marginTop","childrenContainer","top","messageRow","withTheme","connect","state","spinner","dispatch","flushSpinner","classes","children","isHandlerOn","setIsHandlerOn","addEventListener","Box","className","id","length","style","background","palette","primary","main","LinearProgress","color","map","removed","Grid","key","justify","filter","spacing","item","Typography","error","success","fontSize","overflow","ErrorSnackbar","setMessage","setIsError","undefined","dangerouslySetInnerHTML","__html","root","flexDirection","objectFit","textContainer","lightTextContainer","buttonsContainer","margin","logo","maxHeight","title","slogan","light","Helmet","variant","gutterBottom","card","list","onClick","squareImage","hasImage","find","c","image","i","xs","Card","CardActionArea","CardMedia","component","label","alt","CardContent","PageSection","props","sectiontitle","Divider","Page","transparent","isOldBrowserWarningVisible","handleScroll","scrollTop","pageYOffset","document","documentElement","setState","closeWarning","ref","current","scrollIntoView","behavior","alignToTop","scroll","left","isIE","documentMode","isEdge","StyleMedia","this","removeEventListener","oldBrowserWarning","href","target","rel","IconButton","padding","Zoom","in","Fab","fab","ArrowUpward","Component","right","bottom","appBar","paddingBottom","lineHeight","REQUEST_SUCCESS","UserRoles","UserPermissions","initRequest","url","method","GET","data","extra","baseURL","getHideErrorMessage","hideSpinner","contentType","uuid","uuidv4","errorRequest","requestActionPayload","statusCode","response","getDatasetUrl","nodeId","datasetId","getDatasetDownloadUrl","format","zipped","getNodeDeleteUrl","force","getDashboardsUrl","dashboardId","showUserLoginForm","alert","SettingsDialog","onSubmit","hasSubmit","noMinHeight","useTranslation","Dialog","disableEscapeKeyDown","disableBackdropClick","fullWidth","DialogTitle","DialogContent","minHeight","DialogActions","Button","Form","field","paper","tabContent","overflowY","overflowX","forwardRef","config","useForm","register","errors","handleSubmit","useImperativeHandle","submit","f","val","cancel","FormControl","TextField","marginBottom","name","email","helperText","required","inputRef","usersConfig","user","userErrors","sendConfig","POST","onStart","str","recoverPassword","textDecoration","secondary","cursor","onHide","onRegister","isRecoverPasswordModalOpen","setIsRecoverPasswordModalOpen","recoverPasswordFormRef","useRef","password","marginLeft","fetchUsersConfigUsers","disclaimerLink","onCancel","isAnonymous","hub","defaultValues","isActive","disclaimerAccepted","watch","setValue","showPassword","setShowPassword","showPasswordConfirm","setShowPasswordConfirm","isDisclaimerModalOpen","setIsDisclaimerModalOpen","validate","disabled","emailConfirm","FormControlLabel","control","Checkbox","checked","onChange","e","value","firstName","lastName","organization","InputProps","endAdornment","InputAdornment","Visibility","VisibilityOff","passwordConfirm","FormHelperText","disclaimer","fetchConfig","userId","getUserConfigGetUrl","sendConfigCreate","sendUsersConfigUserCreate","PUT","sendUsersConfigUserEdit","clearConfig","needConfig","setNeedConfig","ButtonSelect","anchorEl","setAnchorEl","el","handleMenu","event","currentTarget","handleClose","icon","tooltip","selectedIdx","Boolean","Item","isSelected","MenuItem","startIcon","endIcon","keepMounted","transformOrigin","showOldPassword","setShowOldPassword","showNewPassword","setShowNewPassword","showNewPasswordConfirm","setShowNewPasswordConfirm","oldPassword","newPassword","newPasswordConfirm","btoa","onLogin","Email","Password","fetchUser","onLogout","onLoginFormShow","onLoginFormHide","isChangePasswordModalOpen","setIsChangePasswordModalOpen","isRegisterModalOpen","setIsRegisterModalOpen","registerFormRef","changePasswordFormRef","isAuthenticated","isLoginDialogOpen","goToDatasets","nodeCode","categoryPath","language","toLowerCase","join","goToData","viewId","a11y","goToDatasetsSearch","query","filters","encodeURIComponent","goToNode","goToHome","goToHubDashboards","goToNodeDashboards","CategoriesTree","expanded","selectedCategoryPath","onExpand","node","catalog","getTreeItems","tree","prevPath","cat","TreeItem","includes","nodeIcon","hasAnnotation","size","onDialogOpen","selectedItem","datasetIdentifiers","childrenCategories","Link","code","datasetsCount","categoryGroups","categories","TreeView","defaultCollapseIcon","defaultExpandIcon","onNodeToggle","_","nodeIds","uncategorizedDatasets","content","fetchHubConfigDashboards","startAdornment","marginRight","fileInput","substring","lastIndexOf","fileName","setFileName","accept","file","files","fileFormData","FormData","append","fetch","body","headers","token","credentials","then","res","json","filePath","catch","htmlFor","CustomMaterialTable","customProps","localization","emptyDataSourceMessage","header","actions","toolbar","searchPlaceholder","searchTooltip","mergedProps","merge","validateI18nObj","obj","pickBy","keys","localizeI18nObj","prefLang","langs","Object","getI18nObjCustomFilterAndSearch","languages","row","tableIcons","Search","ResetSearch","SortArrow","tableToolbar","buttonAction","typography","button","app","defaultLanguage","dashboards","allDashboards","fetchDashboards","fetchAllDashboards","addDashboard","removeDashboard","sendDashboardsOrders","clearDashboards","clearAllDashboards","needFetch","setNeedFetch","destroy","orderedDashboardsIds","components","Container","columns","render","customFilterAndSearch","assigned","dashboard","AddIcon","options","paging","draggable","actionsColumnIndex","searchFieldAlignment","maxBodyHeight","showTitle","icons","Toolbar","tableData","ArrowDropUpIcon","rowIndex","slice","ArrowDropDownIcon","DeleteIcon","INIT","persistenceMiddleware","getState","next","action","JSON","parse","localStorage","getItem","result","setItem","stringify","isSetPasswordDialogOpen","supportedLanguages","initialState","roles","permissions","refreshTokenExpiration","tokenTTL","tokenReceivedTime","delayedRequest","userReducer","setPasswordToken","Date","getTime","request","getPermissionStr","permission","canDisplayAppSettingsForm","Administrator","canCreateNode","canSortNodes","canDisplayNodesSettingsForm","p","startsWith","ManageCache","ManageTemplate","ManageConfig","canDisplayUsersSettingsForm","canDisplayCacheSettingForm","canDisplayTemplatesSettingsForm","canSaveTemplate","canEditNode","canDisplayUserViews","canSaveAsView","canClearServerCache","canGetQueryLog","canDisplayPermissionsSettingsForm","canManagePersonalDashboards","canManageAppDashboards","canDeleteNodes","canViewTemplateOrAnnotationIcon","CUSTOM_LANG_TO_COUNTRY","en","langToCountry","setLangToCountry","forEach","langCode","CountryLanguage","getLanguageCountries","err","countries","code_2","lang","data-value","ConnectedComponent","textFieldProps","setLanguage","I18nTextField","HtmlEditor","getInitState","handleEditorChange","bind","editor","getData","items","readOnly","onBeforeLoad","CKEDITOR","disableAutoInline","React","preToolbar","htmlEditorProps","I18nHtmlEditor","disclaimerLabel","tab","setTab","dashboardsManagerRef","createRef","configExtras","extras","pageSize","PageSize","min","Tabs","Tab","Autocomplete","multiple","freeSolo","renderTags","getTagProps","option","index","Chip","renderInput","params","placeholder","select","maxObservationsAfterCriteria","maxCells","hubConfig","hubDashboards","sendHubConfig","getAddHubDashboardUrl","addHubConfigDashboardsDashboard","getRemoveHubDashboardUrl","DELETE","removeHubConfigDashboardsDashboard","orderedDashboarIds","fetchNodesConfigNodes","fetchNodesConfigNodeDashboards","getNodeDashboardsUrl","getCriteriaRequestObject","criteria","push","filterValues","InfoTooltip","placement","aria-label","transform","FormLabelWithTooltip","tooltipOnRight","Tooltip","pointerEvents","downloadFormats","genericdata","extension","genericdata20","compactdata","structurespecificdata","jsondata","csv","getDownloadFormatLabelFromFormat","getDownloadFormatExtensionFromFormat","exportChartJpeg","canvasId","canvas","getElementById","link","createElement","download","toDataURL","appendChild","click","removeChild","mustChangeTabOnErrors","setMustChangeTabOnErrors","active","annotationConfig","showCategoryLevels","decimalNumber","decimalSeparator","catalogNavigationMode","hiddenAttributes","restDataResponseXml","supportPostFilters","enableHttpAuth","enableProxy","optimizeCallWithSoap","namespaceV20","namespaceV21","isPublic","validator","isPort","firstFieldWithErrors","toUpperCase","inputProps","textTransform","agency","Paper","sm","criteriaSelectionMode","endPoint","authHttpUsername","proxyAddress","proxyPort","ttlCatalog","ttlDataflow","helper","getOptionLabel","nodesConfig","getNodeConfigGetUrl","fetchNodesConfigNode","sendNodesConfigNodeEdit","fetchDataflowCache","getDataflowsCacheListUrl","Delete","Edit","Check","Clear","Add","wellFormattedTimeString","days","hours","mins","sec","cacheConfig","fetchCache","clearCache","updateCache","cacheId","ttl","getDataflowsCacheUpdateUrl","updateDataflowCache","createCache","getDataflowsCreateCacheUrl","oldData","createDataflowCache","deleteFromCache","getDataflowsClearCacheUrl","deleteDataflowCache","deleteAllFromCache","getDataflowsClearAllCacheUrl","deleteAllDataflowCache","deleteCatalogCache","getClearNodeCatalogMemoryCacheUrl","hideEmptyDataflowCache","setEmptyDataflowCacheHidden","emptyRowsCounter","setEmptyRowsCounter","rowsCounter","setRowsCounter","cacheSize","editable","rowData","totalSeconds","Math","floor","minutes","seconds","round","secondsToHms","onRowUpdate","newData","Promise","resolve","reject","onRowDelete","dataDelete","splice","editRow","deleteText","editTooltip","deleteTooltip","fetchNodeTemplatesConfig","getNodeTemplatesUrl","templates","nodeTemplatesConfig","fetchTemplates","deleteTemplate","getDeleteTemplateUrl","deleteNodeTemplatesConfigTemplate","clearTemplates","nodes","defaultNodeOpen","needTemplates","setNeedTemplates","deleteTemplateId","setDeleteTemplateId","viewTemplateId","autoFocus","styles","PERMISSIONS","userVal","nodePermissions","ev","nodePermissionsConfig","getNodePermissionsConfigGetUrl","fetchNodePermissionsConfig","getNodePermissionsConfigPutUrl","sendNodePermissionsConfig","nodeDashboards","getAddNodeDashboardUrl","addNodesConfigDashboardsNodeDashboard","getRemoveNodeDashboardUrl","removeNodesConfigDashboardsNodeDashboard","dashboardsIds","getOrderNodeDashboardsUrl","sendNodesConfigDashboardsNodeOrders","sendOrders","orderedIds","sendNodesConfigNodesOrder","deleteNode","onForce","deleteNodesConfigNode","isNodeFormVisible","setNodeFormVisibility","nodeFormNodeId","setNodeFormNodeId","nodeDeleteFormNodeId","setNodeDeleteFormNodeId","cacheFormNodeId","setCacheFormNodeId","isCacheFormVisible","setCacheFormVisibility","templatesNodeId","setTemplatesNodeId","permissionsNodeId","setPermissionsNodeId","dashboardsNodeId","setDashboardsNodeId","nodeFormRef","cacheFormRef","templatesRef","permissionsRef","dashboardsRef","orderedNodes","sort","a","b","order","orderedNodesIds","PersonIcon","canManageNodeDashboards","DashboardIcon","EditIcon","false","users","deleteUser","getUserDeleteUrl","deleteUsersConfigUser","onUserFormShow","showUserConfigForm","onUserFormHide","userDeleteFormUserId","setUserDeleteFormUserId","userFormRef","SettingsSelect","isAppOpen","isNodesOpen","isUsersOpen","appSettingsRef","nodesSettingsRef","usersSettingsRef","isLogDownloadOpen","logLimit","onAppOpen","onAppClose","showSnackbar","isAppSubmitSnackbarVisible","onNodesOpen","onNodesClose","onUsersOpen","onUsersClose","onLogDownloadOpen","onLogDownloadClose","onLogLimitSet","isNaN","onLogDownload","onCacheClear","Input","limit","getQueryLog","fileSave","stringifyResponse","downloadQueryLog","borderRadius","shape","backgroundColor","borderColor","borderWidth","inputRoot","inputInput","input","defaultValue","onKeyDown","preventDefault","$","jQuery","fade","common","white","dialogTop","modalWidth","onRendered","focus","PaperProps","emptyDashboardElem","getViewIdxFromRowAndCol","rowIdx","colIdx","fetchOtherConfigViews","getNewDashboard","newDashboard","cloneDeep","ids","dashboardConfig","col","filterDimension","newFilterLevels","labels","filterLevels","viewIds","views","otherConfig","fetchViews","clearViews","deleteView","getDeleteViewUrl","deleteOtherConfigView","needViews","setNeedViews","deleteViewId","setDeleteViewId","deleteViewNodeId","setDeleteViewNodeId","getScrollBarWidth","temp","css","visibility","appendTo","widthWithScroll","outerWidth","remove","getTextWidth","text","element","innerText","offsetWidth","SortButtons","CHECKBOX_WIDTH","DATA_INDEX_CHECKED","DEFAULT_PAGE_SIZE","getIndexesFromPaginationParams","pageNum","startIdx","stopIdx","AutoSearchInput","tempValue","timeout","onClear","clearTimeout","onSearch","setTimeout","nextProps","searchText","selectedRowCount","tableActions","renderTableAction","leftActions","rightActions","isLoading","isHidden","rowNumStart","rowNumEnd","rowCount","CircularProgress","fontStyle","textStyle","FilterButton","Popover","InfiniteScrollTable","onSearchTextChange","onFiltersChange","onSortChange","getSelectedRowKeys","onRowSelectionChange","getCols","getNormalizedTableActions","renderActions","renderGridRow","renderFixedActions","renderHeaderCells","renderCheckboxTitle","renderCheckbox","getPopulatedRows","getColWidths","getQueriedRows","getRenderedRows","onRenderedRowsChange","gridKeyForRefresh","scrollLeft","gridScrollbarWidth","sortCol","sortByDesc","selectedRowKeys","rowSelection","cols","populatedRows","colWidths","renderedRows","queriedRows","isResizing","resizeTimeout","pageRequestTimeout","isPaginating","isPaginated","pageRequestParams","viewStartIdx","viewEndIdx","viewIndexesUpdateTimeout","doNotCallOnChangeOnNextRenderedRowsChange","rows","multilangStrDataIndexes","fixedActions","altActions","getIsAltRow","getActionsObjs","populatedRow","dataIndex","getTextWidthEl","get","colTitleWidth","noFilter","noSort","CELL_PADDING","max","widthToContent","minWidthToContent","renderText","minWidth","isVariableSizeCol","variableSizeCols","colWidthsSum","availableWidth","getIsVerticalScrollbarVisible","widthToAdd","colWidth","colIndex","colsWidths","getRowKey","resRow","getFilteredGridRows","getSearchTextFilteredGridRows","getSortedGridRows","prevProps","isArrayPropertyChangedLazy","newCols","newPopulatedRows","newColWidths","newRenderedRows","newQueriedRows","newScrollTop","$grid","updateRenderedRows","_this","addClass","on","newScrollLeft","off","nextState","nextContext","newFilters","newPageRequestParams","applyQueryChange","newSearchText","colDataIndex","direction","newSortCol","newSortByDesc","rowKey","selected","getIsDisabledRow","onSelect","onSelectAll","newSelectedRowKeys","selRowKey","titleRender","noSearchText","getNormalizedFixedActions","disableOnRowClickForCell","getNormalizedActions","getNormalizedAltActions","hasOwnProperty","withValuesFilter","isValuePassingSearchText","column","_a","_b","sorter","defaultSorter","onRowClick","getRowStyle","cellData","isRowClickDisabled","colLeftAttr","rowStyle","ROW_HEIGHT","columnWidths","uniq","stopPropagation","checkboxProps","getCheckboxProps","overscanStartIdx","overscanEndIdx","currentPageIndexes","pageRowsThird","MAX_PAGE_SIZE","newPaginationParams","maxIdx","minPageSize","maxPageSize","pageNumForMinPageSize","Number","isInteger","minPageNum","ceil","maxPageNum","indexes","getPaginationParamsFromIndexes","rowNum","showHeader","autoSearch","sum","itemSize","itemCount","initialScrollOffset","onItemsRendered","visibleStartIndex","visibleStopIndex","overscanStartIndex","overscanStopIndex","String","prevProp","prop","isDesc","normalize","withSize","iconStyle","Selector","callOnChange","detailTitle","selectTitle","resetTitle","onDetail","onReset","emptyValue","getInitialInternalValue","internalValue","setInternalValue","timeoutId","setTimeoutId","setValueForLanguage","newInternalValue","I18nDelayedTextField","getDashboardDynamicFilterLabelTranslations","Region","Province","Municipality","translations","getStrippedHtmlText","html","$span","innerHTML","textContent","DashboardBuilderCol","onColRemove","onTypeReset","onViewReset","onTextEdit","onShowTitleChange","onEnableFiltersChange","onFilterDimensionChange","colContainer","viewContainer","view","formLabel","labelPlacement","dynamicViewInput","htmlInput","multiline","viewAction","colActions","DashboardBuilderRow","onRowRemove","onColAdd","rowContainer","idx","rowActions","rowAction","border","verticalAlign","VIEW_ACTION_WIDTH","onViewsHide","selectedRowIdx","setSelectedRowIdx","selectedColIdx","setSelectedColIdx","isEditTextVisible","setEditTextVisibility","tempTextValue","setTempTextValue","handleRowRemove","handleColAdd","handleColRemove","handleTypeReset","handleViewReset","handleEditTextShow","handleEditTextHide","handleShowTitleChange","handleEnableFiltersChange","handleFilterDimensionChange","__originalRow","handleViewSet","handleTextChange","Call","cb","cbParam","FREQ_KEY","toUpperCaseFirst","string","getDimensionLabelFromJsonStat","jsonStat","dimension","getDimensionValueLabelFromJsonStat","category","getDataIdxFromDimensionsArray","dimensions","dataIdx","multiplier","getJsonStatTableSize","layout","count","colCount","indexOf","sections","section","getCombinationArray","dimsArrays","test","ret","arr","j","l","getInitialFiltersValue","fixedFiltersValue","primaryDim","primaryDimArr","primaryDimValues","secondaryDim","secondaryDimArr","secondaryDimValues","dims","concat","dim","indexesMap","getDimensionValuesIndexesMap","primaryDimValuesIndexes","secondaryDimValuesIndexes","dimsIndexesArrays","reverse","unorderedDimCombination","combination","orderedDims","unorderedDims","orderedDimCombination","isValorized","filtersValue","getUpdatedLayout","newLayout","getChartDimensionValues","fixedFilters","tmpLayout","getDimensionFiltersValue","values","dimValue","dimensionsNotInFilters","dimensionsPostFilter","dimensionsNotInFiltersAndPostFilters","addedValues","dataIndexArr","combinationValue","observation","isPrimaryDim","getAttributeObjects","attributeList","attributeObj","attributes","hasAsterisk","attr","valueId","valueLabel","getDimensionAttributeMap","getIdsHtmlString","series","seriesIndexes","dimensionAttributesMap","coordinates","dimIdx","findIndex","dimValueIdx","attributeObjects","htmlString","numberFormatter","Intl","NumberFormat","getFormattedInt","separator","subStrs","pop","subStr","getFormattedValue","decimalPlaces","emptyChar","intSeparator","int","decimal","toFixed","getValorizedElCount","array","getCorrespondingIndexInFilteredArray","n","lastIdx","found","getTableRightPadding","timeoutID","intervalID","isOnMouseDownOnSliderThumb","CustomSlider","orientation","maxValue","onIncrement","ticks","isVerticalScrollbarVisible","onMouseUp","clearInterval","handleChange","newValue","sliderId","step","containerRect","getBoundingClientRect","clientY","clientX","isEventInContainer","setInterval","sliderButton","onMouseDown","Slider","track","verticalSlider","SLIDER_WIDTH","horizontalSlider","opacity","spinnerOverlay","verticalValue","verticalMaxValue","verticalTicks","onVerticalScroll","horizontalValue","horizontalMaxValue","horizontalTicks","onHorizontalScroll","isHorizontalScrollbarVisible","setRow","setCol","setIsPaginating","handleSliderScroll","isVertical","getIncrementedValue","prevValue","delta","isIncrement","handleIncrement","prevRow","prevCol","handleWheelScroll","useCallback","wheelDeltaY","wheelDelta","wheelDeltaX","isBetween","newRow","newCol","fontWeight","isFirstRender","isTimeToUpdate","isElementInContainer","checkOnlyVertical","elementRect","getAttributesValueString","onTimeSet","time","setDatasetHtmlGeneratingTime","addSpinner","removeSpinner","table","labelFormat","isFullscreen","isPreview","removeEmptyLines","isStickyHeader","spinnerUuid","tableSupportStructures","setTableSupportStructures","htmlTable","setHtmlTable","visibleRowCount","setVisibleRowCount","visibleColCount","setVisibleColCount","tableRightPadding","setTableRightPadding","setHorizontalScrollbarVisibility","setVerticalScrollbarVisibility","setAttributes","isCopiedVisible","setCopiedVisibility","Worker","worker","terminate","handleStyle","$tooltip","hover","$elem","rect","observationAttributesMap","split","x","innerWidth","empty","cell","cellFontSize","cellPaddingLeft","cellPaddingRight","each","stickyRowCount","stickyColCount","tops","$headerRows","lefts","$firstBodyRowThs","handleScrollbar","updateVisibleRowAndColCount","$tableContainer","$table","prevIsVerticalScrollbarVisible","prevIsHorizontalScrollbarVisible","onmessage","hasAttributeObservationError","postMessage","func","colsObj","rowsObj","combinations","valorizedCols","valorizedRows","valorizedRowsPerSection","sectionsLength","rowEnd","colEnd","paginationParams","origColStart","colStart","origColEnd","rowStart","t0","performance","now","colVisited","cc","fullColSpan","repCount","colSpan","sectionLabel","r","rr","sectionsStarts","subHeaderHandled","currentSectionIdx","getSectionRow","sectionRow","currentSectionIdxClone","subHeader","rowSpan","getDataCell","dataObj","t1","getJsonStatTableHtml","prevVal","copy","getNodesAtDepth","childrenKey","depth","recursive","subTree","currDepth","getTreeFromArray","parentKey","mappedArr","getTimePeriod","stateTimePeriod","stateFilters","timePeriodCriteria","freqCriteria","minAndMax","moment","add","getMinAndMax","minDate","maxDate","freq","getFreq","fromDate","toDate","frequencies","dataset","accessibleDataset","isPartialData","isEmptyData","isTooBigData","isCriteriaVisible","isCriteriaAlertVisible","mode","viewerIdx","hasViewTemplate","hasTemplateLayout","hasAnnotationLayout","initialTableLayout","initialChartLayout","initialMapLayout","initialFilters","enableCriteria","enableLayout","maxAllowedCells","territorialDims","codes","isCodesFlat","codelists","areCodelistsFlat","codelistsLength","timePeriod","timings","isFetchStructureDisabled","isFetchDatasetDisabled","isDownloadWarningVisible","isUnavailableViewWarningVisible","isCriteriaLengthWarningVisible","geometries","geometryDetailLevels","datasetReducer","cellCount","isResponseNotValid","responseHeaders","backendtimers","isPayloadTooLarge","criteriaView","VIEW_KEY","TEMPLATE_KEY","viewTemplate","viewTemplateLayouts","layouts","tableLayout","mapLayout","chartLayout","filterData","dimensionsId","getViewerIdxFromType","defaultView","defaultlanguage","tableEmptyChar","emptyCellPlaceHolder","territorialDimensions","isAccessible","maxTableCells","flatCodes","codelistIdx","newCodelistsLength","parentId","dimensionId","flatCodelists","codelist","timePeriodIdx","freqIdx","detailLevels","nutsLevel","reduce","acc","level","counter","v","console","log","Attribute","attribute","cardTitle","datasetAttributesCard","datasetAttributes","seriesAttributes","attributeGroup","otherAttributes","CardHeader","disableTypography","headerTitle","headerActions","titleAction","subtitle","viewer","paddingTop","attributeIcon","fontFamily","nodeDownloadFormats","datasetTitle","notes","attachedFiles","initialDecimalSeparator","viewers","onViewTemplateSubmit","onDownloadSubmit","chartId","mapId","tableDefaultLayout","initialTemplate","isViewVisible","setViewVisibility","isTemplateVisible","setTemplateVisibility","tabId","setTabId","template","setTemplate","isAttributesVisible","setAttributesVisibility","isNotesVisible","setNotesVisibility","setDownloadFormats","isTimingsVisible","setTimingsVisibility","actionsWidth","setAttribute","newDownloadFormats","isDownloadFormatValid","handleViewClose","handleTemplateClose","dataSet","datasetIndexes","dimsId","dimsValueId","attrs","currentFilters","dimLabel","canViewTimesLog","handleViewOpen","handleTemplateOpen","canShare","attachedFile","LMap","exportPng","toStamp","getRow","isBold","titleStyle","fullScreen","AppBar","scrollButtons","indicatorColor","textColor","titleTypographyProps","hideDimensions","enableVariation","lastPeriods","outline","floatingMenuOption","floatingMenuOptionSelected","divider","categoryTitle","referenceMetadataIcon","iFrame","navigationActionDisabled","viewerSelectDisabled","referenceMetadataUrl","onViewerSelect","onCriteriaOpen","onLayoutOpen","isRefMetaVisible","setRefMetaVisibility","handleViewerSelect","isCriteriaEnabled","isLayoutEnabled","MenuList","BottomNavigation","showLabels","BottomNavigationAction","src","whiteSpace","sheet","setData","isConfirmOpen","setConfirmVisibility","deleteIcon","onDelete","getFormattedName","isMultiSelectDim","dialogContent","itemDisabled","dimensionTitle","visibleId","setVisibleId","checkedKeys","setCheckedKeys","setDimensionAttributesMap","dataSpinnerUuid","handleFilterClose","InputLabel","Select","renderValue","onOpen","handleFilterOpen","getKeys","getNodeKey","handleHeight","withLevelSelector","actionHeight","levelSelectorHeight","treeActions","treeNode","treeNodeCheckbox","treeNodeLabel","levelTreeNodeLabel","treeNodeAction","showMoreNode","labelKey","getNodeLabel","checkable","defaultExpandedKeys","nodeActions","withoutSearch","withoutCheckControls","withoutExpandControls","withoutPagination","getIsCheckable","isLabelNotMultilingual","setSearchText","expandedKeys","setExpandedKeys","showMoreKeyClicks","setShowMoreKeyClicks","handleCheck","checkedNode","newCheckedKeys","onCheck","handleLevelCheck","nodesAtDepth","filteredTree","handleExpand","getShowMoreNode","parent","remaining","more","getTreeNode","isLevelTree","act","some","child","filterNode","search","subtree","filteredChildren","getFilteredTree","levelTree","maxTreeDepth","getMaxTreeDepth","TREE_NODE_KEY_OF_LEVEL_PREFIX","Array","pointer","disableSelection","periods","year","S1","start","end","endOf","S2","Q1","Q2","Q3","Q4","getYearsArray","startYear","endYear","startYearNumeric","endYearNumeric","getPeriod","date","dateMoment","period","getNewFiltersFromYear","minYear","maxYear","minPeriod","maxPeriod","timePeriodKey","isFrom","newDate","isSameOrAfter","isSameOrBefore","handleSetFilters","onSetFilters","setCriteriaValidity","selectContainer","formControl","timePeriodInput","isCriteriaValid","fromYear","toYear","fromPeriod","toPeriod","fromPeriods","toPeriods","utils","DateFnsUtils","DatePicker","openTo","clearable","criteriaContainer","codelistInfo","codelistContainer","emptyContainer","timePeriodContainer","structure","fetchCodelist","flatCriteria","getDatasetStructureDynamicCodelistUrl","isFull","getDatasetStructureCodelistUrl","fetchDatasetStructureCodelist","fetchCodelists","getDatasetStructureCodelistsUrl","fetchDatasetStructureCodelists","setDatasetStructureCodelistFilters","isCallDisabled","setIsCallDisabled","tmpFilters","setTmpFilters","tmpTabId","setTmpTabId","filtersToRemove","handleTabChange","DataStructureRef","isSelectable","childrenKeys","unselectedChildrenKeys","onDragEnd","setDimensions","source","destination","newDimensions","droppableId","startIndex","endIndex","reorder","droppableSource","droppableDestination","move","Section","Icon","sectionHeaderIcon","sectionHeaderTitle","sectionHeaderContainer","provided","snapshot","sectionContentWrapper","isDraggingOver","draggingHover","innerRef","sectionContent","draggableId","draggableProps","dragHandleProps","isDragging","draggableStyle","userSelect","sectionItem","sectionContainer","previewContainer","setLayout","getFontSizeIcon","styleClasses","fontSizeIcon","fontSizeIconSm","fontSizeIconMd","fontSizeIconLg","fontSizeSelected","boxShadow","setFontSize","sourceArr","destinationArr","removedSrc","removedDst","swap","sectionClasses","isDragDisabled","sectionLeft","sectionRight","markSpinner","onGeometryFetch","currentDetailLevel","setCurrentDetailLevel","filteredGeometries","setFilteredGeometries","firstNotEmptyLevelIndex","destroyMap","mapTranslations","configure","from","to","apply","classification","equalInterval","naturalBreaks","quantile","numberOfClasses","startColor","endColor","preview","layerOptions","srid","legendSettings","paletteStartColor","paletteEndColor","paletteCardinality","pointStartRadius","pointEndRadius","pointRadiusCardinality","classificationMethod","onDataRender","valueFormatter","centerMarker","centerMarkerText","selectedCenterMarker","mapOptions","baseMap","baseMapToGray","onLoadingStart","onLoadingFinish","legendFontFamily","WebFont","load","google","families","initMap","addLayer","geometryMap","g","missingGeometryList","territoryDim","geomId","missingEntry","filtersValues","territoryDimName","dimensionFilterValues","levelsCounter","dimValueArray","valueIdx","geom","uniqueId","wkt","lev","menuItem","setLabelFormat","colors","hexToRGBA","hex","alpha","parseInt","getChartType","isBarOrLineGraph","getOptions","chartType","datasets","abs","responsive","maintainAspectRatio","scales","xAxes","gridLines","beginAtZero","callback","stacked","yAxes","tooltips","enabled","callbacks","tooltipItem","getValue","datasetIndex","removeEmptyValues","valorizedDataMap","secondaryDimValue","fill","valorizedDataArr","secDimIdx","primaryDimValue","primDimIdx","valorizedValues","secDim","colorArr","lineTension","getDefaultRemoveEmptyValues","Chart","chartRef","ChartJs","defaults","global","defaultFontFamily","myChart","plugins","beforeDraw","chart","ctx","fillStyle","fillRect","isEqual","update","hideChart","viewerType","titleHeight","offsetHeight","headerHeight","footerHeight","filtersAndActionsHeight","page","sidebar","viewerContainer","filtersAndActions","footer","warningAlert","criteriaContent","fetchDataset","checkCriteriaLength","fetchAccessibleDataset","onFetchDatasetEnable","onCriteriaShow","onCriteriaHide","onCriteriaAlertHide","onViewerChange","setDatasetViewer","onLabelFormatChange","setDatasetLabelFormat","submitDatasetDownload","onDownloadHide","isView","getCreateViewUrl","getCreateTemplateUrl","submitDatasetViewTemplate","onUnavailableViewHide","onCriteriaLengthWarningHide","idList","fetchDatasetGeometries","nodeExtras","maxObservation","setTableLayout","tmpTableLayout","setTmpTableLayout","tableLayoutSpinnerUuid","setChartLayout","tmpChartLayout","setTmpChartLayout","setMapLayout","isLayoutVisible","setLayoutVisibility","setFullscreen","newTableLayout","newColCount","newRowCount","getInitialTableLayout","newChartLayout","getInitialChartLayout","newMapLayout","geoId","role","geo","getInitialMapLayout","handleLayoutClose","handleLayoutSubmit","handleCriteriaClose","DownloadFormats","HiddenAttributes","classList","jsonStats","maps","dashboardReducer","currentDashboardJsonStats","viewIdx","requestIds","requestId","controllersHeight","DashboardCol","filterValue","viewLayouts","fetchMapGeometries","downloadCsv","widthPercentage","float","viewPlaceholder","staticFilters","viewControllers","viewTitle","viewStaticFilters","viewStaticFilter","viewActiveFilters","DashboardRow","setViewLayouts","prevViewLayouts","newViewLayouts","initialLayout","dimArraysKey","getFilteredLayoutObject","handleFilterSelect","getStaticDashboard","staticDashboard","initialDashboard","needDashboards","dashboardViews","dashboardJsonStats","dashboardMaps","createDashboard","createOtherConfigDashboard","updateDashboard","updateOtherConfigDashboard","changeDashboard","changeOtherConfigDashboard","submitDashboardCreate","submitOtherConfigDashboardCreate","submitDashboardUpdate","getUpdateDashboardUrl","submitOtherConfigDashboardUpdate","deleteDashboard","getDeleteDashboardUrl","deleteOtherConfigDashboard","hideDashboard","fetchOtherConfigDashboardsDataset","fetchOtherConfigDashboardsMapGeometries","clearDatasets","onDashboardsClose","deleteDashboardId","setDeleteDashboardId","updateDashboardId","setUpdateDashboardId","isPreviewVisible","setPreviewVisibility","VisibilityIcon","location","goToDashboard","requests","newCriteria","OtherSettingsSelect","isViewsOpen","isDashboardsOpen","viewsSettigsRef","dashboardsSettingsRef","onViewsOpen","onViewsClose","onDashboardsOpen","useLocation","pathname","replace","NodeHeader","isDrawerOpen","defaultTreeOpen","onDrawerOpen","onDrawerClose","shortName","defaultAppConfigOpen","defaultUsersConfigOpen","defaultNodesConfigOpen","defaultNodeConfigOpen","noNode","leftContainer","leftToolbar","menuButton","edge","centerContainer","logoURL","sistanLogo","rightContainer","defaultAppOpen","defaultNodesOpen","defaultUsersOpen","Drawer","anchor","drawer","drawerHeader","drawerHeaderTitle","underline","drawerCategories","drawerCategoriesTitle","flexGrow","breakpoints","up","mixins","withRouter","textOnly","Home","info","nodesRef","isListMode","defaultUserConfigOpen","backgroundMediaURL","match","autoPlay","muted","loop","description","fullWidthContainer","anchorContainer","nodesContainer","footerContent","transition","toolbarButtons","fetchHub","paddingLeft","paddingRight","cardContainer","default","categoriesChunk","rootCategory","fontSizes","Subtree","parentPath","ListItem","ListItemText","Node","configIsListMode","categorySchemeTab","onListModeToggle","setCategorySchemeTab","nodeMinimalInfo","uncategorizedCategory","identifier","categoriesForExplore","categoriesContainer","categorySchemesTabs","fetchNode","getNodeUrl","fetchCatalog","getNodeCatalogUrl","resCount","checkbox","categoryGroupsWithCount","uncategorizedDatasetsCount","setExpanded","uncategorizedSelected","flexWrap","path","Results","isDialogOpen","expandedIndexes","isA11yMode","onDialogClose","expand","collapse","onA11yModeToggle","subCategories","categoryPathLabels","Breadcrumbs","reload","Switch","results","subCat","isExpanded","resultSource","keywords","expandedDescription","collapsedDescription","keyword","expandIcon","cardContent","cubeIcon","expansion","pager","hubExtras","onFetchStructureEnable","enableDatasetStructureFetch","fetchStructure","getDatasetStructureUrl","fetchDatasetStructure","onDatasetReset","isFetchEnabled","setIsFetchEnabled","getLabelsMap","getNodes","isFilterEnabled","selectValues","setSelectValues","lastValorizedIdx","setLastValorizedIdx","onFilterApply","isApplyDisabled","setIsApplyDisable","labelsMap","getNode","foundNodes","foundNodesInChild","selects","newSelectedValues","getIsFilterEnabled","fetchDashboard","fetchDashboardsDashboard","setDatasetFetchEnableStatus","setDashboardsDatasetFetchEnableStatus","fetchDashboardsDataset","fetchDashboardsMapGeometries","downloadViewCsv","commonsFilters","dashboardHeader","dashboardTabs","dashboardTitle","setFilterValue","allowedDashboards","setAllowedDashboards","currentDashboardId","setCurrentDashboardId","fetchedDashboards","setFetchedDashboards","tabIdx","setTabIdx","newCurrentDashboardId","newFetchedDashboards","static","dynamic","handleFilterApply","newFetchedDashboard","handleFetchDatasets","fetchStatic","fetchDynamic","dynamicFilterValue","addRequest","defaultFilterValue","newFilterValue","appLanguage","setAppLanguage","nodeHavingCode","Recursive","exact","viewParam","URLSearchParams","a11yParam","note","attachedDataFiles","referenceMetadata","ds","datasetsIdsOrDatasetId","getDatasetsIdsAndSubcategoriesOrDatasetId","datasetsIds","lastCategory","datasetIds","nextCategory","categoryId","decodeURIComponent","filteredCatIds","Set","datasetSatisfyQueryOrKeywords","datasetsSatisfyQueryOrKeywords","datasetsSatisfyFilters","searchRecursive","parentCategorySatisfyFilters","catSatisfyFilters","group","datasetsSatisfyQueryOrKeywordsMap","recursiveCountAndFilterZero","dsId","datasetsSatisfyFiltersMap","uniqueDatasets","filtered","onUserSetPasswordFormShow","showUserSetPasswordForm","tokenParam","deleteConflictModal","usedBy","getObjectTranslation","ErrorBoundary","hasError","goHome","username","setUserPassword","setPasswordFormRef","createMuiTheme","dark","contrastText","ThemeProvider","CssBaseline","hubReducer","nodeReducer","LocalCategoryProvider","categ","rootReducer","datasetMap","datasetUncategorized","newState","dataflowId","cachedDataflow","haveError","onDeleteConflictForce","userMiddlewareFactory","getMinutes","requestMiddlewareFactory","handleSuccess","requestAction","onSuccess","successRequest","status","handleGenericError","onGenericError","handleError","onManagedServerError","handleManagedServerError","axios","withCredentials","toString","showGenericError","configMiddleware","fileSaveMiddleware","FileSaver","saveAs","Blob","i18nMiddleware","i18n","changeLanguage","requestSpinnerMiddlewareFactory","spinnerState","feedbackMiddlewareFactory","fetchDatasetAsyncHandlerMiddlewareFactory","myWorker","successFetchDatasetAsyncHandler","init","all","buildID","resources","translation","supportedAndTranslatedLanguages","use","initReactI18next","lng","returnEmptyString","interpolation","escapeValue","store","configureStore","reducer","middleware","initAction","random","clear","cookies","cookie","eqPos","substr","deleteAllCookies","ReactDOM"],"mappings":"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","file":"static/js/main.16aab2e0.chunk.js","sourcesContent":["import {v4 as uuidv4} from 'uuid';\r\n\r\nexport const REQUEST_INIT = \"request/init\";\r\nexport const REQUEST_START = \"request/start\";\r\nexport const REQUEST_ERROR = \"request/error\";\r\nexport const REQUEST_SUCCESS = \"request/success\";\r\n\r\nexport enum RequestMethod {\r\n  GET = \"GET\",\r\n  POST = \"POST\",\r\n  PUT = \"PUT\",\r\n  DELETE = \"DELETE\"\r\n}\r\n\r\ntype RequestMessages = (t: (str: string, options?: any) => string) => {\r\n  onStart?: string,\r\n  onSuccess?: string,\r\n  onError?: string\r\n};\r\n\r\nexport interface RequestActionPayload {\r\n  label: string,\r\n  url: string,\r\n  method: RequestMethod,\r\n  data?: any,\r\n  messages?: RequestMessages,\r\n  extra?: any,\r\n  baseURL?: string,\r\n  getHideErrorMessage?: any,\r\n  hideSpinner?: boolean,\r\n  uuid: string,\r\n  contentType?: string\r\n}\r\n\r\nexport const initRequest = (\r\n  label: string,\r\n  url: string,\r\n  method: RequestMethod = RequestMethod.GET,\r\n  data?: any,\r\n  messages?: RequestMessages,\r\n  extra?: any,\r\n  baseURL?: string,\r\n  getHideErrorMessage?: any,\r\n  hideSpinner?: boolean,\r\n  contentType?: string\r\n) => ({\r\n  type: REQUEST_INIT,\r\n  payload: {\r\n    uuid: uuidv4(),\r\n    label,\r\n    url,\r\n    method,\r\n    data,\r\n    messages,\r\n    extra,\r\n    baseURL,\r\n    getHideErrorMessage,\r\n    hideSpinner,\r\n    contentType\r\n  }\r\n});\r\n\r\nexport const startRequest = (initRequestPayload: RequestActionPayload) => ({\r\n  type: REQUEST_START,\r\n  payload: initRequestPayload\r\n});\r\n\r\nexport const successRequest = (requestActionPayload: RequestActionPayload, response?: any, extra?: any) => ({\r\n  type: REQUEST_SUCCESS,\r\n  payload: {\r\n    ...requestActionPayload,\r\n    response,\r\n    extra: {\r\n      ...extra,\r\n      ...requestActionPayload.extra\r\n    }\r\n  }\r\n});\r\n\r\nexport type ManagedServerError = {\r\n  errorCode: number,\r\n  stackTrace?: string\r\n};\r\n\r\nexport const errorRequest = (\r\n  requestActionPayload: RequestActionPayload,\r\n  statusCode?: number,\r\n  response?: any,\r\n  extra?: any\r\n) => ({\r\n  type: REQUEST_ERROR,\r\n  payload: {\r\n    ...requestActionPayload,\r\n    statusCode,\r\n    response,\r\n    extra: {\r\n      ...extra,\r\n      ...requestActionPayload.extra\r\n    }\r\n  }\r\n});\r\n","import React, {useEffect, useState} from 'react';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\n\r\nconst NotImplementedSnackbar = ({t}) => {\r\n\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isInitialized) {\r\n      window.notImplemented = {\r\n        show: () => {\r\n          setIsOpen(true);\r\n        }\r\n      };\r\n      setIsInitialized(true);\r\n    }\r\n  }, [isInitialized]);\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{vertical: 'top', horizontal: 'center'}}\r\n      open={isOpen}\r\n      autoHideDuration={5000}\r\n      onClose={() => setIsOpen(false)}\r\n      ClickAwayListenerProps={{\r\n        onClickAway: () => {\r\n        }\r\n      }}\r\n    >\r\n      <Alert severity=\"warning\">{t(\"components.notImplementedSnackbar.label\")}</Alert>\r\n    </Snackbar>\r\n  );\r\n};\r\n\r\nexport default withTranslation()(NotImplementedSnackbar);","export const SPINNER_MESSAGE_ADD = \"spinner/addMessage\";\r\nexport const SPINNER_MESSAGE_REMOVE = \"spinner/removeMessage\";\r\nexport const SPINNER_TIMEOUT_SET = \"spinner/setTimeout\";\r\nexport const SPINNER_TIMEOUT_CLEAR = \"spinner/clearTimeout\";\r\nexport const SPINNER_FLUSH = \"spinner/flush\";\r\n\r\nexport const addSpinnerMessage = (uid: any, message: any) => ({\r\n  type: SPINNER_MESSAGE_ADD,\r\n  payload: {\r\n    uid,\r\n    message\r\n  }\r\n});\r\n\r\nexport const markSpinnerMessage = (uid: any, isError?: boolean) => ({\r\n  type: SPINNER_MESSAGE_REMOVE,\r\n  payload: {\r\n    uid,\r\n    isError\r\n  }\r\n});\r\n\r\nexport const setSpinnerTimeout = (timeout: any) => ({\r\n  type: SPINNER_TIMEOUT_SET,\r\n  payload: {\r\n    timeout\r\n  }\r\n});\r\n\r\nexport const clearSpinnerTimeout = () => ({\r\n  type: SPINNER_TIMEOUT_CLEAR\r\n});\r\n\r\nexport const flushSpinner = () => ({\r\n  type: SPINNER_FLUSH\r\n});\r\n\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {withStyles, withTheme} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport \"./style.css\";\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\nimport {flushSpinner} from \"../../state/spinner/spinnerActions\";\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\n\r\nconst OVERLAY_OPACITY_HEX = \"CC\";\r\n\r\nconst styles = theme => ({\r\n  container: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  overlay: {\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    zIndex: 2000\r\n  },\r\n  progressContainer: {\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\"\r\n  },\r\n  progress: {\r\n    width: 320,\r\n    maxWidth: \"50%\"\r\n  },\r\n  messagesContainer: {\r\n    position: \"relative\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    textAlign: \"center\"\r\n  },\r\n  messages: {\r\n    display: \"inline-block\",\r\n    marginTop: \"calc(50vh + 48px)\"\r\n  },\r\n  childrenContainer: {\r\n    position: \"absolute\",\r\n    top: 0,\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  messageRow: {\r\n    height: 32\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  messages: state.spinner.messages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  flushSpinner: () => dispatch(flushSpinner())\r\n});\r\n\r\nconst Spinner = ({classes, theme, children, messages, flushSpinner}) => {\r\n\r\n  const [isHandlerOn, setIsHandlerOn] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isHandlerOn) {\r\n      window.addEventListener('popstate', () => {\r\n        flushSpinner();\r\n      });\r\n      setIsHandlerOn(true);\r\n    }\r\n  }, [flushSpinner, isHandlerOn]);\r\n\r\n  return (\r\n    <Box className={classes.container}>\r\n      <Box\r\n        id=\"spinner\"\r\n        className={classes.overlay + \" \" + (messages.length === 0 ? \"invisible\" : \"\")}\r\n        style={{\r\n          background: theme.palette.primary.main + OVERLAY_OPACITY_HEX,\r\n        }}\r\n      >\r\n        <Box className={classes.progressContainer}>\r\n          <LinearProgress className={classes.progress} color=\"secondary\"/>\r\n        </Box>\r\n        <Box className={classes.messagesContainer}>\r\n          <Box className={classes.messages}>\r\n            {messages.map(({uid, message, removed, isError}) =>\r\n              <Grid container key={uid}\r\n                    justify={messages.filter(({removed}) => removed).length > 0 ? \"space-between\" : \"center\"}\r\n                    className={classes.messageRow}\r\n                    spacing={2}>\r\n                <Grid item>\r\n                  <Typography color=\"secondary\">\r\n                    {message} {!removed && \"...\"}\r\n                  </Typography>\r\n                </Grid>\r\n                {removed && (\r\n                  <Grid item style={{color: isError ? theme.palette.error.main : theme.palette.success.main}}>\r\n                    {isError ? <CancelIcon fontSize=\"small\"/> : <CheckCircleIcon fontSize=\"small\"/>}\r\n                  </Grid>\r\n                )}\r\n              </Grid>\r\n            )}\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n      <Box className={classes.childrenContainer} style={{overflow: messages.length > 0 ? \"hidden\" : \"initial\"}}>\r\n        {children}\r\n      </Box>\r\n    </Box>\r\n  )\r\n    ;\r\n};\r\n\r\nexport default compose(withStyles(styles), withTheme, connect(mapStateToProps, mapDispatchToProps))(Spinner);","import React, {useEffect, useState} from 'react';\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\n\r\nconst ErrorSnackbar = () => {\r\n\r\n  const [message, setMessage] = useState(null);\r\n  const [isError, setIsError] = useState(null);\r\n\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isInitialized) {\r\n      window.error = {\r\n        show: (message, isError) => {\r\n          setMessage(message);\r\n          setIsError(isError !== undefined ? isError : true);\r\n        }\r\n      };\r\n      setIsInitialized(true);\r\n    }\r\n  }, [isInitialized]);\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{vertical: 'top', horizontal: 'center'}}\r\n      open={message !== null}\r\n      autoHideDuration={5000}\r\n      onClose={() => {\r\n        setMessage(null);\r\n        setIsError(null);\r\n      }}\r\n      ClickAwayListenerProps={{\r\n        onClickAway: () => {\r\n        }\r\n      }}\r\n    >\r\n      <Alert severity={isError ? \"error\" :\"success\"}><span dangerouslySetInnerHTML={{__html: message}}/></Alert>\r\n    </Snackbar>\r\n  );\r\n};\r\n\r\nexport default ErrorSnackbar;","import React, {Fragment} from 'react'\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {Helmet} from \"react-helmet\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  background: {\r\n    \"&, & > *\": {\r\n      position: \"fixed\",\r\n      width: \"100%\",\r\n      height: \"100%\",\r\n      objectFit: \"cover\",\r\n      zIndex: -9999\r\n    }\r\n  },\r\n  textContainer: {\r\n    color: \"white\",\r\n    textAlign: \"center\",\r\n    width: \"80%\"\r\n  },\r\n  lightTextContainer: {\r\n    color: theme.palette.primary.main,\r\n    textAlign: \"center\",\r\n    width: \"80%\"\r\n  },\r\n  buttonsContainer: {\r\n    marginTop: theme.spacing(3),\r\n    '& > *': {\r\n      margin: '8px !important'\r\n    }\r\n  },\r\n  logo: {\r\n    position: \"absolute\",\r\n    top: \"80%\",\r\n    width: \"80%\",\r\n    textAlign: \"center\",\r\n    \"& > *\": {\r\n      maxWidth: 340,\r\n      maxHeight: 64\r\n    }\r\n  }\r\n});\r\n\r\nconst Hero = ({classes, title, slogan, logo, background, light, children}) =>\r\n  <Fragment>\r\n    <Helmet>\r\n      <style type=\"text/css\">\r\n        {`\r\n          html, body, #root {\r\n            height: 100%\r\n          }\r\n        `}\r\n      </style>\r\n    </Helmet>\r\n    <div className={classes.root}>\r\n      <div className={classes.background}>\r\n        {background}\r\n      </div>\r\n      <Typography className={light ? classes.lightTextContainer : classes.textContainer} variant=\"h2\" gutterBottom>\r\n        {title}\r\n      </Typography>\r\n      <Typography className={light ? classes.lightTextContainer : classes.textContainer} variant=\"h3\" style={{fontSize: 24}}>\r\n        {slogan}\r\n      </Typography>\r\n      <Box className={classes.buttonsContainer}>\r\n        {children}\r\n      </Box>\r\n      <Box className={classes.logo}>\r\n        {logo}\r\n      </Box>\r\n    </div>\r\n  </Fragment>;\r\n\r\nexport default withStyles(styles)(Hero);","import React from 'react';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardMedia from \"@material-ui/core/CardMedia\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = () => ({\r\n  card: {\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\nconst CardsGrid = ({list, onClick, classes, squareImage}) =>\r\n  <Grid container spacing={2}>\r\n    {(() => {\r\n      const hasImage = squareImage && list.find(c => c.image);\r\n      return list.map((c, i) =>\r\n        <Grid key={i} item xs={hasImage ? 3 : 4}>\r\n          <Card className={classes.card} id={`cards-grid__card-${c.id}`}>\r\n            <CardActionArea onClick={() => onClick(c)}>\r\n              {c.image && (\r\n                <CardMedia\r\n                  component=\"img\"\r\n                  height={hasImage ? 232 : (squareImage ? 315 : 177)}\r\n                  title={c.label}\r\n                  image={c.image}\r\n                  alt={c.label}\r\n                />\r\n              )}\r\n              <CardContent>\r\n                <Typography gutterBottom variant=\"h5\" style={{fontSize: 20}}>\r\n                  {c.label}\r\n                </Typography>\r\n              </CardContent>\r\n            </CardActionArea>\r\n          </Card>\r\n        </Grid>\r\n      );\r\n    })()}\r\n  </Grid>;\r\n\r\nexport default withStyles(styles)(CardsGrid);","import React, {Fragment} from 'react';\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport Box from \"@material-ui/core/Box\";\r\n\r\nconst PageSection = props =>\r\n  <Box {...props}>\r\n    {props.sectiontitle && (\r\n      <Fragment>\r\n        <Typography variant=\"h4\" gutterBottom margin={4} style={{fontSize: 34}}>\r\n          {props.sectiontitle}\r\n        </Typography>\r\n        <Divider/>\r\n      </Fragment>\r\n    )}\r\n    {props.children}\r\n  </Box>;\r\n\r\nexport default PageSection;","import React, {Component} from 'react';\r\nimport Zoom from \"@material-ui/core/Zoom\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport {ArrowUpward} from \"@material-ui/icons\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n  },\r\n  fab: {\r\n    position: 'fixed',\r\n    right: 8,\r\n    bottom: 55,\r\n    height: '50px',\r\n    width: '50px',\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  childrenContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    '& > *:last-child': {\r\n      paddingBottom: theme.spacing(10)\r\n    }\r\n  },\r\n  oldBrowserWarning: {\r\n    position: \"fixed\",\r\n    bottom: 0,\r\n    left: 0,\r\n    zIndex: 1999,\r\n    height: 48,\r\n    width: \"100%\",\r\n    background: \"rgba(0, 0, 0, 0.7)\",\r\n    fontSize: 16,\r\n    lineHeight: \"34px\",\r\n    color: \"white\",\r\n    padding: 8\r\n  }\r\n});\r\n\r\nclass Page extends Component {\r\n\r\n  state = {\r\n    transparent: true,\r\n    isOldBrowserWarningVisible: false\r\n  };\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true,\r\n    });\r\n  }\r\n\r\n  scrollTop() {\r\n    window.scroll({top: 0, left: 0, behavior: 'smooth'});\r\n  }\r\n\r\n  handleScroll = () => {\r\n    const {transparent} = this.state;\r\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n\r\n    if (scrollTop > 50 && transparent) {\r\n      this.setState({transparent: false});\r\n    }\r\n\r\n    if (scrollTop <= 50 && !transparent) {\r\n      this.setState({transparent: true});\r\n    }\r\n  };\r\n\r\n  closeWarning = () => {\r\n    this.setState({isOldBrowserWarningVisible: false});\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Internet Explorer 6-11\r\n    const isIE = !!document.documentMode;\r\n\r\n    // Edge 20+\r\n    const isEdge = !isIE && !!window.StyleMedia;\r\n\r\n    this.setState({isOldBrowserWarningVisible: (isIE || isEdge)});\r\n\r\n    window.scroll({top: 0, left: 0});\r\n\r\n    window.addEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  render() {\r\n\r\n    const {classes, children} = this.props;\r\n    const {transparent, isOldBrowserWarningVisible} = this.state;\r\n\r\n    return (\r\n      <div className={classes.root}>\r\n        {isOldBrowserWarningVisible && (\r\n          <div className={classes.oldBrowserWarning}>\r\n            <Grid container justify=\"space-between\">\r\n              <Grid item>\r\n                This browser in not completely supported, please consider to install the new version\r\n                of <a href=\"https://www.microsoft.com/edge\" target=\"_blank\" rel=\"noopener noreferrer\"\r\n                      style={{color: \"white\"}}>Microsoft Edge</a>\r\n              </Grid>\r\n              <Grid item>\r\n                <IconButton onClick={this.closeWarning} style={{color: \"white\", padding: 7}}>\r\n                  <ClearIcon fontSize=\"small\"/>\r\n                </IconButton>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        )}\r\n        <Zoom in={!transparent}>\r\n          <Fab className={classes.fab} color=\"secondary\" onClick={this.scrollTop}>\r\n            <ArrowUpward/>\r\n          </Fab>\r\n        </Zoom>\r\n        <div className={classes.childrenContainer}>\r\n          {children}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(Page);","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    USER_CLEAR,\r\n    USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR,\r\n    USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET,\r\n    USER_FETCH,\r\n    USER_LOGIN_FORM_HIDE,\r\n    USER_LOGIN_FORM_SHOW,\r\n    USER_REFRESH,\r\n    USER_SET_PASSWORD_FORM_HIDE,\r\n    USER_SET_PASSWORD_FORM_SHOW\r\n} from './userActions';\r\nimport {INIT} from '../rootActions';\r\nimport {PERSISTENCE_ACTION_KEY} from '../../middlewares/persistence/middleware';\r\n\r\nexport enum UserRoles {\r\n    Administrator= \"Administrator\",\r\n    User = \"User\"\r\n}\r\n\r\nexport enum UserPermissions {\r\n    ManageCache = \"ManageCache\",\r\n    ManageTemplate = \"ManageTemplate\",\r\n    ManageConfig = \"ManageConfig\",\r\n    ManageView = \"ManageView\"\r\n}\r\n\r\nexport type UserState = {\r\n    isAuthenticated: boolean,\r\n    email: string | null,\r\n    roles: UserRoles[],\r\n    permissions: string[],\r\n    token: string | null, // auth token\r\n    refreshTokenExpiration: string | null, // refresh token expiration time (utc)\r\n    tokenTTL: number | null // auth token expiration ttl (minutes)\r\n    tokenReceivedTime: number | null // auth token received time (ms from unix epoch)\r\n    isLoginDialogOpen: boolean,\r\n    delayedRequest: object | null\r\n};\r\n\r\nconst initialState = {\r\n    isAuthenticated: false,\r\n    email: null,\r\n    roles: [],\r\n    permissions: [],\r\n    token: null,\r\n    refreshTokenExpiration: null,\r\n    tokenTTL: null,\r\n    tokenReceivedTime: null,\r\n    isLoginDialogOpen: false,\r\n    delayedRequest: null\r\n};\r\n\r\nconst userReducer: Reducer<UserState> = (\r\n    state = initialState,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT:\r\n            return action.payload[PERSISTENCE_ACTION_KEY].user\r\n                ? ({\r\n                    ...initialState,\r\n                    ...action.payload[PERSISTENCE_ACTION_KEY].user\r\n                })\r\n                : initialState;\r\n        case USER_LOGIN_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                isLoginDialogOpen: true,\r\n                message: action.payload?.alert\r\n            };\r\n        case USER_LOGIN_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                isLoginDialogOpen: false,\r\n                message: undefined\r\n            };\r\n        case USER_SET_PASSWORD_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                isSetPasswordDialogOpen: true,\r\n                setPasswordToken: action.payload.token\r\n            };\r\n        case USER_SET_PASSWORD_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                isSetPasswordDialogOpen: false,\r\n                message: undefined\r\n            };\r\n        case USER_CLEAR:\r\n            return initialState;\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case USER_FETCH: {\r\n                    const response = action.payload.response;\r\n                    return {\r\n                        ...response,\r\n                        isLoginDialogOpen: !response.isAuthenticated,\r\n                        tokenReceivedTime: new Date().getTime()\r\n                    };\r\n                }\r\n                case USER_REFRESH:\r\n                    const response = action.payload.response;\r\n                    return {\r\n                        ...response,\r\n                        isLoginDialogOpen: state.isLoginDialogOpen,\r\n                        tokenReceivedTime: new Date().getTime()\r\n                    };\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        case USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET:\r\n            return {\r\n                ...state,\r\n                delayedRequest: action.payload.request\r\n            };\r\n        case USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR:\r\n            return {\r\n                ...state,\r\n                delayedRequest: null\r\n            };\r\n        case REQUEST_ERROR: {\r\n            switch (action.payload.label) {\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default userReducer;","/* config.json */\r\nexport const getAppConfigUrl = () => \"config.json\";\r\n\r\n/* hub */\r\nexport const getHubMinimalInfoUrl = () => \"hub/minimalInfo\";\r\n\r\n/* node */\r\nexport const getNodeUrl = (nodeId: number) => `nodes/${nodeId}`;\r\nexport const getNodeCatalogUrl = (nodeId: number) => `nodes/${nodeId}/catalog`;\r\n\r\n/* cache */\r\nexport const getClearMemoryCacheUrl = () => \"MemoryCache/Clear\";\r\nexport const getDataflowsCacheListUrl = (nodeId: number) => `DataflowCache/DataflowData/Nodes/${nodeId}`;\r\nexport const getDataflowsCacheUpdateUrl = (nodeId: number, cacheId: string) => `DataflowCache/DataflowData/${cacheId}/Nodes/${nodeId}`;\r\nexport const getDataflowsCreateCacheUrl = (nodeId: number) => `DataflowCache/DataflowData/Nodes/${nodeId}`;\r\nexport const getDataflowsClearCacheUrl = (nodeId: number, cacheId: string) => `DataflowCache/Clear/${cacheId}/Nodes/${nodeId}`;\r\nexport const getDataflowsClearAllCacheUrl = (nodeId: number) => `DataflowCache/ClearAll/Nodes/${nodeId}`;\r\nexport const getClearNodeCatalogMemoryCacheUrl = (nodeId: number) => `MemoryCache/Clear/CatalogTree/Nodes/${nodeId}`;\r\n\r\n/* templates */\r\nexport const getNodeTemplatesUrl = (nodeId: number) => `nodes/${nodeId}/templates`;\r\nexport const getCreateTemplateUrl = (nodeId: number) => `nodes/${nodeId}/templates`;\r\nexport const getDeleteTemplateUrl = (nodeId: number, id: number) => `nodes/${nodeId}/templates/${id}`;\r\n\r\n/* views */\r\nexport const getViewsUrl = () => `views`;\r\nexport const getCreateViewUrl = (nodeId: number) => `nodes/${nodeId}/views`;\r\nexport const getDeleteViewUrl = (nodeId: number, id: number) => `nodes/${nodeId}/views/${id}`;\r\n\r\n/* dataset */\r\nexport const getDatasetUrl = (nodeId: number, datasetId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/data`;\r\nexport const getDatasetStructureUrl = (nodeId: number, datasetId: string, viewId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/structure${viewId ? `/${viewId}` : \"\"}`;\r\nexport const getDatasetStructureCodelistUrl = (nodeId: number, datasetId: string, dimensionId: string, isFull: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/column/${dimensionId}/${isFull ? \"full\" : \"partial\"}/values`;\r\nexport const getDatasetStructureDynamicCodelistUrl = (nodeId: number, datasetId: string, dimensionId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/PartialCodelists/${dimensionId}`;\r\nexport const getDatasetStructureCodelistsUrl = (nodeId: number, datasetId: string, isFull: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/columns/${isFull ? \"full\" : \"partial\"}/values`;\r\nexport const getDatasetDownloadUrl = (nodeId: number, datasetId: string, format: string, zipped?: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/${zipped === true ? \"downloadZip\" : \"download\"}/${format}`;\r\n\r\n/* config */\r\nexport const getHubConfigGetUrl = () => \"hub/config\";\r\nexport const getHubConfigPutUrl = () => \"hub\";\r\nexport const getNodesConfigUrl = () => \"nodes/config\";\r\nexport const getNodesOrderPutUrl = () => \"nodes/order\";\r\nexport const getNodeConfigGetUrl = (nodeId: number) => `nodes/${nodeId}/config`;\r\nexport const getNodesConfigPostUrl = () => 'nodes';\r\nexport const getNodesConfigPutUrl = (nodeId: number) => `nodes/${nodeId}`;\r\nexport const getNodeDeleteUrl = (nodeId: number, force?: boolean) => `nodes/${nodeId}${force ? \"/true\" : \"\"}`;\r\n\r\n/* log */\r\nexport const getQueryLog = (limit: number) => `tracing/limit/${limit}`;\r\n\r\n/* files */\r\nexport const getFileUploadUrl = () => 'File/Upload';\r\n\r\n/* authentication */\r\nexport const getTokenUrl = () => 'auth/token';\r\nexport const getRefreshTokenUrl = () => 'auth/refreshToken';\r\n\r\n/* users management */\r\nexport const getUsersConfigGetUrl = () => \"users\";\r\nexport const getUserConfigGetUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserConfigPostUrl = () => \"users/register\";\r\nexport const getUserConfigPutUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserDeleteUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserSendResetPasswordMailUrl = () => 'Users/RecoveryPassword';\r\nexport const getUserResetPasswordUrl = () => 'Users/ResetPassword';\r\nexport const getUserChangePasswordUrl = () => 'Users/ChangePassword';\r\n\r\n/* Geometry */\r\nexport const getGeometryUrl = () => `Geometry`;\r\n\r\n/* permissions */\r\nexport const getNodePermissionsConfigGetUrl = (nodeId: number) => `Users/Permissions/Nodes/${nodeId}`;\r\nexport const getNodePermissionsConfigPutUrl = (nodeId: number) => `Users/Permissions/Nodes/${nodeId}`;\r\n\r\n/* dashboards */\r\nexport const getUserDashboardsUrl = () => \"Dashboards\";\r\nexport const getDashboardsUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getDeleteDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getCreateDashboardUrl = () => `Dashboards/`;\r\nexport const getUpdateDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getHubDashboardsUrl = () => \"Dashboards/Hub\";\r\nexport const getNodeDashboardsUrl = (nodeId: number) => `Dashboards/Nodes/${nodeId}`;\r\nexport const getAddHubDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}/Hub`;\r\nexport const getRemoveHubDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}/Hub`;\r\nexport const getOrderHubDashboardsUrl = () => 'Dashboards/Order/Hub';\r\nexport const getAddNodeDashboardUrl = (nodeId: number, dashboardId: number) => `Dashboards/${dashboardId}/Nodes/${nodeId}`;\r\nexport const getRemoveNodeDashboardUrl = (nodeId: number, dashboardId: number) => `Dashboards/${dashboardId}/Nodes/${nodeId}`;\r\nexport const getOrderNodeDashboardsUrl = (nodeId: number) => `Dashboards/Order/Nodes/${nodeId}`;","import {initRequest, RequestMethod} from '../../middlewares/request/requestActions';\r\nimport {\r\n    getRefreshTokenUrl,\r\n    getTokenUrl,\r\n    getUserChangePasswordUrl,\r\n    getUserResetPasswordUrl,\r\n    getUserSendResetPasswordMailUrl\r\n} from '../../serverApi/urls';\r\n\r\nexport const USER_FETCH = 'USER_FETCH';\r\nexport const USER_REFRESH = 'USER_REFRESH';\r\nexport const USER_CLEAR = 'USER_CLEAR';\r\nexport const USER_LOGIN_FORM_SHOW = 'USER_LOGIN_FORM_SHOW';\r\nexport const USER_LOGIN_FORM_HIDE = 'USER_LOGIN_FORM_HIDE';\r\nexport const USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET = 'USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET';\r\nexport const USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR = 'USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR';\r\nexport const USER_SET_PASSWORD_FORM_SHOW = 'USER_SET_PASSWORD_FORM_SHOW';\r\nexport const USER_SET_PASSWORD_FORM_HIDE = 'USER_SET_PASSWORD_FORM_HIDE';\r\nexport const USER_RESET_PASSWORD_EMAIL_SEND = 'USER_RESET_PASSWORD_EMAIL_SEND';\r\nexport const USER_PASSWORD_CHANGE = 'USER_PASSWORD_CHANGE';\r\nexport const USER_PASSWORD_SET = 'USER_PASSWORD_SET';\r\n\r\nexport const fetchUser = (email: string, password: string) => initRequest(\r\n    USER_FETCH,\r\n    getTokenUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        Email: email,\r\n        Password: btoa(password)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userSelect.messages.fetchUser.start\")\r\n    })\r\n);\r\n\r\nexport const refreshUser = () => initRequest(\r\n    USER_REFRESH,\r\n    getRefreshTokenUrl(),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"middlewares.user.messages.refreshUser.start\")\r\n    })\r\n);\r\n\r\nexport const clearUser = () => ({\r\n    type: USER_CLEAR\r\n});\r\n\r\nexport const showUserLoginForm = (alert: string) => ({\r\n    type: USER_LOGIN_FORM_SHOW,\r\n    payload: {\r\n        alert\r\n    }\r\n});\r\n\r\nexport const hideUserLoginForm = () => ({\r\n    type: USER_LOGIN_FORM_HIDE\r\n});\r\n\r\nexport const setUserDelayedRequestWhenTokenExpired = (request: object) => ({\r\n    type: USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET,\r\n    payload: {\r\n        request\r\n    }\r\n});\r\n\r\nexport const clearUserDelayedRequestWhenTokenExpired = () => ({\r\n    type: USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR\r\n});\r\n\r\nexport const hideUserSetPasswordForm = () => ({\r\n    type: USER_SET_PASSWORD_FORM_HIDE\r\n});\r\n\r\nexport const sendUserResetPasswordEmail = (email: string) => initRequest(\r\n    USER_RESET_PASSWORD_EMAIL_SEND,\r\n    getUserSendResetPasswordMailUrl(),\r\n    RequestMethod.POST,\r\n    email,\r\n    t => ({\r\n        onStart: t(\"components.userRecoverPassword.messages.submit.start\")\r\n    }),\r\n    undefined,\r\n    undefined,\r\n    undefined,\r\n    undefined,\r\n    \"application/json\"\r\n);\r\n\r\nexport const changeUserPassword = (oldPassword: string, newPassword: string) => initRequest(\r\n    USER_PASSWORD_CHANGE,\r\n    getUserChangePasswordUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        oldPassword: btoa(oldPassword),\r\n        newPassword: btoa(newPassword)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userChangePasswordForm.messages.submit.start\")\r\n    })\r\n);\r\n\r\nexport const setUserPassword = (email: string, token: string, password: string) => initRequest(\r\n    USER_PASSWORD_SET,\r\n    getUserResetPasswordUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        username: email,\r\n        token,\r\n        password: btoa(password)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userSetPasswordForm.messages.submit.start\")\r\n    })\r\n);\r\n\r\nexport const showUserSetPasswordForm = (token: string) => ({\r\n    type: USER_SET_PASSWORD_FORM_SHOW,\r\n    payload: {\r\n        token\r\n    }\r\n});\r\n","import React, {Fragment} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {DialogActions} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst SettingsDialog = ({title, children, onSubmit, onClose, open, maxWidth, hasSubmit, noMinHeight}) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth={maxWidth || \"md\"}\r\n      fullWidth\r\n      onClose={onClose}\r\n    >\r\n      <DialogTitle>\r\n        {title}\r\n      </DialogTitle>\r\n      <DialogContent\r\n        style={{\r\n          minHeight: noMinHeight ? undefined : 456,\r\n          paddingBottom: noMinHeight ? 16 : undefined\r\n        }}\r\n      >\r\n        {children}\r\n      </DialogContent>\r\n      <DialogActions>\r\n        {hasSubmit\r\n          ? (\r\n            <Fragment>\r\n              <Button onClick={onClose}>\r\n                {t(\"commons.confirm.cancel\")}\r\n              </Button>\r\n              <Button\r\n                onClick={onSubmit}\r\n              >\r\n                {t(\"commons.confirm.submit\")}\r\n              </Button>\r\n            </Fragment>\r\n          )\r\n          : (\r\n            <Button onClick={onClose}>\r\n              {t(\"commons.confirm.close\")}\r\n            </Button>\r\n          )}\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default SettingsDialog;\r\n","import React, {forwardRef, Fragment, useImperativeHandle} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {sendUserResetPasswordEmail} from \"../../../state/user/userActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit}, ref) => {\r\n\r\n  const {register, errors, handleSubmit} = useForm();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        onSubmit(val);\r\n        f(val);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            style={{marginBottom: 8}}\r\n            name=\"email\"\r\n            label={t(\"components.userLoginDialog.recoverPasswordModal.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  sendConfig: config => dispatch(sendUserResetPasswordEmail(config.email))\r\n});\r\n\r\nconst UserRecoverPasswordForm = ({config, sendConfig, userErrors}, ref) => {\r\n\r\n  return (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>))}\r\n      <Form\r\n        ref={ref}\r\n        onSubmit={sendConfig}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserRecoverPasswordForm);\r\n","import React, {Fragment, useRef, useState} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {DialogActions, withStyles} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport {useForm} from \"react-hook-form\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport UserRecoverPasswordForm from \"./user-recover-password-form\";\r\n\r\nconst styles = theme => ({\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  recoverPassword: {\r\n    textDecoration: \"underline\",\r\n    color: theme.palette.secondary.main,\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\nconst UserLoginDialog = ({open, onSubmit, onHide, onRegister, classes, alert}) => {\r\n\r\n  const {register, errors, handleSubmit} = useForm();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isRecoverPasswordModalOpen, setIsRecoverPasswordModalOpen] = useState(false);\r\n\r\n  const recoverPasswordFormRef = useRef();\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n      onClose={onHide}\r\n    >\r\n      <DialogTitle>\r\n        {t(\"components.userLoginDialog.title\")}\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        {alert && (\r\n          <Alert severity=\"error\">{alert}</Alert>\r\n        )}\r\n        <FormControl fullWidth className={alert ? classes.field : undefined}>\r\n          <TextField\r\n            name=\"email\"\r\n            label={t(\"components.userLoginDialog.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n        <FormControl fullWidth className={classes.field}>\r\n          <TextField\r\n            name=\"password\"\r\n            type=\"password\"\r\n            label={t(\"components.userLoginDialog.fields.password\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.password}\r\n            helperText={\r\n              <Fragment>\r\n                {errors.password?.message}\r\n                <span\r\n                  onClick={() => setIsRecoverPasswordModalOpen(true)}\r\n                  className={classes.recoverPassword}\r\n                  style={{\r\n                    marginLeft: errors.password?.message ? 2 : 0\r\n                  }}>\r\n                  {t(\"components.userLoginDialog.recoverPassword\")}\r\n                </span>\r\n              </Fragment>\r\n            }\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onHide}>\r\n          {t(\"commons.confirm.cancel\")}\r\n        </Button>\r\n        <Button onClick={onRegister}>\r\n          {t(\"components.userLoginDialog.register\")}\r\n        </Button>\r\n        <Button onClick={handleSubmit(onSubmit)}>\r\n          {t(\"components.userLoginDialog.login\")}\r\n        </Button>\r\n      </DialogActions>\r\n      <SettingsDialog\r\n        title={t(\"components.userLoginDialog.recoverPasswordModal.title\")}\r\n        maxWidth={\"xs\"}\r\n        open={isRecoverPasswordModalOpen}\r\n        onClose={() => {\r\n          if (recoverPasswordFormRef.current) {\r\n            recoverPasswordFormRef.current.cancel(() => {\r\n              setIsRecoverPasswordModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsRecoverPasswordModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (recoverPasswordFormRef.current) {\r\n            recoverPasswordFormRef.current.submit(() => {\r\n              setIsRecoverPasswordModalOpen(false);\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n        noMinHeight\r\n      >\r\n        <UserRecoverPasswordForm ref={recoverPasswordFormRef}/>\r\n      </SettingsDialog>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(UserLoginDialog);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getUserConfigGetUrl,\r\n    getUserConfigPostUrl,\r\n    getUserConfigPutUrl,\r\n    getUserDeleteUrl,\r\n    getUsersConfigGetUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const USERS_CONFIG_USERS_FETCH = \"usersConfig/fetchUsers\";\r\nexport const USERS_CONFIG_USERS_CLEAR = \"usersConfig/clearUsers\";\r\nexport const USERS_CONFIG_USER_FETCH = \"usersConfig/fetchUser\";\r\nexport const USERS_CONFIG_USER_CLEAR = \"usersConfig/clearUser\";\r\nexport const USERS_CONFIG_USER_DELETE = \"usersConfig/deleteUser\";\r\nexport const USERS_CONFIG_USER_CREATE = \"usersConfig/createUser\";\r\nexport const USERS_CONFIG_USER_EDIT = \"usersConfig/editUser\";\r\nexport const USER_CONFIG_FORM_SHOW = \"usersConfig/showForm\";\r\nexport const USER_CONFIG_FORM_HIDE = \"usersConfig/hideForm\";\r\n\r\nexport const fetchUsersConfigUsers = () => initRequest(\r\n    USERS_CONFIG_USERS_FETCH,\r\n    getUsersConfigGetUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.fetchUsers.start\")\r\n    })\r\n);\r\n\r\nexport const clearUsersConfigUsers = () => ({\r\n    type: USERS_CONFIG_USERS_CLEAR\r\n});\r\n\r\nexport const fetchUsersConfigUser = (userId: number) => initRequest(\r\n    USERS_CONFIG_USER_FETCH,\r\n    getUserConfigGetUrl(userId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.fetchUser.start\")\r\n    })\r\n);\r\n\r\nexport const clearUsersConfigUser = () => ({\r\n    type: USERS_CONFIG_USER_CLEAR\r\n});\r\n\r\nexport const deleteUsersConfigUser = (userId: number) => initRequest(\r\n    USERS_CONFIG_USER_DELETE,\r\n    getUserDeleteUrl(userId),\r\n    RequestMethod.DELETE,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.deleteUser.start\")\r\n    }),\r\n    {\r\n        userId\r\n    }\r\n);\r\n\r\nexport const sendUsersConfigUserCreate = (user: any, isAnonymous: boolean) => initRequest(\r\n    USERS_CONFIG_USER_CREATE,\r\n    getUserConfigPostUrl(),\r\n    RequestMethod.POST,\r\n    user,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.sendUserCreate.start\")\r\n    }),\r\n    {\r\n        isAnonymous\r\n    }\r\n);\r\n\r\nexport const sendUsersConfigUserEdit = (user: any) => initRequest(\r\n    USERS_CONFIG_USER_EDIT,\r\n    getUserConfigPutUrl(user.userId),\r\n    RequestMethod.PUT,\r\n    user,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.sendUserEdit.start\")\r\n    })\r\n);\r\n\r\nexport const showUserConfigForm = (userId: number) => ({\r\n    type: USER_CONFIG_FORM_SHOW,\r\n    payload: {\r\n        userId\r\n    }\r\n});\r\n\r\nexport const hideUserConfigForm = () => ({\r\n    type: USER_CONFIG_FORM_HIDE\r\n});","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUsersConfigUser,\r\n  fetchUsersConfigUser,\r\n  sendUsersConfigUserCreate,\r\n  sendUsersConfigUserEdit,\r\n} from \"../../../../state/usersConfig/usersConfigActions\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  },\r\n  disclaimerLink: {\r\n    marginLeft: theme.spacing(1),\r\n    color: theme.palette.secondary.main,\r\n    textDecoration: \"underline\"\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit, onCancel, isAnonymous, hub}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      isActive: true,\r\n      disclaimerAccepted: isAnonymous ? false : undefined,\r\n      ...config\r\n    }\r\n  });\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showPasswordConfirm, setShowPasswordConfirm] = useState(false);\r\n  const [isDisclaimerModalOpen, setIsDisclaimerModalOpen] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val\r\n        };\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  useEffect(() => {\r\n    register(\"isActive\");\r\n    if (isAnonymous) {\r\n      register({\r\n          name: \"disclaimerAccepted\"\r\n        },\r\n        {\r\n          validate: val => val || t(\"scenes.usersSettings.userSettings.validation.mustAcceptDisclaimer\")\r\n        });\r\n    }\r\n  }, [isAnonymous, register, t]);\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={6}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            disabled={!!config}\r\n            name=\"email\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.email\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      {!config && (\r\n        <Grid item xs={6}>\r\n          <FormControl fullWidth>\r\n            <TextField\r\n              disabled={!!config}\r\n              name=\"emailConfirm\"\r\n              label={t(\"scenes.usersSettings.userSettings.fields.emailConfirm\")}\r\n              inputRef={\r\n                register({\r\n                  required: t(\"commons.validation.required\"),\r\n                  validate: val =>\r\n                    val === watch('email') ||\r\n                    t(\"scenes.usersSettings.userSettings.validation.emailsMustBeEqual\")\r\n                })\r\n              }\r\n              error={!!errors.emailConfirm}\r\n              helperText={errors.emailConfirm?.message}\r\n              variant=\"outlined\"\r\n              required\r\n            />\r\n          </FormControl>\r\n        </Grid>\r\n      )}\r\n      {!isAnonymous && (\r\n        <Grid item xs={12}>\r\n          <FormControl fullWidth>\r\n            <FormControlLabel\r\n              label={t(\"scenes.usersSettings.userSettings.fields.isActive.label\")}\r\n              control={\r\n                <Checkbox\r\n                  name=\"isActive\"\r\n                  required\r\n                  checked={watch('isActive')}\r\n                  onChange={(e, value) => setValue('isActive', value)}\r\n                />\r\n              }\r\n            />\r\n          </FormControl>\r\n        </Grid>\r\n      )}\r\n      <Grid item xs={6}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"firstName\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.firstName\")}\r\n            error={!!errors.firstName}\r\n            helperText={errors.firstName?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={6}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"lastName\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.lastName\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.lastName}\r\n            helperText={errors.lastName?.message}\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"organization\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.organization\")}\r\n            error={!!errors.organization}\r\n            helperText={errors.organization?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      {!config && (\r\n        <Fragment>\r\n          <Grid item xs={6}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"password\"\r\n                label={t(\"scenes.usersSettings.userSettings.fields.password\")}\r\n                error={!!errors.password}\r\n                helperText={errors.password?.message}\r\n                variant=\"outlined\"\r\n                required\r\n                type={showPassword ? undefined : \"password\"}\r\n                inputRef={register({required: t(\"commons.validation.required\")})}\r\n                InputProps={{\r\n                  endAdornment: (\r\n                    <InputAdornment position=\"end\">\r\n                      <IconButton\r\n                        onClick={() => setShowPassword(!showPassword)}\r\n                      >\r\n                        {showPassword ? <Visibility/> : <VisibilityOff/>}\r\n                      </IconButton>\r\n                    </InputAdornment>\r\n                  )\r\n                }}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={6}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"passwordConfirm\"\r\n                label={t(\"scenes.usersSettings.userSettings.fields.passwordConfirm\")}\r\n                error={!!errors.passwordConfirm}\r\n                helperText={errors.passwordConfirm?.message}\r\n                variant=\"outlined\"\r\n                required\r\n                type={showPasswordConfirm ? undefined : \"password\"}\r\n                inputRef={\r\n                  register({\r\n                    required: t(\"commons.validation.required\"),\r\n                    validate: val =>\r\n                      val === watch('password') ||\r\n                      t(\"scenes.usersSettings.userSettings.validation.passwordsMustBeEqual\")\r\n                  })\r\n                }\r\n                InputProps={{\r\n                  endAdornment: (\r\n                    <InputAdornment position=\"end\">\r\n                      <IconButton\r\n                        onClick={() => setShowPasswordConfirm(!showPasswordConfirm)}\r\n                      >\r\n                        {showPasswordConfirm ? <Visibility/> : <VisibilityOff/>}\r\n                      </IconButton>\r\n                    </InputAdornment>\r\n                  )\r\n                }}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          {isAnonymous && (\r\n            <Grid item xs={12}>\r\n              <FormControl fullWidth error={!!errors.disclaimerAccepted}>\r\n                <FormControlLabel\r\n                  label={\r\n                    <Fragment>\r\n                      {t(\"scenes.usersSettings.userSettings.fields.disclaimerAccepted.label\")}\r\n                      <span\r\n                        onClick={() => setIsDisclaimerModalOpen(true)}\r\n                        className={classes.disclaimerLink}\r\n                      >\r\n                        {t(\"scenes.usersSettings.userSettings.fields.disclaimerAccepted.link\")}\r\n                      </span>\r\n                    </Fragment>\r\n                  }\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"disclaimerAccepted\"\r\n                      required\r\n                      checked={watch('disclaimerAccepted')}\r\n                      onChange={(e, value) => setValue('disclaimerAccepted', value)}\r\n                    />\r\n                  }\r\n                />\r\n                {errors.disclaimerAccepted?.message && (\r\n                  <FormHelperText id=\"my-helper-text\">\r\n                    {errors.disclaimerAccepted?.message}\r\n                  </FormHelperText>\r\n                )}\r\n              </FormControl>\r\n            </Grid>\r\n          )}\r\n          <Dialog\r\n            open={isDisclaimerModalOpen}\r\n            fullWidth\r\n            maxWidth=\"md\"\r\n            onClose={() => setIsDisclaimerModalOpen(false)}\r\n          >\r\n            <DialogTitle>\r\n              {t(\"scenes.usersSettings.userSettings.disclaimerModal.title\")}\r\n            </DialogTitle>\r\n            <DialogContent>\r\n              <div dangerouslySetInnerHTML={{__html: hub.hub.disclaimer}} style={{maxHeight: 460}}/>\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={() => setIsDisclaimerModalOpen(false)}>\r\n                {t(\"commons.confirm.cancel\")}\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n        </Fragment>\r\n      )}\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors,\r\n  hub: state.hub\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchUsersConfigUser(nodeId)),\r\n  sendConfigCreate: (config, isAnonymous) => dispatch(sendUsersConfigUserCreate(config, isAnonymous)),\r\n  sendConfig: config => dispatch(sendUsersConfigUserEdit(config)),\r\n  clearConfig: () => dispatch(clearUsersConfigUser())\r\n});\r\n\r\nconst UserSettingsForm = ({config, userId, fetchConfig, sendConfigCreate, sendConfig, clearConfig, userErrors, isAnonymous, hub}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(userId >= 0);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(userId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, userId]);\r\n\r\n  return (userId === -1 || config) && (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>))}\r\n      <Form\r\n        config={userId === -1 ? undefined : config}\r\n        ref={ref}\r\n        onSubmit={\r\n          userId === -1\r\n            ? (config) => sendConfigCreate(config, isAnonymous)\r\n            : sendConfig\r\n        }\r\n        onCancel={clearConfig}\r\n        isAnonymous={isAnonymous}\r\n        hub={hub}\r\n      />\r\n    </Fragment>\r\n\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserSettingsForm);\r\n","import React, {Component, forwardRef, Fragment} from 'react';\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\n\r\nclass ButtonSelect extends Component {\r\n\r\n  state = {\r\n    anchorEl: null\r\n  };\r\n\r\n  setAnchorEl = (el) => {\r\n    this.setState({\r\n      anchorEl: el\r\n    });\r\n  };\r\n\r\n  handleMenu = (event) => {\r\n    this.setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setAnchorEl(null);\r\n  };\r\n\r\n  render() {\r\n\r\n    const {children, icon, value, color, tooltip, disabled, selectedIdx, onChange} = this.props;\r\n    const {anchorEl} = this.state;\r\n\r\n    const open = Boolean(anchorEl);\r\n\r\n    const Item = forwardRef(({c, isSelected}, ref) =>\r\n      <MenuItem\r\n        ref={ref}\r\n        onClick={() => {\r\n          if (c.props?.onClick) {\r\n            c.props.onClick();\r\n          }\r\n          if (onChange) {\r\n            onChange(c.props[\"data-value\"]);\r\n          }\r\n          this.handleClose();\r\n        }}\r\n        style={{background: isSelected ? \"#fff9e5\" : \"white\"}}\r\n      >\r\n        {c}\r\n      </MenuItem>);\r\n\r\n    return (\r\n      <Fragment>\r\n        <Tooltip title={tooltip || \"\"}>\r\n          <span>\r\n            {value\r\n              ? (\r\n                <Button\r\n                  color={color || \"inherit\"}\r\n                  onClick={this.handleMenu}\r\n                  startIcon={icon}\r\n                  endIcon={<ArrowDropDownIcon/>}\r\n                  disabled={disabled}\r\n                >\r\n                  {value}\r\n                </Button>\r\n              )\r\n              : <IconButton color={color || \"inherit\"} onClick={this.handleMenu} disabled={disabled}>{icon}</IconButton>\r\n            }\r\n          </span>\r\n        </Tooltip>\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          anchorOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          keepMounted\r\n          transformOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          open={open}\r\n          onClose={this.handleClose}\r\n        >\r\n          {children.length\r\n            ? children.filter(c => c).map((c, i) => c !== null ? <Item c={c} key={i} isSelected={i === selectedIdx}/> : null)\r\n            : <Item c={children}/>\r\n          }\r\n        </Menu>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ButtonSelect;","import React, {forwardRef, Fragment, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\nimport {changeUserPassword} from \"../../../state/user/userActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch} = useForm();\r\n\r\n  const [showOldPassword, setShowOldPassword] = useState(false);\r\n  const [showNewPassword, setShowNewPassword] = useState(false);\r\n  const [showNewPasswordConfirm, setShowNewPasswordConfirm] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        onSubmit(val);\r\n        f(val);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"oldPassword\"\r\n            label={t(\"components.userSelect.changePasswordModal.fields.oldPassword\")}\r\n            error={!!errors.oldPassword}\r\n            helperText={errors.oldPassword?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showOldPassword ? undefined : \"password\"}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowOldPassword(!showOldPassword)}\r\n                  >\r\n                    {showOldPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"newPassword\"\r\n            label={t(\"components.userSelect.changePasswordModal.fields.newPassword\")}\r\n            error={!!errors.newPassword}\r\n            helperText={errors.newPassword?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showNewPassword ? undefined : \"password\"}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowNewPassword(!showNewPassword)}\r\n                  >\r\n                    {showNewPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"newPasswordConfirm\"\r\n            label={t(\"components.userSelect.changePasswordModal.fields.newPasswordConfirm\")}\r\n            error={!!errors.newPasswordConfirm}\r\n            helperText={errors.newPasswordConfirm?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showNewPasswordConfirm ? undefined : \"password\"}\r\n            inputRef={\r\n              register({\r\n                required: t(\"commons.validation.required\"),\r\n                validate: val =>\r\n                  val === watch('newPassword') ||\r\n                  t(\"components.userSelect.changePasswordModal.validation.newPasswordMustBeEqual\")\r\n              })}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowNewPasswordConfirm(!showNewPasswordConfirm)}\r\n                  >\r\n                    {showNewPasswordConfirm ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  sendConfig: config => dispatch(changeUserPassword(config.oldPassword, config.newPassword))\r\n});\r\n\r\nconst UserChangePasswordForm = ({config, sendConfig, userErrors}, ref) => {\r\n\r\n  return (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>))}\r\n      <Form\r\n        ref={ref}\r\n        onSubmit={sendConfig}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserChangePasswordForm);\r\n","import React, {Fragment, useRef, useState} from 'react';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUser,\r\n  fetchUser,\r\n  hideUserLoginForm,\r\n  showUserLoginForm\r\n} from \"../../state/user/userActions\";\r\nimport UserLoginDialog from \"../user-login-dialog\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport UserSettingsForm from \"../settings-select/users-settings-form/user-settings-form\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport ButtonSelect from \"../button-select\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport UserChangePasswordForm from \"./user-change-password-form\";\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onLogin: (email, password) => dispatch(fetchUser(email, password)),\r\n  onLogout: () => dispatch(clearUser()),\r\n  onLoginFormShow: () => dispatch(showUserLoginForm()),\r\n  onLoginFormHide: () => dispatch(hideUserLoginForm()),\r\n});\r\n\r\nconst styles = () => ({\r\n  email: {\r\n    cursor: \"initial\",\r\n    color: \"gray\"\r\n  }\r\n});\r\n\r\nconst UserSelect = ({classes, user, onLogin, onLogout, onLoginFormShow, onLoginFormHide}) => {\r\n\r\n  const [isChangePasswordModalOpen, setIsChangePasswordModalOpen] = useState(false);\r\n  const [isRegisterModalOpen, setIsRegisterModalOpen] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const registerFormRef = useRef();\r\n  const changePasswordFormRef = useRef();\r\n\r\n  return (\r\n    <Fragment>\r\n      {user.isAuthenticated\r\n        ? (\r\n          <Tooltip title={user.email}>\r\n            <ButtonSelect value=\"\" icon={<AccountCircleIcon/>}>\r\n              <div className={classes.email}>\r\n                {user.email}\r\n              </div>\r\n              <div onClick={() => setIsChangePasswordModalOpen(true)}>\r\n                {t(\"components.userSelect.changePassword\")}\r\n              </div>\r\n              <div onClick={onLogout}>\r\n                {t(\"components.userSelect.logout\")}\r\n              </div>\r\n            </ButtonSelect>\r\n          </Tooltip>\r\n        )\r\n        : (\r\n          <Button color=\"inherit\" onClick={onLoginFormShow}>\r\n            {t(\"components.userSelect.login\")}\r\n          </Button>\r\n        )}\r\n      <UserLoginDialog open={user.isLoginDialogOpen}\r\n                       onSubmit={({email, password}) => onLogin(email, password)}\r\n                       onRegister={() => setIsRegisterModalOpen(true)}\r\n                       onHide={onLoginFormHide} alert={user.message}/>\r\n      <SettingsDialog\r\n        title={t(\"components.userSelect.registerModal.title\")}\r\n        maxWidth={\"md\"}\r\n        open={isRegisterModalOpen}\r\n        onClose={() => {\r\n          if (registerFormRef.current) {\r\n            registerFormRef.current.cancel(() => {\r\n              setIsRegisterModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsRegisterModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (registerFormRef.current) {\r\n            registerFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <UserSettingsForm ref={registerFormRef} userId={-1} isAnonymous/>\r\n      </SettingsDialog>\r\n      <SettingsDialog\r\n        title={t(\"components.userSelect.changePasswordModal.title\")}\r\n        maxWidth={\"xs\"}\r\n        open={isChangePasswordModalOpen}\r\n        onClose={() => {\r\n          if (changePasswordFormRef.current) {\r\n            changePasswordFormRef.current.cancel(() => {\r\n              setIsChangePasswordModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsChangePasswordModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (changePasswordFormRef.current) {\r\n            changePasswordFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n        noMinHeight\r\n      >\r\n        <UserChangePasswordForm ref={changePasswordFormRef}/>\r\n      </SettingsDialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(UserSelect);","export const goToDatasets = (nodeCode, categoryPath) =>\r\n  window.open(`./#/${window.language}/${nodeCode.toLowerCase()}/${categoryPath.join(\"/\")}`, '_self');\r\n\r\nexport const goToData = (nodeCode, categoryPath, datasetId, viewId, a11y) =>\r\n  window.open(\r\n    `./#/${window.language}/${nodeCode.toLowerCase()}/${categoryPath.length > 0 ? categoryPath.join(\"/\") + \"/\" : \"\"}` +\r\n    `${datasetId}${(viewId || a11y) ? '?' : ''}${viewId ? `view=${viewId}` : \"\"}${a11y ? \"accessible=true\" : \"\"}`,\r\n    '_self'\r\n  );\r\n\r\n// filters = c1/c2,c3/c4\r\nexport const goToDatasetsSearch = (nodeCode, query, filters) => {\r\n  window.open(\r\n    `./#/${window.language}/${nodeCode.toLowerCase()}/search?q=${encodeURIComponent(query)}` +\r\n    (filters && filters.length > 0 ? `&c=${encodeURIComponent(filters.map(f => encodeURIComponent(f.join(\"/\"))).join(\"//\"))}` : ''),\r\n    '_self'\r\n  );\r\n};\r\n\r\nexport const goToNode = nodeCode => window.open(`./#/${window.language}/${nodeCode}`, '_self');\r\nexport const goToHome = () => window.open(`./#/${window.language}`, '_self');\r\n\r\nexport const goToHubDashboards = () => window.open(`./#/${window.language}/dashboards`, '_self');\r\nexport const goToNodeDashboards = nodeCode => window.open(`./#/${window.language}/${nodeCode.toLowerCase()}/dashboards`, '_self');\r\nexport const goToDashboard = dashboardId => window.open(`./#/${window.language}/dashboards/${dashboardId}`, '_self');","import React, {Component, Fragment} from 'react';\r\nimport TreeView from '@material-ui/lab/TreeView';\r\nimport TreeItem from '@material-ui/lab/TreeItem';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport InfoOutlinedIcon from '@material-ui/icons/InfoOutlined';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {Link, withStyles} from \"@material-ui/core\";\r\nimport {goToDatasets} from \"../../links\";\r\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\r\nimport ListIcon from '@material-ui/icons/List';\r\nimport FolderIcon from '@material-ui/icons/Folder';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\n\r\nconst styles = () => ({\r\n  nodeIcon: {\r\n    marginTop: 5\r\n  },\r\n  selectedItem: {\r\n    background: \"rgba(0, 41, 90, 0.2) !important\"\r\n  }\r\n});\r\n\r\nclass CategoriesTree extends Component {\r\n\r\n  state = {\r\n    expanded: this.props.selectedCategoryPath || []\r\n  };\r\n\r\n  onExpand = expanded => this.setState({expanded});\r\n\r\n  render() {\r\n\r\n    const {classes, node, catalog, selectedCategoryPath = [], onClose, t} = this.props;\r\n    const {expanded} = this.state;\r\n\r\n    const getTreeItems = (tree, prevPath) =>\r\n      tree.map((cat, i) =>\r\n        <TreeItem\r\n          key={i}\r\n          nodeId={cat.id}\r\n          label={\r\n            <Grid spacing={1} container alignItems=\"center\">\r\n              <Grid item>\r\n                {(expanded.includes(cat.id))\r\n                  ? <FolderOpenIcon className={classes.nodeIcon}/>\r\n                  : <FolderIcon className={classes.nodeIcon}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                {cat.label}\r\n              </Grid>\r\n              {cat.hasAnnotation && (\r\n                <Grid item>\r\n                  <IconButton\r\n                    size=\"small\"\r\n                    onClick={this.onDialogOpen}\r\n                  >\r\n                    <InfoOutlinedIcon/>\r\n                  </IconButton>\r\n                </Grid>\r\n              )}\r\n            </Grid>\r\n          }\r\n          /* TODO: inefficente */\r\n          classes={{\r\n            label: selectedCategoryPath.includes(cat.id) ? classes.selectedItem : null\r\n          }}\r\n        >\r\n          {(\r\n            (cat.datasetIdentifiers && cat.datasetIdentifiers.length > 0) ||\r\n            (cat.childrenCategories && cat.childrenCategories.length > 0)\r\n          ) && (\r\n            <Fragment>\r\n              {(cat.datasetIdentifiers && cat.datasetIdentifiers.length > 0) && (\r\n                <TreeItem\r\n                  nodeId={cat.id + \"-results\"}\r\n                  label={\r\n                    <Link onClick={() => {\r\n                      onClose();\r\n                      goToDatasets(node.code.toLowerCase(), [...prevPath, cat.id]);\r\n                    }}>\r\n                      <Grid spacing={1} container alignItems=\"center\">\r\n                        <Grid item>\r\n                          <ListIcon className={classes.nodeIcon}/>\r\n                        </Grid>\r\n                        <Grid item>\r\n                          <i>{t(\"components.categoriesTree.goToData\", {datasetsCount: cat.datasetIdentifiers.length})}</i>\r\n                        </Grid>\r\n                      </Grid>\r\n                    </Link>\r\n                  }\r\n                />\r\n              )}\r\n              {cat.childrenCategories && cat.childrenCategories.length > 0 &&\r\n              getTreeItems(cat.childrenCategories, [...prevPath, cat.id])}\r\n            </Fragment>\r\n          )}\r\n        </TreeItem>\r\n      );\r\n\r\n    const getCategorySchemeTree = ({id, label, categories}) =>\r\n      <TreeView\r\n        defaultCollapseIcon={<ExpandMoreIcon/>}\r\n        defaultExpandIcon={<ChevronRightIcon/>}\r\n        expanded={expanded}\r\n        onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n        key={id}\r\n      >\r\n        {getTreeItems([{id, label, childrenCategories: categories}], [])}\r\n      </TreeView>;\r\n\r\n    return (\r\n      <Fragment>\r\n        {catalog.categoryGroups.length > 0 && (\r\n          catalog.categoryGroups.length > 1\r\n            ? (\r\n              <Fragment>\r\n                {catalog.categoryGroups.map(getCategorySchemeTree)}\r\n              </Fragment>\r\n            )\r\n            : (\r\n              <TreeView\r\n                defaultCollapseIcon={<ExpandMoreIcon/>}\r\n                defaultExpandIcon={<ChevronRightIcon/>}\r\n                expanded={expanded}\r\n                onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n              >\r\n                {getTreeItems(catalog.categoryGroups[0].categories, [])}\r\n              </TreeView>\r\n            )\r\n        )}\r\n        {catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0 && (\r\n          <TreeView\r\n            defaultCollapseIcon={<ExpandMoreIcon/>}\r\n            defaultExpandIcon={<ChevronRightIcon/>}\r\n            expanded={expanded}\r\n            onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n          >\r\n            <TreeItem\r\n              key={\"uncategorized\"}\r\n              nodeId={\"uncategorized\"}\r\n              label={\r\n                <Grid spacing={1} container alignItems=\"center\">\r\n                  <Grid item>\r\n                    {(expanded.includes(\"uncategorized\")\r\n                        ? <FolderOpenIcon className={classes.nodeIcon}/>\r\n                        : <FolderIcon className={classes.nodeIcon}/>\r\n                    )}\r\n                  </Grid>\r\n                  <Grid item>\r\n                    {t(\"commons.catalog.uncategorized\")}\r\n                  </Grid>\r\n                </Grid>\r\n              }\r\n              /* TODO: inefficente */\r\n              classes={{\r\n                content: selectedCategoryPath.includes(\"uncategorized\") ? classes.selectedItem : null\r\n              }}\r\n            >\r\n              <TreeItem\r\n                nodeId={\"uncategorized-results\"}\r\n                label={\r\n                  <Link onClick={() => {\r\n                    onClose();\r\n                    goToDatasets(node.code.toLowerCase(), [\"uncategorized\"]);\r\n                  }}>\r\n                    <Grid spacing={1} container alignItems=\"center\">\r\n                      <Grid item>\r\n                        <ListIcon className={classes.nodeIcon}/>\r\n                      </Grid>\r\n                      <Grid item>\r\n                        <i>{t(\"components.categoriesTree.goToData\", {datasetsCount: catalog.uncategorizedDatasets.length})}</i>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Link>\r\n                }\r\n              />\r\n            </TreeItem>\r\n          </TreeView>\r\n        )}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(CategoriesTree);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getAddHubDashboardUrl,\r\n    getHubConfigGetUrl,\r\n    getHubConfigPutUrl,\r\n    getHubDashboardsUrl,\r\n    getOrderHubDashboardsUrl,\r\n    getRemoveHubDashboardUrl,\r\n    getUserDashboardsUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const HUB_CONFIG_FETCH = \"hubConfig/fetch\";\r\nexport const HUB_CONFIG_SEND = \"hubConfig/send\";\r\nexport const HUB_CONFIG_CLEAR = \"hubConfig/clear\";\r\nexport const HUB_CONFIG_DASHBOARDS_FETCH = \"hubConfig/dashboards/fetch\";\r\nexport const HUB_CONFIG_DASHBOARDS_FETCH_ALL = \"hubConfig/dashboards/fetchAll\";\r\nexport const HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD = \"hubConfig/dashboards/addDashboard\";\r\nexport const HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE = \"hubConfig/dashboards/removeDashboard\";\r\nexport const HUB_CONFIG_DASHBOARDS_ORDERS_SEND = \"hubConfig/dashboards/sendOrders\";\r\nexport const HUB_CONFIG_DASHBOARDS_CLEAR = \"hubConfig/dashboards/clear\";\r\nexport const HUB_CONFIG_DASHBOARDS_CLEAR_ALL = \"hubConfig/dashboards/clearAll\";\r\nexport const HUB_CONFIG_CLOSE = \"hubConfig/close\";\r\n\r\nexport const fetchHubConfig = () => initRequest(\r\n    HUB_CONFIG_FETCH,\r\n    getHubConfigGetUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchConfig.start\")\r\n    })\r\n);\r\n\r\nexport const sendHubConfig = (config: any) => initRequest(\r\n  HUB_CONFIG_SEND,\r\n  getHubConfigPutUrl(),\r\n    RequestMethod.PUT,\r\n    config,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.sendConfig.start\")\r\n    })\r\n);\r\n\r\nexport const clearHubConfig = () => ({\r\n    type: HUB_CONFIG_CLEAR\r\n});\r\n\r\nexport const fetchHubConfigDashboards = () => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_FETCH,\r\n    getHubDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const fetchAllHubConfigDashboards = () => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_FETCH_ALL,\r\n    getUserDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchAllDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const addHubConfigDashboardsDashboard = (dashboardId: number) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n    getAddHubDashboardUrl(dashboardId),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.addDashboard.start\")\r\n    })\r\n);\r\n\r\nexport const removeHubConfigDashboardsDashboard = (dashboardId: number) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n    getRemoveHubDashboardUrl(dashboardId),\r\n    RequestMethod.DELETE,\r\n    null,\r\n    t => ({\r\n        onStart:t(\"scenes.appSettings.messages.removeDashboard.start\")\r\n    })\r\n);\r\n\r\nexport const sendHubConfigDashboardsOrders = (orderedDashboardsIds: number[]) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n    getOrderHubDashboardsUrl(),\r\n    RequestMethod.POST,\r\n    orderedDashboardsIds,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.sendDashboardsOrders.start\")\r\n    })\r\n)\r\n\r\nexport const clearHubConfigDashboards = () => ({\r\n    type: HUB_CONFIG_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const clearAllHubConfigDashboards = () => ({\r\n    type: HUB_CONFIG_DASHBOARDS_CLEAR_ALL\r\n});\r\n\r\nexport const closeHubConfig = () => ({\r\n    type: HUB_CONFIG_CLOSE\r\n});","import React, {Fragment, useState} from 'react';\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport CancelIcon from \"@material-ui/icons/Cancel\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport PublishIcon from '@material-ui/icons/Publish';\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport {connect} from \"react-redux\";\r\nimport {getFileUploadUrl} from \"../../serverApi/urls\";\r\nimport {compose} from \"redux\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  startAdornment: {\r\n    marginRight: theme.spacing(2)\r\n  },\r\n  fileInput: {\r\n    display: \"none\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL,\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  addSpinnerMessage: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  markSpinnerMessage: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\nconst FileInput = ({label, value, onChange, classes, baseURL, error, helperText, required, addSpinnerMessage, markSpinnerMessage, user}) => {\r\n\r\n  const [id] = useState(uuidv4());\r\n  const [fileName, setFileName] = useState(value?.substring(value.lastIndexOf('/') + 1) || '');\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Fragment>\r\n      <input\r\n        accept=\"image/*, video/*\"\r\n        className={classes.fileInput}\r\n        id={id}\r\n        type=\"file\"\r\n        onChange={e => {\r\n          const file = e.target.files[0];\r\n\r\n          let fileFormData = new FormData();\r\n          fileFormData.append('files', file);\r\n\r\n          const uuid = uuidv4();\r\n\r\n          addSpinnerMessage(uuid, t(\"components.fileInput.messages.upload.start\"));\r\n\r\n          fetch(baseURL + getFileUploadUrl(), {\r\n            method: 'POST',\r\n            body: fileFormData,\r\n            headers: {\r\n              \"Authorization\": user.token ? `bearer ${user.token}` : undefined\r\n            },\r\n            credentials: 'include'\r\n          })\r\n            .then(res => res.json())\r\n            .then(res => {\r\n              markSpinnerMessage(uuid);\r\n              const filePath = res[0];\r\n              onChange(filePath);\r\n              setFileName(filePath.substring(filePath.lastIndexOf('/') + 1));\r\n            })\r\n            .catch(() => {\r\n              markSpinnerMessage(uuid, true);\r\n              window.error.show(t(\"components.fileInput.messages.upload.error\"));\r\n            });\r\n        }}\r\n      />\r\n      <TextField\r\n        variant=\"outlined\"\r\n        label={label}\r\n        value={fileName}\r\n        InputProps={{\r\n          startAdornment: (\r\n            <InputAdornment className={classes.startAdornment} position=\"start\">\r\n              <label htmlFor={id}>\r\n                <Button startIcon={<PublishIcon/>} variant=\"outlined\" disabled={!!value}\r\n                        title=\"Upload new file\" component=\"span\">\r\n                  {t(\"components.fileInput.upload\")}\r\n                </Button>\r\n              </label>\r\n            </InputAdornment>\r\n          ),\r\n          endAdornment:\r\n            value && (\r\n              <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  title= {t(\"components.fileInput.reset\")}\r\n                  onClick={() => {\r\n                    setFileName('');\r\n                    onChange('');\r\n                  }}\r\n                >\r\n                  <CancelIcon/>\r\n                </IconButton>\r\n              </InputAdornment>\r\n            ),\r\n        }}\r\n        error={error}\r\n        required={required}\r\n        helperText={helperText}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(FileInput);","import React from 'react';\r\nimport MaterialTable from \"material-table\";\r\nimport _ from 'lodash';\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst CustomMaterialTable = props => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  // these props are meant to be used for customizing material table all spread the app\r\n  const customProps = {\r\n    localization: {\r\n      body: {\r\n        emptyDataSourceMessage: t(\"components.customMaterialTable.empty\"),\r\n      },\r\n      header: {\r\n        actions: \"\"\r\n      },\r\n      toolbar: {\r\n        searchPlaceholder: t(\"components.customMaterialTable.search.placeholder\"),\r\n        searchTooltip: t(\"components.customMaterialTable.search.tooltip\")\r\n      }\r\n    }\r\n  };\r\n\r\n  // props passed to this component are merged with and can override the custom props\r\n  const mergedProps = _.merge(customProps, props);\r\n\r\n  return <MaterialTable {...mergedProps}/>;\r\n};\r\n\r\nexport default CustomMaterialTable;\r\n","import _ from \"lodash\";\r\n\r\nexport const validateI18nObj = obj =>\r\n  obj !== undefined && obj !== null &&\r\n  _(obj)\r\n    .pickBy(val => val !== undefined && val !== null && val.length > 0)\r\n    .keys()\r\n    .value().length > 0;\r\n\r\nexport const localizeI18nObj = (obj, prefLang, langs) => {\r\n\r\n  if (obj === null || obj === undefined || obj === {}) {\r\n    return null\r\n  }\r\n  if (typeof (obj) === \"string\") {\r\n    return obj\r\n  }\r\n\r\n  if (obj[prefLang]) {\r\n    return obj[prefLang];\r\n  }\r\n\r\n  for (let code of langs) {\r\n    if (obj[code]) {\r\n      return obj[code];\r\n    }\r\n  }\r\n\r\n  return obj[Object.keys(obj)[0]];\r\n};\r\n\r\nexport const getI18nObjCustomFilterAndSearch = (language, languages) => (str, row, {field}) =>\r\n  localizeI18nObj(row[field], language, languages).toLowerCase().includes(str.toLowerCase());","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {compose} from \"redux\";\r\nimport {Box, Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport ArrowDropUpIcon from \"@material-ui/icons/ArrowDropUp\";\r\nimport ArrowDropDownIcon from \"@material-ui/icons/ArrowDropDown\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../utils/i18n\";\r\nimport {MTableToolbar} from \"material-table\";\r\nimport \"./style.css\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  languages: state.app.languages,\r\n  defaultLanguage: state.app.language\r\n});\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst DashboardsManager = ({\r\n                             classes,\r\n                             defaultLanguage,\r\n                             languages,\r\n                             dashboards,\r\n                             allDashboards,\r\n                             fetchDashboards,\r\n                             fetchAllDashboards,\r\n                             addDashboard,\r\n                             removeDashboard,\r\n                             sendDashboardsOrders,\r\n                             clearDashboards,\r\n                             clearAllDashboards\r\n                           }, ref) => {\r\n\r\n  const [needFetch, setNeedFetch] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    if (needFetch) {\r\n      setNeedFetch(false);\r\n      fetchDashboards();\r\n    }\r\n  }, [dashboards, needFetch, setNeedFetch, fetchDashboards]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    destroy(f) {\r\n      clearDashboards();\r\n      if (f) {\r\n        f();\r\n      }\r\n    }\r\n  }));\r\n\r\n  const orderedDashboardsIds = (dashboards || []).map(({dashboardId}) => dashboardId);\r\n\r\n  const moveUp = rowIndex =>\r\n    sendDashboardsOrders([\r\n      ...orderedDashboardsIds.slice(0, rowIndex - 1),\r\n      orderedDashboardsIds[rowIndex],\r\n      orderedDashboardsIds[rowIndex - 1],\r\n      ...orderedDashboardsIds.slice(rowIndex + 1)\r\n    ]);\r\n\r\n  const moveDown = rowIndex =>\r\n    sendDashboardsOrders([\r\n      ...orderedDashboardsIds.slice(0, rowIndex),\r\n      orderedDashboardsIds[rowIndex + 1],\r\n      orderedDashboardsIds[rowIndex],\r\n      ...orderedDashboardsIds.slice(rowIndex + 2)\r\n    ]);\r\n\r\n  return dashboards !== null && (\r\n    <Fragment>\r\n      <Dialog\r\n        open={allDashboards !== null}\r\n        disableEscapeKeyDown\r\n        disableBackdropClick\r\n        maxWidth=\"md\"\r\n        fullWidth\r\n        onClose={() => {\r\n          clearAllDashboards();\r\n        }}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardsManager.modals.addDashboard.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{minHeight: 456}}>\r\n          {allDashboards !== null && (\r\n            <CustomMaterialTable\r\n              components={{\r\n                Container: Box\r\n              }}\r\n              columns={[\r\n                {\r\n                  field: \"title\",\r\n                  title: t(\"components.dashboardsManager.modals.addDashboard.table.columns.dashboardTitle\"),\r\n                  render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n                  customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n                }\r\n              ]}\r\n              data={allDashboards}\r\n              actions={[\r\n                ({dashboardId}) => {\r\n                  const assigned = !!dashboards.find(dashboard => dashboard.dashboardId === dashboardId)\r\n                  return ({\r\n                    icon: AddIcon,\r\n                    tooltip:\r\n                      assigned\r\n                        ? t(\"components.dashboardsManager.modals.addDashboard.table.actions.addDashboard.tooltip.assigned\")\r\n                        : t(\"components.dashboardsManager.modals.addDashboard.table.actions.addDashboard.tooltip.notAssigned\"),\r\n                    onClick: (_, {dashboardId}) => addDashboard(dashboardId),\r\n                    disabled: assigned\r\n                  });\r\n                }\r\n              ]}\r\n              options={{\r\n                paging: false,\r\n                draggable: true,\r\n                actionsColumnIndex: 2,\r\n                searchFieldAlignment: \"left\",\r\n                maxBodyHeight: 400,\r\n                showTitle: false\r\n              }}\r\n              icons={tableIcons}\r\n            />\r\n          )}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => clearAllDashboards()}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n      <FormControlLabel\r\n        label={t(\"components.dashboardsManager.fields.showHubDashboards.label\")}\r\n        control={\r\n          <Checkbox\r\n            name=\"showHubDashboards\"\r\n            checked\r\n            disabled\r\n          />\r\n        }\r\n      />\r\n      <Box className=\"dashboards-manager__table\">\r\n        <CustomMaterialTable\r\n          title=\"\"\r\n          components={{\r\n            Container: Box,\r\n            Toolbar: props =>\r\n              <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n                <Grid item>\r\n                  <MTableToolbar {...props} />\r\n                </Grid>\r\n                <Grid item>\r\n                  <Button\r\n                    size=\"small\"\r\n                    startIcon={<AddIcon/>}\r\n                    onClick={() => {\r\n                      fetchAllDashboards();\r\n                    }}>\r\n                    {t(\"components.dashboardsManager.addDashboard\")}\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n          }}\r\n          columns={[\r\n            {\r\n              field: \"title\",\r\n              title: t(\"components.dashboardsManager.table.columns.dashboardTitle\"),\r\n              render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n              customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n            }\r\n          ]}\r\n          data={dashboards}\r\n          actions={[\r\n            ({tableData}) => ({\r\n              icon: ArrowDropUpIcon,\r\n              tooltip: t(\"components.dashboardsManager.table.actions.dashboardOrderMoveUp\"),\r\n              onClick: (_, {tableData}) => moveUp(tableData.id), // tableData.id is the rowIndex\r\n              disabled: tableData.id === 0\r\n            }),\r\n            ({tableData}) => ({\r\n              icon: ArrowDropDownIcon,\r\n              tooltip: t(\"components.dashboardsManager.table.actions.dashboardOrderMoveDown\"),\r\n              onClick: (_, {tableData}) => moveDown(tableData.id), // tableData.id is the rowIndex\r\n              disabled: tableData.id === dashboards.length - 1\r\n            }),\r\n            {\r\n              icon: DeleteIcon,\r\n              tooltip: t(\"components.dashboardsManager.table.actions.removeDashboard\"),\r\n              onClick: (_, {dashboardId}) => removeDashboard(dashboardId)\r\n            }\r\n          ]}\r\n          options={{\r\n            paging: false,\r\n            draggable: true,\r\n            actionsColumnIndex: 2,\r\n            searchFieldAlignment: \"left\",\r\n            maxBodyHeight: 320\r\n          }}\r\n          icons={tableIcons}\r\n        />\r\n      </Box>\r\n    </Fragment>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, null, null, {forwardRef: true}),\r\n  forwardRef\r\n)(DashboardsManager);","export const INIT = \"INIT\";\r\n\r\nexport const init = (baseURL: string, supportedLanguages: string[], defaultLanguage: string) => ({\r\n    type: INIT,\r\n    payload: {\r\n        baseURL,\r\n        supportedLanguages,\r\n        defaultLanguage\r\n    }\r\n});\r\n","import {INIT} from \"../../state/rootActions\";\r\nimport {REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {HUB_CONFIG_SEND} from \"../../state/hubConfig/hubConfigActions\";\r\n\r\nexport const PERSISTENCE_LOCAL_STORAGE_KEY = \"state\";\r\nexport const PERSISTENCE_ACTION_KEY = \"persistentState\";\r\n\r\nconst persistenceMiddleware = ({getState}) => next => action => {\r\n\r\n  // when init action is dispatched\r\n  if (action.type === INIT) {\r\n    if (!action.payload) {\r\n      action.payload = {};\r\n    }\r\n    // attach persistent state to the action\r\n    action.payload[PERSISTENCE_ACTION_KEY] = JSON.parse(localStorage.getItem(PERSISTENCE_LOCAL_STORAGE_KEY) || \"{}\");\r\n  }\r\n\r\n  const result = next(action);\r\n\r\n  const state = getState();\r\n\r\n  // any time an action is dispatched, update persistent state (localStorage is fast)\r\n  localStorage.setItem(\r\n    PERSISTENCE_LOCAL_STORAGE_KEY,\r\n    JSON.stringify({\r\n      user: {\r\n        ...state.user,\r\n        isSetPasswordDialogOpen: undefined\r\n      },\r\n      app: {\r\n        language:\r\n          action.type === REQUEST_SUCCESS &&\r\n          action.payload.label === HUB_CONFIG_SEND &&\r\n          !action.payload.data.supportedLanguages.includes(state.app.language)\r\n            ? action.payload.data.defaultLanguage\r\n            : state.app.language\r\n      }\r\n    })\r\n  );\r\n\r\n  return result;\r\n};\r\n\r\nexport default persistenceMiddleware;","import {UserPermissions, UserRoles, UserState} from '../state/user/userReducer';\r\n\r\ntype UserChecker = (user: UserState, nodeId?: number) => boolean;\r\ntype UserNodeChecker = (user: UserState, nodeId: number) => boolean;\r\n\r\nconst getPermissionStr = (permission: UserPermissions, nodeId: number) => `${permission}_SingleNode_${nodeId}`;\r\n\r\nexport const canDisplayAppSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canCreateNode: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canSortNodes: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayNodesSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageCache}_SingleNode`)) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageTemplate}_SingleNode`)) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageConfig}_SingleNode`))\r\n    );\r\n\r\nexport const canDisplayUsersSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayCacheSettingForm: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageCache, nodeId))\r\n    );\r\n\r\nexport const canDisplayTemplatesSettingsForm: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n    );\r\n\r\nexport const canSaveTemplate: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n    );\r\n\r\nexport const canEditNode: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n    );\r\n\r\nexport const canDisplayUserViews: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canShare: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canSaveAsView: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canClearServerCache: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canGetQueryLog: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayPermissionsSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canManagePersonalDashboards: UserChecker = user =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageConfig}_SingleNode`))\r\n    );\r\n\r\nexport const canManageAppDashboards: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canManageNodeDashboards: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n  );\r\n\r\nexport const canDeleteNodes: UserChecker = user =>\r\n  user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canViewTimesLog: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n  );\r\n\r\nexport const canViewTemplateOrAnnotationIcon: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n  );","import React, {useEffect, useState} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport {connect} from \"react-redux\";\r\nimport CountryLanguage from 'country-language';\r\n\r\nconst CUSTOM_LANG_TO_COUNTRY = {\r\n  en: \"gb\"\r\n};\r\n\r\nconst I18nInputAdornmentSelect = ({value, onChange, languages}) => {\r\n\r\n  const [langToCountry, setLangToCountry] = useState(null);\r\n\r\n  useEffect(() => {\r\n\r\n    let res = {};\r\n\r\n    languages.forEach(langCode =>\r\n      CountryLanguage.getLanguageCountries(langCode, (err, countries) => {\r\n        if (!err) {\r\n          res[langCode] =\r\n            CUSTOM_LANG_TO_COUNTRY[langCode] ||\r\n            countries.find(({code_2}) => code_2.toLowerCase() === langCode)?.code_2.toLowerCase() ||\r\n            countries[0].code_2.toLowerCase();\r\n        }\r\n      }));\r\n\r\n    setLangToCountry(res);\r\n\r\n  }, [languages]);\r\n\r\n  return langToCountry && (\r\n    <ButtonSelect value={<span className={`flag-icon flag-icon-${langToCountry[value]}`}/>}\r\n                  onChange={onChange}>\r\n      {languages.map(lang =>\r\n        <span key={lang} className={`flag-icon flag-icon-${langToCountry[lang]}`} data-value={lang}/>\r\n      )}\r\n    </ButtonSelect>\r\n  );\r\n};\r\n\r\nexport default connect(state => ({\r\n  languages: state.app.languages\r\n}))(I18nInputAdornmentSelect);","import React, {useState} from 'react';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst Component = ({\r\n                     textFieldProps,\r\n                     defaultLanguage,\r\n                     languages,\r\n                     children\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n\r\n  return (\r\n    <TextField\r\n      {...textFieldProps}\r\n      value={\r\n        textFieldProps.value && textFieldProps.value[language]\r\n          ? textFieldProps.value[language]\r\n          : \"\"\r\n      }\r\n      onChange={({target}) => {\r\n        const res = {};\r\n        languages.forEach(lang => {\r\n          if (textFieldProps.value[lang]) {\r\n            res[lang] = textFieldProps.value[lang];\r\n          }\r\n        });\r\n        res[language] = target.value;\r\n        textFieldProps.onChange(res);\r\n      }}\r\n      InputProps={{\r\n        startAdornment: (\r\n          <InputAdornment position=\"start\">\r\n            <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n          </InputAdornment>\r\n        )\r\n      }}\r\n    >\r\n      {textFieldProps.children}\r\n    </TextField>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nTextField = props =>\r\n  <ConnectedComponent textFieldProps={props}/>;\r\n\r\nexport default I18nTextField;","import React, {Fragment} from 'react';\r\nimport CKEditor from 'ckeditor4-react';\r\nimport './style.css'\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  preToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nclass HtmlEditor extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = HtmlEditor.getInitState(props);\r\n    this.handleEditorChange = this.handleEditorChange.bind(this);\r\n  }\r\n\r\n  static getInitState(props) {\r\n    return {\r\n      value: props ? (props.value || '') : ''\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromProps(props) {\r\n    if (props.value !== null && props.value !== undefined) {\r\n      return {\r\n        value: props.value\r\n      };\r\n\r\n    } else {\r\n      return HtmlEditor.getInitState(props);\r\n    }\r\n  }\r\n\r\n  handleEditorChange(event) {\r\n    const data = event.editor.getData();\r\n    if (this.props.onChange) {\r\n      this.props.onChange(data);\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      value\r\n    } = this.state;\r\n\r\n    const {\r\n      disabled,\r\n    } = this.props;\r\n\r\n    return (\r\n      <Fragment>\r\n        {/* <Grid container className={classes.preToolbar}>\r\n          <Grid item>\r\n            <I18nInputAdornmentSelect/>\r\n          </Grid>\r\n        </Grid>*/}\r\n        <CKEditor\r\n          data={value}\r\n          config={{\r\n            defaultLanguage: 'en',\r\n            language: 'en',\r\n            toolbar: [\r\n              {name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike']},\r\n              {name: 'format', items: ['RemoveFormat']},\r\n              {name: 'colors', items: ['TextColor', 'BGColor']},\r\n              {name: 'insert', items: ['Table']},\r\n              {name: 'links', items: ['Link', 'Unlink']},\r\n              {name: 'paragraph', items: ['NumberedList', 'BulletedList']},\r\n              {name: 'indent', items: ['Outdent', 'Indent']},\r\n              {\r\n                name: 'justify',\r\n                items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']\r\n              },\r\n              {name: 'clipboard', items: ['Cut', 'Copy', 'Paste']},\r\n              {name: 'history', items: ['Undo', 'Redo']}\r\n            ]\r\n          }}\r\n          readOnly={disabled ? disabled : false}\r\n          onChange={this.handleEditorChange}\r\n          onBeforeLoad={(CKEDITOR) => (CKEDITOR.disableAutoInline = true)} // needed to fix \"Error code: editor-element-conflict.\"\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(HtmlEditor);\r\n","import React, {Fragment, useState} from 'react';\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport HtmlEditor from \"../html-editor\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nconst Component = ({\r\n                     htmlEditorProps,\r\n                     defaultLanguage,\r\n                     languages\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid container justify=\"flex-end\" style={{marginBottom: 4}}>\r\n        <Grid item>\r\n          <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n        </Grid>\r\n      </Grid>\r\n      <HtmlEditor\r\n        {...htmlEditorProps}\r\n        value={\r\n          htmlEditorProps.value && htmlEditorProps.value[language]\r\n            ? htmlEditorProps.value[language]\r\n            : \"\"\r\n        }\r\n        onChange={val => {\r\n          const res = {};\r\n          languages.forEach(lang => {\r\n            if (htmlEditorProps.value && htmlEditorProps.value[lang]) {\r\n              res[lang] = htmlEditorProps.value[lang];\r\n            }\r\n          });\r\n          res[language] = val;\r\n          htmlEditorProps.onChange(res);\r\n        }}\r\n\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nHtmlEditor = props =>\r\n  <ConnectedComponent htmlEditorProps={props}/>;\r\n\r\nexport default I18nHtmlEditor;","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {\r\n  addHubConfigDashboardsDashboard,\r\n  clearAllHubConfigDashboards,\r\n  clearHubConfig,\r\n  clearHubConfigDashboards,\r\n  closeHubConfig,\r\n  fetchAllHubConfigDashboards,\r\n  fetchHubConfig,\r\n  fetchHubConfigDashboards,\r\n  removeHubConfigDashboardsDashboard,\r\n  sendHubConfig,\r\n  sendHubConfigDashboardsOrders\r\n} from \"../../../state/hubConfig/hubConfigActions\";\r\nimport {connect} from \"react-redux\";\r\nimport FileInput from \"../../file-input\";\r\nimport DashboardsManager from \"../../dashboards-manager\";\r\nimport {canManageAppDashboards} from \"../../../utils/user\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nTextField from \"../../i18n-text-field\";\r\nimport {validateI18nObj} from \"../../../utils/i18n\";\r\nimport I18nHtmlEditor from \"../../i18n-html-editor\";\r\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  disclaimerLabel: {\r\n    fontSize: \"1rem\",\r\n    marginTop: theme.spacing(3)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.hubConfig.hub,\r\n  user: state.user,\r\n  dashboards: state.hubConfig.hubDashboards,\r\n  allDashboards: state.hubConfig.allDashboards\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  clearConfig: () => dispatch(clearHubConfig()),\r\n  fetchConfig: () => dispatch(fetchHubConfig()),\r\n  sendConfig: config => dispatch(sendHubConfig(config)),\r\n  fetchDashboards: () => dispatch(fetchHubConfigDashboards()),\r\n  fetchAllDashboards: () => dispatch(fetchAllHubConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearHubConfigDashboards()),\r\n  clearAllDashboards: () => dispatch(clearAllHubConfigDashboards()),\r\n  addDashboard: dashboardId => dispatch(addHubConfigDashboardsDashboard(dashboardId)),\r\n  removeDashboard: dashboardId => dispatch(removeHubConfigDashboardsDashboard(dashboardId)),\r\n  sendDashboardsOrders: orderedDashboarIds => dispatch(sendHubConfigDashboardsOrders(orderedDashboarIds)),\r\n  onClose: () => dispatch(closeHubConfig())\r\n});\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({\r\n                                                        classes,\r\n                                                        config,\r\n                                                        onSubmit,\r\n                                                        onCancel,\r\n                                                        user,\r\n                                                        dashboards,\r\n                                                        allDashboards,\r\n                                                        fetchDashboards,\r\n                                                        fetchAllDashboards,\r\n                                                        clearDashboards,\r\n                                                        clearAllDashboards,\r\n                                                        addDashboard,\r\n                                                        removeDashboard,\r\n                                                        sendDashboardsOrders\r\n                                                      }, ref) => {\r\n\r\n  const [tab, setTab] = useState(\"general\");\r\n  const dashboardsManagerRef = React.createRef();\r\n  const {t} = useTranslation();\r\n\r\n  const configExtras = config.extras ? JSON.parse(config.extras) : {};\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      ...config,\r\n      pageSize: configExtras.PageSize\r\n    }\r\n  });\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          pageSize: undefined\r\n        };\r\n\r\n        data.extras = JSON.stringify({\r\n          ...JSON.parse(data.extras || \"{}\"),\r\n          PageSize: val.pageSize\r\n        });\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n        if (dashboardsManagerRef.current) {\r\n          dashboardsManagerRef.current.destroy();\r\n        }\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n      if (dashboardsManagerRef.current) {\r\n        dashboardsManagerRef.current.destroy();\r\n      }\r\n    }\r\n  }));\r\n\r\n  /* custom register */\r\n  useEffect(() => {\r\n    register({\r\n      name: 'title'\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({name: 'slogan'});\r\n    register({\r\n      name: 'supportedLanguages'\r\n    }, {\r\n      validate: val => val.length > 0 || t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: 'defaultLanguage'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: 'maxObservationsAfterCriteria'\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      min: {\r\n        value: 1,\r\n        message: t(\"commons.validation.positiveInteger\")\r\n      }\r\n    })\r\n    register({\r\n      name: \"maxCells\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      min: {\r\n        value: 1,\r\n        message: t(\"commons.validation.positiveInteger\")\r\n      }\r\n    })\r\n    register({name: 'backgroundMediaURL'});\r\n    register({name: 'logoURL'});\r\n    register({name: 'description'});\r\n    register({\r\n      name: 'pageSize'\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: \"disclaimer\"\r\n    });\r\n  }, [register, t]);\r\n\r\n  const defaultLanguage = watch('defaultLanguage');\r\n  const supportedLanguages = watch('supportedLanguages');\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <Tabs\r\n        value={tab}\r\n        onChange={(_, tab) => {\r\n          setTab(tab)\r\n        }}\r\n      >\r\n        <Tab value=\"general\" label={t(\"scenes.appSettings.tabs.general\")}/>\r\n        <Tab value=\"infos\" label={t(\"scenes.appSettings.tabs.information\")}/>\r\n        <Tab value=\"users\" label={t(\"scenes.appSettings.tabs.users\")}/>\r\n        {canManageAppDashboards(user) && (<Tab value=\"dashboards\" label={t(\"scenes.appSettings.tabs.dashboards\")}/>)}\r\n      </Tabs>\r\n      <div className={classes.tabContent}>\r\n        {tab === \"general\" && (\r\n          <Fragment>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"title\"\r\n                label={t(\"scenes.appSettings.fields.title.label\")}\r\n                required\r\n                error={!!errors.title}\r\n                helperText={errors.title?.message}\r\n                variant=\"outlined\"\r\n                value={watch('title') || {}}\r\n                onChange={value => setValue('title', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"slogan\"\r\n                label={t(\"scenes.appSettings.fields.slogan.label\")}\r\n                variant=\"outlined\"\r\n                value={watch('slogan') || {}}\r\n                onChange={value => setValue('slogan', value)}\r\n              />\r\n            </FormControl>\r\n            <Autocomplete\r\n              multiple\r\n              variant=\"outlined\"\r\n              freeSolo\r\n              options={[]}\r\n              value={supportedLanguages || []}\r\n              renderTags={(value, getTagProps) =>\r\n                value.map((option, index) => (\r\n                  <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n                ))\r\n              }\r\n              required\r\n              onChange={(e, val) => {\r\n                setValue('supportedLanguages', val);\r\n                if (defaultLanguage && !val.includes(defaultLanguage)) {\r\n                  setValue('defaultLanguage', \"\");\r\n                }\r\n              }}\r\n              renderInput={params => (\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    label={t(\"scenes.appSettings.fields.supportedLanguages.label\")}\r\n                    {...params}\r\n                    variant=\"outlined\"\r\n                    placeholder={t(\"scenes.appSettings.fields.supportedLanguages.placeholder\")}\r\n                    error={!!errors.supportedLanguages}\r\n                    helperText={\r\n                      errors.supportedLanguages?.message || (\r\n                        <Fragment>\r\n                          {t(\"scenes.appSettings.fields.supportedLanguages.helper.text\")}\r\n                          <a\r\n                            href=\"https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes\"\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            style={{marginLeft: 4}}\r\n                          >\r\n                            {t(\"scenes.appSettings.fields.supportedLanguages.helper.linkText\")}\r\n                          </a>\r\n                        </Fragment>\r\n                      )}\r\n                  />\r\n                </FormControl>\r\n              )}\r\n            />\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"defaultLanguage\"\r\n                select\r\n                required\r\n                label={t(\"scenes.nodeSettings.fields.defaultLanguage.label\")}\r\n                onChange={e => setValue('defaultLanguage', e.target.value)}\r\n                value={watch(\"defaultLanguage\") || ''}\r\n                error={!!errors.defaultLanguage}\r\n                helperText={errors.defaultLanguage?.message || t(\"scenes.nodeSettings.fields.defaultLanguage.helper\")}\r\n                variant=\"outlined\"\r\n              >\r\n                {supportedLanguages.map((val, index) =>\r\n                  <MenuItem key={index} value={val}>{val}</MenuItem>\r\n                )}\r\n              </TextField>\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"maxObservationsAfterCriteria\"\r\n                label={t(\"scenes.appSettings.fields.maxObservationsAfterCriteria.label\")}\r\n                required\r\n                type=\"number\"\r\n                error={!!errors.maxObservationsAfterCriteria}\r\n                helperText={errors.maxObservationsAfterCriteria?.message}\r\n                variant=\"outlined\"\r\n                value={watch('maxObservationsAfterCriteria') || ''}\r\n                onChange={({target}) => setValue('maxObservationsAfterCriteria', target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"maxCells\"\r\n                label={t(\"scenes.appSettings.fields.maxCells.label\")}\r\n                required\r\n                error={!!errors.maxCells}\r\n                helperText={errors.maxCells?.message}\r\n                variant=\"outlined\"\r\n                type=\"number\"\r\n                value={watch('maxCells') || ''}\r\n                onChange={({target}) => setValue('maxCells', target.value)}\r\n              />\r\n            </FormControl>\r\n            {/*<FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"pageSize\"\r\n                label={t(\"scenes.appSettings.fields.pageSize.label\")}\r\n                variant=\"outlined\"\r\n                type=\"number\"\r\n                error={!!errors.pageSize}\r\n                helperText={errors.pageSize?.message}\r\n                value={watch('pageSize') || ''}\r\n                onChange={({target}) => setValue('pageSize', Number(target.value))}\r\n              />\r\n            </FormControl>*/}\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.appSettings.fields.backgroundMediaURL.label\")}\r\n                value={watch('backgroundMediaURL')}\r\n                onChange={value => setValue('backgroundMediaURL', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.appSettings.fields.logoURL.label\")}\r\n                value={watch('logoURL')}\r\n                onChange={value => setValue('logoURL', value)}\r\n              />\r\n            </FormControl>\r\n          </Fragment>\r\n        )}\r\n        {tab === \"infos\" && (\r\n          <I18nHtmlEditor\r\n            value={watch('description')}\r\n            onChange={val => setValue('description', val)}\r\n          />\r\n        )}\r\n        {tab === \"users\" && (\r\n          <Fragment>\r\n            {/* <Autocomplete\r\n              multiple\r\n              variant=\"outlined\"\r\n              freeSolo\r\n              options={[]}\r\n              value={watch('userTypes') || []}\r\n              renderTags={(value, getTagProps) =>\r\n                value.map((option, index) => (\r\n                  <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n                ))\r\n              }\r\n              required\r\n              onChange={(e, val) => setValue('userTypes', val)}\r\n              renderInput={params => (\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    label={t(\"scenes.appSettings.fields.userTypes.label\")}\r\n                    {...params}\r\n                    variant=\"outlined\"\r\n                    placeholder={t(\"scenes.appSettings.fields.userTypes.placeholder\")}\r\n                    error={!!errors.userTypes}\r\n                    helperText={errors.userTypes?.message}\r\n                  />\r\n                </FormControl>\r\n              )}\r\n            />*/}\r\n            <div className={classes.disclaimerLabel}>\r\n              {t(\"scenes.appSettings.fields.disclaimer.label\")}:\r\n            </div>\r\n            <I18nHtmlEditor\r\n              value={watch('disclaimer')}\r\n              onChange={val => setValue('disclaimer', val)}\r\n            />\r\n          </Fragment>\r\n        )}\r\n        {canManageAppDashboards(user) && tab === \"dashboards\" && (\r\n          <DashboardsManager\r\n            dashboards={dashboards}\r\n            allDashboards={allDashboards}\r\n            fetchDashboards={fetchDashboards}\r\n            fetchAllDashboards={fetchAllDashboards}\r\n            clearDashboards={clearDashboards}\r\n            clearAllDashboards={clearAllDashboards}\r\n            addDashboard={addDashboard}\r\n            removeDashboard={removeDashboard}\r\n            sendDashboardsOrders={sendDashboardsOrders}\r\n            ref={dashboardsManagerRef}\r\n          />\r\n        )}\r\n      </div>\r\n    </Box>\r\n  );\r\n});\r\n\r\nconst AppSettingsForm = ({\r\n                           config,\r\n                           fetchConfig,\r\n                           sendConfig,\r\n                           clearConfig,\r\n                           user,\r\n                           dashboards,\r\n                           allDashboards,\r\n                           fetchDashboards,\r\n                           fetchAllDashboards,\r\n                           clearDashboards,\r\n                           clearAllDashboards,\r\n                           addDashboard,\r\n                           removeDashboard,\r\n                           sendDashboardsOrders,\r\n                           onClose\r\n                         }, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  return (config &&\r\n    <Form\r\n      config={config}\r\n      ref={ref}\r\n      onSubmit={sendConfig}\r\n      onCancel={() => {\r\n        clearConfig();\r\n        onClose();\r\n      }}\r\n      user={user}\r\n      dashboards={dashboards}\r\n      allDashboards={allDashboards}\r\n      fetchDashboards={fetchDashboards}\r\n      fetchAllDashboards={fetchAllDashboards}\r\n      clearDashboards={clearDashboards}\r\n      clearAllDashboards={clearAllDashboards}\r\n      addDashboard={addDashboard}\r\n      removeDashboard={removeDashboard}\r\n      sendDashboardsOrders={sendDashboardsOrders}\r\n    />);\r\n\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(AppSettingsForm);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getAddNodeDashboardUrl,\r\n    getNodeConfigGetUrl,\r\n    getNodeDashboardsUrl,\r\n    getNodeDeleteUrl,\r\n    getNodesConfigPostUrl,\r\n    getNodesConfigPutUrl,\r\n    getNodesConfigUrl,\r\n    getNodesOrderPutUrl,\r\n    getOrderNodeDashboardsUrl,\r\n    getRemoveNodeDashboardUrl,\r\n    getUserDashboardsUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const NODES_CONFIG_NODES_FETCH = \"nodesConfig/fetchNodes\";\r\nexport const NODES_CONFIG_NODES_CLEAR = \"nodesConfig/clearNodes\";\r\nexport const NODES_CONFIG_NODE_FETCH = \"nodesConfig/fetchNode\";\r\nexport const NODES_CONFIG_NODE_CLEAR = \"nodesConfig/clearNode\";\r\nexport const NODES_CONFIG_NODES_ORDER_SEND = \"nodesConfig/sendNodesOrder\";\r\nexport const NODES_CONFIG_NODE_DELETE = \"nodesConfig/deleteNode\";\r\nexport const NODES_CONFIG_NODE_CREATE = \"nodesConfig/createNode\";\r\nexport const NODES_CONFIG_NODE_EDIT = \"nodesConfig/editNode\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_FETCH = \"nodesConfig/nodeDashboards/fetch\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL = \"nodesConfig/nodeDashboards/fetchAll\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD = \"nodesConfig/nodeDashboards/addDashboard\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE = \"nodesConfig/nodeDashboards/removeDashboard\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND = \"nodesConfig/nodeDashboards/sendOrders\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_CLEAR = \"nodesConfig/nodeDashboards/clear\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL = \"nodesConfig/nodeDashboards/clearAll\";\r\nexport const NODES_CONFIG_CLOSE = \"nodesConfig/close\";\r\n\r\nexport const fetchNodesConfigNodes = () => initRequest(\r\n    NODES_CONFIG_NODES_FETCH,\r\n    getNodesConfigUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchNodes.start\")\r\n    })\r\n);\r\n\r\nexport const clearNodesConfigNodes = () => ({\r\n  type: NODES_CONFIG_NODES_CLEAR\r\n});\r\n\r\nexport const sendNodesConfigNodesOrder = (orderedIds: number[]) => initRequest(\r\n  NODES_CONFIG_NODES_ORDER_SEND,\r\n  getNodesOrderPutUrl(),\r\n  RequestMethod.PUT,\r\n  orderedIds,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.sendNodesOrder.start\")\r\n  })\r\n);\r\n\r\nexport const deleteNodesConfigNode = (nodeId: number) => initRequest(\r\n  NODES_CONFIG_NODE_DELETE,\r\n  getNodeDeleteUrl(nodeId),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.deleteNode.start\")\r\n  }),\r\n  {\r\n      nodeId,\r\n      onForce: () => initRequest(\r\n          NODES_CONFIG_NODE_DELETE,\r\n          getNodeDeleteUrl(nodeId, true),\r\n          RequestMethod.DELETE,\r\n          undefined,\r\n          t => ({\r\n              onStart: t(\"scenes.nodesSettings.messages.deleteNode.start\")\r\n          }),\r\n          {\r\n              nodeId\r\n          }\r\n      )\r\n  }\r\n);\r\n\r\nexport const fetchNodesConfigNode = (nodeId: number) => initRequest(\r\n  NODES_CONFIG_NODE_FETCH,\r\n  getNodeConfigGetUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.fetchNode.start\")\r\n  })\r\n);\r\n\r\nexport const clearNodesConfigNode = () => ({\r\n  type: NODES_CONFIG_NODE_CLEAR\r\n});\r\n\r\nexport const sendNodesConfigNodeCreate = (node: any) => initRequest(\r\n  NODES_CONFIG_NODE_CREATE,\r\n  getNodesConfigPostUrl(),\r\n  RequestMethod.POST,\r\n  node,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.sendNodeCreate.start\")\r\n  })\r\n);\r\n\r\nexport const sendNodesConfigNodeEdit = (node: any) => initRequest(\r\n    NODES_CONFIG_NODE_EDIT,\r\n    getNodesConfigPutUrl(node.nodeId),\r\n    RequestMethod.PUT,\r\n    node,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.sendNodeEdit.start\")\r\n    }),\r\n    {\r\n        nodeId: node.nodeId\r\n    }\r\n);\r\n\r\nexport const fetchNodesConfigNodeDashboards = (nodeId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_FETCH,\r\n    getNodeDashboardsUrl(nodeId),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchNodeDashboards.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const fetchAllNodeConfigDashboards = () => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL,\r\n    getUserDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchAllDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const addNodesConfigDashboardsNodeDashboard = (nodeId: number, dashboardId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n    getAddNodeDashboardUrl(nodeId, dashboardId),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.addNodeDashboard.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const removeNodesConfigDashboardsNodeDashboard = (nodeId: number, dashboardId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n    getRemoveNodeDashboardUrl(nodeId, dashboardId),\r\n    RequestMethod.DELETE,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.removeNodeDashboard.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const sendNodesConfigDashboardsNodeOrders = (nodeId: number, orderedDashboardsIds: number[]) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n    getOrderNodeDashboardsUrl(nodeId),\r\n    RequestMethod.POST,\r\n    orderedDashboardsIds,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.sendNodeDashboardsOrders.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n)\r\n\r\nexport const clearNodesConfigNodeDashboards = () => ({\r\n    type: NODES_CONFIG_NODE_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const clearAllNodesConfigNodeDashboards = () => ({\r\n    type: NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL\r\n});\r\n\r\nexport const closeNodesConfig = () => ({\r\n    type: NODES_CONFIG_CLOSE\r\n});","export const getCriteriaRequestObject = (criteria) => {\r\n  const res = [];\r\n\r\n  Object.keys(criteria).forEach(key => {\r\n    if (criteria[key] && criteria[key].length > 0) {\r\n      res.push({\r\n        id: key,\r\n        filterValues: criteria[key]\r\n      })\r\n    }\r\n  });\r\n\r\n  return res;\r\n};","import React from \"react\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\n\r\nconst InfoTooltip = ({children}) => {\r\n\r\n  return children\r\n    ? (\r\n      <Tooltip title={children} placement=\"top\">\r\n        <IconButton\r\n          aria-label=\"info\"\r\n          style={{\r\n            color: \"#00295A\",\r\n            padding: 0,\r\n            transform: \"translateY(-1px)\"\r\n          }}\r\n        >\r\n          <InfoIcon fontSize=\"small\"/>\r\n        </IconButton>\r\n      </Tooltip>\r\n    )\r\n    : (\r\n      <IconButton\r\n        aria-label=\"info\"\r\n        style={{\r\n          color: \"#00295A\",\r\n          padding: 0,\r\n          transform: \"translateY(-1px)\"\r\n        }}\r\n      >\r\n        <InfoIcon fontSize=\"small\"/>\r\n      </IconButton>\r\n    );\r\n};\r\n\r\nexport default InfoTooltip;","import React, {Fragment} from 'react';\r\nimport InfoTooltip from \"../info-tooltip\";\r\n\r\nconst FormLabelWithTooltip = ({children, tooltip, tooltipOnRight}) => {\r\n\r\n  const Tooltip = () =>\r\n    <span\r\n      style={{\r\n        pointerEvents: \"auto\",\r\n        marginLeft: tooltipOnRight ? 10 : null,\r\n        marginRight: !tooltipOnRight ? 10 : null,\r\n      }}\r\n    >\r\n        <InfoTooltip>\r\n          {tooltip}\r\n        </InfoTooltip>\r\n     </span>;\r\n\r\n  return (\r\n    <Fragment>\r\n      {!tooltipOnRight && <Tooltip/>}\r\n      <span style={{pointerEvents: \"none\"}}>\r\n        {children}\r\n      </span>\r\n      {tooltipOnRight && <Tooltip/>}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default FormLabelWithTooltip;","export const downloadFormats = t => ({\r\n  genericdata: {\r\n    label: t ? t(\"commons.downloadFormat.genericdata\") : \"genericdata\",\r\n    extension: \"xml\"\r\n  },\r\n  genericdata20: {\r\n    label: t ? t(\"commons.downloadFormat.genericdata20\") : \"genericdata20\",\r\n    extension: \"xml\"\r\n  },\r\n  compactdata: {\r\n    label: t ? t(\"commons.downloadFormat.compactdata\") : \"compactdata\",\r\n    extension: \"xml\"\r\n  },\r\n  structurespecificdata: {\r\n    label: t ? t(\"commons.downloadFormat.structurespecificdata\") : \"structurespecificdata\",\r\n    extension: \"xml\"\r\n  },\r\n  jsondata: {\r\n    label: t ? t(\"commons.downloadFormat.jsondata\") : \"jsondata\",\r\n    extension: \"json\"\r\n  },\r\n  csv: {\r\n    label: t ? t(\"commons.downloadFormat.csv\") : \"csv\",\r\n    extension: \"csv\"\r\n  }\r\n});\r\n\r\nexport const isDownloadFormatValid = format => downloadFormats()?.[format] !== undefined\r\n\r\nexport const getDownloadFormatLabels = t => {\r\n  const labels = [];\r\n\r\n  for (let format in downloadFormats) {\r\n    if (downloadFormats.hasOwnProperty(format)) {\r\n      labels.push(downloadFormats(t)[format].label);\r\n    }\r\n  }\r\n\r\n  return labels;\r\n};\r\n\r\nexport const getDownloadFormatLabelFromFormat = (format, t) => downloadFormats(t)[format]?.label;\r\n\r\nexport const getDownloadFormatExtensionFromFormat = (format, t) => downloadFormats(t)[format]?.extension;\r\n\r\nexport const exportChartJpeg = (canvasId, fileName) => {\r\n  const canvas = document.getElementById(canvasId);\r\n\r\n  const link = document.createElement(\"a\");\r\n  link.download = fileName;\r\n  link.target = \"_blank\";\r\n  link.href = canvas.toDataURL(\"image/jpeg\");\r\n\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport {useForm} from 'react-hook-form'\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport {compose} from \"redux\";\r\nimport validator from \"validator\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearNodesConfigNode,\r\n  fetchNodesConfigNode,\r\n  sendNodesConfigNodeCreate,\r\n  sendNodesConfigNodeEdit\r\n} from \"../../../../state/nodesConfig/nodesConfigActions\";\r\nimport {\r\n  ALL_FULL,\r\n  ALL_PARTIAL,\r\n  STEP_BY_STEP_DYNAMIC,\r\n  STEP_BY_STEP_FULL,\r\n  STEP_BY_STEP_PARTIAL\r\n} from \"../../../../state/dataset/datasetActions\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport FileInput from \"../../../file-input\";\r\nimport FormLabelWithTooltip from \"../../../form-label-with-tooltip\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nTextField from \"../../../i18n-text-field\";\r\nimport {validateI18nObj} from \"../../../../utils/i18n\";\r\nimport I18nHtmlEditor from \"../../../i18n-html-editor\";\r\nimport {downloadFormats} from \"../../../../utils/download\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit, onCancel}, ref) => {\r\n\r\n  const [tab, setTab] = useState(\"general\");\r\n  const [mustChangeTabOnErrors, setMustChangeTabOnErrors] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      active: false,\r\n      ...config,\r\n      annotationConfig:\r\n        config?.extras?.find(({key}) => key === \"AnnotationConfig\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"AnnotationConfig\").value)\r\n          : {\r\n            \"ORDER\": \"ORDER\",\r\n            \"ORDER_CATEGORY\": \"ORDER\",\r\n            \"ORDER_CODELIST\": \"ORDER\",\r\n            \"NOT_DISPLAYED\": \"NOT_DISPLAYED\",\r\n            \"DEFAULT\": \"DEFAULT\",\r\n            \"LAYOUT_ROW\": \"LAYOUT_ROW\",\r\n            \"LAYOUT_COLUMN\": \"LAYOUT_COLUMN\",\r\n            \"LAYOUT_FILTER\": \"LAYOUT_FILTER\",\r\n            \"LAYOUT_ROW_SECTION\": \"LAYOUT_ROW_SECTION\",\r\n            \"CRITERIA_SELECTION\": \"CRITERIA_SELECTION\",\r\n            \"ATTACHED_DATA_FILES\": \"ATTACHED_DATA_FILES\",\r\n            \"LAYOUT_DECIMAL_SEPARATOR\": \"LAYOUT_DECIMAL_SEPARATOR\",\r\n            \"LAYOUT_NUMBER_OF_DECIMALS\": \"LAYOUT_NUMBER_OF_DECIMALS\",\r\n            \"LAYOUT_EMPTY_CELL_PLACEHOLDER\": \"LAYOUT_EMPTY_CELL_PLACEHOLDER\",\r\n            \"DATAFLOW_NOTES\": \"DATAFLOW_NOTES\",\r\n            \"DATAFLOW_SOURCE\": \"DATAFLOW_SOURCE\",\r\n            \"METADATA_URL\": \"METADATA_URL\",\r\n            \"KEYWORDS\": \"KEYWORDS\",\r\n            \"DEFAULT_VIEW\": \"DEFAULT_VIEW\",\r\n            \"GEO_ID\": \"GEO_ID\",\r\n            \"LAST_UPDATE\": \"LAST_UPDATE\",\r\n            \"VIRTUAL_DATAFLOW_NODE\": \"VIRTUAL_DATAFLOW_NODE\",\r\n          },\r\n      showCategoryLevels: config?.showCategoryLevels || 1,\r\n      decimalNumber: config?.decimalNumber || 1,\r\n      decimalSeparator: config?.decimalSeparator || {en: \",\"},\r\n      catalogNavigationMode: config?.catalogNavigationMode || \"List\",\r\n      hiddenAttributes:\r\n        config?.extras?.find(({key}) => key === \"HiddenAttributes\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"HiddenAttributes\").value)\r\n          : [],\r\n      pageSize:\r\n        config?.extras?.find(({key}) => key === \"PageSize\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"PageSize\").value)\r\n          : \"\",\r\n      restDataResponseXml:\r\n        config?.extras?.find(({key}) => key === \"RestDataResponseXml\") && (\r\n          config.extras.find(({key}) => key === \"RestDataResponseXml\").value === \"false\" ||\r\n          config.extras.find(({key}) => key === \"RestDataResponseXml\").value === \"true\"\r\n        )\r\n          ? config.extras.find(({key}) => key === \"RestDataResponseXml\").value\r\n          : \"\",\r\n      downloadFormats:\r\n        config?.extras?.find(({key}) => key === \"DownloadFormats\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"DownloadFormats\").value)\r\n          : [],\r\n      supportPostFilters:\r\n        config?.extras?.find(({key}) => key === \"SupportPostFilters\") && (\r\n          config.extras.find(({key}) => key === \"SupportPostFilters\").value === \"false\" ||\r\n          config.extras.find(({key}) => key === \"SupportPostFilters\").value === \"true\"\r\n        )\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"SupportPostFilters\").value)\r\n          : false\r\n    }\r\n  });\r\n\r\n  const enableHttpAuth = watch(\"enableHttpAuth\");\r\n  const enableProxy = watch(\"enableProxy\");\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      setMustChangeTabOnErrors(true);\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          type: \"SDMX-REST\",\r\n          annotationConfig: undefined,\r\n          restDataResponseXml: undefined,\r\n          optimizeCallWithSoap: undefined,\r\n          namespaceV20: undefined,\r\n          namespaceV21: undefined,\r\n          hiddenAttributes: undefined,\r\n          pageSize: undefined,\r\n          downloadFormats: undefined\r\n        };\r\n\r\n        if (data.extras?.find(({key}) => key === \"AnnotationConfig\")) {\r\n          data.extras.find(({key}) => key === \"AnnotationConfig\").value = JSON.stringify(val.annotationConfig)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"AnnotationConfig\",\r\n            value: JSON.stringify(val.annotationConfig),\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"RestDataResponseXml\")) {\r\n          data.extras.find(({key}) => key === \"RestDataResponseXml\").value = val.restDataResponseXml\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"RestDataResponseXml\",\r\n            value: val.restDataResponseXml,\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"SupportPostFilters\")) {\r\n          data.extras.find(({key}) => key === \"SupportPostFilters\").value = JSON.stringify(val.supportPostFilters)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"SupportPostFilters\",\r\n            value: JSON.stringify(val.supportPostFilters),\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"HiddenAttributes\")) {\r\n          data.extras.find(({key}) => key === \"HiddenAttributes\").value = JSON.stringify(val.hiddenAttributes)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"HiddenAttributes\",\r\n            value: JSON.stringify(val.hiddenAttributes),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"PageSize\")) {\r\n          data.extras.find(({key}) => key === \"PageSize\").value = JSON.stringify(val.pageSize)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"PageSize\",\r\n            value: JSON.stringify(val.pageSize),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"DownloadFormats\")) {\r\n          data.extras.find(({key}) => key === \"DownloadFormats\").value = JSON.stringify(val.downloadFormats)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"DownloadFormats\",\r\n            value: JSON.stringify(val.downloadFormats),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  /* custom register */\r\n  useEffect(() => {\r\n\r\n    register({\r\n      name: \"code\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n    });\r\n    register({\r\n      name: \"title\"\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({\r\n      name: \"agency\"\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    })\r\n    register({name: 'active'});\r\n    register({name: \"slogan\"});\r\n    register({name: 'backgroundMediaURL'});\r\n    register({name: 'logo'});\r\n    register({name: 'description'});\r\n    register({\r\n      name: 'criteriaSelectionMode'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"endPoint\"\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"supportPostFilters\"\r\n    });\r\n    register({name: 'enableHttpAuth'});\r\n    register({name: 'enableProxy'});\r\n    register({name: 'annotationConfig.ORDER'});\r\n    register({name: 'annotationConfig.ORDER_CATEGORY'});\r\n    register({name: 'annotationConfig.ORDER_CODELIST'});\r\n    register({name: 'annotationConfig.NOT_DISPLAYED'});\r\n    register({name: 'annotationConfig.DEFAULT'});\r\n    register({name: 'annotationConfig.LAYOUT_ROW'});\r\n    register({name: 'annotationConfig.LAYOUT_COLUMN'});\r\n    register({name: 'annotationConfig.LAYOUT_FILTER'});\r\n    register({name: 'annotationConfig.LAYOUT_ROW_SECTION'});\r\n    register({name: 'annotationConfig.CRITERIA_SELECTION'});\r\n    register({name: 'annotationConfig.ATTACHED_DATA_FILES'});\r\n    register({name: 'annotationConfig.LAYOUT_DECIMAL_SEPARATOR'});\r\n    register({name: 'annotationConfig.LAYOUT_NUMBER_OF_DECIMALS'});\r\n    register({name: 'annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER'});\r\n    register({name: 'annotationConfig.DATAFLOW_NOTES'});\r\n    register({name: 'annotationConfig.DATAFLOW_SOURCE'});\r\n    register({name: 'annotationConfig.METADATA_URL'});\r\n    register({name: 'annotationConfig.KEYWORDS'});\r\n    register({name: 'annotationConfig.DEFAULT_VIEW'});\r\n    register({name: 'annotationConfig.GEO_ID'});\r\n    register({name: 'annotationConfig.LAST_UPDATE'});\r\n    register({name: 'annotationConfig.VIRTUAL_DATAFLOW_NODE'});\r\n    register({\r\n      name: \"ttlCatalog\"\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: \"ttlDataflow\"\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({name: 'showDataflowUncategorized'});\r\n    register({\r\n      name: 'showCategoryLevels'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"decimalNumber\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: 'decimalSeparator'\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({name: 'labelDimensionTerritorials'});\r\n    register({name: 'labelDimensionTemporals'});\r\n    register({name: 'categorySchemaExcludes'});\r\n    register({\r\n      name: 'catalogNavigationMode'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({name: 'hiddenAttributes'});\r\n    register({\r\n      name: 'pageSize'\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: 'restDataResponseXml'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({name: 'downloadFormats'});\r\n  }, [register, t]);\r\n\r\n  /* register enableHttpAuth fieldset */\r\n  useEffect(() => {\r\n\r\n    if (enableHttpAuth) {\r\n      register({\r\n        name: \"authHttpUsername\"\r\n      }, {\r\n        required: t(\"commons.validation.required\")\r\n      });\r\n      register({\r\n        name: \"authHttpPassword\"\r\n      });\r\n      register({\r\n        name: \"authHttpDomain\"\r\n      });\r\n    }\r\n\r\n  }, [register, enableHttpAuth, t]);\r\n\r\n  /* register enableProxy fieldset */\r\n  useEffect(() => {\r\n\r\n    if (enableProxy) {\r\n      register({\r\n        name: \"proxyAddress\"\r\n      }, {\r\n        required: t(\"commons.validation.required\")\r\n      });\r\n      register({\r\n        name: \"proxyPort\"\r\n      }, {\r\n        required: t(\"commons.validation.required\"),\r\n        validate: val => validator.isPort(val) || t(\"scenes.nodeSettings.fields.proxyPort.validation\")\r\n      });\r\n      register({name: \"proxyUsername\"});\r\n      register({name: \"proxyPassword\"});\r\n    }\r\n  }, [register, enableProxy, t]);\r\n\r\n  /* switch to first tab with errors */\r\n  if (Object.keys(errors).length > 0 && mustChangeTabOnErrors) {\r\n\r\n    setMustChangeTabOnErrors(false);\r\n\r\n    const firstFieldWithErrors = Object.keys(errors)[0];\r\n    if (firstFieldWithErrors === \"code\" || firstFieldWithErrors === \"agency\" || firstFieldWithErrors === \"title\" || firstFieldWithErrors === \"slogan\") {\r\n      if (tab !== \"general\") {\r\n        setTab(\"general\")\r\n      }\r\n    } else if (\r\n      firstFieldWithErrors === \"showCategoryLevels\" ||\r\n      firstFieldWithErrors === \"decimalNumber\" ||\r\n      firstFieldWithErrors === \"decimalSeparator\" ||\r\n      firstFieldWithErrors === \"labelDimensionTerritorials\" ||\r\n      firstFieldWithErrors === \"labelDimensionTemporals\" ||\r\n      firstFieldWithErrors === \"categorySchemaExcludes\" ||\r\n      firstFieldWithErrors === \"catalogNavigationMode\" ||\r\n      firstFieldWithErrors === \"hiddenAttributes\" ||\r\n      firstFieldWithErrors === \"pageSize\" ||\r\n      firstFieldWithErrors === \"downloadFormats\"\r\n    ) {\r\n\r\n      if (tab !== \"view\") {\r\n        setTab(\"view\")\r\n      }\r\n\r\n    } else if (firstFieldWithErrors) {\r\n\r\n      if (tab !== \"endpoint\") {\r\n        setTab(\"endpoint\");\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <Tabs\r\n        value={tab}\r\n        onChange={(_, tab) => setTab(tab)}\r\n      >\r\n        <Tab value=\"general\" label={t(\"scenes.nodeSettings.tabs.general.label\")}/>\r\n        <Tab value=\"infos\" label={t(\"scenes.nodeSettings.tabs.information.label\")}/>\r\n        <Tab value=\"endpoint\" label={t(\"scenes.nodeSettings.tabs.endpoint.label\")}/>\r\n        <Tab value=\"annotations\" label={t(\"scenes.nodeSettings.tabs.annotations.label\")}/>\r\n        <Tab value=\"view\" label={t(\"scenes.nodeSettings.tabs.view.label\")}/>\r\n        <Tab value=\"cache\" label={t(\"scenes.nodeSettings.tabs.cache.label\")}/>\r\n      </Tabs>\r\n      <div className={classes.tabContent}>\r\n        <Box style={tab !== \"general\" ? {display: \"none\"} : undefined}>\r\n          <Fragment>\r\n            <Grid container spacing={3}>\r\n              <Grid item xs={3}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    disabled={!!config}\r\n                    name=\"code\"\r\n                    variant=\"outlined\"\r\n                    label={\r\n                      <FormLabelWithTooltip tooltip={t(\"scenes.nodeSettings.fields.code.tooltip\")}>\r\n                        {t(\"scenes.nodeSettings.fields.code.label\")}\r\n                      </FormLabelWithTooltip>\r\n                    }\r\n                    required\r\n                    error={!!errors.code}\r\n                    helperText={errors.code?.message}\r\n                    value={watch('code') || \"\"}\r\n                    onChange={({target}) => setValue('code', (target.value || \"\").toUpperCase())}\r\n                    inputProps={{\r\n                      style: {textTransform: \"uppercase\"}\r\n                    }}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <I18nTextField\r\n                    name=\"title\"\r\n                    label={t(\"scenes.nodeSettings.fields.title.label\")}\r\n                    required\r\n                    error={!!errors.title}\r\n                    helperText={errors.title?.message}\r\n                    variant=\"outlined\"\r\n                    value={watch('title') || {}}\r\n                    onChange={value => setValue('title', value)}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={3}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    name=\"agency\"\r\n                    label={t(\"scenes.nodeSettings.fields.agency.label\")}\r\n                    required\r\n                    error={!!errors.agency}\r\n                    helperText={errors.agency?.message}\r\n                    variant=\"outlined\"\r\n                    value={watch('agency') || \"\"}\r\n                    onChange={({target}) => setValue('agency', target.value)}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FormControlLabel\r\n                label={\r\n                  <FormLabelWithTooltip\r\n                    tooltip={t(\"scenes.nodeSettings.fields.active.tooltip\")}\r\n                    tooltipOnRight\r\n                  >\r\n                    {t(\"scenes.nodeSettings.fields.active.label\")}\r\n                  </FormLabelWithTooltip>\r\n                }\r\n                control={\r\n                  <Checkbox\r\n                    name=\"active\"\r\n                    required\r\n                    checked={watch('active')}\r\n                    onChange={(e, value) => setValue('active', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"slogan\"\r\n                label={t(\"scenes.nodeSettings.fields.slogan.label\")}\r\n                variant=\"outlined\"\r\n                value={watch('slogan') || {}}\r\n                onChange={value => setValue('slogan', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.nodeSettings.fields.backgroundMediaURL.label\")}\r\n                value={watch('backgroundMediaURL')}\r\n                onChange={value => setValue('backgroundMediaURL', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.nodeSettings.fields.logo.label\")}\r\n                value={watch('logo')}\r\n                onChange={value => setValue('logo', value)}\r\n              />\r\n            </FormControl>\r\n          </Fragment>\r\n        </Box>\r\n        <Box style={tab !== \"infos\" ? {display: \"none\"} : undefined}>\r\n          <I18nHtmlEditor\r\n            value={watch('description')}\r\n            onChange={val => setValue('description', val)}\r\n          />\r\n        </Box>\r\n        <Box style={tab !== \"endpoint\" ? {display: \"none\"} : undefined}>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={12}>\r\n                <FormControl fullWidth>\r\n                  <TextField\r\n                    name=\"type\"\r\n                    select\r\n                    label={t(\"scenes.nodeSettings.fields.type.label\")}\r\n                    value=\"SDMX-REST\"\r\n                    variant=\"outlined\"\r\n                  >\r\n                    <MenuItem value=\"SDMX-REST\">SDMX-REST</MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item sm={12}>\r\n                <FormControl fullWidth>\r\n                  <TextField\r\n                    name=\"criteriaSelectionMode\"\r\n                    select\r\n                    label={\r\n                      <FormLabelWithTooltip\r\n                        tooltip={t(\"scenes.nodeSettings.fields.criteriaSelectionMode.tooltip\")}\r\n                      >\r\n                        {t(\"scenes.nodeSettings.fields.criteriaSelectionMode.label\")}\r\n                      </FormLabelWithTooltip>\r\n                    }\r\n                    variant=\"outlined\"\r\n                    onChange={e => setValue('criteriaSelectionMode', e.target.value)}\r\n                    value={watch(\"criteriaSelectionMode\") || ''}\r\n                    helperText={errors.criteriaSelectionMode?.message}\r\n                    error={!!errors.criteriaSelectionMode}\r\n                  >\r\n                    <MenuItem value={ALL_FULL}>ALL_FULL</MenuItem>\r\n                    <MenuItem value={ALL_PARTIAL}>ALL_PARTIAL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_FULL}>STEP_BY_STEP_FULL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_PARTIAL}>STEP_BY_STEP_PARTIAL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_DYNAMIC}>STEP_BY_STEP_DYNAMIC</MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n          </Paper>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"endPoint\"\r\n                label={t(\"scenes.nodeSettings.fields.endPoint.label\")}\r\n                required\r\n                error={!!errors.endPoint}\r\n                helperText={errors.endPoint?.message}\r\n                variant=\"outlined\"\r\n                value={watch('endPoint') || \"\"}\r\n                onChange={({target}) => setValue('endPoint', target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                select\r\n                label={t(\"scenes.nodeSettings.fields.responseFormat.label\")}\r\n                value={watch(\"restDataResponseXml\") || \"\"}\r\n                required\r\n                variant=\"outlined\"\r\n                error={!!errors.restDataResponseXml}\r\n                helperText={errors.restDataResponseXml?.message}\r\n                onChange={({target}) => setValue('restDataResponseXml', target.value)}\r\n              >\r\n                <MenuItem value=\"true\">XML</MenuItem>\r\n                <MenuItem value=\"false\">JSON</MenuItem>\r\n              </TextField>\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FormControlLabel\r\n                label={t(\"scenes.nodeSettings.fields.supportPostFilters.label\")}\r\n                control={\r\n                  <Checkbox\r\n                    name=\"supportPostFilters\"\r\n                    required\r\n                    checked={watch('supportPostFilters') || false}\r\n                    onChange={(e, value) => setValue('supportPostFilters', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n          </Paper>\r\n          {/*<Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label=\"SOAP endpoint\"\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"optimizeCallWithSoap\"\r\n                      checked={watch('optimizeCallWithSoap')}\r\n                      onChange={(e, value) => setValue('optimizeCallWithSoap', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {optimizeCallWithSoap && (\r\n                <Fragment>\r\n                  <Grid item sm={8}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"namespaceV20\"\r\n                        label=\"Endpoint V20\"\r\n                        required\r\n                        inputRef={register({\r\n                          required: REQUIRED_MESSAGE\r\n                        })}\r\n                        error={!!errors.namespaceV20}\r\n                        helperText={errors.namespaceV20?.message}\r\n                        variant=\"outlined\"\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}></Grid>\r\n                  <Grid item sm={8}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"namespaceV21\"\r\n                        label=\"Endpoint V21\"\r\n                        required\r\n                        inputRef={register({\r\n                          required: REQUIRED_MESSAGE\r\n                        })}\r\n                        error={!!errors.namespaceV21}\r\n                        helperText={errors.namespaceV21?.message}\r\n                        variant=\"outlined\"\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>*/}\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label={t(\"scenes.nodeSettings.fields.enableHttpAuth.label\")}\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"enableHttpAuth\"\r\n                      checked={enableHttpAuth || false}\r\n                      onChange={(e, value) => setValue('enableHttpAuth', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {enableHttpAuth && (\r\n                <Fragment>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpUsername\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpUsername.label\")}\r\n                        required\r\n                        error={!!errors.authHttpUsername}\r\n                        helperText={errors.authHttpUsername?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpUsername') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpUsername', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpPassword\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpPassword.label\")}\r\n                        type=\"password\"\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpPassword') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpPassword', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}/>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpDomain\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpDomain.label\")}\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpDomain') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpDomain', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label={t(\"scenes.nodeSettings.fields.enableProxy.label\")}\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"enableProxy\"\r\n                      checked={enableProxy || false}\r\n                      onChange={(e, value) => setValue('enableProxy', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {enableProxy && (\r\n                <Fragment>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyAddress\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyAddress.label\")}\r\n                        required\r\n                        error={!!errors.proxyAddress}\r\n                        helperText={errors.proxyAddress?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyAddress') || \"\"}\r\n                        onChange={({target}) => setValue('proxyAddress', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyPort\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyPort.label\")}\r\n                        required\r\n                        error={!!errors.proxyPort}\r\n                        helperText={errors.proxyPort?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyPort') || \"\"}\r\n                        onChange={({target}) => setValue('proxyPort', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}/>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyUsername\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyUsername.label\")}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyUsername') || \"\"}\r\n                        onChange={({target}) => setValue('proxyUsername', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyPassword\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyPassword.label\")}\r\n                        type=\"password\"\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyPassword') || \"\"}\r\n                        onChange={e => setValue('proxyPassword', e.target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>\r\n        </Box>\r\n        <Box style={tab !== \"annotations\" ? {display: \"none\"} : undefined}>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER_CATEGORY\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER_CATEGORY.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER_CATEGORY') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER_CATEGORY', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER_CODELIST\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER_CODELIST.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER_CODELIST') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER_CODELIST', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.NOT_DISPLAYED\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.NOT_DISPLAYED.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.NOT_DISPLAYED') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.NOT_DISPLAYED', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DEFAULT\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DEFAULT.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DEFAULT') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DEFAULT', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_ROW\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_ROW.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_ROW') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_ROW', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_COLUMN\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_COLUMN.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_COLUMN') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_COLUMN', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_FILTER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_FILTER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_FILTER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_FILTER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_ROW_SECTION\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_ROW_SECTION.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_ROW_SECTION') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_ROW_SECTION', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.CRITERIA_SELECTION\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.CRITERIA_SELECTION.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.CRITERIA_SELECTION') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.CRITERIA_SELECTION', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ATTACHED_DATA_FILES\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ATTACHED_DATA_FILES.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ATTACHED_DATA_FILES') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ATTACHED_DATA_FILES', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_DECIMAL_SEPARATOR\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_DECIMAL_SEPARATOR.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_DECIMAL_SEPARATOR') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_DECIMAL_SEPARATOR', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_NUMBER_OF_DECIMALS\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_NUMBER_OF_DECIMALS.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_NUMBER_OF_DECIMALS') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_NUMBER_OF_DECIMALS', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_EMPTY_CELL_PLACEHOLDER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_NOTES\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_NOTES.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_NOTES') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_NOTES', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_SOURCE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_SOURCE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_SOURCE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_SOURCE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.METADATA_URL\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.METADATA_URL.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.METADATA_URL') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.METADATA_URL', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.KEYWORDS\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.KEYWORDS.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.KEYWORDS') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.KEYWORDS', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DEFAULT_VIEW\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DEFAULT_VIEW.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DEFAULT_VIEW') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DEFAULT_VIEW', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.GEO_ID\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.GEO_ID.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.GEO_ID') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.GEO_ID', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAST_UPDATE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAST_UPDATE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAST_UPDATE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAST_UPDATE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.VIRTUAL_DATAFLOW_NODE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.VIRTUAL_DATAFLOW_NODE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.VIRTUAL_DATAFLOW_NODE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.VIRTUAL_DATAFLOW_NODE', target.value)}\r\n            />\r\n          </FormControl>\r\n        </Box>\r\n        <Box style={tab !== \"cache\" ? {display: \"none\"} : undefined}>\r\n\r\n\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"ttlCatalog\"\r\n              variant=\"outlined\"\r\n              helperText={errors.ttlCatalog?.message}\r\n              label={\r\n                <FormLabelWithTooltip tooltip={t(\"scenes.nodeSettings.fields.catalogCacheValidity.tooltip\")}>\r\n                  {t(\"scenes.nodeSettings.fields.catalogCacheValidity.label\")}\r\n                </FormLabelWithTooltip>\r\n              }\r\n              error={!!errors.ttlCatalog}\r\n              value={watch('ttlCatalog') || \"\"}\r\n              onChange={({target}) => setValue('ttlCatalog', target.value)}\r\n            />\r\n          </FormControl>\r\n\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"ttlDataflow\"\r\n              variant=\"outlined\"\r\n              helperText={errors.ttlDataflow?.message}\r\n              label={\r\n                <FormLabelWithTooltip tooltip={t(\"scenes.nodeSettings.fields.dataflowCacheValidity.tooltip\")}>\r\n                  {t(\"scenes.nodeSettings.fields.dataflowCacheValidity.label\")}\r\n                </FormLabelWithTooltip>\r\n              }\r\n              error={!!errors.ttlDataflow}\r\n              value={watch('ttlDataflow') || \"\"}\r\n              onChange={({target}) => setValue('ttlDataflow', target.value)}\r\n            />\r\n          </FormControl>\r\n\r\n\r\n        </Box>\r\n        <Box style={tab !== \"view\" ? {display: \"none\"} : undefined}>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <FormControlLabel\r\n              label={t(\"scenes.nodeSettings.fields.showDataflowUncategorized.label\")}\r\n              control={\r\n                <Checkbox\r\n                  name=\"showDataflowUncategorized\"\r\n                  required\r\n                  checked={watch('showDataflowUncategorized') || false}\r\n                  onChange={(e, value) => setValue('showDataflowUncategorized', value)}\r\n                />\r\n              }\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"showCategoryLevels\"\r\n              select\r\n              required\r\n              label={t(\"scenes.nodeSettings.fields.showCategoryLevels.label\")}\r\n              onChange={e => setValue('showCategoryLevels', e.target.value)}\r\n              value={watch(\"showCategoryLevels\") || ''}\r\n              error={!!errors.showCategoryLevels}\r\n              helperText={errors.showCategoryLevels?.message}\r\n              variant=\"outlined\"\r\n            >\r\n              <MenuItem value={1}>1</MenuItem>\r\n              <MenuItem value={5}>5</MenuItem>\r\n            </TextField>\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"decimalNumber\"\r\n              label={t(\"scenes.nodeSettings.fields.decimalNumber.label\")}\r\n              variant=\"outlined\"\r\n              required\r\n              type=\"number\"\r\n              error={!!errors.decimalNumber}\r\n              helperText={errors.decimalNumber?.message}\r\n              value={watch('decimalNumber') || ''}\r\n              onChange={({target}) => setValue('decimalNumber', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <I18nTextField\r\n              name=\"decimalSeparator\"\r\n              select\r\n              required\r\n              label={t(\"scenes.nodeSettings.fields.decimalSeparator.label\")}\r\n              onChange={value => setValue('decimalSeparator', value)}\r\n              value={watch(\"decimalSeparator\") || ''}\r\n              helper={t(\"scenes.nodeSettings.fields.decimalSeparator.helper\")}\r\n              error={!!errors.decimalSeparator}\r\n              helperText={errors.decimalSeparator?.message}\r\n              variant=\"outlined\"\r\n            >\r\n              <MenuItem value=\".\">Dot</MenuItem>\r\n              <MenuItem value=\",\">Comma</MenuItem>\r\n            </I18nTextField>\r\n          </FormControl>\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('labelDimensionTerritorials') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('labelDimensionTerritorials', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.labelDimensionTerritorials.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.labelDimensionTerritorials.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('labelDimensionTemporals') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('labelDimensionTemporals', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.labelDimensionTemporals.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.labelDimensionTemporals.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('categorySchemaExcludes') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('categorySchemaExcludes', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.categorySchemaExcludes.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.categorySchemaExcludes.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              select\r\n              label={t(\"scenes.nodeSettings.fields.catalogNavigationMode.label\")}\r\n              onChange={e => setValue('catalogNavigationMode', e.target.value)}\r\n              value={watch(\"catalogNavigationMode\") || ''}\r\n              required\r\n              variant=\"outlined\"\r\n              error={!!errors.catalogNavigationMode}\r\n              helperText={errors.catalogNavigationMode?.message}\r\n            >\r\n              <MenuItem value=\"Card\">{t(\"scenes.nodeSettings.fields.catalogNavigationMode.values.card\")}</MenuItem>\r\n              <MenuItem value=\"List\">{t(\"scenes.nodeSettings.fields.catalogNavigationMode.values.list\")}</MenuItem>\r\n            </TextField>\r\n          </FormControl>\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('hiddenAttributes') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('hiddenAttributes', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.hiddenAttributes.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.hiddenAttributes.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          {/*<FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"pageSize\"\r\n              label={t(\"scenes.nodeSettings.fields.pageSize.label\")}\r\n              variant=\"outlined\"\r\n              type=\"number\"\r\n              value={watch('pageSize') || \"\"}\r\n              onChange={({target}) => setValue('pageSize', Number(target.value))}\r\n            />\r\n          </FormControl>*/}\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            options={Object.keys(downloadFormats(t))}\r\n            getOptionLabel={option => downloadFormats(t)[option].label}\r\n            value={watch('downloadFormats') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip\r\n                  variant=\"outlined\"\r\n                  label={downloadFormats(t)[option].label}\r\n                  {...getTagProps({index})}\r\n                />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('downloadFormats', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.downloadFormats.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.downloadFormats.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n        </Box>\r\n      </div>\r\n    </Box>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodesConfig.node\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchNodesConfigNode(nodeId)),\r\n  sendConfigCreate: config => dispatch(sendNodesConfigNodeCreate(config)),\r\n  sendConfig: config => dispatch(sendNodesConfigNodeEdit(config)),\r\n  clearConfig: () => dispatch(clearNodesConfigNode())\r\n});\r\n\r\nconst NodeSettingsForm = ({config, nodeId, fetchConfig, sendConfigCreate, sendConfig, clearConfig}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(nodeId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, nodeId]);\r\n\r\n  return ((nodeId === null || config) && (\r\n    <Form\r\n      config={nodeId === null ? undefined : config}\r\n      ref={ref}\r\n      onSubmit={nodeId === null ? sendConfigCreate : sendConfig}\r\n      onCancel={clearConfig}\r\n    />\r\n  ));\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(NodeSettingsForm);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  getCreateTemplateUrl,\r\n  getCreateViewUrl,\r\n  getDatasetDownloadUrl,\r\n  getDatasetStructureCodelistsUrl,\r\n  getDatasetStructureCodelistUrl,\r\n  getDatasetStructureDynamicCodelistUrl,\r\n  getDatasetStructureUrl,\r\n  getDatasetUrl,\r\n  getGeometryUrl\r\n} from \"../../serverApi/urls\";\r\nimport {getCriteriaRequestObject} from \"../../utils/datasets\";\r\n\r\nexport const DATASET_STRUCTURE_FETCH_ENABLE = \"dataset/structure/fetch/enable\";\r\nexport const DATASET_STRUCTURE_FETCH = \"dataset/structure/fetch\";\r\nexport const DATASET_FETCH_ENABLE = \"dataset/fetch/enable\";\r\nexport const DATASET_FETCH = \"dataset/fetch\";\r\nexport const DATASET_ACCESSIBLE_FETCH = \"dataset/accessible/fetch\";\r\nexport const DATASET_CRITERIA_LENGTH_WARNING_SHOW = \"dataset/criteria/length/warning/show\";\r\nexport const DATASET_CRITERIA_LENGTH_WARNING_HIDE = \"dataset/criteria/length/warning/hide\";\r\nexport const DATASET_CRITERIA_SHOW = \"dataset/criteria/show\";\r\nexport const DATASET_CRITERIA_HIDE = \"dataset/criteria/hide\";\r\nexport const DATASET_CRITERIA_ALERT_HIDE = \"dataset/criteria/alert/hide\";\r\nexport const DATASET_STRUCTURE_CODELIST_FETCH = \"dataset/structure/codelist/fetch\";\r\nexport const DATASET_STRUCTURE_CODELISTS_FETCH = \"dataset/structure/codelists/fetch\";\r\nexport const DATASET_STRUCTURE_CODELIST_FILTER_SET = \"dataset/structure/codelist/filters/set\";\r\nexport const DATASET_RESET = \"dataset/reset\";\r\n\r\nexport const DATASET_VIEWER_SET = \"dataset/viewer/set\";\r\n\r\nexport const DATASET_LABEL_FORMAT_SET = \"dataset/label/format/set\";\r\n\r\nexport const DATASET_DOWNLOAD_SUBMIT = \"dataset/download/submit\";\r\nexport const DATASET_DOWNLOAD_WARNING_HIDE = \"dataset/download/warning/hide\";\r\n\r\nexport const DATASET_VIEW_TEMPLATE_SUBMIT = \"dataset/view/template/submit\";\r\n\r\nexport const DATASET_UNAVAILABLE_VIEW_WARNING_HIDE = \"dataset/unavailable/view/warning/hide\";\r\n\r\nexport const DATASET_HTML_GENERATING_TIME_SET = \"dataset/html/generating/time/set\";\r\n\r\nexport const DATASET_TERRITORY_FETCH = \"dataset/territory/fetch\";\r\n\r\nexport const ALL_FULL = \"FullAll\"\r\nexport const ALL_PARTIAL = \"PartialAll\"\r\nexport const STEP_BY_STEP_FULL = \"FullStep\"\r\nexport const STEP_BY_STEP_PARTIAL = \"PartialStep\"\r\nexport const STEP_BY_STEP_DYNAMIC = \"Dynamic\"\r\n\r\nexport const CRITERIA_SELECTION_MODE_STEP_BY_STEP = \"stepByStep\"\r\nexport const CRITERIA_SELECTION_MODE_ALL = \"all\"\r\n\r\nexport const CRITERIA_SELECTION_TYPE_FULL = \"full\"\r\nexport const CRITERIA_SELECTION_TYPE_PARTIAL = \"partial\"\r\nexport const CRITERIA_SELECTION_TYPE_DYNAMIC = \"dynamic\"\r\n\r\nconst ENDPOINT_STRING_LENGTH = 100;\r\nconst MAX_CRITERIA_STRING_LENGTH = 2000;\r\n\r\nexport const enableDatasetStructureFetch = (datasetId: string) => ({\r\n  type: DATASET_STRUCTURE_FETCH_ENABLE,\r\n  datasetId\r\n});\r\n\r\nexport const fetchDatasetStructure = (nodeId: number, datasetId: string, viewId: string, isAccessible: boolean, defaultLanguage: string, languages: string[]) => initRequest(\r\n  DATASET_STRUCTURE_FETCH,\r\n  getDatasetStructureUrl(nodeId, datasetId, viewId),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDatasetStructure\")\r\n  }),\r\n  {\r\n    viewId: viewId,\r\n    isAccessible: isAccessible,\r\n    defaultLanguage: defaultLanguage,\r\n    languages: languages\r\n  }\r\n);\r\n\r\nexport const enableDatasetFetch = () => ({\r\n  type: DATASET_FETCH_ENABLE\r\n});\r\n\r\nexport const fetchDataset = (nodeId: number, datasetId: string, filters: any, datasetTitle: string, checkCriteriaLength: boolean, tableLayout: any, initialTableLayout: any, initialChartLayout: any, initialMapLayout: any, maxAllowedCells: number, hasViewTemplate: boolean) => {\r\n  const flatCriteria = getCriteriaRequestObject(filters);\r\n\r\n  return (checkCriteriaLength && ((JSON.stringify(flatCriteria).length + ENDPOINT_STRING_LENGTH) > MAX_CRITERIA_STRING_LENGTH))\r\n    ? {\r\n      type: DATASET_CRITERIA_LENGTH_WARNING_SHOW\r\n    }\r\n    : initRequest(\r\n      DATASET_FETCH,\r\n      getDatasetUrl(nodeId, datasetId),\r\n      RequestMethod.POST,\r\n      flatCriteria,\r\n      t => ({\r\n        onStart: t(\"scenes.dataset.actions.fetchingDataset\", {title: datasetTitle})\r\n      }),\r\n      {\r\n        tableLayout: tableLayout,\r\n        initialTableLayout: initialTableLayout,\r\n        initialChartLayout: initialChartLayout,\r\n        initialMapLayout: initialMapLayout,\r\n        maxAllowedCells: maxAllowedCells,\r\n        hasViewTemplate: hasViewTemplate\r\n      },\r\n      \"\",\r\n      (statusCode: number) => statusCode === 413\r\n    );\r\n};\r\n\r\nexport const fetchAccessibleDataset = (nodeId: number, datasetId: string, criteria: any, datasetTitle: string) => initRequest(\r\n  DATASET_ACCESSIBLE_FETCH,\r\n  getDatasetDownloadUrl(nodeId, datasetId, \"csv\"),\r\n  RequestMethod.POST,\r\n  getCriteriaRequestObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.fetchingDataset\", {title: datasetTitle})\r\n  })\r\n);\r\n\r\nexport const hideDatasetCriteriaLengthWarning = () => ({\r\n  type: DATASET_CRITERIA_LENGTH_WARNING_HIDE\r\n});\r\n\r\nexport const showDatasetCriteria = () => ({\r\n  type: DATASET_CRITERIA_SHOW\r\n});\r\n\r\nexport const hideDatasetCriteria = () => ({\r\n  type: DATASET_CRITERIA_HIDE\r\n});\r\n\r\nexport const hideDatasetCriteriaAlert = () => ({\r\n  type: DATASET_CRITERIA_ALERT_HIDE\r\n});\r\n\r\nexport const fetchDatasetStructureCodelist = (nodeId: number, datasetId: string, dimensionId: string, type: string, filters: any) => {\r\n\r\n  let flatCriteria = getCriteriaRequestObject(filters);\r\n  // @ts-ignore\r\n  flatCriteria = flatCriteria.filter(({id}) => id !== dimensionId)\r\n\r\n  return type === CRITERIA_SELECTION_TYPE_DYNAMIC\r\n    ? (\r\n      initRequest(\r\n        DATASET_STRUCTURE_CODELIST_FETCH,\r\n        getDatasetStructureDynamicCodelistUrl(nodeId, datasetId, dimensionId),\r\n        RequestMethod.POST,\r\n        flatCriteria,\r\n        t => ({\r\n          onStart: t(\"scenes.dataset.actions.fetchingCodelist\")\r\n        })\r\n      )\r\n    )\r\n    : (\r\n      initRequest(\r\n        DATASET_STRUCTURE_CODELIST_FETCH,\r\n        getDatasetStructureCodelistUrl(nodeId, datasetId, dimensionId, type === CRITERIA_SELECTION_TYPE_FULL),\r\n        undefined,\r\n        undefined,\r\n        t => ({\r\n          onStart: t(\"scenes.dataset.actions.fetchingCodelist\")\r\n        })\r\n      )\r\n    );\r\n};\r\n\r\nexport const fetchDatasetStructureCodelists = (nodeId: number, datasetId: string, type: string) => initRequest(\r\n  DATASET_STRUCTURE_CODELISTS_FETCH,\r\n  getDatasetStructureCodelistsUrl(nodeId, datasetId, type === CRITERIA_SELECTION_TYPE_FULL),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.fetchingCodelists\")\r\n  })\r\n);\r\n\r\nexport const setDatasetStructureCodelistFilters = (filters: any) => ({\r\n  type: DATASET_STRUCTURE_CODELIST_FILTER_SET,\r\n  filters\r\n});\r\n\r\nexport const resetDataset = () => ({\r\n  type: DATASET_RESET\r\n});\r\n\r\nexport const setDatasetViewer = (viewerIdx: number) => ({\r\n  type: DATASET_VIEWER_SET,\r\n  viewerIdx\r\n});\r\n\r\nexport const setDatasetLabelFormat = (labelFormat: string) => ({\r\n  type: DATASET_LABEL_FORMAT_SET,\r\n  labelFormat\r\n});\r\n\r\nexport const submitDatasetDownload = (nodeId: number, datasetId: string, datasetTitle: string, criteria: any, format: string, extension: string, zipped?: boolean) => initRequest(\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  getDatasetDownloadUrl(nodeId, datasetId, format, zipped),\r\n  RequestMethod.POST,\r\n  getCriteriaRequestObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.downloadingDataset\")\r\n  }),\r\n  {\r\n    fileSave: {\r\n      name: `${datasetTitle}.${extension}`,\r\n      type: \"text/plain;charset=utf-8\"\r\n    }\r\n  },\r\n  \"\",\r\n  (statusCode: number) => statusCode === 406\r\n);\r\n\r\nexport const hideDatasetDownloadWarning = () => ({\r\n  type: DATASET_DOWNLOAD_WARNING_HIDE\r\n});\r\n\r\nexport const submitDatasetViewTemplate = (nodeId: number, viewTemplate: any, isView: boolean) => initRequest(\r\n  DATASET_VIEW_TEMPLATE_SUBMIT,\r\n  isView\r\n    ? getCreateViewUrl(nodeId)\r\n    : getCreateTemplateUrl(nodeId),\r\n  RequestMethod.POST,\r\n  viewTemplate,\r\n  t => ({\r\n    onStart: isView\r\n      ? t(\"scenes.dataset.actions.savingView\")\r\n      : t(\"scenes.dataset.actions.savingTemplate\")\r\n  })\r\n);\r\n\r\nexport const hideDatasetUnavailableViewWarning = () => ({\r\n  type: DATASET_UNAVAILABLE_VIEW_WARNING_HIDE\r\n});\r\n\r\nexport const setDatasetHtmlGeneratingTime = (time: number) => ({\r\n  type: DATASET_HTML_GENERATING_TIME_SET,\r\n  time\r\n});\r\n\r\n\r\nexport const fetchDatasetGeometries = (idList: string[]) => initRequest(\r\n  DATASET_TERRITORY_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dataset.actions.fetchingGeometries`)\r\n  })\r\n);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getClearNodeCatalogMemoryCacheUrl,\r\n    getDataflowsCacheListUrl,\r\n    getDataflowsCacheUpdateUrl,\r\n    getDataflowsClearAllCacheUrl,\r\n    getDataflowsClearCacheUrl,\r\n    getDataflowsCreateCacheUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const DATAFLOW_CACHE_FETCH = \"cache/fetch\";\r\nexport const DATAFLOW_CACHE_CLEAR = \"cache/clear\";\r\nexport const DATAFLOW_CACHE_UPDATE = \"cache/update\";\r\nexport const DATAFLOW_CACHE_CREATE = \"cache/create\";\r\nexport const DATAFLOW_CACHE_DELETE = \"cache/delete\";\r\nexport const DATAFLOW_CACHE_DELETE_ALL = \"cache/deleteAll\";\r\nexport const DATAFLOW_CACHE_DELETE_CATALOG = \"cache/deleteCatalog\";\r\n\r\n\r\nexport const fetchDataflowCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_FETCH,\r\n  getDataflowsCacheListUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.cacheSettings.messages.fetchDataflowCache.start\")\r\n  })\r\n);\r\n\r\nexport const updateDataflowCache = (nodeId: number, cacheId: string, ttl: number) => initRequest(\r\n  DATAFLOW_CACHE_UPDATE,\r\n  getDataflowsCacheUpdateUrl(nodeId, cacheId),\r\n  RequestMethod.PUT,\r\n  {ttl: ttl},\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.updateDataflowCache.start\")\r\n  }),\r\n  {\r\n    ttl: ttl,\r\n    nodeId: nodeId,\r\n    cacheId: cacheId\r\n  }\r\n);\r\n\r\nexport const createDataflowCache = (nodeId: number, data:any) => initRequest(\r\n    DATAFLOW_CACHE_CREATE,\r\n    getDataflowsCreateCacheUrl(nodeId),\r\n    RequestMethod.POST,\r\n    data,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.cacheSettings.messages.createDataflowCache.start\")\r\n    }),\r\n    {\r\n      oldData: data,\r\n    }\r\n);\r\n\r\nexport const deleteDataflowCache = (nodeId: number, cacheId: string) => initRequest(\r\n  DATAFLOW_CACHE_DELETE,\r\n  getDataflowsClearCacheUrl(nodeId, cacheId),\r\n  RequestMethod.POST,\r\n  {},\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteDataflowCache.start\")\r\n  }),\r\n  {\r\n    nodeId: nodeId,\r\n    cacheId: cacheId\r\n  }\r\n);\r\n\r\nexport const clearDataflowCache = () => ({\r\n  type: DATAFLOW_CACHE_CLEAR\r\n});\r\n\r\nexport const deleteAllDataflowCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_DELETE_ALL,\r\n  getDataflowsClearAllCacheUrl(nodeId),\r\n  RequestMethod.POST,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteAllDataflowCache.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n\r\nexport const deleteCatalogCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_DELETE_CATALOG,\r\n  getClearNodeCatalogMemoryCacheUrl(nodeId),\r\n  RequestMethod.POST,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteCatalogCache.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n","import React, {forwardRef, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport CheckIcon from \"@material-ui/icons/Check\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport ArrowUpwardIcon from \"@material-ui/icons/ArrowUpward\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {\r\n  clearDataflowCache,\r\n  createDataflowCache,\r\n  deleteAllDataflowCache,\r\n  deleteCatalogCache,\r\n  deleteDataflowCache,\r\n  fetchDataflowCache,\r\n  updateDataflowCache\r\n} from \"../../../../state/cache/cacheActions\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport {Checkbox, withStyles, withTheme} from \"@material-ui/core\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\n\r\n\r\nconst tableIcons = {\r\n  Delete: forwardRef((props, ref) => <DeleteIcon {...props} ref={ref}/>),\r\n  Edit: forwardRef((props, ref) => <EditIcon {...props} ref={ref}/>),\r\n  Check: forwardRef((props, ref) => <CheckIcon {...props} ref={ref}/>),\r\n  Clear: forwardRef((props, ref) => <ClearIcon {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <ClearIcon {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpwardIcon {...props} ref={ref}/>),\r\n  Search: forwardRef((props, ref) => <SearchIcon {...props} ref={ref}/>),\r\n  Add: forwardRef((props, ref) => <AddIcon {...props} ref={ref}/>)\r\n};\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.cacheConfig\r\n});\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchCache: nodeId => dispatch(fetchDataflowCache(nodeId)),\r\n  clearCache: () => dispatch(clearDataflowCache()),\r\n  updateCache: (nodeId, cacheId, ttl) => dispatch(updateDataflowCache(nodeId, cacheId, ttl)),\r\n  createCache: (nodeId, data) => dispatch(createDataflowCache(nodeId, data)),\r\n  deleteFromCache: (nodeId, cacheId) => dispatch(deleteDataflowCache(nodeId, cacheId)),\r\n  deleteAllFromCache: (nodeId) => dispatch(deleteAllDataflowCache(nodeId)),\r\n  deleteCatalogCache: (nodeId) => dispatch(deleteCatalogCache(nodeId))\r\n});\r\n\r\n\r\nconst SECONDS_PER_DAY = 86400;\r\nconst SECONDS_PER_HOUR = 3600;\r\n\r\n\r\n/**\r\n * Convert seconds to HH:MM:SS\r\n * If seconds exceeds 24 hours, hours will be greater than 24 (30:05:10)\r\n *\r\n * @param {number} seconds\r\n * @returns {string}\r\n */\r\nconst secondsToHms = (totalSeconds) => {\r\n\r\n  if (!totalSeconds) {\r\n    return \"0 s\";\r\n  }\r\n\r\n  var days = Math.floor(totalSeconds / SECONDS_PER_DAY);\r\n  var hours = Math.floor((totalSeconds - (days * SECONDS_PER_DAY)) / SECONDS_PER_HOUR);\r\n  var minutes = Math.floor((totalSeconds - (days * SECONDS_PER_DAY) - (hours * SECONDS_PER_HOUR)) / 60);\r\n  var seconds = totalSeconds - (days * SECONDS_PER_DAY) - (hours * SECONDS_PER_HOUR) - (minutes * 60);\r\n\r\n  // round seconds\r\n  seconds = Math.round(seconds * 100) / 100\r\n\r\n  return wellFormattedTimeString(days, hours, minutes, seconds);\r\n};\r\n\r\nconst wellFormattedTimeString = (days, hours, mins, sec) => {\r\n  var result = \"\";\r\n  result += (days > 0 ? days + \"d \" : \"\"); // hide days if 0\r\n  result += (hours < 10 ? \" \" + hours : hours) + \"h \";\r\n  result += (mins < 10 ? \" \" + mins : mins) + \"m \";\r\n\r\n  if (days === 0) { // truncate if days is greater than zero\r\n    result += (sec < 10 ? \" \" + sec : sec) + \"s\";\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nconst CacheSettingsForm = ({classes, config, nodeId, fetchCache, createCache, updateCache, clearCache, deleteFromCache, deleteAllFromCache, deleteCatalogCache}, ref) => {\r\n//const CacheSettingsForm = compose(withStyles(styles), forwardRef)(({classes, config, nodeId, fetchCache, updateCache, clearCache, deleteFromCache}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null && (!config || config.length === 0));\r\n  const [hideEmptyDataflowCache, setEmptyDataflowCacheHidden] = useState(true);\r\n  const [emptyRowsCounter, setEmptyRowsCounter] = useState(0);\r\n  const [rowsCounter, setRowsCounter] = useState(0);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (!config || config.length === 0) {\r\n      setRowsCounter(0);\r\n      setEmptyRowsCounter(0);\r\n      return;\r\n    }\r\n    setRowsCounter(config.length);\r\n    setEmptyRowsCounter(config.filter(val => val?.cacheSize === 0).length);\r\n  }, [config]);\r\n\r\n  useEffect(() => {\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchCache(nodeId);\r\n    }\r\n\r\n\r\n  }, [config, fetchCache, nodeId, needConfig, setNeedConfig]);\r\n  /*\r\n      const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n          defaultValues: {\r\n              ...config\r\n          }\r\n      });\r\n  */\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      f();\r\n    },\r\n    cancel(f) {\r\n      clearCache();\r\n      f();\r\n    }\r\n  }));\r\n\r\n\r\n  return (\r\n\r\n    <Grid container>\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n\r\n            <Grid container spacing={2}>\r\n\r\n\r\n              <Grid item xs={4}>\r\n                <FormControl fullWidth>\r\n                  <Button container style={{marginRight: 24}} size=\"large\" variant=\"contained\"\r\n                          color=\"primary\" onClick={() => deleteCatalogCache(nodeId)}>\r\n                    {t(\"scenes.nodeSettings.cacheSettings.deleteCatalogCache\")}\r\n                  </Button>\r\n                </FormControl>\r\n              </Grid>\r\n              {/* <Grid item xs={4}>\r\n                                <FormControl fullWidth>\r\n                                    <Button size=\"large\" variant=\"contained\" color=\"primary\"\r\n                                            onClick={window.notImplemented.show}>\r\n                                        Refresh catalog cache\r\n                                    </Button>\r\n                                </FormControl>\r\n                            </Grid>\r\n                            <Grid item xs={4}/>*/}\r\n            </Grid>\r\n          </Paper>\r\n\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={1}>\r\n              <Grid item xs={4}>\r\n                <FormControl fullWidth>\r\n                  <Button container style={{marginRight: 24}} size=\"large\" variant=\"contained\"\r\n                          color=\"primary\" onClick={() => deleteAllFromCache(nodeId)}>\r\n                    {t(\"scenes.nodeSettings.cacheSettings.deleteAllDataflowCache\")}\r\n                  </Button>\r\n                </FormControl>\r\n              </Grid>\r\n              {/*<Grid item xs={4} >*/}\r\n              {/*    <FormControl fullWidth>*/}\r\n              {/*        <Button disabled size=\"large\" variant=\"contained\" color=\"primary\"*/}\r\n              {/*                onClick={window.notImplemented.show}>*/}\r\n              {/*            Refresh dataflow cache*/}\r\n              {/*        </Button>*/}\r\n              {/*    </FormControl>*/}\r\n              {/*</Grid>*/}\r\n              <Grid item xs={4}/>\r\n              <Grid item xs={4}/>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.nodeSettings.cacheSettings.hideEmptyEntries\")}\r\n                    control={\r\n                      <Checkbox\r\n                        name=\"active\"\r\n                        required\r\n                        disabled={emptyRowsCounter === 0 || rowsCounter === 0}\r\n                        checked={hideEmptyDataflowCache}\r\n                        onChange={(e, value) => setEmptyDataflowCacheHidden(value)}\r\n                      />\r\n                    }\r\n                  />\r\n                  {/*<FormHelperText>*/}\r\n                  {/*    { (!hideEmptyDataflowCache? \"Hide\" : \"Show\") + \" cache entries which size is 0 Kb.\" }*/}\r\n                  {/*</FormHelperText>*/}\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <CustomMaterialTable\r\n                components={{\r\n                  Container: Box\r\n                }}\r\n                icons={tableIcons}\r\n                columns={[\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowTitle\"),\r\n                    field: \"title\",\r\n                    editable: 'never'\r\n                  },\r\n                  /*{title: \"Title\", field: \"dataflowId\", editable: 'never'},*/\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowValidity\"),\r\n                    field: \"ttl\",\r\n                    type: \"numeric\",\r\n                    editable: 'onUpdate',\r\n                    render: rowData => secondsToHms(rowData.ttl)\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowFiles\"),\r\n                    field: \"cachedDataflow\",\r\n                    type: \"numeric\",\r\n                    editable: 'never'\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowSize\"),\r\n                    field: \"cacheSize\",\r\n                    type: \"numeric\",\r\n                    editable: 'never',\r\n                    render: rowData => rowData.cacheSize + \" Kb\"\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowAccess\"),\r\n                    field: \"cachedDataAccess\",\r\n                    type: \"numeric\",\r\n                    editable: 'never'\r\n                  }\r\n\r\n                ]}\r\n                data={config?.filter(val => !hideEmptyDataflowCache || val.cacheSize > 0) || []}\r\n                editable={{\r\n                  onRowUpdate: (newData, oldData) =>\r\n                    new Promise((resolve, reject) => {\r\n                      if (newData.ttl < 0) { // invalid ttl\r\n                        reject();\r\n                        return;\r\n                      }\r\n\r\n                      if (newData.ttl === oldData.ttl) { //no update is needed here\r\n                        resolve();\r\n                        return;\r\n                      }\r\n\r\n                      const dataUpdate = [...config];\r\n                      const index = oldData.tableData.id;\r\n                      dataUpdate[index] = newData;\r\n\r\n                      if (!newData.id || newData.id === '00000000-0000-0000-0000-000000000000') {\r\n                        createCache(nodeId, newData);\r\n                      } else {\r\n                        updateCache(nodeId, newData.id, newData.ttl)\r\n                      }\r\n\r\n\r\n                      // config([...dataUpdate]);\r\n\r\n                      resolve();\r\n                    }),\r\n                  onRowDelete: oldData =>\r\n                    new Promise((resolve, reject) => {\r\n                      const dataDelete = [...config];\r\n                      const index = oldData.tableData.id;\r\n                      dataDelete.splice(index, 1);\r\n\r\n                      //data does not exists. no need to make a server call\r\n                      if (!oldData.id || oldData.id === '00000000-0000-0000-0000-000000000000') {\r\n                        resolve();\r\n                        return;\r\n                      }\r\n\r\n                      deleteFromCache(nodeId, oldData.id)\r\n                      //setCacheConfig([...dataDelete]);\r\n\r\n                      resolve();\r\n                    }),\r\n                }}\r\n                /*actions={[\r\n                  {\r\n                    icon: EditIcon,\r\n                    tooltip: 'Edit node',\r\n                    onClick: (_, {id}) => {window.notImplemented.show();}\r\n                  },\r\n                  {\r\n                    icon: DeleteIcon,\r\n                    tooltip: 'Delete node',\r\n                    onClick: (_, {id}) => {window.notImplemented.show();}\r\n                  }]}\r\n                 */\r\n                options={{\r\n                  paging: false,\r\n                  draggable: true,\r\n                  actionsColumnIndex: -1,\r\n                  searchFieldAlignment: \"left\",\r\n                  //maxBodyHeight: 400,\r\n                  showTitle: false\r\n                }}\r\n                localization={{\r\n                  body: {\r\n                    editRow: {\r\n                      deleteText: t(\"scenes.nodesSettings.cacheSettings.modals.deleteDataflowCache.title\")\r\n                    },\r\n                    editTooltip: t(\"scenes.nodeSettings.cacheSettings.table.actions.editRow\"),\r\n                    deleteTooltip: t(\"scenes.nodeSettings.cacheSettings.table.actions.deleteRow\")\r\n                  }\r\n                }}\r\n              />\r\n            </Grid>\r\n\r\n          </Paper>\r\n\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n\r\n\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), withTheme, compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}),\r\n  forwardRef))(CacheSettingsForm);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getDeleteTemplateUrl, getNodeTemplatesUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_TEMPLATES_CONFIG_FETCH = \"nodeTemplatesConfig/fetch\";\r\nexport const NODE_TEMPLATES_CONFIG_CLEAR = \"nodeTemplatesConfig/clear\";\r\nexport const NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE = \"nodeTemplatesConfig/deleteTemplate\";\r\n\r\nexport const fetchNodeTemplatesConfig = (nodeId: number) => initRequest(\r\n  NODE_TEMPLATES_CONFIG_FETCH,\r\n  getNodeTemplatesUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.templatesSettings.fetchConfig.start\")\r\n  })\r\n);\r\n\r\nexport const clearNodeTemplatesConfig = () => ({\r\n  type: NODE_TEMPLATES_CONFIG_CLEAR\r\n});\r\n\r\nexport const deleteNodeTemplatesConfigTemplate = (nodeId: number, id: number) => initRequest(\r\n  NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE,\r\n  getDeleteTemplateUrl(nodeId, id),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.templatesSettings.deleteTemplate.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {Visibility} from \"@material-ui/icons\";\r\nimport {\r\n  clearNodeTemplatesConfig,\r\n  deleteNodeTemplatesConfigTemplate,\r\n  fetchNodeTemplatesConfig\r\n} from \"../../../../state/noteTemplatesConfig/nodeTemplatesConfigActions\";\r\nimport {goToData} from \"../../../../links\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  templates: state.nodeTemplatesConfig.templates\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchTemplates: nodeId => dispatch(fetchNodeTemplatesConfig(nodeId)),\r\n  deleteTemplate: (nodeId, id) => dispatch(deleteNodeTemplatesConfigTemplate(nodeId, id)),\r\n  clearTemplates: () => dispatch(clearNodeTemplatesConfig())\r\n});\r\n\r\nconst TemplatesSettingsForm = ({classes, defaultLanguage, languages, nodes, nodeId, defaultNodeOpen, templates, fetchTemplates, deleteTemplate, clearTemplates}, ref) => {\r\n\r\n  const [needTemplates, setNeedTemplates] = useState(true);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needTemplates) {\r\n      setNeedTemplates(false);\r\n      fetchTemplates(nodeId);\r\n    }\r\n  }, [templates, needTemplates, setNeedTemplates, fetchTemplates, nodeId]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearTemplates();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [deleteTemplateId, setDeleteTemplateId] = useState(null);\r\n\r\n  return templates && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"datasetId\",\r\n            title: t(\"scenes.nodeSettings.templatesSettings.table.columns.datasetId\")\r\n          },\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.nodeSettings.templatesSettings.table.columns.templateName\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          }\r\n        ]}\r\n        data={templates}\r\n        actions={[\r\n          ({\r\n            icon: Visibility,\r\n            tooltip: t(\"scenes.nodeSettings.templatesSettings.table.actions.viewData\"),\r\n            onClick: (_, {nodeId, datasetId}) => goToData(nodes.find(node => node.nodeId === nodeId).code, [], datasetId)\r\n          }),\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.nodeSettings.templatesSettings.table.actions.deleteTemplate\"),\r\n            onClick: (_, {viewTemplateId}) => setDeleteTemplateId(viewTemplateId)\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 3,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteTemplateId !== null}\r\n      >\r\n        <DialogTitle> {t(\"scenes.nodeSettings.templatesSettings.modals.deleteTemplate.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.nodeSettings.templatesSettings.modals.deleteTemplate.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setDeleteTemplateId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteTemplate(nodeId, deleteTemplateId);\r\n            setDeleteTemplateId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(TemplatesSettingsForm);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearNodePermissionsConfig,\r\n  fetchNodePermissionsConfig,\r\n  sendNodePermissionsConfig\r\n} from \"../../../../state/nodePermissionsConfig/nodePermissionsConfigActions\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport {useForm} from \"react-hook-form\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst PERMISSIONS = [\r\n  \"ManageCache\",\r\n  \"ManageTemplate\",\r\n  \"ManageConfig\"\r\n];\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, nodeId, onSubmit, onCancel}, ref) => {\r\n\r\n  const {register, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      config: config?.map((user, index) => {\r\n        let res = {...user};\r\n        PERMISSIONS.forEach(p => {\r\n          res[p] = config[index].permission.includes(`${p}_SingleNode_${nodeId}`) === true;\r\n        });\r\n        return res;\r\n      })\r\n    }\r\n  });\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    if (config) {\r\n      config.forEach((user, index) =>\r\n        PERMISSIONS.forEach(p =>\r\n          register({name: `config[${index}].${p}`})))\r\n    }\r\n  }, [register, config]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n\r\n        const data = val.config.map((userVal, index) => {\r\n          let res = {\r\n            userId: config[index].userId,\r\n            nodePermissions: []\r\n          };\r\n          PERMISSIONS.forEach(p => {\r\n            if (userVal[p] === true) {\r\n              res.nodePermissions.push(p);\r\n            }\r\n          });\r\n          res.tableData = undefined;\r\n          return res;\r\n        });\r\n\r\n        onSubmit(nodeId, data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return config && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"firstName\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userFirstName\")\r\n          },\r\n          {\r\n            field: \"lastName\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userLastName\")\r\n          },\r\n          {\r\n            field: \"organization\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userOrganization\")\r\n          },\r\n          {\r\n            field: \"email\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userEmail\")\r\n          },\r\n          ...PERMISSIONS.map(p => ({\r\n            title: p,\r\n            render: ({tableData}) =>\r\n              <Grid container justify=\"center\">\r\n                <Grid item>\r\n                  <Checkbox\r\n                    checked={watch(`config[${tableData.id}].${p}`)}\r\n                    onChange={(ev, value) => setValue(`config[${tableData.id}].${p}`, value)}\r\n                  />\r\n                </Grid>\r\n              </Grid>\r\n          }))\r\n        ]}\r\n        data={config}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          searchFieldAlignment: \"left\",\r\n          maxBodyHeight: 400,\r\n          showTitle: false\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n    </Fragment>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodePermissionsConfig.permissions\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchNodePermissionsConfig(nodeId)),\r\n  sendConfig: (nodeId, config) => dispatch(sendNodePermissionsConfig(nodeId, config)),\r\n  clearConfig: () => dispatch(clearNodePermissionsConfig())\r\n});\r\n\r\nconst PermissionsSettingsForm = ({config, nodeId, fetchConfig, sendConfig, clearConfig}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(nodeId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, nodeId]);\r\n\r\n  return ((nodeId === null || config) && (\r\n    <Form\r\n      nodeId={nodeId}\r\n      config={nodeId === null ? undefined : config}\r\n      ref={ref}\r\n      onSubmit={sendConfig}\r\n      onCancel={clearConfig}\r\n    />\r\n  ));\r\n};\r\n\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(PermissionsSettingsForm);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getNodePermissionsConfigGetUrl, getNodePermissionsConfigPutUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_PERMISSIONS_CONFIG_FETCH = \"nodePermissionsConfig/fetch\";\r\nexport const NODE_PERMISSIONS_CONFIG_CLEAR = \"nodePermissionsConfig/clear\";\r\nexport const NODE_PERMISSIONS_CONFIG_SEND = \"nodePermissionsConfig/send\";\r\n\r\nexport const fetchNodePermissionsConfig = (nodeId: number) => initRequest(\r\n    NODE_PERMISSIONS_CONFIG_FETCH,\r\n    getNodePermissionsConfigGetUrl(nodeId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.permissionsSettings.fetchConfig.start\")\r\n    })\r\n);\r\n\r\nexport const sendNodePermissionsConfig = (nodeId: number, config: any) => initRequest(\r\n    NODE_PERMISSIONS_CONFIG_SEND,\r\n    getNodePermissionsConfigPutUrl(nodeId),\r\n    RequestMethod.PUT,\r\n    config,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.permissionsSettings.sendConfig.start\")\r\n    })\r\n);\r\n\r\nexport const clearNodePermissionsConfig = () => ({\r\n    type: NODE_PERMISSIONS_CONFIG_CLEAR\r\n});\r\n","import React, {forwardRef} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport DashboardsManager from \"../../../dashboards-manager\";\r\nimport {\r\n  addNodesConfigDashboardsNodeDashboard,\r\n  clearAllNodesConfigNodeDashboards,\r\n  clearNodesConfigNodeDashboards,\r\n  fetchAllNodeConfigDashboards,\r\n  fetchNodesConfigNodeDashboards,\r\n  removeNodesConfigDashboardsNodeDashboard,\r\n  sendNodesConfigDashboardsNodeOrders\r\n} from \"../../../../state/nodesConfig/nodesConfigActions\";\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.hubConfig.hub,\r\n  user: state.user,\r\n  dashboards: state.nodesConfig.nodeDashboards,\r\n  allDashboards: state.nodesConfig.allDashboards\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboards: nodeId => dispatch(fetchNodesConfigNodeDashboards(nodeId)),\r\n  fetchAllDashboards: () => dispatch(fetchAllNodeConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearNodesConfigNodeDashboards()),\r\n  clearAllDashboards: () => dispatch(clearAllNodesConfigNodeDashboards()),\r\n  addDashboard: (nodeId, dashboardId) => dispatch(addNodesConfigDashboardsNodeDashboard(nodeId, dashboardId)),\r\n  removeDashboard: (nodeId, dashboardId) => dispatch(removeNodesConfigDashboardsNodeDashboard(nodeId, dashboardId)),\r\n  sendDashboardsOrders: (nodeId, dashboardsIds) => dispatch(sendNodesConfigDashboardsNodeOrders(nodeId, dashboardsIds))\r\n});\r\n\r\nconst DashboardsSettingsForm = ({\r\n                                  dashboards,\r\n                                  allDashboards,\r\n                                  fetchDashboards,\r\n                                  fetchAllDashboards,\r\n                                  clearDashboards,\r\n                                  clearAllDashboards,\r\n                                  addDashboard,\r\n                                  removeDashboard,\r\n                                  sendDashboardsOrders,\r\n                                  nodeId\r\n                                }, ref) =>\r\n  <DashboardsManager\r\n    dashboards={dashboards}\r\n    allDashboards={allDashboards}\r\n    fetchDashboards={() => fetchDashboards(nodeId)}\r\n    fetchAllDashboards={fetchAllDashboards}\r\n    clearDashboards={clearDashboards}\r\n    clearAllDashboards={clearAllDashboards}\r\n    addDashboard={dashboardId => addDashboard(nodeId, dashboardId)}\r\n    removeDashboard={dashboardId => removeDashboard(nodeId, dashboardId)}\r\n    sendDashboardsOrders={dashboardsIds => sendDashboardsOrders(nodeId, dashboardsIds)}\r\n    ref={ref}\r\n  />;\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(DashboardsSettingsForm);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useRef, useState} from 'react';\r\nimport NodeSettingsForm from \"./node-settings-form\";\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport SettingsDialog from \"../../settings-dialog\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {\r\n  clearNodesConfigNodes,\r\n  closeNodesConfig,\r\n  deleteNodesConfigNode,\r\n  fetchNodesConfigNodes,\r\n  sendNodesConfigNodesOrder\r\n} from \"../../../state/nodesConfig/nodesConfigActions\";\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {compose} from \"redux\";\r\nimport CacheSettingsForm from \"./cache-setting-form/index\";\r\nimport TemplatesSettingsForm from \"./templates-settings-form\";\r\nimport {\r\n  canCreateNode,\r\n  canDeleteNodes,\r\n  canDisplayCacheSettingForm,\r\n  canDisplayPermissionsSettingsForm,\r\n  canDisplayTemplatesSettingsForm,\r\n  canEditNode,\r\n  canManageNodeDashboards,\r\n  canSortNodes\r\n} from \"../../../utils/user\";\r\nimport PermissionsSettingsForm from \"./permissions-settings-form\";\r\nimport PersonIcon from '@material-ui/icons/Person';\r\nimport DashboardIcon from \"@material-ui/icons/Dashboard\";\r\nimport DashboardsSettingsForm from \"./dashboards-settings-form\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../utils/i18n\";\r\nimport \"./style.css\";\r\nimport {MTableToolbar} from \"material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodesConfig.nodes,\r\n  user: state.user,\r\n  language: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: () => dispatch(fetchNodesConfigNodes()),\r\n  sendOrders: orderedIds => dispatch(sendNodesConfigNodesOrder(orderedIds)),\r\n  deleteNode: nodeId => dispatch(deleteNodesConfigNode(nodeId)),\r\n  clearConfig: () => dispatch(clearNodesConfigNodes()),\r\n  onClose: () => dispatch(closeNodesConfig())\r\n});\r\n\r\nconst NodesSettingsForm = ({classes, defaultNodeOpen, config, fetchConfig, sendOrders, deleteNode, clearConfig, nodes, user, onClose, language, languages}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearConfig();\r\n      onClose();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [isNodeFormVisible, setNodeFormVisibility] = useState(defaultNodeOpen || false);\r\n  const [nodeFormNodeId, setNodeFormNodeId] = useState(null);\r\n  const [nodeDeleteFormNodeId, setNodeDeleteFormNodeId] = useState(null);\r\n  const [cacheFormNodeId, setCacheFormNodeId] = useState(null);\r\n  const [isCacheFormVisible, setCacheFormVisibility] = useState(false);\r\n  const [templatesNodeId, setTemplatesNodeId] = useState(null);\r\n  const [permissionsNodeId, setPermissionsNodeId] = useState(null);\r\n  const [dashboardsNodeId, setDashboardsNodeId] = useState(null);\r\n\r\n  const nodeFormRef = useRef();\r\n  const cacheFormRef = useRef();\r\n  const templatesRef = useRef();\r\n  const permissionsRef = useRef();\r\n  const dashboardsRef = useRef();\r\n\r\n  const allowedNodes = (config || []).filter(({nodeId}) =>\r\n    canCreateNode(user) ||\r\n    canSortNodes(user) ||\r\n    canDisplayCacheSettingForm(user, nodeId) ||\r\n    canDisplayTemplatesSettingsForm(user, nodeId) ||\r\n    canDisplayPermissionsSettingsForm(user) ||\r\n    canEditNode(user, nodeId) ||\r\n    canDeleteNodes(user)\r\n  );\r\n  const orderedNodes = (allowedNodes || []).sort((a, b) => a.order - b.order)\r\n  const orderedNodesIds = orderedNodes.map(({nodeId}) => nodeId);\r\n\r\n  const moveUp = rowIndex =>\r\n    sendOrders([\r\n      ...orderedNodesIds.slice(0, rowIndex - 1),\r\n      orderedNodesIds[rowIndex],\r\n      orderedNodesIds[rowIndex - 1],\r\n      ...orderedNodesIds.slice(rowIndex + 1)\r\n    ]);\r\n\r\n  const moveDown = rowIndex =>\r\n    sendOrders([\r\n      ...orderedNodesIds.slice(0, rowIndex),\r\n      orderedNodesIds[rowIndex + 1],\r\n      orderedNodesIds[rowIndex],\r\n      ...orderedNodesIds.slice(rowIndex + 2)\r\n    ]);\r\n\r\n  return config && (\r\n    <Fragment>\r\n      <Box className=\"nodes-settings-form__table\">\r\n        <CustomMaterialTable\r\n          components={{\r\n            Container: Box,\r\n            Toolbar: props =>\r\n              <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n                <Grid item>\r\n                  <MTableToolbar {...props} />\r\n                </Grid>\r\n                {canCreateNode(user) && (\r\n                  <Grid item>\r\n                    <Button\r\n                      size=\"small\"\r\n                      startIcon={<AddIcon/>}\r\n                      onClick={() => {\r\n                        setNodeFormNodeId(null);\r\n                        setNodeFormVisibility(true);\r\n                        setCacheFormVisibility(false);\r\n                      }}>\r\n                      {t(\"scenes.nodesSettings.createNode\")}\r\n                    </Button>\r\n                  </Grid>\r\n                )}\r\n              </Grid>\r\n          }}\r\n          columns={[\r\n            {\r\n              field: \"code\",\r\n              title: t(\"scenes.nodesSettings.table.columns.nodeCode\")\r\n            },\r\n            {\r\n              field: \"title\",\r\n              title: t(\"scenes.nodesSettings.table.columns.nodeName\"),\r\n              render: ({title}) => localizeI18nObj(title, language, languages),\r\n              customFilterAndSearch: getI18nObjCustomFilterAndSearch(language, languages)\r\n            },\r\n            {\r\n              field: \"active\",\r\n              title: t(\"scenes.nodesSettings.table.columns.isNodeActive.title\"),\r\n              render: ({active}) =>\r\n                active\r\n                  ? t(\"scenes.nodesSettings.table.columns.isNodeActive.values.true\")\r\n                  : t(\"scenes.nodesSettings.table.columns.isNodeActive.values.false\")\r\n            }\r\n          ]}\r\n          data={orderedNodes}\r\n          actions={[\r\n            ({tableData}) =>\r\n              canSortNodes(user)\r\n                ? {\r\n                  icon: ArrowDropUpIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeOrderMoveUp\"),\r\n                  onClick: (_, {tableData}) => moveUp(tableData.id), // tableData.id is the rowIndex\r\n                  disabled: tableData.id === 0\r\n                }\r\n                : null,\r\n            ({tableData}) =>\r\n              canSortNodes(user)\r\n                ? {\r\n                  icon: ArrowDropDownIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeOrderMoveDown\"),\r\n                  onClick: (_, {tableData}) => moveDown(tableData.id), // tableData.id is the rowIndex\r\n                  disabled: tableData.id === config.length - 1\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canDisplayCacheSettingForm(user, nodeId)\r\n                ? {\r\n                  icon: () =>\r\n                    <div className={classes.buttonAction}>\r\n                      {t(\"scenes.nodesSettings.table.actions.nodeDataflowsCache.label\")}\r\n                    </div>,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeDataflowsCache.tooltip\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setCacheFormNodeId(nodeId);\r\n                    setNodeFormVisibility(false);\r\n                    setCacheFormVisibility(true);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canDisplayTemplatesSettingsForm(user, nodeId)\r\n                ? {\r\n                  icon: () =>\r\n                    <div className={classes.buttonAction}>\r\n                      {t(\"scenes.nodesSettings.table.actions.nodeTemplates.label\")}\r\n                    </div>,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeTemplates.tooltip\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setTemplatesNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            () =>\r\n              canDisplayPermissionsSettingsForm(user)\r\n                ? {\r\n                  icon: PersonIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodePermissions\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setPermissionsNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canManageNodeDashboards(user, nodeId)\r\n                ? {\r\n                  icon: DashboardIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeDashboards\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setDashboardsNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canEditNode(user, nodeId)\r\n                ? {\r\n                  icon: EditIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.editNode\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setNodeFormNodeId(nodeId);\r\n                    setNodeFormVisibility(true);\r\n                    setCacheFormVisibility(false);\r\n                  }\r\n                }\r\n                : null,\r\n            () =>\r\n              canDeleteNodes(user)\r\n                ? {\r\n                  icon: DeleteIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.deleteNode\"),\r\n                  onClick: (_, {nodeId}) => setNodeDeleteFormNodeId(nodeId)\r\n                }\r\n                : null\r\n          ]}\r\n          options={{\r\n            paging: false,\r\n            draggable: true,\r\n            actionsColumnIndex: 3,\r\n            searchFieldAlignment: \"left\",\r\n            maxBodyHeight: 400,\r\n            showTitle: false\r\n          }}\r\n          icons={tableIcons}\r\n        />\r\n      </Box>\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.editNode\")}\r\n        open={isNodeFormVisible}\r\n        onClose={() => {\r\n          if (nodeFormRef.current) {\r\n            nodeFormRef.current.cancel(() => {\r\n              setNodeFormVisibility(false);\r\n              setNodeFormNodeId(null);\r\n            });\r\n          } else {\r\n            setNodeFormVisibility(false);\r\n            setNodeFormNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (nodeFormRef.current) {\r\n            nodeFormRef.current.submit(() => {\r\n              setNodeFormVisibility(false);\r\n              setNodeFormNodeId(null);\r\n            });\r\n          } else {\r\n            setNodeFormVisibility(false);\r\n            setNodeFormNodeId(null);\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <NodeSettingsForm ref={nodeFormRef} nodeId={nodeFormNodeId}/>\r\n\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeCache\", {nodeCode: config.find(node => node.nodeId === cacheFormNodeId)?.code})}\r\n        open={isCacheFormVisible}\r\n        onClose={() => {\r\n          if (cacheFormRef.current) {\r\n            cacheFormRef.current.cancel(() => {\r\n              setCacheFormVisibility(false);\r\n              setCacheFormNodeId(null);\r\n            });\r\n          } else {\r\n            setCacheFormVisibility(false);\r\n            setCacheFormNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (cacheFormRef.current) {\r\n            cacheFormRef.current.submit(() => {\r\n              setCacheFormVisibility(false);\r\n              setCacheFormNodeId(null);\r\n            });\r\n          } else {\r\n            setCacheFormVisibility(false);\r\n            setCacheFormNodeId(null);\r\n          }\r\n        }}\r\n        false\r\n      >\r\n        <CacheSettingsForm ref={cacheFormRef} nodeId={cacheFormNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeTemplates\", {nodeCode: config.find(node => node.nodeId === templatesNodeId)?.code})}\r\n        open={templatesNodeId !== null}\r\n        onClose={() => {\r\n          if (templatesRef.current) {\r\n            templatesRef.current.cancel(() => setTemplatesNodeId(null));\r\n          } else {\r\n            setTemplatesNodeId(null);\r\n          }\r\n        }}\r\n        maxWidth=\"md\"\r\n      >\r\n        <TemplatesSettingsForm ref={templatesRef} nodeId={templatesNodeId} nodes={config}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodePermissions\", {nodeCode: config.find(node => node.nodeId === permissionsNodeId)?.code})}\r\n        open={permissionsNodeId !== null}\r\n        onClose={() => {\r\n          if (permissionsRef.current) {\r\n            permissionsRef.current.cancel(() => {\r\n              setPermissionsNodeId(null);\r\n            });\r\n          } else {\r\n            setPermissionsNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (permissionsRef.current) {\r\n            permissionsRef.current.submit(() => {\r\n              setPermissionsNodeId(null);\r\n            });\r\n          } else {\r\n            setPermissionsNodeId(null);\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <PermissionsSettingsForm ref={permissionsRef} nodeId={permissionsNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeDashboards\", {nodeCode: config.find(node => node.nodeId === dashboardsNodeId)?.code})}\r\n        open={dashboardsNodeId !== null}\r\n        onClose={() => {\r\n          if (dashboardsRef.current) {\r\n            dashboardsRef.current.destroy(() => {\r\n              setDashboardsNodeId(null);\r\n            });\r\n          } else {\r\n            setDashboardsNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (dashboardsRef.current) {\r\n            dashboardsRef.current.destroy(() => {\r\n              setDashboardsNodeId(null);\r\n            });\r\n          } else {\r\n            setDashboardsNodeId(null);\r\n          }\r\n        }}\r\n      >\r\n        <DashboardsSettingsForm ref={dashboardsRef} nodeId={dashboardsNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={nodeDeleteFormNodeId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.nodesSettings.modals.nodeDelete.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.nodesSettings.modals.nodeDelete.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setNodeDeleteFormNodeId(null);\r\n            setCacheFormNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteNode(nodeDeleteFormNodeId);\r\n            setNodeDeleteFormNodeId(null);\r\n            setCacheFormNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(NodesSettingsForm);","import React, {forwardRef, useEffect, useImperativeHandle, useRef, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport SettingsDialog from \"../../settings-dialog\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {compose} from \"redux\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport UserSettingsForm from \"./user-settings-form\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUsersConfigUsers,\r\n  deleteUsersConfigUser,\r\n  fetchUsersConfigUsers,\r\n  hideUserConfigForm,\r\n  showUserConfigForm\r\n} from \"../../../state/usersConfig/usersConfigActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {MTableToolbar} from \"material-table\";\r\nimport \"./style.css\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.users,\r\n  userErrors: state.usersConfig.userErrors,\r\n  userId: state.usersConfig.userId\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: () => dispatch(fetchUsersConfigUsers()),\r\n  deleteUser: userId => dispatch(deleteUsersConfigUser(userId)),\r\n  clearConfig: () => dispatch(clearUsersConfigUsers()),\r\n  onUserFormShow: userId => dispatch(showUserConfigForm(userId)),\r\n  onUserFormHide: () => dispatch(hideUserConfigForm())\r\n});\r\n\r\nconst UsersSettingsForm = ({classes, config, fetchConfig, deleteUser, clearConfig, users, userErrors, userId, onUserFormShow, onUserFormHide}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearConfig();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [userDeleteFormUserId, setUserDeleteFormUserId] = useState(null);\r\n\r\n  const userFormRef = useRef();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return config && (\r\n    <div className=\"users-settings-form__table\">\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n          Toolbar: props =>\r\n            <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n              <Grid item>\r\n                <MTableToolbar {...props} />\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  size=\"small\"\r\n                  startIcon={<AddIcon/>}\r\n                  onClick={() => onUserFormShow(-1)}>\r\n                  {t(\"scenes.usersSettings.createUser\")}\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n        }}\r\n        columns={[\r\n          {field: \"firstName\", title: t(\"scenes.usersSettings.table.columns.userFirstName\")},\r\n          {field: \"lastName\", title: t(\"scenes.usersSettings.table.columns.userLastName\")},\r\n          {field: \"organization\", title: t(\"scenes.usersSettings.table.columns.userOrganization\")},\r\n          {field: \"email\", title: t(\"scenes.usersSettings.table.columns.userEmail\")},\r\n          {\r\n            field: \"isActive\",\r\n            title: t(\"scenes.usersSettings.table.columns.isActive.title\"),\r\n            render: ({isActive}) =>\r\n              isActive\r\n                ? t(\"scenes.usersSettings.table.columns.isActive.values.true\")\r\n                : t(\"scenes.usersSettings.table.columns.isActive.values.false\")\r\n          }\r\n        ]}\r\n        data={config}\r\n        actions={[\r\n          {\r\n            icon: EditIcon,\r\n            tooltip: t(\"scenes.usersSettings.table.actions.editUser\"),\r\n            onClick: (_, {userId}) => {\r\n              onUserFormShow(userId);\r\n            }\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.usersSettings.table.actions.deleteUser\"),\r\n            onClick: (_, {userId}) => {\r\n              setUserDeleteFormUserId(userId);\r\n            }\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 5,\r\n          searchFieldAlignment: \"left\",\r\n          maxBodyHeight: 400,\r\n          showTitle: false\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n      <SettingsDialog\r\n        title={\r\n          userId === -1\r\n            ? t(\"scenes.usersSettings.modals.createUser\")\r\n            : t(\"scenes.usersSettings.modals.editUser\")\r\n        }\r\n        maxWidth={\"sm\"}\r\n        open={userId !== null || userErrors !== null}\r\n        onClose={() => {\r\n          if (userFormRef.current) {\r\n            userFormRef.current.cancel(() => {\r\n              onUserFormHide();\r\n            });\r\n          } else {\r\n            onUserFormHide();\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (userFormRef.current) {\r\n            userFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <UserSettingsForm ref={userFormRef} userId={userId}/>\r\n      </SettingsDialog>\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={userDeleteFormUserId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.usersSettings.modals.deleteUser.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.usersSettings.modals.deleteUser.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setUserDeleteFormUserId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteUser(userDeleteFormUserId);\r\n            setUserDeleteFormUserId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}),\r\n  forwardRef\r\n)(UsersSettingsForm);","import React, {Fragment} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport AppSettingsForm from \"./app-settings-form\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport NodesSettingsForm from \"./nodes-settings-form\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {clearMemoryCache, downloadQueryLog} from \"./actions\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport Input from \"@material-ui/core/Input\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport UsersSettingsForm from \"./users-settings-form\";\r\nimport {\r\n  canClearServerCache,\r\n  canDisplayAppSettingsForm,\r\n  canDisplayNodesSettingsForm,\r\n  canDisplayUsersSettingsForm, canGetQueryLog\r\n} from \"../../utils/user\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  option: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onLogDownload: limit => dispatch(downloadQueryLog(limit)),\r\n  onCacheClear: () => dispatch(clearMemoryCache())\r\n});\r\n\r\nclass SettingsSelect extends React.Component {\r\n\r\n  state = {\r\n    isAppOpen: false,\r\n    isNodesOpen: false,\r\n    isUsersOpen: false,\r\n    appSettingsRef: React.createRef(),\r\n    nodesSettingsRef: React.createRef(),\r\n    usersSettingsRef: React.createRef(),\r\n    isLogDownloadOpen: false,\r\n    logLimit: 5,\r\n  };\r\n\r\n  onAppOpen = () => this.setState({\r\n    ...this.state,\r\n    isAppOpen: true\r\n  });\r\n\r\n  onAppClose = showSnackbar => this.setState({\r\n    ...this.state,\r\n    isAppOpen: false,\r\n    isAppSubmitSnackbarVisible: showSnackbar || false\r\n  });\r\n\r\n  onNodesOpen = () => this.setState({\r\n    ...this.state,\r\n    isNodesOpen: true\r\n  });\r\n\r\n  onNodesClose = () => this.setState({\r\n    ...this.state,\r\n    isNodesOpen: false\r\n  });\r\n\r\n  onUsersOpen = () => this.setState({\r\n    ...this.state,\r\n    isUsersOpen: true\r\n  });\r\n\r\n  onUsersClose = () => this.setState({\r\n    ...this.state,\r\n    isUsersOpen: false\r\n  });\r\n\r\n  onLogDownloadOpen = () => this.setState({\r\n    ...this.state,\r\n    isLogDownloadOpen: true\r\n  });\r\n\r\n  onLogDownloadClose = () => this.setState({\r\n    ...this.state,\r\n    isLogDownloadOpen: false,\r\n    logLimit: 5\r\n  });\r\n\r\n  onLogLimitSet = logLimit => {\r\n    if (!isNaN(logLimit)) {\r\n      this.setState({\r\n        ...this.state,\r\n        logLimit: logLimit\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      onLogDownload,\r\n      onCacheClear,\r\n      nodes,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {\r\n      isAppOpen,\r\n      isNodesOpen,\r\n      isUsersOpen,\r\n      appSettingsRef,\r\n      nodesSettingsRef,\r\n      usersSettingsRef,\r\n      isLogDownloadOpen,\r\n      logLimit\r\n    } = this.state;\r\n\r\n    return (\r\n      <Fragment>\r\n        <ButtonSelect value=\"\" icon={<SettingsIcon/>}>\r\n          {canDisplayAppSettingsForm(user) && (\r\n            <div onClick={this.onAppOpen} className={classes.option}>{t(\"components.header.settings.app\")}</div>\r\n          )}\r\n          {canDisplayUsersSettingsForm(user) && (\r\n            <div onClick={this.onUsersOpen} className={classes.option}>{t(\"components.header.settings.users\")}</div>\r\n          )}\r\n          {canDisplayNodesSettingsForm(user) && (\r\n            <div onClick={this.onNodesOpen} className={classes.option}>{t(\"components.header.settings.nodes\")}</div>\r\n          )}\r\n          {canGetQueryLog(user) && (\r\n            <div onClick={this.onLogDownloadOpen} className={classes.option}>{t(\"components.header.settings.queriesLog\")}</div>\r\n          )}\r\n          {canClearServerCache(user) && (\r\n            <div onClick={onCacheClear} className={classes.option}>{t(\"components.header.settings.clearServerCache\")}</div>\r\n          )}\r\n        </ButtonSelect>\r\n        <SettingsDialog\r\n          title={t(\"scenes.appSettings.title\")}\r\n          open={isAppOpen}\r\n          onClose={() => {\r\n            if (appSettingsRef.current) {\r\n              appSettingsRef.current.cancel(() => this.onAppClose());\r\n            } else {\r\n              this.onAppClose();\r\n            }\r\n          }}\r\n          onSubmit={() => {\r\n            if (appSettingsRef.current) {\r\n              appSettingsRef.current.submit(() => {\r\n                this.onAppClose();\r\n              });\r\n            } else {\r\n              this.onAppClose();\r\n            }\r\n          }}\r\n          hasSubmit\r\n        >\r\n          <AppSettingsForm ref={appSettingsRef}/>\r\n        </SettingsDialog>\r\n        <SettingsDialog\r\n          title={t(\"scenes.nodesSettings.title\")}\r\n          open={isNodesOpen}\r\n          onClose={() => {\r\n            if (nodesSettingsRef.current) {\r\n              nodesSettingsRef.current.cancel(() => this.onNodesClose());\r\n            } else {\r\n              this.onNodesClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <NodesSettingsForm ref={nodesSettingsRef} nodes={nodes}/>\r\n        </SettingsDialog>\r\n\r\n        <SettingsDialog\r\n          title={t(\"scenes.usersSettings.title\")}\r\n          open={isUsersOpen}\r\n          onClose={() => {\r\n            if (usersSettingsRef.current) {\r\n              usersSettingsRef.current.cancel(() => this.onUsersClose());\r\n            } else {\r\n              this.onUsersClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <UsersSettingsForm ref={usersSettingsRef} />\r\n        </SettingsDialog>\r\n\r\n        <Dialog\r\n          open={isLogDownloadOpen}\r\n          onClose={this.onLogDownloadClose}\r\n        >\r\n          <DialogContent>\r\n            <Grid container spacing={2} style={{width: 400}}>\r\n              <Grid item xs={12}>\r\n                <div>{t(\"components.header.settings.queriesLogModal.content\")}:</div>\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <Input\r\n                  value={logLimit}\r\n                  onChange={ev => this.onLogLimitSet(ev.target.value)}\r\n                  style={{width: \"100%\"}}\r\n                />\r\n              </Grid>\r\n            </Grid>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={this.onLogDownloadClose}>\r\n              {t(\"commons.confirm.cancel\")}\r\n            </Button>\r\n            <Button\r\n              autoFocus\r\n              onClick={() => {\r\n                this.onLogDownloadClose()\r\n                onLogDownload(logLimit);\r\n              }}\r\n              color=\"primary\">\r\n              {t(\"commons.confirm.download\")}\r\n            </Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(SettingsSelect);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getClearMemoryCacheUrl, getQueryLog} from \"../../serverApi/urls\";\r\n\r\nexport const QUERY_LOG_DOWNLOAD = \"query/log/download\";\r\nexport const MEMORY_CACHE_CLEAR = \"memory/cache/clear\";\r\n\r\nexport const downloadQueryLog = limit => initRequest(\r\n  QUERY_LOG_DOWNLOAD,\r\n  getQueryLog(limit),\r\n  RequestMethod.GET,\r\n  null,\r\n  null,\r\n  {\r\n    fileSave: {\r\n      name: \"sdmx-query-log.txt\",\r\n      type: \"text/plain;charset=utf-8\"\r\n    },\r\n    stringifyResponse: true\r\n  }\r\n);\r\n\r\nexport const clearMemoryCache = () => initRequest(\r\n  MEMORY_CACHE_CLEAR,\r\n  getClearMemoryCacheUrl(),\r\n  RequestMethod.POST,\r\n  null,\r\n  t => ({\r\n    onStart: t(\"components.header.settings.clearServerCacheAction.messages.clear.start\")\r\n  })\r\n);\r\n","import React, {useRef} from 'react';\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\n\r\nconst styles = theme => ({\r\n  button: {\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: \"white\",\r\n    borderColor: theme.palette.primary.main,\r\n    borderWidth: 1,\r\n    position: \"relative\",\r\n    height: 35,\r\n  },\r\n  icon: {\r\n    width: theme.spacing(6),\r\n    height: 35,\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    position: 'absolute',\r\n    width: `calc(100% - ${theme.spacing(6)})`,\r\n    left: theme.spacing(6)\r\n  },\r\n  inputInput: {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n  }\r\n});\r\n\r\nconst SearchInput = ({classes, query = \"\", onSubmit}) => {\r\n\r\n  const input = useRef(null);\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <div className={classes.button} style={{width: 320}}>\r\n      <label htmlFor=\"search-input\" style={{display: \"none\"}}>\r\n        {t(\"components.searchInput.label\")}\r\n      </label>\r\n      <TextField\r\n        id=\"search-input\"\r\n        fullWidth\r\n        size=\"small\"\r\n        variant=\"outlined\"\r\n        placeholder={t(\"components.searchInput.placeholder\")}\r\n        defaultValue={query}\r\n        InputProps={{\r\n          startAdornment:\r\n            <InputAdornment position=\"start\">\r\n              <SearchIcon/>\r\n            </InputAdornment>,\r\n          inputRef: input,\r\n        }}\r\n        onKeyDown={\r\n          e => {\r\n            if (e.key === \"Enter\" && input.current.value && input.current.value.length > 0) {\r\n              e.preventDefault();\r\n              onSubmit(input.current.value);\r\n            }\r\n          }\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(SearchInput);","import React, {useState} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {fade, withStyles} from \"@material-ui/core\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport SearchInput from \"../search-input\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  button: {\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.15),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.25),\r\n    },\r\n    position: \"relative\",\r\n    height: 35,\r\n  },\r\n  icon: {\r\n    width: theme.spacing(6),\r\n    height: 35,\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    position: 'absolute',\r\n    width: `calc(100% - ${theme.spacing(6)})`,\r\n    left: theme.spacing(6)\r\n  },\r\n  inputInput: {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n  }\r\n});\r\n\r\nconst SearchDialog = ({classes, dialogTop, modalWidth, query, onSubmit}) => {\r\n\r\n  const [uuid] = useState(uuidv4());\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  return (\r\n    <div>\r\n      <IconButton color=\"inherit\" onClick={() => setIsOpen(true)}>\r\n        <SearchIcon/>\r\n      </IconButton>\r\n      <Dialog\r\n        open={isOpen}\r\n        onClose={() => setIsOpen(false)}\r\n        onRendered={() => $(`#search-dialog__dialog__${uuid} input`).focus()}\r\n        PaperProps={{\r\n          style: {\r\n            position: \"absolute\",\r\n            top: dialogTop,\r\n            height: 40\r\n          }\r\n        }}\r\n      >\r\n        <div id={`search-dialog__dialog__${uuid}`}>\r\n          <SearchInput\r\n            query={query}\r\n            onSubmit={value => {\r\n              setIsOpen(false);\r\n              onSubmit(value);\r\n            }}\r\n          />\r\n        </div>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(SearchDialog);","export const DASHBOARD_ELEM_TYPE_KEY = \"type\";\r\nexport const DASHBOARD_ELEM_VALUE_KEY = \"value\";\r\nexport const DASHBOARD_ELEM_WIDTH_KEY = \"widthPercentage\";\r\nexport const DASHBOARD_ELEM_SHOW_TITLE_KEY = \"showTitle\";\r\nexport const DASHBOARD_ELEM_ENABLE_FILTERS_KEY = \"enableFilters\";\r\nexport const DASHBOARD_ELEM_FILTER_DIMENSION_KEY = \"filterDimension\";\r\n\r\nexport const DASHBOARD_ELEM_TYPE_VALUE_VIEW = \"view\";\r\nexport const DASHBOARD_ELEM_TYPE_VALUE_TEXT = \"text\";\r\n\r\nexport const emptyDashboardElem = {\r\n  [DASHBOARD_ELEM_TYPE_KEY]: null,\r\n  [DASHBOARD_ELEM_VALUE_KEY]: null,\r\n  [DASHBOARD_ELEM_WIDTH_KEY]: 100,\r\n  [DASHBOARD_ELEM_SHOW_TITLE_KEY]: true,\r\n  [DASHBOARD_ELEM_ENABLE_FILTERS_KEY]: false,\r\n  [DASHBOARD_ELEM_FILTER_DIMENSION_KEY]: null\r\n};\r\n\r\nexport const getViewIdxFromRowAndCol = (rowIdx, colIdx) => `${rowIdx}+${colIdx}`;\r\n\r\nexport const getFilterDimensionId = (layout, filterDimensionIds) => {\r\n  const dimArraysKey = [\"rows\", \"cols\", \"filters\", \"sections\", \"primaryDim\", \"secondaryDim\", \"territoryDim\"];\r\n  let viewDims = [];\r\n\r\n  dimArraysKey.forEach(key => viewDims = viewDims.concat(layout[key] || []));\r\n\r\n  return (filterDimensionIds.find(dimId => viewDims.includes(dimId)) || null);\r\n};","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  getCreateDashboardUrl,\r\n  getDashboardsUrl,\r\n  getDatasetUrl,\r\n  getDeleteDashboardUrl,\r\n  getDeleteViewUrl,\r\n  getGeometryUrl,\r\n  getUpdateDashboardUrl,\r\n  getUserDashboardsUrl,\r\n  getViewsUrl\r\n} from \"../../serverApi/urls\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY\r\n} from \"../../utils/dashboards\";\r\nimport {getCriteriaRequestObject} from \"../../utils/datasets\";\r\nimport _ from \"lodash\"\r\nimport filters from \"../../dummy/filters.json\";\r\n\r\nexport const OTHER_CONFIG_VIEWS_FETCH = \"otherConfig/fetchViews\";\r\nexport const OTHER_CONFIG_VIEWS_CLEAR = \"otherConfig/clearViews\";\r\nexport const OTHER_CONFIG_VIEW_DELETE = \"otherConfig/deleteView\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARDS_FETCH = \"otherConfig/fetchDashboards\";\r\nexport const OTHER_CONFIG_DASHBOARDS_CLEAR = \"otherConfig/clearDashboards\";\r\nexport const OTHER_CONFIG_DASHBOARDS_CLOSE = \"otherConfig/closeDashboards\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_CREATE = \"otherConfig/dashboard/create\";\r\nexport const OTHER_CONFIG_DASHBOARD_UPDATE = \"otherConfig/dashboard/update\";\r\nexport const OTHER_CONFIG_DASHBOARD_CHANGE = \"otherConfig/dashboard/change\";\r\nexport const OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT = \"otherConfig/dashboard/create/submit\";\r\nexport const OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT = \"otherConfig/dashboard/update/submit\";\r\nexport const OTHER_CONFIG_DASHBOARD_HIDE = \"otherConfig/dashboard/hide\";\r\nexport const OTHER_CONFIG_DASHBOARD_DELETE = \"otherConfig/dashboard/create\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_VIEWS_FETCH = \"otherConfig/dashboard/views/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR = \"otherConfig/dashboard/views/clear\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_DATASET_FETCH = \"otherConfig/dashboard/dataset/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH = \"otherConfig/dashboard/map/geometry/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_DATASET_CLEAR = \"otherConfig/dashboard/dataset/clear\";\r\n\r\nexport const fetchOtherConfigViews = () => initRequest(\r\n  OTHER_CONFIG_VIEWS_FETCH,\r\n  getViewsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.viewsConfig.messages.fetchViews.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigViews = () => ({\r\n  type: OTHER_CONFIG_VIEWS_CLEAR\r\n});\r\n\r\nexport const deleteOtherConfigView = (nodeId: number, id: number) => initRequest(\r\n  OTHER_CONFIG_VIEW_DELETE,\r\n  getDeleteViewUrl(nodeId, id),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.viewsConfig.messages.deleteView.start\")\r\n  })\r\n);\r\n\r\nexport const fetchOtherConfigDashboards = () => initRequest(\r\n  OTHER_CONFIG_DASHBOARDS_FETCH,\r\n  getUserDashboardsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboards.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigDashboards = () => ({\r\n  type: OTHER_CONFIG_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const closeOtherConfigDashboard = () => ({\r\n  type: OTHER_CONFIG_DASHBOARDS_CLOSE\r\n});\r\n\r\nexport const createOtherConfigDashboard = (dashboard: any) => ({\r\n  type: OTHER_CONFIG_DASHBOARD_CREATE,\r\n  payload: {\r\n    dashboard: dashboard\r\n  }\r\n});\r\n\r\nexport const updateOtherConfigDashboard = (dashboardId: number) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_UPDATE,\r\n  getDashboardsUrl(dashboardId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboard.start\")\r\n  })\r\n);\r\n\r\nexport const changeOtherConfigDashboard = (dashboard: any) => ({\r\n  type: OTHER_CONFIG_DASHBOARD_CHANGE,\r\n  payload: {\r\n    dashboard: dashboard\r\n  }\r\n});\r\n\r\nconst getNewDashboard = (dashboard: any, dashboardId?: number) => {\r\n  const newDashboard = _.cloneDeep(dashboard);\r\n  const ids: string[] = [];\r\n\r\n  newDashboard.dashboardConfig.forEach((row: any, rowIdx: number) => {\r\n    row.forEach((col: any, colIdx: number) => {\r\n      const type = col[DASHBOARD_ELEM_TYPE_KEY];\r\n      const value = col[DASHBOARD_ELEM_VALUE_KEY];\r\n      const filterDimension = col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY]\r\n\r\n      if (type === DASHBOARD_ELEM_TYPE_VALUE_VIEW && value !== null && value !== undefined && !ids.includes(value)) {\r\n        ids.push(value)\r\n      }\r\n      if (filterDimension === \"\") {\r\n        newDashboard.dashboardConfig[rowIdx][colIdx].filterDimension = null;\r\n      }\r\n    });\r\n  });\r\n\r\n  let newFilterLevels = {};\r\n  filters.labels.forEach((label: string) => {\r\n    newFilterLevels = {\r\n      ...newFilterLevels,\r\n      [label]: (newDashboard.filterLevels[label] || false)\r\n    }\r\n  });\r\n\r\n  return {\r\n    dashboardId: dashboardId,\r\n    title: newDashboard.title,\r\n    dashboardConfig: JSON.stringify(newDashboard.dashboardConfig),\r\n    viewIds: ids,\r\n    filterLevels: JSON.stringify(newFilterLevels)\r\n  }\r\n};\r\n\r\nexport const submitOtherConfigDashboardCreate = (dashboard: any) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT,\r\n  getCreateDashboardUrl(),\r\n  RequestMethod.POST,\r\n  getNewDashboard(dashboard),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.submitDashboardCreate.start\")\r\n  })\r\n);\r\n\r\nexport const submitOtherConfigDashboardUpdate = (dashboardId: number, dashboard: any) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  getUpdateDashboardUrl(dashboardId),\r\n  RequestMethod.PUT,\r\n  getNewDashboard(dashboard, dashboardId),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.submitDashboardUpdate.start\")\r\n  })\r\n);\r\n\r\nexport const deleteOtherConfigDashboard = (dashboardId: number) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_DELETE,\r\n  getDeleteDashboardUrl(dashboardId),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.deleteDashboard.start\")\r\n  })\r\n);\r\n\r\nexport const hideOtherConfigDashboard = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_HIDE\r\n});\r\n\r\nexport const fetchOtherConfigDashboardViews = () => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_FETCH,\r\n  getViewsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboardViews.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigDashboardViews = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR\r\n});\r\n\r\nexport const fetchOtherConfigDashboardsDataset = (nodeId: number, datasetId: string, criteria: any, requestIds: string[]) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_DATASET_FETCH,\r\n  getDatasetUrl(nodeId, datasetId),\r\n  RequestMethod.POST,\r\n  getCriteriaRequestObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDataset\")\r\n  }),\r\n  {\r\n    requestIds: requestIds,\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const fetchOtherConfigDashboardsMapGeometries = (idList: string[], requestId: string) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dashboard.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    requestId: requestId\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const clearOtherConfigDashboardsDataset = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_DATASET_CLEAR\r\n});","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {Visibility} from \"@material-ui/icons\";\r\nimport {\r\n  clearOtherConfigViews,\r\n  deleteOtherConfigView,\r\n  fetchOtherConfigViews\r\n} from \"../../../state/otherConfig/otherConfigActions\";\r\nimport {goToData} from \"../../../links\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  views: state.otherConfig.views\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchViews: () => dispatch(fetchOtherConfigViews()),\r\n  clearViews: () => dispatch(clearOtherConfigViews()),\r\n  deleteView: (nodeId, id) => dispatch(deleteOtherConfigView(nodeId, id))\r\n});\r\n\r\nconst ViewsSettingsForm = ({classes, defaultLanguage, languages, views, fetchViews, clearViews, deleteView, nodes}, ref) => {\r\n\r\n  const [needViews, setNeedViews] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needViews) {\r\n      setNeedViews(false);\r\n      fetchViews();\r\n    }\r\n  }, [views, needViews, setNeedViews, fetchViews]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearViews();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [deleteViewId, setDeleteViewId] = useState(null);\r\n  const [deleteViewNodeId, setDeleteViewNodeId] = useState(null);\r\n\r\n  return nodes && views && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"nodeId\",\r\n            title: t(\"scenes.viewsSettings.table.columns.viewNodeId\"),\r\n            render: ({nodeId}) => nodes.find(node => node.nodeId === nodeId).code,\r\n            customFilterAndSearch: (str, {nodeId}) =>\r\n              nodes.find(node => node.nodeId === nodeId).code.toLowerCase()\r\n                .includes(str.toLowerCase())\r\n          },\r\n          {field: \"datasetId\", title: t(\"scenes.viewsSettings.table.columns.viewDatasetId\")},\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.viewsSettings.table.columns.viewTitle\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          },\r\n        ]}\r\n        data={views}\r\n        actions={[\r\n          ({\r\n            icon: Visibility,\r\n            tooltip: t(\"scenes.viewsSettings.table.actions.viewView\"),\r\n            onClick: (_, {nodeId, datasetId, viewTemplateId}) => goToData(nodes.find(node => node.nodeId === nodeId).code, [], datasetId, viewTemplateId)\r\n          }),\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.viewsSettings.table.actions.deleteView\"),\r\n            onClick: (_, {nodeId, viewTemplateId}) => {\r\n              setDeleteViewId(viewTemplateId);\r\n              setDeleteViewNodeId(nodeId);\r\n            }\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 3,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteViewId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.viewsSettings.modals.deleteView.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.viewsSettings.modals.deleteView.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setDeleteViewId(null);\r\n            setDeleteViewNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteView(deleteViewNodeId, deleteViewId);\r\n            setDeleteViewId(null);\r\n            setDeleteViewNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(ViewsSettingsForm);","const $ = window.jQuery;\r\n\r\n/* https://stackoverflow.com/questions/986937/how-can-i-get-the-browsers-scrollbar-sizes */\r\nexport function getScrollBarWidth() {\r\n  const temp = $('<div>').css({visibility: 'hidden', width: 100, overflow: 'scroll'}).appendTo('body');\r\n  const widthWithScroll = $('<div>').css({width: '100%'}).appendTo(temp).outerWidth();\r\n  temp.remove();\r\n  return 100 - widthWithScroll;\r\n}\r\n\r\nexport function getTextWidth(text, element) {\r\n  if (typeof (text) === \"string\" && text.length > 0) {\r\n    element.innerText = text;\r\n    return element.offsetWidth;\r\n  } else {\r\n    return 0;\r\n  }\r\n}\r\n","import React, {Fragment} from 'react';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport \"./style.css\";\r\n\r\nexport const SORT_DIRECTION_ASC = 'SORT_DIRECTION_ASC';\r\nexport const SORT_DIRECTION_DESC = 'SORT_DIRECTION_DESC';\r\n\r\nconst SortButtons = ({\r\n                       value,\r\n                       onChange\r\n                     }) =>\r\n  <Fragment>\r\n    <div className=\"infinite-scroll-table__header__sort-buttons__icon-container\">\r\n      <IconButton\r\n        onClick={() => onChange(value !== SORT_DIRECTION_ASC ? SORT_DIRECTION_ASC : SORT_DIRECTION_DESC)}\r\n        style={{padding: 4, top: -4}}\r\n      >\r\n        {\r\n          value === SORT_DIRECTION_ASC\r\n            ? <ArrowUpwardIcon className=\"infinite-scroll-table__header__icon\"/>\r\n            : <ArrowDownwardIcon className=\"infinite-scroll-table__header__icon\"/>\r\n        }\r\n      </IconButton>\r\n    </div>\r\n  </Fragment>;\r\n\r\nexport default SortButtons;\r\n","export const DEFAULT_TABLE_HEIGHT = 340;\r\nexport const ROW_HEIGHT = 40;\r\nexport const TABLE_TOTAL_BORDER = 2;\r\n\r\nexport const ACTIONS_GUTTER = 4;\r\nexport const ACTION_WIDTH = 24;\r\nexport const CELL_PADDING = 8;\r\nexport const CHECKBOX_WIDTH = 40;\r\nexport const COL_WIDTH_SAFE = 4;\r\nexport const HEADER_CELL_PADDING = 8;\r\nexport const HEADER_CELL_GUTTER = 4;\r\nexport const HEADER_CELL_CONTROLS_GUTTER = 4;\r\nexport const FILTER_BUTTON_WIDTH = 16;\r\nexport const SORT_BUTTON_WIDTH = 16;\r\n\r\nexport const DATA_INDEX_ACTIONS_OBJS = \"_actions\";\r\nexport const DATA_INDEX_FIXED_ACTIONS_OBJS = \"_fixedActions\";\r\nexport const DATA_INDEX_CHECKED = \"_checked\";\r\nexport const DATA_INDEX_RENDERED = \"__rendered\";\r\nexport const DATA_INDEX_ORIGINAL_ROW = \"__originalRow\";\r\nexport const DATA_INDEX_ORIGINAL_TRANSLATED_ROW = \"__originalTranslatedRow\";\r\n\r\nexport const RESIZE_TIMEOUT = 1000;\r\nexport const PAGINATION_TIMEOUT = 500;\r\nexport const VIEW_INDEXES_UPDATE_TIMEOUT = 200;\r\n\r\nexport const MAX_PAGE_SIZE = 200;\r\n\r\nexport const DEFAULT_PAGE_SIZE = Math.floor(MAX_PAGE_SIZE / 3) * 3;\r\nexport const DEFAULT_PAGE_NUM = 1;\r\n\r\nexport const TABLE_PLACEHOLDER_BGCOLOR = \"#fafafa\";\r\n","export const getIndexesFromPaginationParams = (pageSize, pageNum) => ({\r\n  startIdx: pageSize * (pageNum - 1),\r\n  stopIdx: (pageSize * pageNum) - 1\r\n});\r\n\r\nexport const getPaginationParamsFromIndexes = (startIdx, stopIdx, maxIdx) => {\r\n\r\n  const minPageSize = stopIdx - startIdx + 1;\r\n  const maxPageSize = maxIdx + 1;\r\n\r\n  const pageNumForMinPageSize = (stopIdx + 1) / minPageSize;\r\n\r\n  if (Number.isInteger(pageNumForMinPageSize)) {\r\n    return ({\r\n      pageSize: minPageSize,\r\n      pageNum: pageNumForMinPageSize\r\n    });\r\n  } else {\r\n\r\n    for (let pageSize = minPageSize + 1; pageSize <= maxPageSize; pageSize++) {\r\n\r\n      const minPageNum = Math.ceil((stopIdx + 1) / pageSize);\r\n      const maxPageNum = Math.floor((startIdx / pageSize) + 1);\r\n\r\n      for (let pageNum = minPageNum; pageNum <= maxPageNum; pageNum++) {\r\n\r\n        const indexes = getIndexesFromPaginationParams(pageSize, pageNum);\r\n\r\n        if (indexes.startIdx <= startIdx && stopIdx <= indexes.stopIdx) {\r\n          return ({\r\n            pageSize,\r\n            pageNum\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n","import React from 'react';\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst AUTO_SEARCH_INPUT_TIMEOUT = 500;\r\n\r\nclass AutoSearchInput extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      tempValue: props.value || \"\",\r\n      value: props.value || \"\",\r\n      timeout: null\r\n    };\r\n    this.onChange = this.onChange.bind(this);\r\n    this.onClear = this.onClear.bind(this);\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, state) {\r\n\r\n    if (nextProps.value !== undefined && (nextProps.value !== state.value)) {\r\n      if (state.timeout) {\r\n        clearTimeout(state.timeout)\r\n      }\r\n      return ({\r\n        tempValue: null,\r\n        value: nextProps.value\r\n      });\r\n    } else {\r\n      return null;\r\n    }\r\n\r\n  }\r\n\r\n  onClear() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n    this.setState({\r\n      tempValue: null,\r\n      value: \"\",\r\n      timeout: null\r\n    });\r\n    this.props.onSearch(\"\");\r\n  }\r\n\r\n  onChange(value) {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n    this.setState({\r\n      tempValue: value,\r\n      timeout: setTimeout(\r\n        () => {\r\n          this.setState({\r\n            tempValue: null,\r\n            value\r\n          });\r\n          this.props.onSearch(value);\r\n        },\r\n        AUTO_SEARCH_INPUT_TIMEOUT\r\n      ),\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      t,\r\n      placeholder\r\n    } = this.props;\r\n\r\n    const {\r\n      tempValue,\r\n      value\r\n    } = this.state;\r\n\r\n    return (\r\n      <TextField\r\n        value={tempValue !== null ? tempValue : value}\r\n        placeholder={placeholder || (t(\"components.autoSearchInput.placeholder\") + \"...\")}\r\n        onChange={({target}) => this.onChange(target.value)}\r\n        InputProps={{\r\n          startAdornment: (\r\n            <InputAdornment position=\"start\">\r\n              <SearchIcon/>\r\n            </InputAdornment>\r\n          ),\r\n          endAdornment: (\r\n            <InputAdornment position=\"end\">\r\n              <IconButton\r\n                disabled={!value || value.length === 0}\r\n                onClick={this.onClear}\r\n                style={{padding: 6}}\r\n              >\r\n                <ClearIcon fontSize=\"small\"/>\r\n              </IconButton>\r\n            </InputAdornment>\r\n          )\r\n        }}\r\n        style={{width: \"100%\"}}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default withTranslation()(AutoSearchInput);\r\n","import React, {Fragment} from \"react\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport AutoSearchInput from \"../../auto-search-input\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nconst PreHeader = ({\r\n                     t,\r\n                     searchText,\r\n                     onSearch,\r\n                     selectedRowCount,\r\n                     tableActions,\r\n                     renderTableAction,\r\n                     leftActions,\r\n                     rightActions\r\n                   }) =>\r\n  <Grid container style={{marginBottom: 4}}>\r\n    <Grid item xs={6}>\r\n      <Grid container justify=\"space-between\">\r\n        <Grid item>\r\n          {leftActions}\r\n        </Grid>\r\n        <Grid item>\r\n          <Grid container justify=\"flex-end\">\r\n            {tableActions && selectedRowCount > 0 && (\r\n              <Fragment>\r\n                <Grid item style={{padding: \"14px 16px 14px 8px\"}}>\r\n                  {selectedRowCount > 1\r\n                    ? t(\"components.infiniteScrollTable.preHeader.selectedCount_plural\", {selectedRowCount})\r\n                    : t(\"components.infiniteScrollTable.preHeader.selectedCount\", {selectedRowCount})\r\n                  }\r\n                </Grid>\r\n                {tableActions.map((action, index) =>\r\n                  <Grid item key={index}>\r\n                    {renderTableAction(action)}\r\n                  </Grid>\r\n                )}\r\n              </Fragment>\r\n            )}\r\n            {rightActions && (\r\n              <Grid item>\r\n                {rightActions}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n    <Grid item xs={6} style={{padding: \"8px 0\"}}>\r\n      <AutoSearchInput\r\n        value={searchText}\r\n        onSearch={onSearch}\r\n      />\r\n    </Grid>\r\n\r\n  </Grid>;\r\n\r\nexport default withTranslation()(PreHeader);\r\n","import React from \"react\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\n\r\nconst Footer = ({\r\n                  t,\r\n                  isLoading,\r\n                  isHidden,\r\n                  rowNumStart,\r\n                  rowNumEnd,\r\n                  rowCount\r\n                }) =>\r\n  <Grid container justify=\"flex-end\" style={{marginTop: 8}}>\r\n    <Grid item>\r\n      {!isHidden\r\n        ? (\r\n          isLoading\r\n            ? (\r\n              <CircularProgress\r\n                size=\"small\"\r\n                className=\"infinite-scroll-table__footer__spinner\"\r\n                style={{\r\n                  fontSize: 10,\r\n                  width: 13,\r\n                  height: 13,\r\n                  marginRight: 2\r\n                }}\r\n              />\r\n            )\r\n            : t(\"components.infiniteScrollTable.footer.rowCount\", {rowNumStart, rowNumEnd, rowCount})\r\n        )\r\n        : <span/>\r\n      }\r\n    </Grid>\r\n  </Grid>;\r\n\r\nexport default withTranslation()(Footer);\r\n","import React from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"relative\",\r\n    height: \"100%\"\r\n  },\r\n  text: {\r\n    fontStyle: \"italic\",\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%)\"\r\n  },\r\n  image: {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -100%)\",\r\n    paddingBottom: 16\r\n  }\r\n});\r\n\r\nconst CustomEmpty = ({\r\n  t,\r\n                       classes,\r\n                       text,\r\n                       textStyle,\r\n                       width,\r\n                       backgroundColor,\r\n                       color,\r\n                       image\r\n                     }) =>\r\n  <div className={classes.root} style={{width: width || \"100%\", backgroundColor, color}}>\r\n    <div style={{width: width || \"100%\"}}>\r\n      {image && (\r\n        <div className={classes.image}>\r\n          {image}\r\n        </div>\r\n      )}\r\n      <div className={classes.text} style={{...textStyle}}>\r\n        {text || t(\"components.customEmpty.placeholder\")}\r\n      </div>\r\n    </div>\r\n  </div>;\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(CustomEmpty);\r\n","import React, {Fragment, useState} from 'react';\r\nimport \"./style.css\";\r\nimport AutoSearchInput from \"../../auto-search-input\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Popover from \"@material-ui/core/Popover\";\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\n\r\nconst FilterButton = ({\r\n                        value,\r\n                        onChange,\r\n                        options\r\n                      }) => {\r\n\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n\r\n  const handleOpen = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <div className=\"infinite-scroll-table__header__filter-button__icon-container\">\r\n        <IconButton\r\n          onClick={handleOpen}\r\n          style={{padding: 4, top: -4}}\r\n        >\r\n          <FilterListIcon className=\"infinite-scroll-table__header__icon\"/>\r\n        </IconButton>\r\n      </div>\r\n\r\n      <Popover\r\n        open={Boolean(anchorEl)}\r\n        anchorEl={anchorEl}\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'center',\r\n        }}\r\n        transformOrigin={{\r\n          vertical: 'top',\r\n          horizontal: 'center',\r\n        }}\r\n        onClose={handleClose}\r\n      >\r\n        {options && options.length\r\n          ? (\r\n            options.map((option, index) =>\r\n              <Grid\r\n                container\r\n                className=\"infinite-scroll-table__header__filter-button__option\"\r\n                key={index}\r\n              >\r\n                <Grid item>\r\n                  <Checkbox\r\n                    checked={(value || []).find(val => val === option.value) !== undefined}\r\n                    onChange={({target}) => target.checked\r\n                      ? onChange([...(value || []), option.value])\r\n                      : onChange((value || []).filter(val => val !== option.value))\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item>\r\n                  <div style={{height: 42, lineHeight: \"42px\", marginRight: 16}}>\r\n                    {option.text}\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n          )\r\n          : (\r\n            <div style={{padding: 8}}>\r\n              <AutoSearchInput onSearch={onChange} value={value}/>\r\n            </div>\r\n          )\r\n        }\r\n      </Popover>\r\n\r\n    </Fragment>\r\n  )\r\n};\r\n\r\nexport default FilterButton;\r\n","import React, {Component, Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport \"./style.css\";\r\nimport {getScrollBarWidth, getTextWidth} from \"../../utils/style\";\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport SortButtons, {SORT_DIRECTION_ASC, SORT_DIRECTION_DESC} from './sort-buttons';\r\nimport _ from \"lodash\";\r\nimport {FixedSizeList} from \"react-window\";\r\nimport {\r\n  ACTION_WIDTH,\r\n  ACTIONS_GUTTER,\r\n  CELL_PADDING,\r\n  CHECKBOX_WIDTH,\r\n  COL_WIDTH_SAFE,\r\n  DATA_INDEX_ACTIONS_OBJS,\r\n  DATA_INDEX_CHECKED,\r\n  DATA_INDEX_FIXED_ACTIONS_OBJS,\r\n  DATA_INDEX_ORIGINAL_ROW,\r\n  DATA_INDEX_ORIGINAL_TRANSLATED_ROW,\r\n  DATA_INDEX_RENDERED,\r\n  DEFAULT_PAGE_NUM,\r\n  DEFAULT_PAGE_SIZE,\r\n  DEFAULT_TABLE_HEIGHT,\r\n  FILTER_BUTTON_WIDTH,\r\n  HEADER_CELL_CONTROLS_GUTTER,\r\n  HEADER_CELL_GUTTER,\r\n  HEADER_CELL_PADDING,\r\n  MAX_PAGE_SIZE,\r\n  PAGINATION_TIMEOUT,\r\n  RESIZE_TIMEOUT,\r\n  ROW_HEIGHT,\r\n  SORT_BUTTON_WIDTH,\r\n  TABLE_TOTAL_BORDER,\r\n  VIEW_INDEXES_UPDATE_TIMEOUT\r\n} from \"./contants\";\r\nimport {getIndexesFromPaginationParams, getPaginationParamsFromIndexes} from \"./utils\";\r\nimport PreHeader from \"./pre-header\";\r\nimport Footer from \"./footer\";\r\nimport {withSize} from \"react-sizeme\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport FilterButton from \"./filter-button\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nexport const numberStringSorter = (a, b) => Number(a) - Number(b);\r\n\r\nclass InfiniteScrollTable extends Component {\r\n\r\n  constructor(props) {\r\n\r\n    super(props);\r\n\r\n    this.onSearchTextChange = this.onSearchTextChange.bind(this);\r\n    this.onFiltersChange = this.onFiltersChange.bind(this);\r\n    this.onSortChange = this.onSortChange.bind(this);\r\n    this.getSelectedRowKeys = this.getSelectedRowKeys.bind(this);\r\n    this.onRowSelectionChange = this.onRowSelectionChange.bind(this);\r\n    this.getCols = this.getCols.bind(this);\r\n    this.getNormalizedTableActions = this.getNormalizedTableActions.bind(this);\r\n    this.renderActions = this.renderActions.bind(this);\r\n    this.renderGridRow = this.renderGridRow.bind(this);\r\n    this.renderFixedActions = this.renderFixedActions.bind(this);\r\n    this.renderHeaderCells = this.renderHeaderCells.bind(this);\r\n    this.renderCheckboxTitle = this.renderCheckboxTitle.bind(this);\r\n    this.renderCheckbox = this.renderCheckbox.bind(this);\r\n    this.getPopulatedRows = this.getPopulatedRows.bind(this);\r\n    this.getColWidths = this.getColWidths.bind(this);\r\n    this.getQueriedRows = this.getQueriedRows.bind(this);\r\n    this.getRenderedRows = this.getRenderedRows.bind(this);\r\n    this.onRenderedRowsChange = this.onRenderedRowsChange.bind(this);\r\n\r\n    this.state = {\r\n      uuid: uuidv4(),\r\n\r\n      gridKeyForRefresh: uuidv4(),\r\n      scrollTop: 0,\r\n      scrollLeft: 0,\r\n\r\n      gridScrollbarWidth: getScrollBarWidth(),\r\n\r\n      searchText: \"\",\r\n      sortCol: null,\r\n      sortByDesc: false,\r\n      filters: {},\r\n\r\n      selectedRowKeys:\r\n        props.rowSelection && props.rowSelection.selectedRowKeys\r\n          ? props.rowSelection.selectedRowKeys\r\n          : [],\r\n\r\n      cols: null,\r\n\r\n      populatedRows: null,\r\n\r\n      colWidths: null,\r\n\r\n      renderedRows: null,\r\n\r\n      queriedRows: null,\r\n\r\n      isResizing: false,\r\n      resizeTimeout: null,\r\n\r\n      pageSize: null,\r\n      pageNum: null,\r\n      pageRequestTimeout: null,\r\n\r\n      isPaginating: props.isPaginated,\r\n      pageRequestParams: null,\r\n\r\n      viewStartIdx: null,\r\n      viewEndIdx: null,\r\n      viewIndexesUpdateTimeout: null,\r\n\r\n      doNotCallOnChangeOnNextRenderedRowsChange: false\r\n    };\r\n\r\n    if (props.isPaginated) {\r\n      this.state.pageRequestParams = {\r\n        pageSize: DEFAULT_PAGE_SIZE,\r\n        pageNum: DEFAULT_PAGE_NUM,\r\n        filters: this.state.filters,\r\n        searchText: this.state.searchText,\r\n        sortCol: this.state.sortCol,\r\n        sortByDesc: this.state.sortByDesc\r\n      };\r\n    }\r\n\r\n    if (props.onChange && props.isPaginated) {\r\n      props.onChange(this.state.pageRequestParams);\r\n    }\r\n  }\r\n\r\n  static isValuePassingSearchText(value, searchText) {\r\n    return String(value).toLowerCase().includes(searchText.toLowerCase())\r\n  }\r\n\r\n  static defaultSorter = (a, b, isDesc) => {\r\n\r\n    const normalize = val => typeof (val) === \"string\" ? val.toLowerCase() : Number(val);\r\n    const _a = normalize(a);\r\n    const _b = normalize(b);\r\n\r\n    return (isDesc ? (_b < _a) : (_a < _b)) ? -1 : 1\r\n  };\r\n\r\n  static isArrayPropertyChangedLazy(prevProp, prop) {\r\n    return (\r\n      (prevProp !== prop) ||\r\n      ((prevProp === null || prevProp === undefined) && prop !== null && prop !== undefined) ||\r\n      (prevProp && prop && prevProp.length !== prop.length)\r\n    );\r\n  }\r\n\r\n  /* === Hooks === */\r\n\r\n  getPopulatedRows(rows) {\r\n\r\n    const {\r\n      defaultLanguage,\r\n      languages,\r\n      multilangStrDataIndexes,\r\n      actions,\r\n      fixedActions,\r\n      altActions,\r\n      getIsAltRow\r\n    } = this.props;\r\n\r\n    const getActionsObjs = (actions, row) =>\r\n      (actions || [])\r\n        .filter(action => action !== null)\r\n        .map(action => typeof (action) === \"function\" ? action(row) : action)\r\n        .filter(action => action !== null)\r\n        .map(action => ({...action, row}));\r\n\r\n    return (rows !== null && rows !== undefined)\r\n      ? rows.map(row => {\r\n\r\n        const populatedRow = {...row};\r\n\r\n        populatedRow[DATA_INDEX_ORIGINAL_ROW] = {...populatedRow};\r\n\r\n        if (multilangStrDataIndexes) {\r\n          for (let dataIndex of multilangStrDataIndexes) {\r\n            populatedRow[dataIndex] = localizeI18nObj(populatedRow[dataIndex], defaultLanguage, languages);\r\n          }\r\n        }\r\n\r\n        populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW] = {...populatedRow};\r\n\r\n        populatedRow[DATA_INDEX_FIXED_ACTIONS_OBJS] =\r\n          fixedActions\r\n            ? getActionsObjs(fixedActions, populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW])\r\n            : null;\r\n\r\n        populatedRow[DATA_INDEX_ACTIONS_OBJS] =\r\n          (actions || altActions)\r\n            ? getActionsObjs(\r\n            (getIsAltRow && getIsAltRow(populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW])) ? altActions : actions,\r\n            populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW]\r\n            )\r\n            : null;\r\n\r\n        return populatedRow;\r\n\r\n      })\r\n      : null;\r\n  }\r\n\r\n  getColWidths(rows, cols) {\r\n\r\n    const {\r\n      size\r\n    } = this.props;\r\n\r\n    const {\r\n      gridScrollbarWidth\r\n    } = this.state;\r\n\r\n    if (cols === null) {\r\n      return null;\r\n    }\r\n\r\n    const getTextWidthEl = $('<span>').css({visibility: 'hidden', position: 'absolute'}).appendTo('body').get(0);\r\n\r\n    let colWidths = cols.map(col => {\r\n\r\n      let colWidth = 0;\r\n\r\n      const colTitleWidth =\r\n        getTextWidth(col.title, getTextWidthEl) +\r\n        ((!col.noFilter || !col.noSort) ? HEADER_CELL_GUTTER : 0) +\r\n        (col.noFilter ? 0 : FILTER_BUTTON_WIDTH) +\r\n        (col.noSort ? 0 : SORT_BUTTON_WIDTH) +\r\n        ((!col.noFilter && !col.noSort) ? HEADER_CELL_CONTROLS_GUTTER : 0) +\r\n        CELL_PADDING * 2 + COL_WIDTH_SAFE;\r\n\r\n      if (col.width) {\r\n\r\n        colWidth = Math.max(colTitleWidth, col.width);\r\n\r\n      } else if ((col.widthToContent || col.minWidthToContent) && rows.length > 0) {\r\n\r\n        colWidth = Math.max(\r\n          colTitleWidth,\r\n          ...rows.map(row =>\r\n            getTextWidth(\r\n              col.renderText\r\n                ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][col.dataIndex])\r\n                : row[col.dataIndex],\r\n              getTextWidthEl\r\n            ) +\r\n            (CELL_PADDING * 2) +\r\n            COL_WIDTH_SAFE\r\n          )\r\n        );\r\n\r\n      } else if (col.minWidth) {\r\n\r\n        colWidth = Math.max(colTitleWidth, col.minWidth);\r\n\r\n      } else {\r\n\r\n        colWidth = colTitleWidth;\r\n\r\n      }\r\n\r\n      return colWidth;\r\n    });\r\n\r\n    $(getTextWidthEl).remove();\r\n\r\n    const isVariableSizeCol = col => !col.width && (rows.length > 0 ? !col.widthToContent : true);\r\n    const variableSizeCols = cols.filter(isVariableSizeCol);\r\n\r\n    let colWidthsSum = 0;\r\n    colWidths.forEach(width => colWidthsSum += width);\r\n\r\n    const availableWidth = size.width - colWidthsSum -\r\n      ((rows !== null && this.getIsVerticalScrollbarVisible(rows.length)) ? gridScrollbarWidth : 0) -\r\n      TABLE_TOTAL_BORDER;\r\n\r\n    if (variableSizeCols.length > 0 && availableWidth > 0) {\r\n\r\n      const widthToAdd = availableWidth / variableSizeCols.length;\r\n\r\n      colWidths = colWidths.map((colWidth, colIndex) =>\r\n        isVariableSizeCol(cols[colIndex])\r\n          ? colWidth + widthToAdd\r\n          : colWidth\r\n      );\r\n    }\r\n\r\n    return colWidths;\r\n  }\r\n\r\n  getRenderedRows(rows, cols, colsWidths, selectedRowKeys) {\r\n\r\n    const {\r\n      rowSelection,\r\n      tableActions,\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    return rows !== null\r\n      ? rows.map(row => {\r\n\r\n        const resRow = {...row};\r\n\r\n        if (rowSelection || tableActions) {\r\n          resRow[DATA_INDEX_CHECKED] = selectedRowKeys.includes(getRowKey(row))\r\n        }\r\n\r\n        return ({\r\n          ...resRow,\r\n          [DATA_INDEX_RENDERED]: this.renderGridRow(resRow, cols, colsWidths)\r\n        });\r\n      })\r\n      : null;\r\n  }\r\n\r\n  getQueriedRows(rows, cols, filters, searchText, sortCol, sortByDesc) {\r\n\r\n    const {\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    if (isPaginated) {\r\n      return rows;\r\n    } else {\r\n      let queriedRows = this.getFilteredGridRows(rows, cols, filters);\r\n      queriedRows = this.getSearchTextFilteredGridRows(queriedRows, cols, searchText);\r\n      return this.getSortedGridRows(queriedRows, cols, sortCol, sortByDesc);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    const {\r\n      data,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    if (data !== null) {\r\n      const cols = this.getCols();\r\n      const populatedRows = this.getPopulatedRows(data);\r\n      const colWidths = this.getColWidths(populatedRows, cols);\r\n      const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, this.getSelectedRowKeys());\r\n      const queriedRows = this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc, isPaginated);\r\n\r\n      this.setState({\r\n        cols,\r\n        populatedRows,\r\n        colWidths,\r\n        renderedRows,\r\n        queriedRows\r\n      });\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n\r\n    const {\r\n      isPaginated,\r\n      rowSelection,\r\n      data\r\n    } = this.props;\r\n\r\n    const {\r\n      uuid,\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc,\r\n      scrollLeft,\r\n      scrollTop,\r\n      resizeTimeout,\r\n      colWidths,\r\n      cols,\r\n      pageSize,\r\n      pageNum,\r\n      pageRequestParams\r\n    } = this.state;\r\n\r\n    if (InfiniteScrollTable.isArrayPropertyChangedLazy(prevProps.data, data)) { // todo: check for lang change\r\n\r\n      let newCols = null;\r\n      let newPopulatedRows = null;\r\n      let newColWidths = null;\r\n      let newRenderedRows = null;\r\n      let newQueriedRows = null;\r\n      let newScrollTop = null;\r\n\r\n      if (data !== null) {\r\n\r\n        newCols = this.getCols();\r\n        newPopulatedRows = this.getPopulatedRows(this.props.data);\r\n\r\n        newColWidths =\r\n          colWidths !== null && cols !== null && (\r\n            (prevProps.data === null && data === null) ||\r\n            ((prevProps.data !== null && prevProps.data.length === 0) && (data !== null && data.length === 0))\r\n          )\r\n            ? colWidths\r\n            : this.getColWidths(newPopulatedRows, newCols);\r\n        newRenderedRows = this.getRenderedRows(newPopulatedRows, newCols, newColWidths, this.getSelectedRowKeys());\r\n        newQueriedRows = this.getQueriedRows(\r\n          newRenderedRows,\r\n          newCols,\r\n          filters,\r\n          searchText,\r\n          sortCol,\r\n          sortByDesc\r\n        );\r\n      } else {\r\n\r\n        const $grid = $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid`);\r\n        if ($grid) {\r\n          newScrollTop = $grid.scrollTop();\r\n        }\r\n      }\r\n\r\n      this.setState({\r\n        cols: newCols,\r\n        populatedRows: newPopulatedRows,\r\n        colWidths: newColWidths,\r\n        renderedRows: newRenderedRows,\r\n        queriedRows: newQueriedRows,\r\n        pageNum: isPaginated && pageRequestParams ? pageRequestParams.pageNum : pageNum,\r\n        pageSize: isPaginated && pageRequestParams ? pageRequestParams.pageSize : pageSize,\r\n        isPaginating: false,\r\n        pageRequestParams: null,\r\n        scrollTop: newScrollTop,\r\n        selectedRowKeys: this.getSelectedRowKeys()\r\n      });\r\n\r\n    } else if (\r\n      rowSelection &&\r\n      InfiniteScrollTable.isArrayPropertyChangedLazy(\r\n        prevProps.rowSelection.selectedRowKeys,\r\n        rowSelection.selectedRowKeys\r\n      )\r\n    ) {\r\n\r\n      this.setState({\r\n        selectedRowKeys: rowSelection.selectedRowKeys,\r\n      });\r\n      this.updateRenderedRows(rowSelection.selectedRowKeys);\r\n\r\n    } else if (prevProps.size && this.props.size && prevProps.size.width !== this.props.size.width) {\r\n\r\n      if (resizeTimeout) {\r\n        clearTimeout(resizeTimeout);\r\n      }\r\n\r\n      let newScrollTop = null;\r\n      const $grid = $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid`);\r\n      if ($grid) {\r\n        newScrollTop = $grid.scrollTop();\r\n      }\r\n\r\n      this.setState({\r\n        isResizing: true,\r\n        scrollTop: newScrollTop || scrollTop,\r\n        resizeTimeout: setTimeout(\r\n          () => {\r\n            this.setState(state => {\r\n\r\n              const {\r\n                populatedRows,\r\n                cols\r\n              } = state;\r\n\r\n              const colWidths = this.getColWidths(populatedRows, cols);\r\n              const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, this.getSelectedRowKeys());\r\n              const queriedRows = this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc);\r\n\r\n              return {\r\n                gridKeyForRefresh: uuidv4(),\r\n                isResizing: false,\r\n                resizeTimeout: null,\r\n                colWidths,\r\n                renderedRows,\r\n                queriedRows\r\n              };\r\n            });\r\n          },\r\n          RESIZE_TIMEOUT\r\n        )\r\n      });\r\n    }\r\n\r\n    const $grid =\r\n      $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid:not(.infinite-scroll-table__grid--with-event-handlers)`);\r\n\r\n    if ($grid.length) {\r\n\r\n      const _this = this;\r\n\r\n      $grid\r\n        .scrollLeft(scrollLeft)\r\n        .addClass('infinite-scroll-table__grid--with-event-handlers')\r\n        .on('scroll', function () {\r\n          const newScrollLeft = $(this).scrollLeft();\r\n          if (newScrollLeft !== _this.state.scrollLeft) {\r\n            $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__header`).scrollLeft(newScrollLeft);\r\n            _this.setState({\r\n              scrollLeft: newScrollLeft\r\n            });\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n\r\n    const {\r\n      uuid,\r\n      resizeTimeout,\r\n      pageRequestTimeout,\r\n      viewIndexesUpdateTimeout\r\n    } = this.state;\r\n\r\n    const $grid =\r\n      $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid--with-event-handlers`);\r\n\r\n    if ($grid.length) {\r\n      $grid.off('scroll');\r\n    }\r\n\r\n    if (resizeTimeout) {\r\n      clearTimeout(resizeTimeout);\r\n    }\r\n\r\n    if (pageRequestTimeout) {\r\n      clearTimeout(pageRequestTimeout);\r\n    }\r\n\r\n    if (viewIndexesUpdateTimeout) {\r\n      clearTimeout(viewIndexesUpdateTimeout);\r\n    }\r\n\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n    if (this.state.gridKeyForRefresh === nextState.gridKeyForRefresh && this.state.scrollLeft !== nextState.scrollLeft) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  /* === Event handlers === */\r\n\r\n  updateRenderedRows(selectedRowKeys) {\r\n\r\n    const {\r\n      populatedRows,\r\n      cols,\r\n      colWidths,\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, selectedRowKeys);\r\n\r\n    this.setState({\r\n      renderedRows,\r\n      queriedRows: this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc)\r\n    });\r\n  }\r\n\r\n  applyQueryChange(filters, searchText, sortCol, sortByDesc) {\r\n\r\n    const {\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      renderedRows,\r\n      cols,\r\n      queriedRows\r\n    } = this.state;\r\n\r\n    this.setState({\r\n      scrollTop: 0,\r\n      gridKeyForRefresh: uuidv4(),\r\n      queriedRows: isPaginated\r\n        ? queriedRows\r\n        : this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc)\r\n    });\r\n  }\r\n\r\n  onFiltersChange(dataIndex, value) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated,\r\n    } = this.props;\r\n\r\n    const {\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const newFilters = this.state.filters;\r\n\r\n    if (value !== null && value.length > 0) {\r\n      newFilters[dataIndex] = value;\r\n    } else {\r\n      delete newFilters[dataIndex];\r\n    }\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText,\r\n      filters: newFilters,\r\n      sortCol,\r\n      sortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      filters: newFilters,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n\r\n    this.applyQueryChange(newFilters, searchText, sortCol, sortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onSearchTextChange(value) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const newSearchText = value;\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText: newSearchText,\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      searchText: newSearchText,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n    this.applyQueryChange(filters, newSearchText, sortCol, sortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onSortChange(colDataIndex, direction) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      searchText,\r\n      filters\r\n    } = this.state;\r\n\r\n    const newSortCol = direction ? colDataIndex : null;\r\n    const newSortByDesc = direction === SORT_DIRECTION_DESC;\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText,\r\n      filters,\r\n      sortCol: newSortCol,\r\n      sortByDesc: newSortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      sortCol: newSortCol,\r\n      sortByDesc: newSortByDesc,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n\r\n    this.applyQueryChange(filters, searchText, newSortCol, newSortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onRowSelectionChange(rowKey, selected) {\r\n\r\n    const {\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc,\r\n      filters,\r\n    } = this.state;\r\n\r\n    const {\r\n      rowSelection,\r\n      getRowKey,\r\n      getIsDisabledRow\r\n    } = this.props;\r\n\r\n    if (rowSelection && (rowSelection.onSelect || rowSelection.onSelectAll)) {\r\n\r\n      if (rowKey !== null && rowSelection.onSelect) {\r\n        rowSelection.onSelect(rowKey, selected);\r\n      }\r\n\r\n      if (rowKey === null && rowSelection.onSelectAll) {\r\n        rowSelection.onSelectAll(\r\n          selected,\r\n          {\r\n            searchText,\r\n            sortCol,\r\n            sortByDesc,\r\n            filters\r\n          }\r\n        );\r\n      }\r\n\r\n    } else {\r\n\r\n      const {\r\n        selectedRowKeys,\r\n        queriedRows\r\n      } = this.state;\r\n\r\n      let newSelectedRowKeys = null;\r\n\r\n      if (rowKey !== null) {\r\n        newSelectedRowKeys =\r\n          selected\r\n            ? [...selectedRowKeys, rowKey]\r\n            : selectedRowKeys.filter(selRowKey => selRowKey !== rowKey);\r\n      } else {\r\n        newSelectedRowKeys =\r\n          selected\r\n            ? queriedRows.map(row => row[DATA_INDEX_ORIGINAL_ROW]).filter(row => !getIsDisabledRow || !getIsDisabledRow(row)).map(row => getRowKey(row))\r\n            : [];\r\n      }\r\n\r\n      if (rowSelection && rowSelection.onChange) {\r\n        rowSelection.onChange(newSelectedRowKeys);\r\n      }\r\n\r\n      this.setState({\r\n        selectedRowKeys: newSelectedRowKeys,\r\n      });\r\n      this.updateRenderedRows(newSelectedRowKeys);\r\n    }\r\n  }\r\n\r\n  /* === Getters === */\r\n\r\n  getCols() {\r\n\r\n    const {\r\n      columns,\r\n      rowSelection\r\n    } = this.props;\r\n\r\n    if (columns === null) {\r\n      return null;\r\n    } else {\r\n\r\n      let res = columns.filter(col => col !== null);\r\n\r\n      if (rowSelection || this.getNormalizedTableActions().length > 0) {\r\n\r\n        res = [\r\n          {\r\n            dataIndex: DATA_INDEX_CHECKED,\r\n            render: this.renderCheckbox,\r\n            titleRender: this.renderCheckboxTitle,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            width: CHECKBOX_WIDTH,\r\n            renderText: () => \"\"\r\n          },\r\n          ...res\r\n        ];\r\n      }\r\n\r\n      if (this.getNormalizedFixedActions().length > 0) {\r\n        res = [\r\n          ...res,\r\n          {\r\n            dataIndex: DATA_INDEX_FIXED_ACTIONS_OBJS,\r\n            render: this.renderFixedActions,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            disableOnRowClickForCell: true,\r\n            renderText: () => \"\",\r\n            width: this.getNormalizedFixedActions().length * (ACTION_WIDTH + ACTIONS_GUTTER) - ACTIONS_GUTTER + COL_WIDTH_SAFE + 2 * CELL_PADDING\r\n          }\r\n        ];\r\n      }\r\n\r\n      if (this.getNormalizedActions().length > 0 || this.getNormalizedAltActions().length > 0) {\r\n        res = [\r\n          ...res,\r\n          {\r\n            dataIndex: DATA_INDEX_ACTIONS_OBJS,\r\n            render: this.renderActions,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            disableOnRowClickForCell: true,\r\n            renderText: () => \"\",\r\n            width: Math.max(this.getNormalizedActions().length, this.getNormalizedAltActions().length) * (ACTION_WIDTH + ACTIONS_GUTTER) - ACTIONS_GUTTER + COL_WIDTH_SAFE + 2 * CELL_PADDING\r\n          }\r\n        ];\r\n      }\r\n\r\n      return res;\r\n    }\r\n  }\r\n\r\n  getNormalizedTableActions() {\r\n\r\n    const {\r\n      tableActions\r\n    } = this.props;\r\n\r\n    return (tableActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedActions() {\r\n\r\n    const {\r\n      actions\r\n    } = this.props;\r\n\r\n    return (actions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedAltActions() {\r\n\r\n    const {\r\n      altActions\r\n    } = this.props;\r\n\r\n    return (altActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedFixedActions() {\r\n\r\n    const {\r\n      fixedActions\r\n    } = this.props;\r\n\r\n    return (fixedActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getSelectedRowKeys() {\r\n\r\n    const {\r\n      rowSelection\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return rowSelection && rowSelection.selectedRowKeys\r\n      ? rowSelection.selectedRowKeys\r\n      : selectedRowKeys;\r\n  }\r\n\r\n  /* === Data manipulation === */\r\n\r\n  getFilteredGridRows(rows, cols, filters) {\r\n\r\n    return Object.keys(filters).length > 0\r\n      ? rows.filter(row => {\r\n\r\n        for (let dataIndex in filters) {\r\n          if (filters.hasOwnProperty(dataIndex)) {\r\n\r\n            const col = cols.find(col => col.dataIndex === dataIndex);\r\n\r\n            const testPassed =\r\n              col.withValuesFilter\r\n                ? filters[dataIndex].includes(row[dataIndex])\r\n                : (\r\n                  InfiniteScrollTable.isValuePassingSearchText(\r\n                    col.renderText\r\n                      ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][dataIndex])\r\n                      : row[dataIndex],\r\n                    filters[dataIndex]\r\n                  )\r\n                );\r\n\r\n            if (!testPassed) {\r\n              return false;\r\n            }\r\n\r\n          }\r\n        }\r\n\r\n        return true;\r\n\r\n      })\r\n      : rows;\r\n  }\r\n\r\n  getSearchTextFilteredGridRows(rows, cols, searchText) {\r\n\r\n    return searchText !== null\r\n      ? (\r\n        rows !== null\r\n          ? rows.filter(row => {\r\n            for (let col of cols) {\r\n              if (!col.noSearchText && typeof (row[col.dataIndex]) !== 'boolean' &&\r\n                InfiniteScrollTable.isValuePassingSearchText(\r\n                  col.renderText\r\n                    ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][col.dataIndex])\r\n                    : row[col.dataIndex],\r\n                  searchText\r\n                )) {\r\n                return true;\r\n              }\r\n            }\r\n            return false;\r\n          })\r\n          : null\r\n      )\r\n      : rows;\r\n  }\r\n\r\n  getSortedGridRows(rows, cols, sortCol, sortByDesc) {\r\n\r\n    const column = sortCol !== null ? cols.find(col => col.dataIndex === sortCol) : null;\r\n\r\n    return column\r\n      ? rows.sort((a, b) => {\r\n        const _a =\r\n          column.renderText\r\n            ? column.renderText(a[DATA_INDEX_ORIGINAL_ROW][column.dataIndex])\r\n            : a[column.dataIndex];\r\n        const _b =\r\n          column.renderText\r\n            ? column.renderText(b[DATA_INDEX_ORIGINAL_ROW][column.dataIndex])\r\n            : b[column.dataIndex];\r\n        return (\r\n          column.sorter\r\n            ? column.sorter(_a, _b) * (sortByDesc ? -1 : 1)\r\n            : InfiniteScrollTable.defaultSorter(_a, _b, sortByDesc)\r\n        );\r\n      })\r\n      : rows;\r\n  }\r\n\r\n  /* === Rendering ==== */\r\n\r\n  renderGridRow(row, cols, colWidths) {\r\n\r\n    const {\r\n      onRowClick,\r\n      getIsDisabledRow,\r\n      getRowStyle\r\n    } = this.props;\r\n\r\n    return (\r\n      <div className=\"infinite-scroll-table__grid__row\" style={{width: \"100%\", height: ROW_HEIGHT}}>\r\n        {cols.map((col, colIndex) => {\r\n          const cellData = row[col.dataIndex];\r\n          const isRowClickDisabled =\r\n            !onRowClick || col.disableOnRowClickForCell ||\r\n            (getIsDisabledRow && getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW]));\r\n          let colLeftAttr = 0;\r\n          cols\r\n            .slice(0, colIndex)\r\n            .map((_, index) => index)\r\n            .forEach(index => colLeftAttr += colWidths[index]);\r\n          const rowStyle = getRowStyle ? getRowStyle(row[DATA_INDEX_ORIGINAL_ROW]) : null;\r\n          return (\r\n            <Tooltip key={colIndex} title={col.renderText ? col.renderText(cellData) : cellData}>\r\n              <div\r\n                className={\r\n                  'infinite-scroll-table__grid__cell' +\r\n                  (getIsDisabledRow && getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW])\r\n                    ? ' infinite-scroll-table__grid__cell--disabled'\r\n                    : '')\r\n                }\r\n                style={{\r\n                  position: \"absolute\",\r\n                  width: colWidths[colIndex],\r\n                  height: ROW_HEIGHT,\r\n                  lineHeight: `${ROW_HEIGHT - CELL_PADDING - CELL_PADDING}px`,\r\n                  top: 0,\r\n                  left: colLeftAttr,\r\n                  cursor: !isRowClickDisabled ? \"pointer\" : null,\r\n                  ...rowStyle\r\n                }}\r\n                onClick={!isRowClickDisabled ? () => onRowClick(row[DATA_INDEX_ORIGINAL_TRANSLATED_ROW]) : null}\r\n              >\r\n                {col.render\r\n                  ? col.render(cellData, row[DATA_INDEX_ORIGINAL_ROW])\r\n                  : cellData\r\n                }\r\n              </div>\r\n            </Tooltip>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderHeaderCells(cols, columnWidths, rows) {\r\n\r\n    const {\r\n      data\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    return (cols || []).map((col, index) =>\r\n      <div\r\n        key={index}\r\n        className=\"infinite-scroll-table__header__cell\"\r\n        style={{\r\n          width: columnWidths[index],\r\n          height: ROW_HEIGHT,\r\n          padding: HEADER_CELL_PADDING\r\n        }}\r\n      >\r\n        <Grid container justify=\"space-between\">\r\n          {(col.title || col.titleRender) && (\r\n            <Grid item style={{marginRight: (!col.noFilter || !col.noSort) ? HEADER_CELL_GUTTER : 0}}>\r\n              <div\r\n                style={{\r\n                  height: (ROW_HEIGHT - (2 * HEADER_CELL_PADDING)),\r\n                  lineHeight: `${(ROW_HEIGHT - (2 * HEADER_CELL_PADDING))}px`,\r\n                  textAlign: \"center\"\r\n                }}\r\n              >\r\n                {col.titleRender ? col.titleRender(rows) : col.title}\r\n              </div>\r\n            </Grid>\r\n          )}\r\n          {(!col.noFilter || !col.noSort)\r\n            ? (\r\n              <Grid item>\r\n                <Grid container>\r\n                  {!col.noSort && (\r\n                    <Grid item style={{marginRight: !col.noFilter ? HEADER_CELL_CONTROLS_GUTTER : 0}}>\r\n                      <SortButtons\r\n                        value={\r\n                          col.dataIndex === sortCol\r\n                            ? (sortByDesc ? SORT_DIRECTION_DESC : SORT_DIRECTION_ASC)\r\n                            : null\r\n                        }\r\n                        onChange={value => this.onSortChange(col.dataIndex, value)}\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                  {!col.noFilter && (\r\n                    <Grid item>\r\n                      <FilterButton\r\n                        value={filters[col.dataIndex]}\r\n                        onChange={value => this.onFiltersChange(col.dataIndex, value)}\r\n                        options={\r\n                          col.withValuesFilter\r\n                            ? (\r\n                              _.uniq(\r\n                                (data || []).map(row => row[col.dataIndex])\r\n                              ).map(option => ({\r\n                                value: option,\r\n                                text: col.renderText\r\n                                  ? col.renderText(option)\r\n                                  : option\r\n                              })).sort((a, b) =>\r\n                                col.sorter\r\n                                  ? col.sorter(a.text, b.text)\r\n                                  : InfiniteScrollTable.defaultSorter(a.text, b.text)\r\n                              )\r\n                            )\r\n                            : null\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n            : <span/>\r\n          }\r\n        </Grid>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderFixedActions(actions) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return (\r\n      <Grid container>\r\n        {(actions || []).map((action, index) =>\r\n          <Grid item key={index} style={{marginLeft: index === 0 ? 0 : ACTIONS_GUTTER}}>\r\n            <Tooltip title={action.title}>\r\n              <IconButton\r\n                {...action}\r\n                key={index}\r\n                size=\"small\"\r\n                onClick={\r\n                  e => {\r\n                    e.stopPropagation();\r\n                    action.onClick(\r\n                      action.row,\r\n                      () => this.setState({\r\n                        selectedRowKeys: selectedRowKeys.filter(key => key !== getRowKey(action.row))\r\n                      })\r\n                    );\r\n                  }}\r\n              >\r\n                {action.icon}\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  renderActions(actions) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return (\r\n      <Grid\r\n        container\r\n        className=\"infinite-scroll-table__grid__cell__actions-container\"\r\n        justify=\"flex-end\"\r\n      >\r\n        {(actions || []).map((action, index) =>\r\n          <Grid item key={index} style={{marginLeft: index === 0 ? 0 : ACTIONS_GUTTER}}>\r\n            <Tooltip title={action.title}>\r\n              <IconButton\r\n                className={`infinite-scroll-table__grid__cell__action ${action.className || \"\"}`}\r\n                style={{\r\n                  width: ACTION_WIDTH,\r\n                  height: ACTION_WIDTH,\r\n                  padding: 0\r\n                }}\r\n                disabled={action.disabled}\r\n                onClick={\r\n                  e => {\r\n                    e.stopPropagation();\r\n                    action.onClick(\r\n                      action.row,\r\n                      () => this.setState({\r\n                        selectedRowKeys: selectedRowKeys.filter(key => key !== getRowKey(action.row))\r\n                      })\r\n                    );\r\n                  }}\r\n              >\r\n                {action.icon}\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  renderTableAction(action, rows) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    return (\r\n      <Button\r\n        type=\"primary\"\r\n        className={action.className}\r\n        startIcon={action.icon}\r\n        title={action.title}\r\n        disabled={action.disabled}\r\n        onClick={\r\n          e => {\r\n            e.stopPropagation();\r\n            action.onClick(\r\n              rows.filter(row => this.getSelectedRowKeys().includes(getRowKey(row[DATA_INDEX_ORIGINAL_ROW]))),\r\n              () => this.onRowSelectionChange(null, false)\r\n            )\r\n          }}\r\n      >\r\n        {action.title}\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  renderCheckbox(checked, row) {\r\n    const {\r\n      getRowKey,\r\n      rowSelection,\r\n      getIsDisabledRow\r\n    } = this.props;\r\n\r\n    const checkboxProps =\r\n      rowSelection && rowSelection.getCheckboxProps\r\n        ? rowSelection.getCheckboxProps(row)\r\n        : ({\r\n          disabled: getIsDisabledRow && getIsDisabledRow(row)\r\n        });\r\n\r\n    return (\r\n      <Checkbox\r\n        checked={checked}\r\n        onChange={e => {\r\n          e.stopPropagation();\r\n          this.onRowSelectionChange(getRowKey(row), !checked)\r\n        }}\r\n        style={{padding: 0}}\r\n        {...checkboxProps}\r\n      />\r\n    );\r\n  }\r\n\r\n  renderCheckboxTitle(rows) {\r\n    const {\r\n      getRowKey,\r\n      getIsDisabledRow\r\n    } = this.props;\r\n\r\n    const selectedRowKeys = this.getSelectedRowKeys();\r\n\r\n    const checked =\r\n      rows !== null &&\r\n      rows.length > 0 &&\r\n      rows\r\n        .filter(row => !getIsDisabledRow || !getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW]))\r\n        .map(row => getRowKey(row[DATA_INDEX_ORIGINAL_ROW]))\r\n        .filter(rowKey => !selectedRowKeys.includes(rowKey))\r\n        .length === 0;\r\n\r\n    return (\r\n      <Checkbox\r\n        checked={checked}\r\n        onChange={() => this.onRowSelectionChange(null, !checked)}\r\n        style={{padding: 0}}\r\n      />\r\n    );\r\n  }\r\n\r\n  onRenderedRowsChange(viewStartIdx, viewEndIdx, overscanStartIdx, overscanEndIdx) {\r\n\r\n    const {\r\n      onChange,\r\n      rowCount,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      pageRequestTimeout,\r\n      pageSize,\r\n      pageNum,\r\n      isPaginating,\r\n      viewIndexesUpdateTimeout,\r\n      doNotCallOnChangeOnNextRenderedRowsChange\r\n    } = this.state;\r\n\r\n    if (viewIndexesUpdateTimeout) {\r\n      clearTimeout(viewIndexesUpdateTimeout);\r\n    }\r\n\r\n    this.setState({\r\n      viewIndexesUpdateTimeout: setTimeout(\r\n        () => this.setState({\r\n          viewStartIdx,\r\n          viewEndIdx,\r\n          viewIndexesUpdateTimeout: null\r\n        }),\r\n        VIEW_INDEXES_UPDATE_TIMEOUT\r\n      )\r\n    });\r\n\r\n    if (isPaginated && !doNotCallOnChangeOnNextRenderedRowsChange) {\r\n\r\n      const currentPageIndexes = getIndexesFromPaginationParams(\r\n        pageSize || DEFAULT_PAGE_SIZE,\r\n        pageNum || DEFAULT_PAGE_NUM\r\n      );\r\n\r\n      if (\r\n        isPaginating ||\r\n        (overscanStartIdx < currentPageIndexes.startIdx || overscanEndIdx > currentPageIndexes.stopIdx)\r\n      ) {\r\n\r\n        if (pageRequestTimeout !== null) {\r\n          clearTimeout(pageRequestTimeout);\r\n        }\r\n\r\n        const safePageSize = MAX_PAGE_SIZE / 2; // getPaginationParamsFromIndexes can double the size of a page\r\n        const pageRowsThird = Math.floor(safePageSize / 3);\r\n        const newPaginationParams =\r\n          getPaginationParamsFromIndexes(\r\n            Math.max(overscanStartIdx - pageRowsThird, 0),\r\n            Math.min(overscanStartIdx + 2 * pageRowsThird - 1, rowCount - 1),\r\n            rowCount\r\n          );\r\n\r\n        const newPageRequestParams = {\r\n          pageSize: newPaginationParams.pageSize,\r\n          pageNum: newPaginationParams.pageNum,\r\n          filters: this.state.filters,\r\n          searchText: this.state.searchText,\r\n          sortCol: this.state.sortCol,\r\n          sortByDesc: this.state.sortByDesc\r\n        };\r\n\r\n        this.setState({\r\n          isPaginating: true,\r\n          pageRequestTimeout: setTimeout(\r\n            () => {\r\n              onChange(newPageRequestParams);\r\n              this.setState({\r\n                pageRequestParams: newPageRequestParams\r\n              })\r\n            },\r\n            PAGINATION_TIMEOUT\r\n          )\r\n        });\r\n      }\r\n    } else if (isPaginated) {\r\n      this.setState({\r\n        doNotCallOnChangeOnNextRenderedRowsChange: false\r\n      });\r\n    }\r\n  }\r\n\r\n  getIsVerticalScrollbarVisible(rowNum) {\r\n\r\n    const {\r\n      height = DEFAULT_TABLE_HEIGHT\r\n    } = this.props;\r\n\r\n    return rowNum * ROW_HEIGHT > height;\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      t,\r\n      size,\r\n      leftActions,\r\n      rightActions,\r\n      showHeader = true,\r\n      rowCount,\r\n      isPaginated = false,\r\n      height = DEFAULT_TABLE_HEIGHT,\r\n      selectedRowCount,\r\n      autoSearch = true\r\n    } = this.props;\r\n\r\n    const {\r\n      uuid,\r\n      cols,\r\n      gridKeyForRefresh,\r\n      scrollTop,\r\n      gridScrollbarWidth,\r\n      populatedRows,\r\n      queriedRows,\r\n      isResizing,\r\n      colWidths,\r\n      pageSize,\r\n      pageNum,\r\n      isPaginating,\r\n      viewStartIdx,\r\n      viewEndIdx,\r\n      viewIndexesUpdateTimeout,\r\n      searchText\r\n    } = this.state;\r\n\r\n    const currentPageIndexes = getIndexesFromPaginationParams(\r\n      pageSize || DEFAULT_PAGE_SIZE,\r\n      pageNum || DEFAULT_PAGE_NUM\r\n    );\r\n\r\n    return (\r\n      <div className={`infinite-scroll-table infinite-scroll-table__${uuid}`}>\r\n        <PreHeader\r\n          searchText={searchText}\r\n          autoSearch={autoSearch}\r\n          onSearch={this.onSearchTextChange}\r\n          selectedRowCount={selectedRowCount ? selectedRowCount : this.getSelectedRowKeys().length}\r\n          tableActions={this.getNormalizedTableActions()}\r\n          renderTableAction={action => this.renderTableAction(action, populatedRows)}\r\n          leftActions={leftActions}\r\n          rightActions={rightActions}\r\n        />\r\n        <Fragment>\r\n          {showHeader && (\r\n            isResizing\r\n              ? <div className=\"infinite-scroll-table__header-placeholder\" style={{height: ROW_HEIGHT}}/>\r\n              : (\r\n                <div className=\"infinite-scroll-table__header\" style={{height: ROW_HEIGHT}}>\r\n                  {queriedRows !== null\r\n                    ? (\r\n                      <Fragment>\r\n                        <div className=\"infinite-scroll-table__header__cells-container\">\r\n                          {this.renderHeaderCells(cols, colWidths, queriedRows)}\r\n                        </div>\r\n                        <div\r\n                          className=\"infinite-scroll-table__header__scrollbar-padding\"\r\n                          style={{width: gridScrollbarWidth, height: ROW_HEIGHT}}\r\n                        >\r\n                        </div>\r\n                      </Fragment>\r\n                    )\r\n                    : (\r\n                      <div\r\n                        className=\"infinite-scroll-table__header-placeholder\"\r\n                        style={{height: ROW_HEIGHT, width: size.width}}\r\n                      />\r\n                    )\r\n                  }\r\n                </div>\r\n              )\r\n          )}\r\n          {isResizing || queriedRows === null || queriedRows.length === 0\r\n            ? (\r\n              <div style={{height}} className=\"infinite-scroll-table__grid-container-placeholder\">\r\n                <CustomEmpty\r\n                  width={(!isResizing && queriedRows !== null) ? _.sum(colWidths) : undefined}\r\n                  text={\r\n                    isResizing\r\n                      ? t(\"components.infiniteScrollTable.resizing\") + \"...\"\r\n                      : (\r\n                        queriedRows === null\r\n                          ? t(\"components.infiniteScrollTable.updating\") + \"...\"\r\n                          : undefined\r\n                      )}\r\n                  image={isResizing\r\n                    ? <CircularProgress/>\r\n                    : <span/>\r\n                  }\r\n                />\r\n              </div>\r\n            )\r\n            : (\r\n              <div className=\"infinite-scroll-table__grid-container\" style={{position: \"relative\", height}}>\r\n                {isPaginating && (\r\n                  <div\r\n                    style={{\r\n                      position: \"absolute\",\r\n                      width: Math.min(_.sum(colWidths), size.width),\r\n                      height,\r\n                    }}\r\n                  >\r\n                    <CustomEmpty\r\n                      text={t(\"components.infiniteScrollTable.updating\") + \"...\"}\r\n                    />\r\n                  </div>\r\n                )}\r\n                <FixedSizeList\r\n                  className=\"infinite-scroll-table__grid\"\r\n                  key={gridKeyForRefresh}\r\n                  width={size.width}\r\n                  height={height}\r\n                  itemSize={ROW_HEIGHT}\r\n                  itemCount={rowCount || queriedRows.length}\r\n                  initialScrollOffset={scrollTop}\r\n                  onItemsRendered={\r\n                    ({visibleStartIndex, visibleStopIndex, overscanStartIndex, overscanStopIndex}) =>\r\n                      this.onRenderedRowsChange(\r\n                        visibleStartIndex,\r\n                        visibleStopIndex,\r\n                        overscanStartIndex,\r\n                        overscanStopIndex\r\n                      )\r\n                  }\r\n                >\r\n                  {({index, style}) =>\r\n                    <div\r\n                      style={{...style, width: _.sum(colWidths)}}\r\n                      className={`infinite-scroll-table__grid__row infinite-scroll-table__grid__row--${index % 2 ? 'odd' : 'even'}`}\r\n                    >\r\n                      {\r\n                        !isPaginated ||\r\n                        (\r\n                          !isPaginating &&\r\n                          currentPageIndexes.startIdx <= index &&\r\n                          index <= currentPageIndexes.stopIdx &&\r\n                          (index - currentPageIndexes.startIdx < queriedRows.length)\r\n                        )\r\n                          ? (\r\n                            queriedRows[\r\n                              isPaginated\r\n                                ? (index - currentPageIndexes.startIdx)\r\n                                : index\r\n                              ][DATA_INDEX_RENDERED]\r\n                          )\r\n                          : <span/>\r\n                      }\r\n                    </div>\r\n                  }\r\n                </FixedSizeList>\r\n              </div>\r\n            )}\r\n          <Footer\r\n            isHidden={queriedRows === null || queriedRows.length === 0}\r\n            isLoading={isPaginating || viewIndexesUpdateTimeout}\r\n            rowNumStart={viewStartIdx + 1}\r\n            rowNumEnd={viewEndIdx + 1}\r\n            rowCount={rowCount || (queriedRows ? queriedRows.length : null)}\r\n          />\r\n        </Fragment>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withSize(),\r\n  withTranslation(),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(InfiniteScrollTable);\r\n","import React from 'react';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\n\r\nconst iconStyle = {\r\n  cursor: 'pointer'\r\n};\r\n\r\n/* Based on https://ant.design/components/form/#components-form-demo-customized-form-controls */\r\nclass Selector extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      value: null\r\n    };\r\n    this.callOnChange = this.callOnChange.bind(this);\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, state) {\r\n    if (nextProps.value !== state.value) {\r\n      return {\r\n        value: nextProps.value\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  callOnChange(value) {\r\n    if (this.props.onChange) {\r\n      this.props.onChange(value);\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      disabled,\r\n      detailTitle,\r\n      selectTitle,\r\n      resetTitle,\r\n      onDetail,\r\n      onSelect,\r\n      onReset,\r\n      render,\r\n      variant,\r\n      className\r\n    } = this.props;\r\n\r\n    const {\r\n      value\r\n    } = this.state;\r\n\r\n    return (\r\n      <TextField\r\n        value={render ? render(value) : value}\r\n        onChange={f => f}\r\n        variant={variant || \"outlined\"}\r\n        InputProps={{\r\n          readOnly: true,\r\n          endAdornment: disabled\r\n            ? undefined\r\n            : value !== null\r\n              ? resetTitle\r\n                ? (\r\n                  <Tooltip title={resetTitle}>\r\n                    <CloseIcon onClick={onReset} style={iconStyle}/>\r\n                  </Tooltip>\r\n                )\r\n                : <CloseIcon onClick={onReset} style={iconStyle}/>\r\n              : selectTitle\r\n                ? (\r\n                  <Tooltip title={selectTitle}>\r\n                    <AddIcon onClick={onSelect} style={iconStyle}/>\r\n                  </Tooltip>\r\n                )\r\n                : <AddIcon onClick={onSelect} style={iconStyle}/>,\r\n          startAdornment: (onDetail && value !== null)\r\n            ? detailTitle\r\n              ? (\r\n                <Tooltip title={detailTitle}>\r\n                  <VisibilityIcon onClick={onDetail} style={iconStyle}/>\r\n                </Tooltip>\r\n              )\r\n              : <VisibilityIcon onClick={onDetail} style={iconStyle}/>\r\n            : undefined\r\n        }}\r\n        className={className}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Selector;\r\n","import React, {useState} from 'react';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport _ from \"lodash\";\r\n\r\nconst ON_CHANGE_TIMEOUT = 500;\r\n\r\nconst getInitialInternalValue = (value, languages) => {\r\n  const emptyValue = {};\r\n  languages.forEach(lang => emptyValue[lang] = \"\");\r\n\r\n  return _.merge(emptyValue, value)\r\n};\r\n\r\nconst Component = ({\r\n                     textFieldProps,\r\n                     defaultLanguage,\r\n                     languages\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n  const [internalValue, setInternalValue] = useState(getInitialInternalValue(textFieldProps.value, languages));\r\n  const [timeoutId, setTimeoutId] = useState(null);\r\n\r\n  const callOnChange = value => {\r\n    if (textFieldProps.onChange) {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId)\r\n      }\r\n      setTimeoutId(setTimeout(\r\n        () => {\r\n          textFieldProps.onChange(value);\r\n        },\r\n        ON_CHANGE_TIMEOUT\r\n      ));\r\n    }\r\n  };\r\n\r\n  const setValueForLanguage = value => {\r\n    let newInternalValue = _.cloneDeep(internalValue);\r\n    newInternalValue[language] = value;\r\n\r\n    setInternalValue(newInternalValue);\r\n    callOnChange(newInternalValue);\r\n  };\r\n\r\n  return (\r\n    <TextField\r\n      {...textFieldProps}\r\n      value={(internalValue && internalValue[language])\r\n        ? internalValue[language]\r\n        : \"\"\r\n      }\r\n      onChange={({target}) => setValueForLanguage(target.value)}\r\n      InputProps={{\r\n        startAdornment: (\r\n          <InputAdornment position=\"start\">\r\n            <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n          </InputAdornment>\r\n        )\r\n      }}\r\n    >\r\n      {textFieldProps.children}\r\n    </TextField>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nDelayedTextField = props =>\r\n  <ConnectedComponent textFieldProps={props}/>;\r\n\r\nexport default I18nDelayedTextField;","export const getDashboardDynamicFilterLabelTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    Region: t('dashboards.dynamicFilterLabels.region'),\r\n    Province: t('dashboards.dynamicFilterLabels.province'),\r\n    Municipality: t('dashboards.dynamicFilterLabels.municipality'),\r\n  });\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};\r\n","import React, {Fragment, useState} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport _ from \"lodash\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport Selector from \"../selector\";\r\nimport {\r\n  DASHBOARD_ELEM_ENABLE_FILTERS_KEY,\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_SHOW_TITLE_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_TEXT,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  DASHBOARD_ELEM_WIDTH_KEY,\r\n  emptyDashboardElem\r\n} from \"../../utils/dashboards\";\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport I18nDelayedTextField from \"../i18n-delayed-text-field\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nHtmlEditor from \"../i18n-html-editor\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport filters from \"../../dummy/filters.json\";\r\nimport {getDashboardDynamicFilterLabelTranslations} from \"../../constants/getDashboardDynamicFilterLabelTranslations\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst MAX_VIEW_PER_ROW = 4;\r\n\r\nconst ROW_ACTION_WIDTH = 48;\r\nconst COL_ACTION_WIDTH = 48;\r\nconst VIEW_ACTION_WIDTH = 48;\r\n\r\nconst styles = theme => ({\r\n  filterLevels: {\r\n    fontSize: 16\r\n  },\r\n  rowContainer: {\r\n    width: \"100%\",\r\n    marginTop: 8\r\n  },\r\n  row: {\r\n    width: `calc(100% - ${2 * ROW_ACTION_WIDTH}px)`,\r\n    height: 164,\r\n    display: \"inline-block\"\r\n  },\r\n  rowActions: {\r\n    width: (2 * ROW_ACTION_WIDTH),\r\n    display: \"inline-block\",\r\n    margin: \"5px 0\"\r\n  },\r\n  rowAction: {\r\n    width: ROW_ACTION_WIDTH\r\n  },\r\n  colContainer: {\r\n    border: \"1px solid rgba(0, 0, 0, 0.2)\",\r\n    marginRight: 8,\r\n    padding: 16,\r\n    height: \"100%\",\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  col: {\r\n    width: `calc(100% - ${COL_ACTION_WIDTH}px)`,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  colActions: {\r\n    width: COL_ACTION_WIDTH,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  viewContainer: {\r\n    width: \"100%\"\r\n  },\r\n  view: {\r\n    width: `calc(100% - ${VIEW_ACTION_WIDTH + 4}px)`,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  viewAction: {\r\n    width: VIEW_ACTION_WIDTH,\r\n    marginLeft: 4,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  input: {\r\n    width: \"100%\",\r\n    \"& > div\": {\r\n      width: \"100%\"\r\n    },\r\n    \"& input\": {\r\n      padding: 10,\r\n      height: 20\r\n    },\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  dynamicViewInput: {\r\n    marginLeft: 16,\r\n    \"& input\": {\r\n      padding: 10,\r\n      height: 20\r\n    }\r\n  },\r\n  htmlInput: {\r\n    \"& > div\": {\r\n      height: 130\r\n    }\r\n  },\r\n  formLabel: {\r\n    marginLeft: 0,\r\n    marginRight: 0\r\n  }\r\n});\r\n\r\nconst getStrippedHtmlText = html => {\r\n  const $span = $('<span>').get(0);\r\n\r\n  $span.innerHTML = html;\r\n  const text = $span.textContent || $span.innerText || \"\";\r\n\r\n  $($span).remove();\r\n\r\n  return text;\r\n}\r\n\r\nconst DashboardBuilderCol = ({\r\n                               t,\r\n                               classes,\r\n                               defaultLanguage,\r\n                               languages,\r\n                               dashboard,\r\n                               rowIdx,\r\n                               colIdx,\r\n                               col,\r\n                               onColRemove,\r\n                               onTypeReset,\r\n                               fetchViews,\r\n                               onViewReset,\r\n                               onTextEdit,\r\n                               onShowTitleChange,\r\n                               onEnableFiltersChange,\r\n                               onFilterDimensionChange\r\n                             }) =>\r\n  <div\r\n    className={classes.colContainer}\r\n    style={{width: `calc(${col[DASHBOARD_ELEM_WIDTH_KEY]}% - ${2 * 4}px)`}}\r\n  >\r\n    <div className={classes.col}>\r\n      {col[DASHBOARD_ELEM_TYPE_KEY] === null\r\n        ? (\r\n          <Grid container justify=\"center\" style={{margin: \"47px 0\"}}>\r\n            <Grid item>\r\n              <Button onClick={() => fetchViews(rowIdx, colIdx)}>\r\n                {t(\"components.dashboardBuilder.actions.addView\")}\r\n              </Button>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button onClick={() => onTextEdit(rowIdx, colIdx, \"\")}>\r\n                {t(\"components.dashboardBuilder.actions.addText\")}\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        )\r\n        : (\r\n          <div className={classes.viewContainer}>\r\n            <div className={classes.view}>\r\n              {col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW\r\n                ? (\r\n                  <Grid container>\r\n                    <Grid item xs={12} style={{marginBottom: 8}}>\r\n                      <Selector\r\n                        value={col[DASHBOARD_ELEM_VALUE_KEY] ? dashboard.views[col[DASHBOARD_ELEM_VALUE_KEY]] : null}\r\n                        render={view => view?.title ? localizeI18nObj(view.title, defaultLanguage, languages) : \"\"}\r\n                        variant=\"standard\"\r\n                        className={classes.input}\r\n                        selectTitle={t(\"components.dashboardBuilder.actions.selectView\")}\r\n                        onSelect={() => fetchViews(rowIdx, colIdx)}\r\n                        resetTitle={t(\"components.dashboardBuilder.actions.deselectView\")}\r\n                        onReset={() => onViewReset(rowIdx, colIdx, col[DASHBOARD_ELEM_VALUE_KEY])}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={12}>\r\n                      <Grid container>\r\n                        <Grid item style={{marginRight: 8}}>\r\n                          <FormControlLabel\r\n                            className={classes.formLabel}\r\n                            label={t(\"components.dashboardBuilder.actions.showTitle\")}\r\n                            control={\r\n                              <Checkbox\r\n                                style={{padding: 5}}\r\n                                checked={col[DASHBOARD_ELEM_SHOW_TITLE_KEY]}\r\n                                onChange={(ev, checked) => onShowTitleChange(rowIdx, colIdx, checked)}\r\n                              />\r\n                            }\r\n                          />\r\n                        </Grid>\r\n                        <Grid item>\r\n                          <FormControlLabel\r\n                            className={classes.formLabel}\r\n                            label={t(\"components.dashboardBuilder.actions.enableFilters\")}\r\n                            control={\r\n                              <Checkbox\r\n                                style={{padding: 5}}\r\n                                checked={col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY]}\r\n                                onChange={(ev, checked) => onEnableFiltersChange(rowIdx, colIdx, checked)}\r\n                              />\r\n                            }\r\n                          />\r\n                        </Grid>\r\n                      </Grid>\r\n                    </Grid>\r\n                    <Grid item xs={12} style={{marginTop: 8}}>\r\n                      <FormControlLabel\r\n                        className={classes.formLabel}\r\n                        style={{marginLeft: 8}}\r\n                        label={t(\"components.dashboardBuilder.filterDimension.label\") + \":\"}\r\n                        labelPlacement=\"start\"\r\n                        control={\r\n                          <TextField\r\n                            value={col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || \"\"}\r\n                            placeholder={t(\"components.dashboardBuilder.filterDimension.noOne\")}\r\n                            className={classes.dynamicViewInput}\r\n                            variant=\"outlined\"\r\n                            onChange={({target}) => onFilterDimensionChange(rowIdx, colIdx, target.value)}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  </Grid>\r\n                )\r\n                : (\r\n                  <TextField\r\n                    value={getStrippedHtmlText(localizeI18nObj(col[DASHBOARD_ELEM_VALUE_KEY], defaultLanguage, languages) || \"\")}\r\n                    className={`${classes.input} ${classes.htmlInput}`}\r\n                    multiline\r\n                    rows={5}\r\n                    InputProps={{\r\n                      readOnly: true,\r\n                      endAdornment: (\r\n                        <Tooltip title={t(\"components.dashboardBuilder.actions.editText\")}>\r\n                          <EditIcon\r\n                            style={{cursor: \"pointer\", marginLeft: 4}}\r\n                            onClick={() => onTextEdit(rowIdx, colIdx, col[DASHBOARD_ELEM_VALUE_KEY])}\r\n                          />\r\n                        </Tooltip>\r\n                      )\r\n                    }}\r\n                  />\r\n                )\r\n              }\r\n            </div>\r\n            <Tooltip title={t(\"components.dashboardBuilder.actions.resetColumn\")}>\r\n              <IconButton\r\n                className={classes.viewAction}\r\n                onClick={() => onTypeReset(rowIdx, colIdx)}\r\n              >\r\n                <CloseIcon/>\r\n              </IconButton>\r\n            </Tooltip>\r\n          </div>\r\n        )\r\n      }\r\n    </div>\r\n    <Tooltip title={t(\"components.dashboardBuilder.actions.removeColumn\")}>\r\n      <span>\r\n        <IconButton\r\n          className={classes.colActions}\r\n          onClick={() => onColRemove(rowIdx, colIdx)}\r\n          disabled={dashboard.dashboardConfig[rowIdx].length === 1}\r\n        >\r\n          <DeleteIcon/>\r\n        </IconButton>\r\n      </span>\r\n    </Tooltip>\r\n  </div>;\r\n\r\nconst DashboardBuilderRow = ({\r\n                               t,\r\n                               classes,\r\n                               defaultLanguage,\r\n                               languages,\r\n                               dashboard,\r\n                               row,\r\n                               rowIdx,\r\n                               onRowRemove,\r\n                               onColAdd,\r\n                               onColRemove,\r\n                               onTypeReset,\r\n                               fetchViews,\r\n                               onViewReset,\r\n                               onTextEdit,\r\n                               onShowTitleChange,\r\n                               onEnableFiltersChange,\r\n                               onFilterDimensionChange\r\n                             }) =>\r\n  <div className={classes.rowContainer}>\r\n    <div className={classes.row}>\r\n      {row.map((col, idx) =>\r\n        <DashboardBuilderCol\r\n          key={idx}\r\n          t={t}\r\n          classes={classes}\r\n          defaultLanguage={defaultLanguage}\r\n          languages={languages}\r\n          dashboard={dashboard}\r\n          rowIdx={rowIdx}\r\n          colIdx={idx}\r\n          col={col}\r\n          onColRemove={onColRemove}\r\n          onTypeReset={onTypeReset}\r\n          fetchViews={fetchViews}\r\n          onViewReset={onViewReset}\r\n          onTextEdit={onTextEdit}\r\n          onShowTitleChange={onShowTitleChange}\r\n          onEnableFiltersChange={onEnableFiltersChange}\r\n          onFilterDimensionChange={onFilterDimensionChange}\r\n        />\r\n      )}\r\n    </div>\r\n    <div className={classes.rowActions}>\r\n      <Tooltip title={t(\"components.dashboardBuilder.actions.addColumn\")}>\r\n        <span>\r\n          <IconButton\r\n            className={classes.rowAction}\r\n            onClick={() => onColAdd(rowIdx)}\r\n            disabled={row.length === MAX_VIEW_PER_ROW}\r\n          >\r\n            <AddIcon/>\r\n          </IconButton>\r\n        </span>\r\n      </Tooltip>\r\n      <Tooltip title={t(\"components.dashboardBuilder.actions.removeRow\")}>\r\n        <IconButton\r\n          className={classes.rowAction}\r\n          onClick={() => onRowRemove(rowIdx)}\r\n        >\r\n          <DeleteIcon/>\r\n        </IconButton>\r\n      </Tooltip>\r\n    </div>\r\n  </div>;\r\n\r\nfunction DashboardBuilder(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    nodes,\r\n    dashboard,\r\n    onChange,\r\n    views,\r\n    fetchViews,\r\n    onViewsHide\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [selectedRowIdx, setSelectedRowIdx] = useState(null);\r\n  const [selectedColIdx, setSelectedColIdx] = useState(null);\r\n\r\n  const [isEditTextVisible, setEditTextVisibility] = useState(false);\r\n  const [tempTextValue, setTempTextValue] = useState(null);\r\n\r\n  const handleRowAdd = () => {\r\n    const newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig.push([emptyDashboardElem]);\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleRowRemove = rowIdx => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig = newDashboard.dashboardConfig.filter((_, idx) => idx !== rowIdx);\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleColAdd = rowIdx => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx].push(emptyDashboardElem)\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].map(col => ({\r\n      ...col,\r\n      [DASHBOARD_ELEM_WIDTH_KEY]: (100 / newDashboard.dashboardConfig[rowIdx].length)\r\n    }));\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleColRemove = (rowIdx, colIdx) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].filter((_, idx) => idx !== colIdx);\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].map(col => ({\r\n      ...col,\r\n      [DASHBOARD_ELEM_WIDTH_KEY]: (100 / newDashboard.dashboardConfig[rowIdx].length)\r\n    }));\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleTypeReset = (rowIdx, colIdx) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = null;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = null;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleViewSet = (rowIdx, colIdx, view) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = DASHBOARD_ELEM_TYPE_VALUE_VIEW;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = view.viewTemplateId;\r\n    newDashboard.views[view.viewTemplateId] = view;\r\n    onChange(newDashboard);\r\n    onViewsHide();\r\n  };\r\n\r\n  const handleViewReset = (rowIdx, colIdx, viewId) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = null;\r\n    onChange(newDashboard);\r\n    onViewsHide();\r\n  };\r\n\r\n  const handleEditTextShow = (rowIdx, colIdx, text) => {\r\n    setSelectedRowIdx(rowIdx);\r\n    setSelectedColIdx(colIdx);\r\n    setTempTextValue(text);\r\n    setEditTextVisibility(true);\r\n  };\r\n\r\n  const handleEditTextHide = () => {\r\n    setSelectedRowIdx(null);\r\n    setSelectedColIdx(null);\r\n    setTempTextValue(null);\r\n    setEditTextVisibility(false);\r\n  };\r\n\r\n  const handleTextChange = (rowIdx, colIdx, text) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = DASHBOARD_ELEM_TYPE_VALUE_TEXT;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = text;\r\n    onChange(newDashboard);\r\n    setEditTextVisibility(false);\r\n  };\r\n\r\n  const handleShowTitleChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_SHOW_TITLE_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleEnableFiltersChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_ENABLE_FILTERS_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleFilterDimensionChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_FILTER_DIMENSION_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      {dashboard && (\r\n        <Grid container spacing={1}>\r\n          <Grid item xs={12}>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nDelayedTextField\r\n                label={t(\"components.dashboardBuilder.title\")}\r\n                value={dashboard.title}\r\n                variant=\"outlined\"\r\n                required\r\n                onChange={value => onChange({...dashboard, title: value})}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Grid container>\r\n              <Grid item className={classes.filterLevels} style={{marginRight: 16, lineHeight: \"34px\"}}>\r\n                {t(\"components.dashboardBuilder.filterLevels\")}:\r\n              </Grid>\r\n              <Grid item>\r\n                <Grid container>\r\n                  {filters.labels.map((label, idx) =>\r\n                    <Grid item key={idx} style={{marginRight: 8}}>\r\n                      <FormControlLabel\r\n                        className={classes.formLabel}\r\n                        label={getDashboardDynamicFilterLabelTranslations(t)[label]}\r\n                        control={\r\n                          <Checkbox\r\n                            style={{padding: 5}}\r\n                            checked={!!dashboard.filterLevels[label]}\r\n                            onChange={(ev, checked) => onChange({\r\n                              ...dashboard,\r\n                              filterLevels: {\r\n                                ...dashboard.filterLevels,\r\n                                [label]: checked\r\n                              }\r\n                            })}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            {(dashboard.dashboardConfig || []).map((row, idx) =>\r\n              <DashboardBuilderRow\r\n                key={idx}\r\n                t={t}\r\n                classes={classes}\r\n                defaultLanguage={defaultLanguage}\r\n                languages={languages}\r\n                dashboard={dashboard}\r\n                row={row}\r\n                rowIdx={idx}\r\n                onRowRemove={handleRowRemove}\r\n                onColAdd={handleColAdd}\r\n                onColRemove={handleColRemove}\r\n                onTypeReset={handleTypeReset}\r\n                fetchViews={(rowIdx, colIdx) => {\r\n                  fetchViews();\r\n                  setSelectedRowIdx(rowIdx);\r\n                  setSelectedColIdx(colIdx);\r\n                }}\r\n                onViewReset={handleViewReset}\r\n                onTextEdit={handleEditTextShow}\r\n                onShowTitleChange={handleShowTitleChange}\r\n                onEnableFiltersChange={handleEnableFiltersChange}\r\n                onFilterDimensionChange={handleFilterDimensionChange}\r\n              />\r\n            )}\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Grid container justify=\"center\">\r\n              <Button endIcon={<AddIcon/>} onClick={handleRowAdd}>\r\n                {t(\"components.dashboardBuilder.actions.addRow\")}\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n      )}\r\n\r\n      <Dialog\r\n        open={views !== null && views !== undefined}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={onViewsHide}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.views.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <InfiniteScrollTable\r\n            data={(views || [])}\r\n            getRowKey={({viewTemplateId}) => viewTemplateId}\r\n            columns={[\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.node\"),\r\n                dataIndex: 'nodeId',\r\n                render: (_, {nodeId}) => nodes.find(node => node.nodeId === nodeId).code,\r\n                renderText: nodeId => nodes.find(node => node.nodeId === nodeId).code,\r\n                minWidthToContent: true\r\n              },\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.datasetId\"),\r\n                dataIndex: 'datasetId',\r\n                minWidthToContent: true\r\n              },\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.name\"),\r\n                dataIndex: 'title',\r\n                minWidthToContent: true\r\n              }\r\n            ]}\r\n            multilangStrDataIndexes={[\"title\"]}\r\n            onRowClick={({__originalRow: view}) => {\r\n              handleViewSet(selectedRowIdx, selectedColIdx, view);\r\n              setSelectedRowIdx(null);\r\n              setSelectedColIdx(null);\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              onViewsHide();\r\n              setSelectedRowIdx(null);\r\n              setSelectedColIdx(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isEditTextVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={handleEditTextHide}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.text.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <I18nHtmlEditor\r\n            value={tempTextValue}\r\n            onChange={setTempTextValue}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleEditTextHide}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => handleTextChange(selectedRowIdx, selectedColIdx, tempTextValue)}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(DashboardBuilder);","import React from 'react';\r\n\r\n/* Calls a function right after the WrappedComponent has been mounted and updated (if props changed) */\r\nclass Call extends React.Component {\r\n\r\n  componentDidMount() {\r\n    /* children has been mounted */\r\n    if (this.props.disabled === undefined || !this.props.disabled) {\r\n      this.props.cb(this.props.cbParam);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate({cb, cbParam, disabled}) {\r\n    /* children has been updated */\r\n    if (\r\n      (this.props.disabled === undefined || !this.props.disabled)\r\n      &&\r\n      (\r\n        JSON.stringify(cbParam) !== JSON.stringify(this.props.cbParam)\r\n        ||\r\n        (this.props.disabled !== undefined && disabled === true && this.props.disabled === false)\r\n      )\r\n    ) {\r\n      this.props.cb(this.props.cbParam);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default Call;\r\n","import _ from \"lodash\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"../components/label-format-selector/constants\";\r\n\r\nexport const TIME_PERIOD_KEY = \"TIME_PERIOD\";\r\nexport const FREQ_KEY = \"FREQ\";\r\n\r\nconst toUpperCaseFirst = string => (string !== null && string.length > 0)\r\n  ? string[0].toUpperCase() + string.slice(1)\r\n  : string;\r\n\r\nexport const getDimensionLabelFromJsonStat = (jsonStat, dimension, format) => {\r\n  const name = toUpperCaseFirst(jsonStat.dimension[dimension].label);\r\n  const id = dimension;\r\n\r\n  return (name || id);\r\n};\r\n\r\nexport const getDimensionValueLabelFromJsonStat = (jsonStat, dimension, value, format) => {\r\n  const name = toUpperCaseFirst(jsonStat.dimension[dimension].category.label[value]);\r\n  const id = value;\r\n\r\n  if (dimension === TIME_PERIOD_KEY) {\r\n    return name;\r\n  }\r\n\r\n  switch (format) {\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME:\r\n      return name;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID:\r\n      return id;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH:\r\n      return `[${id}] ${name}`;\r\n    default:\r\n      return name;\r\n  }\r\n};\r\n\r\nexport const getDataIdxFromDimensionsArray = (dimensions, size) => {\r\n  let dataIdx = 0;\r\n  let multiplier = 1;\r\n\r\n  for (let i = 0; i < dimensions.length; i++) {\r\n    multiplier *= (i > 0) ? size[dimensions.length - i] : 1;\r\n    dataIdx += multiplier * dimensions[dimensions.length - i - 1];\r\n  }\r\n\r\n  return dataIdx;\r\n};\r\n\r\nexport const getJsonStatTableSize = (jsonStat, layout) => {\r\n  if (jsonStat) {\r\n    let count = 1;\r\n\r\n    if (!layout) {\r\n      jsonStat.size.forEach(el => count *= el);\r\n\r\n    } else {\r\n      let colCount = 1;\r\n      layout.cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n      let rowCount = 1;\r\n      layout.rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n      layout.sections.forEach(section => rowCount *= jsonStat.size[jsonStat.id.indexOf(section)]);\r\n      count = colCount * rowCount;\r\n    }\r\n\r\n    return count;\r\n\r\n  } else {\r\n    return 0\r\n  }\r\n};\r\n\r\nexport const getCombinationArrays = arrays => {\r\n  if (!arrays || arrays.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  const ret = [];\r\n  const max = arrays.length - 1;\r\n\r\n  function helper(arr, i) {\r\n    for (let j = 0, l = arrays[i].length; j < l; j++) {\r\n      const a = arr.slice(0); // clone arr\r\n      a.push(arrays[i][j]);\r\n      if (i === max) {\r\n        ret.push(a);\r\n      } else {\r\n        helper(a, i + 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  helper([], 0);\r\n  return ret;\r\n};\r\n\r\nconst getCombinationArray = (jsonStat, dimsArrays, test) => {\r\n  if (!dimsArrays || dimsArrays.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  const max = dimsArrays.length - 1;\r\n  let ret = null\r\n\r\n  function helper(arr, i) {\r\n    if (!ret) {\r\n      for (let j = 0, l = dimsArrays[i].length; j < l; j++) {\r\n        if (!ret) {\r\n          const a = arr.slice(0); // clone arr\r\n          a.push(dimsArrays[i][j]);\r\n          if (i === max) {\r\n            if (!test || test(a)) {\r\n              ret = ret || a;\r\n            }\r\n          } else {\r\n            helper(a, i + 1);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  helper([], 0);\r\n  return ret;\r\n};\r\n\r\nexport const getInitialFiltersValue = (jsonStat, layout, fixedFiltersValue) => {\r\n  if (!jsonStat.id || jsonStat.id.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const {\r\n    filters = [],\r\n    primaryDim: primaryDimArr = [],\r\n    primaryDimValues = [],\r\n    secondaryDim: secondaryDimArr = [],\r\n    secondaryDimValues = []\r\n  } = layout || {};\r\n  const primaryDim = primaryDimArr?.[0] || null;\r\n  const secondaryDim = secondaryDimArr?.[0] || null;\r\n\r\n  let dims = [];\r\n  if (primaryDim) {\r\n    dims.push(primaryDim);\r\n  }\r\n  if (secondaryDim) {\r\n    dims.push(secondaryDim);\r\n  }\r\n  if (filters.includes(TIME_PERIOD_KEY)) {\r\n    dims.push(TIME_PERIOD_KEY)\r\n  }\r\n  dims = dims.concat(filters).concat(jsonStat.id);\r\n  dims = _.uniq(dims);\r\n  dims = dims.filter(dim => jsonStat.id.includes(dim));\r\n\r\n  const indexesMap = (fixedFiltersValue || primaryDim || secondaryDim)\r\n    ? getDimensionValuesIndexesMap(jsonStat)\r\n    : null;\r\n\r\n  const primaryDimValuesIndexes = primaryDimValues.map(value => indexesMap[primaryDim][value]);\r\n  const secondaryDimValuesIndexes = secondaryDimValues.map(value => indexesMap[secondaryDim][value]);\r\n\r\n  const dimsIndexesArrays = dims.map(dim => (primaryDim && dim === primaryDim)\r\n    ? primaryDimValuesIndexes\r\n    : (secondaryDim && dim === secondaryDim)\r\n      ? secondaryDimValuesIndexes\r\n      : (!fixedFiltersValue || !Object.keys(fixedFiltersValue).includes(dim))\r\n        ? jsonStat.dimension[dim].category.index.map((_, idx) => idx)\r\n        : [indexesMap[dim][fixedFiltersValue[dim]]]\r\n  );\r\n  dimsIndexesArrays[dims.indexOf(TIME_PERIOD_KEY)].reverse();\r\n\r\n  const isValorized = (orderedDims, unorderedDims, unorderedDimCombination) => {\r\n    const orderedDimCombination = orderedDims.map(dim => unorderedDimCombination[unorderedDims.indexOf(dim)]);\r\n    const dataIdx = getDataIdxFromDimensionsArray(orderedDimCombination, jsonStat.size);\r\n    const value = jsonStat.value[dataIdx];\r\n    return (value !== null && value !== undefined);\r\n  }\r\n  const unorderedDimCombination = getCombinationArray(jsonStat, dimsIndexesArrays, combination => isValorized(jsonStat.id, dims, combination));\r\n  const orderedDimCombination = jsonStat.id.map(dim => unorderedDimCombination[dims.indexOf(dim)]);\r\n\r\n  const filtersValue = {};\r\n  jsonStat.id.forEach((dim, idx) => {\r\n    if (filters.includes(dim)) {\r\n      filtersValue[dim] = jsonStat.dimension[dim].category.index[orderedDimCombination[idx]];\r\n    }\r\n  });\r\n\r\n  return filtersValue;\r\n};\r\n\r\nexport const getFilteredLayoutObject = (jsonStat, initialLayout) => {\r\n  if (!initialLayout) {\r\n    return null\r\n  }\r\n\r\n  const layout = _.cloneDeep(initialLayout);\r\n  const dimArraysKey = [\"rows\", \"cols\", \"filters\", \"sections\", \"primaryDim\", \"secondaryDim\", \"territoryDim\"];\r\n\r\n  if (layout.territoryDim) {\r\n    layout.territoryDim = [layout.territoryDim];\r\n  }\r\n\r\n  // removing dimensions from layout not present in jsonStat\r\n  for (let key in layout) {\r\n    if (layout.hasOwnProperty(key)) {\r\n      if (dimArraysKey.includes(key)) {\r\n        layout[key] = (layout[key] || []).filter(dim => jsonStat.id.includes(dim));\r\n      }\r\n    }\r\n  }\r\n\r\n  // adding missing dimensions to layout\r\n  jsonStat.id.forEach(dim => {\r\n    let found = false;\r\n    for (let key in layout) {\r\n      if (layout.hasOwnProperty(key)) {\r\n        if (!found && dimArraysKey.includes(key)) {\r\n          found = layout[key].includes(dim);\r\n        }\r\n      }\r\n    }\r\n    if (!found) {\r\n      layout.filters.push(dim);\r\n      layout.filtersValue[dim] = jsonStat.dimension[dim].category.index[0];\r\n    }\r\n  });\r\n\r\n  // checking selected filtersValue\r\n  if (layout.filtersValue) {\r\n    for (let dim in layout.filtersValue) {\r\n      if (layout.filtersValue.hasOwnProperty(dim)) {\r\n        if (!layout.filters.includes(dim)) {\r\n          layout.filtersValue[dim] = undefined;\r\n        } else if (!jsonStat.dimension[dim].category.index.includes(layout.filtersValue[dim])) {\r\n          layout.filtersValue[dim] = jsonStat.dimension[dim].category.index[0];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // checking selected primaryDimValues\r\n  if (layout.primaryDim && layout.primaryDimValues) {\r\n    layout.primaryDimValues = layout.primaryDimValues.filter(value =>\r\n      jsonStat.dimension[layout.primaryDim].category.index.includes(value));\r\n  }\r\n\r\n  // checking selected secondaryDimValues\r\n  if (layout.secondaryDim && layout.secondaryDimValues) {\r\n    layout.secondaryDimValues = layout.secondaryDimValues.filter(value =>\r\n      jsonStat.dimension[layout.secondaryDim].category.index.includes(value));\r\n  }\r\n\r\n  if (layout.territoryDim) {\r\n    layout.territoryDim = layout.territoryDim[0];\r\n  }\r\n\r\n  return layout\r\n};\r\n\r\nexport const getUpdatedLayout = (jsonStat, layout, dimension, value) => {\r\n  let newLayout = _.cloneDeep(layout);\r\n\r\n  if ((newLayout.primaryDim || []).includes(dimension)) {\r\n    newLayout.primaryDimValues = value;\r\n    newLayout.secondaryDimValues = getChartDimensionValues(jsonStat, newLayout, false, 10);\r\n\r\n  } else if ((newLayout.secondaryDim || []).includes(dimension)) {\r\n    newLayout.secondaryDimValues = value;\r\n\r\n  } else if ((newLayout.filters || []).includes(dimension)) {\r\n    newLayout.filtersValue[dimension] = value\r\n  }\r\n\r\n  const filters = (newLayout.filters || []).filter(filter => jsonStat.size[jsonStat.id.indexOf(filter)] > 1);\r\n  const fixedFilters = filters.slice(0, filters.indexOf(dimension) + 1);\r\n  const fixedFiltersValue = {};\r\n  fixedFilters.forEach(filter => fixedFiltersValue[filter] = newLayout.filtersValue[filter]);\r\n\r\n  const tmpLayout = {\r\n    ...newLayout,\r\n    filters: filters.slice(filters.indexOf(dimension) + 1)\r\n  };\r\n\r\n  newLayout.filtersValue = {\r\n    ...newLayout.filtersValue,\r\n    ...getInitialFiltersValue(jsonStat, tmpLayout, fixedFiltersValue)\r\n  };\r\n\r\n  return newLayout\r\n};\r\n\r\nexport const getDimensionFiltersValue = (jsonStat, dimension, layout) => {\r\n  const {\r\n    filters = [],\r\n    filtersValue = {},\r\n    primaryDim: primaryDimArr = [],\r\n    primaryDimValues = [],\r\n    secondaryDim: secondaryDimArr = [],\r\n    secondaryDimValues = []\r\n  } = layout || {};\r\n  const primaryDim = primaryDimArr?.[0] || null;\r\n  const secondaryDim = secondaryDimArr?.[0] || null;\r\n\r\n  const values = [];\r\n\r\n  if ((dimension === primaryDim) || (!primaryDim && !secondaryDim && filters.filter(filter => jsonStat.size[jsonStat.id.indexOf(filter)] > 1)[0] === dimension)) {\r\n    jsonStat.dimension[dimension].category.index.forEach(dimValue => values.push({\r\n      id: dimValue,\r\n      label: jsonStat.dimension[dimension].category.label[dimValue]\r\n    }));\r\n    return values\r\n\r\n  } else {\r\n    const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n    const dimensionsNotInFilters = jsonStat.id.filter(dim => !filters.includes(dim));\r\n    const dimensionsPostFilter = filters.slice(filters.indexOf(dimension) + 1);\r\n    const dimensionsNotInFiltersAndPostFilters = dimensionsNotInFilters.concat(dimensionsPostFilter).filter(dim => dim !== dimension);\r\n\r\n    jsonStat.dimension[dimension].category.index.forEach(dimValue => {\r\n      const dimsArrays = jsonStat.id.map(dim => {\r\n        if (dimension === dim) {\r\n          return [dimValue]\r\n        } else if (dimensionsNotInFiltersAndPostFilters.includes(dim)) {\r\n          if (dim === primaryDim) {\r\n            return primaryDimValues\r\n          } else if (dim === secondaryDim) {\r\n            return secondaryDimValues\r\n          } else {\r\n            return jsonStat.dimension[dim].category.index\r\n          }\r\n        } else { // dimension in filters preceding the selected one\r\n          return [filtersValue[dim]]\r\n        }\r\n      });\r\n      const addedValues = {};\r\n      const isValorized = combination => {\r\n        const dataIndexArr = combination.map((combinationValue, idx) => indexesMap[jsonStat.id[idx]][combinationValue]);\r\n        const observation = jsonStat.value[getDataIdxFromDimensionsArray(dataIndexArr, jsonStat.size)];\r\n        return (observation !== null && observation !== undefined && !addedValues[dimValue])\r\n      };\r\n      const combinationArray = getCombinationArray(jsonStat, dimsArrays, isValorized);\r\n      if (combinationArray) {\r\n        values.push({\r\n          id: dimValue,\r\n          label: jsonStat.dimension[dimension].category.label[dimValue]\r\n        });\r\n        addedValues[dimValue] = true;\r\n      }\r\n    });\r\n    return values;\r\n  }\r\n};\r\n\r\nexport const getChartDimensionValues = (jsonStat, layout, isPrimaryDim, count) => {\r\n  const primaryDim = layout?.primaryDim?.[0] || null;\r\n  const secondaryDim = layout?.secondaryDim?.[0] || null;\r\n\r\n  if ((isPrimaryDim && !primaryDim) || (!isPrimaryDim && !secondaryDim)) {\r\n    return [];\r\n  }\r\n\r\n  const values = isPrimaryDim\r\n    ? jsonStat.dimension[primaryDim].category.index\r\n    : getDimensionFiltersValue(jsonStat, secondaryDim, layout).map(({id}) => id);\r\n\r\n  return values.slice(0, count ? count : undefined);\r\n};\r\n\r\nexport const getDimensionValuesIndexesMap = jsonStat => {\r\n  const indexesMap = {};\r\n\r\n  jsonStat.id.forEach(dim => {\r\n    indexesMap[dim] = {};\r\n    jsonStat.dimension[dim].category.index.forEach((dimValue, idx) => indexesMap[dim][dimValue] = idx);\r\n  });\r\n\r\n  return indexesMap;\r\n};\r\n\r\nexport const getAttributeObjects = (attributeList, attributeObj, hiddenAttributes) => {\r\n  const attributes = [];\r\n  const ids = [];\r\n  let hasAsterisk = false;\r\n\r\n  try {\r\n    (attributeList || []).forEach((attr, idx) => {\r\n      if (attr !== null && !(hiddenAttributes || []).includes(attributeObj[idx].id)) {\r\n        const valueId = attributeObj[idx].values[attr].id;\r\n        const valueLabel = attributeObj[idx].values[attr].name;\r\n\r\n        attributes.push({\r\n          id: attributeObj[idx].id,\r\n          label: attributeObj[idx].name,\r\n          valueId: valueId,\r\n          valueLabel: valueLabel\r\n        });\r\n\r\n        if (valueId !== valueLabel && valueId.length <= 5) {\r\n          ids.push(valueId);\r\n        } else {\r\n          hasAsterisk = true;\r\n        }\r\n      }\r\n    });\r\n\r\n    if (hasAsterisk) {\r\n      ids.push(\"(*)\");\r\n    }\r\n\r\n    return (attributes.length > 0 && ids.length > 0)\r\n      ? {\r\n        attributes,\r\n        ids\r\n      }\r\n      : null\r\n\r\n  } catch (error) {\r\n    return -1\r\n  }\r\n\r\n\r\n};\r\n\r\nexport const getDimensionAttributeMap = (jsonStat, hiddenAttributes, getIdsHtmlString) => {\r\n  if (!jsonStat) {\r\n    return null;\r\n  }\r\n\r\n  const series = (jsonStat?.extension?.attributes?.series || []);\r\n  const seriesIndexes = (jsonStat?.extension?.attributes?.index?.series || []);\r\n  const dimensionAttributesMap = {};\r\n\r\n  jsonStat.id.forEach(dim => dimensionAttributesMap[dim] = {});\r\n  if (series && series.length > 0 && seriesIndexes && seriesIndexes.length > 0) {\r\n    seriesIndexes\r\n      .filter(({coordinates}) => (coordinates || []).filter(c => c !== null).length === 1)\r\n      .forEach(index => {\r\n        const dimIdx = index.coordinates.findIndex(el => el !== null);\r\n        const dim = jsonStat.id[dimIdx];\r\n        const dimValueIdx = index.coordinates.find(el => el !== null);\r\n        const dimValue = jsonStat.dimension[dim].category.index[dimValueIdx];\r\n\r\n        const attributeObjects = getAttributeObjects(index.attributes, series, hiddenAttributes);\r\n        if (attributeObjects !== null && attributeObjects !== -1) {\r\n          dimensionAttributesMap[dim][dimValue] = {\r\n            attributes: attributeObjects.attributes,\r\n            ids: attributeObjects.ids,\r\n            htmlString: getIdsHtmlString\r\n              ? getIdsHtmlString(attributeObjects.ids, dim, dimValue)\r\n              : null\r\n          };\r\n        }\r\n      });\r\n  }\r\n\r\n  return dimensionAttributesMap;\r\n};\r\n\r\nexport const getCompleteTableLayout = (initialLayout, jsonStat) => {\r\n  const layout = _.cloneDeep(initialLayout);\r\n\r\n  layout.rows = (initialLayout.rows || []).filter(dim => jsonStat.id.includes(dim));\r\n  layout.cols = (initialLayout.cols || []).filter(dim => jsonStat.id.includes(dim));\r\n  layout.sections = (initialLayout.sections || []).filter(dim => jsonStat.id.includes(dim));\r\n\r\n  layout.filters = [];\r\n  jsonStat.id.forEach(dim => {\r\n    if (!layout.rows.includes(dim) && !layout.cols.includes(dim) && !layout.sections.includes(dim)) {\r\n      layout.filters.push(dim);\r\n    }\r\n  })\r\n\r\n  layout.filtersValue = getInitialFiltersValue(jsonStat, layout);\r\n\r\n  return layout\r\n};","export const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME = \"LABEL_FORMAT_SELECTOR_FORMAT_NAME\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID = \"LABEL_FORMAT_SELECTOR_FORMAT_ID\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH = \"LABEL_FORMAT_SELECTOR_FORMAT_BOTH\";","export const numberFormatter = (new Intl.NumberFormat()).format;\r\n\r\nexport const DECIMAL_SEPARATOR_DEFAULT = \",\";\r\nexport const DECIMAL_PLACES_DEFAULT = 2;\r\nexport const EMPTY_CHAR_DEFAULT = \"\";\r\n\r\nconst getFormattedInt = (value, separator) => {\r\n  let str = value + \"\";\r\n  let subStrs = [];\r\n\r\n  while (str.length > 3) {\r\n    subStrs.push(str.slice(-3));\r\n    str = str.slice(0, -3)\r\n    subStrs.push((separator || \".\"));\r\n  }\r\n  if (str.length > 0) {\r\n    subStrs.push(str);\r\n  } else {\r\n    subStrs.pop()\r\n  }\r\n  subStrs.reverse();\r\n\r\n  let ret = \"\";\r\n  subStrs.forEach(subStr => ret += subStr);\r\n\r\n  return ret;\r\n};\r\n\r\nexport const getFormattedValue = (value, decimalSeparator, decimalPlaces, emptyChar) => {\r\n\r\n  if (value === null || value === undefined) {\r\n    return (emptyChar || EMPTY_CHAR_DEFAULT);\r\n  }\r\n\r\n  if (isNaN(value)) {\r\n    return value;\r\n  }\r\n\r\n  const intSeparator = decimalSeparator === \".\" ? \",\" : \".\";\r\n\r\n  if (Number.isInteger(value)) {\r\n    return getFormattedInt(value, intSeparator);\r\n  }\r\n\r\n  const int = Math.floor(value);\r\n\r\n  if (decimalPlaces === 0 || DECIMAL_PLACES_DEFAULT === 0) {\r\n    return getFormattedInt(int, intSeparator);\r\n  }\r\n\r\n  const decimal = (value - int).toFixed(decimalPlaces || DECIMAL_PLACES_DEFAULT).slice(2);\r\n\r\n  return getFormattedInt(int, intSeparator) + (decimalSeparator || DECIMAL_SEPARATOR_DEFAULT) + decimal;\r\n}","import {\r\n  getAttributeObjects,\r\n  getCombinationArrays,\r\n  getDataIdxFromDimensionsArray,\r\n  getDimensionAttributeMap,\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat\r\n} from \"../../utils/jsonStat\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport {getFormattedValue} from \"../../utils/formatters\";\r\nimport _ from \"lodash\";\r\n\r\nconst JSONSTAT_TABLE_PREVIEW_PLACEHOLDER = \"xxx\";\r\nconst JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR = '<svg height=\"6px\" width=\"6px\" fill=\"#00295a\"><path d=\"M 0 0 H 6 V 6 H 0 Z\"/></svg>';\r\n\r\nconst extendArr = (array, n) => {\r\n  let arrays = Array.apply(null, new Array(n / array.length));\r\n  arrays = arrays.map(() => array);\r\n  return [].concat.apply([], arrays);\r\n};\r\n\r\nconst getObj = (jsonStat, arr, length, isPreview) => {\r\n  const obj = {};\r\n  arr.forEach((el, idx) => {\r\n    const repCount = idx === 0\r\n      ? length / jsonStat.size[jsonStat.id.indexOf(el)]\r\n      : obj[arr[idx - 1]].repCount / jsonStat.size[jsonStat.id.indexOf(el)];\r\n\r\n    obj[el] = {\r\n      repCount: repCount,\r\n      ids: [],\r\n      labels: [],\r\n      indexesMap: {}\r\n    };\r\n    if (!isPreview) {\r\n      jsonStat.dimension[el].category.index.forEach((value, idx) => {\r\n        for (let j = 0; j < repCount; j++) {\r\n          obj[el].ids.push(value);\r\n          obj[el].labels.push(jsonStat.dimension[el].category.label[value]);\r\n          obj[el].indexesMap[value] = idx;\r\n        }\r\n      })\r\n    }\r\n  });\r\n  if (!isPreview) {\r\n    arr.forEach(el => {\r\n      if (obj[el].ids.length < length) {\r\n        obj[el].ids = extendArr(obj[el].ids, length);\r\n        obj[el].labels = extendArr(obj[el].labels, length);\r\n      }\r\n    });\r\n  }\r\n\r\n  return obj\r\n};\r\n\r\nconst getValorizedElCount = array => {\r\n  let count = 0;\r\n\r\n  array.forEach(el => {\r\n    if (el === true) {\r\n      count++;\r\n    }\r\n  });\r\n\r\n  return count;\r\n};\r\n\r\nconst getCorrespondingIndexInFilteredArray = (array, n) => {\r\n  let count = 0;\r\n  let res = 0;\r\n  let lastIdx = 0;\r\n  let found = false;\r\n\r\n  array.forEach((el, idx) => {\r\n    if (el === true) {\r\n      count++;\r\n      lastIdx = idx;\r\n      if (count === n + 1) {\r\n        res = idx;\r\n        found = true;\r\n      }\r\n    }\r\n  });\r\n\r\n  return found ? res : (lastIdx + 1);\r\n};\r\n\r\nexport const getJsonStatLayoutObjects = (jsonStat, rows, cols, sections, filters, filtersValue, isPreview) => {\r\n\r\n  /** rows handling **/\r\n  let rowCount = 1;\r\n  (rows || []).forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n  const rowsObj = (rows || []).length > 0\r\n    ? getObj(jsonStat, rows, rowCount, isPreview)\r\n    : {};\r\n\r\n  /** cols handling **/\r\n  let colCount = 1;\r\n  (cols || []).forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  const colsObj = (cols || []).length > 0\r\n    ? getObj(jsonStat, cols, colCount, isPreview)\r\n    : {};\r\n\r\n  /** sections handling **/\r\n  const sectionArray = [];\r\n  (sections || []).forEach(section => sectionArray.push(jsonStat.dimension[section].category.index));\r\n  const combinations = sectionArray.length > 0\r\n    ? getCombinationArrays(sectionArray)\r\n    : [];\r\n\r\n  /** indexes map handling **/\r\n  const indexesMap = {};\r\n  rows.forEach(row => indexesMap[row] = rowsObj[row].indexesMap);\r\n  cols.forEach(col => indexesMap[col] = colsObj[col].indexesMap);\r\n  sections.forEach(section => {\r\n    indexesMap[section] = {};\r\n    jsonStat.dimension[section].category.index.forEach((val, idx) => indexesMap[section][val] = idx);\r\n  });\r\n  filters.forEach(filter => {\r\n    indexesMap[filter] = {};\r\n    jsonStat.dimension[filter].category.index.forEach((val, idx) => indexesMap[filter][val] = idx);\r\n  });\r\n\r\n  return {\r\n    rowCount,\r\n    rowsObj,\r\n    colCount,\r\n    colsObj,\r\n    combinations,\r\n    indexesMap\r\n  }\r\n};\r\n\r\nconst getCellAttributeIdsElem = (ids, id, isDataCell) => {\r\n  let idElems = \"\";\r\n  const astElem = ' <span class=\"ct-a\">(*)</span> ';\r\n\r\n  if (!ids || ids.length === 0) {\r\n    return \"\";\r\n\r\n  } else {\r\n    if (ids.join(\"\").length > 7) {\r\n      idElems += astElem;\r\n    } else {\r\n      ids.forEach(id => {\r\n        idElems += ` <span class=\"${id === \"(*)\" ? 'ct-a' : 'ct-c'}\">${id}</span> `;\r\n      })\r\n    }\r\n  }\r\n\r\n  return ` <span id=\"${id}\" class=\"ct ${isDataCell ? 'ctd' : 'ctsh'}\">${idElems}</span> `\r\n};\r\n\r\nexport const getJsonStatTableSupportStructures = (jsonStat, layout, isPreview, removeEmptyLines, hiddenAttributes) => {\r\n  const {\r\n    rows,\r\n    cols,\r\n    filters,\r\n    filtersValue,\r\n    sections\r\n  } = layout;\r\n\r\n  const {\r\n    rowCount,\r\n    rowsObj,\r\n    colCount,\r\n    colsObj,\r\n    combinations,\r\n    indexesMap\r\n  } = getJsonStatLayoutObjects(jsonStat, rows, cols, sections, filters, filtersValue, isPreview);\r\n\r\n  /** empty rows & cols handling **/\r\n\r\n  let valorizedRowsPerSection = (combinations && combinations.length > 0)\r\n    ? combinations.map(() => [])\r\n    : [[]];\r\n  let valorizedCols = [];\r\n\r\n  if (removeEmptyLines) {\r\n    valorizedRowsPerSection = valorizedRowsPerSection.map(() => new Array(rowCount).fill(false));\r\n    valorizedCols = new Array(colCount).fill(false);\r\n\r\n    const setValorizedLines = (combination, idx) => {\r\n\r\n      const dataObj = {\r\n        ...filtersValue\r\n      };\r\n      sections.forEach((section, idx) => dataObj[section] = combination[idx]);\r\n\r\n      for (let r = 0; r < rowCount; r++) {\r\n\r\n        rows.forEach(row => dataObj[row] = rowsObj[row].ids[r]);\r\n\r\n        for (let c = 0; c < colCount; c++) {\r\n\r\n          if (!(valorizedRowsPerSection[idx][r] === true && valorizedCols[c] === true)) {\r\n\r\n            cols.forEach(col => dataObj[col] = colsObj[col].ids[c]);\r\n\r\n            const dataIndexArr = jsonStat.id.map(dim => indexesMap[dim][dataObj[dim]]);\r\n\r\n            const value = jsonStat.value[getDataIdxFromDimensionsArray(dataIndexArr, jsonStat.size)];\r\n\r\n            if (value !== null && value !== undefined) {\r\n              valorizedRowsPerSection[idx][r] = true;\r\n              valorizedCols[c] = true;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    if (sections && sections.length > 0) {\r\n      combinations.forEach((combination, idx) => setValorizedLines(combination, idx));\r\n    } else {\r\n      setValorizedLines(null, 0)\r\n    }\r\n\r\n  } else {\r\n    valorizedRowsPerSection = valorizedRowsPerSection.map(() => new Array(rowCount).fill(true));\r\n    valorizedCols = new Array(colCount).fill(true);\r\n  }\r\n\r\n  let totalRowCount = 0;\r\n  valorizedRowsPerSection.forEach(section => totalRowCount += getValorizedElCount(section))\r\n\r\n  let valorizedRows;\r\n  if (Array.prototype.flat) {\r\n    valorizedRows = valorizedRowsPerSection.flat();\r\n  } else {\r\n    valorizedRows = [];\r\n    valorizedRowsPerSection.forEach(section => valorizedRows = valorizedRows.concat(section));\r\n  }\r\n\r\n  /** dimension attributes handling **/\r\n  const dimensionAttributesMap = getDimensionAttributeMap(\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    (ids, dim, dimValue) => getCellAttributeIdsElem(ids, `${dim},${dimValue}`, false)\r\n  );\r\n\r\n  /** observation attributes handling **/\r\n  const observations = (jsonStat?.extension?.attributes?.observation || []);\r\n  const observationIndexes = (jsonStat?.extension?.attributes?.index?.observation || {});\r\n  const observationAttributesMap = _.cloneDeep(observationIndexes);\r\n\r\n  let hasAttributeObservationError = false;\r\n  for (let key in observationAttributesMap) {\r\n    if (observationAttributesMap.hasOwnProperty(key)) {\r\n      const attributeObjects = getAttributeObjects(observationAttributesMap[key], observations, hiddenAttributes);\r\n      if (attributeObjects !== null && attributeObjects !== -1) {\r\n        observationAttributesMap[key] = {\r\n          attributes: attributeObjects.attributes,\r\n          ids: attributeObjects.ids,\r\n          htmlString: getCellAttributeIdsElem(attributeObjects.ids, key, true)\r\n        };\r\n      } else if (attributeObjects === -1) {\r\n        hasAttributeObservationError = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    rows,\r\n    cols,\r\n    sections,\r\n    filters,\r\n    filtersValue,\r\n    colCount: getValorizedElCount(valorizedCols),\r\n    rowCount: (combinations && combinations.length > 0)\r\n      ? totalRowCount\r\n      : getValorizedElCount(valorizedRowsPerSection[0]),\r\n    colsObj,\r\n    rowsObj,\r\n    combinations,\r\n    indexesMap,\r\n    valorizedCols,\r\n    valorizedRows,\r\n    valorizedRowsPerSection,\r\n    sectionsLength: valorizedRowsPerSection[0].length,\r\n    dimensionAttributesMap,\r\n    observationAttributesMap,\r\n    hasAttributeObservationError\r\n  }\r\n};\r\n\r\nconst getTableRightPadding = padding => padding\r\n  ? `<td class=\"c c-rb\" style=\"min-width: ${padding}px;\">`\r\n  : \"\";\r\n\r\nexport const getJsonStatTableHtml = (\r\n  jsonStat,\r\n  rows,\r\n  cols,\r\n  sections,\r\n  filters,\r\n  filtersValue,\r\n  colCount,\r\n  rowCount,\r\n  colsObj,\r\n  rowsObj,\r\n  combinations,\r\n  indexesMap,\r\n  valorizedCols,\r\n  valorizedRows,\r\n  valorizedRowsPerSection,\r\n  sectionsLength,\r\n  labelFormat,\r\n  fontSize,\r\n  decimalSeparator,\r\n  decimalPlaces,\r\n  emptyChar,\r\n  isPreview,\r\n  paginationParams,\r\n  dimensionAttributesMap,\r\n  observationAttributesMap,\r\n  onTimeSet\r\n) => {\r\n\r\n  /** pagination **/\r\n\r\n  const origColStart = paginationParams ? paginationParams.colStart : 0;\r\n  const origColEnd = paginationParams ? paginationParams.colEnd : colCount;\r\n\r\n  const rowStart = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedRows, paginationParams.rowStart)\r\n    : getCorrespondingIndexInFilteredArray(valorizedRows, 0);\r\n\r\n  const rowEnd = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedRows, paginationParams.rowEnd)\r\n    : getValorizedElCount(valorizedRows);\r\n\r\n  const colStart = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedCols, paginationParams.colStart)\r\n    : getCorrespondingIndexInFilteredArray(valorizedCols, 0);\r\n\r\n  const colEnd = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedCols, paginationParams.colEnd)\r\n    : getValorizedElCount(valorizedCols);\r\n\r\n  const t0 = performance.now();\r\n\r\n  /** HTML generating **/\r\n\r\n  let table = `<table id=\"${uuidv4()}\">`;\r\n\r\n  /** table head **/\r\n\r\n  table += '<thead>';\r\n\r\n  cols.forEach((col, idx) => {\r\n    table += `<tr data-row-key=\"h-${idx}\">`;\r\n    table += `<th class=\"c cf${fontSize} ch cl0\" colspan=\"${rows.length}\">${getDimensionLabelFromJsonStat(jsonStat, col, labelFormat)}</th>`;\r\n\r\n    if (!isPreview) {\r\n\r\n      let c = colStart;\r\n      let colVisited = origColStart;\r\n      while (colVisited < origColEnd) {\r\n\r\n        const cc = c;\r\n        let fullColSpan = colsObj[col].ids.slice(c, c + colsObj[col].repCount).filter(el => el === colsObj[col].ids[cc]).length;\r\n\r\n        let colSpan = valorizedCols.slice(c, c + fullColSpan).filter(el => el === true).length;\r\n\r\n        if (colVisited + colSpan > origColEnd) {\r\n          colSpan = origColEnd - colVisited;\r\n        }\r\n\r\n        if (colSpan > 0) {\r\n\r\n          const htmlString = (dimensionAttributesMap?.[col]?.[colsObj[col].ids[c]]?.htmlString || \"\");\r\n\r\n          table += (\r\n            `<th class=\"c cf${fontSize} csh ${htmlString.length > 0 ? 'ca' : ''}\" colspan=\"${colSpan}\">` +\r\n            getDimensionValueLabelFromJsonStat(jsonStat, col, colsObj[col].ids[c], labelFormat) +\r\n            htmlString +\r\n            `</th>`\r\n          );\r\n        }\r\n\r\n        c += fullColSpan;\r\n        colVisited += colSpan;\r\n      }\r\n\r\n    } else {\r\n      for (let c = 0; c < 3; c++) {\r\n        table += `<th class=\"c cf${fontSize} csh\" colspan=\"1\">${JSONSTAT_TABLE_PREVIEW_PLACEHOLDER}</th>`;\r\n      }\r\n    }\r\n\r\n    table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n    table += '</tr>';\r\n  });\r\n\r\n  if (rows.length > 0) {\r\n    table += `<tr data-row-key=\"hh\">`;\r\n    rows.forEach((row, idx) => table += `<th class=\"c cf${fontSize} ch cl${idx}\">${getDimensionLabelFromJsonStat(jsonStat, row, labelFormat)}</th>`);\r\n    if (!isPreview) {\r\n      table += `<th class=\"c cf${fontSize} csh\" colspan=\"${origColEnd - origColStart}\"/>`;\r\n    } else {\r\n      table += `<th class=\"c cf${fontSize} csh\" colspan=\"${cols.length > 0 ? 3 : 1}\"/>`;\r\n    }\r\n    table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n    table += '</tr>';\r\n  }\r\n\r\n  table += '</thead>';\r\n\r\n  /** table body **/\r\n\r\n  table += '<tbody id=\"body\">';\r\n\r\n  if (!isPreview) {\r\n\r\n    const sectionsStarts = [0];\r\n    valorizedRowsPerSection.forEach((valorizedRows, idx) => sectionsStarts.push(sectionsStarts[idx] + valorizedRows.length));\r\n\r\n    const subHeaderHandled = {};\r\n    rows.forEach(row => subHeaderHandled[row] = -1);\r\n\r\n    let currentSectionIdx = 0;\r\n    for (let i = 0; i < sectionsStarts.length; i++) {\r\n      if (rowStart >= sectionsStarts[i] && (i === sectionsStarts.length - 1 || rowStart < sectionsStarts[i + 1])) {\r\n        currentSectionIdx = i;\r\n      }\r\n    }\r\n\r\n    const getSectionRow = currentSectionIdx => {\r\n      let sectionRow = `<tr data-row-key=\"s-${currentSectionIdx}\" class=\"rs\">`;\r\n      let sectionLabel = \"\";\r\n      const currentSectionIdxClone = currentSectionIdx;\r\n      sections.forEach((section, idx) => {\r\n\r\n        const htmlString = (dimensionAttributesMap?.[section]?.[combinations[currentSectionIdxClone][idx]]?.htmlString || \"\");\r\n\r\n        sectionLabel += (\r\n          `<span class=\"${htmlString.length > 0 ? 'ca' : ''}\" style=\"display: inline-block;\">` +\r\n          `<span class=\"cs-d\">${getDimensionLabelFromJsonStat(jsonStat, section, labelFormat)}:</span> ${getDimensionValueLabelFromJsonStat(jsonStat, section, combinations[currentSectionIdxClone][idx], labelFormat)}` +\r\n          htmlString +\r\n          '</span>'\r\n        );\r\n        sectionLabel += idx < (sections.length - 1) ? `<span style=\"display: inline-block; margin: 0 8px\">${JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR}</span>` : '';\r\n      });\r\n\r\n      sectionRow += `<th class=\"c cf${fontSize} cs\" colspan=\"${origColEnd - origColStart + (rows.length || 1)}\">${sectionLabel}</th>`;\r\n\r\n      sectionRow += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n      sectionRow += '</tr>';\r\n\r\n      return sectionRow;\r\n    }\r\n\r\n    if (sections && sections.length > 0) {\r\n      table += getSectionRow(currentSectionIdx);\r\n    }\r\n\r\n    for (let r = rowStart; r < rowEnd; r++) {\r\n\r\n      if (sections && sections.length > 0) {\r\n        if (r > rowStart && sectionsStarts.indexOf(r) !== -1) {\r\n          currentSectionIdx = sectionsStarts.indexOf(r);\r\n          table += getSectionRow(currentSectionIdx);\r\n        }\r\n      }\r\n\r\n      if (valorizedRows[r] === true) {\r\n\r\n        table += `<tr data-row-key=\"r-${r}\">`;\r\n\r\n        let subHeader = \"\";\r\n\r\n        if (rows.length > 0) {\r\n          for (let rr = 0; rr < rows.length; rr++) {\r\n\r\n            const htmlString = (dimensionAttributesMap?.[rows[rr]]?.[rowsObj[rows[rr]].ids[r % sectionsLength]]?.htmlString || \"\");\r\n\r\n            if (r > subHeaderHandled[rows[rr]]) {\r\n\r\n              let rowSpan = valorizedRows.slice(r, r + (rowsObj[rows[rr]].repCount - (r % rowsObj[rows[rr]].repCount))).filter(el => el === true).length;\r\n              if (r + rowSpan > rowEnd) {\r\n                rowSpan = rowEnd - r;\r\n              }\r\n\r\n              subHeaderHandled[rows[rr]] = r + (rowsObj[rows[rr]].repCount - (r % rowsObj[rows[rr]].repCount)) - 1;\r\n\r\n              if (rowSpan > 0) {\r\n                subHeader += (\r\n                  `<th class=\"c cf${fontSize} csh cl${rr} ${htmlString.length > 0 ? 'ca' : ''}\" rowspan=\"${rowSpan}\">` +\r\n                  getDimensionValueLabelFromJsonStat(jsonStat, rows[rr], rowsObj[rows[rr]].ids[r % sectionsLength], labelFormat) +\r\n                  htmlString +\r\n                  `</th>`\r\n                );\r\n              }\r\n            }\r\n          }\r\n\r\n        } else {\r\n          subHeader += `<th class=\"c cf${fontSize} csh cl0\"/>`\r\n        }\r\n\r\n        table += subHeader;\r\n\r\n        const getDataCell = (c, currentSectionIdx) => {\r\n\r\n          const dataObj = {\r\n            ...filtersValue\r\n          };\r\n          rows.forEach(row => dataObj[row] = rowsObj[row].ids[r % sectionsLength]);\r\n          cols.forEach(col => dataObj[col] = colsObj[col].ids[c]);\r\n          sections.forEach((section, idx) => dataObj[section] = combinations[currentSectionIdx][idx]);\r\n\r\n          const dataIndexArr = jsonStat.id.map(dim => indexesMap[dim][dataObj[dim]]);\r\n\r\n          const dataIdx = getDataIdxFromDimensionsArray(dataIndexArr, jsonStat.size);\r\n          const value = jsonStat.value[dataIdx];\r\n\r\n          const htmlString = (observationAttributesMap[dataIdx]?.htmlString || \"\");\r\n\r\n          return (\r\n            `<td id=\"${dataIdx}\" class=\"c cf${fontSize} ${htmlString.length > 0 ? 'ca' : ''}\">` +\r\n            htmlString +\r\n            getFormattedValue(value, decimalSeparator, decimalPlaces, emptyChar) +\r\n            `</td>`\r\n          );\r\n        }\r\n\r\n        if (valorizedRows[r] === true) {\r\n          for (let c = colStart; c < colEnd; c++) {\r\n            if (valorizedCols[c] === true) {\r\n              table += getDataCell(c, currentSectionIdx);\r\n            }\r\n          }\r\n\r\n        } else {\r\n          for (let c = colStart; c < colEnd; c++) {\r\n            table += getDataCell(c, currentSectionIdx);\r\n          }\r\n        }\r\n\r\n        table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n        table += '</tr>';\r\n      }\r\n\r\n    }\r\n\r\n    table += `<tr><td class=\"c c-bb\" colspan=\"${rows.length + (origColEnd - origColStart + (rows.length > 0 ? 0 : 1))}\"></td></tr>`;\r\n\r\n  } else {\r\n\r\n    if (sections && sections.length > 0) {\r\n      table += `<tr data-row-key=\"s-0\" class=\"rs\">`;\r\n      let sectionLabel = \"\";\r\n      sections.forEach((section, idx) => {\r\n        sectionLabel += `<span style=\"display: inline-block;\"><span class=\"cs-d\">${getDimensionLabelFromJsonStat(jsonStat, section, labelFormat)}:</span> ${JSONSTAT_TABLE_PREVIEW_PLACEHOLDER}</span>`;\r\n        sectionLabel += idx < (sections.length - 1) ? `<span style=\"display: inline-block; margin: 0 8px\">${JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR}</span>` : '';\r\n      });\r\n      table += `<th class=\"c cf${fontSize} cs\" colspan=\"${(rows.length || 1) + (cols.length > 0 ? 3 : 1)}\">${sectionLabel}</th>`;\r\n      table += getTableRightPadding(1);\r\n      table += '</tr>';\r\n    }\r\n    for (let r = 0; r < (rows.length > 0 ? 3 : 1); r++) {\r\n      table += `<tr data-row-key=\"r-${r}\">`;\r\n      if (rows.length > 0) {\r\n        for (let rr = 0; rr < rows.length; rr++) {\r\n          table += `<th class=\"c cf${fontSize} csh cl${rr}\">xxx</th>`;\r\n        }\r\n      } else {\r\n        table += `<th class=\"c cf${fontSize} csh cl0\">&nbsp;</th>`\r\n      }\r\n      for (let c = 0; c < (cols.length > 0 ? 3 : 1); c++) {\r\n        table += `<td class=\"c cf${fontSize}\"/>`;\r\n      }\r\n      table += getTableRightPadding(1);\r\n      table += '</tr>';\r\n    }\r\n    table += `<tr><td class=\"c c-bb\" colspan=\"${(rows.length || 1) + (cols.length > 0 ? 3 : 1)}\"></td></tr>`;\r\n  }\r\n\r\n  table += '</tbody>';\r\n\r\n  table += '</table>';\r\n\r\n  table += '<div id=\"jsonstat-table__tooltip\" class=\"ctt\"/>'\r\n\r\n  const t1 = performance.now();\r\n  if (!isPreview) {\r\n    onTimeSet(Math.round((t1 - t0) * 100) / 100);\r\n  }\r\n\r\n  return table;\r\n};","import React, {useCallback, useEffect, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport ArrowLeftIcon from '@material-ui/icons/ArrowLeft';\r\nimport ArrowRightIcon from '@material-ui/icons/ArrowRight';\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nlet timeoutID = null;\r\nconst SCROLLBARS_TIMEOUT = 100;\r\nlet intervalID = null;\r\nconst SCROLLBARS_INTERVAL = 200;\r\n\r\nlet isOnMouseDownOnSliderThumb = null;\r\n\r\nconst WHEEL_DELTA = 1;\r\n\r\nexport const SLIDER_WIDTH = 32;\r\nconst SLIDER_MARGIN = 4;\r\n\r\nconst SLIDER_RAIL_COLOR = \"#cfcfcf\";\r\nconst SLIDER_POINTER_COLOR = \"#808080\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sliderButton: {\r\n    width: SLIDER_WIDTH,\r\n    height: SLIDER_WIDTH,\r\n    padding: 0,\r\n    \"& svg\": {\r\n      width: SLIDER_WIDTH,\r\n      height: SLIDER_WIDTH,\r\n    }\r\n  },\r\n  horizontalSlider: {\r\n    color: SLIDER_POINTER_COLOR,\r\n    \"& span.MuiSlider-rail\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    },\r\n    \"& span.MuiSlider-track\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    }\r\n  },\r\n  verticalSlider: {\r\n    color: SLIDER_POINTER_COLOR,\r\n    \"& span.MuiSlider-rail\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    },\r\n    \"& span.MuiSlider-track\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    }\r\n  },\r\n  spinnerOverlay: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    position: \"absolute\",\r\n    top: 0,\r\n    left: 0\r\n  }\r\n});\r\n\r\nconst isEventInContainer = (ev, container) => {\r\n  const containerRect = container.getBoundingClientRect();\r\n  const BUFFER = 32;\r\n\r\n  return (\r\n    ev.clientY >= (containerRect.top - BUFFER) &&\r\n    ev.clientY <= (containerRect.bottom + BUFFER) &&\r\n    ev.clientX >= (containerRect.left - BUFFER) &&\r\n    ev.clientX <= (containerRect.right + BUFFER)\r\n  );\r\n};\r\n\r\nfunction CustomSlider(props) {\r\n  const {\r\n    uuid,\r\n    classes,\r\n    orientation,\r\n    value,\r\n    maxValue,\r\n    onChange,\r\n    onIncrement,\r\n    ticks,\r\n    isVerticalScrollbarVisible\r\n  } = props;\r\n\r\n  useEffect(() => {\r\n    const onMouseUp = () => {\r\n      clearInterval(intervalID);\r\n      isOnMouseDownOnSliderThumb = null;\r\n    }\r\n    window.addEventListener(\"mouseup\", onMouseUp);\r\n    return () => window.removeEventListener(\"mouseup\", onMouseUp);\r\n  }, []);\r\n\r\n  const handleChange = (value, ev, newValue, sliderId) => {\r\n    const step = Math.ceil(ticks / 10);\r\n\r\n    if (ev.type === \"mousedown\") {\r\n\r\n      isOnMouseDownOnSliderThumb = isEventInContainer(ev, $(`#${sliderId} span.MuiSlider-thumb`)[0]);\r\n\r\n      if (newValue < value) {\r\n        if ((value - step) > newValue) {\r\n          onIncrement(false, step, newValue);\r\n          clearInterval(intervalID);\r\n          intervalID = setInterval(\r\n            () => onIncrement(false, step, newValue),\r\n            SCROLLBARS_INTERVAL\r\n          );\r\n        } else {\r\n          onChange(newValue);\r\n        }\r\n      } else {\r\n        if ((value + step) < newValue) {\r\n          onIncrement(true, step, newValue);\r\n          clearInterval(intervalID);\r\n          intervalID = setInterval(\r\n            () => onIncrement(true, step, newValue),\r\n            SCROLLBARS_INTERVAL\r\n          );\r\n        } else {\r\n          onChange(newValue);\r\n        }\r\n      }\r\n\r\n    } else if (ev.type === \"mousemove\" && isOnMouseDownOnSliderThumb) {\r\n      onChange(newValue);\r\n    }\r\n  };\r\n\r\n  return orientation === \"vertical\"\r\n    ? (\r\n      <div style={{width: SLIDER_WIDTH, height: \"100%\", display: \"inline-block\", verticalAlign: \"top\"}}>\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          onMouseDown={() => {\r\n            if (value > 0) {\r\n              onIncrement(false, 1);\r\n              intervalID = setInterval(\r\n                () => onIncrement(false, 1),\r\n                SCROLLBARS_INTERVAL\r\n              );\r\n            }\r\n          }}\r\n          disabled={value === 0}\r\n        >\r\n          <ArrowDropUpIcon/>\r\n        </IconButton>\r\n        <Slider\r\n          id={`sliders__custom-sliders__vertical__${uuid}`}\r\n          orientation=\"vertical\"\r\n          value={ticks - value}\r\n          min={0}\r\n          max={ticks}\r\n          onChange={(ev, newValue) => {\r\n            const invertedValue = (ticks - newValue);\r\n            handleChange(value, ev, invertedValue, `sliders__custom-sliders__vertical__${uuid}`)\r\n          }}\r\n          track=\"inverted\"\r\n          className={classes.verticalSlider}\r\n          style={{\r\n            height: `calc(100% - ${SLIDER_WIDTH + SLIDER_WIDTH + SLIDER_MARGIN + SLIDER_MARGIN}px)`,\r\n            padding: \"0 15px\",\r\n            margin: `${SLIDER_MARGIN}px 0`\r\n          }}\r\n        />\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          onMouseDown={() => {\r\n            if (value < (maxValue - 1)) {\r\n              onIncrement(true, 1);\r\n              intervalID = setInterval(\r\n                () => onIncrement(true, 1),\r\n                SCROLLBARS_INTERVAL\r\n              );\r\n            }\r\n          }}\r\n          disabled={value >= (maxValue - 1)}\r\n        >\r\n          <ArrowDropDownIcon/>\r\n        </IconButton>\r\n      </div>\r\n    )\r\n    : (\r\n      <div style={{width: \"100%\", height: SLIDER_WIDTH, display: \"inline-block\", verticalAlign: \"middle\"}}>\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          style={{display: \"inline-block\", verticalAlign: \"middle\"}}\r\n          onMouseDown={() => {\r\n            onIncrement(false, 1);\r\n            intervalID = setInterval(\r\n              () => onIncrement(false, 1),\r\n              SCROLLBARS_INTERVAL\r\n            );\r\n          }}\r\n          disabled={value === 0}\r\n        >\r\n          <ArrowLeftIcon fontSize=\"small\"/>\r\n        </IconButton>\r\n        <Slider\r\n          id={`sliders__custom-sliders__horizontal__${uuid}`}\r\n          orientation=\"horizontal\"\r\n          value={value}\r\n          min={0}\r\n          max={ticks}\r\n          onChange={(ev, newValue) => handleChange(value, ev, newValue, `sliders__custom-sliders__horizontal__${uuid}`)}\r\n          className={classes.horizontalSlider}\r\n          style={{\r\n            width: `calc(100% - ${SLIDER_WIDTH + SLIDER_WIDTH + SLIDER_MARGIN + SLIDER_MARGIN + (isVerticalScrollbarVisible ? SLIDER_WIDTH : 0)}px)`,\r\n            padding: \"15px 0\",\r\n            display: \"inline-block\",\r\n            verticalAlign: \"middle\",\r\n            margin: `0 ${SLIDER_MARGIN}px`\r\n          }}\r\n        />\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          style={{display: \"inline-block\", verticalAlign: \"middle\"}}\r\n          onMouseDown={() => {\r\n            onIncrement(true, 1);\r\n            intervalID = setInterval(\r\n              () => onIncrement(true, 1),\r\n              SCROLLBARS_INTERVAL\r\n            );\r\n          }}\r\n          disabled={value >= (maxValue - 1)}\r\n        >\r\n          <ArrowRightIcon/>\r\n        </IconButton>\r\n        {isVerticalScrollbarVisible && (\r\n          <div style={{width: SLIDER_WIDTH, height: SLIDER_WIDTH, display: \"inline-block\", verticalAlign: \"middle\"}}/>\r\n        )}\r\n      </div>\r\n    )\r\n}\r\n\r\nfunction Scrollbars(props) {\r\n  const {\r\n    classes,\r\n    children,\r\n    verticalValue,\r\n    verticalMaxValue,\r\n    verticalTicks,\r\n    onVerticalScroll,\r\n    isVerticalScrollbarVisible,\r\n    horizontalValue,\r\n    horizontalMaxValue,\r\n    horizontalTicks,\r\n    onHorizontalScroll,\r\n    isHorizontalScrollbarVisible\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [row, setRow] = useState(verticalValue);\r\n  const [col, setCol] = useState(horizontalValue);\r\n\r\n  const [isPaginating, setIsPaginating] = useState(false);\r\n\r\n  const handleSliderScroll = (value, isVertical) => {\r\n    if (isVertical) {\r\n      setRow(value);\r\n      if (value !== row) {\r\n        setIsPaginating(true);\r\n      }\r\n    } else {\r\n      setCol(value);\r\n      if (value !== col) {\r\n        setIsPaginating(true);\r\n      }\r\n    }\r\n  };\r\n\r\n  const getIncrementedValue = (prevValue, delta, isIncrement, limit) => isIncrement\r\n    ? (prevValue + delta) > limit\r\n      ? limit\r\n      : (prevValue + delta)\r\n    : (prevValue - delta) < limit\r\n      ? limit\r\n      : (prevValue - delta);\r\n\r\n  const handleIncrement = (isIncrement, isVertical, delta, limit) => isVertical\r\n    ? setRow(prevRow => isIncrement\r\n      ? getIncrementedValue(prevRow, delta, isIncrement, (limit || (verticalMaxValue - 1)))\r\n      : getIncrementedValue(prevRow, delta, isIncrement, (limit || 0))\r\n    )\r\n    : setCol(prevCol => isIncrement\r\n      ? getIncrementedValue(prevCol, delta, isIncrement, (limit || (horizontalMaxValue - 1)))\r\n      : getIncrementedValue(prevCol, delta, isIncrement, (limit || 0))\r\n    );\r\n\r\n  const handleWheelScroll = useCallback(\r\n    ev => {\r\n      const isVertical = ev.wheelDeltaY !== 0;\r\n      const wheelDelta = isVertical\r\n        ? ev.wheelDeltaY > 0 ? -WHEEL_DELTA : WHEEL_DELTA\r\n        : ev.wheelDeltaX > 0 ? -WHEEL_DELTA : WHEEL_DELTA\r\n\r\n      const isBetween = (val, min, max) => (val >= min && val < max);\r\n\r\n      if (isVertical) {\r\n        setRow(prevRow => {\r\n          const newRow = isBetween(prevRow + wheelDelta, 0, verticalMaxValue) ? (prevRow + wheelDelta) : prevRow\r\n          return isVerticalScrollbarVisible\r\n            ? newRow\r\n            : prevRow\r\n        });\r\n      } else {\r\n        setCol(prevCol => {\r\n          const newCol = isBetween(prevCol + wheelDelta, 0, horizontalMaxValue) ? (prevCol + wheelDelta) : prevCol;\r\n          return isHorizontalScrollbarVisible\r\n            ? newCol\r\n            : prevCol\r\n        });\r\n      }\r\n    },\r\n    [isVerticalScrollbarVisible, isHorizontalScrollbarVisible, verticalMaxValue, horizontalMaxValue, setRow, setCol],\r\n  );\r\n\r\n  useEffect(() => {\r\n    document.getElementById(`scrollbars-container__${uuid}`).addEventListener(\"wheel\", handleWheelScroll);\r\n    return () => document.getElementById(`scrollbars-container__${uuid}`).removeEventListener(\"wheel\", handleWheelScroll);\r\n  }, [uuid, handleWheelScroll]);\r\n\r\n  useEffect(() => {\r\n    if (timeoutID) {\r\n      clearTimeout(timeoutID);\r\n    }\r\n\r\n    timeoutID = setTimeout(\r\n      () => {\r\n        onVerticalScroll(row);\r\n        onHorizontalScroll(col);\r\n        setIsPaginating(false);\r\n      },\r\n      SCROLLBARS_TIMEOUT\r\n    );\r\n  }, [row, col, onVerticalScroll, onHorizontalScroll, setIsPaginating]);\r\n\r\n  useEffect(() => {\r\n    setRow(verticalValue);\r\n    setCol(horizontalValue);\r\n  }, [verticalValue, horizontalValue, setRow, setCol]);\r\n\r\n  return (\r\n    <div id={`scrollbars-container__${uuid}`} style={{width: \"100%\", height: \"100%\"}}>\r\n      <div style={{width: \"100%\", height: `calc(100% - ${isHorizontalScrollbarVisible ? SLIDER_WIDTH : 0}px)`}}>\r\n        <div\r\n          style={{\r\n            width: `calc(100% - ${isVerticalScrollbarVisible ? SLIDER_WIDTH : 0}px)`,\r\n            height: \"100%\",\r\n            display: \"inline-block\",\r\n            verticalAlign: \"top\",\r\n            position: \"relative\"\r\n          }}\r\n        >\r\n          <div className={classes.spinnerOverlay} style={{filter: isPaginating ? \"blur(1px)\" : \"\"}}>{children}</div>\r\n          {isPaginating && (\r\n            <div className={classes.spinnerOverlay}>\r\n              <CustomEmpty\r\n                text={t(\"components.table.scrollbars.loading\") + \"...\"}\r\n                textStyle={{fontWeight: \"bold\"}}\r\n                color=\"#ffffff\"\r\n                backgroundColor=\"rgba(0, 0, 0, 0.1)\"\r\n                image={<CircularProgress style={{color: \"#ffffff\"}}/>}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n        {isVerticalScrollbarVisible && (\r\n          <CustomSlider\r\n            uuid={uuid}\r\n            classes={classes}\r\n            orientation=\"vertical\"\r\n            value={row}\r\n            maxValue={verticalMaxValue}\r\n            onChange={value => handleSliderScroll(value, true)}\r\n            onIncrement={(isIncrement, delta, limit) => handleIncrement(isIncrement, true, delta, limit)}\r\n            ticks={verticalTicks}\r\n            isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n          />\r\n        )}\r\n      </div>\r\n      {\r\n        isHorizontalScrollbarVisible && (\r\n          <CustomSlider\r\n            uuid={uuid}\r\n            classes={classes}\r\n            orientation=\"horizontal\"\r\n            value={col}\r\n            maxValue={horizontalMaxValue}\r\n            onChange={value => handleSliderScroll(value, false)}\r\n            onIncrement={(isIncrement, delta, limit) => handleIncrement(isIncrement, false, delta, limit)}\r\n            ticks={horizontalTicks}\r\n            isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n          />\r\n        )\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(Scrollbars)","import React, {Fragment, useCallback, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {getJsonStatTableHtml} from \"./jsonStatTable\";\r\nimport \"./style.css\"\r\nimport {setDatasetHtmlGeneratingTime} from \"../../state/dataset/datasetActions\";\r\nimport Scrollbars, {SLIDER_WIDTH} from \"./Scrollbars\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport copy from \"copy-to-clipboard\";\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../label-format-selector/constants\";\r\nimport CustomEmpty from \"../custom-empty\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nexport const JSONSTAT_TABLE_FONT_SIZE_SM = \"s\";\r\nexport const JSONSTAT_TABLE_FONT_SIZE_MD = \"m\";\r\nexport const JSONSTAT_TABLE_FONT_SIZE_LG = \"l\";\r\n\r\nconst COLS_PER_PAGE = 30;\r\nconst ROWS_PER_PAGE = 50;\r\n\r\nconst SLIDER_SAFETY_MARGIN_PERCENTAGE = 20;\r\n\r\nconst TABLE_RIGHT_PADDING_CELL_WIDTH = 100;\r\n\r\nlet isFirstRender = false;\r\nlet isTimeToUpdate = false;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  table: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onTimeSet: time => dispatch(setDatasetHtmlGeneratingTime(time)),\r\n  addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  removeSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError)),\r\n});\r\n\r\nconst isElementInContainer = (el, container, isVerticalScrollbarVisible, isHorizontalScrollbarVisible, checkOnlyVertical) => {\r\n  const containerRect = container.getBoundingClientRect();\r\n  const elementRect = el.getBoundingClientRect();\r\n\r\n  return (\r\n    elementRect.top >= containerRect.top &&\r\n    elementRect.bottom <= (containerRect.bottom - (isHorizontalScrollbarVisible ? SLIDER_WIDTH : 0)) &&\r\n    (checkOnlyVertical === true || (\r\n      elementRect.left >= containerRect.left &&\r\n      elementRect.right <= (containerRect.right - (isVerticalScrollbarVisible ? SLIDER_WIDTH : 0))\r\n    ))\r\n  );\r\n}\r\n\r\nconst getAttributesValueString = (valueId, valueLabel) => `${(valueLabel || valueId)}${(valueLabel !== valueId) ? ` [${valueId}]` : ''}`\r\n\r\nfunction JsonStatTable(props) {\r\n  const {\r\n    classes,\r\n    jsonStat,\r\n    layout,\r\n    labelFormat = LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME,\r\n    fontSize,\r\n    isFullscreen,\r\n    isPreview = false,\r\n    removeEmptyLines = !isPreview,\r\n    isPaginated = !isPreview,\r\n    isStickyHeader = true,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    hiddenAttributes,\r\n    addSpinner,\r\n    removeSpinner,\r\n    hideSpinner = false,\r\n    onTimeSet\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n  const [spinnerUuid] = useState(uuidv4());\r\n\r\n  const [tableSupportStructures, setTableSupportStructures] = useState(null);\r\n  const [htmlTable, setHtmlTable] = useState(\"\");\r\n\r\n  const [row, setRow] = useState(0);\r\n  const [col, setCol] = useState(0);\r\n\r\n  const [visibleRowCount, setVisibleRowCount] = useState(1);\r\n  const [visibleColCount, setVisibleColCount] = useState(1);\r\n\r\n  const [tableRightPadding, setTableRightPadding] = useState(0);\r\n\r\n  const [isHorizontalScrollbarVisible, setHorizontalScrollbarVisibility] = useState(null);\r\n  const [isVerticalScrollbarVisible, setVerticalScrollbarVisibility] = useState(null);\r\n\r\n  const [attributes, setAttributes] = useState(null);\r\n  const [isCopiedVisible, setCopiedVisibility] = useState(false);\r\n\r\n  const [worker] = useState(() => new Worker(\"./workers/getJsonStatTableSupportStructuresWorker.js\"));\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (worker) {\r\n        worker.terminate();\r\n      }\r\n    }\r\n  }, [worker]);\r\n\r\n  const handleStyle = useCallback(\r\n    (isFirstRender, isResizing) => {\r\n      if (!isPreview && tableSupportStructures) {\r\n\r\n        if (!isResizing) {\r\n\r\n          /** attribute's tooltip handling **/\r\n          const $tooltip = $(`.jsonstat-table__${uuid} #jsonstat-table__tooltip`);\r\n          $(`.jsonstat-table__${uuid} .ca .ct`)\r\n            .hover(\r\n              function () {\r\n                const $elem = $(this).get(0);\r\n                const rect = $elem.getBoundingClientRect();\r\n\r\n                const attributes = $elem.className.includes(\"ctd\")\r\n                  ? tableSupportStructures.observationAttributesMap[$elem.id].attributes\r\n                  : tableSupportStructures.dimensionAttributesMap[$elem.id.split(\",\")[0]][$elem.id.split(\",\")[1]].attributes;\r\n\r\n                const ATTRIBUTE_HEIGHT = 18;\r\n\r\n                attributes.forEach(({id, label, valueId, valueLabel}) => {\r\n                  $tooltip.append($(`<li class=\"cttt\"><b>${(label || id)}</b>: ${getAttributesValueString(valueId, valueLabel)}</li>`))\r\n                })\r\n\r\n                const left = rect.x < (window.innerWidth / 2)\r\n                  ? rect.left\r\n                  : rect.left - $tooltip.innerWidth();\r\n\r\n                $tooltip.css({\r\n                  visibility: \"visible\",\r\n                  top: rect.top - (ATTRIBUTE_HEIGHT * attributes.length) - 30,\r\n                  left: left\r\n                });\r\n              },\r\n              function () {\r\n                $tooltip.empty().css({visibility: \"hidden\"});\r\n              }\r\n            )\r\n            .click(\r\n              function () {\r\n                const $elem = $(this).get(0);\r\n\r\n                const attributes = $elem.className.includes(\"ctd\")\r\n                  ? tableSupportStructures.observationAttributesMap[$elem.id].attributes\r\n                  : tableSupportStructures.dimensionAttributesMap[$elem.id.split(\",\")[0]][$elem.id.split(\",\")[1]].attributes;\r\n\r\n                setAttributes(attributes);\r\n              }\r\n            );\r\n\r\n          /** header's height handling **/\r\n          const cell = $(`.jsonstat-table__${uuid} th.c:first`);\r\n          if ((cell.css(\"minWidth\") || \"\") === \"\" || (cell.css(\"minWidth\") || \"\") === \"0px\") {\r\n\r\n            const cellFontSize = cell.css(\"fontSize\")\r\n            const cellPaddingLeft = Number(cell.css(\"paddingLeft\").split(\"px\")[0])\r\n            const cellPaddingRight = Number(cell.css(\"paddingRight\").split(\"px\")[0])\r\n\r\n            const getTextWidthEl = $('<span>').css({\r\n              visibility: 'hidden',\r\n              position: 'absolute',\r\n              fontSize: cellFontSize\r\n            }).appendTo('body').get(0);\r\n\r\n            $(`.jsonstat-table__${uuid} table thead th`).each(function () {\r\n              const minWidth = getTextWidth($(this).text(), getTextWidthEl);\r\n              $(this).css({minWidth: ((minWidth / 2) + cellPaddingLeft + cellPaddingRight + 24)})\r\n            })\r\n\r\n            $(getTextWidthEl).remove();\r\n          }\r\n        }\r\n\r\n        if (!isPaginated) {\r\n\r\n          const stickyRowCount = (layout.cols.length + 1);\r\n          const stickyColCount = layout.rows.length;\r\n\r\n          if (isStickyHeader) {\r\n\r\n            /** header **/\r\n            const tops = [0];\r\n            const $headerRows = $(`.jsonstat-table__${uuid} thead tr`);\r\n            for (let i = 0; i < $headerRows.length; i++) {\r\n              tops.push(tops[i] + $headerRows[i].getBoundingClientRect().height);\r\n            }\r\n            for (let i = 0; i < (tops.length - 1); i++) {\r\n              $(`.jsonstat-table__${uuid} thead tr:nth-child(${i + 1}) th`).css(\"top\", tops[i]);\r\n            }\r\n\r\n            /** columns **/\r\n            const lefts = [0];\r\n            const $firstBodyRowThs = $(`.jsonstat-table__${uuid} tbody tr:not(.rs):first th`);\r\n            for (let i = 0; i < $firstBodyRowThs.length; i++) {\r\n              lefts.push(lefts[i] + $firstBodyRowThs[i].getBoundingClientRect().width);\r\n            }\r\n            for (let i = 0; i < (lefts.length - 1); i++) {\r\n              // the class \"clX\" is assigned during the html generation to the x-th column for each row, if this column have to be sticky\r\n              $(`.jsonstat-table__${uuid} th.cl${i}`).css(\"left\", lefts[i]);\r\n            }\r\n\r\n            /** sections **/\r\n            $(`.jsonstat-table__${uuid} .cs`).css({top: tops[tops.length - 1], left: 0});\r\n\r\n          } else {\r\n\r\n            if (!isFirstRender) {\r\n\r\n              /** header **/\r\n              for (let i = 0; i < stickyRowCount; i++) {\r\n                $(`.jsonstat-table__${uuid} thead tr:nth-child(${i + 1}) th`).css(\"top\", \"auto\");\r\n              }\r\n\r\n              /** columns **/\r\n              for (let i = 0; i < stickyColCount; i++) {\r\n                // the class \"clX\" is assigned during the html generation to the x-th column for each row, if this column have to be sticky\r\n                $(`.jsonstat-table__${uuid} th.cl${i}`).css(\"left\", \"auto\");\r\n              }\r\n\r\n              /** sections **/\r\n              $(`.jsonstat-table__${uuid} .cs`).css({top: \"auto\", left: \"auto\"});\r\n            }\r\n          }\r\n        }\r\n\r\n        removeSpinner(spinnerUuid);\r\n      }\r\n    },\r\n    [uuid, tableSupportStructures, layout, isPreview, isStickyHeader, isPaginated, removeSpinner, spinnerUuid]\r\n  );\r\n\r\n  const handleScrollbar = useCallback(\r\n    updateVisibleRowAndColCount => {\r\n      let $tableContainer = $(`.jsonstat-table__${uuid}`);\r\n\r\n      if ($tableContainer && tableSupportStructures) {\r\n\r\n        let isVerticalScrollbarVisible = null;\r\n        let isHorizontalScrollbarVisible = null;\r\n\r\n        const {rowCount, colCount} = tableSupportStructures;\r\n        const $table = $(`.jsonstat-table__${uuid} table`);\r\n\r\n        setVerticalScrollbarVisibility(prevIsVerticalScrollbarVisible => {\r\n          isVerticalScrollbarVisible = (row !== null && row !== undefined && row !== 0)\r\n            ? prevIsVerticalScrollbarVisible\r\n            : ((rowCount > ROWS_PER_PAGE) || (rowCount <= ROWS_PER_PAGE && $table.height() > $tableContainer.height()));\r\n          return isVerticalScrollbarVisible;\r\n        });\r\n\r\n        setHorizontalScrollbarVisibility(prevIsHorizontalScrollbarVisible => {\r\n          isHorizontalScrollbarVisible = (col !== null && col !== undefined && col !== 0)\r\n            ? prevIsHorizontalScrollbarVisible\r\n            : ((colCount > COLS_PER_PAGE) || (colCount <= COLS_PER_PAGE && ($table.width() - tableRightPadding) > $tableContainer.width()));\r\n          return isHorizontalScrollbarVisible;\r\n        });\r\n\r\n        let visibleColCount = 0;\r\n        $(`.jsonstat-table__${uuid} tbody tr:not(.rs):first td`).each((idx, el) => {\r\n          if (isElementInContainer(el, $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible)) {\r\n            visibleColCount++;\r\n          }\r\n        });\r\n        if (updateVisibleRowAndColCount) {\r\n          setVisibleColCount(visibleColCount);\r\n        }\r\n\r\n        let visibleRowCount = 0;\r\n        $(`.jsonstat-table__${uuid} tbody tr:not(.rs)`).each((idx, el) => {\r\n          if (isElementInContainer($(el).children(\"td\")[0], $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible)) {\r\n            visibleRowCount++;\r\n          }\r\n        });\r\n        $(`.jsonstat-table__${uuid} tbody tr.rs`).each((idx, el) => {\r\n          if (isElementInContainer(el, $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible, true)) {\r\n            visibleRowCount++;\r\n          }\r\n        });\r\n        if (updateVisibleRowAndColCount) {\r\n          setVisibleRowCount(visibleRowCount);\r\n        }\r\n      }\r\n    },\r\n    [uuid, tableSupportStructures, tableRightPadding, row, col]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (jsonStat && layout) {\r\n      isTimeToUpdate = false;\r\n      setTableSupportStructures(null);\r\n      setHtmlTable(\"\");\r\n\r\n      if (!hideSpinner && !isPreview) {\r\n        addSpinner(spinnerUuid, t(\"components.table.spinners.rendering\"));\r\n      }\r\n\r\n      worker.onmessage = event => {\r\n        isTimeToUpdate = true;\r\n        setTableSupportStructures(event.data);\r\n        if (event.data.hasAttributeObservationError) {\r\n          window.error.show(\"Error retrieving attributes at observation level\");\r\n        }\r\n      }\r\n      worker.postMessage({\r\n        jsonStat,\r\n        layout,\r\n        isPreview,\r\n        removeEmptyLines,\r\n        hiddenAttributes\r\n      });\r\n\r\n      setRow(0);\r\n      setCol(0);\r\n      isFirstRender = true;\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [jsonStat, layout, isPreview, removeEmptyLines, hideSpinner, addSpinner, spinnerUuid, t]); // TODO: include \"hiddenAttributes\" in deps array\r\n\r\n  useEffect(() => {\r\n    if (isTimeToUpdate && tableSupportStructures) {\r\n      const func = () => {\r\n        handleStyle(false, true);\r\n        handleScrollbar(true);\r\n      }\r\n      window.addEventListener(\"resize\", func);\r\n      return () => window.removeEventListener(\"resize\", func);\r\n    }\r\n  }, [tableSupportStructures, handleStyle, handleScrollbar]);\r\n\r\n  useEffect(() => {\r\n    if (isTimeToUpdate && tableSupportStructures) {\r\n      const {\r\n        rows,\r\n        cols,\r\n        sections,\r\n        filters,\r\n        filtersValue,\r\n        colCount,\r\n        rowCount,\r\n        colsObj,\r\n        rowsObj,\r\n        combinations,\r\n        indexesMap,\r\n        valorizedCols,\r\n        valorizedRows,\r\n        valorizedRowsPerSection,\r\n        sectionsLength,\r\n        dimensionAttributesMap,\r\n        observationAttributesMap\r\n      } = tableSupportStructures;\r\n\r\n      const rowEnd = (row + ROWS_PER_PAGE) >= rowCount ? rowCount : (row + ROWS_PER_PAGE);\r\n      const colEnd = (col + COLS_PER_PAGE) >= colCount ? colCount : (col + COLS_PER_PAGE);\r\n\r\n      const tableRightPadding = (COLS_PER_PAGE - (colEnd - col)) * TABLE_RIGHT_PADDING_CELL_WIDTH;\r\n      setTableRightPadding(tableRightPadding);\r\n\r\n      setHtmlTable(getJsonStatTableHtml(\r\n        jsonStat,\r\n        rows,\r\n        cols,\r\n        sections,\r\n        filters,\r\n        filtersValue,\r\n        colCount,\r\n        rowCount,\r\n        colsObj,\r\n        rowsObj,\r\n        combinations,\r\n        indexesMap,\r\n        valorizedCols,\r\n        valorizedRows,\r\n        valorizedRowsPerSection,\r\n        sectionsLength,\r\n        labelFormat,\r\n        (fontSize || JSONSTAT_TABLE_FONT_SIZE_MD),\r\n        decimalSeparator,\r\n        decimalPlaces,\r\n        emptyChar,\r\n        isPreview,\r\n        isPaginated\r\n          ? {\r\n            rowStart: row,\r\n            rowEnd: rowEnd,\r\n            colStart: col,\r\n            colEnd: colEnd,\r\n            tableRightPadding: !isPreview ? tableRightPadding : 1\r\n          }\r\n          : null,\r\n        dimensionAttributesMap,\r\n        observationAttributesMap,\r\n        onTimeSet\r\n      ));\r\n\r\n      $(`.jsonstat-table__${uuid}`).scrollTop(0).scrollLeft(0);\r\n    }\r\n  }, [uuid, tableSupportStructures, jsonStat, labelFormat, fontSize, isFullscreen, decimalSeparator, decimalPlaces, emptyChar, isPreview, isPaginated, onTimeSet, row, col]);\r\n\r\n  useEffect(() => {\r\n    if (isTimeToUpdate && htmlTable && htmlTable.length > 0) {\r\n      handleStyle(isFirstRender, false);\r\n      handleScrollbar(isFirstRender);\r\n\r\n      isFirstRender = false;\r\n    }\r\n  }, [htmlTable, handleStyle, handleScrollbar]);\r\n\r\n  return (\r\n    <Fragment>\r\n      {tableSupportStructures\r\n        ? (\r\n          <div className={classes.root}>\r\n            {isPaginated\r\n              ? (\r\n                <Scrollbars\r\n                  verticalValue={row}\r\n                  verticalMaxValue={tableSupportStructures.rowCount}\r\n                  verticalTicks={tableSupportStructures.rowCount - (visibleRowCount - Math.floor(visibleRowCount / 100 * SLIDER_SAFETY_MARGIN_PERCENTAGE))}\r\n                  onVerticalScroll={setRow}\r\n                  isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n                  horizontalValue={col}\r\n                  horizontalMaxValue={tableSupportStructures.colCount}\r\n                  horizontalTicks={tableSupportStructures.colCount - (visibleColCount - Math.floor(visibleColCount / 100 * SLIDER_SAFETY_MARGIN_PERCENTAGE))}\r\n                  onHorizontalScroll={setCol}\r\n                  isHorizontalScrollbarVisible={isHorizontalScrollbarVisible}\r\n                >\r\n                  <div\r\n                    className={`${classes.table} jsonstat-table jsonstat-table__${uuid}`}\r\n                    style={{overflow: \"hidden\"}}\r\n                    dangerouslySetInnerHTML={{__html: htmlTable}}\r\n                  />\r\n                </Scrollbars>\r\n              )\r\n              : (\r\n                <div\r\n                  className={`${classes.table} jsonstat-table jsonstat-table__${uuid}`}\r\n                  style={{overflow: \"auto\"}}\r\n                  dangerouslySetInnerHTML={{__html: htmlTable}}\r\n                />\r\n              )\r\n            }\r\n          </div>\r\n        )\r\n        : (\r\n          <CustomEmpty text={\"Initializing table...\"}/> // TODO\r\n        )\r\n      }\r\n      <Snackbar\r\n        open={isCopiedVisible}\r\n        autoHideDuration={2000}\r\n        onClose={() => setCopiedVisibility(prevVal => !prevVal)}\r\n      >\r\n        <Alert severity=\"success\" onClose={() => setCopiedVisibility(prevVal => !prevVal)}>\r\n          {t(\"components.table.alerts.attributeCopied\")}\r\n        </Alert>\r\n      </Snackbar>\r\n      <Dialog\r\n        open={attributes !== null}\r\n        onClose={() => setAttributes(null)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.table.dialogs.observationAttributes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{width: 480}}>\r\n          <Grid container spacing={2}>\r\n            {(attributes || []).map(({id, label, valueId, valueLabel}, idx) =>\r\n              <Grid item key={idx} xs={12}>\r\n                <b>{label || id}</b>{`: ${getAttributesValueString(valueId, valueLabel)}`}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setAttributes(null)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n          <Button\r\n            color=\"primary\"\r\n            autoFocus\r\n            onClick={() => {\r\n              copy(attributes\r\n                .map(({id, label, valueId, valueLabel}) => `${(label || id)}: ${getAttributesValueString(valueId, valueLabel)}`)\r\n                .join(\", \")\r\n              );\r\n              setCopiedVisibility(prevVal => !prevVal)();\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.copy\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(null, mapDispatchToProps),\r\n  withStyles(styles)\r\n)(JsonStatTable);","import _ from \"lodash\"\r\n\r\nexport function getMaxTreeDepth(tree, childrenKey) {\r\n\r\n  const recursive = node =>\r\n    node\r\n      ? 1 + Math.max(...(node[childrenKey] || []).map(recursive), 0)\r\n      : 0;\r\n\r\n  return tree\r\n    ? Math.max(...tree.map(recursive), 0)\r\n    : 0;\r\n}\r\n\r\nexport function getNodesAtDepth(tree, childrenKey, depth) {\r\n\r\n  const res = [];\r\n\r\n  const recursive = (subTree, currDepth) =>\r\n    subTree\r\n      ? (\r\n        subTree.map(node => {\r\n          if (depth === currDepth) {\r\n            res.push(_.cloneDeep(node));\r\n          }\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            recursive(node[childrenKey], currDepth + 1);\r\n          }\r\n          return null;\r\n        })\r\n      )\r\n      : [];\r\n\r\n  recursive(tree, 1);\r\n\r\n  return res;\r\n}\r\n\r\nexport function getTreeFromArray(arr, parentKey, childrenKey) {\r\n  const mappedArr = {};\r\n  const tree = [];\r\n\r\n  // first map the nodes of the array to an object -> create a hash table.\r\n  arr.forEach(el => {\r\n    el[childrenKey] = [];\r\n    mappedArr[el.id] = el;\r\n  });\r\n\r\n  arr.forEach(el => {\r\n    if (el[parentKey]) {\r\n      // if the element is not at the root level, add it to its parent array of children.\r\n      mappedArr[el[parentKey]][childrenKey].push(el);\r\n    } else {\r\n      // if the element is at the root level, add it to first level elements array.\r\n      tree.push(el);\r\n    }\r\n  });\r\n\r\n  return tree;\r\n}\r\n\r\nexport function getNode(tree, childrenKey, test) {\r\n\r\n  if (!(tree !== null && tree.length)) return null;\r\n\r\n  const foundNodes = tree.filter(test);\r\n\r\n  if (foundNodes.length) {\r\n    return foundNodes[0];\r\n  } else {\r\n    const foundNodesInChild =\r\n      tree\r\n        .filter(node => node[childrenKey])\r\n        .map(node => getNode(node[childrenKey], childrenKey, test))\r\n        .filter(result => result !== null);\r\n\r\n    if (foundNodesInChild.length) {\r\n      return foundNodesInChild[0];\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getNodes(tree, childrenKey, test) {\r\n\r\n  const res = [];\r\n\r\n  const recursive = subTree =>\r\n    subTree\r\n      ? (\r\n        subTree.map(node => {\r\n          if (test && test(node)) {\r\n            res.push(_.cloneDeep(node));\r\n          }\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            recursive(node[childrenKey]);\r\n          }\r\n          return null;\r\n        })\r\n      )\r\n      : [];\r\n\r\n  recursive(tree);\r\n\r\n  return res;\r\n}","import {Reducer} from \"@reduxjs/toolkit\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  ALL_FULL,\r\n  ALL_PARTIAL,\r\n  CRITERIA_SELECTION_MODE_ALL,\r\n  CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n  CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n  CRITERIA_SELECTION_TYPE_FULL,\r\n  CRITERIA_SELECTION_TYPE_PARTIAL,\r\n  DATASET_ACCESSIBLE_FETCH,\r\n  DATASET_CRITERIA_ALERT_HIDE,\r\n  DATASET_CRITERIA_HIDE,\r\n  DATASET_CRITERIA_LENGTH_WARNING_HIDE,\r\n  DATASET_CRITERIA_LENGTH_WARNING_SHOW,\r\n  DATASET_CRITERIA_SHOW,\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  DATASET_DOWNLOAD_WARNING_HIDE,\r\n  DATASET_FETCH_ENABLE,\r\n  DATASET_HTML_GENERATING_TIME_SET,\r\n  DATASET_LABEL_FORMAT_SET,\r\n  DATASET_RESET,\r\n  DATASET_STRUCTURE_CODELIST_FETCH,\r\n  DATASET_STRUCTURE_CODELIST_FILTER_SET,\r\n  DATASET_STRUCTURE_CODELISTS_FETCH,\r\n  DATASET_STRUCTURE_FETCH,\r\n  DATASET_STRUCTURE_FETCH_ENABLE,\r\n  DATASET_TERRITORY_FETCH,\r\n  DATASET_UNAVAILABLE_VIEW_WARNING_HIDE,\r\n  DATASET_VIEWER_SET,\r\n  STEP_BY_STEP_FULL,\r\n  STEP_BY_STEP_PARTIAL\r\n} from \"./datasetActions\";\r\nimport {getTreeFromArray} from \"../../utils/tree\";\r\n// @ts-ignore\r\nimport moment from \"moment\";\r\nimport {FREQ_KEY, TIME_PERIOD_KEY} from \"../../utils/jsonStat\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../../components/label-format-selector/constants\";\r\nimport {getViewerIdxFromType} from \"../../components/data-viewer\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  FETCH_DATASET_ASYNC_HANDLER_ERROR,\r\n  FETCH_DATASET_ASYNC_HANDLER_INIT,\r\n  FETCH_DATASET_ASYNC_HANDLER_SUCCESS\r\n} from \"../../middlewares/fetchDatasetAsyncHandler/actions\";\r\n\r\nexport const GENERATING_HTML_TIME_KEY = \"generatingHtml\";\r\nexport const OBSERVATION_COUNT_KEY = \"observationCount\";\r\nexport const SERVER_TIMINGS_KEY = \"serverTimings\";\r\n\r\nconst MAX_ALLOWED_CELLS = 1000000;\r\n\r\nconst getMinAndMax = (criteria: any) => {\r\n  let min = moment().add(-20, 'y').format(\"YYYY\") + \"-01-01\";\r\n  let max = moment().add(10, 'y').format(\"YYYY\") + \"-12-31\";\r\n\r\n  return {\r\n    min: criteria.values && criteria.values[0] && criteria.values[0].id\r\n      ? moment(criteria.values[0].id).format(\"YYYY-MM-DD\")\r\n      : min,\r\n    max: criteria.values && criteria.values[1] && criteria.values[1].id\r\n      ? moment(criteria.values[1].id).format(\"YYYY-MM-DD\")\r\n      : max\r\n  }\r\n};\r\n\r\nconst getTimePeriod = (stateTimePeriod: any, stateFilters: any, timePeriodCriteria: any | null, freqCriteria: any | null) => {\r\n\r\n  const minAndMax = timePeriodCriteria\r\n    ? getMinAndMax(timePeriodCriteria)\r\n    : {\r\n      min: stateTimePeriod.minDate,\r\n      max: stateTimePeriod.maxDate,\r\n    };\r\n\r\n  let freq = stateTimePeriod.freq;\r\n  if (!freq && !!freqCriteria) {\r\n    freq = getFreq((freqCriteria.values || []).map(({id}: any) => id));\r\n  }\r\n\r\n  return {\r\n    minDate: stateTimePeriod.minDate || minAndMax.min,\r\n    maxDate: stateTimePeriod.maxDate || minAndMax.max,\r\n    fromDate: (stateFilters[TIME_PERIOD_KEY] && stateFilters[TIME_PERIOD_KEY].length === 2)\r\n      ? stateFilters[TIME_PERIOD_KEY][0]\r\n      : minAndMax.min,\r\n    toDate: (stateFilters[TIME_PERIOD_KEY] && stateFilters[TIME_PERIOD_KEY].length === 2)\r\n      ? stateFilters[TIME_PERIOD_KEY][1]\r\n      : minAndMax.max,\r\n    freq: freq\r\n  }\r\n};\r\n\r\nexport const FREQ_ANNUAL = \"A\";\r\nexport const FREQ_SEMESTER = \"S\";\r\nexport const FREQ_QUARTERLY = \"Q\";\r\nexport const FREQ_MONTHLY = \"M\";\r\nconst frequencies = [FREQ_MONTHLY, FREQ_QUARTERLY, FREQ_SEMESTER, FREQ_ANNUAL];\r\n\r\nconst getFreq = (values: any) => {\r\n  return (frequencies.find(freq => (values || []).includes(freq)) || null)\r\n};\r\n\r\ntype DatasetState = {\r\n  dataset: any | null,\r\n  accessibleDataset: string | null,\r\n  datasetId: string | null,\r\n  isPartialData: boolean,\r\n  isEmptyData: boolean,\r\n  isTooBigData: boolean,\r\n  isCriteriaVisible: boolean,\r\n  isCriteriaAlertVisible: boolean,\r\n  dimensions: any[] | null,\r\n  mode: string | null,\r\n  type: string | null,\r\n  viewerIdx: number,\r\n  hasViewTemplate: boolean,\r\n  hasTemplateLayout: boolean,\r\n  hasAnnotationLayout: boolean,\r\n  initialTableLayout: any | null,\r\n  initialChartLayout: any | null,\r\n  initialMapLayout: any | null,\r\n  labelFormat: string | null,\r\n  filters: any | null,\r\n  initialFilters: any | null,\r\n  decimalSeparator: string | null,\r\n  decimalPlaces: number | null\r\n  emptyChar: string | null,\r\n  enableCriteria: boolean,\r\n  enableLayout: boolean,\r\n  maxAllowedCells: number,\r\n  territorialDims: string[] | null,\r\n  codes: any[] | null,\r\n  isCodesFlat: boolean,\r\n  codelists: any[] | null,\r\n  areCodelistsFlat: boolean[],\r\n  codelistsLength: number[] | null,\r\n  timePeriod: {\r\n    minDate: string | null,\r\n    maxDate: string | null,\r\n    fromDate: string | null,\r\n    toDate: string | null,\r\n    freq: string | null\r\n  },\r\n  timings: any | null,\r\n  isFetchStructureDisabled: boolean,\r\n  isFetchDatasetDisabled: boolean,\r\n  isDownloadWarningVisible: boolean,\r\n  isUnavailableViewWarningVisible: boolean,\r\n  isCriteriaLengthWarningVisible: boolean,\r\n  geometries: any | null,\r\n  geometryDetailLevels: any | null\r\n};\r\n\r\nconst initialState = {\r\n  dataset: null,\r\n  accessibleDataset: null,\r\n  datasetId: null,\r\n  isPartialData: false,\r\n  isEmptyData: false,\r\n  isTooBigData: false,\r\n  isCriteriaVisible: false,\r\n  isCriteriaAlertVisible: false,\r\n  dimensions: null,\r\n  mode: null,\r\n  type: null,\r\n  viewerIdx: 0,\r\n  hasViewTemplate: false,\r\n  hasTemplateLayout: false,\r\n  hasAnnotationLayout: false,\r\n  initialTableLayout: null,\r\n  initialChartLayout: null,\r\n  initialMapLayout: null,\r\n  labelFormat: null,\r\n  filters: null,\r\n  initialFilters: null,\r\n  decimalSeparator: null,\r\n  decimalPlaces: null,\r\n  emptyChar: null,\r\n  enableCriteria: true,\r\n  enableLayout: true,\r\n  maxAllowedCells: MAX_ALLOWED_CELLS,\r\n  territorialDims: null,\r\n  codes: null,\r\n  isCodesFlat: false,\r\n  codelists: null,\r\n  areCodelistsFlat: [],\r\n  codelistsLength: null,\r\n  timePeriod: {\r\n    minDate: null,\r\n    maxDate: null,\r\n    fromDate: null,\r\n    toDate: null,\r\n    freq: null\r\n  },\r\n  timings: null,\r\n  isFetchStructureDisabled: true,\r\n  isFetchDatasetDisabled: true,\r\n  isDownloadWarningVisible: false,\r\n  isUnavailableViewWarningVisible: false,\r\n  isCriteriaLengthWarningVisible: false,\r\n  geometries: null,\r\n  geometryDetailLevels: null\r\n};\r\n\r\nconst datasetReducer: Reducer<DatasetState> = (\r\n  state = initialState,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case DATASET_STRUCTURE_FETCH_ENABLE: {\r\n      return {\r\n        ...state,\r\n        datasetId: action.datasetId,\r\n        isFetchStructureDisabled: false\r\n      }\r\n    }\r\n    case DATASET_FETCH_ENABLE: {\r\n      return {\r\n        ...state,\r\n        isFetchDatasetDisabled: false\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_SHOW: {\r\n      return {\r\n        ...state,\r\n        isCriteriaVisible: true\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaVisible: false,\r\n        filters: state.initialFilters,\r\n        codes: null,\r\n        isCodesFlat: false,\r\n        codelists: null,\r\n        areCodelistsFlat: [],\r\n        timePeriod: {\r\n          ...state.timePeriod,\r\n          minDate: null,\r\n          maxDate: null,\r\n          fromDate: null,\r\n          toDate: null\r\n        }\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_ALERT_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaAlertVisible: false\r\n      }\r\n    }\r\n    case DATASET_STRUCTURE_CODELIST_FILTER_SET: {\r\n\r\n      let fromDate = state.timePeriod.fromDate;\r\n      let toDate = state.timePeriod.toDate;\r\n      let freq = state.timePeriod.freq;\r\n\r\n      if (action.filters[TIME_PERIOD_KEY]) {\r\n        fromDate = action.filters[TIME_PERIOD_KEY][0];\r\n        toDate = action.filters[TIME_PERIOD_KEY][1];\r\n      }\r\n\r\n      if (action.filters[FREQ_KEY]) {\r\n        freq = getFreq(action.filters[FREQ_KEY])\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        filters: action.filters,\r\n        timePeriod: {\r\n          ...state.timePeriod,\r\n          fromDate: fromDate,\r\n          toDate: toDate,\r\n          freq: freq\r\n        }\r\n      }\r\n    }\r\n    case DATASET_RESET: {\r\n      return initialState\r\n    }\r\n    case DATASET_VIEWER_SET: {\r\n      return {\r\n        ...state,\r\n        viewerIdx: action.viewerIdx\r\n      }\r\n    }\r\n    case DATASET_LABEL_FORMAT_SET: {\r\n      return {\r\n        ...state,\r\n        labelFormat: action.labelFormat\r\n      }\r\n    }\r\n    case DATASET_DOWNLOAD_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isDownloadWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_UNAVAILABLE_VIEW_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isUnavailableViewWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_LENGTH_WARNING_SHOW: {\r\n      return {\r\n        ...state,\r\n        isCriteriaLengthWarningVisible: true,\r\n        isFetchDatasetDisabled: true\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_LENGTH_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaLengthWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_HTML_GENERATING_TIME_SET: {\r\n      return {\r\n        ...state,\r\n        timings: {\r\n          ...state.timings,\r\n          [GENERATING_HTML_TIME_KEY]: action.time\r\n        }\r\n      }\r\n    }\r\n    case FETCH_DATASET_ASYNC_HANDLER_INIT: {\r\n      return {\r\n        ...state,\r\n        dataset: null,\r\n        isFetchDatasetDisabled: true\r\n      }\r\n    }\r\n    case FETCH_DATASET_ASYNC_HANDLER_SUCCESS: {\r\n      if (action.payload.worker) {\r\n        action.payload.worker.terminate();\r\n      }\r\n      return {\r\n        ...state,\r\n        dataset: (action.payload.response?.id || \"\").length !== 0 ? action.payload.response : null,\r\n\r\n        isTooBigData: action.payload.cellCount > state.maxAllowedCells,\r\n        isEmptyData: (action.payload.statusCode === 204 || (action.payload.response?.id || \"\").length === 0),\r\n        isPartialData: action.payload.statusCode === 206,\r\n\r\n        isCriteriaVisible: action.payload.isResponseNotValid,\r\n        isCriteriaAlertVisible: action.payload.isResponseNotValid,\r\n\r\n        initialTableLayout: action.payload.initialTableLayout,\r\n        initialMapLayout: action.payload.initialMapLayout,\r\n        initialChartLayout: action.payload.initialChartLayout,\r\n\r\n        initialFilters: action.payload.isResponseNotValid ? state.initialFilters : state.filters,\r\n\r\n        codes: action.payload.isResponseNotValid ? state.codes : null,\r\n        isCodesFlat: action.payload.isResponseNotValid ? state.isCodesFlat : false,\r\n        codelists: action.payload.isResponseNotValid ? state.codelists : null,\r\n        areCodelistsFlat: action.payload.isResponseNotValid ? state.areCodelistsFlat : [],\r\n        timePeriod: action.payload.isResponseNotValid\r\n          ? state.timePeriod\r\n          : {\r\n            ...state.timePeriod,\r\n            minDate: null,\r\n            maxDate: null,\r\n            fromDate: null,\r\n            toDate: null\r\n          },\r\n        isCriteriaLengthWarningVisible: false,\r\n        timings: {\r\n          [OBSERVATION_COUNT_KEY]: action.payload.response?.value ? Object.keys(action.payload.response.value).length : null,\r\n          [SERVER_TIMINGS_KEY]: action.payload.responseHeaders.backendtimers\r\n            ? JSON.parse(action.payload.responseHeaders.backendtimers)\r\n            : null\r\n        }\r\n      }\r\n    }\r\n    case FETCH_DATASET_ASYNC_HANDLER_ERROR: {\r\n      const isPayloadTooLarge = action.payload.statusCode === 413\r\n      return {\r\n        ...state,\r\n        dataset: null,\r\n        accessibleDataset: null,\r\n        isPartialData: false,\r\n        isEmptyData: false,\r\n        isTooBigData: isPayloadTooLarge,\r\n        isCriteriaAlertVisible: isPayloadTooLarge\r\n      }\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          return {\r\n            ...state,\r\n            isFetchStructureDisabled: true\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n          return {\r\n            ...state,\r\n            codes: null,\r\n            isCodesFlat: false\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          const criteriaView = action.payload.response.criteriaView;\r\n\r\n          const VIEW_KEY = \"view\";\r\n          const TEMPLATE_KEY = \"template\";\r\n\r\n          const viewTemplate = action.payload.response[VIEW_KEY]\r\n            ? action.payload.response[VIEW_KEY]\r\n            : action.payload.response[TEMPLATE_KEY]\r\n              ? action.payload.response[TEMPLATE_KEY]\r\n              : null\r\n\r\n          const viewTemplateLayouts = viewTemplate\r\n            ? JSON.parse(viewTemplate.layouts)\r\n            : null;\r\n\r\n          const tableLayout = viewTemplateLayouts?.tableLayout\r\n            ? viewTemplateLayouts.tableLayout\r\n            : action.payload.response.layout\r\n              ? action.payload.response.layout\r\n              : null;\r\n\r\n          const mapLayout = viewTemplateLayouts?.mapLayout\r\n            ? viewTemplateLayouts.mapLayout\r\n            : null;\r\n\r\n          const chartLayout = viewTemplateLayouts?.chartLayout\r\n            ? viewTemplateLayouts.chartLayout\r\n            : null;\r\n\r\n          let filters = viewTemplate\r\n            ? viewTemplate.criteria\r\n            : (action.payload.response.filters && action.payload.response.filters.filterData)\r\n              ? action.payload.response.filters.filterData\r\n              : null;\r\n\r\n          if (filters) {\r\n            const dimensionsId = action.payload.response.criteria.map(({id}: any) => id);\r\n            Object.keys(filters).forEach(key => {\r\n              if (!dimensionsId.includes(key)) {\r\n                filters[key] = undefined;\r\n              }\r\n            });\r\n          }\r\n\r\n          const hasViewTemplate = (viewTemplate !== null && viewTemplate !== undefined);\r\n\r\n          return {\r\n            ...state,\r\n            hasViewTemplate: hasViewTemplate,\r\n            hasTemplateLayout: !!action.payload.response[TEMPLATE_KEY],\r\n            hasAnnotationLayout: !!action.payload.response.layout,\r\n            dimensions: action.payload.response.criteria,\r\n            mode: (criteriaView === ALL_FULL || criteriaView === ALL_PARTIAL)\r\n              ? CRITERIA_SELECTION_MODE_ALL\r\n              : CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n            type: (criteriaView === ALL_FULL || criteriaView === STEP_BY_STEP_FULL)\r\n              ? CRITERIA_SELECTION_TYPE_FULL\r\n              : (criteriaView === ALL_PARTIAL || criteriaView === STEP_BY_STEP_PARTIAL)\r\n                ? CRITERIA_SELECTION_TYPE_PARTIAL\r\n                : CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n            codelistsLength: state.codelistsLength ? state.codelistsLength : action.payload.response.criteria.map(() => null),\r\n            isCriteriaVisible: (tableLayout === null && chartLayout === null && mapLayout === null && filters === null),\r\n            viewerIdx: viewTemplate ? getViewerIdxFromType(viewTemplate.defaultView) : 0,\r\n            isUnavailableViewWarningVisible: (!!action.payload.extra?.viewId && !hasViewTemplate),\r\n            initialTableLayout: tableLayout,\r\n            initialMapLayout: mapLayout,\r\n            initialChartLayout: chartLayout,\r\n            labelFormat: (viewTemplate?.layouts?.labelFormat || LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME),\r\n            filters: (filters || {}),\r\n            initialFilters: (filters || {}),\r\n            decimalSeparator: (viewTemplate && viewTemplate.decimalSeparator)\r\n              ? localizeI18nObj(viewTemplate.decimalSeparator, action.payload.extra.defaultlanguage, action.payload.extra.languages)\r\n              : action.payload.response.decimalSeparator,\r\n            decimalPlaces: (viewTemplate?.decimalNumber || action.payload.response.decimalPlaces),\r\n            emptyChar: (viewTemplateLayouts?.tableEmptyChar || action.payload.response.emptyCellPlaceHolder),\r\n            territorialDims: (action.payload.response.territorialDimensions || []),\r\n            enableCriteria: viewTemplate?.enableCriteria !== false,\r\n            enableLayout: viewTemplate?.enableLayout !== false,\r\n            isFetchDatasetDisabled: !(action.payload.extra.isAccessible || (tableLayout !== null || filters !== null)),\r\n            timePeriod: {\r\n              ...state.timePeriod,\r\n              freq: getFreq((filters || {})[FREQ_KEY])\r\n            },\r\n            maxAllowedCells: (action.payload.response.maxTableCells || MAX_ALLOWED_CELLS)\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n\r\n          const criteria = action.payload.response.criteria[0] || {};\r\n\r\n          let flatCodes = criteria.values ? criteria.values : [];\r\n          const codelistIdx = criteria.id ? (state.dimensions || []).map(({id}: any) => id).indexOf(criteria.id) : -1;\r\n\r\n          const newCodelistsLength = state.codelistsLength ? [...state.codelistsLength] : [];\r\n          if (codelistIdx >= 0 && criteria.id !== TIME_PERIOD_KEY) {\r\n            newCodelistsLength[codelistIdx] = flatCodes.length;\r\n          }\r\n\r\n          let isCodesFlat = true;\r\n          flatCodes.forEach((item: any) => {\r\n            if (isCodesFlat && item.parentId !== null && item.parentId !== undefined) {\r\n              isCodesFlat = false;\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            codes: getTreeFromArray((flatCodes || []), \"parentId\", \"children\"),\r\n            isCodesFlat: isCodesFlat,\r\n            timePeriod: getTimePeriod(\r\n              state.timePeriod,\r\n              state.filters,\r\n              criteria.id === TIME_PERIOD_KEY ? criteria : null,\r\n              criteria.id === FREQ_KEY ? criteria : null\r\n            ),\r\n            codelistsLength: newCodelistsLength\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELISTS_FETCH: {\r\n\r\n          const criteria = (state.dimensions || []).map(({id: dimensionId}) => {\r\n            const found = action.payload.response.criteria.find((criteria: any) => criteria.id === dimensionId);\r\n            return {\r\n              id: dimensionId,\r\n              values: (found?.values || [])\r\n            }\r\n          });\r\n\r\n          const flatCodelists = criteria ? criteria.map(({values}: any) => (values || [])) : [];\r\n\r\n          let areCodelistsFlat = flatCodelists.map(() => true);\r\n          flatCodelists.forEach((codelist: any, idx: number) => {\r\n            codelist.forEach((item: any) => {\r\n              if (areCodelistsFlat[idx] && item.parentId !== null && item.parentId !== undefined) {\r\n                areCodelistsFlat[idx] = false;\r\n              }\r\n            })\r\n          })\r\n\r\n          const timePeriodIdx = (state.dimensions || []).map(({id}: any) => id).indexOf(TIME_PERIOD_KEY);\r\n          const freqIdx = (state.dimensions || []).map(({id}: any) => id).indexOf(FREQ_KEY);\r\n\r\n          return {\r\n            ...state,\r\n            codelists: flatCodelists.map((flatCodes: any) => getTreeFromArray((flatCodes || []), \"parentId\", \"children\")),\r\n            areCodelistsFlat: areCodelistsFlat,\r\n            timePeriod: getTimePeriod(\r\n              state.timePeriod,\r\n              state.filters,\r\n              criteria[timePeriodIdx],\r\n              criteria[freqIdx]\r\n            ),\r\n            codelistsLength: flatCodelists.map((codelist: any, idx: number) => idx !== timePeriodIdx ? codelist.length : null)\r\n          }\r\n        }\r\n        case DATASET_ACCESSIBLE_FETCH: {\r\n          return {\r\n            ...state,\r\n            accessibleDataset: action.payload.response\r\n          }\r\n        }\r\n        case DATASET_TERRITORY_FETCH: {\r\n          const detailLevels = action.payload.response.map((val: any, idx: number) => val.nutsLevel)\r\n            .reduce((acc: any, val: any) => {\r\n              if (!acc[val]) {\r\n                const label = \"Nuts level \" + val;\r\n                acc[val] = {level: val, counter: 0, label: label};\r\n              }\r\n              acc[val].counter++;\r\n              return acc;\r\n            }, [])\r\n            .filter((v: any) => {\r\n              if (v.counter <= 1) {\r\n                console.log(\"hiding NUTS level \" + v.level + \" (size = \" + v.counter + \")\");\r\n              }\r\n              return v.counter > 1\r\n            }).sort((a: any, b: any) => a.level - b.level);\r\n\r\n          return {\r\n            ...state,\r\n            geometries: action.payload.response,\r\n            geometryDetailLevels: detailLevels\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          return {\r\n            ...initialState,\r\n            enableCriteria: false,\r\n            enableLayout: false\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n          return {\r\n            ...state\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELISTS_FETCH: {\r\n          return {\r\n            ...state\r\n          }\r\n        }\r\n        case DATASET_DOWNLOAD_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            isDownloadWarningVisible: action.payload.statusCode === 406\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\nexport default datasetReducer;","export const FETCH_DATASET_ASYNC_HANDLER_INIT = \"fetch/dataset/async/handler/init\"\r\nexport const FETCH_DATASET_ASYNC_HANDLER_SUCCESS = \"fetch/dataset/async/handler/success\"\r\nexport const FETCH_DATASET_ASYNC_HANDLER_ERROR = \"fetch/dataset/async/handler/error\"\r\n\r\nexport const initFetchDatasetAsyncHandler = () => ({\r\n  type: FETCH_DATASET_ASYNC_HANDLER_INIT\r\n});\r\n\r\nexport const successFetchDatasetAsyncHandler = (response, statusCode, responseHeaders, cellCount, isResponseNotValid, initialTableLayout, initialMapLayout, initialChartLayout, worker) => ({\r\n  type: FETCH_DATASET_ASYNC_HANDLER_SUCCESS,\r\n  payload: {\r\n    response,\r\n    statusCode,\r\n    responseHeaders,\r\n    cellCount,\r\n    isResponseNotValid,\r\n    initialTableLayout,\r\n    initialMapLayout,\r\n    initialChartLayout,\r\n    worker\r\n  }\r\n});\r\n\r\nexport const errorFetchDatasetAsyncHandler = statusCode => ({\r\n  type: FETCH_DATASET_ASYNC_HANDLER_ERROR,\r\n  payload: {\r\n    statusCode\r\n  }\r\n});","import React from \"react\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  cardTitle: {\r\n    fontSize: 17,\r\n    fontWeight: \"bold\"\r\n  },\r\n  datasetAttributesCard: {\r\n    background: \"#F5F5F5\"\r\n  },\r\n  datasetAttributes: {\r\n    margin: 0,\r\n    padding: \"0 16px 16px\"\r\n  },\r\n  seriesAttributes: {\r\n    margin: 0,\r\n    padding: \"0 0 16px\"\r\n  },\r\n  attributeGroup: {\r\n    margin: 0,\r\n    padding: \"0 16px\"\r\n  }\r\n});\r\n\r\nconst Attribute = ({attribute, list}) =>\r\n  <Grid item xs={12}>\r\n    {`${list ? \"- \" : \"\"}${attribute.id}: ${attribute.value}`}\r\n  </Grid>;\r\n\r\nfunction AttributeList(props) {\r\n\r\n  const {\r\n    classes,\r\n    datasetAttributes,\r\n    otherAttributes\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {datasetAttributes.length > 0 && (\r\n        <Card variant=\"outlined\" className={classes.datasetAttributesCard}>\r\n          <CardHeader\r\n            title={\r\n              <div className={classes.cardTitle}>\r\n                {t(\"components.attributeList.datasetInformation.title\")}:\r\n              </div>\r\n            }\r\n            disableTypography\r\n          />\r\n          <Grid container spacing={2} className={classes.datasetAttributes}>\r\n            {datasetAttributes.map((attribute, idx) =>\r\n              <Attribute\r\n                key={idx}\r\n                attribute={attribute}\r\n              />\r\n            )}\r\n          </Grid>\r\n        </Card>\r\n      )}\r\n      {otherAttributes.length > 0 && (\r\n        <Card variant=\"outlined\" style={{marginTop: 16}}>\r\n          <CardHeader\r\n            title={\r\n              <div className={classes.cardTitle}>\r\n                {t(\"components.attributeList.seriesInformation.title\")}:\r\n              </div>\r\n            }\r\n            disableTypography\r\n          />\r\n          <Grid container spacing={2} className={classes.seriesAttributes}>\r\n            {otherAttributes.map(({dims, attributes}, idx) =>\r\n              <Grid\r\n                container\r\n                key={idx}\r\n                spacing={2}\r\n                className={classes.attributeGroup}\r\n                style={{background: idx % 2 ? \"#FFFFFF\" : \"#F5F5F5\"}}\r\n              >\r\n                <Grid item xs={12}>\r\n                  {dims.map(({id, value}, idx) =>\r\n                    <div key={idx} style={{display: \"inline-block\", marginRight: 8}}>\r\n                      <b>{id}</b>: <i>{value}</i>{idx < dims.length - 1 ? \",\" : \"\"}\r\n                    </div>\r\n                  )}\r\n                </Grid>\r\n                {attributes.map((attribute, idx) =>\r\n                  <Attribute\r\n                    key={idx}\r\n                    attribute={attribute}\r\n                    list\r\n                  />\r\n                )}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(AttributeList)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport ShareIcon from '@material-ui/icons/Share';\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {goToNode} from \"../../links\";\r\nimport HomeIcon from \"@material-ui/icons/Home\";\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport AccessTimeIcon from '@material-ui/icons/AccessTime';\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {GENERATING_HTML_TIME_KEY, OBSERVATION_COUNT_KEY, SERVER_TIMINGS_KEY} from \"../../state/dataset/datasetReducer\";\r\nimport ButtonSelect from \"../button-select\";\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport JsonStatTable from \"../table\";\r\nimport AttributeList from \"../attribute-list\";\r\nimport {\r\n  getDimensionAttributeMap,\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat\r\n} from \"../../utils/jsonStat\";\r\nimport {DECIMAL_PLACES_DEFAULT, DECIMAL_SEPARATOR_DEFAULT, EMPTY_CHAR_DEFAULT} from \"../../utils/formatters\";\r\nimport {\r\n  canSaveAsView,\r\n  canSaveTemplate,\r\n  canShare,\r\n  canViewTemplateOrAnnotationIcon,\r\n  canViewTimesLog\r\n} from \"../../utils/user\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport I18nTextField from \"../i18n-text-field\";\r\nimport {localizeI18nObj, validateI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  exportChartJpeg,\r\n  getDownloadFormatExtensionFromFormat,\r\n  getDownloadFormatLabelFromFormat,\r\n  isDownloadFormatValid\r\n} from \"../../utils/download\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px 0\"\r\n  },\r\n  headerTitle: {\r\n    marginRight: 8\r\n  },\r\n  headerActions: {},\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 500\r\n  },\r\n  titleAction: {},\r\n  subtitle: {\r\n    padding: \"0 12px 8px 48px\"\r\n  },\r\n  card: {\r\n    padding: theme.spacing(2)\r\n  },\r\n  viewer: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 16px - 64px)\",\r\n    marginTop: 16\r\n  },\r\n  field: {},\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 48px)\",\r\n    paddingTop: 16\r\n  },\r\n  attributeIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontSize: 23,\r\n    fontWeight: \"bold\",\r\n    fontFamily: \"Do Hyeon\"\r\n  },\r\n  icon: {\r\n    width: 48,\r\n    height: 48,\r\n    padding: 12,\r\n    color: \"rgba(0, 0, 0, 0.54)\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user,\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nfunction DataViewerHeader(props) {\r\n\r\n  const {\r\n    classes,\r\n    user,\r\n    defaultLanguage,\r\n    languages,\r\n    nodeId,\r\n    nodeCode,\r\n    nodeDownloadFormats,\r\n    datasetId,\r\n    datasetTitle,\r\n    hasTemplateLayout,\r\n    hasAnnotationLayout,\r\n    notes,\r\n    attachedFiles,\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    labelFormat,\r\n    tableLayout,\r\n    chartLayout,\r\n    mapLayout,\r\n    criteria,\r\n    decimalSeparator: initialDecimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    viewers,\r\n    viewerIdx,\r\n    onViewTemplateSubmit,\r\n    onDownloadSubmit,\r\n    timings,\r\n    chartId,\r\n    mapId\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [initialTemplate] = useState({\r\n    datasetId: \"\",\r\n    type: \"\",\r\n    title: {},\r\n    defaultView: \"\",\r\n    criteria: {},\r\n    layouts: {\r\n      tableDefaultLayout: \"\",\r\n      tableLayout: {},\r\n      tableEmptyChar: \"\",\r\n      mapLayout: {},\r\n      chartLayout: {}\r\n    },\r\n    decimalNumber: \"\",\r\n    decimalSeparator: {},\r\n    enableCriteria: true,\r\n    enableLayout: true\r\n  });\r\n\r\n  const [isViewVisible, setViewVisibility] = useState(false);\r\n\r\n  const [isTemplateVisible, setTemplateVisibility] = useState(false);\r\n  const [tabId, setTabId] = useState(0);\r\n\r\n  const [template, setTemplate] = useState(initialTemplate);\r\n\r\n  const [isAttributesVisible, setAttributesVisibility] = useState(false);\r\n\r\n  const [isNotesVisible, setNotesVisibility] = useState(false);\r\n\r\n  const [downloadFormats, setDownloadFormats] = useState([]);\r\n\r\n  const [isTimingsVisible, setTimingsVisibility] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const actionsWidth = document.getElementById(\"dataset-viewer-header__actions\")\r\n      ? document.getElementById(\"dataset-viewer-header__actions\").offsetWidth\r\n      : 0;\r\n    document.getElementById(\"dataset-viewer-header__title\").setAttribute(\"style\", `width: calc(100% - ${actionsWidth}px - 8px)`);\r\n  });\r\n\r\n  useEffect(() => {\r\n    const newDownloadFormats = [];\r\n    (nodeDownloadFormats || []).forEach(format => {\r\n      if (isDownloadFormatValid(format)) {\r\n        newDownloadFormats.push({\r\n          label: getDownloadFormatLabelFromFormat(format, t),\r\n          format: format,\r\n          extension: getDownloadFormatExtensionFromFormat(format, t)\r\n        })\r\n      }\r\n    });\r\n    setDownloadFormats(newDownloadFormats);\r\n  }, [nodeDownloadFormats, t]);\r\n\r\n  const handleViewOpen = defaultLanguage => {\r\n    setViewVisibility(true);\r\n    setTemplate({\r\n      datasetId: datasetId,\r\n      title: {\r\n        [defaultLanguage]: `${viewers[viewerIdx].title} - ${datasetTitle}`\r\n      },\r\n      defaultView: viewers[viewerIdx].type,\r\n      criteria: criteria,\r\n      layouts: {\r\n        labelFormat: labelFormat,\r\n        tableLayout: viewerIdx === 0 ? tableLayout : null,\r\n        mapLayout: viewerIdx === 1 ? mapLayout : null,\r\n        chartLayout: viewerIdx >= 2 ? chartLayout : null\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleViewClose = () => {\r\n    setViewVisibility(false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const handleViewSubmit = () => {\r\n    onViewTemplateSubmit(\r\n      {\r\n        type: \"view\",\r\n        datasetId: template.datasetId,\r\n        title: template.title,\r\n        defaultView: template.defaultView,\r\n        criteria: template.criteria,\r\n        layouts: JSON.stringify(template.layouts)\r\n      },\r\n      true\r\n    );\r\n    setViewVisibility(false);\r\n  };\r\n\r\n  const handleTemplateOpen = defaultLanguage => {\r\n    setTemplateVisibility(true);\r\n    setTemplate({\r\n      ...initialTemplate,\r\n      datasetId: datasetId,\r\n      title: {\r\n        [defaultLanguage]: datasetTitle\r\n      },\r\n      defaultView: \"table\",\r\n      criteria: criteria,\r\n      layouts: {\r\n        labelFormat: labelFormat,\r\n        tableDefaultLayout: \"custom\",\r\n        tableLayout: tableLayout,\r\n        tableEmptyChar: (emptyChar !== null && emptyChar !== undefined) ? emptyChar : EMPTY_CHAR_DEFAULT,\r\n        mapLayout: mapLayout,\r\n        chartLayout: chartLayout\r\n      },\r\n      decimalNumber: (decimalPlaces !== null && decimalPlaces !== undefined) ? decimalPlaces : DECIMAL_PLACES_DEFAULT,\r\n      decimalSeparator: {\r\n        [defaultLanguage]: (initialDecimalSeparator || DECIMAL_SEPARATOR_DEFAULT)\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleTemplateClose = () => {\r\n    setTabId(0);\r\n    setTemplateVisibility(false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const handleTemplateSubmit = () => {\r\n    onViewTemplateSubmit(\r\n      {\r\n        ...template,\r\n        type: \"template\",\r\n        criteria: template.criteria,\r\n        layouts: JSON.stringify(template.layouts)\r\n      },\r\n      false\r\n    );\r\n    setTabId(0);\r\n    setTemplateVisibility(false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const datasetAttributes = [];\r\n  const dataset = (jsonStat?.extension?.attributes?.dataSet || []);\r\n  const datasetIndexes = (jsonStat?.extension?.attributes?.index?.dataSet || []);\r\n\r\n  if (dataset && dataset.length > 0 && datasetIndexes && datasetIndexes.length > 0) {\r\n    (datasetIndexes || []).forEach((el, idx) => {\r\n      if (el !== null && !(hiddenAttributes || []).includes(dataset[idx].id)) {\r\n        datasetAttributes.push({\r\n          id: (dataset[idx].name || dataset[idx].id),\r\n          value: (dataset[idx].values[el].name || dataset[idx].values[el].id)\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  const otherAttributes = [];\r\n  const series = (jsonStat?.extension?.attributes?.series || []);\r\n  const seriesIndexes = (jsonStat?.extension?.attributes?.index?.series || []);\r\n\r\n  if (series && series.length > 0 && seriesIndexes && seriesIndexes.length > 0) {\r\n    seriesIndexes\r\n      .filter(({coordinates}) => (coordinates || []).filter(c => c !== null).length > 1)\r\n      .forEach(({coordinates, attributes}) => {\r\n        const dimsId = [];\r\n        const dimsValueId = [];\r\n        coordinates.forEach((el, idx) => {\r\n          if (el !== null) {\r\n            const dim = jsonStat.id[idx];\r\n            dimsId.push(dim);\r\n            dimsValueId.push(jsonStat.dimension[dim].category.index[el]);\r\n          }\r\n        });\r\n        const dims = dimsId.map((dim, idx) => ({\r\n          id: getDimensionLabelFromJsonStat(jsonStat, dim, labelFormat),\r\n          value: getDimensionValueLabelFromJsonStat(jsonStat, dim, dimsValueId[idx], labelFormat)\r\n        }));\r\n        const attrs = [];\r\n        attributes.forEach((attr, idx) => {\r\n          if (attr !== null && attr !== undefined && !(hiddenAttributes || []).includes(series[idx].id)) {\r\n            attrs.push({\r\n              id: (series[idx].name || series[idx].id),\r\n              value: (series[idx].values[attr].name || series[idx].values[attr].id)\r\n            })\r\n          }\r\n        });\r\n        if (dims.length > 0 && attrs.length > 0) {\r\n          otherAttributes.push({\r\n            dims: dims,\r\n            attributes: attrs\r\n          });\r\n        }\r\n      });\r\n  }\r\n\r\n  const currentFilters = (viewers[viewerIdx].key === 0 && tableLayout?.filters)\r\n    ? tableLayout.filters\r\n    : (viewers[viewerIdx].key === 1 && mapLayout?.filters)\r\n      ? mapLayout.filters\r\n      : (viewers[viewerIdx].key >= 2 && chartLayout?.filters)\r\n        ? chartLayout.filters\r\n        : [];\r\n\r\n  const subtitle = [];\r\n  if (jsonStat && currentFilters) {\r\n    currentFilters.forEach(filter => {\r\n      if (jsonStat.size[jsonStat.id.indexOf(filter)] === 1) {\r\n        subtitle.push({\r\n          dim: filter,\r\n          dimLabel: getDimensionLabelFromJsonStat(jsonStat, filter, labelFormat),\r\n          value: jsonStat.dimension[filter].category.index[0],\r\n          valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, filter, jsonStat.dimension[filter].category.index[0], labelFormat)\r\n        });\r\n      }\r\n    })\r\n  }\r\n\r\n  const dimensionAttributesMap = getDimensionAttributeMap(jsonStat, hiddenAttributes);\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <Grid container className={classes.root}>\r\n        <Grid container justify=\"space-between\" alignItems=\"flex-start\">\r\n          <Grid item id=\"dataset-viewer-header__title\" className={classes.headerTitle}>\r\n            <Grid container alignItems=\"flex-start\">\r\n              <Grid item>\r\n                <Tooltip title={t(\"scenes.dataViewer.header.action.goHome.tooltip\")}>\r\n                  <IconButton color=\"primary\" onClick={() => goToNode(nodeCode)}>\r\n                    <HomeIcon/>\r\n                  </IconButton>\r\n                </Tooltip>\r\n              </Grid>\r\n              <Grid container style={{width: \"calc(100% - 48px)\"}}>\r\n                <Grid item className={classes.title}>\r\n                  <div style={{display: \"table\", minHeight: 48}}>\r\n                    <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n                      <span style={{marginRight: 4}}>{datasetTitle}</span>\r\n                      {notes && notes.length > 0 && (\r\n                        <Tooltip title={t(\"scenes.dataViewer.header.action.information.tooltip\")}>\r\n                          <IconButton\r\n                            id=\"dataset-attributes-btn\"\r\n                            className={classes.titleAction}\r\n                            onClick={() => setNotesVisibility(true)}\r\n                          >\r\n                            <InfoIcon/>\r\n                          </IconButton>\r\n                        </Tooltip>\r\n                      )}\r\n                      {datasetAttributes.concat(otherAttributes).length > 0 && (\r\n                        <Tooltip title={t(\"scenes.dataViewer.header.action.attributes.tooltip\")}>\r\n                          <IconButton\r\n                            id=\"dataset-attributes-btn\"\r\n                            className={classes.titleAction}\r\n                            onClick={() => setAttributesVisibility(true)}\r\n                          >\r\n                            <div className={classes.attributeIcon}>(*)</div>\r\n                          </IconButton>\r\n                        </Tooltip>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item id=\"dataset-viewer-header__actions\" className={classes.headerActions}>\r\n            <Grid container alignItems=\"center\">\r\n              {canViewTemplateOrAnnotationIcon(user, nodeId) && hasTemplateLayout && (\r\n                <div className={classes.icon}>\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.hasTemplate.tooltip\")}>\r\n                    <InfoIcon/>\r\n                  </Tooltip>\r\n                </div>\r\n              )}\r\n              {canViewTemplateOrAnnotationIcon(user, nodeId) && viewerIdx === 0 && !hasTemplateLayout && hasAnnotationLayout && (\r\n                <div className={classes.icon}>\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.hasAnnotationLayout.tooltip\")}>\r\n                    <InfoIcon/>\r\n                  </Tooltip>\r\n                </div>\r\n              )}\r\n              {canViewTimesLog(user, nodeId) && (\r\n                <Grid item id=\"dataset-times-log-btn\">\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.timesLog.tooltip\")}>\r\n                    <div>\r\n                      <IconButton onClick={() => setTimingsVisibility(true)} disabled={timings === null}>\r\n                        <AccessTimeIcon/>\r\n                      </IconButton>\r\n                    </div>\r\n                  </Tooltip>\r\n                </Grid>\r\n              )}\r\n              {(canSaveAsView(user) || canSaveTemplate(user, nodeId)) && (\r\n                <Grid item id=\"dataset-save-btn\">\r\n                  <ButtonSelect\r\n                    icon={<SaveIcon/>}\r\n                    tooltip={t(\"scenes.dataViewer.header.action.save.tooltip\")}\r\n                    color=\"default\"\r\n                    disabled={!tableLayout && !chartLayout && !mapLayout}\r\n                  >\r\n                    {canSaveAsView(user) && (\r\n                      <div onClick={() => handleViewOpen(defaultLanguage)}>\r\n                        {t(\"scenes.dataViewer.header.action.save.values.view\")}\r\n                      </div>\r\n                    )}\r\n                    {canSaveTemplate(user, nodeId) && (\r\n                      <div onClick={() => handleTemplateOpen(defaultLanguage)}>\r\n                        {t(\"scenes.dataViewer.header.action.save.values.template\")}\r\n                      </div>\r\n                    )}\r\n                  </ButtonSelect>\r\n                </Grid>\r\n              )}\r\n              {canShare(user) && (\r\n                <Grid item id=\"dataset-share-btn\">\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.share.tooltip\")}>\r\n                    <IconButton onClick={window.notImplemented.show}>\r\n                      <ShareIcon/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                </Grid>\r\n              )}\r\n              <Grid item id=\"dataset-attachments-btn\">\r\n                <ButtonSelect\r\n                  icon={<AttachFileIcon/>}\r\n                  tooltip={t(\"scenes.dataViewer.header.action.attachments.tooltip\")}\r\n                  color=\"default\"\r\n                  onChange={({attachedFile}) => window.open(attachedFile.url)}\r\n                  disabled={!attachedFiles || attachedFiles.length === 0}\r\n                >\r\n                  {(attachedFiles || []).map((attachedFile, idx) => (\r\n                    <div key={idx} data-value={{attachedFile}}>\r\n                      {`${attachedFile.url} (${attachedFile.format})`}\r\n                    </div>\r\n                  ))}\r\n                </ButtonSelect>\r\n              </Grid>\r\n              {(downloadFormats && downloadFormats.length > 0 && (\r\n                <Grid item id=\"dataset-export-btn\">\r\n                  <ButtonSelect\r\n                    icon={<GetAppIcon/>}\r\n                    tooltip={t(\"scenes.dataViewer.header.action.export.tooltip\")}\r\n                    color=\"default\"\r\n                    onChange={({format, extension}) => {\r\n                      if (format === \"png\" && viewerIdx === 1) {\r\n                        window.LMap.exportPng(mapId, `${datasetTitle}.png`);\r\n                      } else if (format === \"jpeg\" && viewerIdx >= 2) {\r\n                        exportChartJpeg(chartId, `${datasetTitle}.jpeg`);\r\n                      } else {\r\n                        onDownloadSubmit(format, extension);\r\n                      }\r\n                    }}\r\n                  >\r\n                    {(downloadFormats)\r\n                      .concat(viewerIdx === 1\r\n                        ? {format: \"png\", label: \"PNG\", extension: \"png\"}\r\n                        : viewerIdx >= 2\r\n                          ? {format: \"jpeg\", label: \"JPEG\", extension: \"jpeg\"}\r\n                          : []\r\n                      )\r\n                      .map(({format, label, extension}, idx) =>\r\n                        <div key={idx} data-value={{format, extension}}>\r\n                          {label}\r\n                        </div>\r\n                      )}\r\n                  </ButtonSelect>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n        <Grid item className={classes.subtitle} xs={12}>\r\n          {subtitle && dimensionAttributesMap && subtitle.map(({dim, dimLabel, value, valueLabel}, idx) =>\r\n            <div key={idx} style={{display: \"inline-block\", marginRight: 8}}>\r\n              <div style={{display: \"inline-block\"}}>\r\n                <b>{dimLabel}</b>: <i>{valueLabel}</i>\r\n              </div>\r\n              {dimensionAttributesMap[dim][value] && (\r\n                <div style={{display: \"inline-block\", marginLeft: 4}}>\r\n                  <Tooltip\r\n                    title={\r\n                      <div>\r\n                        {dimensionAttributesMap[dim][value].attributes.map(({id, label, valueId, valueLabel}, idx) => (\r\n                          <div\r\n                            key={idx}>{`${label || id}: ${valueLabel || valueId}${valueLabel !== valueId ? ` [${valueId}]` : ''}`}</div>\r\n                        ))}\r\n                      </div>\r\n                    }\r\n                    placement=\"top\"\r\n                  >\r\n                    <div>\r\n                      {`[${dimensionAttributesMap[dim][value].ids.join(\", \")}]`}\r\n                    </div>\r\n                  </Tooltip>\r\n                </div>\r\n              )}\r\n              <div style={{display: \"inline-block\"}}>\r\n                {idx < subtitle.length - 1 ? \",\" : \"\"}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <Dialog\r\n        open={isAttributesVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setAttributesVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.attributes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <AttributeList\r\n            datasetAttributes={datasetAttributes}\r\n            otherAttributes={otherAttributes}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setAttributesVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isTimingsVisible}\r\n        onClose={() => setTimingsVisibility(false)}\r\n      >\r\n        <DialogContent style={{width: 400}}>\r\n          <div>\r\n            {(() => {\r\n              const toStamp = [];\r\n\r\n              const TOTAL_TIME_KEY = \"BackeEnd completed\";\r\n              const DOWNLOAD_SIZE_KEY = \"NSI Response Download Size\";\r\n\r\n              const getRow = (key, value, isBold) => (\r\n                <Grid container justify=\"space-between\" spacing={2} key={key}>\r\n                  <Grid item>\r\n                    {isBold ? <b>{key}:</b> : `${key}:`}\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <b>{value}</b>\r\n                  </Grid>\r\n                </Grid>\r\n              );\r\n\r\n              const titleStyle = {\r\n                width: \"100%\",\r\n                height: 32,\r\n                fontSize: 15\r\n              };\r\n\r\n              if (timings) {\r\n\r\n                toStamp.push(getRow(\"Observation count\", timings[OBSERVATION_COUNT_KEY], true));\r\n                toStamp.push(<Divider style={{margin: \"8px 0\"}} key=\"divider3\"/>);\r\n\r\n                /** server side **/\r\n                if (timings[SERVER_TIMINGS_KEY]) {\r\n                  toStamp.push(\r\n                    <div style={{...titleStyle, marginTop: 24}} key=\"server\"><b><u>Server timings</u></b></div>\r\n                  );\r\n                  for (const key in timings[SERVER_TIMINGS_KEY]) {\r\n                    if (timings[SERVER_TIMINGS_KEY].hasOwnProperty(key)) {\r\n                      if (key !== TOTAL_TIME_KEY && key !== DOWNLOAD_SIZE_KEY) {\r\n                        toStamp.push(\r\n                          getRow(key, timings[SERVER_TIMINGS_KEY][key])\r\n                        )\r\n                      }\r\n                    }\r\n                  }\r\n                  toStamp.push(<Divider style={{margin: \"8px 0\"}} key=\"divider1\"/>);\r\n                  toStamp.push(getRow(\"Total\", timings[SERVER_TIMINGS_KEY][TOTAL_TIME_KEY], true));\r\n                  toStamp.push(<Divider style={{margin: \"8px 0\"}} key=\"divider2\"/>);\r\n                  if (timings[SERVER_TIMINGS_KEY][DOWNLOAD_SIZE_KEY]) {\r\n                    toStamp.push(getRow(DOWNLOAD_SIZE_KEY, timings[SERVER_TIMINGS_KEY][DOWNLOAD_SIZE_KEY]));\r\n                  }\r\n                }\r\n\r\n                /** client side **/\r\n                if (timings[GENERATING_HTML_TIME_KEY] !== null && timings[GENERATING_HTML_TIME_KEY] !== undefined) {\r\n                  toStamp.push(\r\n                    <div style={{...titleStyle, marginTop: 24}} key=\"client\"><b><u>Client timings</u></b></div>\r\n                  );\r\n                  toStamp.push(getRow(\"Generating HTML\", `${timings[GENERATING_HTML_TIME_KEY]}ms`));\r\n                }\r\n              }\r\n\r\n              return toStamp\r\n            })()}\r\n          </div>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => setTimingsVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isViewVisible}\r\n        onClose={handleViewClose}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.saveView.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{width: 480}}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={12}>\r\n              <FormControl fullWidth className={classes.field}>\r\n                <I18nTextField\r\n                  label=\"Title\"\r\n                  required\r\n                  variant=\"outlined\"\r\n                  value={template.title}\r\n                  onChange={value => setTemplate({...template, title: value})}\r\n                />\r\n              </FormControl>\r\n            </Grid>\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleViewClose}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button\r\n            color=\"primary\"\r\n            autoFocus\r\n            onClick={handleViewSubmit}\r\n            disabled={!validateI18nObj(template.title)}\r\n          >\r\n            {t(\"commons.confirm.save\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isTemplateVisible}\r\n        fullScreen\r\n        onClose={handleTemplateClose}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.saveTemplate.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <AppBar position=\"static\" color=\"default\">\r\n            <Tabs\r\n              value={tabId}\r\n              variant=\"scrollable\"\r\n              scrollButtons=\"auto\"\r\n              indicatorColor=\"primary\"\r\n              textColor=\"primary\"\r\n              onChange={(event, newValue) => setTabId(newValue)}\r\n            >\r\n              <Tab key={0} label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.label\")}/>\r\n              <Tab key={1} label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.label\")}/>\r\n              <Tab key={2} label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.chart.label\")}/>\r\n              <Tab key={3} label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.map.label\")}/>\r\n            </Tabs>\r\n          </AppBar>\r\n          <div className={classes.tabContent}>\r\n            {tabId === 0 && (\r\n              <Fragment>\r\n                <Card variant=\"outlined\">\r\n                  <CardHeader\r\n                    title={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.title\")}\r\n                    titleTypographyProps={{variant: \"subtitle1\"}}\r\n                  />\r\n                  <Grid container spacing={2} className={classes.card}>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <I18nTextField\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.title\")}\r\n                          required\r\n                          variant=\"outlined\"\r\n                          value={template.title}\r\n                          onChange={value => setTemplate({...template, title: value})}\r\n                        />\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <TextField\r\n                          select\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.defaultView\")}\r\n                          defaultValue=\"table\"\r\n                          value={template.defaultView}\r\n                          variant=\"outlined\"\r\n                          onChange={ev => setTemplate({...template, defaultView: ev.target.value})}\r\n                        >\r\n                          {viewers.map(({type, title}, idx) =>\r\n                            <MenuItem key={idx} value={type}>{title}</MenuItem>\r\n                          )}\r\n                        </TextField>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControlLabel\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.enableCriteria\")}\r\n                        className={classes.field}\r\n                        control={\r\n                          <Checkbox\r\n                            checked={template.enableCriteria}\r\n                            onChange={(ev, value) => setTemplate({...template, enableCriteria: value})}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControlLabel\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.enableLayout\")}\r\n                        className={classes.field}\r\n                        control={\r\n                          <Checkbox\r\n                            checked={template.enableLayout}\r\n                            onChange={(ev, value) => setTemplate({...template, enableLayout: value})}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControlLabel\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.hideDimensions\") + \" (*)\"}\r\n                        className={classes.field}\r\n                        control={\r\n                          <Checkbox\r\n                            checked={template.hideDimensions}\r\n                            onChange={(ev, value) => setTemplate({...template, hideDimensions: value})}\r\n                            disabled\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControlLabel\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.enableVariation\") + \" (*)\"}\r\n                        className={classes.field}\r\n                        control={\r\n                          <Checkbox\r\n                            checked={true} // template.enableVariation\r\n                            onChange={(ev, value) => setTemplate({...template, enableVariation: value})}\r\n                            disabled\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <TextField\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.decimalPlaces\")}\r\n                          value={template.decimalNumber}\r\n                          variant=\"outlined\"\r\n                          required\r\n                          onChange={ev => setTemplate({...template, decimalNumber: ev.target.value})}\r\n                        />\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <I18nTextField\r\n                          select\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.decimalSeparator.label\")}\r\n                          value={template.decimalSeparator}\r\n                          defaultValue=\".\"\r\n                          variant=\"outlined\"\r\n                          required\r\n                          onChange={value => setTemplate({...template, decimalSeparator: value})}\r\n                        >\r\n                          <MenuItem value=\".\">\r\n                            {t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.decimalSeparator.values.dot\")}\r\n                          </MenuItem>\r\n                          <MenuItem value=\",\">\r\n                            {t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.decimalSeparator.values.comma\")}\r\n                          </MenuItem>\r\n                        </I18nTextField>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <TextField\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.filterOnLastPeriods\") + \" (*)\"}\r\n                          value={template.lastPeriods}\r\n                          type=\"number\"\r\n                          variant=\"outlined\"\r\n                          onChange={ev => setTemplate({...template, lastPeriods: ev.target.value})}\r\n                          disabled\r\n                        />\r\n                      </FormControl>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Card>\r\n                <Card variant=\"outlined\" style={{marginTop: 16}}>\r\n                  <CardHeader\r\n                    title={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.table.title\")}\r\n                    titleTypographyProps={{variant: \"subtitle1\"}}\r\n                  />\r\n                  <Grid container spacing={2} className={classes.card}>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <TextField\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.table.form.emptyCellPlaceholder\")}\r\n                          value={template.layouts.tableEmptyChar}\r\n                          variant=\"outlined\"\r\n                          required\r\n                          onChange={ev => setTemplate({\r\n                            ...template,\r\n                            layouts: {\r\n                              ...template.layouts,\r\n                              tableEmptyChar: ev.target.value\r\n                            }\r\n                          })}\r\n                        />\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}/>\r\n                  </Grid>\r\n                </Card>\r\n                <div\r\n                  style={{marginTop: 16}}>{\"( *): \" + t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.notImplemented\")}</div>\r\n              </Fragment>\r\n            )}\r\n            {tabId === 1 && (\r\n              <Fragment>\r\n                <Grid container spacing={2}>\r\n                  <Grid item xs={12}>\r\n                    <FormControl fullWidth className={classes.field}>\r\n                      <TextField\r\n                        select\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.form.defaultLayout.label\")}\r\n                        value={template.layouts.tableDefaultLayout}\r\n                        variant=\"outlined\"\r\n                        onChange={ev => setTemplate({\r\n                          ...template,\r\n                          layouts: {\r\n                            ...template.layouts,\r\n                            tableDefaultLayout: ev.target.value,\r\n                            tableLayout: ev.target.value === \"custom\"\r\n                              ? tableLayout\r\n                              : null\r\n                          }\r\n                        })}\r\n                      >\r\n                        <MenuItem value=\"custom\">\r\n                          {t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.form.defaultLayout.values.custom\")}\r\n                        </MenuItem>\r\n                        <MenuItem value=\"default\">\r\n                          {t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.form.defaultLayout.values.default\")}\r\n                        </MenuItem>\r\n                      </TextField>\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Grid>\r\n                <div className={classes.viewer}>\r\n                  {template.layouts.tableDefaultLayout === \"custom\"\r\n                    ? (\r\n                      <JsonStatTable\r\n                        jsonStat={jsonStat}\r\n                        layout={tableLayout}\r\n                        labelFormat={labelFormat}\r\n                        decimalSeparator={localizeI18nObj(template.decimalSeparator, defaultLanguage, languages)}\r\n                        decimalPlaces={template.decimalNumber}\r\n                        emptyChar={template.layouts.tableEmptyChar}\r\n                        hiddenAttributes={hiddenAttributes}\r\n                      />\r\n                    )\r\n                    : (\r\n                      <CustomEmpty\r\n                        text={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.form.defaultLayout.defaultPlaceholder\")}/>\r\n                    )\r\n                  }\r\n                </div>\r\n              </Fragment>\r\n            )}\r\n            {tabId === 2 && (\r\n              <CustomEmpty text={t(\"commons.notImplemented\")}/>\r\n            )}\r\n            {tabId === 3 && (\r\n              <CustomEmpty text={t(\"commons.notImplemented\")}/>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleTemplateClose}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button\r\n            color=\"primary\"\r\n            autoFocus\r\n            onClick={handleTemplateSubmit}\r\n            disabled={(\r\n              !validateI18nObj(template.title) ||\r\n              !validateI18nObj(template.decimalSeparator) ||\r\n              !Number.isInteger(Number(template.decimalNumber)) || Number(template.decimalNumber) < 0 || Number(template.decimalNumber) > 20\r\n            )}\r\n          >\r\n            {t(\"commons.confirm.save\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isNotesVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setNotesVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.notes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          {notes}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setNotesVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps)\r\n)(DataViewerHeader)","import React, {useState} from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport MenuList from \"@material-ui/core/MenuList\";\r\nimport BarChartIcon from '@material-ui/icons/BarChart';\r\nimport BottomNavigationAction from \"@material-ui/core/BottomNavigationAction\";\r\nimport BottomNavigation from \"@material-ui/core/BottomNavigation\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    textAlign: \"center\",\r\n    '& ul': {\r\n      padding: \"4px 0\",\r\n      outline: \"none\"\r\n    },\r\n    \"& .MuiBottomNavigation-root\": {\r\n      height: \"unset !important\",\r\n      outline: \"none\"\r\n    }\r\n  },\r\n  floatingMenuOption: {\r\n    width: 200,\r\n    color: \"gray\"\r\n  },\r\n  floatingMenuOptionSelected: {\r\n    color: theme.palette.primary.main\r\n  },\r\n  divider: {\r\n    margin: \"4px 0\"\r\n  },\r\n  categoryTitle: {\r\n    color: \"gray\",\r\n    fontSize: 11,\r\n    fontWeight: 500\r\n  },\r\n  referenceMetadataIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontSize: 22,\r\n    fontWeight: \"bold\",\r\n    display: \"table\"\r\n  },\r\n  iFrame: {\r\n    width: 960,\r\n    border: 0\r\n  },\r\n  navigationActionDisabled: {\r\n    color: \"rgba(0, 0, 0, 0.54) !important\",\r\n    \"& svg\": {\r\n      color: \"rgba(0, 0, 0, 0.26)\"\r\n    }\r\n  }\r\n});\r\n\r\nfunction DataViewerSideBar(props) {\r\n\r\n  const {\r\n    classes,\r\n    viewers,\r\n    selected,\r\n    viewerSelectDisabled = false,\r\n    referenceMetadataUrl,\r\n    onViewerSelect,\r\n    onCriteriaOpen,\r\n    onLayoutOpen\r\n  } = props;\r\n\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n\r\n  const [isRefMetaVisible, setRefMetaVisibility] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const handleViewerSelect = index => {\r\n    onViewerSelect(index);\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const isCriteriaEnabled = !!onCriteriaOpen;\r\n  const isLayoutEnabled = !!onLayoutOpen;\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <MenuList>\r\n\r\n        <BottomNavigation onChange={onCriteriaOpen} showLabels>\r\n          <BottomNavigationAction\r\n            label={t(\"scenes.dataViewer.sidebar.criteria\")}\r\n            icon={<SettingsIcon/>}\r\n            className={!isCriteriaEnabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={!isCriteriaEnabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation onChange={onLayoutOpen} showLabels>\r\n          <BottomNavigationAction\r\n            label={t(\"scenes.dataViewer.sidebar.layout\")}\r\n            icon={<EditIcon/>}\r\n            className={!isLayoutEnabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={!isLayoutEnabled}\r\n          />\r\n        </BottomNavigation>\r\n\r\n        <Divider className={classes.divider}/>\r\n\r\n        {referenceMetadataUrl && (\r\n          <BottomNavigation\r\n            onChange={() => setRefMetaVisibility(true)}\r\n            showLabels style={{marginBottom: 8}}\r\n          >\r\n            <BottomNavigationAction\r\n              label={t(\"scenes.dataViewer.sidebar.referenceMetadata\")}\r\n              icon={\r\n                <div className={classes.referenceMetadataIcon}>\r\n                  <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n                    M\r\n                  </div>\r\n                </div>\r\n              }\r\n            />\r\n          </BottomNavigation>\r\n        )}\r\n\r\n        <BottomNavigation\r\n          value={selected === 0 ? 0 : null}\r\n          onChange={() => handleViewerSelect(0)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={viewers[0].title}\r\n            icon={viewers[0].icon}\r\n            className={viewerSelectDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={viewerSelectDisabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation\r\n          value={selected >= 2 ? 0 : null}\r\n          onChange={({currentTarget}) => setAnchorEl(currentTarget)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={selected >= 2 ? viewers[selected].title : t(\"scenes.dataViewer.sidebar.chart\")}\r\n            icon={selected >= 2 ? viewers[selected].icon : <BarChartIcon/>}\r\n            className={viewerSelectDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={viewerSelectDisabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation\r\n          value={selected === 1 ? 0 : null}\r\n          onChange={() => handleViewerSelect(1)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={viewers[1].title}\r\n            icon={viewers[1].icon}\r\n            className={viewerSelectDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={viewerSelectDisabled}\r\n          />\r\n        </BottomNavigation>\r\n\r\n      </MenuList>\r\n\r\n      <Menu\r\n        anchorEl={anchorEl}\r\n        keepMounted\r\n        open={Boolean(anchorEl)}\r\n        onClose={() => setAnchorEl(null)}\r\n      >\r\n        {viewers\r\n          .slice(2)\r\n          .map(option => (\r\n            <MenuItem\r\n              className={`${classes.floatingMenuOption} ${selected === option.key ? classes.floatingMenuOptionSelected : ''}`}\r\n              key={option.key}\r\n              selected={selected === option.key}\r\n              onClick={() => handleViewerSelect(option.key)}\r\n            >\r\n              {option.icon}\r\n              <Typography style={{marginLeft: 8}}>{option.title}</Typography>\r\n            </MenuItem>\r\n          ))}\r\n      </Menu>\r\n\r\n      <Dialog\r\n        open={isRefMetaVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setRefMetaVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.sidebar.dialogs.referenceMetadata.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{height: 480}}>\r\n          <iframe\r\n            title={\"title\"}\r\n            src={referenceMetadataUrl}\r\n            style={{\r\n              border: 0,\r\n              width: \"100%\",\r\n              height: \"calc(100% - 6px)\"\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setRefMetaVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withStyles(styles)(DataViewerSideBar)","import React, {Fragment, useState} from 'react';\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    whiteSpace: \"nowrap\"\r\n  },\r\n  sheet: {\r\n    display: \"inline-block\",\r\n    marginRight: 8\r\n  }\r\n});\r\n\r\nfunction DataViewerFooter(props) {\r\n\r\n  const {\r\n    classes,\r\n    labels,\r\n    dataIdx,\r\n    setData\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isConfirmOpen, setConfirmVisibility] = useState(false);\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <div className={classes.root}>\r\n        {labels\r\n          .map((label, idx) => ({key: idx, label: label}))\r\n          .map(sheet => (\r\n            <div key={sheet.key} className={classes.sheet}>\r\n              <Chip\r\n                label={sheet.label}\r\n                color={sheet.key === dataIdx ? \"primary\" : undefined}\r\n                onClick={() => setData(sheet.key)}\r\n                deleteIcon={\r\n                  <Tooltip title={t(\"scenes.dataViewer.footer.worksheetDelete\")}>\r\n                    <CancelIcon/>\r\n                  </Tooltip>\r\n                }\r\n                onDelete={dataIdx === sheet.key\r\n                  ? undefined\r\n                  : () => setConfirmVisibility(true)\r\n                }\r\n              />\r\n            </div>\r\n          ))}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={isConfirmOpen}\r\n        onClose={() => setConfirmVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.footer.dialogs.worksheetDelete.title\")}\r\n        </DialogTitle>\r\n        <DialogActions>\r\n          <Button onClick={() => setConfirmVisibility(false)} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => setConfirmVisibility(false)} color=\"primary\" autoFocus>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(DataViewerFooter)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport {getDimensionAttributeMap} from \"../../utils/jsonStat\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"../label-format-selector/constants\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  filter: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"bottom\",\r\n    minWidth: 120,\r\n    marginRight: 24,\r\n    marginBottom: 8\r\n  },\r\n  dialogContent: {\r\n    padding: \"8px !important\"\r\n  },\r\n  item: {\r\n    fontSize: 14\r\n  },\r\n  itemDisabled: {\r\n    pointerEvents: \"none\",\r\n    '& > svg': {\r\n      visibility: \"hidden\"\r\n    }\r\n  },\r\n  dimensionTitle: {\r\n    marginBottom: 4,\r\n    fontSize: 13,\r\n    color: theme.palette.primary.main\r\n  }\r\n});\r\n\r\nconst getFormattedName = (id, name, labelFormat) => {\r\n  switch (labelFormat) {\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME:\r\n      return name;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID:\r\n      return id;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH:\r\n      return `[${id}] ${name}`;\r\n    default:\r\n      return name;\r\n  }\r\n};\r\n\r\nconst isMultiSelectDim = (dim, layout) => (layout?.primaryDim?.[0] === dim || layout?.secondaryDim?.[0] === dim);\r\n\r\nfunction DatasetFilters(props) {\r\n  const {\r\n    classes,\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    layout,\r\n    labelFormat,\r\n    onSelect,\r\n    addSpinner,\r\n    removeSpinner\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [filters] = useState((layout?.primaryDim || []).concat((layout?.secondaryDim || [])).concat(layout?.filters || []));\r\n\r\n  const [visibleId, setVisibleId] = useState(null);\r\n  const [data, setData] = useState(null);\r\n\r\n  const [checkedKeys, setCheckedKeys] = useState(null);\r\n\r\n  const [dimensionAttributesMap, setDimensionAttributesMap] = useState(null);\r\n\r\n  const [dataSpinnerUuid] = useState(uuidv4());\r\n\r\n  const [worker] = useState(() => new Worker(\"./workers/getDimensionFiltersValueWorker.js\"));\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (worker) {\r\n        worker.terminate();\r\n      }\r\n    }\r\n  }, [worker]);\r\n\r\n  useEffect(() => {\r\n    setDimensionAttributesMap(getDimensionAttributeMap(jsonStat, hiddenAttributes))\r\n  }, [jsonStat, hiddenAttributes]);\r\n\r\n  const handleFilterOpen = visibleId => {\r\n    setVisibleId(visibleId);\r\n    const dim = filters[visibleId];\r\n\r\n    addSpinner(dataSpinnerUuid, t(\"components.datasetFilters.spinners.loading\"));\r\n    worker.onmessage = event => {\r\n      setData(event.data);\r\n      removeSpinner(dataSpinnerUuid);\r\n    }\r\n    worker.postMessage({\r\n      jsonStat,\r\n      dim,\r\n      layout\r\n    });\r\n\r\n    if (isMultiSelectDim(dim, layout)) {\r\n      if (checkedKeys === null && dim === layout?.primaryDim?.[0]) {\r\n        setCheckedKeys(layout.primaryDimValues);\r\n      } else if (checkedKeys === null && dim === layout?.secondaryDim?.[0]) {\r\n        setCheckedKeys(layout.secondaryDimValues);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleFilterClose = () => {\r\n    setVisibleId(null);\r\n    setCheckedKeys(null);\r\n    setData(null)\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.root}>\r\n        {(() => {\r\n          const getTextWidthEl = $('<span>').css({\r\n            visibility: 'hidden',\r\n            position: 'absolute',\r\n            fontSize: 16\r\n          }).appendTo('body').get(0);\r\n\r\n          const select = [];\r\n          filters.forEach((filter, idx) => {\r\n\r\n            const {\r\n              filtersValue\r\n            } = layout;\r\n\r\n            if (isMultiSelectDim(filter, layout) || jsonStat.size[jsonStat.id.indexOf(filter)] !== 1) {\r\n\r\n              const dimLabel = (jsonStat.dimension[filter].label || filter);\r\n              const minWidth = getTextWidth(dimLabel, getTextWidthEl) + 16;\r\n\r\n              select.push(\r\n                <div key={idx} className={classes.filter}>\r\n                  {isMultiSelectDim(filter, layout) && (\r\n                    <InputLabel className={classes.dimensionTitle}>\r\n                      {layout.primaryDim[0] === filter\r\n                        ? t(\"components.datasetFilters.primaryDim\")\r\n                        : t(\"components.datasetFilters.secondaryDim\")\r\n                      }\r\n                    </InputLabel>\r\n                  )}\r\n                  <FormControl style={{display: \"inline-block\", verticalAlign: \"bottom\"}}>\r\n                    <InputLabel>{dimLabel}</InputLabel>\r\n                    <Select\r\n                      open={false}\r\n                      style={{minWidth: minWidth}}\r\n                      value={isMultiSelectDim(filter, layout)\r\n                        ? layout.primaryDim[0] === filter\r\n                          ? layout.primaryDimValues\r\n                          : layout.secondaryDimValues\r\n                        : filtersValue[filter]\r\n                      }\r\n                      multiple={isMultiSelectDim(filter, layout)}\r\n                      renderValue={value => isMultiSelectDim(filter, layout)\r\n                        ? jsonStat.size[jsonStat.id.indexOf(filter)] !== 1\r\n                          ? value.length === 1\r\n                            ? t(\"components.datasetFilters.selectedCount\", {selected: value.length})\r\n                            : t(\"components.datasetFilters.selectedCount_plural\", {selected: value.length})\r\n                          : getFormattedName(value[0], jsonStat.dimension[filter].category.label[value[0]], labelFormat)\r\n                        : getFormattedName(value, jsonStat.dimension[filter].category.label[value], labelFormat)\r\n                      }\r\n                      className={`${classes.item} ${jsonStat.size[jsonStat.id.indexOf(filter)] === 1 ? classes.itemDisabled : \"\"}`}\r\n                      onOpen={() => jsonStat.size[jsonStat.id.indexOf(filter)] === 1\r\n                        ? null\r\n                        : handleFilterOpen(idx)\r\n                      }\r\n                    >\r\n                      {jsonStat.dimension[filter].category.index.map((el, idx) => (\r\n                        <MenuItem key={idx + el} value={el}>{el}</MenuItem>\r\n                      ))}\r\n                    </Select>\r\n                  </FormControl>\r\n                  {dimensionAttributesMap && dimensionAttributesMap[filter][filtersValue[filter]] && ( // TODO: attributi per dimensioni multiselezionabili\r\n                    <div style={{display: \"inline-block\", verticalAlign: \"bottom\", marginLeft: 8, marginBottom: 4}}>\r\n                      <Tooltip\r\n                        title={\r\n                          <div>\r\n                            {dimensionAttributesMap[filter][filtersValue[filter]].attributes.map(({id, label, valueId, valueLabel}, idx) => (\r\n                              <div\r\n                                key={idx}>{`${label || id}: ${valueLabel || valueId}${valueLabel !== valueId ? ` [${valueId}]` : ''}`}</div>\r\n                            ))}\r\n                          </div>\r\n                        }\r\n                        placement=\"top\"\r\n                      >\r\n                        <div>\r\n                          {`[${dimensionAttributesMap[filter][filtersValue[filter]].ids.join(\", \")}]`}\r\n                        </div>\r\n                      </Tooltip>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )\r\n            }\r\n          });\r\n\r\n          $(getTextWidthEl).remove();\r\n\r\n          return select\r\n        })()}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={data !== null}\r\n        onClose={handleFilterClose}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent className={classes.dialogContent}>\r\n          {!isMultiSelectDim(filters[visibleId], layout)\r\n            ? (\r\n              <InfiniteScrollTable\r\n                data={data}\r\n                getRowKey={({id}) => id}\r\n                showHeader={false}\r\n                columns={[\r\n                  {\r\n                    title: \"\",\r\n                    dataIndex: 'label',\r\n                    render: (_, {id, label}) => getFormattedName(id, label, labelFormat),\r\n                    minWidth: 100\r\n                  }\r\n                ]}\r\n                onRowClick={rowData => {\r\n                  onSelect(filters[visibleId], rowData.id);\r\n                  handleFilterClose();\r\n                }}\r\n                getRowStyle={rowData => ({\r\n                  background: rowData.id === layout.filtersValue[filters[visibleId]]\r\n                    ? \"#fff9e5\"\r\n                    : undefined\r\n                })}\r\n              />\r\n            )\r\n            : (\r\n              <InfiniteScrollTable\r\n                data={data}\r\n                getRowKey={({id}) => id}\r\n                columns={[\r\n                  {\r\n                    title: t(\"components.datasetFilters.table.columns.label.title\"),\r\n                    dataIndex: 'label',\r\n                    render: (_, {id, label}) => getFormattedName(id, label, labelFormat),\r\n                    minWidth: 100,\r\n                    noFilter: true\r\n                  }\r\n                ]}\r\n                rowSelection={{\r\n                  selectedRowKeys: checkedKeys,\r\n                  onChange: checkedKeys => setCheckedKeys(data.map(({id}) => id).filter(key => checkedKeys.includes(key)))\r\n                }}\r\n              />\r\n            )\r\n          }\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleFilterClose} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          {isMultiSelectDim(filters[visibleId], layout) && (\r\n            <Button\r\n              onClick={() => {\r\n                onSelect(filters[visibleId], checkedKeys);\r\n                handleFilterClose();\r\n              }}\r\n              color=\"primary\"\r\n              disabled={(checkedKeys || []).length < 1}\r\n            >\r\n              {t(\"commons.confirm.confirm\")}\r\n            </Button>\r\n          )}\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(null, dispatch => ({\r\n    addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n    removeSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError)),\r\n  })),\r\n  withStyles(styles)\r\n)(DatasetFilters);","import React, {Fragment, useEffect, useState} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport TreeItem from \"@material-ui/lab/TreeItem\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\r\nimport TreeView from \"@material-ui/lab/TreeView\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport LibraryAddCheckIcon from \"@material-ui/icons/LibraryAddCheck\";\r\nimport FilterNoneIcon from \"@material-ui/icons/FilterNone\";\r\nimport HeightIcon from \"@material-ui/icons/Height\";\r\nimport VerticalAlignCenterIcon from \"@material-ui/icons/VerticalAlignCenter\";\r\nimport AutoSearchInput from \"../auto-search-input\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {getMaxTreeDepth, getNodesAtDepth} from \"../../utils/tree\";\r\nimport _ from \"lodash\"\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst TREE_PAGE_SIZE = 10;\r\n\r\nconst TREE_NODE_KEY_OF_LEVEL_PREFIX = \"TREE_NODE_KEY_OF_LEVEL_PREFIX_\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: \"100%\"\r\n  },\r\n  tree: {\r\n    overflow: \"auto\",\r\n  },\r\n  treeActions: {\r\n    marginBottom: 6\r\n  },\r\n  treeNode: {\r\n    height: 34,\r\n    padding: \"2px 0\"\r\n  },\r\n  treeNodeCheckbox: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    padding: \"4px 8px\"\r\n  },\r\n  treeNodeLabel: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    fontSize: 14,\r\n    color: \"rgba(0, 0, 0, 0.65)\"\r\n  },\r\n  levelTreeNodeLabel: {\r\n    color: \"rgba(0, 0, 0, 0.85)\",\r\n    fontWeight: 500\r\n  },\r\n  treeNodeAction: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginLeft: 4,\r\n    \"& > button\": {\r\n      padding: 4\r\n    }\r\n  },\r\n  divider: {\r\n    margin: \"4px 0\"\r\n  },\r\n  showMoreNode: {\r\n    marginLeft: 10,\r\n    \"& i\": {\r\n      fontSize: 14\r\n    }\r\n  }\r\n});\r\n\r\nconst getKeys = (tree, childrenKey, getNodeKey, test) => {\r\n\r\n  const res = [];\r\n\r\n  const recursive = subTree =>\r\n    subTree\r\n      ? subTree.map(node => {\r\n        if (node[childrenKey] && node[childrenKey].length) {\r\n          recursive(node[childrenKey]);\r\n        }\r\n        if (!test || test(node)) {\r\n          res.push(getNodeKey(node));\r\n        }\r\n        return null;\r\n      })\r\n      : [];\r\n\r\n  recursive(tree);\r\n\r\n  return res;\r\n}\r\n\r\nconst getFilteredTree = (tree, childrenKey, labelKey, searchText, defaultLanguage, languages, isLabelNotMultilingual) => {\r\n\r\n  const filterNode = node => {\r\n    const search = searchText.toLowerCase();\r\n    return (\r\n      (node.id && node.id.toLowerCase().indexOf(search) >= 0) ||\r\n      (isLabelNotMultilingual && node[labelKey].toLowerCase().indexOf(search) >= 0) ||\r\n      (!isLabelNotMultilingual && localizeI18nObj(node[labelKey], defaultLanguage, languages).toLowerCase().indexOf(search) >= 0)\r\n    );\r\n  };\r\n\r\n  const recursive = subtree => subtree\r\n    ? ([\r\n      ...subtree\r\n        .map(node => ({...node}))\r\n        .filter(node => {\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            if (filterNode(node)) {\r\n              return true;\r\n            } else {\r\n              const filteredChildren = [...recursive(node[childrenKey], filterNode)];\r\n              if (filteredChildren.length) {\r\n                node[childrenKey] = filteredChildren;\r\n                return true;\r\n              } else {\r\n                return false;\r\n              }\r\n            }\r\n          } else {\r\n            return filterNode(node);\r\n          }\r\n        })\r\n    ])\r\n    : null;\r\n\r\n  return recursive(tree, filterNode);\r\n}\r\n\r\nconst handleHeight = (uuid, keys, withLevelSelector) => {\r\n\r\n  const actionHeight = $(`.enhanced-tree__${uuid} .enhanced-tree__actions`).css(\"height\");\r\n\r\n  let levelSelectorHeight = 0;\r\n  if (withLevelSelector) {\r\n    levelSelectorHeight = 32 + 16;\r\n    let found = false;\r\n    for (let i = 0; i < keys.length; i++) {\r\n      if (keys.find(key => key === TREE_NODE_KEY_OF_LEVEL_PREFIX + i) && !found) {\r\n        levelSelectorHeight += 32;\r\n      } else {\r\n        found = true\r\n      }\r\n    }\r\n  }\r\n\r\n  $(`.enhanced-tree__${uuid} .enhanced-tree__tree`).css(\"height\", `calc(100% - ${actionHeight} - ${levelSelectorHeight}px)`);\r\n}\r\n\r\nfunction EnhancedTree(props) {\r\n\r\n  const {\r\n    languages,\r\n    defaultLanguage,\r\n    classes,\r\n    tree,\r\n    getNodeKey,\r\n    childrenKey,\r\n    labelKey,\r\n    getNodeLabel,\r\n    checkable,\r\n    defaultExpandedKeys,\r\n    nodeActions,\r\n    withoutSearch,\r\n    withoutCheckControls,\r\n    withoutExpandControls,\r\n    withLevelSelector,\r\n    withoutPagination,\r\n    getIsCheckable,\r\n    isLabelNotMultilingual\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [searchText, setSearchText] = useState(\"\");\r\n\r\n  const [checkedKeys, setCheckedKeys] = useState(props.checkedKeys || []);\r\n  const [expandedKeys, setExpandedKeys] = useState(defaultExpandedKeys || []);\r\n  const [showMoreKeyClicks, setShowMoreKeyClicks] = useState({});\r\n\r\n  useEffect(() => {\r\n    handleHeight(uuid, [], withLevelSelector)\r\n  }, [uuid, withLevelSelector])\r\n\r\n  const handleCheck = (checkedNode, checked) => {\r\n\r\n    const newCheckedKeys = [...(props.checkedKeys || checkedKeys)];\r\n    checked\r\n      ? newCheckedKeys.push(getNodeKey(checkedNode))\r\n      : newCheckedKeys.splice((props.checkedKeys || checkedKeys).indexOf(getNodeKey(checkedNode)), 1);\r\n\r\n    setCheckedKeys(newCheckedKeys);\r\n    if (props.onCheck) {\r\n      props.onCheck(newCheckedKeys)\r\n    }\r\n  }\r\n\r\n  const handleLevelCheck = (checkedNode, checked) => {\r\n\r\n    const nodesAtDepth = getNodesAtDepth(filteredTree, childrenKey, checkedNode.level + 1)\r\n      .filter(node => getIsCheckable ? getIsCheckable(node) : true)\r\n      .map(node => getNodeKey(node));\r\n\r\n    let newCheckedKeys = [...(props.checkedKeys || checkedKeys)];\r\n    newCheckedKeys = checked\r\n      ? _.uniq(newCheckedKeys.concat(nodesAtDepth))\r\n      : newCheckedKeys.filter(key => !nodesAtDepth.includes(key));\r\n\r\n    setCheckedKeys(newCheckedKeys)\r\n    if (props.onCheck) {\r\n      props.onCheck(newCheckedKeys)\r\n    }\r\n  }\r\n\r\n  const handleExpand = expandedKeys => {\r\n    setExpandedKeys(expandedKeys);\r\n    if (props.onExpand) {\r\n      props.onExpand(expandedKeys)\r\n    }\r\n  }\r\n\r\n  const handleSearch = searchText => {\r\n    setSearchText(searchText)\r\n    setExpandedKeys((searchText && searchText.length > 0)\r\n      ? getKeys(filteredTree, childrenKey, getNodeKey)\r\n      : [] // TODO: quale dovrebbe essere il comportamento corretto?\r\n    )\r\n  }\r\n\r\n  const getShowMoreNode = parent => {\r\n\r\n    const key = `${parent ? getNodeKey(parent) : 'root'}`;\r\n\r\n    const remaining = (parent ? parent[childrenKey] : filteredTree.filter(node => node != null)).length - ((showMoreKeyClicks[key] || 0) + 1) * TREE_PAGE_SIZE;\r\n\r\n    return (\r\n      <TreeItem\r\n        key={`${key}_showMore`}\r\n        nodeId={`${key}_showMore`}\r\n        className={classes.showMoreNode}\r\n        label={\r\n          <i\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              setShowMoreKeyClicks({\r\n                ...showMoreKeyClicks,\r\n                [key]:\r\n                  showMoreKeyClicks[key]\r\n                    ? showMoreKeyClicks[key] + 1\r\n                    : 1\r\n              })\r\n            }}\r\n          >\r\n            {t(\"components.enhancedTree.showMore\", {more: Math.min(remaining, TREE_PAGE_SIZE), remaining: remaining})}\r\n          </i>\r\n        }\r\n      />\r\n    );\r\n  }\r\n\r\n  const getTreeNode = (node, getNodeKey, isLevelTree, checkable, checkedKeys, onCheck, getIsCheckable) => {\r\n\r\n    const actions = (nodeActions || [])\r\n      .filter(act => act)\r\n      .map(act => typeof (act) === \"function\" ? act(node) : act)\r\n      .filter(act => act);\r\n\r\n    return (\r\n      <TreeItem\r\n        key={getNodeKey(node)}\r\n        nodeId={getNodeKey(node)}\r\n        label={\r\n          <div className={classes.treeNode}>\r\n            {checkable && (\r\n              <Checkbox\r\n                className={classes.treeNodeCheckbox}\r\n                checked={!isLevelTree\r\n                  ? checkedKeys.includes(getNodeKey(node))\r\n                  : !getNodesAtDepth(filteredTree, childrenKey, node.level + 1).filter(node => getIsCheckable ? getIsCheckable(node) : true).map(node => getNodeKey(node)).some(val => checkedKeys.indexOf(val) === -1)}\r\n                onClick={event => {\r\n                  onCheck(node, event.target.checked);\r\n                  event.stopPropagation();\r\n                }}\r\n                disabled={getIsCheckable ? !getIsCheckable(node) : false}\r\n              />\r\n            )}\r\n            <div\r\n              className={`${classes.treeNodeLabel} ${isLevelTree ? classes.levelTreeNodeLabel : \"\"}`}\r\n            >\r\n              {(getNodeLabel && !isLevelTree)\r\n                ? getNodeLabel(node)\r\n                : isLabelNotMultilingual\r\n                  ? node[labelKey]\r\n                  : localizeI18nObj(node[labelKey], defaultLanguage, languages)\r\n              }\r\n            </div>\r\n            {!isLevelTree && (\r\n              <div className={classes.treeNodeAction}>\r\n                {actions\r\n                  .filter(action => (action !== null && action !== undefined))\r\n                  .map((action, idx) =>\r\n                    <Tooltip key={idx} title={action.title}>\r\n                      <IconButton\r\n                        onClick={event => {\r\n                          action.onClick(node);\r\n                          event.stopPropagation();\r\n                        }}\r\n                      >\r\n                        {action.icon}\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        }\r\n      >\r\n        {node[childrenKey]\r\n          ? node[childrenKey]\r\n            .filter((child, index) => withoutPagination || index < TREE_PAGE_SIZE * ((showMoreKeyClicks[getNodeKey(node)] || 0) + 1))\r\n            .map(child => getTreeNode(child, getNodeKey, isLevelTree, checkable, checkedKeys, onCheck, getIsCheckable))\r\n            .concat(!withoutPagination && node[childrenKey].length > TREE_PAGE_SIZE * ((showMoreKeyClicks[getNodeKey(node)] || 0) + 1)\r\n              ? [getShowMoreNode(node)]\r\n              : []\r\n            )\r\n          : null\r\n        }\r\n      </TreeItem>\r\n    )\r\n  };\r\n\r\n  const filteredTree = getFilteredTree(tree, childrenKey, labelKey, searchText, defaultLanguage, languages, isLabelNotMultilingual);\r\n\r\n  let levelTree = []\r\n  if (withLevelSelector) {\r\n    const maxTreeDepth = getMaxTreeDepth(filteredTree, childrenKey);\r\n    levelTree = [{\r\n      id: TREE_NODE_KEY_OF_LEVEL_PREFIX + 0,\r\n      [labelKey]: isLabelNotMultilingual\r\n        ? t(\"components.enhancedTree.levelSelector\", {level: 0})\r\n        : {\r\n          [defaultLanguage]: t(\"components.enhancedTree.levelSelector\", {level: 0})\r\n        },\r\n      level: 0,\r\n    }];\r\n    if (maxTreeDepth !== null && maxTreeDepth !== 0) {\r\n      [...Array(maxTreeDepth - 1)].forEach(() => {\r\n        let pointer = levelTree[0];\r\n        let counter = 0;\r\n        while (pointer[childrenKey]) {\r\n          pointer = pointer[childrenKey][0];\r\n          counter++;\r\n        }\r\n        pointer[childrenKey] = [\r\n          {\r\n            id: TREE_NODE_KEY_OF_LEVEL_PREFIX + Number(counter + 1),\r\n            [labelKey]: isLabelNotMultilingual\r\n              ? t(\"components.enhancedTree.levelSelector\", {level: counter + 1})\r\n              : {\r\n                [defaultLanguage]: t(\"components.enhancedTree.levelSelector\", {level: counter + 1})\r\n              },\r\n            level: counter + 1\r\n          }\r\n        ]\r\n      });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={`enhanced-tree enhanced-tree__${uuid} ${classes.root}`}>\r\n      <div className={`enhanced-tree__actions ${classes.treeActions}`}>\r\n        <Grid container justify=\"space-between\">\r\n          <Grid item xs={6}>\r\n            {!withoutCheckControls\r\n              ? (\r\n                <Fragment>\r\n                  <Tooltip title={t(\"components.enhancedTree.selectAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => {\r\n                        const newCheckedKeys = getKeys(filteredTree, childrenKey, getNodeKey, getIsCheckable);\r\n                        setCheckedKeys(newCheckedKeys)\r\n                        if (props.onCheck) {\r\n                          props.onCheck(newCheckedKeys)\r\n                        }\r\n                      }}\r\n                    >\r\n                      <LibraryAddCheckIcon/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                  <Tooltip title={t(\"components.enhancedTree.deselectAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => {\r\n                        setCheckedKeys([])\r\n                        if (props.onCheck) {\r\n                          props.onCheck([])\r\n                        }\r\n                      }}\r\n                    >\r\n                      <FilterNoneIcon style={{padding: 1}}/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                </Fragment>\r\n              )\r\n              : null\r\n            }\r\n            {!withoutExpandControls\r\n              ? (\r\n                <Fragment>\r\n                  <Tooltip title={t(\"components.enhancedTree.expandAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => handleExpand(getKeys(filteredTree, childrenKey, getNodeKey))}><HeightIcon/></IconButton>\r\n                  </Tooltip>\r\n                  <Tooltip title={t(\"components.enhancedTree.collapseAll.tooltip\")}>\r\n                    <IconButton onClick={() => handleExpand([])}><VerticalAlignCenterIcon/></IconButton>\r\n                  </Tooltip>\r\n                </Fragment>\r\n              )\r\n              : null\r\n            }\r\n          </Grid>\r\n          <Grid item xs={6} style={{padding: \"8px 0\"}}>\r\n            {!withoutSearch\r\n              ? (\r\n                <AutoSearchInput\r\n                  onSearch={handleSearch}\r\n                />\r\n              )\r\n              : null\r\n            }\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n      {withLevelSelector && getKeys(filteredTree, childrenKey, getNodeKey).length > 1 && (\r\n        <Fragment>\r\n          <TreeView\r\n            defaultCollapseIcon={<ExpandMoreIcon/>}\r\n            defaultExpandIcon={<ChevronRightIcon/>}\r\n            disableSelection\r\n            onNodeToggle={(ev, nodeIds) => handleHeight(uuid, nodeIds, withLevelSelector)}\r\n          >\r\n            {levelTree.map(node => getTreeNode(node, ({id}) => id, true, checkable, (props.checkedKeys || checkedKeys), handleLevelCheck, getIsCheckable))}\r\n          </TreeView>\r\n          <Divider className={classes.divider}/>\r\n        </Fragment>\r\n      )}\r\n      <div className={`enhanced-tree__tree ${classes.tree}`}>\r\n        {(filteredTree && filteredTree.length > 0)\r\n          ? (\r\n            <TreeView\r\n              defaultCollapseIcon={<ExpandMoreIcon/>}\r\n              defaultExpandIcon={<ChevronRightIcon/>}\r\n              disableSelection\r\n              expanded={expandedKeys}\r\n              onNodeToggle={(ev, nodeIds) => handleExpand(nodeIds)}\r\n            >\r\n              {filteredTree.map(node => getTreeNode(node, getNodeKey, false, checkable, (props.checkedKeys || checkedKeys), handleCheck, getIsCheckable))}\r\n            </TreeView>\r\n          )\r\n          : <CustomEmpty/>\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(EnhancedTree)","import React, {Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {DatePicker, MuiPickersUtilsProvider} from '@material-ui/pickers';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport moment from \"moment\";\r\nimport _ from \"lodash\"\r\nimport {FREQ_MONTHLY, FREQ_QUARTERLY, FREQ_SEMESTER} from \"../../state/dataset/datasetReducer\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  selectContainer: {\r\n    marginTop: 16\r\n  },\r\n  formControl: {\r\n    width: \"100%\"\r\n  },\r\n  timePeriodInput: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst periods = year => ({\r\n  [FREQ_SEMESTER]: {\r\n    values: [\"S1\", \"S2\"],\r\n    S1: {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    S2: {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  [FREQ_QUARTERLY]: {\r\n    values: [\"Q1\", \"Q2\", \"Q3\", \"Q4\"],\r\n    Q1: {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-03`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q2: {\r\n      start: `${year}-04-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q3: {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-09`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q4: {\r\n      start: `${year}-10-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  [FREQ_MONTHLY]: {\r\n    values: [\"01\", \"02\", \"03\", \"04\", \"05\", \"06\", \"07\", \"08\", \"09\", \"10\", \"11\", \"12\"],\r\n    \"01\": {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-01`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"02\": {\r\n      start: `${year}-02-01`,\r\n      end: moment(`${year}-02`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"03\": {\r\n      start: `${year}-03-01`,\r\n      end: moment(`${year}-03`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"04\": {\r\n      start: `${year}-04-01`,\r\n      end: moment(`${year}-04`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"05\": {\r\n      start: `${year}-05-01`,\r\n      end: moment(`${year}-05`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"06\": {\r\n      start: `${year}-06-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"07\": {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-07`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"08\": {\r\n      start: `${year}-08-01`,\r\n      end: moment(`${year}-08`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"09\": {\r\n      start: `${year}-09-01`,\r\n      end: moment(`${year}-09`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"10\": {\r\n      start: `${year}-10-01`,\r\n      end: moment(`${year}-10`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"11\": {\r\n      start: `${year}-11-01`,\r\n      end: moment(`${year}-11`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"12\": {\r\n      start: `${year}-12-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  }\r\n});\r\n\r\nconst getYearsArray = (startYear, endYear) => {\r\n  const res = [];\r\n\r\n  if (startYear && endYear) {\r\n    const startYearNumeric = Number(startYear);\r\n    const endYearNumeric = Number(endYear);\r\n\r\n    for (let i = startYearNumeric; i <= endYearNumeric; i++) {\r\n      res.push(i + \"\");\r\n    }\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nconst getPeriod = (freq, date) => {\r\n  if (freq && date) {\r\n    const year = date.slice(0, 4);\r\n\r\n    if (periods(year)[freq]) {\r\n      const dateMoment = moment(date, \"YYYY-MM-DD\");\r\n\r\n      return periods(year)[freq].values.find(period => {\r\n        const start = moment(periods(year)[freq][period].start, \"YYYY-MM-DD\");\r\n        const end = moment(periods(year)[freq][period].end, \"YYYY-MM-DD\");\r\n\r\n        return dateMoment.isBetween(start, end, null, \"[]\");\r\n      });\r\n    }\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nconst getNewFiltersFromYear = (date, year, minYear, maxYear, period, minPeriod, maxPeriod, timePeriod, filters, timePeriodKey, isFrom) => {\r\n  const newFilters = _.cloneDeep(filters);\r\n\r\n  let newDate;\r\n  if (isFrom) {\r\n    if (year === minYear && period && minPeriod) {\r\n      if (moment((year + period), \"YYYY-MM-DD\").isSameOrAfter(moment(timePeriod.minDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].start;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][minPeriod].start;\r\n      }\r\n\r\n    } else if (year === maxYear && period && maxPeriod) {\r\n      if (moment((year + period), \"YYYY-MM-DD\").isSameOrBefore(moment(timePeriod.maxDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].start;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][maxPeriod].start;\r\n      }\r\n\r\n    } else {\r\n      newDate = period\r\n        ? periods(year)[timePeriod.freq][period].start\r\n        : year + \"-01-01\";\r\n    }\r\n\r\n  } else {\r\n    if (year === minYear && period && minPeriod) {\r\n      if (period && moment((year + period), \"YYYY-MM-DD\").isSameOrAfter(moment(timePeriod.minDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].end;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][minPeriod].end;\r\n      }\r\n\r\n    } else if (year === maxYear && period && maxPeriod) {\r\n      if (period && moment((year + period), \"YYYY-MM-DD\").isSameOrBefore(moment(timePeriod.maxDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].end;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][maxPeriod].end;\r\n      }\r\n\r\n    } else {\r\n      newDate = period\r\n        ? periods(year)[timePeriod.freq][period].end\r\n        : year + \"-12-31\";\r\n    }\r\n  }\r\n\r\n  if (isFrom) {\r\n    newFilters[timePeriodKey] = [newDate, timePeriod.toDate];\r\n  } else {\r\n    newFilters[timePeriodKey] = [timePeriod.fromDate, newDate];\r\n  }\r\n\r\n  return newFilters;\r\n};\r\n\r\nconst handleSetFilters = (newFilters, timePeriodKey, onSetFilters, setCriteriaValidity) => {\r\n  onSetFilters(newFilters);\r\n  setCriteriaValidity(moment(newFilters[timePeriodKey][0], \"YYYY-MM-DD\").isSameOrBefore(moment(newFilters[timePeriodKey][1], \"YYYY-MM-DD\")));\r\n};\r\n\r\nconst TimePeriod = ({\r\n                      t,\r\n                      classes,\r\n                      timePeriod,\r\n                      timePeriodKey,\r\n                      filters,\r\n                      onSetFilters,\r\n                      isCriteriaValid,\r\n                      setCriteriaValidity\r\n                    }) => {\r\n\r\n  const minYear = timePeriod.minDate ? moment(timePeriod.minDate).format(\"YYYY\") : null;\r\n  const maxYear = timePeriod.maxDate ? moment(timePeriod.maxDate).format(\"YYYY\") : null;\r\n  const fromYear = timePeriod.fromDate ? moment(timePeriod.fromDate).format(\"YYYY\") : null;\r\n  const toYear = timePeriod.toDate ? moment(timePeriod.toDate).format(\"YYYY\") : null;\r\n\r\n  const minPeriod = getPeriod(timePeriod.freq, timePeriod.minDate);\r\n  const maxPeriod = getPeriod(timePeriod.freq, timePeriod.maxDate);\r\n  const fromPeriod = getPeriod(timePeriod.freq, timePeriod.fromDate);\r\n  const toPeriod = getPeriod(timePeriod.freq, timePeriod.toDate);\r\n\r\n  const fromPeriods = periods(fromYear)[timePeriod.freq]\r\n    ? periods(fromYear)[timePeriod.freq].values.slice(\r\n      fromYear === minYear ? periods(fromYear)[timePeriod.freq].values.indexOf(minPeriod) : 0,\r\n      fromYear === maxYear ? periods(fromYear)[timePeriod.freq].values.indexOf(maxPeriod) + 1 : undefined\r\n    )\r\n    : []\r\n  const toPeriods = periods(toYear)[timePeriod.freq]\r\n    ? periods(toYear)[timePeriod.freq].values.slice(\r\n      toYear === minYear ? periods(toYear)[timePeriod.freq].values.indexOf(minPeriod) : 0,\r\n      toYear === maxYear ? periods(toYear)[timePeriod.freq].values.indexOf(maxPeriod) + 1 : undefined\r\n    )\r\n    : []\r\n\r\n  return timePeriod.freq !== null\r\n    ? (\r\n      <Fragment>\r\n        <Grid container spacing={2} className={classes.selectContainer}>\r\n          {!isCriteriaValid && (\r\n            <Grid item xs={12}>\r\n              <Alert severity=\"warning\">{t(\"components.criteria.timePeriod.alert.notValidRange\")}</Alert>\r\n            </Grid>\r\n          )}\r\n          <Grid item xs={12}>\r\n            {t(\"components.criteria.timePeriod.start\")}\r\n          </Grid>\r\n          <Grid item xs={periods(fromYear)[timePeriod.freq] !== undefined ? 6 : 12}>\r\n            {fromYear && minYear && toYear && (\r\n              <FormControl className={classes.formControl}>\r\n                <InputLabel>{t(\"components.criteria.timePeriod.year\")}</InputLabel>\r\n                <Select\r\n                  value={fromYear}\r\n                  onChange={ev => {\r\n                    const year = ev.target.value;\r\n                    const newFilters = getNewFiltersFromYear(timePeriod.fromDate, year, minYear, maxYear, fromPeriod, minPeriod, maxPeriod, timePeriod, filters, timePeriodKey, true);\r\n                    handleSetFilters(newFilters, timePeriodKey, onSetFilters, setCriteriaValidity);\r\n                  }}\r\n                >\r\n                  {getYearsArray(minYear, maxYear).map((year, idx) => (\r\n                    <MenuItem key={idx} value={year}>{year}</MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            )}\r\n          </Grid>\r\n          {fromYear && periods(fromYear)[timePeriod.freq] !== undefined && fromPeriods && fromPeriod && (\r\n            <Grid item xs={6}>\r\n              <FormControl className={classes.formControl}>\r\n                <InputLabel>{t(\"components.criteria.timePeriod.period\")}</InputLabel>\r\n                <Select\r\n                  value={fromPeriod}\r\n                  onChange={ev => {\r\n                    const period = ev.target.value;\r\n                    const newFilters = _.cloneDeep(filters);\r\n                    newFilters[timePeriodKey] = [periods(fromYear)[timePeriod.freq][period].start, timePeriod.toDate];\r\n                    handleSetFilters(newFilters, timePeriodKey, onSetFilters, setCriteriaValidity);\r\n                  }}\r\n                >\r\n                  {fromPeriods.map((period, idx) => (\r\n                    <MenuItem key={idx} value={period}>{period}</MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n          )}\r\n        </Grid>\r\n        <Grid container spacing={2} className={classes.selectContainer}>\r\n          <Grid item xs={12}>\r\n            {t(\"components.criteria.timePeriod.end\")}\r\n          </Grid>\r\n          <Grid item xs={periods(toYear)[timePeriod.freq] !== undefined ? 6 : 12}>\r\n            {toYear && fromYear && maxYear && (\r\n              <FormControl className={classes.formControl}>\r\n                <InputLabel>{t(\"components.criteria.timePeriod.year\")}</InputLabel>\r\n                <Select\r\n                  value={toYear}\r\n                  onChange={ev => {\r\n                    const year = ev.target.value;\r\n                    const newFilters = getNewFiltersFromYear(timePeriod.toDate, year, minYear, maxYear, toPeriod, minPeriod, maxPeriod, timePeriod, filters, timePeriodKey, false);\r\n                    handleSetFilters(newFilters, timePeriodKey, onSetFilters, setCriteriaValidity);\r\n                  }}\r\n                >\r\n                  {getYearsArray(minYear, maxYear).map((year, idx) => (\r\n                    <MenuItem key={idx} value={year}>{year}</MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            )}\r\n          </Grid>\r\n          {toYear && periods(toYear)[timePeriod.freq] !== undefined && toPeriods && toPeriod && (\r\n            <Grid item xs={6}>\r\n              <FormControl className={classes.formControl}>\r\n                <InputLabel>{t(\"components.criteria.timePeriod.period\")}</InputLabel>\r\n                <Select\r\n                  value={toPeriods.includes(toPeriod) ? toPeriod : toPeriods[toPeriods.length - 1]}\r\n                  onChange={ev => {\r\n                    const period = ev.target.value;\r\n                    const newFilters = _.cloneDeep(filters);\r\n                    newFilters[timePeriodKey] = [timePeriod.fromDate, periods(toYear)[timePeriod.freq][period].end];\r\n                    handleSetFilters(newFilters, timePeriodKey, onSetFilters, setCriteriaValidity);\r\n                  }}\r\n                >\r\n                  {toPeriods.map((period, idx) => (\r\n                    <MenuItem key={idx} value={period}>{period}</MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n          )}\r\n        </Grid>\r\n      </Fragment>\r\n    )\r\n    : (\r\n      <Grid container spacing={3}>\r\n        <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n          <Grid item xs={6}>\r\n            <DatePicker\r\n              openTo=\"year\"\r\n              format=\"yyyy-MM-dd\"\r\n              label={t(\"components.criteria.timePeriod.from\")}\r\n              views={[\"year\", \"month\", \"date\"]}\r\n              clearable\r\n              minDate={moment(timePeriod.minDate)}\r\n              maxDate={moment(timePeriod.toDate)}\r\n              value={moment(timePeriod.fromDate)}\r\n              onChange={date => {\r\n                const newFilters = _.cloneDeep(filters);\r\n                newFilters[timePeriodKey] = [date ? moment(date).format(\"YYYY-MM-DD\") : timePeriod.minDate, timePeriod.toDate];\r\n                onSetFilters(newFilters)\r\n              }}\r\n              className={classes.timePeriodInput}\r\n            />\r\n          </Grid>\r\n          <Grid item xs={6}>\r\n            <DatePicker\r\n              openTo=\"year\"\r\n              format=\"yyyy-MM-dd\"\r\n              label={t(\"components.criteria.timePeriod.to\")}\r\n              views={[\"year\", \"month\", \"date\"]}\r\n              clearable\r\n              minDate={moment(timePeriod.fromDate)}\r\n              maxDate={moment(timePeriod.maxDate)}\r\n              value={moment(timePeriod.toDate)}\r\n              onChange={date => {\r\n                const newFilters = _.cloneDeep(filters);\r\n                newFilters[timePeriodKey] = [timePeriod.fromDate, date ? moment(date).format(\"YYYY-MM-DD\") : timePeriod.maxDate];\r\n                onSetFilters(newFilters)\r\n              }}\r\n              className={classes.timePeriodInput}\r\n            />\r\n          </Grid>\r\n        </MuiPickersUtilsProvider>\r\n      </Grid>\r\n    )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(TimePeriod)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Call from \"../../hocs/call\";\r\nimport {\r\n  CRITERIA_SELECTION_MODE_ALL,\r\n  CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n  CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n  fetchDatasetStructureCodelist,\r\n  fetchDatasetStructureCodelists,\r\n  setDatasetStructureCodelistFilters\r\n} from \"../../state/dataset/datasetActions\";\r\nimport EnhancedTree from \"../enhanced-tree\";\r\nimport _ from \"lodash\"\r\nimport PlaylistAddCheckIcon from \"@material-ui/icons/PlaylistAddCheck\"\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport TimePeriod from \"./TimePeriod\";\r\nimport Typography from '@material-ui/core/Typography';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {TIME_PERIOD_KEY} from \"../../utils/jsonStat\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport CustomEmpty from \"../custom-empty\";\r\n\r\nconst CRITERIA_CONTAINER_HEIGHT = 380;\r\nconst CODELIST_INFO_HEIGHT = 40;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  criteriaContainer: {\r\n    width: \"100%\",\r\n    height: CRITERIA_CONTAINER_HEIGHT,\r\n    padding: 8\r\n  },\r\n  codelistInfo: {\r\n    width: \"100%\",\r\n    height: CODELIST_INFO_HEIGHT,\r\n    padding: \"8px 0\"\r\n  },\r\n  codelistContainer: {\r\n    width: \"100%\",\r\n    height: `calc(100% - ${CODELIST_INFO_HEIGHT}px)`,\r\n  },\r\n  emptyContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  timePeriodContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    paddingTop: 24\r\n  },\r\n  treeActions: {\r\n    marginBottom: 8\r\n  },\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  structure: state.dataset.structure\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchCodelist: ({nodeId, datasetId, dimensionId, type, filters}) => dispatch(fetchDatasetStructureCodelist(nodeId, datasetId, dimensionId, type, filters)),\r\n  fetchCodelists: ({nodeId, datasetId, type}) => dispatch(fetchDatasetStructureCodelists(nodeId, datasetId, type)),\r\n  onSetFilters: filters => dispatch(setDatasetStructureCodelistFilters(filters))\r\n});\r\n\r\nfunction Criteria(props) {\r\n  const {\r\n    t,\r\n    classes,\r\n    nodeId,\r\n    datasetId,\r\n    dimensions,\r\n    mode,\r\n    type,\r\n    codes,\r\n    isCodesFlat,\r\n    codelists,\r\n    areCodelistsFlat,\r\n    codelistsLength,\r\n    filters,\r\n    timePeriod,\r\n    fetchCodelist,\r\n    fetchCodelists,\r\n    onSetFilters,\r\n    isCriteriaValid,\r\n    setCriteriaValidity\r\n  } = props;\r\n\r\n  const [tabId, setTabId] = useState(0);\r\n  const [isCallDisabled, setIsCallDisabled] = useState(false);\r\n\r\n  const [tmpFilters, setTmpFilters] = useState(null);\r\n  const [tmpTabId, setTmpTabId] = useState(null);\r\n\r\n  const handleTabChange = tabId => {\r\n\r\n    if (type === CRITERIA_SELECTION_TYPE_DYNAMIC && tabId < (dimensions.length - 1)) {\r\n      const filtersToRemove = [];\r\n      const newFilters = _.cloneDeep(filters);\r\n\r\n      for (let i = tabId + 1; i < dimensions.length; i++) {\r\n        if (filters[dimensions[i].id] !== null && filters[dimensions[i].id] !== undefined && filters[dimensions[i].id] !== []) {\r\n          filtersToRemove.push(dimensions[i].id)\r\n        }\r\n      }\r\n\r\n      if (filtersToRemove.length > 0) {\r\n        filtersToRemove.forEach(dim => newFilters[dim] = undefined);\r\n        setTmpFilters(newFilters);\r\n        setTmpTabId(tabId);\r\n\r\n      } else {\r\n        setTabId(tabId);\r\n        setIsCallDisabled(false);\r\n      }\r\n\r\n    } else {\r\n      setTabId(tabId);\r\n      setIsCallDisabled(false);\r\n    }\r\n  };\r\n\r\n  const handleCheck = checkedKeys => {\r\n    const newFilters = _.cloneDeep(filters);\r\n\r\n    newFilters[dimensions[tabId].id] = (checkedKeys.length === 1 && checkedKeys[0] === \"\") ? undefined : checkedKeys;\r\n    onSetFilters(newFilters);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (dimensions && isCallDisabled === false) {\r\n      setIsCallDisabled(true)\r\n    }\r\n  }, [dimensions, isCallDisabled]);\r\n\r\n  const checkedKeys = (filters[dimensions[tabId].id] || []);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {dimensions && (\r\n        <Fragment>\r\n          <AppBar position=\"static\" color=\"default\">\r\n            <Tabs\r\n              value={tabId}\r\n              variant=\"scrollable\"\r\n              scrollButtons=\"auto\"\r\n              indicatorColor=\"primary\"\r\n              textColor=\"primary\"\r\n              onChange={(event, newValue) => handleTabChange(newValue)}\r\n            >\r\n              {(dimensions || []).map((dim, idx) => (\r\n                <Tab\r\n                  key={idx}\r\n                  label={\r\n                    <Tooltip title={dim.label || \"\"}>\r\n                      <span>\r\n                        {dim.id + (\r\n                          codelistsLength[idx]\r\n                            ? ` (${(filters && filters[dim.id]) ? filters[dim.id].length : 0}/${codelistsLength[idx]})`\r\n                            : '')\r\n                        }\r\n                      </span>\r\n                    </Tooltip>\r\n                  }\r\n                  disabled={!isCriteriaValid}\r\n                />\r\n              ))}\r\n            </Tabs>\r\n          </AppBar>\r\n          <div key={tabId} className={classes.criteriaContainer}>\r\n            <Call\r\n              cb={mode === CRITERIA_SELECTION_MODE_STEP_BY_STEP\r\n                ? fetchCodelist\r\n                : fetchCodelists\r\n              }\r\n              cbParam={{\r\n                nodeId,\r\n                datasetId,\r\n                dimensionId: dimensions[tabId].id,\r\n                mode,\r\n                type,\r\n                filters\r\n              }}\r\n              disabled={!nodeId || !datasetId || !dimensions || (mode === CRITERIA_SELECTION_MODE_ALL && !!codelists) || isCallDisabled}\r\n            >\r\n              {(() => {\r\n                const data = mode === CRITERIA_SELECTION_MODE_STEP_BY_STEP\r\n                  ? codes\r\n                  : codelists?.[tabId];\r\n\r\n                if (!data) {\r\n                  return (\r\n                    <div className={classes.emptyContainer}>\r\n                      <CustomEmpty/>\r\n                    </div>\r\n                  )\r\n\r\n                } else if (dimensions[tabId].id === TIME_PERIOD_KEY) {\r\n                  return (\r\n                    <div className={classes.timePeriodContainer}>\r\n                      <TimePeriod\r\n                        timePeriod={timePeriod}\r\n                        timePeriodKey={TIME_PERIOD_KEY}\r\n                        filters={filters}\r\n                        onSetFilters={onSetFilters}\r\n                        isCriteriaValid={isCriteriaValid}\r\n                        setCriteriaValidity={setCriteriaValidity}\r\n                      />\r\n                    </div>\r\n                  )\r\n\r\n                } else {\r\n                  return (\r\n                    <Fragment>\r\n                      <Typography className={classes.codelistInfo}>\r\n                        {`${dimensions[tabId].label || dimensions[tabId].id}${dimensions[tabId]?.extra?.DataStructureRef ? ` (${dimensions[tabId].extra.DataStructureRef})` : \"\"}`}\r\n                      </Typography>\r\n                      <div className={classes.codelistContainer}>\r\n                        {(data.length === 0)\r\n                          ? (\r\n                            <Fragment>\r\n                              <div style={{margin: \"16px 0\"}}>\r\n                                {t(\"components.criteria.noCodelistAssociated.info\")}\r\n                              </div>\r\n                              <TextField\r\n                                value={checkedKeys[0] || \"\"}\r\n                                placeholder={t(\"components.criteria.noCodelistAssociated.noFilter\")}\r\n                                variant=\"outlined\"\r\n                                style={{width: \"100%\"}}\r\n                                onChange={({target}) => handleCheck([target.value])}\r\n                              />\r\n                            </Fragment>\r\n                          )\r\n                          : (isCodesFlat === true || areCodelistsFlat?.[tabId] === true)\r\n                            ? (\r\n                              <InfiniteScrollTable\r\n                                data={data}\r\n                                getRowKey={({id}) => id}\r\n                                columns={[\r\n                                  {\r\n                                    title: t(\"components.criteria.table.columns.name.title\"),\r\n                                    dataIndex: 'name',\r\n                                    render: (_, {id, name}) => `[${id}] ${name}`,\r\n                                    minWidthToContent: true,\r\n                                    noFilter: true\r\n                                  }\r\n                                ]}\r\n                                rowSelection={{\r\n                                  selectedRowKeys: checkedKeys,\r\n                                  onChange: handleCheck,\r\n                                }}\r\n                                height={204}\r\n                              />\r\n                            )\r\n                            : (\r\n                              <EnhancedTree\r\n                                key={tabId}\r\n                                tree={data}\r\n                                getNodeKey={({id}) => id}\r\n                                childrenKey=\"children\"\r\n                                labelKey=\"name\"\r\n                                getNodeLabel={node => `[${node.id}] ${node.name}`}\r\n                                isLabelNotMultilingual\r\n                                checkable\r\n                                withLevelSelector\r\n                                checkedKeys={checkedKeys}\r\n                                getIsCheckable={node => node.isSelectable !== false}\r\n                                // defaultExpandedKeys={filters[dimensions[tabId].id] || []}\r\n                                onCheck={handleCheck}\r\n                                nodeActions={[\r\n                                  node => (node.children && node.children.length > 0)\r\n                                    ? {\r\n                                      icon: <PlaylistAddCheckIcon/>,\r\n                                      title: t(\"components.criteria.tree.nodeActions.selectAll.title\"),\r\n                                      onClick: node => {\r\n                                        let newCheckedKeys = [...checkedKeys];\r\n                                        const childrenKeys = (node.children || []).filter(({isSelectable}) => isSelectable !== false).map(({id}) => id)\r\n                                        const unselectedChildrenKeys = childrenKeys.filter(key => !newCheckedKeys.includes(key))\r\n\r\n                                        newCheckedKeys = (unselectedChildrenKeys.length > 0)\r\n                                          ? newCheckedKeys.concat(childrenKeys)\r\n                                          : newCheckedKeys.filter(key => !childrenKeys.includes(key));\r\n                                        handleCheck(_.uniq(newCheckedKeys));\r\n                                      }\r\n                                    }\r\n                                    : null\r\n                                ]}\r\n                              />\r\n                            )\r\n                        }\r\n                      </div>\r\n                    </Fragment>\r\n                  )\r\n                }\r\n              })()}\r\n            </Call>\r\n          </div>\r\n\r\n          <Dialog\r\n            open={tmpFilters !== null}\r\n            fullWidth\r\n            maxWidth=\"sm\"\r\n            onClose={() => setTmpFilters(null)}\r\n          >\r\n            <DialogContent>\r\n              {t(\"components.criteria.dialogs.warning.losingFilters.title\")}\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button\r\n                onClick={() => {\r\n                  setTmpFilters(null);\r\n                  setTmpTabId(null);\r\n                }}\r\n              >\r\n                cancel\r\n              </Button>\r\n              <Button\r\n                autoFocus\r\n                onClick={() => {\r\n                  setTmpFilters(null);\r\n                  onSetFilters(tmpFilters);\r\n                  setTmpTabId(null);\r\n                  setTabId(tmpTabId);\r\n                  setIsCallDisabled(false);\r\n                }}\r\n                color=\"primary\"\r\n              >\r\n                ok\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n\r\n        </Fragment>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(Criteria)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport ViewCompactIcon from '@material-ui/icons/ViewCompact';\r\nimport ViewStreamIcon from '@material-ui/icons/ViewStream';\r\nimport ViewColumnIcon from '@material-ui/icons/ViewColumn';\r\nimport JsonStatTable from \"../table\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sectionContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(60% - 8px)\",\r\n    marginRight: 16\r\n  },\r\n  section: {\r\n    height: 216,\r\n    background: \"#eeeeee\"\r\n  },\r\n  sectionHeaderContainer: {\r\n    height: 48,\r\n    padding: \"16px 16px 0\"\r\n  },\r\n  sectionHeaderIcon: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginRight: 8\r\n  },\r\n  sectionHeaderTitle: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    height: 30,\r\n  },\r\n  sectionContentWrapper: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 48px)\",\r\n    padding: 16\r\n  },\r\n  draggingHover: {\r\n    border: \"1px dashed #999999\"\r\n  },\r\n  sectionContent: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\"\r\n  },\r\n  sectionItem: {\r\n    textAlign: \"center\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px\"\r\n  },\r\n  previewContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(40% - 8px)\"\r\n  },\r\n  divider: {\r\n    marginBottom: 16\r\n  }\r\n});\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n  userSelect: 'none',\r\n  height: 32,\r\n  marginBottom: 8,\r\n  ...draggableStyle\r\n});\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const [removed] = list.splice(startIndex, 1);\r\n  list.splice(endIndex, 0, removed);\r\n};\r\n\r\nconst move = (source, destination, droppableSource, droppableDestination) => {\r\n  const [removed] = source.splice(droppableSource.index, 1);\r\n  destination.splice(droppableDestination.index, 0, removed);\r\n};\r\n\r\nconst onDragEnd = (result, dimensions, setDimensions) => {\r\n\r\n  const {\r\n    source,\r\n    destination\r\n  } = result;\r\n\r\n  // dropped outside the list\r\n  if (!destination) {\r\n    return;\r\n  }\r\n\r\n  const newDimensions = JSON.parse(JSON.stringify(dimensions));\r\n\r\n  if (source.droppableId === destination.droppableId) {\r\n    reorder(\r\n      newDimensions[source.droppableId],\r\n      source.index,\r\n      destination.index\r\n    );\r\n\r\n  } else {\r\n    move(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source,\r\n      destination\r\n    );\r\n  }\r\n\r\n  setDimensions(newDimensions);\r\n};\r\n\r\nconst Section = ({\r\n                   classes,\r\n                   id,\r\n                   title,\r\n                   Icon,\r\n                   dimensions,\r\n                   jsonStat\r\n                 }) =>\r\n\r\n  <Card variant=\"outlined\" className={classes.section}>\r\n    <CardHeader\r\n      title={\r\n        <Fragment>\r\n          <div className={classes.sectionHeaderIcon}>{Icon}</div>\r\n          <Typography className={classes.sectionHeaderTitle} variant=\"button\">{title}</Typography>\r\n        </Fragment>\r\n      }\r\n      className={classes.sectionHeaderContainer}\r\n    />\r\n    <Droppable droppableId={id}>\r\n      {(provided, snapshot) => (\r\n        <div className={`${classes.sectionContentWrapper} ${snapshot.isDraggingOver ? classes.draggingHover : \"\"}`}>\r\n          <div ref={provided.innerRef} className={classes.sectionContent}>\r\n            {dimensions.map((item, idx) =>\r\n              <Draggable\r\n                key={idx}\r\n                index={idx}\r\n                draggableId={`${id}-${idx}`}\r\n              >\r\n                {(provided, snapshot) => (\r\n                  <div\r\n                    ref={provided.innerRef}\r\n                    {...provided.draggableProps}\r\n                    {...provided.dragHandleProps}\r\n                    style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\r\n                  >\r\n                    <Tooltip title={jsonStat.dimension[item].label}>\r\n                      <Paper className={classes.sectionItem}>\r\n                        {`${item} (${jsonStat.size[jsonStat.id.indexOf(item)]})`}\r\n                      </Paper>\r\n                    </Tooltip>\r\n                  </div>\r\n                )}\r\n              </Draggable>\r\n            )}\r\n            {provided.placeholder}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  </Card>;\r\n\r\nconst TableLayout = ({\r\n                       t,\r\n                       classes,\r\n                       jsonStat,\r\n                       layout,\r\n                       labelFormat,\r\n                       setLayout\r\n                     }) => {\r\n  const {\r\n    filters,\r\n    sections,\r\n    rows,\r\n    cols,\r\n  } = layout;\r\n\r\n  let colCount = 1;\r\n  cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  let rowCount = 1;\r\n  rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n  sections.forEach(section => rowCount *= jsonStat.size[jsonStat.id.indexOf(section)]);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider className={classes.divider}/>\r\n      <div className={classes.sectionContainer}>\r\n        <DragDropContext onDragEnd={result => onDragEnd(result, layout, setLayout)}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"filters\"\r\n                title={t(\"components.tableLayout.sections.filters\")}\r\n                Icon={<FilterListIcon/>}\r\n                dimensions={filters}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"sections\"\r\n                title={t(\"components.tableLayout.sections.sections\")}\r\n                Icon={<ViewCompactIcon/>}\r\n                dimensions={sections}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"rows\"\r\n                title={t(\"components.tableLayout.sections.rows\")}\r\n                Icon={<ViewStreamIcon/>}\r\n                dimensions={rows}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"cols\"\r\n                title={t(\"components.tableLayout.sections.columns\")}\r\n                Icon={<ViewColumnIcon/>}\r\n                dimensions={cols}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n        </DragDropContext>\r\n      </div>\r\n      <div className={`${classes.previewContainer}`}>\r\n        <JsonStatTable\r\n          jsonStat={jsonStat}\r\n          layout={layout}\r\n          labelFormat={labelFormat}\r\n          isPreview={true}\r\n        />\r\n        <Grid container spacing={1} style={{marginTop: 16}}>\r\n          <Grid item xs={12} style={{textAlign: \"end\"}}>\r\n            {t(\"components.tableLayout.rowCount\", {rowCount})}\r\n          </Grid>\r\n          <Grid item xs={12} style={{textAlign: \"end\"}}>\r\n            {t(\"components.tableLayout.colCount\", {colCount})}\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(TableLayout)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\n\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_SM = \"sm\";\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_MD = \"md\";\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_LG = \"lg\";\r\n\r\nconst styles = theme => ({\r\n  fontSizeIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontWeight: \"bold\",\r\n    display: \"table\"\r\n  },\r\n  fontSizeIconSm: {\r\n    fontSize: 14\r\n  },\r\n  fontSizeIconMd: {\r\n    fontSize: 16\r\n  },\r\n  fontSizeIconLg: {\r\n    fontSize: 20\r\n  },\r\n  fontSizeSelected: {\r\n    \"& div\": {\r\n      boxShadow: \"inset 0 -2px 0 0 rgba(0, 0, 0, .54)\"\r\n    }\r\n  }\r\n});\r\n\r\nconst getFontSizeIcon = styleClasses =>\r\n  <div className={styleClasses}>\r\n    <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n      A\r\n    </div>\r\n  </div>;\r\n\r\nconst FontSizeSelector = ({\r\n  t,\r\n                            classes,\r\n                            fontSize,\r\n                            setFontSize\r\n                          }) =>\r\n\r\n  <Fragment>\r\n    <Tooltip title={t(\"components.fontSizeSelector.small.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_SM ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_SM)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconSm}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n    <Tooltip title={t(\"components.fontSizeSelector.normal.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_MD ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_MD)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconMd}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n    <Tooltip title={t(\"components.fontSizeSelector.big.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_LG ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_LG)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconLg}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n  </Fragment>;\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(FontSizeSelector)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport ViewCompactIcon from '@material-ui/icons/ViewCompact';\r\nimport ViewStreamIcon from '@material-ui/icons/ViewStream';\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sectionContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(60% - 8px)\",\r\n    marginRight: 16\r\n  },\r\n  section: {\r\n    background: \"#eeeeee\"\r\n  },\r\n  sectionLeft: {\r\n    height: 416\r\n  },\r\n  sectionRight: {\r\n    height: 200\r\n  },\r\n  sectionHeaderContainer: {\r\n    height: 48,\r\n    padding: \"16px 16px 0\"\r\n  },\r\n  sectionHeaderIcon: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginRight: 8\r\n  },\r\n  sectionHeaderTitle: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    height: 30,\r\n  },\r\n  sectionContentWrapper: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 48px)\",\r\n    padding: 16\r\n  },\r\n  draggingHover: {\r\n    border: \"1px dashed #999999\"\r\n  },\r\n  sectionContent: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\"\r\n  },\r\n  sectionItem: {\r\n    textAlign: \"center\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px\"\r\n  },\r\n  divider: {\r\n    marginBottom: 16\r\n  }\r\n});\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n  userSelect: 'none',\r\n  height: 32,\r\n  marginBottom: 8,\r\n  ...draggableStyle\r\n});\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const [removed] = list.splice(startIndex, 1);\r\n  list.splice(endIndex, 0, removed);\r\n};\r\n\r\nconst move = (source, destination, droppableSource, droppableDestination) => {\r\n  const [removed] = source.splice(droppableSource.index, 1);\r\n  destination.splice(droppableDestination.index, 0, removed);\r\n};\r\n\r\nconst swap = (sourceArr, destinationArr, droppableSource) => {\r\n  const [removedSrc] = sourceArr.splice(droppableSource.index, 1);\r\n  const [removedDst] = destinationArr.splice(0, 1, removedSrc);\r\n  sourceArr.splice(sourceArr.length, 0, removedDst);\r\n};\r\n\r\nconst onDragEnd = (result, dimensions, setDimensions) => {\r\n\r\n  const {\r\n    source,\r\n    destination\r\n  } = result;\r\n\r\n  // dropped outside the list\r\n  if (!destination) {\r\n    return;\r\n  }\r\n\r\n  const newDimensions = JSON.parse(JSON.stringify(dimensions));\r\n\r\n  if (source.droppableId === destination.droppableId) {\r\n    reorder(\r\n      newDimensions[source.droppableId],\r\n      source.index,\r\n      destination.index\r\n    );\r\n\r\n  } else if (\r\n    (source.droppableId === \"secondaryDim\" && destination.droppableId === \"filters\") ||\r\n    (source.droppableId === \"filters\" && destination.droppableId === \"secondaryDim\" && newDimensions[destination.droppableId].length === 0)\r\n  ) {\r\n    move(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source,\r\n      destination\r\n    );\r\n\r\n  } else {\r\n    swap(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source\r\n    );\r\n  }\r\n\r\n  setDimensions(newDimensions);\r\n};\r\n\r\nconst Section = ({\r\n                   classes,\r\n                   sectionClasses,\r\n                   id,\r\n                   title,\r\n                   Icon,\r\n                   dimensions,\r\n                   jsonStat\r\n                 }) =>\r\n\r\n  <Card variant=\"outlined\" className={`${classes.section} ${sectionClasses}`}>\r\n    <CardHeader\r\n      title={\r\n        <Fragment>\r\n          <div className={classes.sectionHeaderIcon}>{Icon}</div>\r\n          <Typography className={classes.sectionHeaderTitle} variant=\"button\">{title}</Typography>\r\n        </Fragment>\r\n      }\r\n      className={classes.sectionHeaderContainer}\r\n    />\r\n    <Droppable droppableId={id}>\r\n      {(provided, snapshot) => (\r\n        <div className={`${classes.sectionContentWrapper} ${snapshot.isDraggingOver ? classes.draggingHover : \"\"}`}>\r\n          <div ref={provided.innerRef} className={classes.sectionContent}>\r\n            {dimensions.map((item, idx) =>\r\n              <Draggable\r\n                key={idx}\r\n                index={idx}\r\n                draggableId={`${id}-${idx}`}\r\n                isDragDisabled={id === \"primaryDim\"}\r\n              >\r\n                {(provided, snapshot) => (\r\n                  <div\r\n                    ref={provided.innerRef}\r\n                    {...provided.draggableProps}\r\n                    {...provided.dragHandleProps}\r\n                    style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\r\n                  >\r\n                    <Paper\r\n                      className={classes.sectionItem}\r\n                    >\r\n                      {`${item} (${jsonStat.size[jsonStat.id.indexOf(item)]})`}\r\n                    </Paper>\r\n                  </div>\r\n                )}\r\n              </Draggable>\r\n            )}\r\n            {provided.placeholder}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  </Card>;\r\n\r\nconst ChartLayout = ({\r\n                       t,\r\n                       classes,\r\n                       jsonStat,\r\n                       layout,\r\n                       setLayout\r\n                     }) => {\r\n\r\n  const {\r\n    primaryDim,\r\n    secondaryDim,\r\n    filters\r\n  } = layout;\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider className={classes.divider}/>\r\n      <div className={classes.sectionContainer}>\r\n        <DragDropContext onDragEnd={result => onDragEnd(result, layout, setLayout)}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                sectionClasses={classes.sectionLeft}\r\n                id=\"filters\"\r\n                title={t(\"components.chartLayout.filters.title\")}\r\n                Icon={<FilterListIcon/>}\r\n                dimensions={filters}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Grid item xs={12} style={{paddingBottom: 8}}>\r\n                <Section\r\n                  classes={classes}\r\n                  sectionClasses={classes.sectionRight}\r\n                  id=\"primaryDim\"\r\n                  title={t(\"components.chartLayout.primaryDim.title\")}\r\n                  Icon={<ViewCompactIcon/>}\r\n                  dimensions={primaryDim}\r\n                  jsonStat={jsonStat}\r\n                />\r\n              </Grid>\r\n              <Grid item xs={12} style={{paddingTop: 8}}>\r\n                <Section\r\n                  classes={classes}\r\n                  sectionClasses={classes.sectionRight}\r\n                  id=\"secondaryDim\"\r\n                  title={t(\"components.chartLayout.secondaryDim.title\")}\r\n                  Icon={<ViewStreamIcon/>}\r\n                  dimensions={secondaryDim}\r\n                  jsonStat={jsonStat}\r\n                />\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        </DragDropContext>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ChartLayout)","import React, {useEffect, useState} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport \"./style.css\";\r\nimport WebFont from 'webfontloader';\r\nimport {numberFormatter} from \"../../utils/formatters\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport Call from \"../../hocs/call/index\";\r\nimport {\r\n  getDataIdxFromDimensionsArray,\r\n  getDimensionFiltersValue,\r\n  getDimensionValuesIndexesMap\r\n} from \"../../utils/jsonStat\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  markSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\n\r\nfunction Map(props) {\r\n  const {\r\n    mapId = `map__${uuidv4()}`,\r\n    mapLayout,\r\n    jsonStat,\r\n    onGeometryFetch,\r\n    geometries,\r\n    geometryDetailLevels,\r\n    hideSpinner,\r\n    addSpinner,\r\n    markSpinner\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [currentDetailLevel, setCurrentDetailLevel] = useState(-1);\r\n\r\n  const [filteredGeometries, setFilteredGeometries] = useState(null);\r\n\r\n  const [spinnerUuid] = useState(uuidv4());\r\n\r\n  // select default detail level\r\n  useEffect(() => {\r\n\r\n    if (!geometryDetailLevels) {\r\n      return;\r\n    }\r\n\r\n    if (geometryDetailLevels && geometryDetailLevels?.length > 0) {\r\n      const firstNotEmptyLevelIndex = geometryDetailLevels.findIndex(el => el);\r\n      setCurrentDetailLevel(geometryDetailLevels[firstNotEmptyLevelIndex].level);\r\n    }\r\n\r\n    return () => {\r\n      window.LMap.destroyMap(mapId)\r\n    }\r\n  }, [mapId, geometryDetailLevels]);\r\n\r\n\r\n  // init the map with filtered geometries\r\n  useEffect(() => {\r\n\r\n    if (!filteredGeometries || filteredGeometries.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const mapTranslations = {\r\n      configure: t(\"components.map.translation.configure\"),\r\n      opacity: t(\"components.map.translation.opacity\"),\r\n      from: t(\"components.map.translation.from\"),\r\n      to: t(\"components.map.translation.to\"),\r\n      cancel: t(\"components.map.translation.cancel\"),\r\n      apply: t(\"components.map.translation.apply\"),\r\n      classification: t(\"components.map.translation.classification\"),\r\n      equalInterval: t(\"components.map.translation.equalInterval\"),\r\n      naturalBreaks: t(\"components.map.translation.naturalBreaks\"),\r\n      quantile: t(\"components.map.translation.quantile\"),\r\n      numberOfClasses: t(\"components.map.translation.numberOfClasses\"),\r\n      startColor: t(\"components.map.translation.startColor\"),\r\n      endColor: t(\"components.map.translation.endColor\"),\r\n      preview: t(\"components.map.translation.preview\")\r\n    };\r\n\r\n    const isGeometryData = false;\r\n\r\n    if (!hideSpinner) {\r\n      addSpinner(spinnerUuid, t(\"components.map.spinners.rendering\"));\r\n    }\r\n\r\n    const layerOptions = {\r\n      srid: \"EPSG:4326\",\r\n      legendSettings: {\r\n        paletteStartColor: \"#eff3ff\",\r\n        paletteEndColor: \"#2171b5\",\r\n        paletteCardinality: 9,\r\n        pointStartRadius: 1,\r\n        pointEndRadius: 9,\r\n        pointRadiusCardinality: 9,\r\n        opacity: 0.9,\r\n        classificationMethod: \"quantile\"\r\n      },\r\n      onDataRender: function () {\r\n        markSpinner(spinnerUuid);\r\n      },\r\n      borderColor: [128, 128, 128, 0.5],\r\n      valueFormatter: numberFormatter,\r\n      centerMarker:\r\n        isGeometryData\r\n          ? \"data:image/png;base64,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\"\r\n          : undefined,\r\n      centerMarkerText: isGeometryData ? \"test\" : undefined,\r\n      selectedCenterMarker:\r\n        isGeometryData\r\n          ? \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADIklEQVR4AbXXA3hrWRQF4Ixt27Zt27atcGzbto3YeUZt2zbiNau+PVVO0uzv+9+r97o4UsVT6z7iUa1D66s9q26pc6+6td6lGpK0OuMF05BVaEs6jR6h949/1vzzdjrHz1tonJ+Qgc6hbbbUulbZUuuct8ZDdqCnKJsGCISTnjODAcCmY/yUTy/SzpurnSoGSbj5KZRGUYKSGECQTWdvrXcLIeSbVxIIkgFAdXQWDYWQDrAdrSCITnveiNPp1Bcs2NHgxKZqBzZ9ZMYg6bQjSV+9Tmx8Op1J93+1GD8vKcXiwkZYc5rwtqscZ7yzHFuy4ebTh3hi5H1wxRxgI1oqNj/nZQs+dxegsy8AsVp7/HjGWIRt9a7pQqTwEWxKMQc4mNonBXjehHctOQiEwpipBoNhqH/Pw2Zqhxigk46gmANcSMGJ5kZc+54LVS09mKsKG3tw4PMLGWJSgDBdIRPgZsKYU58z4pnfUxGKRDFXBcMR3PBVBjaZ+lLellCA9625iLV0f+YnHOBiCikDvPZvJqJRzFlR/tA9P+WIASJ0lUyAo6hbOe7v/GwhOvr8mKuau/048Y2l4ovYS8fLBNiGCgljznrJjH9TKjFXfbGoClvrXOLtL6MdZAKsSt8SlCPh6ndcWFbcNO2jiPCL1txm7P/sAnEEgH7iJLS6zDww9h74xSn4srcc+NJTgKL6TrT3+tHMCSi9uhPPmYqx11O+6eaAwNjz30rnkpqON6FFBGFCIiMuecOOGz704YTXFmO3J7zDjTcXr5xoOW1Oca2GNyknJNEJz5qwjVZoPFmY7qS4l+RNyJvAcrxEuPq47sJF1BtHgH66nMRVUDrEWvR1HAF+5G1fh+ZlT7gflUoEqKSDxKtPNMRd5I8hQJDu21ztEF+8hEOsSz/EEOB3Nt5A4sWTugt7Ud4sAYpof+Wkk4wQl1LXNAF66Gr5s4B8iNXoeQorAkTpVTZeXbz1yQqxMXfHfykCmGiz5DYXHsXZL5r2POFZc9b2ekfeZhrnvmye3AOqGGIXg1115NOWY3c12E/kIVV87smvTTRu1ca0yah4638QYUyY6yhczwAAAABJRU5ErkJggg==\"\r\n          : undefined\r\n    };\r\n\r\n    const mapOptions = {\r\n      baseMap: \"osm\",\r\n      baseMapToGray: true,\r\n      onLoadingStart: function () {\r\n        console.log(\"Map creation - start\");\r\n      },\r\n      onLoadingFinish: function () {\r\n        console.log(\"Map creation - done\");\r\n      },\r\n      legendFontFamily: \"Roboto\"\r\n    };\r\n\r\n    WebFont.load({\r\n      google: {\r\n        families: ['Roboto:300,400,500,700']\r\n      },\r\n      active: () => {\r\n        window.LMap.initMap(mapId, mapOptions, mapTranslations);\r\n        window.LMap.addLayer(mapId, filteredGeometries, \"Dataset\", layerOptions);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      window.LMap.destroyMap(mapId)\r\n    }\r\n  }, [mapId, filteredGeometries, spinnerUuid, hideSpinner, addSpinner, markSpinner, t]);\r\n\r\n\r\n  // check for missing geometry ids\r\n  useEffect(() => {\r\n    if (!geometries) {\r\n      return;\r\n    }\r\n    const geometryMap = {};\r\n    geometries.forEach(g => geometryMap[g.id] = g);\r\n\r\n    const missingGeometryList = [];\r\n    jsonStat.dimension[mapLayout.territoryDim].category.index.forEach(geomId => {\r\n      if (!geometryMap[geomId]) {\r\n        const missingEntry = {id: geomId, label: jsonStat.dimension[mapLayout.territoryDim].category.label[geomId]};\r\n        missingGeometryList.push(missingEntry);\r\n      }\r\n    });\r\n    console.log(\"missing ids\", missingGeometryList);\r\n  }, [jsonStat, geometries, mapLayout.territoryDim])\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    if (!geometries || !currentDetailLevel < 0) {\r\n      return;\r\n    }\r\n\r\n    const geometryMap = {};\r\n    geometries.forEach(g => geometryMap[g.id] = g);\r\n\r\n    const filters = [...mapLayout.filters];\r\n    const filtersValues = {...mapLayout.filtersValue};\r\n    const territoryDimName = mapLayout.territoryDim;\r\n    const dimensionFilterValues = getDimensionFiltersValue(jsonStat, mapLayout.territoryDim, filters, filtersValues);\r\n    const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n    const data = [];\r\n    var levelsCounter = {};\r\n    dimensionFilterValues.forEach(territoryDim => {\r\n      const dimValueArray = jsonStat.id.map(dim => {\r\n        if (dim === territoryDimName) {\r\n          return territoryDim.id;\r\n        } else {\r\n          return filtersValues[dim];\r\n        }\r\n      });\r\n      const valueIdx = getDataIdxFromDimensionsArray(\r\n        dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n        jsonStat.size\r\n      );\r\n      const valueId = jsonStat.value[valueIdx];\r\n      const geom = geometryMap[territoryDim.id];\r\n\r\n      if (valueId !== null && valueId !== undefined && geom && geom.nutsLevel === +currentDetailLevel) {\r\n        data.push({\r\n          \"value\": valueId,\r\n          \"identifier\": geom.uniqueId,\r\n          \"geometry\": geom.wkt,\r\n          \"label\": territoryDim.label\r\n        });\r\n      }\r\n      if (valueId && geom?.nutsLevel >= 0) {\r\n        if (!levelsCounter[geom.nutsLevel]) {\r\n          levelsCounter[geom.nutsLevel] = 0;\r\n        }\r\n        levelsCounter[geom.nutsLevel]++;\r\n      }\r\n    });\r\n\r\n    /*\r\n    // set the first not empty level\r\n    if(data.length === 0){\r\n      const firstNotEmpty = Object.entries(levelsCounter).filter((entry) => {return entry[1] > 1;});\r\n      if(firstNotEmpty?.length > 0){\r\n        setCurrentDetailLevel(firstNotEmpty[0][0]);\r\n        return;\r\n      }\r\n    }\r\n    */\r\n\r\n    setFilteredGeometries(data);\r\n\r\n  }, [geometries, mapLayout, currentDetailLevel, jsonStat])\r\n\r\n\r\n  return (\r\n    jsonStat.dimension[mapLayout.territoryDim]\r\n      ? (\r\n        <Call\r\n          cb={onGeometryFetch}\r\n          cbParam={[...jsonStat.dimension[mapLayout.territoryDim].category.index]}\r\n          disabled={geometries !== null && geometries !== undefined && geometryDetailLevels !== null && geometryDetailLevels !== undefined}\r\n        >\r\n          {geometryDetailLevels && geometryDetailLevels.length > 1 && (\r\n            <FormControl>\r\n              <InputLabel id=\"Map detail level label\">{t(\"components.map.detailLevel\")}</InputLabel>\r\n              <Select\r\n                value={currentDetailLevel}\r\n                onChange={(ev) => {\r\n                  setCurrentDetailLevel(ev.target.value)\r\n                }}\r\n              >\r\n                {geometryDetailLevels.map(val =>\r\n                  <MenuItem value={val.level} key={val.level}>{val.label}</MenuItem>\r\n                )}\r\n              </Select>\r\n            </FormControl>\r\n          )}\r\n          {currentDetailLevel > 0 && filteredGeometries && filteredGeometries.length === 0 && (\r\n            <span style={{textAlign: 'center', width: '100%'}}>\r\n              <h2>\r\n                {t(\"components.map.noDataToDisplayFor\")}\r\n                {\" \"}\r\n                {(geometryDetailLevels || []).filter(lev => lev.level === +currentDetailLevel).map(val =>\r\n                  <i key={\"span-i-\" + val.level}>{val.label}</i>\r\n                )}\r\n                .\r\n              </h2>\r\n            </span>\r\n          )}\r\n          <div id={mapId} style={{width: \"100%\", height: \"100%\"}}/>\r\n        </Call>\r\n      )\r\n      : <span style={{textAlign: 'center', width: '100%'}}><h2>{t(\"components.map.noTerritorialDim\")}</h2></span>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  connect(null, mapDispatchToProps)\r\n)(Map);\r\n","import React from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"./constants\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    margin: \"0 4px\"\r\n  },\r\n  label: {\r\n    color: \"rgba(0, 0, 0, 0.54)\",\r\n    fontSize: 13,\r\n    width: 80,\r\n    height: 40,\r\n    lineHeight: \"40px\",\r\n    marginRight: 8\r\n  },\r\n  formControl: {\r\n    margin: \"8px 0\"\r\n  },\r\n  select: {\r\n    width: 80,\r\n    \"& .MuiSelect-root.MuiSelect-select\": {\r\n      padding: \"2px 24px 3px 0\",\r\n      fontSize: 14\r\n    }\r\n  },\r\n  menuItem: {\r\n    fontSize: 14\r\n  }\r\n});\r\n\r\nconst LabelFormatSelector = ({\r\n                               t,\r\n                               classes,\r\n                               labelFormat,\r\n                               setLabelFormat\r\n                             }) =>\r\n  <Grid container className={classes.root}>\r\n    <Grid item className={classes.label}>\r\n      {t(\"components.labelFormatSelector.labelFormat.title\")}:\r\n    </Grid>\r\n    <Grid item>\r\n      <FormControl className={classes.formControl}>\r\n        <Select\r\n          className={classes.select}\r\n          value={(labelFormat || \"\")}\r\n          onChange={(ev) => setLabelFormat(ev.target.value)}\r\n        >\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.name\")}\r\n          </MenuItem>\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.id\")}\r\n          </MenuItem>\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.both\")}\r\n          </MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n    </Grid>\r\n  </Grid>\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(LabelFormatSelector)","import React, {Component, createRef, Fragment} from 'react';\r\nimport ChartJs from 'chart.js';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {getFormattedValue} from \"../../utils/formatters\";\r\nimport {\r\n  getDataIdxFromDimensionsArray,\r\n  getDimensionValueLabelFromJsonStat,\r\n  getDimensionValuesIndexesMap,\r\n  TIME_PERIOD_KEY\r\n} from \"../../utils/jsonStat\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport _ from \"lodash\";\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nconst colors = [\r\n  '#1E88E5',\r\n  '#C2185B',\r\n  '#FDD835',\r\n  '#0E9D59',\r\n  '#F06292',\r\n  '#FF7043',\r\n  '#8BC34A',\r\n  '#00BCD4',\r\n  '#EA3F4D',\r\n  '#AA47BC',\r\n  '#26A69A',\r\n  '#FF9800',\r\n];\r\n\r\nconst hexToRGBA = (hex, alpha) => {\r\n  const r = parseInt(hex.slice(1, 3), 16);\r\n  const g = parseInt(hex.slice(3, 5), 16);\r\n  const b = parseInt(hex.slice(5, 7), 16);\r\n\r\n  return \"rgba(\" + r + \", \" + g + \", \" + b + \", \" + alpha + \")\";\r\n};\r\n\r\nconst getChartType = type => {\r\n  switch (type) {\r\n    case \"area\":\r\n      return \"line\"\r\n    case \"pyramid\":\r\n      return \"horizontalBar\"\r\n    default:\r\n      return type\r\n  }\r\n};\r\n\r\nconst isBarOrLineGraph = type => (\r\n  type === \"bar\" ||\r\n  type === \"horizontalBar\" ||\r\n  type === \"line\" ||\r\n  type === \"area\" ||\r\n  type === \"pyramid\"\r\n);\r\n\r\nconst getOptions = (chartType, data, decimalSeparator, decimalPlaces) => {\r\n\r\n  let max = 0;\r\n  data.datasets.forEach(dataset => dataset.data.forEach(value => max = Math.max(max, Math.abs(value))));\r\n  max += Math.floor(max / 100 * 20);\r\n\r\n  return {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    scales: isBarOrLineGraph(chartType)\r\n      ? {\r\n        xAxes: [{\r\n          gridLines: {\r\n            display: chartType !== \"bar\"\r\n          },\r\n          ticks: {\r\n            beginAtZero: (chartType === \"horizontalBar\" || chartType === \"pyramid\"),\r\n            callback: value => {\r\n              if (chartType === \"horizontalBar\" || chartType === \"pyramid\") {\r\n                if (chartType === \"pyramid\" && data.datasets.length === 2 && value < 0) {\r\n                  return getFormattedValue(-value, decimalSeparator, decimalPlaces)\r\n                } else {\r\n                  return getFormattedValue(value, decimalSeparator, decimalPlaces)\r\n                }\r\n              } else {\r\n                return value\r\n              }\r\n            },\r\n            max: chartType === \"pyramid\" ? max : undefined,\r\n            min: chartType === \"pyramid\" ? -(max) : undefined,\r\n          },\r\n          stacked: chartType === \"pyramid\",\r\n        }],\r\n        yAxes: [{\r\n          gridLines: {\r\n            display: (chartType !== \"horizontalBar\" && chartType !== \"pyramid\")\r\n          },\r\n          ticks: {\r\n            beginAtZero: (chartType !== \"horizontalBar\" && chartType !== \"pyramid\"),\r\n            callback: value => (chartType !== \"horizontalBar\" && chartType !== \"pyramid\")\r\n              ? getFormattedValue(value, decimalSeparator, decimalPlaces)\r\n              : value\r\n          },\r\n          stacked: chartType === \"pyramid\"\r\n        }]\r\n      }\r\n      : {},\r\n    tooltips: {\r\n      enabled: true,\r\n      mode: \"index\",\r\n      callbacks: {\r\n        title: (tooltipItem, data) => (data.labels[tooltipItem[0].index] || ''),\r\n        label: (tooltipItem, data) => {\r\n          const getValue = () => {\r\n            let value = dataset.data[tooltipItem.index];\r\n            if (!value) {\r\n              return null;\r\n            }\r\n            value = getFormattedValue(value, decimalSeparator, decimalPlaces);\r\n            if (chartType === \"pyramid\" && data.datasets.length === 2 && tooltipItem.datasetIndex === 0 && value[0] === \"-\") {\r\n              return value.slice(1)\r\n            } else {\r\n              return value\r\n            }\r\n          };\r\n          const dataset = data.datasets[tooltipItem.datasetIndex];\r\n          const value = getValue();\r\n          return value ? `${dataset.label}: ${getValue()}` : null\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nconst getData = (chartType, jsonStat, layout, removeEmptyValues, labelFormat) => {\r\n\r\n  const {\r\n    primaryDim,\r\n    primaryDimValues,\r\n    secondaryDim,\r\n    secondaryDimValues,\r\n    filtersValue\r\n  } = layout;\r\n\r\n  const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n  const valorizedDataMap = {};\r\n  secondaryDimValues.forEach(secondaryDimValue => {\r\n    valorizedDataMap[secondaryDimValue] = new Array(primaryDimValues.length).fill(false);\r\n  });\r\n  const valorizedDataArr = new Array(primaryDimValues.length).fill(false);\r\n\r\n  const datasets = [];\r\n\r\n  if (secondaryDimValues && secondaryDimValues.length > 0) {\r\n    secondaryDimValues.forEach((secondaryDimValue, secDimIdx) => {\r\n      const data = [];\r\n      primaryDimValues.forEach((primaryDimValue, primDimIdx) => {\r\n        const dimValueArray = jsonStat.id.map(dim => {\r\n          if (dim === primaryDim[0]) {\r\n            return primaryDimValue;\r\n          } else if (dim === secondaryDim[0]) {\r\n            return secondaryDimValue;\r\n          } else {\r\n            return filtersValue[dim];\r\n          }\r\n        });\r\n        const valueIdx = getDataIdxFromDimensionsArray(\r\n          dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n          jsonStat.size\r\n        );\r\n        const value = jsonStat.value[valueIdx];\r\n        if (value) {\r\n          if (chartType === \"pyramid\" && secondaryDimValues.length === 2 && secDimIdx === 0) {\r\n            data.push(-value);\r\n          } else {\r\n            data.push(value);\r\n          }\r\n          valorizedDataMap[secondaryDimValue][primDimIdx] = true;\r\n        } else {\r\n          data.push(null);\r\n        }\r\n      });\r\n      datasets.push({\r\n        label: getDimensionValueLabelFromJsonStat(jsonStat, secondaryDim[0], secondaryDimValue, labelFormat),\r\n        data: data\r\n      });\r\n    });\r\n\r\n  } else {\r\n    const data = [];\r\n    primaryDimValues.forEach((primaryDimValue, primDimIdx) => {\r\n      const dimValueArray = jsonStat.id.map(dim => {\r\n        if (dim === primaryDim[0]) {\r\n          return primaryDimValue;\r\n        } else {\r\n          return filtersValue[dim];\r\n        }\r\n      });\r\n      const valueIdx = getDataIdxFromDimensionsArray(\r\n        dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n        jsonStat.size\r\n      );\r\n      const value = jsonStat.value[valueIdx];\r\n      if (value) {\r\n        data.push(value);\r\n        valorizedDataArr[primDimIdx] = true;\r\n      } else {\r\n        data.push(null);\r\n      }\r\n    });\r\n    datasets.push({\r\n      label: \"\",\r\n      data: data\r\n    });\r\n  }\r\n\r\n  const labels = [];\r\n\r\n  if (removeEmptyValues) {\r\n    const valorizedValues = (secondaryDimValues && secondaryDimValues.length > 0)\r\n      ? new Array(primaryDimValues.length)\r\n      : [...valorizedDataArr];\r\n\r\n    if (secondaryDimValues && secondaryDimValues.length > 0) {\r\n      primaryDimValues.forEach((_, idx) => {\r\n        let found = false;\r\n        secondaryDimValues.forEach(secDim => {\r\n          if (!found && valorizedDataMap[secDim][idx] === true) {\r\n            found = true;\r\n          }\r\n        });\r\n        valorizedValues[idx] = found;\r\n      });\r\n    }\r\n\r\n    datasets.forEach(dataset => dataset.data = dataset.data.filter((_, idx) => valorizedValues[idx]));\r\n\r\n    primaryDimValues.forEach((value, idx) => {\r\n      if (valorizedValues[idx]) {\r\n        labels.push(getDimensionValueLabelFromJsonStat(jsonStat, primaryDim[0], value, labelFormat));\r\n      }\r\n    });\r\n\r\n  } else {\r\n    primaryDimValues.forEach(value => {\r\n      labels.push(getDimensionValueLabelFromJsonStat(jsonStat, primaryDim[0], value, labelFormat));\r\n    });\r\n  }\r\n\r\n  let colorArr = colors;\r\n  if (datasets.length > 0) {\r\n    while (colorArr.length < datasets[0].data.length) {\r\n      colorArr = colorArr.concat(colorArr);\r\n    }\r\n    if (colorArr.length > datasets[0].data.length) {\r\n      colorArr = colorArr.slice(0, datasets[0].data.length)\r\n    }\r\n  }\r\n\r\n  return {\r\n    labels: labels,\r\n    datasets: datasets.map((dataset, idx) => ({\r\n      ...dataset,\r\n      borderWidth: 1,\r\n      lineTension: chartType === \"area\" ? 0 : undefined,\r\n      fill: (chartType === \"area\" || chartType === \"radar\"),\r\n      backgroundColor: (isBarOrLineGraph(chartType) && colorArr.length > 0)\r\n        ? hexToRGBA(colors[idx % colors.length], 0.3)\r\n        : colorArr.map(col => hexToRGBA(col, 0.3)),\r\n      borderColor: (isBarOrLineGraph(chartType) && colorArr.length > 0)\r\n        ? colors[idx % colors.length]\r\n        : colorArr\r\n    }))\r\n  };\r\n};\r\n\r\nconst getDefaultRemoveEmptyValues = (type, {primaryDim}) => !((type === \"line\" || type === \"area\") && primaryDim[0] === TIME_PERIOD_KEY);\r\n\r\nclass Chart extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.chartRef = createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    const {\r\n      jsonStat,\r\n      type,\r\n      layout,\r\n      removeEmptyValues = getDefaultRemoveEmptyValues(type, layout),\r\n      labelFormat,\r\n      decimalSeparator,\r\n      decimalPlaces,\r\n      backgroundColor = \"white\"\r\n    } = this.props;\r\n\r\n    ChartJs.defaults.global.defaultFontFamily = \"'Roboto', 'Helvetica', 'Arial', sans-serif\";\r\n    const data = getData(type, jsonStat, layout, removeEmptyValues, labelFormat);\r\n    this.myChart = new ChartJs(this.chartRef.current, {\r\n      type: getChartType(type),\r\n      options: getOptions(type, data, decimalSeparator, decimalPlaces),\r\n      data: data,\r\n      plugins: [{\r\n        beforeDraw: function (chart) {\r\n          const ctx = chart.chart.ctx;\r\n          ctx.fillStyle = backgroundColor;\r\n          ctx.fillRect(0, 0, chart.chart.width, chart.chart.height);\r\n        }\r\n      }]\r\n    });\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const {\r\n      jsonStat,\r\n      type,\r\n      layout,\r\n      removeEmptyValues = getDefaultRemoveEmptyValues(type, layout),\r\n      labelFormat,\r\n      decimalSeparator,\r\n      decimalPlaces\r\n    } = this.props;\r\n\r\n    if (\r\n      prevProps.jsonStat !== jsonStat ||\r\n      prevProps.type !== type ||\r\n      !_.isEqual(prevProps.layout, layout) ||\r\n      prevProps.labelFormat !== labelFormat\r\n    ) {\r\n      const data = getData(type, jsonStat, layout, removeEmptyValues, labelFormat);\r\n      this.myChart.config.type = getChartType(type);\r\n      this.myChart.options = getOptions(type, data, decimalSeparator, decimalPlaces);\r\n      this.myChart.data = data;\r\n      this.myChart.update();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      t,\r\n      chartId = `cart__${uuidv4()}`,\r\n      type,\r\n      layout\r\n    } = this.props;\r\n\r\n    const hideChart = (type === \"pyramid\" && ((layout.secondaryDim || []).length !== 1 || (layout.secondaryDimValues || []).length !== 2));\r\n\r\n    return (\r\n      <Fragment>\r\n        {hideChart && <CustomEmpty text={t(\"components.chart.pyramid.invalidSecondaryDimension\")}/>}\r\n        <canvas id={chartId} ref={this.chartRef} style={{display: hideChart ? \"none\" : \"block\"}}/>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withTranslation()(Chart);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport DataViewerHeader from \"./Header\";\r\nimport DataViewerSideBar from \"./Sidebar\";\r\nimport DataViewerFooter from \"./Footer\";\r\nimport DatasetFilters from \"../dataset-filters\";\r\nimport JsonStatTable, {\r\n  JSONSTAT_TABLE_FONT_SIZE_LG,\r\n  JSONSTAT_TABLE_FONT_SIZE_MD,\r\n  JSONSTAT_TABLE_FONT_SIZE_SM\r\n} from \"../table\";\r\nimport Criteria from \"../criteria\";\r\nimport TableLayout from \"../table-layout\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FontSizeSelector, {\r\n  FONT_SIZE_SELECTOR_FONT_SIZE_MD,\r\n  FONT_SIZE_SELECTOR_FONT_SIZE_SM\r\n} from \"../font-size-selector\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport \"./style.css\"\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport TableChartIcon from \"@material-ui/icons/TableChart\";\r\nimport MapIcon from \"@material-ui/icons/Map\";\r\nimport BarChartIcon from \"@material-ui/icons/BarChart\";\r\nimport TimelineIcon from \"@material-ui/icons/Timeline\";\r\nimport HelpIcon from \"@material-ui/icons/Help\";\r\nimport DonutLargeIcon from \"@material-ui/icons/DonutLarge\";\r\nimport PieChartIcon from \"@material-ui/icons/PieChart\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  enableDatasetFetch,\r\n  fetchAccessibleDataset,\r\n  fetchDataset,\r\n  fetchDatasetGeometries,\r\n  hideDatasetCriteria,\r\n  hideDatasetCriteriaAlert,\r\n  hideDatasetCriteriaLengthWarning,\r\n  hideDatasetDownloadWarning,\r\n  hideDatasetUnavailableViewWarning,\r\n  setDatasetLabelFormat,\r\n  setDatasetViewer,\r\n  showDatasetCriteria,\r\n  submitDatasetDownload,\r\n  submitDatasetViewTemplate\r\n} from \"../../state/dataset/datasetActions\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {\r\n  FREQ_KEY,\r\n  getChartDimensionValues,\r\n  getInitialFiltersValue,\r\n  getJsonStatTableSize,\r\n  getUpdatedLayout,\r\n  TIME_PERIOD_KEY\r\n} from \"../../utils/jsonStat\";\r\nimport {numberFormatter} from \"../../utils/formatters\";\r\nimport Call from \"../../hocs/call\";\r\nimport _ from \"lodash\"\r\nimport ChartLayout from \"../chart-layout\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Map from \"../map/index\";\r\nimport LabelFormatSelector from \"../label-format-selector\";\r\nimport Chart from \"../chart\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\n\r\nconst SIDEBAR_WIDTH = 80;\r\nconst TABLE_ACTIONS_WIDTH = 336;\r\n\r\nexport const MAX_COL_COUNT = 10000;\r\nexport const MAX_ROW_COUNT = 10000;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"absolute\",\r\n    width: \"100%\"\r\n  },\r\n  header: {\r\n    width: \"100%\"\r\n  },\r\n  page: {\r\n    width: \"100%\"\r\n  },\r\n  sidebar: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\",\r\n    width: SIDEBAR_WIDTH,\r\n    height: \"100%\",\r\n    overflow: \"auto\",\r\n    marginLeft: theme.spacing(2),\r\n    padding: \"0 8px\"\r\n  },\r\n  data: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\",\r\n    width: `calc(100% - ${SIDEBAR_WIDTH + theme.spacing(2) + theme.spacing(2) + theme.spacing(2)}px)`,\r\n    height: \"100%\",\r\n    marginLeft: theme.spacing(2),\r\n    marginRight: theme.spacing(2),\r\n    padding: theme.spacing(2)\r\n  },\r\n  viewerContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  action: {\r\n    height: 40,\r\n    \"& button\": {\r\n      padding: 8\r\n    }\r\n  },\r\n  filtersAndActions: {\r\n    width: \"100%\",\r\n    paddingBottom: theme.spacing(1)\r\n  },\r\n  filters: {\r\n    width: `calc(100% - ${TABLE_ACTIONS_WIDTH}px)`,\r\n    display: \"inline-block\"\r\n  },\r\n  actions: {\r\n    width: TABLE_ACTIONS_WIDTH,\r\n    display: \"inline-block\"\r\n  },\r\n  viewer: {\r\n    width: \"100%\",\r\n    position: \"relative\"\r\n  },\r\n  attributes: {\r\n    width: \"100%\",\r\n    paddingTop: 12\r\n  },\r\n  footer: {\r\n    bottom: 0,\r\n    left: 0,\r\n    width: \"100%\",\r\n    overflowX: \"auto\",\r\n    overflowY: \"hidden\",\r\n    padding: theme.spacing(1)\r\n  },\r\n  warningAlert: {\r\n    width: \"100%\",\r\n    marginBottom: 16\r\n  },\r\n  criteriaContent: {\r\n    overflow: \"hidden !important\"\r\n  }\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDataset: ({nodeId, datasetId, filters, datasetTitle, checkCriteriaLength, tableLayout, initialTableLayout, initialChartLayout, initialMapLayout, maxAllowedCells, hasViewTemplate}) =>\r\n    dispatch(fetchDataset(nodeId, datasetId, filters, datasetTitle, checkCriteriaLength, tableLayout, initialTableLayout, initialChartLayout, initialMapLayout, maxAllowedCells, hasViewTemplate)),\r\n  fetchAccessibleDataset: ({nodeId, datasetId, filters, datasetTitle}) => dispatch(fetchAccessibleDataset(nodeId, datasetId, filters, datasetTitle)),\r\n  onFetchDatasetEnable: () => dispatch(enableDatasetFetch()),\r\n  onCriteriaShow: () => dispatch(showDatasetCriteria()),\r\n  onCriteriaHide: () => dispatch(hideDatasetCriteria()),\r\n  onCriteriaAlertHide: () => dispatch(hideDatasetCriteriaAlert()),\r\n  onViewerChange: viewerIdx => dispatch(setDatasetViewer(viewerIdx)),\r\n  onLabelFormatChange: labelFormat => dispatch(setDatasetLabelFormat(labelFormat)),\r\n  onDownloadSubmit: (nodeId, datasetId, datasetTitle, criteria, format, extension) =>\r\n    dispatch(submitDatasetDownload(nodeId, datasetId, datasetTitle, criteria, format, extension)),\r\n  onDownloadHide: () => dispatch(hideDatasetDownloadWarning()),\r\n  onViewTemplateSubmit: (nodeId, viewTemplate, isView) => dispatch(submitDatasetViewTemplate(nodeId, viewTemplate, isView)),\r\n  onUnavailableViewHide: () => dispatch(hideDatasetUnavailableViewWarning()),\r\n  onCriteriaLengthWarningHide: () => dispatch(hideDatasetCriteriaLengthWarning()),\r\n  onGeometryFetch: (idList) => dispatch(fetchDatasetGeometries(idList)),\r\n  addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  removeSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\nconst viewers = t => [\r\n  {\r\n    key: 0,\r\n    type: \"table\",\r\n    title: t ? t(\"scenes.dataViewers.viewers.table\") : \"\",\r\n    icon: <TableChartIcon/>\r\n  },\r\n  {\r\n    key: 1,\r\n    title: t ? t(\"scenes.dataViewers.viewers.map\") : \"\",\r\n    type: \"map\",\r\n    icon: <MapIcon/>\r\n  },\r\n  {\r\n    key: 2,\r\n    title: t ? t(\"scenes.dataViewers.viewers.verticalBar\") : \"\",\r\n    type: \"bar\",\r\n    icon: <BarChartIcon/>,\r\n    chartType: \"bar\"\r\n  },\r\n  {\r\n    key: 3,\r\n    title: t ? t(\"scenes.dataViewers.viewers.horizontalBar\") : \"\",\r\n    type: \"horizontalBar\",\r\n    icon: <BarChartIcon style={{transform: \"rotate(90deg)\"}}/>,\r\n    chartType: \"horizontalBar\"\r\n  },\r\n  {\r\n    key: 4,\r\n    title: t ? t(\"scenes.dataViewers.viewers.line\") : \"\",\r\n    type: \"line\",\r\n    icon: <TimelineIcon/>,\r\n    chartType: \"line\"\r\n  },\r\n  {\r\n    key: 5,\r\n    title: t ? t(\"scenes.dataViewers.viewers.area\") : \"\",\r\n    type: \"area\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"area\"\r\n  },\r\n  {\r\n    key: 6,\r\n    title: t ? t(\"scenes.dataViewers.viewers.doughnut\") : \"\",\r\n    type: \"doughnut\",\r\n    icon: <DonutLargeIcon/>,\r\n    chartType: \"doughnut\"\r\n  },\r\n  {\r\n    key: 7,\r\n    title: t ? t(\"scenes.dataViewers.viewers.pie\") : \"\",\r\n    type: \"pie\",\r\n    icon: <PieChartIcon/>,\r\n    chartType: \"pie\"\r\n  },\r\n  {\r\n    key: 8,\r\n    title: t ? t(\"scenes.dataViewers.viewers.radar\") : \"\",\r\n    type: \"radar\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"radar\"\r\n  },\r\n  {\r\n    key: 9,\r\n    title: t ? t(\"scenes.dataViewers.viewers.polarArea\") : \"\",\r\n    type: \"polarArea\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"polarArea\"\r\n  },\r\n  {\r\n    key: 10,\r\n    title: t ? t(\"scenes.dataViewers.viewers.pyramid\") : \"\",\r\n    type: \"pyramid\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"pyramid\"\r\n  }\r\n];\r\n\r\nexport const getViewerIdxFromType = viewerType => {\r\n  if (!viewerType) {\r\n    return 0\r\n  }\r\n\r\n  const viewer = viewers().find(({type}) => type === viewerType);\r\n  return viewer\r\n    ? viewer.key\r\n    : 0\r\n}\r\n\r\nconst handleHeight = () => {\r\n  const titleHeight = document.getElementById(\"node-header\")\r\n    ? document.getElementById(\"node-header\").offsetHeight\r\n    : 0;\r\n  const headerHeight = document.getElementById(\"data-viewer__header\")\r\n    ? document.getElementById(\"data-viewer__header\").offsetHeight\r\n    : 0;\r\n  const footerHeight = document.getElementById(\"data-viewer__footer\")\r\n    ? document.getElementById(\"data-viewer__footer\").offsetHeight\r\n    : 0;\r\n  const filtersAndActionsHeight = document.getElementById(\"data-viewer__page__viewer__filters-and-actions\")\r\n    ? document.getElementById(\"data-viewer__page__viewer__filters-and-actions\").offsetHeight\r\n    : 0;\r\n\r\n  if (document.getElementById(\"data-viewer\")) {\r\n    document.getElementById(\"data-viewer\").setAttribute(\"style\", `height: calc(100% - ${titleHeight}px); top: ${titleHeight}px`);\r\n  }\r\n  if (document.getElementById(\"data-viewer__page\")) {\r\n    document.getElementById(\"data-viewer__page\").setAttribute(\"style\", `height: calc(100% - ${headerHeight + footerHeight}px)`);\r\n  }\r\n  if (document.getElementById(\"data-viewer__page__viewer__viewer\")) {\r\n    document.getElementById(\"data-viewer__page__viewer__viewer\").setAttribute(\"style\", `height: calc(100% - ${filtersAndActionsHeight}px)`);\r\n  }\r\n};\r\n\r\nconst getInitialTableLayout = (jsonStat, territorialDims) => {\r\n  if (!jsonStat) {\r\n    return null;\r\n  }\r\n\r\n  let dimensions = [...jsonStat.id];\r\n\r\n  let rows = dimensions.filter(dim => dim === TIME_PERIOD_KEY);\r\n  dimensions = dimensions.filter(dim => !rows.includes(dim));\r\n\r\n  let cols = dimensions.filter(dim => (territorialDims || []).includes(dim));\r\n  dimensions = dimensions.filter(dim => !cols.includes(dim));\r\n\r\n  let filters = dimensions.filter(dim => jsonStat.size[jsonStat.id.indexOf(dim)] === 1);\r\n  dimensions = dimensions.filter(dim => !filters.includes(dim));\r\n\r\n  if (dimensions.includes(FREQ_KEY)) {\r\n    rows = [FREQ_KEY, ...rows];\r\n    dimensions = dimensions.filter(dim => !rows.includes(dim));\r\n  }\r\n\r\n  if (rows.length === 1 && jsonStat.size[jsonStat.id.indexOf(rows[0])] === 1 && cols.length === 1) {\r\n    filters = filters.concat(rows);\r\n    rows = [...cols];\r\n    cols = [];\r\n  }\r\n\r\n  let colCount = 1;\r\n  cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  let rowCount = 1;\r\n  rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n\r\n  dimensions.forEach(dim => {\r\n    const newColCount = colCount * jsonStat.size[jsonStat.id.indexOf(dim)];\r\n\r\n    if (newColCount > MAX_COL_COUNT) {\r\n      const newRowCount = rowCount * jsonStat.size[jsonStat.id.indexOf(dim)];\r\n\r\n      if (newRowCount > MAX_ROW_COUNT) {\r\n        filters.push(dim);\r\n\r\n      } else {\r\n        rows = [dim].concat(rows);\r\n        rowCount = newRowCount;\r\n      }\r\n\r\n    } else {\r\n      cols.push(dim);\r\n      colCount = newColCount;\r\n    }\r\n  });\r\n\r\n  const layout = {\r\n    rows: rows,\r\n    cols: cols,\r\n    sections: [],\r\n    filters: filters\r\n  }\r\n\r\n  return {\r\n    ...layout,\r\n    filtersValue: getInitialFiltersValue(jsonStat, layout)\r\n  }\r\n};\r\n\r\nconst getInitialChartLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null\r\n  }\r\n\r\n  let primaryDim = jsonStat.id.find(dim => dim === TIME_PERIOD_KEY);\r\n  if (!primaryDim) {\r\n    primaryDim = jsonStat.id[0];\r\n  }\r\n  const filters = jsonStat.id.filter(dim => dim !== primaryDim);\r\n\r\n  let layout = {\r\n    primaryDim: [primaryDim],\r\n    secondaryDim: [],\r\n    secondaryDimValues: [],\r\n    filters: filters\r\n  }\r\n\r\n  layout = {\r\n    ...layout,\r\n    primaryDimValues: getChartDimensionValues(jsonStat, layout, true, 10)\r\n  }\r\n\r\n  return {\r\n    ...layout,\r\n    filtersValue: getInitialFiltersValue(jsonStat, layout),\r\n  }\r\n};\r\n\r\nconst getInitialMapLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null\r\n  }\r\n\r\n  let dimensions = [...jsonStat.id];\r\n  let geoId = jsonStat.role?.geo?.length > 0 ? jsonStat.role.geo[0] : null;\r\n  let territoryDim = dimensions.find(dim => (geoId !== null && dim === geoId) || dim === 'REF_AREA' || dim === 'ITTER107');\r\n\r\n  const layout = {\r\n    territoryDim: territoryDim,\r\n    filters: dimensions.filter(dim => dim !== territoryDim)\r\n  }\r\n\r\n  return {\r\n    ...layout,\r\n    filtersValue: getInitialFiltersValue(jsonStat, layout)\r\n  }\r\n};\r\n\r\nfunction DataViewer(props) {\r\n  const {\r\n    classes,\r\n\r\n    nodeId,\r\n    nodeCode,\r\n    nodeExtras,\r\n\r\n    isAccessible,\r\n\r\n    datasetId,\r\n    datasetTitle,\r\n    notes,\r\n    attachedFiles,\r\n    referenceMetadataUrl,\r\n    dataset,\r\n    accessibleDataset,\r\n    isFetchDatasetDisabled,\r\n\r\n    isCriteriaVisible,\r\n    isCriteriaAlertVisible,\r\n\r\n    hasViewTemplate,\r\n    hasTemplateLayout,\r\n    hasAnnotationLayout,\r\n\r\n    dimensions,\r\n    mode,\r\n    type,\r\n    codelistsLength,\r\n    viewerIdx,\r\n    initialTableLayout,\r\n    initialMapLayout,\r\n    initialChartLayout,\r\n    labelFormat,\r\n    filters,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    enableCriteria,\r\n    enableLayout,\r\n    maxAllowedCells,\r\n    territorialDims,\r\n    codes,\r\n    isCodesFlat,\r\n    codelists,\r\n    areCodelistsFlat,\r\n    timePeriod,\r\n\r\n    isPartialData,\r\n    isEmptyData,\r\n    isTooBigData,\r\n\r\n    maxObservation,\r\n\r\n    isDownloadWarningVisible,\r\n    isUnavailableViewWarningVisible,\r\n    isCriteriaLengthWarningVisible,\r\n\r\n    timings,\r\n    geometries,\r\n    geometryDetailLevels,\r\n\r\n    fetchDataset,\r\n    fetchAccessibleDataset,\r\n    onFetchDatasetEnable,\r\n    onCriteriaShow,\r\n    onCriteriaHide,\r\n    onCriteriaAlertHide,\r\n    onViewerChange,\r\n    onLabelFormatChange,\r\n    onDownloadSubmit,\r\n    onDownloadHide,\r\n    onViewTemplateSubmit,\r\n    onUnavailableViewHide,\r\n    onGeometryFetch,\r\n    onCriteriaLengthWarningHide,\r\n    addSpinner,\r\n    removeSpinner\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [tableLayout, setTableLayout] = useState(null);\r\n  const [tmpTableLayout, setTmpTableLayout] = useState(null);\r\n  const [tableLayoutSpinnerUuid] = useState(uuidv4());\r\n\r\n  const [chartId] = useState(\"chart__\" + uuidv4());\r\n  const [chartLayout, setChartLayout] = useState(null);\r\n  const [tmpChartLayout, setTmpChartLayout] = useState(null);\r\n\r\n  const [mapId] = useState(\"map__\" + uuidv4());\r\n  const [mapLayout, setMapLayout] = useState(null);\r\n\r\n  const [isLayoutVisible, setLayoutVisibility] = useState(false);\r\n\r\n  const [isCriteriaValid, setCriteriaValidity] = useState(true);\r\n\r\n  const [isFullscreen, setFullscreen] = useState(false);\r\n  const [fontSize, setFontSize] = useState(FONT_SIZE_SELECTOR_FONT_SIZE_MD);\r\n\r\n  const [worker] = useState(() => new Worker(\"./workers/getInitialFiltersValueWorker.js\"));\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (worker) {\r\n        worker.terminate();\r\n      }\r\n    }\r\n  }, [worker]);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", handleHeight);\r\n    return () => window.removeEventListener(\"resize\", handleHeight)\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    handleHeight();\r\n  }, [dataset, viewerIdx, tableLayout]);\r\n\r\n  useEffect(() => {\r\n    setTableLayout(null);\r\n    setTmpTableLayout(null);\r\n    setChartLayout(null);\r\n    setTmpChartLayout(null);\r\n  }, [dataset]);\r\n\r\n  useEffect(() => {\r\n    const cellCount = getJsonStatTableSize(dataset);\r\n\r\n    if (cellCount < maxAllowedCells) {\r\n      if (dataset) {\r\n\r\n        const newTableLayout = initialTableLayout !== null\r\n          ? initialTableLayout\r\n          : getInitialTableLayout(dataset, territorialDims);\r\n        setTableLayout(newTableLayout);\r\n        setTmpTableLayout(newTableLayout);\r\n\r\n        const newChartLayout = initialChartLayout !== null\r\n          ? initialChartLayout\r\n          : getInitialChartLayout(dataset);\r\n        setChartLayout(newChartLayout);\r\n        setTmpChartLayout(newChartLayout);\r\n\r\n        const newMapLayout = initialMapLayout !== null\r\n          ? initialMapLayout\r\n          : getInitialMapLayout(dataset);\r\n        setMapLayout(newMapLayout);\r\n      }\r\n\r\n    } else {\r\n      setTableLayout(null);\r\n      setTmpTableLayout(null);\r\n      setChartLayout(null);\r\n      setTmpChartLayout(null);\r\n      setMapLayout(null);\r\n    }\r\n\r\n  }, [dataset, initialTableLayout, initialMapLayout, initialChartLayout, maxAllowedCells, territorialDims, isAccessible]);\r\n\r\n  const handleSetViewer = viewerIdx => {\r\n    onViewerChange(viewerIdx);\r\n  };\r\n\r\n  const handleSetData = dataIdx => {\r\n    // fetch new data\r\n  };\r\n\r\n  const handleLayoutOpen = () => {\r\n    if (dataset) {\r\n      setLayoutVisibility(true);\r\n    }\r\n  };\r\n\r\n  const handleLayoutClose = () => {\r\n    setLayoutVisibility(false);\r\n    setTmpTableLayout(tableLayout);\r\n    setTmpChartLayout(chartLayout);\r\n  };\r\n\r\n  const handleLayoutSubmit = () => {\r\n    setLayoutVisibility(false);\r\n\r\n    if (viewerIdx === 0) {\r\n      const newTableLayout = _.cloneDeep(tmpTableLayout);\r\n\r\n      addSpinner(tableLayoutSpinnerUuid, t(\"scenes.dataViewer.spinners.applyingLayout\"));\r\n\r\n      worker.onmessage = event => {\r\n        newTableLayout.filtersValue = event.data;\r\n        setTableLayout(newTableLayout);\r\n        removeSpinner(tableLayoutSpinnerUuid);\r\n      }\r\n      worker.postMessage({\r\n        jsonStat: dataset,\r\n        layout: newTableLayout\r\n      });\r\n\r\n    } else if (viewerIdx >= 2) {\r\n      const newChartLayout = _.cloneDeep(tmpChartLayout);\r\n\r\n      newChartLayout.primaryDimValues = chartLayout.primaryDim[0] !== newChartLayout.primaryDim[0]\r\n        ? getChartDimensionValues(dataset, newChartLayout, true, 10)\r\n        : chartLayout.primaryDimValues;\r\n\r\n      newChartLayout.secondaryDimValues = chartLayout.secondaryDim[0] !== newChartLayout.secondaryDim[0]\r\n        ? getChartDimensionValues(dataset, newChartLayout, false, 10)\r\n        : chartLayout.secondaryDimValues;\r\n\r\n      newChartLayout.filtersValue = getInitialFiltersValue(dataset, newChartLayout);\r\n\r\n      setChartLayout(newChartLayout);\r\n    }\r\n  };\r\n\r\n  const handleCriteriaOpen = () => {\r\n    onCriteriaShow();\r\n  }\r\n\r\n  const handleCriteriaClose = () => {\r\n    onCriteriaHide();\r\n    setCriteriaValidity(true);\r\n  }\r\n\r\n  const handleCriteriaSubmit = () => {\r\n    onFetchDatasetEnable();\r\n  }\r\n\r\n  const handleFilterSelect = (dimension, value) => {\r\n    if (viewerIdx === 0) {\r\n      setTableLayout(getUpdatedLayout(dataset, tableLayout, dimension, value));\r\n    } else if (viewerIdx === 1) {\r\n      setMapLayout(getUpdatedLayout(dataset, mapLayout, dimension, value));\r\n    } else if (viewerIdx >= 2) {\r\n      setChartLayout(getUpdatedLayout(dataset, chartLayout, dimension, value));\r\n    }\r\n  };\r\n\r\n  const handleFontSizeSelect = size => {\r\n    setFontSize(size);\r\n  };\r\n\r\n  const handleFullscreen = () => {\r\n    !isFullscreen\r\n      ? document.getElementById(\"data-viewer__page__viewer\").classList.add(\"data-viewer__page__viewer--fullscreen\")\r\n      : document.getElementById(\"data-viewer__page__viewer\").classList.remove(\"data-viewer__page__viewer--fullscreen\");\r\n\r\n    setFullscreen(!isFullscreen);\r\n  };\r\n\r\n  return (\r\n    <div id=\"data-viewer\" className={classes.root}>\r\n      {isAccessible\r\n        ? (\r\n          <Call\r\n            cb={fetchAccessibleDataset}\r\n            cbParam={{nodeId, datasetId, filters, datasetTitle}}\r\n            disabled={!nodeId || !datasetId || !filters || !datasetTitle || isFetchDatasetDisabled}\r\n          >\r\n            <div style={{height: \"100%\", width: \"100%\", overflow: \"auto\", padding: 16}}>\r\n              <span>{accessibleDataset}</span>\r\n            </div>\r\n          </Call>\r\n        )\r\n        : (\r\n          <Fragment>\r\n            <Call\r\n              cb={fetchDataset}\r\n              cbParam={{\r\n                nodeId,\r\n                datasetId,\r\n                filters,\r\n                datasetTitle,\r\n                checkCriteriaLength: true,\r\n                tableLayout,\r\n                initialTableLayout,\r\n                initialChartLayout,\r\n                initialMapLayout,\r\n                maxAllowedCells,\r\n                hasViewTemplate\r\n              }}\r\n              disabled={!nodeId || !datasetId || !filters || !datasetTitle || isFetchDatasetDisabled}\r\n            >\r\n              <div id=\"data-viewer__header\" className={classes.header}>\r\n                <DataViewerHeader\r\n                  nodeId={nodeId}\r\n                  nodeCode={nodeCode}\r\n                  nodeDownloadFormats={nodeExtras?.DownloadFormats}\r\n                  datasetId={datasetId}\r\n                  datasetTitle={datasetTitle}\r\n                  hasTemplateLayout={hasTemplateLayout}\r\n                  hasAnnotationLayout={hasAnnotationLayout}\r\n                  notes={notes}\r\n                  attachedFiles={attachedFiles}\r\n                  jsonStat={dataset}\r\n                  hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                  tableLayout={tableLayout}\r\n                  mapLayout={mapLayout}\r\n                  chartLayout={chartLayout}\r\n                  labelFormat={labelFormat}\r\n                  criteria={filters}\r\n                  decimalSeparator={decimalSeparator}\r\n                  decimalPlaces={decimalPlaces}\r\n                  emptyChar={emptyChar}\r\n                  viewers={viewers(t)}\r\n                  viewerIdx={viewerIdx}\r\n                  onViewTemplateSubmit={(viewTemplate, isView) => onViewTemplateSubmit(nodeId, viewTemplate, isView)}\r\n                  onDownloadSubmit={(format, extension) => onDownloadSubmit(nodeId, datasetId, datasetTitle, filters, format, extension)}\r\n                  timings={timings}\r\n                  chartId={chartId}\r\n                  mapId={mapId}\r\n                />\r\n              </div>\r\n              <div id=\"data-viewer__page\" className={classes.page}>\r\n                <Card className={classes.sidebar}>\r\n                  <DataViewerSideBar\r\n                    viewers={viewers(t)}\r\n                    selected={viewerIdx}\r\n                    viewerSelectDisabled={!dataset || !tableLayout || !chartLayout || !mapLayout}\r\n                    referenceMetadataUrl={referenceMetadataUrl}\r\n                    onViewerSelect={handleSetViewer}\r\n                    onCriteriaOpen={enableCriteria ? handleCriteriaOpen : null}\r\n                    onLayoutOpen={(enableLayout && tableLayout && chartLayout && mapLayout)\r\n                      ? handleLayoutOpen\r\n                      : null\r\n                    }\r\n                  />\r\n                </Card>\r\n                <Card className={classes.data}>\r\n                  <div id=\"data-viewer__page__viewer\" className={classes.viewerContainer}>\r\n                    <div id=\"data-viewer__page__viewer__filters-and-actions\" className={classes.filtersAndActions}>\r\n                      {dataset && (\r\n                        <Fragment>\r\n                          {dataset && isPartialData && tableLayout && chartLayout && mapLayout && (\r\n                            <Alert severity=\"warning\" className={classes.warningAlert}>\r\n                              {t(\"scenes.dataViewer.warnings.maxObservation.label\", {maxObservation: maxObservation ? numberFormatter(maxObservation) : \"\"})}\r\n                            </Alert>\r\n                          )}\r\n                          <div className={classes.filters}>\r\n                            <DatasetFilters\r\n                              key={uuidv4()}\r\n                              jsonStat={dataset}\r\n                              hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                              layout={viewerIdx === 0\r\n                                ? tableLayout\r\n                                : viewerIdx === 1\r\n                                  ? mapLayout\r\n                                  : chartLayout\r\n                              }\r\n                              labelFormat={labelFormat}\r\n                              onSelect={handleFilterSelect}\r\n                            />\r\n                          </div>\r\n                          <div className={classes.actions}>\r\n                            <Grid container>\r\n                              <Grid item className={classes.action}>\r\n                                <LabelFormatSelector\r\n                                  labelFormat={labelFormat}\r\n                                  setLabelFormat={labelFormat => onLabelFormatChange(labelFormat)}\r\n                                />\r\n                              </Grid>\r\n                              <Grid item className={classes.action}>\r\n                                <FontSizeSelector\r\n                                  fontSize={fontSize}\r\n                                  setFontSize={handleFontSizeSelect}\r\n                                />\r\n                              </Grid>\r\n                              <Grid item className={classes.action}>\r\n                                <Tooltip\r\n                                  title={isFullscreen\r\n                                    ? t(\"scenes.dataViewer.fullscreen.exit\")\r\n                                    : t(\"scenes.dataViewer.fullscreen.enter\")\r\n                                  }\r\n                                >\r\n                                  <IconButton onClick={handleFullscreen}>\r\n                                    {isFullscreen ? <FullscreenExitIcon/> : <FullscreenIcon/>}\r\n                                  </IconButton>\r\n                                </Tooltip>\r\n                              </Grid>\r\n                            </Grid>\r\n                          </div>\r\n                        </Fragment>\r\n                      )}\r\n                    </div>\r\n                    <div id=\"data-viewer__page__viewer__viewer\" className={classes.viewer}>\r\n                      {(() => {\r\n                        if (!dataset) {\r\n                          return isEmptyData\r\n                            ? <CustomEmpty text={t(\"scenes.dataViewer.errors.emptyData\")}/>\r\n                            : <CustomEmpty text={t(\"scenes.dataViewer.errors.applyCriteria\")}/>\r\n                        }\r\n                        if (viewerIdx === 0) {\r\n                          return (tableLayout && getJsonStatTableSize(dataset) < maxAllowedCells)\r\n                            ? (\r\n                              <JsonStatTable\r\n                                jsonStat={dataset}\r\n                                layout={tableLayout}\r\n                                isFullscreen={isFullscreen}\r\n                                labelFormat={labelFormat}\r\n                                fontSize={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_SM\r\n                                  ? JSONSTAT_TABLE_FONT_SIZE_SM\r\n                                  : fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_MD\r\n                                    ? JSONSTAT_TABLE_FONT_SIZE_MD\r\n                                    : JSONSTAT_TABLE_FONT_SIZE_LG\r\n                                }\r\n                                decimalSeparator={decimalSeparator}\r\n                                decimalPlaces={decimalPlaces}\r\n                                emptyChar={emptyChar}\r\n                                hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                              />\r\n                            )\r\n                            : (\r\n                              <CustomEmpty\r\n                                text={t(\"scenes.dataViewer.errors.tooBigData\")}\r\n                              />\r\n                            )\r\n                        } else if (viewerIdx === 1) {\r\n                          return (\r\n                            <Map\r\n                              mapId={mapId}\r\n                              jsonStat={dataset}\r\n                              mapLayout={mapLayout}\r\n                              onGeometryFetch={onGeometryFetch}\r\n                              geometries={geometries}\r\n                              geometryDetailLevels={geometryDetailLevels}\r\n                            />\r\n                          )\r\n                        } else if (viewerIdx >= 2) {\r\n                          return (\r\n                            <Chart\r\n                              chartId={chartId}\r\n                              type={viewers(t)[viewerIdx].chartType}\r\n                              jsonStat={dataset}\r\n                              layout={chartLayout}\r\n                              labelFormat={labelFormat}\r\n                              decimalSeparator={decimalSeparator}\r\n                              decimalPlaces={decimalPlaces}\r\n                            />\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              </div>\r\n              <div id=\"data-viewer__footer\" className={classes.footer}>\r\n                <DataViewerFooter\r\n                  labels={dataset ? [datasetTitle] : []}\r\n                  dataIdx={0}\r\n                  setData={handleSetData}\r\n                />\r\n              </div>\r\n            </Call>\r\n\r\n            <Dialog\r\n              open={isCriteriaVisible}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleCriteriaClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.criteria.title\")}\r\n              </DialogTitle>\r\n              <DialogContent className={classes.criteriaContent}>\r\n                {dimensions && isCriteriaVisible && (\r\n                  <Fragment>\r\n\r\n                    <Criteria\r\n                      nodeId={nodeId}\r\n                      datasetId={datasetId}\r\n                      dimensions={dimensions}\r\n                      mode={mode}\r\n                      type={type}\r\n                      codes={codes}\r\n                      isCodesFlat={isCodesFlat}\r\n                      codelists={codelists}\r\n                      areCodelistsFlat={areCodelistsFlat}\r\n                      codelistsLength={codelistsLength}\r\n                      filters={filters}\r\n                      timePeriod={timePeriod}\r\n                      isCriteriaValid={isCriteriaValid}\r\n                      setCriteriaValidity={setCriteriaValidity}\r\n                    />\r\n\r\n                    <Dialog\r\n                      open={isCriteriaAlertVisible}\r\n                      fullWidth\r\n                      maxWidth=\"sm\"\r\n                      onClose={onCriteriaAlertHide}\r\n                    >\r\n                      {(() => {\r\n                        if (isEmptyData) {\r\n                          return (\r\n                            <DialogTitle>\r\n                              {t(\"scenes.dataViewer.errors.emptyData\")}\r\n                            </DialogTitle>\r\n                          )\r\n\r\n                        } else if (isTooBigData) {\r\n                          const count = getJsonStatTableSize(dataset);\r\n\r\n                          return (\r\n                            <Fragment>\r\n                              <DialogTitle>\r\n                                {t(\"scenes.dataViewer.dialogs.tooBigData.title\")}\r\n                              </DialogTitle>\r\n                              <DialogContent>\r\n                                {count !== 0 && (\r\n                                  <div style={{width: \"100%\", textAlign: \"end\"}}>\r\n                                    {t(\"scenes.dataViewer.dialogs.tooBigData.content.requestCells\")}: <b>{numberFormatter(count)}</b>\r\n                                  </div>\r\n                                )}\r\n                                <div style={{width: \"100%\", textAlign: \"end\"}}>\r\n                                  {t(\"scenes.dataViewer.dialogs.tooBigData.content.maxCells\")}: <b>{numberFormatter(maxAllowedCells)}</b>\r\n                                </div>\r\n                                <div style={{width: \"100%\", textAlign: \"end\", marginTop: 16}}>\r\n                                  {t(\"scenes.dataViewer.dialogs.tooBigData.content.applyCriteria\")}\r\n                                </div>\r\n                              </DialogContent>\r\n                            </Fragment>\r\n                          )\r\n\r\n                        } else {\r\n                          return (\r\n                            <DialogTitle>\r\n                              {t(\"scenes.dataViewer.errors.genericError\")}\r\n                            </DialogTitle>\r\n                          )\r\n                        }\r\n                      })()}\r\n                      <DialogActions>\r\n                        <Button autoFocus onClick={onCriteriaAlertHide} color=\"primary\">\r\n                          {t(\"commons.confirm.confirm\")}\r\n                        </Button>\r\n                      </DialogActions>\r\n                    </Dialog>\r\n\r\n                  </Fragment>\r\n                )}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleCriteriaClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button\r\n                  autoFocus\r\n                  color=\"primary\"\r\n                  onClick={handleCriteriaSubmit}\r\n                  disabled={!isCriteriaValid}\r\n                >\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isLayoutVisible && viewerIdx === 0}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleLayoutClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.tableLayout.title\")}\r\n              </DialogTitle>\r\n              <DialogContent>\r\n                <TableLayout\r\n                  jsonStat={dataset}\r\n                  layout={tmpTableLayout}\r\n                  labelFormat={labelFormat}\r\n                  setLayout={setTmpTableLayout}\r\n                />\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleLayoutClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button autoFocus onClick={handleLayoutSubmit} color=\"primary\">\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isLayoutVisible && viewerIdx >= 2}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleLayoutClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.chartLayout.title\")}\r\n              </DialogTitle>\r\n              <DialogContent>\r\n                <ChartLayout\r\n                  jsonStat={dataset}\r\n                  layout={tmpChartLayout}\r\n                  setLayout={setTmpChartLayout}\r\n                />\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleLayoutClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button autoFocus onClick={handleLayoutSubmit} color=\"primary\">\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isDownloadWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onDownloadHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.downloadFormat.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onDownloadHide}>\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isUnavailableViewWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onUnavailableViewHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.unavailableView.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onUnavailableViewHide}>\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isCriteriaLengthWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onCriteriaLengthWarningHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.tooLongQuery.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onCriteriaLengthWarningHide}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button\r\n                  onClick={() => fetchDataset({\r\n                    nodeId,\r\n                    datasetId,\r\n                    filters,\r\n                    datasetTitle,\r\n                    checkCriteriaLength: false,\r\n                    tableLayout\r\n                  })}\r\n                >\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n          </Fragment>\r\n        )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(null, mapDispatchToProps)\r\n)(DataViewer)","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  DASHBOARDS_DASHBOARD_FETCH,\r\n  DASHBOARDS_DASHBOARDS_CLEAR,\r\n  DASHBOARDS_DATASET_FETCH,\r\n  DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET,\r\n  DASHBOARDS_MAP_GEOMETRIES_FETCH\r\n} from \"./dashboardActions\";\r\nimport _ from \"lodash\"\r\nimport {DASHBOARD_ELEM_FILTER_DIMENSION_KEY, getViewIdxFromRowAndCol} from \"../../utils/dashboards\";\r\n\r\nexport const DASHBOARD_VIEW_STATE_APPLY_FILTERS = \"DASHBOARD_VIEW_STATE_APPLY_FILTERS\"\r\nexport const DASHBOARD_VIEW_STATE_ERROR = \"DASHBOARD_VIEW_STATE_ERROR\"\r\nexport const DASHBOARD_VIEW_STATE_FETCHING = \"DASHBOARD_VIEW_STATE_FETCHING\"\r\n\r\ntype DashboardState = {\r\n  dashboards: any | null,\r\n  isFetchDatasetDisabled: boolean,\r\n  jsonStats: any | null,\r\n  maps: any | null\r\n}\r\n\r\nconst initialState = {\r\n  dashboards: null,\r\n  isFetchDatasetDisabled: true,\r\n  jsonStats: null,\r\n  maps: null\r\n};\r\n\r\nconst dashboardReducer: Reducer<DashboardState> = (\r\n  state = initialState,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case DASHBOARDS_DASHBOARDS_CLEAR: {\r\n      return initialState\r\n    }\r\n    case DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET: {\r\n      return {\r\n        ...state,\r\n        isFetchDatasetDisabled: action.payload.disabled\r\n      }\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DATASET_FETCH: {\r\n\r\n          let currentDashboardJsonStats = {};\r\n          state.dashboards[action.payload.extra.dashboardId].dashboardConfig.forEach((row: any, rowIdx: number) => {\r\n            row.forEach((col: any, colIdx: number) => {\r\n              const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n\r\n              if (!col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY].length === 0) {\r\n                currentDashboardJsonStats = {\r\n                  ...currentDashboardJsonStats,\r\n                  [viewIdx]: (state.jsonStats?.[action.payload.extra.dashboardId]?.[viewIdx] || DASHBOARD_VIEW_STATE_FETCHING)\r\n                }\r\n              } else {\r\n                currentDashboardJsonStats = {\r\n                  ...currentDashboardJsonStats,\r\n                  [viewIdx]: DASHBOARD_VIEW_STATE_FETCHING\r\n                }\r\n              }\r\n            });\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            jsonStats: {\r\n              ...state.jsonStats,\r\n              [action.payload.extra.dashboardId]: currentDashboardJsonStats\r\n            }\r\n          }\r\n        }\r\n        case DASHBOARDS_MAP_GEOMETRIES_FETCH: {\r\n          return {\r\n            ...state,\r\n            maps: {\r\n              ...state.maps,\r\n              [action.payload.extra.dashboardId]: null\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DASHBOARD_FETCH: {\r\n          const views = action.payload.response.views;\r\n          for (let key in views) {\r\n            if (views.hasOwnProperty(key)) {\r\n              views[key] = {\r\n                ...views[key],\r\n                datasetId: views[key].datasetId ? views[key].datasetId.split(\"+\").join(\",\") : undefined\r\n              }\r\n            }\r\n          }\r\n\r\n          return {\r\n            ...state,\r\n            dashboards: {\r\n              ...state.dashboards,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...action.payload.response,\r\n                dashboardConfig: action.payload.response?.dashboardConfig\r\n                  ? JSON.parse(action.payload.response.dashboardConfig)\r\n                  : {},\r\n                filterLevels: action.payload.response?.filterLevels\r\n                  ? JSON.parse(action.payload.response.filterLevels)\r\n                  : {},\r\n                views: views\r\n              }\r\n            }\r\n          }\r\n        }\r\n        case DASHBOARDS_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.jsonStats);\r\n          const jsonStat = (action.payload.response?.id || []).length > 0\r\n            ? action.payload.response\r\n            : \"\";\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...jsonStats[action.payload.extra.dashboardId],\r\n                [id]: jsonStat\r\n              }\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            jsonStats: jsonStats\r\n          }\r\n        }\r\n        case DASHBOARDS_MAP_GEOMETRIES_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any, idx: number) => val.nutsLevel)\r\n            .reduce((acc: any, val: any) => {\r\n              if (!acc[val]) {\r\n                const label = \"Nuts level \" + val;\r\n                acc[val] = {level: val, counter: 0, label: label};\r\n              }\r\n              acc[val].counter++;\r\n              return acc;\r\n            }, []);\r\n\r\n          return {\r\n            ...state,\r\n            maps: {\r\n              ...state.maps,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...state.maps[action.payload.extra.dashboardId],\r\n                [action.payload.extra.requestId]: {\r\n                  geometries: action.payload.response,\r\n                  geometryDetailLevels: detailLevels\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.jsonStats);\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...jsonStats[action.payload.extra.dashboardId],\r\n                [id]: DASHBOARD_VIEW_STATE_ERROR\r\n              }\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            jsonStats: jsonStats\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\nexport default dashboardReducer;","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getDashboardsUrl, getDatasetDownloadUrl, getDatasetUrl, getGeometryUrl} from \"../../serverApi/urls\";\r\nimport {getCriteriaRequestObject} from \"../../utils/datasets\";\r\nimport {DATASET_DOWNLOAD_SUBMIT} from \"../dataset/datasetActions\";\r\n\r\nexport const DASHBOARDS_DASHBOARD_FETCH = \"dashboards/dashboard/fetch\";\r\nexport const DASHBOARDS_DASHBOARDS_CLEAR = \"dashboards/dashboards/clear\";\r\nexport const DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET = \"dashboards/dataset/fetch/enableStatus/set\";\r\nexport const DASHBOARDS_DATASET_FETCH = \"dashboards/dataset/fetch\";\r\nexport const DASHBOARDS_MAP_GEOMETRIES_FETCH = \"dashboards/map/geometries/fetch\";\r\n\r\nexport const fetchDashboardsDashboard = (dashboardId: number) => initRequest(\r\n  DASHBOARDS_DASHBOARD_FETCH,\r\n  getDashboardsUrl(dashboardId),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDashboard\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId\r\n  }\r\n);\r\n\r\nexport const clearDashboardsDashboards = () => ({\r\n  type: DASHBOARDS_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const setDashboardsDatasetFetchEnableStatus = (enabled: boolean) => ({\r\n  type: DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET,\r\n  payload: {\r\n    disabled: !enabled\r\n  }\r\n});\r\n\r\nexport const fetchDashboardsDataset = (dashboardId: number, nodeId: number, datasetId: string, criteria: any, requestIds: string[]) => initRequest(\r\n  DASHBOARDS_DATASET_FETCH,\r\n  getDatasetUrl(nodeId, datasetId),\r\n  RequestMethod.POST,\r\n  getCriteriaRequestObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDataset\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId,\r\n    requestIds: requestIds\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const fetchDashboardsMapGeometries = (dashboardId: number, idList: string[], requestId: string) => initRequest(\r\n  DASHBOARDS_MAP_GEOMETRIES_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dashboard.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    dashboardId: dashboardId,\r\n    requestId: requestId\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const downloadViewCsv = (nodeId: number, datasetId: string, viewTitle: string, criteria: any) => initRequest(\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  getDatasetDownloadUrl(nodeId, datasetId, \"csv\"),\r\n  RequestMethod.POST,\r\n  getCriteriaRequestObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.downloadingDataset\")\r\n  }),\r\n  {\r\n    fileSave: {\r\n      name: `${viewTitle}.csv`,\r\n      type: \"text/plain;charset=utf-8\"\r\n    }\r\n  },\r\n  \"\",\r\n  (statusCode: number) => statusCode === 406\r\n);","import React, {Fragment, useEffect, useState} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {\r\n  DASHBOARD_ELEM_ENABLE_FILTERS_KEY,\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_SHOW_TITLE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_TEXT,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../utils/dashboards\";\r\nimport JsonStatTable from \"../table\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport _ from \"lodash\";\r\nimport {getViewerIdxFromType} from \"../data-viewer\";\r\nimport DatasetFilters from \"../dataset-filters\";\r\nimport Map from \"../map\";\r\nimport {\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat,\r\n  getFilteredLayoutObject,\r\n  getUpdatedLayout\r\n} from \"../../utils/jsonStat\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  DASHBOARD_VIEW_STATE_APPLY_FILTERS,\r\n  DASHBOARD_VIEW_STATE_ERROR,\r\n  DASHBOARD_VIEW_STATE_FETCHING\r\n} from \"../../state/dashboard/dashboardReducer\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport \"./style.css\"\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Chart from \"../chart\";\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport {exportChartJpeg} from \"../../utils/download\";\r\n\r\nconst styles = theme => ({\r\n  row: {\r\n    width: \"100%\",\r\n    marginTop: 8\r\n  },\r\n  col: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\"\r\n  },\r\n  viewContainer: {\r\n    padding: 16,\r\n    height: 640,\r\n    width: \"100%\",\r\n    overflow: \"auto\"\r\n  },\r\n  viewPlaceholder: {\r\n    height: \"100%\"\r\n  },\r\n  viewControllers: {\r\n    paddingBottom: 16\r\n  },\r\n  viewTitle: {\r\n    fontSize: 18,\r\n    marginBottom: 8\r\n  },\r\n  viewStaticFilters: {\r\n    marginBottom: 8\r\n  },\r\n  viewStaticFilter: {\r\n    display: \"inline-block\",\r\n    marginRight: 8\r\n  },\r\n  viewActiveFilters: {},\r\n  view: {\r\n    width: \"100%\",\r\n    position: \"relative\"\r\n  }\r\n});\r\n\r\nconst handleHeight = (uuid, viewIdx) => {\r\n  const controllersHeight = document.getElementById(`dashboard__view-container__${uuid}__controllers__${viewIdx}`)?.offsetHeight || 0;\r\n  const view = document.getElementById(`dashboard__view-container__${uuid}__view__${viewIdx}`);\r\n  if (view) {\r\n    view.setAttribute(\"style\", `height: calc(100% - ${controllersHeight}px)`);\r\n  }\r\n};\r\n\r\nfunction DashboardCol(props) {\r\n\r\n  const {\r\n    t,\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    dashboard,\r\n    filterValue,\r\n    rowIdx,\r\n    colIdx,\r\n    col,\r\n    jsonStats,\r\n    viewLayouts,\r\n    onSelect,\r\n    maps,\r\n    fetchMapGeometries,\r\n    downloadCsv\r\n  } = props;\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [isFullscreen, setFullscreen] = useState(false);\r\n\r\n  const [chartId] = useState(\"chart__\" + uuidv4());\r\n  const [mapId] = useState(\"map__\" + uuidv4());\r\n\r\n  useEffect(() => {\r\n    const func = () => handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n\r\n    window.addEventListener(\"resize\", func);\r\n    return () => window.removeEventListener(\"resize\", func)\r\n  }, [uuid, rowIdx, colIdx]);\r\n\r\n  useEffect(() => {\r\n    handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n  }, [uuid, rowIdx, colIdx, col, jsonStats, viewLayouts]);\r\n\r\n  const handleFullscreen = () => {\r\n    !isFullscreen\r\n      ? document.getElementById(`dashboard__view-container__${uuid}__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`).classList.add(\"dashboard__view-container--fullscreen\")\r\n      : document.getElementById(`dashboard__view-container__${uuid}__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`).classList.remove(\"dashboard__view-container--fullscreen\");\r\n    handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n\r\n    setFullscreen(!isFullscreen);\r\n  };\r\n\r\n  const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n  const jsonStat = jsonStats ? jsonStats[viewIdx] : null;\r\n  let layout = viewLayouts ? _.cloneDeep(viewLayouts[viewIdx]) : null;\r\n\r\n  const view = _.cloneDeep((dashboard.views || {})[col.value]);\r\n  const viewerIdx = view ? getViewerIdxFromType(view.defaultView) : null;\r\n\r\n  return (\r\n    <div className={classes.col} style={{width: `${col.widthPercentage}%`}}>\r\n      <div\r\n        id={`dashboard__view-container__${uuid}__${viewIdx}`}\r\n        className={classes.viewContainer}\r\n      >\r\n        {(col.type === DASHBOARD_ELEM_TYPE_VALUE_VIEW && jsonStat && layout) && (\r\n          <div style={{float: \"right\"}}>\r\n            <Tooltip title={t(\"components.dashboard.actions.download\")}>\r\n              <IconButton\r\n                color=\"primary\"\r\n                onClick={() => {\r\n                  if (viewerIdx === 0) {\r\n                    downloadCsv(view.nodeId, view.datasetId, localizeI18nObj(view.title, defaultLanguage, languages), view.criteria);\r\n                  } else if (viewerIdx === 1) {\r\n                    window.LMap.exportPng(mapId, `${localizeI18nObj(view.title, defaultLanguage, languages)}.png`)\r\n                  } else {\r\n                    exportChartJpeg(chartId, `${localizeI18nObj(view.title, defaultLanguage, languages)}.jpeg`);\r\n                  }\r\n                }}\r\n              >\r\n                <GetAppIcon/>\r\n              </IconButton>\r\n            </Tooltip>\r\n          </div>\r\n        )}\r\n        {(col.type === DASHBOARD_ELEM_TYPE_VALUE_TEXT || (jsonStat && layout)) && (\r\n          <div style={{float: \"right\"}}>\r\n            <Tooltip\r\n              title={isFullscreen\r\n                ? t(\"components.dashboard.actions.fullscreen.exit\")\r\n                : t(\"components.dashboard.actions.fullscreen.enter\")\r\n              }\r\n            >\r\n              <IconButton\r\n                color=\"primary\"\r\n                onClick={handleFullscreen}\r\n              >\r\n                {isFullscreen ? <FullscreenExitIcon/> : <FullscreenIcon/>}\r\n              </IconButton>\r\n            </Tooltip>\r\n          </div>\r\n        )}\r\n        {(() => {\r\n          if (col.type === DASHBOARD_ELEM_TYPE_VALUE_TEXT) {\r\n            return (\r\n              <div dangerouslySetInnerHTML={{__html: localizeI18nObj(col.value, defaultLanguage, languages)}}/>\r\n            )\r\n\r\n          } else if (jsonStats && viewLayouts) {\r\n\r\n            if (jsonStat === DASHBOARD_VIEW_STATE_ERROR) {\r\n              return (\r\n                <div className={classes.viewPlaceholder}>\r\n                  <CustomEmpty\r\n                    text={t(\"components.dashboard.fetchingDatasetError\")}\r\n                    backgroundColor={\"#f5f5f5\"}\r\n                  />\r\n                </div>\r\n              )\r\n\r\n            } else if (jsonStat === DASHBOARD_VIEW_STATE_APPLY_FILTERS) {\r\n              return (\r\n                <div className={classes.viewPlaceholder}>\r\n                  <CustomEmpty\r\n                    text={t(\"components.dashboard.applyFilters\")}\r\n                    backgroundColor={\"#f5f5f5\"}\r\n                  />\r\n                </div>\r\n              )\r\n\r\n            } else if (jsonStat === DASHBOARD_VIEW_STATE_FETCHING) {\r\n              return (\r\n                <div className={classes.viewPlaceholder}>\r\n                  <CustomEmpty\r\n                    text={t(\"components.dashboard.fetching\") + \"...\"}\r\n                    backgroundColor={\"#f5f5f5\"}\r\n                    image={<CircularProgress/>}\r\n                  />\r\n                </div>\r\n              )\r\n\r\n            } else if (jsonStat === \"\") {\r\n              return (\r\n                <div className={classes.viewPlaceholder}>\r\n                  <CustomEmpty\r\n                    text={t(\"components.dashboard.emptyView\")}\r\n                    backgroundColor={\"#f5f5f5\"}\r\n                  />\r\n                </div>\r\n              )\r\n\r\n            } else if (jsonStat && layout) {\r\n\r\n              const filter = col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY];\r\n              if (filter && filterValue) {\r\n                if ((layout.filters || []).includes(filter)) {\r\n                  layout.filtersValue = {\r\n                    ...layout.filtersValue,\r\n                    [filter]: filterValue\r\n                  };\r\n                } else if ((layout.primaryDim || []).includes(filter)) {\r\n                  layout.primaryDimValues = {\r\n                    ...layout.primaryDimValues,\r\n                    [filter]: filterValue\r\n                  };\r\n                } else if ((layout.secondaryDim || []).includes(filter)) {\r\n                  layout.secondaryDimValues = {\r\n                    ...layout.secondaryDimValues,\r\n                    [filter]: filterValue\r\n                  };\r\n                }\r\n              }\r\n\r\n              const staticFilters = [];\r\n              layout.filters.forEach(dim => {\r\n                if (jsonStat.size[jsonStat.id.indexOf(dim)] === 1) {\r\n                  staticFilters.push({\r\n                    dim: dim,\r\n                    dimLabel: getDimensionLabelFromJsonStat(jsonStat, dim),\r\n                    value: jsonStat.dimension[dim].category.index[0],\r\n                    valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, dim, jsonStat.dimension[dim].category.index[0])\r\n                  })\r\n                }\r\n              });\r\n              if (!col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY]) {\r\n                layout.filters.forEach(dim => {\r\n                  if (jsonStat.size[jsonStat.id.indexOf(dim)] !== 1) {\r\n                    staticFilters.push({\r\n                      dim: dim,\r\n                      dimLabel: getDimensionLabelFromJsonStat(jsonStat, dim),\r\n                      value: layout.filtersValue[dim],\r\n                      valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, dim, layout.filtersValue[dim])\r\n                    })\r\n                  }\r\n                });\r\n              }\r\n\r\n              return (\r\n                <Fragment>\r\n                  <div\r\n                    id={`dashboard__view-container__${uuid}__controllers__${viewIdx}`}\r\n                    className={classes.viewControllers}\r\n                  >\r\n                    {col[DASHBOARD_ELEM_SHOW_TITLE_KEY] && (\r\n                      <div className={classes.viewTitle}>\r\n                        {localizeI18nObj(view.title, defaultLanguage, languages)}\r\n                      </div>\r\n                    )}\r\n                    <div className={classes.viewStaticFilters}>\r\n                      {staticFilters.map(({dim, dimLabel, value, valueLabel}, idx) =>\r\n                        <div key={idx} className={classes.viewStaticFilter}>\r\n                          <b>{(dimLabel || dim)}</b>: <i>{(valueLabel || value)}</i>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    {col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY] && (\r\n                      <div className={classes.viewActiveFilters}>\r\n                        <DatasetFilters\r\n                          jsonStat={jsonStat}\r\n                          layout={layout}\r\n                          onSelect={(dimension, value) => onSelect(viewIdx, dimension, value)}\r\n                        />\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div\r\n                    id={`dashboard__view-container__${uuid}__view__${viewIdx}`}\r\n                    className={classes.view}\r\n                  >\r\n                    {(() => {\r\n                      if (viewerIdx === 0) {\r\n                        return (\r\n                          <JsonStatTable\r\n                            jsonStat={jsonStat}\r\n                            layout={layout}\r\n                            isFullscreen={isFullscreen}\r\n                            labelFormat={view.layouts.labelFormat}\r\n                            decimalSeparator={\",\"} // TODO\r\n                            decimalPlaces={view.decimalNumber} // TODO\r\n                            emptyChar={\"\"} // TODO\r\n                            hideSpinner\r\n                          />\r\n                        )\r\n                      } else if (viewerIdx === 1) {\r\n                        return (\r\n                          <Map\r\n                            mapId={mapId}\r\n                            jsonStat={jsonStat}\r\n                            mapLayout={layout}\r\n                            onGeometryFetch={idList => fetchMapGeometries(idList, viewIdx)}\r\n                            geometries={maps?.[viewIdx]?.geometries || null}\r\n                            geometryDetailLevels={maps?.[viewIdx]?.geometryDetailLevels || null}\r\n                            hideSpinner\r\n                          />\r\n                        )\r\n                      } else {\r\n                        return (\r\n                          <Chart\r\n                            chartId={chartId}\r\n                            type={view.defaultView}\r\n                            jsonStat={jsonStat}\r\n                            layout={layout}\r\n                            labelFormat={view.layouts.labelFormat}\r\n                            decimalSeparator={\",\"} // TODO\r\n                            decimalPlaces={view.decimalNumber} // TODO\r\n                          />\r\n                        )\r\n                      }\r\n                    })()}\r\n                  </div>\r\n                </Fragment>\r\n              )\r\n            } else {\r\n              return <span/>\r\n            }\r\n          } else {\r\n            return <span/>\r\n          }\r\n        })()}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst DashboardRow = ({\r\n                        t,\r\n                        classes,\r\n                        defaultLanguage,\r\n                        languages,\r\n                        dashboard,\r\n                        filterValue,\r\n                        row,\r\n                        rowIdx,\r\n                        jsonStats,\r\n                        viewLayouts,\r\n                        onSelect,\r\n                        maps,\r\n                        fetchMapGeometries,\r\n                        downloadCsv\r\n                      }) =>\r\n  <div className={classes.row}>\r\n    {row.map((col, idx) =>\r\n      <DashboardCol\r\n        key={idx}\r\n        t={t}\r\n        classes={classes}\r\n        defaultLanguage={defaultLanguage}\r\n        languages={languages}\r\n        dashboard={dashboard}\r\n        filterValue={filterValue}\r\n        rowIdx={rowIdx}\r\n        colIdx={idx}\r\n        col={col}\r\n        jsonStats={jsonStats}\r\n        viewLayouts={viewLayouts}\r\n        onSelect={onSelect}\r\n        maps={maps}\r\n        fetchMapGeometries={fetchMapGeometries}\r\n        downloadCsv={downloadCsv}\r\n      />\r\n    )}\r\n  </div>;\r\n\r\nfunction Dashboard(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    dashboard,\r\n    filterValue,\r\n    jsonStats,\r\n    maps,\r\n    fetchMapGeometries,\r\n    downloadCsv\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [viewLayouts, setViewLayouts] = useState(null);\r\n\r\n  useEffect(() => {\r\n    dashboard.dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col.type === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n          setViewLayouts(prevViewLayouts => {\r\n            const newViewLayouts = prevViewLayouts\r\n              ? _.cloneDeep(prevViewLayouts)\r\n              : {};\r\n\r\n            const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n            if (!jsonStats?.[viewIdx]?.id) {\r\n              return newViewLayouts;\r\n            }\r\n\r\n            const layouts = JSON.parse(dashboard.views[col.value].layouts);\r\n            let layout = (layouts.tableLayout || layouts.mapLayout || layouts.chartLayout);\r\n            layout = getFilteredLayoutObject(jsonStats[viewIdx], layout);\r\n\r\n            newViewLayouts[viewIdx] = layout;\r\n            return newViewLayouts;\r\n          });\r\n        }\r\n      })\r\n    })\r\n  }, [dashboard, jsonStats]);\r\n\r\n  const handleFilterSelect = (viewIdx, dimension, value) => {\r\n    setViewLayouts(prevViewLayouts => ({\r\n      ...prevViewLayouts,\r\n      [viewIdx]: getUpdatedLayout(jsonStats[viewIdx], prevViewLayouts[viewIdx], dimension, value)\r\n    }));\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      {(dashboard.dashboardConfig || []).map((row, idx) =>\r\n        <DashboardRow\r\n          key={idx}\r\n          t={t}\r\n          classes={classes}\r\n          defaultLanguage={defaultLanguage}\r\n          languages={languages}\r\n          dashboard={dashboard}\r\n          filterValue={filterValue}\r\n          row={row}\r\n          rowIdx={idx}\r\n          jsonStats={jsonStats}\r\n          viewLayouts={viewLayouts}\r\n          onSelect={handleFilterSelect}\r\n          maps={maps}\r\n          fetchMapGeometries={fetchMapGeometries}\r\n          downloadCsv={downloadCsv}\r\n        />\r\n      )}\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(Dashboard);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport {\r\n  changeOtherConfigDashboard,\r\n  clearOtherConfigDashboards,\r\n  clearOtherConfigDashboardsDataset,\r\n  clearOtherConfigDashboardViews,\r\n  closeOtherConfigDashboard,\r\n  createOtherConfigDashboard,\r\n  deleteOtherConfigDashboard,\r\n  fetchOtherConfigDashboards,\r\n  fetchOtherConfigDashboardsDataset,\r\n  fetchOtherConfigDashboardsMapGeometries,\r\n  fetchOtherConfigDashboardViews,\r\n  hideOtherConfigDashboard,\r\n  submitOtherConfigDashboardCreate,\r\n  submitOtherConfigDashboardUpdate,\r\n  updateOtherConfigDashboard\r\n} from \"../../../state/otherConfig/otherConfigActions\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {goToDashboard} from \"../../../links\";\r\nimport DashboardBuilder from \"../../dashboard-builder\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj, validateI18nObj} from \"../../../utils/i18n\";\r\nimport Call from \"../../../hocs/call\";\r\nimport Dashboard from \"../../dashboard\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../../utils/dashboards\";\r\nimport _ from \"lodash\"\r\nimport {MTableToolbar} from \"material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  needDashboards: state.otherConfig.needDashboards,\r\n  dashboards: state.otherConfig.dashboards,\r\n  dashboard: state.otherConfig.dashboard,\r\n  dashboardViews: state.otherConfig.dashboardViews,\r\n  dashboardJsonStats: state.otherConfig.dashboardJsonStats,\r\n  dashboardMaps: state.otherConfig.dashboardMaps\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboards: () => dispatch(fetchOtherConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearOtherConfigDashboards()),\r\n  createDashboard: dashboard => dispatch(createOtherConfigDashboard(dashboard)),\r\n  updateDashboard: dashboardId => dispatch(updateOtherConfigDashboard(dashboardId)),\r\n  changeDashboard: dashboard => dispatch(changeOtherConfigDashboard(dashboard)),\r\n  submitDashboardCreate: dashboard => dispatch(submitOtherConfigDashboardCreate(dashboard)),\r\n  submitDashboardUpdate: (dashboardId, dashboard) => dispatch(submitOtherConfigDashboardUpdate(dashboardId, dashboard)),\r\n  deleteDashboard: dashboardId => dispatch(deleteOtherConfigDashboard(dashboardId)),\r\n  hideDashboard: () => dispatch(hideOtherConfigDashboard()),\r\n  fetchViews: () => dispatch(fetchOtherConfigDashboardViews()),\r\n  clearViews: () => dispatch(clearOtherConfigDashboardViews()),\r\n  onClose: () => dispatch(closeOtherConfigDashboard()),\r\n  fetchDataset: (nodeId, datasetId, criteria, requestIds) => dispatch(fetchOtherConfigDashboardsDataset(nodeId, datasetId, criteria, requestIds)),\r\n  fetchMapGeometries: (idList, requestId) => dispatch(fetchOtherConfigDashboardsMapGeometries(idList, requestId)),\r\n  clearDatasets: () => dispatch(clearOtherConfigDashboardsDataset()),\r\n});\r\n\r\nconst getStaticDashboard = dashboard => {\r\n  if (!dashboard) {\r\n    return null\r\n  }\r\n\r\n  const staticDashboard = _.cloneDeep(dashboard);\r\n  staticDashboard.dashboardConfig.forEach(row => {\r\n    row.forEach(col => {\r\n      col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] = null\r\n    });\r\n  });\r\n\r\n  return staticDashboard\r\n};\r\n\r\nconst initialDashboard = {\r\n  title: {},\r\n  dashboardConfig: [],\r\n  viewIds: [],\r\n  views: {},\r\n  filterLevels: {}\r\n};\r\n\r\nconst UserDashboardsSettingsForm = ({\r\n                                      classes,\r\n                                      defaultLanguage,\r\n                                      languages,\r\n                                      nodes,\r\n                                      needDashboards,\r\n                                      dashboards,\r\n                                      dashboard,\r\n                                      fetchDashboards,\r\n                                      clearDashboards,\r\n                                      createDashboard,\r\n                                      updateDashboard,\r\n                                      changeDashboard,\r\n                                      submitDashboardCreate,\r\n                                      submitDashboardUpdate,\r\n                                      deleteDashboard,\r\n                                      hideDashboard,\r\n                                      dashboardViews,\r\n                                      fetchViews,\r\n                                      clearViews,\r\n                                      onClose,\r\n                                      dashboardJsonStats,\r\n                                      dashboardMaps,\r\n                                      fetchDataset,\r\n                                      fetchMapGeometries,\r\n                                      clearDatasets,\r\n                                      onDashboardsClose\r\n                                    }, ref) => {\r\n\r\n  const [deleteDashboardId, setDeleteDashboardId] = useState(null);\r\n  const [updateDashboardId, setUpdateDashboardId] = useState(null);\r\n\r\n  const [isPreviewVisible, setPreviewVisibility] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    fetchDashboards();\r\n  }, [fetchDashboards]);\r\n\r\n  useEffect(() => {\r\n    if (needDashboards) {\r\n      fetchDashboards();\r\n    }\r\n  }, [dashboards, needDashboards, fetchDashboards]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearDashboards();\r\n      onClose();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const handleFetchDatasets = () => {\r\n\r\n    const requests = [];\r\n    dashboard.dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n\r\n          const view = dashboard.views[col[DASHBOARD_ELEM_VALUE_KEY]];\r\n\r\n          let newCriteria = view.criteria;\r\n\r\n          const request = requests.find(({nodeId, datasetId, criteria}) => {\r\n            return (\r\n              nodeId === view.nodeId &&\r\n              datasetId === view.datasetId &&\r\n              _.isEqual(criteria, newCriteria)\r\n            )\r\n          });\r\n\r\n          if (request === undefined) {\r\n            requests.push({\r\n              nodeId: view.nodeId,\r\n              datasetId: view.datasetId.split(\"+\").join(\",\"),\r\n              criteria: newCriteria,\r\n              requestIds: [getViewIdxFromRowAndCol(rowIdx, colIdx)]\r\n            });\r\n          } else {\r\n            request.requestIds.push(getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n          }\r\n        }\r\n      });\r\n    });\r\n    requests.forEach(({nodeId, datasetId, criteria, requestIds}) => fetchDataset(nodeId, datasetId, criteria, requestIds));\r\n  };\r\n\r\n  return dashboards && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n          Toolbar: props =>\r\n            <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n              <Grid item>\r\n                <MTableToolbar {...props} />\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  size=\"small\"\r\n                  startIcon={<AddIcon/>}\r\n                  onClick={() => createDashboard(initialDashboard)}\r\n                >\r\n                  {t(\"scenes.dashboardsSettings.createDashboard\")}\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.dashboardsSettings.table.columns.dashboardTitle\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          }\r\n        ]}\r\n        data={dashboards}\r\n        actions={[\r\n          ({dashboardId}) => ({\r\n            icon: VisibilityIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.viewDashboard\"),\r\n            onClick: () => {\r\n              window.location.href.includes(`/dashboards/${dashboardId}`)\r\n                ? onDashboardsClose()\r\n                : goToDashboard(dashboardId)\r\n            }\r\n          }),\r\n          {\r\n            icon: EditIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.editDashboard\"),\r\n            onClick: (_, {dashboardId}) => {\r\n              updateDashboard(dashboardId);\r\n              setUpdateDashboardId(dashboardId);\r\n            }\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.deleteDashboard\"),\r\n            onClick: (_, {dashboardId}) => setDeleteDashboardId(dashboardId)\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 1,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteDashboardId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.dashboardsSettings.modals.deleteDashboard.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.dashboardsSettings.modals.deleteDashboard.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            autoFocus\r\n            onClick={() => setDeleteDashboardId(null)}\r\n          >\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button\r\n            onClick={() => {\r\n              deleteDashboard(deleteDashboardId);\r\n              setDeleteDashboardId(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={dashboard !== null}\r\n        fullScreen\r\n        onClose={hideDashboard}\r\n      >\r\n        <DialogTitle>\r\n          {updateDashboardId\r\n            ? t(\"scenes.dashboardsSettings.modals.updateDashboard.title\")\r\n            : t(\"scenes.dashboardsSettings.modals.createDashboard.title\")\r\n          }\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <DashboardBuilder\r\n            nodes={nodes}\r\n            dashboard={dashboard}\r\n            onChange={changeDashboard}\r\n            views={dashboardViews}\r\n            fetchViews={fetchViews}\r\n            onViewsHide={clearViews}\r\n            jsonStats={dashboardJsonStats}\r\n            fetchDataset={fetchDataset}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              hideDashboard();\r\n              setUpdateDashboardId(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n          <Button\r\n            onClick={() => setPreviewVisibility(true)}\r\n          >\r\n            {t(\"commons.confirm.preview\")}\r\n          </Button>\r\n          <Button\r\n            onClick={updateDashboardId\r\n              ? () => submitDashboardUpdate(updateDashboardId, dashboard)\r\n              : () => {\r\n                submitDashboardCreate(dashboard);\r\n                hideDashboard();\r\n              }\r\n            }\r\n            disabled={dashboard && !validateI18nObj(dashboard.title)}\r\n          >\r\n            {t(\"commons.confirm.save\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isPreviewVisible}\r\n        fullScreen\r\n        onClose={() => setPreviewVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.preview.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Call cb={handleFetchDatasets}>\r\n            <Dashboard\r\n              dashboard={getStaticDashboard(dashboard)}\r\n              jsonStats={dashboardJsonStats}\r\n              maps={dashboardMaps}\r\n              fetchMapGeometries={(idList, requestId) => fetchMapGeometries(idList, requestId)}\r\n            />\r\n          </Call>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              setPreviewVisibility(false);\r\n              clearDatasets();\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserDashboardsSettingsForm);","import React, {Fragment} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport ViewsSettingsForm from \"./views-settings-form\";\r\nimport WorkIcon from '@material-ui/icons/Work';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {canDisplayUserViews, canManagePersonalDashboards} from \"../../utils/user\";\r\nimport UserDashboardsSettingsForm from \"./user-dashboards-settings-form\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  option: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nclass OtherSettingsSelect extends React.Component {\r\n\r\n  state = {\r\n    isViewsOpen: false,\r\n    isDashboardsOpen: false,\r\n    viewsSettigsRef: React.createRef(),\r\n    dashboardsSettingsRef: React.createRef()\r\n  };\r\n\r\n  onViewsOpen = () => this.setState({\r\n    ...this.state,\r\n    isViewsOpen: true\r\n  });\r\n\r\n  onViewsClose = () => this.setState({\r\n    ...this.state,\r\n    isViewsOpen: false\r\n  });\r\n\r\n  onDashboardsOpen = () => this.setState({\r\n    ...this.state,\r\n    isDashboardsOpen: true\r\n  });\r\n\r\n  onDashboardsClose = () => this.setState({\r\n    ...this.state,\r\n    isDashboardsOpen: false\r\n  });\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      nodes,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {\r\n      isViewsOpen,\r\n      isDashboardsOpen,\r\n      viewsSettigsRef,\r\n      dashboardsSettingsRef\r\n    } = this.state;\r\n\r\n    return (\r\n      <Fragment>\r\n        <ButtonSelect value=\"\" icon={<WorkIcon/>}>\r\n          {canDisplayUserViews(user) && (\r\n            <div onClick={this.onViewsOpen} className={classes.option}>{t(\"components.header.otherSettings.views\")}</div>\r\n          )}\r\n          {canManagePersonalDashboards(user) && (\r\n            <div onClick={this.onDashboardsOpen} className={classes.option}>{t(\"components.header.otherSettings.dashboards\")}</div>\r\n          )}\r\n        </ButtonSelect>\r\n        <SettingsDialog\r\n          title={t(\"scenes.viewsSettings.title\")}\r\n          open={isViewsOpen}\r\n          onClose={() => {\r\n            if (viewsSettigsRef.current) {\r\n              viewsSettigsRef.current.cancel(() => this.onViewsClose());\r\n            } else {\r\n              this.onViewsClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <ViewsSettingsForm ref={viewsSettigsRef} nodes={nodes}/>\r\n        </SettingsDialog>\r\n        <SettingsDialog\r\n          title={t(\"scenes.dashboardsSettings.title\")}\r\n          open={isDashboardsOpen}\r\n          onClose={() => {\r\n            if (dashboardsSettingsRef.current) {\r\n              dashboardsSettingsRef.current.cancel(() => this.onDashboardsClose());\r\n            } else {\r\n              this.onDashboardsClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <UserDashboardsSettingsForm ref={dashboardsSettingsRef} nodes={nodes}\r\n                                      onDashboardsClose={this.onDashboardsClose}/>\r\n        </SettingsDialog>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps),\r\n  withTranslation()\r\n)(OtherSettingsSelect);","import React from 'react';\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport {useLocation} from \"react-router\";\r\n\r\nconst mapStateToProps = state => ({\r\n  language: state.app.language\r\n});\r\n\r\nconst AppLanguageSelect = ({language}) => {\r\n\r\n  const location = useLocation();\r\n\r\n  return (\r\n    <I18nInputAdornmentSelect\r\n      value={language}\r\n      onChange={val => {\r\n        window.open(\"./#\" + location.pathname.replace(language, val), \"_self\");\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps)(AppLanguageSelect);","import {Link, withStyles} from \"@material-ui/core\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport React, {Component} from \"react\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport UserSelect from \"../user-select\";\r\nimport Drawer from \"@material-ui/core/Drawer\";\r\nimport ChevronLeftIcon from \"@material-ui/icons/ChevronLeft\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport CategoriesTree from \"../categories-tree\";\r\nimport {withRouter} from \"react-router\";\r\nimport SettingsSelect from \"../settings-select\";\r\nimport SearchDialog from \"../search-dialog\";\r\nimport ButtonSelect from \"../button-select\";\r\nimport {goToDatasetsSearch, goToHome, goToNode, goToNodeDashboards} from \"../../links\";\r\nimport HomeIcon from '@material-ui/icons/Home';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport OtherSettingsSelect from \"../other-settings-select\";\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport {\r\n  canClearServerCache,\r\n  canDisplayAppSettingsForm,\r\n  canDisplayNodesSettingsForm,\r\n  canDisplayUsersSettingsForm,\r\n  canDisplayUserViews,\r\n  canGetQueryLog,\r\n  canManagePersonalDashboards\r\n} from \"../../utils/user\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport AppLanguageSelect from \"../app-language-select\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"fixed\",\r\n    width: \"100%\",\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n    display: 'none',\r\n    [theme.breakpoints.up('sm')]: {\r\n      display: 'block',\r\n    },\r\n    color: \"white\"\r\n  },\r\n  leftToolbar: {\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  leftContainer: {\r\n    width: \"calc((100% - 296px)/2)\"\r\n  },\r\n  rightContainer: {\r\n    width: \"calc((100% - 296px)/2)\"\r\n  },\r\n  drawer: {\r\n    minWidth: 448\r\n  },\r\n  drawerHeader: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    padding: theme.spacing(0, 1),\r\n    ...theme.mixins.toolbar,\r\n    justifyContent: 'flex-end',\r\n  },\r\n  drawerHeaderTitle: {\r\n    position: \"absolute\",\r\n    left: theme.spacing(2),\r\n  },\r\n  drawerCategories: {\r\n    margin: theme.spacing(2)\r\n  },\r\n  drawerCategoriesTitle: {\r\n    marginBottom: theme.spacing(2)\r\n  },\r\n  goToHome: {\r\n    margin: theme.spacing(2, 2, 0, 2)\r\n  },\r\n  centerContainer: {\r\n    width: 280,\r\n    textAlign: \"center\"\r\n  },\r\n  sistanLogo: {\r\n    width: 32,\r\n    height: 32,\r\n    transform: \"translateY(3px)\"\r\n  }\r\n});\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL,\r\n  user: state.user,\r\n});\r\n\r\nclass NodeHeader extends Component {\r\n\r\n  state = {\r\n    isDrawerOpen: this.props.defaultTreeOpen || false\r\n  };\r\n\r\n  onDrawerOpen = () => {\r\n    this.setState({\r\n      isDrawerOpen: true\r\n    });\r\n  };\r\n\r\n  onDrawerClose = () => {\r\n    this.setState({\r\n      isDrawerOpen: false\r\n    });\r\n  };\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      selectedCategoryPath,\r\n      shortName,\r\n      title,\r\n      defaultAppConfigOpen,\r\n      defaultUsersConfigOpen,\r\n      defaultNodesConfigOpen,\r\n      defaultNodeConfigOpen,\r\n      nodes,\r\n      noNode,\r\n      catalog,\r\n      node,\r\n      query,\r\n      hub,\r\n      baseURL,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isDrawerOpen} = this.state;\r\n\r\n    return (\r\n      <div className={classes.root} id=\"node-header\">\r\n        <AppBar position=\"static\" color=\"primary\">\r\n          <Grid container justify=\"space-between\" alignItems=\"center\">\r\n            <Grid item className={classes.leftContainer}>\r\n              {!noNode && (\r\n                <Toolbar className={classes.leftToolbar}>\r\n                  <Grid container spacing={1} alignItems=\"center\">\r\n                    <Grid item>\r\n                      <IconButton\r\n                        className={classes.menuButton}\r\n                        edge=\"start\"\r\n                        color=\"inherit\"\r\n                        onClick={this.onDrawerOpen}\r\n                      >\r\n                        <MenuIcon/>\r\n                      </IconButton>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <ButtonSelect\r\n                        value={\r\n                          <Typography variant=\"h6\" color=\"inherit\">\r\n                            {shortName}\r\n                          </Typography>\r\n                        }\r\n                        onChange={code => goToNode(code.toLowerCase())}\r\n                      >\r\n                        {nodes.sort((a, b) => a.order - b.order).map(({code, name}, i) =>\r\n                          <span key={i} data-value={code}>\r\n                            {code} - {name}\r\n                          </span>\r\n                        )}\r\n                      </ButtonSelect>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Toolbar>\r\n              )}\r\n            </Grid>\r\n            <Grid item className={classes.centerContainer}>\r\n              <Link onClick={goToHome} style={{cursor: \"pointer\"}}>\r\n                <Grid container spacing={2} alignItems=\"center\" justify=\"center\">\r\n                  {hub.logoURL && (\r\n                    <Grid item>\r\n                      <img src={baseURL + hub.logoURL} alt={hub.name} className={classes.sistanLogo}/>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid item>\r\n                    <Typography variant=\"h6\" color=\"secondary\">\r\n                      {hub.name}\r\n                    </Typography>\r\n                  </Grid>\r\n                </Grid>\r\n              </Link>\r\n            </Grid>\r\n            <Grid item className={classes.rightContainer}>\r\n              <Toolbar>\r\n                <Grid container justify=\"flex-end\" alignItems=\"center\" spacing={1}>\r\n                  {!noNode && (\r\n                    <div>\r\n                      <SearchDialog\r\n                        query={query}\r\n                        modalWidth={320}\r\n                        dialogTop={56}\r\n                        onSubmit={value => goToDatasetsSearch(node.code, value)}\r\n                      />\r\n                    </div>\r\n                  )}\r\n                  <Grid item id=\"language-btn\">\r\n                    <AppLanguageSelect/>\r\n                  </Grid>\r\n                  {!noNode && node && node.dashboards && node.dashboards.length > 0 && (\r\n                    <Grid item id=\"dashboards-btn\">\r\n                      <IconButton onClick={() => goToNodeDashboards(node.code)} color=\"inherit\">\r\n                        <DashboardIcon/>\r\n                      </IconButton>\r\n                    </Grid>\r\n                  )}\r\n                  {(canDisplayAppSettingsForm(user) ||\r\n                    canDisplayUsersSettingsForm(user) ||\r\n                    canDisplayNodesSettingsForm(user) ||\r\n                    canGetQueryLog(user) ||\r\n                    canClearServerCache(user)\r\n                  ) && (\r\n                    <Grid item id=\"admin-settings-btn\">\r\n                      <SettingsSelect\r\n                        defaultAppOpen={defaultAppConfigOpen}\r\n                        defaultNodesOpen={defaultNodesConfigOpen}\r\n                        defaultUsersOpen={defaultUsersConfigOpen}\r\n                        defaultNodeOpen={defaultNodeConfigOpen}\r\n                        nodes={nodes}\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                  {(canDisplayUserViews(user) || canManagePersonalDashboards(user)) && (\r\n                    <Grid item id=\"other-settings-btn\">\r\n                      <OtherSettingsSelect nodes={nodes}/>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid item id=\"user-settings-btn\">\r\n                    <UserSelect/>\r\n                  </Grid>\r\n                </Grid>\r\n              </Toolbar>\r\n            </Grid>\r\n          </Grid>\r\n        </AppBar>\r\n        {!noNode && (\r\n          <Drawer\r\n            anchor=\"left\"\r\n            open={isDrawerOpen}\r\n            classes={{\r\n              paper: classes.drawer\r\n            }}\r\n            onClose={this.onDrawerClose}\r\n          >\r\n            <div className={classes.drawerHeader}>\r\n              <Typography variant=\"h6\" className={classes.drawerHeaderTitle}>\r\n                {title}\r\n              </Typography>\r\n              <IconButton onClick={this.onDrawerClose}>\r\n                <ChevronLeftIcon/>\r\n              </IconButton>\r\n            </div>\r\n            <Divider/>\r\n            <div className={classes.goToHome}>\r\n              <Link underline=\"none\" onClick={() => goToNode(node.code)} style={{cursor: \"pointer\"}}>\r\n                <Grid container spacing={1}>\r\n                  <Grid item>\r\n                    <HomeIcon/>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <Typography>\r\n                      {t(\"components.header.drawer.backToNodeHome\")}\r\n                    </Typography>\r\n                  </Grid>\r\n                </Grid>\r\n              </Link>\r\n            </div>\r\n            {catalog && (\r\n              <div className={classes.drawerCategories}>\r\n                <div className={classes.drawerCategoriesTitle}>\r\n                  <Typography>\r\n                    {t(\"components.header.drawer.categoriesTitle\")}\r\n                  </Typography>\r\n                </div>\r\n                <CategoriesTree selectedCategoryPath={selectedCategoryPath} catalog={catalog} node={node}\r\n                                onClose={this.onDrawerClose}/>\r\n              </div>\r\n            )}\r\n          </Drawer>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps),\r\n  withRouter\r\n)(NodeHeader);","import Grid from \"@material-ui/core/Grid\";\r\nimport React from \"react\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  image: {\r\n    height: 20,\r\n    margin: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst Footer = ({classes, textOnly}) =>\r\n  <Grid container type=\"flex\" justify=\"center\" alignItems=\"center\">\r\n    <Grid item>\r\n      {textOnly\r\n        ? <span>ISTAT&nbsp;</span>\r\n        : (\r\n          <img src=\"images/istat/istat-logo-gray.png\" className={classes.image} alt=\"istat logo\"/>\r\n        )}\r\n    </Grid>\r\n    <Grid item>\r\n      Data Browser v0.9\r\n    </Grid>\r\n  </Grid>;\r\n\r\nexport default withStyles(styles)(Footer);","import React, {Component} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Hero from \"../hero\";\r\nimport CardsGrid from \"../cards-grid\";\r\nimport PageSection from \"../page-section\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Page from \"../page\";\r\nimport NodeHeader from \"../node-header\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport {goToHubDashboards, goToNode} from \"../../links\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Footer from \"../footer\";\r\n\r\nconst styles = theme => ({\r\n  appBar: {\r\n    transition: \"opacity 1s\",\r\n  },\r\n  toolbarButtons: {\r\n    marginLeft: \"auto\",\r\n    '& > *': {\r\n      marginRight: theme.spacing(1)\r\n    }\r\n  },\r\n  anchorContainer: {\r\n    position: \"relative\"\r\n  },\r\n  anchor: {\r\n    position: \"absolute\",\r\n    top: -theme.mixins.toolbar.minHeight\r\n  },\r\n  fullWidthContainer: {\r\n    backgroundColor: \"white\",\r\n    width: \"100%\"\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(3),\r\n    width: 1024,\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  footer: {\r\n    paddingTop: theme.spacing(4)\r\n  },\r\n  footerContent: {\r\n    paddingTop: theme.spacing(2)\r\n  },\r\n  nodesContainer: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  centerContainer: {\r\n    width: 316,\r\n    textAlign: \"center\"\r\n  },\r\n  sistanLogo: {\r\n    width: 32,\r\n    height: 32,\r\n    transform: \"translateY(3px)\"\r\n  },\r\n  leftContainer: {\r\n    width: \"calc((100% - 316px)/2)\"\r\n  },\r\n  rightContainer: {\r\n    width: \"calc((100% - 316px)/2)\"\r\n  },\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL\r\n});\r\n\r\nclass Home extends Component {\r\n\r\n  info = React.createRef();\r\n  nodesRef = React.createRef();\r\n  dashboard = React.createRef();\r\n  // explore = React.createRef();\r\n\r\n  state = {\r\n    isListMode: true,\r\n  };\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true,\r\n    });\r\n  }\r\n\r\n  /*  onListModeToggle = () => {\r\n      this.setState({isListMode: !this.state.isListMode});\r\n    };*/\r\n\r\n  render() {\r\n\r\n    const {classes, hub, baseURL, t} = this.props;\r\n    // const {isListMode} = this.state;\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          noNode\r\n          defaultNodeConfigOpen={this.props.defaultNodeConfigOpen}\r\n          defaultAppConfigOpen={this.props.defaultAppConfigOpen}\r\n          defaultUserConfigOpen={this.props.defaultUserConfigOpen}\r\n          defaultNodesConfigOpen={this.props.defaultNodesConfigOpen}\r\n          hub={hub.hub}\r\n          nodes={hub.nodes}\r\n        />\r\n        <Hero\r\n          title={hub.hub.name}\r\n          slogan={hub.hub.slogan}\r\n          logo={hub.hub.logoURL && <img src={baseURL + hub.hub.logoURL} alt={hub.hub.name}/>}\r\n          background={\r\n            hub.hub.backgroundMediaURL\r\n              ? (hub.hub.backgroundMediaURL.match(/\\.(jpeg|jpg|gif|png|JPEG|JPG|GIF|PNG)$/)\r\n                ? <img src={baseURL + hub.hub.backgroundMediaURL} alt={hub.hub.name}/>\r\n                : (\r\n                  <video autoPlay muted loop>\r\n                    <source src={baseURL + hub.hub.backgroundMediaURL}/>\r\n                  </video>\r\n                )\r\n              ) : <video autoPlay muted loop>\r\n                <source src=\"./videos/landing-background.mp4\"/>\r\n              </video>\r\n          }\r\n        >\r\n          {hub.hub.description && hub.hub.description.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.info)}>\r\n              {t(\"scenes.hub.informations\")}\r\n            </Button>\r\n          )}\r\n          <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                  onClick={() => this.scroll(this.nodesRef)}>\r\n            {t(\"scenes.hub.nodes\")}\r\n          </Button>\r\n          {hub.hub.dashboards && hub.hub.dashboards.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\" onClick={goToHubDashboards}>\r\n              {t(\"scenes.hub.dashboards\")}\r\n            </Button>\r\n          )}\r\n        </Hero>\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            {hub.hub.description && hub.hub.description.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.info}/>\r\n                <PageSection className={classes.section}\r\n                             sectiontitle={t(\"scenes.hub.informations\")}>\r\n                  <Box textAlign=\"justify\">\r\n                    <Box dangerouslySetInnerHTML={{__html: hub.hub.description}}/>\r\n                  </Box>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n            <div className={classes.anchorContainer}>\r\n              <div className={classes.anchor} ref={this.nodesRef}/>\r\n              <PageSection className={classes.section} sectiontitle={t(\"scenes.hub.nodes\")}>\r\n                <Box className={classes.nodesContainer}>\r\n                  <CardsGrid\r\n                    list={hub.nodes.sort((a, b) => a.order - b.order).map(({code, name, backgroundMediaURL}) => ({\r\n                      code,\r\n                      id: code,\r\n                      label: name,\r\n                      image: backgroundMediaURL ? baseURL + backgroundMediaURL : \"./images/istat/istat-background.jpg\"\r\n                    }))}\r\n                    onClick={node => goToNode(node.code.toLowerCase())}\r\n                  />\r\n                </Box>\r\n              </PageSection>\r\n            </div>\r\n            <div className={classes.footer}>\r\n              <Divider/>\r\n              <div className={classes.footerContent}>\r\n                <Footer/>\r\n              </div>\r\n            </div>\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps)\r\n)(Home);","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getHubMinimalInfoUrl} from \"../../serverApi/urls\";\r\n\r\nexport const HUB_FETCH = \"hub/fetch\";\r\n\r\nexport const fetchHub = () => initRequest(\r\n  HUB_FETCH,\r\n  getHubMinimalInfoUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"domains.hub.messages.fetch.start\")\r\n  })\r\n);","import React, {Fragment} from 'react';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {Link} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  list: {\r\n    paddingLeft: theme.spacing(1),\r\n    paddingRight: theme.spacing(1)\r\n  },\r\n  cardContainer: {\r\n    position: \"relative\"\r\n  },\r\n  card: {\r\n    height: \"100%\",\r\n    backgroundColor: theme.palette.background.default\r\n  },\r\n  item: {\r\n    padding: 0\r\n  },\r\n  link: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\nconst CategoriesLists = ({classes, categories, onClick}) => {\r\n\r\n  const rows = [];\r\n\r\n  const chunkSize = 3;\r\n\r\n  for (let i = 0; i < categories.length; i += chunkSize) {\r\n\r\n    const categoriesChunk = categories.slice(i, i + chunkSize);\r\n\r\n    /* first level */\r\n    rows.push(\r\n      <Grid key={i} container spacing={2}>\r\n        {categoriesChunk.map((rootCategory, i) =>\r\n          <Grid item key={i} xs={4}>\r\n            <Typography variant=\"h5\" className={classes.title} style={{fontSize: 20}}>\r\n              {rootCategory.datasetIdentifiers?.length > 0\r\n                ? (\r\n                  <Link onClick={() => onClick([rootCategory.id])} className={classes.link}>\r\n                    {rootCategory.label} ({rootCategory.datasetIdentifiers.length})\r\n                  </Link>\r\n                ) : rootCategory.label\r\n              }\r\n            </Typography>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n\r\n    const fontSizes = [18, 16, 15, 14];\r\n\r\n    /* recursively renders subtree of categories */\r\n    const Subtree = ({root, depth, fontSizes, parentPath = []}) =>\r\n      root.childrenCategories && (\r\n        <div className={classes.card}>\r\n          <List className={classes.list}>\r\n            {root.childrenCategories.map((child, i) =>\r\n              <Fragment key={i}>\r\n                <ListItem className={classes.item}>\r\n                  <ListItemText\r\n                    primary={\r\n                      <Typography style={{fontSize: fontSizes[0]}}>\r\n                        {child.datasetIdentifiers?.length > 0\r\n                          ? (\r\n                            <Link onClick={() => onClick([...parentPath, root.id, child.id])} className={classes.link}>\r\n                              {child.label} ({child.datasetIdentifiers.length})\r\n                            </Link>\r\n                          ) : child.label}\r\n                      </Typography>\r\n                    }\r\n                  />\r\n                </ListItem>\r\n                {/* recursion on subtree of child category */}\r\n                {depth > 1 && (\r\n                  <Subtree\r\n                    root={child}\r\n                    depth={depth - 1}\r\n                    fontSizes={fontSizes.slice(1)}\r\n                    parentPath={[...parentPath, root.id]}\r\n                  />\r\n                )}\r\n              </Fragment>\r\n            )}\r\n          </List>\r\n        </div>\r\n      );\r\n\r\n    /* 4 levels subtree */\r\n    rows.push(\r\n      <Grid key={i + 1} container spacing={2}>\r\n        {categoriesChunk.map((rootCategory, i) =>\r\n          <Grid item key={i} xs={4} className={classes.cardContainer}>\r\n            <Subtree root={rootCategory} depth={4} fontSizes={fontSizes}/>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  return rows;\r\n};\r\n\r\nexport default withStyles(styles)(CategoriesLists);\r\n","import React, {Component} from 'react';\r\nimport Hero from \"../hero\";\r\nimport CardsGrid from \"../cards-grid\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport PageSection from \"../page-section\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport NodeHeader from \"../node-header\";\r\nimport Page from \"../page\";\r\nimport {goToDatasets, goToNodeDashboards} from \"../../links\";\r\nimport CategoriesLists from \"../../components/categories-lists\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  anchor: {\r\n    position: \"absolute\",\r\n    top: -theme.mixins.toolbar.minHeight\r\n  },\r\n  anchorContainer: {\r\n    position: \"relative\"\r\n  },\r\n  fullWidthContainer: {\r\n    backgroundColor: \"white\",\r\n    width: \"100%\",\r\n    minHeight: \"100%\"\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(3),\r\n    width: 1024,\r\n  },\r\n  categoriesContainer: {\r\n    paddingTop: theme.spacing(2)\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  categorySchemesTabs: {\r\n    marginBottom: theme.spacing(2)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL\r\n});\r\n\r\nclass Node extends Component {\r\n\r\n  state = {\r\n    configIsListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5,\r\n    isListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5,\r\n    categorySchemeTab: 0\r\n  };\r\n\r\n  info = React.createRef();\r\n  nodes = React.createRef();\r\n  dashboard = React.createRef();\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true\r\n    });\r\n  }\r\n\r\n  onListModeToggle = () => {\r\n    this.setState({isListMode: !this.state.isListMode});\r\n  };\r\n\r\n  setCategorySchemeTab = tab => {\r\n    this.setState({categorySchemeTab: tab});\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n\r\n    const configIsListMode = props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5;\r\n\r\n    if (configIsListMode !== state.configIsListMode) {\r\n      return {\r\n        ...state,\r\n        configIsListMode,\r\n        isListMode: configIsListMode\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      light,\r\n      defaultTreeOpen,\r\n      defaultNodeConfigOpen,\r\n      defaultAppConfigOpen,\r\n      defaultUserConfigOpen,\r\n      defaultNodesConfigOpen,\r\n      node,\r\n      nodeCode,\r\n      hub,\r\n      catalog,\r\n      baseURL,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isListMode, categorySchemeTab} = this.state;\r\n\r\n    const nodeMinimalInfo = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n\r\n    const uncategorizedCategory = {\r\n      id: \"uncategorized\",\r\n      label: t(\"commons.catalog.uncategorized\"),\r\n      childrenCategories: [],\r\n      datasetIdentifiers: catalog?.uncategorizedDatasets.map(({identifier}) => identifier)\r\n    };\r\n\r\n    const categoriesForExplore =\r\n      catalog\r\n        ? (\r\n          catalog.categoryGroups.length > 1\r\n            ? (\r\n              categorySchemeTab === \"uncategorized\"\r\n                ? [uncategorizedCategory]\r\n                : catalog.categoryGroups[categorySchemeTab].categories.map(c => ({\r\n                  ...c,\r\n                  image: c.image ? baseURL + c.image : undefined\r\n                }))\r\n            )\r\n            : (\r\n              catalog.uncategorizedDatasets.length > 0\r\n                ? catalog.categoryGroups[0]?.categories.map(c => ({\r\n                ...c,\r\n                image: c.image ? baseURL + c.image : undefined\r\n              })).concat([uncategorizedCategory]) || [uncategorizedCategory]\r\n                : catalog.categoryGroups[0]?.categories.map(c => ({\r\n                ...c,\r\n                image: c.image ? baseURL + c.image : undefined\r\n              })) || []\r\n            ))\r\n        : [];\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          hub={hub.hub}\r\n          nodes={hub.nodes}\r\n          catalog={catalog}\r\n          defaultTreeOpen={defaultTreeOpen}\r\n          shortName={nodeCode}\r\n          title={nodeMinimalInfo.name}\r\n          node={node}\r\n          defaultNodeConfigOpen={defaultNodeConfigOpen}\r\n          defaultAppConfigOpen={defaultAppConfigOpen}\r\n          defaultUserConfigOpen={defaultUserConfigOpen}\r\n          defaultNodesConfigOpen={defaultNodesConfigOpen}\r\n          nodeId={nodeMinimalInfo.nodeId}\r\n        />\r\n        <Hero\r\n          light={light}\r\n          title={nodeMinimalInfo.name}\r\n          slogan={node && node.slogan}\r\n          logo={node && nodeMinimalInfo.logoURL &&\r\n          <img src={baseURL + nodeMinimalInfo.logoURL} alt={nodeMinimalInfo.name}/>}\r\n          background={\r\n            nodeMinimalInfo.backgroundMediaURL\r\n              ? (\r\n                nodeMinimalInfo.backgroundMediaURL.match(/\\.(jpeg|jpg|gif|png|JPEG|JPG|GIF|PNG)$/)\r\n                  ? <img src={baseURL + nodeMinimalInfo.backgroundMediaURL} alt={nodeMinimalInfo.name}/>\r\n                  : (\r\n                    <video autoPlay muted loop>\r\n                      <source src={baseURL + nodeMinimalInfo.backgroundMediaURL}/>\r\n                    </video>\r\n                  )\r\n              )\r\n              : <img src=\"./images/istat/istat-background.jpg\" alt={nodeMinimalInfo.name}/>\r\n          }\r\n        >\r\n          {node && node.description && node.description.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.info)}>\r\n              {t(\"scenes.node.informations\")}\r\n            </Button>\r\n          )}\r\n          {catalog && categoriesForExplore.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.nodes)}>\r\n              {t(\"scenes.node.explore\")}\r\n            </Button>\r\n          )}\r\n          {nodeMinimalInfo.dashboards && nodeMinimalInfo.dashboards.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => goToNodeDashboards(nodeCode)}>\r\n              {t(\"scenes.node.dashboards\")}\r\n            </Button>\r\n          )}\r\n        </Hero>\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            {node && node.description && node.description.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.info}/>\r\n                <PageSection className={classes.section} sectiontitle={t(\"scenes.node.informations\")}>\r\n                  <Box textAlign=\"justify\">\r\n                    <Box dangerouslySetInnerHTML={{__html: node.description}}/>\r\n                  </Box>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n            {catalog && categoriesForExplore.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.nodes}/>\r\n                <PageSection className={classes.section} sectiontitle={t(\"scenes.node.explore\")}>\r\n                  <div className={classes.categoriesContainer}>\r\n                    {catalog.categoryGroups.length > 1 && (\r\n                      <Tabs\r\n                        value={categorySchemeTab}\r\n                        onChange={(_, tab) => this.setCategorySchemeTab(tab)}\r\n                        className={classes.categorySchemesTabs}\r\n                      >\r\n                        {catalog.categoryGroups.map(({label}, index) =>\r\n                          <Tab value={index} label={label} key={index}/>\r\n                        )}\r\n                        {catalog.uncategorizedDatasets?.length > 0 && (\r\n                          <Tab value=\"uncategorized\" label={t(\"commons.catalog.uncategorized\")}\r\n                               key=\"uncategorized\"/>\r\n                        )}\r\n                      </Tabs>\r\n                    )}\r\n                    {isListMode\r\n                      ? (\r\n                        <CategoriesLists\r\n                          categories={categoriesForExplore}\r\n                          onClick={\r\n                            categoryPath =>\r\n                              goToDatasets(\r\n                                node.code,\r\n                                categoryPath[0] === \"uncategorized\"\r\n                                  ? [\"uncategorized\"]\r\n                                  : catalog.categoryGroups.length > 1 ? [catalog.categoryGroups[categorySchemeTab].id, ...categoryPath] : categoryPath\r\n                              )\r\n                          }\r\n                        />\r\n                      )\r\n                      : (\r\n                        <CardsGrid\r\n                          squareImage\r\n                          list={categoriesForExplore}\r\n                          onClick={\r\n                            category =>\r\n                              goToDatasets(\r\n                                node.code,\r\n                                category.id === \"uncategorized\"\r\n                                  ? [\"uncategorized\"]\r\n                                  : catalog.categoryGroups.length > 1 ? [catalog.categoryGroups[categorySchemeTab].id, category.id] : [category.id]\r\n                              )\r\n                          }\r\n                        />\r\n                      )\r\n                    }\r\n                  </div>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps)\r\n)(Node);","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getNodeUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_FETCH = \"node/fetch\";\r\n\r\nexport const fetchNode = (nodeId: number) =>\r\n  initRequest(\r\n    NODE_FETCH,\r\n    getNodeUrl(nodeId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n      onStart: t(\"domains.node.messages.fetch.start\")\r\n    })\r\n  );","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getNodeCatalogUrl} from \"../../serverApi/urls\";\r\n\r\nexport const CATALOG_FETCH = \"catalog/fetch\";\r\n\r\nexport const fetchCatalog = (nodeId: number) => initRequest(\r\n  CATALOG_FETCH,\r\n  getNodeCatalogUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"domains.catalog.messages.fetch.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n","import React, {useState} from \"react\";\r\nimport TreeItem from \"@material-ui/lab/TreeItem\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport TreeView from \"@material-ui/lab/TreeView\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\r\nimport {goToDatasetsSearch} from \"../../links\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\n\r\nconst styles = () => ({\r\n  container: {\r\n    background: \"#F5F5F5\",\r\n    paddingTop: 8,\r\n    paddingBottom: 8\r\n  },\r\n  nodeIcon: {\r\n    marginTop: 5\r\n  },\r\n  item: {\r\n    background: \"none !important\"\r\n  },\r\n  resCount: {\r\n    fontWeight: \"bold\",\r\n    marginLeft: 4\r\n  },\r\n  checkbox: {\r\n    padding: 0,\r\n    transform: \"translateY(-2px)\"\r\n  }\r\n});\r\n\r\nfunction ResultTree(props) {\r\n  const {\r\n    classes,\r\n    catalog,\r\n    query,\r\n    node,\r\n    filters = [],\r\n    categoryGroupsWithCount,\r\n    uncategorizedDatasetsCount,\r\n    t\r\n  } = props;\r\n\r\n  const [expanded, setExpanded] = useState([]);\r\n\r\n  const getTreeItems = (tree, prevPath) =>\r\n    tree.map((cat, i) => {\r\n\r\n      const selected = !!filters.find(filter => filter.includes(cat.id));\r\n\r\n      return (\r\n        <TreeItem\r\n          key={i}\r\n          nodeId={cat.id}\r\n          label={\r\n            <Grid spacing={1} container alignItems=\"flex-start\" style={{flexWrap: \"nowrap\", marginTop: 4}}>\r\n              <Grid item>\r\n                <label htmlFor={`result-tree__checkbox__${cat.id}`} style={{display: \"none\"}}>\r\n                  {cat.label}\r\n                </label>\r\n                <Checkbox\r\n                  id={`result-tree__checkbox__${cat.id}`}\r\n                  checked={selected}\r\n                  className={classes.checkbox}\r\n                  onClick={\r\n                    e => {\r\n                      goToDatasetsSearch(\r\n                        node.code,\r\n                        query,\r\n                        selected\r\n                          ? filters.filter(path => !path.includes(cat.id))\r\n                          : [...filters, [...prevPath, cat.id]]\r\n                      );\r\n                      e.stopPropagation();\r\n                    }}\r\n                />\r\n              </Grid>\r\n              <Grid style={{width: \"100%\"}} item>\r\n                {cat.label} <span className={classes.resCount}>({cat.count})</span>\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n          classes={{label: classes.item}}\r\n        >\r\n          {cat.categories && cat.categories.length > 0 && getTreeItems(cat.categories, [...prevPath, cat.id])}\r\n        </TreeItem>\r\n      );\r\n    });\r\n\r\n  const uncategorizedSelected = !!filters.find(filter => filter.includes(\"uncategorized\"));\r\n\r\n  return (\r\n    <Box className={classes.container}>\r\n      {categoryGroupsWithCount.length > 0 && (\r\n        <TreeView\r\n          defaultCollapseIcon={<ExpandMoreIcon/>}\r\n          defaultExpandIcon={<ChevronRightIcon/>}\r\n          expanded={expanded}\r\n          onNodeToggle={(_, nodeIds) => setExpanded(nodeIds)}\r\n        >\r\n          {getTreeItems(\r\n            catalog.categoryGroups.length > 1\r\n              ? categoryGroupsWithCount\r\n              : categoryGroupsWithCount[0].categories,\r\n            []\r\n          )}\r\n        </TreeView>\r\n      )}\r\n      {uncategorizedDatasetsCount > 0 && (\r\n        <TreeView\r\n          defaultCollapseIcon={<ExpandMoreIcon/>}\r\n          defaultExpandIcon={<ChevronRightIcon/>}\r\n          expanded={expanded}\r\n          onNodeToggle={(_, nodeIds) => setExpanded(nodeIds)}\r\n        >\r\n          <TreeItem\r\n            key={\"uncategorized\"}\r\n            nodeId={\"uncategorized\"}\r\n            label={\r\n              <Grid spacing={1} container alignItems=\"flex-start\" style={{flexWrap: \"nowrap\", marginTop: 4}}>\r\n                <Grid item>\r\n                  <label htmlFor=\"result-tree__checkbox__uncategorized\" style={{display: \"none\"}}>\r\n                    {t(\"commons.catalog.uncategorized\")}\r\n                  </label>\r\n                  <Checkbox\r\n                    id=\"result-tree__checkbox__uncategorized\"\r\n                    checked={uncategorizedSelected}\r\n                    className={classes.checkbox}\r\n                    onClick={\r\n                      e => {\r\n                        goToDatasetsSearch(\r\n                          node.code,\r\n                          query,\r\n                          uncategorizedSelected\r\n                            ? filters.filter(path => JSON.stringify(path) !== JSON.stringify([\"uncategorized\"]))\r\n                            : [...filters, [\"uncategorized\"]]\r\n                        );\r\n                        e.stopPropagation();\r\n                      }}\r\n                  />\r\n                </Grid>\r\n                <Grid style={{width: \"100%\"}} item>\r\n                  {t(\"commons.catalog.uncategorized\")} <span\r\n                  className={classes.resCount}>({uncategorizedDatasetsCount})</span>\r\n                </Grid>\r\n              </Grid>\r\n            }\r\n            classes={{label: classes.item}}\r\n          />\r\n        </TreeView>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ResultTree);","import React, {Component, Fragment} from 'react';\r\nimport NodeHeader from \"../node-header\";\r\nimport {Link, withStyles} from \"@material-ui/core\";\r\nimport Page from \"../page\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {goToData, goToDatasets, goToNode} from \"../../links\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport ListIcon from '@material-ui/icons/List';\r\nimport GridOnIcon from '@material-ui/icons/GridOn';\r\nimport Breadcrumbs from \"@material-ui/core/Breadcrumbs\";\r\nimport ResultTree from \"./ResultTree\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\nimport FolderIcon from \"@material-ui/icons/Folder\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  fullWidthContainer: {\r\n    width: \"100%\",\r\n    paddingTop: 64,\r\n    backgroundColor: \"white\",\r\n    minHeight: \"100%\"\r\n  },\r\n  container: {\r\n    width: 1024,\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  results: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  cubeIcon: {\r\n    width: 24,\r\n    height: 24\r\n  },\r\n  collapsedDescription: {\r\n    marginTop: 8,\r\n    height: 49,\r\n    overflow: \"hidden\"\r\n  },\r\n  expandedDescription: {\r\n    marginTop: 8\r\n  },\r\n  resultSource: {\r\n    fontSize: 14,\r\n    color: \"rgba(0, 0, 0, 0.54)\",\r\n  },\r\n  expansion: {},\r\n  toolbar: {\r\n    marginTop: theme.spacing(2),\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  pager: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  cardContent: {\r\n    padding: \"16px !important\"\r\n  },\r\n  subCat: {\r\n    padding: theme.spacing(1)\r\n  },\r\n  row: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  description: {\r\n    \"& > p\": {\r\n      margin: 0\r\n    }\r\n  }\r\n});\r\n\r\nclass Results extends Component {\r\n\r\n  state = {\r\n    isDialogOpen: false,\r\n    expandedIndexes: [],\r\n    configIsListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .catalogNavigationMode === \"List\",\r\n    isListMode:\r\n      this.props.hub.nodes\r\n        .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n        .catalogNavigationMode === \"List\",\r\n    isA11yMode: false\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n\r\n    const configIsListMode = props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === props.nodeCode.toLowerCase())\r\n      .catalogNavigationMode === \"List\";\r\n\r\n    if (configIsListMode !== state.configIsListMode) {\r\n      return {\r\n        ...state,\r\n        configIsListMode,\r\n        isListMode: configIsListMode\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  onDialogOpen = () => this.setState({isDialogOpen: true});\r\n\r\n  onDialogClose = () => this.setState({isDialogOpen: false});\r\n\r\n  expand = index =>\r\n    this.setState({\r\n      expandedIndexes: [...this.state.expandedIndexes, index]\r\n    });\r\n\r\n  collapse = index =>\r\n    this.setState({\r\n      expandedIndexes: [...this.state.expandedIndexes.filter(i => i !== index)]\r\n    });\r\n\r\n  onListModeToggle = () => {\r\n    this.setState({isListMode: !this.state.isListMode});\r\n  };\r\n\r\n  onA11yModeToggle = () => {\r\n    this.setState({isA11yMode: !this.state.isA11yMode});\r\n  };\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      query,\r\n      hub,\r\n      catalog,\r\n      node,\r\n      nodeCode,\r\n      categoryPath,\r\n      datasets,\r\n      subCategories,\r\n      filters,\r\n      categoryGroupsWithCount,\r\n      uncategorizedDatasetsCount,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isDialogOpen, expandedIndexes, isListMode, isA11yMode} = this.state;\r\n\r\n    const nodeMinimalInfo = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n\r\n    let categoryPathLabels = [];\r\n    if (categoryPath) {\r\n      if (categoryPath[0] === \"uncategorized\") {\r\n        categoryPathLabels = [t(\"commons.catalog.uncategorized\")];\r\n      } else {\r\n\r\n        let category;\r\n\r\n        if (catalog.categoryGroups.length > 1) {\r\n          category = catalog.categoryGroups.find(({id}) => id === categoryPath[0]);\r\n        } else {\r\n          category = catalog.categoryGroups[0].categories.find(({id}) => id === categoryPath[0]);\r\n        }\r\n\r\n        categoryPathLabels.push(category.label);\r\n        for (let i = 1; i < categoryPath.length; i++) {\r\n          category = (category.childrenCategories || category.categories).find(({id}) => id === categoryPath[i]);\r\n          categoryPathLabels.push(category.label);\r\n        }\r\n      }\r\n    }\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          hub={hub.hub}\r\n          query={query}\r\n          nodes={hub.nodes}\r\n          catalog={catalog}\r\n          shortName={nodeMinimalInfo.code}\r\n          title={nodeMinimalInfo.name}\r\n          node={node}\r\n          nodeId={nodeMinimalInfo.nodeId}\r\n          selectedCategoryPath={categoryPath}\r\n        />\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            <Grid container justify=\"space-between\" alignItems=\"center\" className={classes.toolbar}>\r\n              <Grid item>\r\n                {query ?\r\n                  (\r\n                    <Typography variant={\"h5\"}>\r\n                      {t(\"scenes.results.searchTitle\", {query})}\r\n                    </Typography>\r\n                  )\r\n                  : (\r\n                    <Breadcrumbs>\r\n                      <Link underline=\"none\" onClick={() => {\r\n                        goToNode(node.code);\r\n                        window.location.reload();\r\n                      }} style={{cursor: \"pointer\"}}\r\n                      >\r\n                        <Typography>\r\n                          {nodeCode.toUpperCase()}\r\n                        </Typography>\r\n                      </Link>\r\n                      {categoryPath.map((id, idx) => {\r\n                        if (idx >= (catalog && catalog.categoryGroups.length === 1 ? 0 : 1)) {\r\n                          return (\r\n                            <Link\r\n                              key={idx}\r\n                              underline=\"none\"\r\n                              onClick={\r\n                                idx >= (\r\n                                  catalog && catalog.categoryGroups.length === 1\r\n                                    ? 0\r\n                                    : 1\r\n                                )\r\n                                  ? () => goToDatasets(node.code, categoryPath.slice(0, idx + 1))\r\n                                  : null\r\n                              }\r\n                              style={idx < categoryPath.length - 1 ? {cursor: \"pointer\"} : undefined}\r\n                            >\r\n                              <Typography>\r\n                                {id === \"uncategorized\"\r\n                                  ? t(\"commons.catalog.uncategorized\")\r\n                                  : categoryPathLabels[idx]\r\n                                }\r\n                              </Typography>\r\n                            </Link>\r\n                          );\r\n                        } else {\r\n                          return (\r\n                            <Typography key=\"idx\" color=\"primary\">\r\n                              {id === \"uncategorized\"\r\n                                ? t(\"commons.catalog.uncategorized\")\r\n                                : categoryPathLabels[idx]\r\n                              }\r\n                            </Typography>\r\n                          );\r\n                        }\r\n                      })}\r\n                    </Breadcrumbs>\r\n                  )}\r\n              </Grid>\r\n              <Grid item>\r\n                <Grid container alignItems=\"center\" justify=\"flex-end\" spacing={1}>\r\n                  <Grid item>\r\n                    {datasets.length > 0 && (\r\n                      <IconButton onClick={this.onListModeToggle}>\r\n                        {isListMode\r\n                          ? <GridOnIcon/>\r\n                          : <ListIcon/>\r\n                        }\r\n                      </IconButton>\r\n                    )}\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <label htmlFor=\"results__a11y-mode-toggle\" style={{display: \"none\"}}>\r\n                      {t(\"scenes.results.a11yModeToggle.label\")}\r\n                    </label>\r\n                    <FormControlLabel\r\n                      label={t(\"scenes.results.a11yModeToggle.label\")}\r\n                      control={\r\n                        <Switch\r\n                          checked={isA11yMode}\r\n                          onChange={this.onA11yModeToggle}\r\n                          color=\"primary\"\r\n                          name=\"checkedB\"\r\n                          id=\"results__a11y-mode-toggle\"\r\n                        />\r\n                      }\r\n                    />\r\n                  </Grid>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container spacing={2} className={classes.results}>\r\n              {query && datasets.length > 0 && (\r\n                <Grid item style={{width: 256, transform: \"translateX(-24px)\"}}>\r\n                  <ResultTree\r\n                    query={query} filters={filters} catalog={catalog} node={node}\r\n                    datasets={datasets}\r\n                    categoryGroupsWithCount={categoryGroupsWithCount}\r\n                    uncategorizedDatasetsCount={uncategorizedDatasetsCount}\r\n                  />\r\n                </Grid>\r\n              )}\r\n              <Grid item style={{width: query ? `calc(100% - 256px)` : \"100%\"}}>\r\n                {subCategories && subCategories.length\r\n                  ? (\r\n                    <Grid container spacing={2} className={classes.row}>\r\n                      {subCategories.map(({id, label, datasetIdentifiers}) =>\r\n                        <Grid item key={id}>\r\n                          <Card className={classes.subCat}>\r\n                            <CardActionArea\r\n                              onClick={() => goToDatasets(node.code.toLowerCase(), [...categoryPath, id])}>\r\n                              <Grid container spacing={1}>\r\n                                <Grid item>\r\n                                  <FolderIcon/>\r\n                                </Grid>\r\n                                <Grid item>\r\n                                  <Typography variant=\"body1\">\r\n                                    {label} {datasetIdentifiers && datasetIdentifiers.length ? `(${datasetIdentifiers.length})` : ''}\r\n                                  </Typography>\r\n                                </Grid>\r\n                              </Grid>\r\n                            </CardActionArea>\r\n                          </Card>\r\n                        </Grid>\r\n                      )}\r\n                    </Grid>\r\n                  )\r\n                  : null}\r\n                {query && datasets.length\r\n                  ? (\r\n                    <Typography variant=\"body1\" className={classes.row}>\r\n                      {datasets.length > 1\r\n                        ? t(\"scenes.results.datasetsCount.plural\", {datasetsCount: datasets.length})\r\n                        : t(\"scenes.results.datasetsCount.singular\", {datasetsCount: datasets.length})\r\n                      }:\r\n                    </Typography>\r\n                  ) : null\r\n                }\r\n                <Grid container spacing={2}>\r\n                  {datasets.length > 0\r\n                    ? datasets.map((dataset, i) => {\r\n\r\n                      const isExpanded = expandedIndexes.includes(i);\r\n\r\n                      const header =\r\n                        <CardActionArea\r\n                          onClick={() => goToData(node.code, dataset.categoryPath, dataset.identifier, undefined, isA11yMode)}>\r\n                          <Typography variant=\"h6\">\r\n                            {dataset.title}\r\n                          </Typography>\r\n                          {dataset.source && (\r\n                            <Typography variant=\"body1\" className={classes.resultSource}>\r\n                              {dataset.source}\r\n                            </Typography>\r\n                          )}\r\n                        </CardActionArea>;\r\n\r\n                      const description = dataset.description || (dataset.keywords && dataset.keywords.length > 0)\r\n                        ? (\r\n                          <Typography\r\n                            component='div'\r\n                            variant=\"body1\"\r\n                            className={isExpanded ? classes.expandedDescription : classes.collapsedDescription}>\r\n                            <div dangerouslySetInnerHTML={{__html: dataset.description}} className={classes.description}/>\r\n                            {dataset.keywords && dataset.keywords.length > 0 && (\r\n                              <Grid container spacing={1}>\r\n                                {dataset.keywords.map((keyword, index) =>\r\n                                  <Grid item key={index}>\r\n                                    <Chip\r\n                                      label={keyword}\r\n                                      size=\"small\"\r\n                                    />\r\n                                  </Grid>\r\n                                )}\r\n                              </Grid>\r\n                            )}\r\n                          </Typography>\r\n                        )\r\n                        : null;\r\n\r\n                      const expandIcon = <Grid container justify=\"flex-end\">\r\n                        <Grid item>\r\n                          <IconButton\r\n                            onClick={() => isExpanded ? this.collapse(i) : this.expand(i)}\r\n                          >\r\n                            {isExpanded\r\n                              ? <ExpandLessIcon/>\r\n                              : <ExpandMoreIcon/>\r\n                            }\r\n                          </IconButton>\r\n                        </Grid>\r\n                      </Grid>;\r\n\r\n                      /*    const viewButton = <Button onClick={() => goToData(node.code, dataset.categoryPath, dataset.identifier)}\r\n                                                     color=\"primary\">View</Button>;*/\r\n\r\n                      /*   const downloadButton = <Button color=\"secondary\" onClick={this.onDialogOpen}>\r\n                           Download\r\n                         </Button>;\r\n       */\r\n                      return (\r\n                        <Grid item key={i} xs={isListMode ? 12 : 4}>\r\n                          <Card>\r\n                            {isListMode\r\n                              ? (\r\n                                <CardContent className={classes.cardContent}>\r\n                                  <Grid container>\r\n                                    <Grid item xs={12}>\r\n                                      {header}\r\n                                    </Grid>\r\n                                  </Grid>\r\n                                  {description}\r\n                                  {description && expandIcon}\r\n                                </CardContent>\r\n                              )\r\n                              : (\r\n                                <Fragment>\r\n                                  <CardContent>\r\n                                    {header}\r\n                                    {description}\r\n                                    {description && expandIcon}\r\n                                  </CardContent>\r\n                                  <Divider/>\r\n                                  {/*<CardActions>\r\n                                <Grid container justify=\"space-between\">\r\n                                  <Grid item>\r\n                                    {viewButton}\r\n                                  </Grid>\r\n                                </Grid>\r\n                              </CardActions>*/}\r\n                                </Fragment>\r\n                              )}\r\n                          </Card>\r\n                        </Grid>\r\n                      );\r\n                    })\r\n                    : (\r\n                      query || !subCategories || !subCategories.length\r\n                        ? (\r\n                          <Grid container>\r\n                            <Grid item>\r\n                              {t(\"scenes.results.datasetsCount.none\")}\r\n                            </Grid>\r\n                          </Grid>\r\n                        )\r\n                        : null\r\n                    )}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n            {/* pagination */}\r\n            {/* <Grid container justify=\"flex-end\" className={classes.pager}>\r\n              <Grid item>\r\n                <Pagination count={10}/>\r\n              </Grid>\r\n            </Grid>*/}\r\n            <Dialog open={isDialogOpen} onClose={this.onDialogClose}>\r\n              <DialogTitle>Download</DialogTitle>\r\n              <DialogContent>\r\n                <Button color=\"primary\" onClick={this.onDialogClose}>\r\n                  CSV\r\n                </Button>\r\n                <Button color=\"primary\" onClick={this.onDialogClose}>\r\n                  SDMX\r\n                </Button>\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={this.onDialogClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(Results);","import React from 'react';\r\nimport NodeHeader from \"../node-header\";\r\nimport DataViewer from \"../data-viewer\";\r\nimport Page from \"../page\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = () => ({\r\n  fullWidthContainer: {\r\n    backgroundColor: \"white\",\r\n    width: \"100%\",\r\n    minHeight: \"100%\"\r\n  }\r\n});\r\n\r\nconst Data = ({\r\n                classes,\r\n                hub,\r\n                node,\r\n                catalog,\r\n                categoryPath,\r\n                isAccessible,\r\n                datasetId,\r\n                datasetTitle,\r\n                notes,\r\n                attachedFiles,\r\n                referenceMetadataUrl,\r\n                dataset\r\n              }) => {\r\n\r\n  const nodeExtras = {};\r\n  if (node?.extras) {\r\n    node.extras.map(({key, value}) => nodeExtras[key] = JSON.parse(value));\r\n  }\r\n\r\n  const hubExtras = JSON.parse(hub.hub.extras || \"{}\");\r\n\r\n  return (\r\n    <Page>\r\n      <NodeHeader\r\n        hub={hub.hub}\r\n        nodes={hub?.nodes}\r\n        catalog={catalog}\r\n        shortName={node?.code}\r\n        title={node?.name}\r\n        node={node}\r\n        nodeId={node?.nodeId}\r\n        selectedCategoryPath={categoryPath}\r\n      />\r\n      <div style={{paddingTop: 64}} className={classes.fullWidthContainer}>\r\n        <div style={{marginLeft: 16}}/>\r\n        <DataViewer\r\n          nodeId={node?.nodeId}\r\n          nodeCode={node?.code}\r\n\r\n          isAccessible={isAccessible}\r\n\r\n          datasetId={datasetId}\r\n          datasetTitle={datasetTitle}\r\n          dataset={dataset?.dataset}\r\n          accessibleDataset={dataset?.accessibleDataset}\r\n          isFetchDatasetDisabled={dataset?.isFetchDatasetDisabled}\r\n\r\n          isCriteriaVisible={dataset?.isCriteriaVisible}\r\n          isCriteriaAlertVisible={dataset?.isCriteriaAlertVisible}\r\n\r\n          hasViewTemplate={dataset?.hasViewTemplate}\r\n          hasTemplateLayout={dataset?.hasTemplateLayout}\r\n          hasAnnotationLayout={dataset?.hasAnnotationLayout}\r\n\r\n          dimensions={dataset?.dimensions}\r\n          mode={dataset?.mode}\r\n          type={dataset?.type}\r\n          codelistsLength={dataset?.codelistsLength}\r\n          viewerIdx={dataset?.viewerIdx}\r\n          initialTableLayout={dataset?.initialTableLayout}\r\n          initialMapLayout={dataset?.initialMapLayout}\r\n          initialChartLayout={dataset?.initialChartLayout}\r\n          labelFormat={dataset?.labelFormat}\r\n          filters={dataset?.filters}\r\n          decimalSeparator={dataset?.decimalSeparator}\r\n          decimalPlaces={dataset?.decimalPlaces}\r\n          emptyChar={dataset?.emptyChar}\r\n          enableCriteria={dataset?.enableCriteria}\r\n          enableLayout={dataset?.enableLayout}\r\n          maxAllowedCells={dataset?.maxAllowedCells}\r\n          territorialDims={dataset?.territorialDims}\r\n          codes={dataset?.codes}\r\n          isCodesFlat={dataset?.isCodesFlat}\r\n          codelists={dataset?.codelists}\r\n          areCodelistsFlat={dataset?.areCodelistsFlat}\r\n          timePeriod={dataset?.timePeriod}\r\n\r\n          geometries={dataset?.geometries}\r\n          geometryDetailLevels={dataset?.geometryDetailLevels}\r\n          isPartialData={dataset?.isPartialData}\r\n          isEmptyData={dataset?.isEmptyData}\r\n          isTooBigData={dataset?.isTooBigData}\r\n\r\n          maxObservation={hub?.hub?.maxObservationsAfterCriteria}\r\n\r\n          isDownloadWarningVisible={dataset?.isDownloadWarningVisible}\r\n          isUnavailableViewWarningVisible={dataset?.isUnavailableViewWarningVisible}\r\n          isCriteriaLengthWarningVisible={dataset?.isCriteriaLengthWarningVisible}\r\n\r\n          timings={dataset?.timings}\r\n\r\n          notes={notes}\r\n          attachedFiles={attachedFiles}\r\n          referenceMetadataUrl={referenceMetadataUrl}\r\n\r\n          hubExtras={hubExtras}\r\n          nodeExtras={nodeExtras}\r\n        />\r\n      </div>\r\n    </Page>\r\n  )\r\n};\r\n\r\nexport default withStyles(styles)(Data);","import React, {useEffect, useState} from 'react';\r\nimport Data from \"../components/data\";\r\nimport {connect} from \"react-redux\";\r\nimport {enableDatasetStructureFetch, fetchDatasetStructure, resetDataset} from \"../state/dataset/datasetActions\";\r\nimport Call from \"../hocs/call\";\r\n\r\nconst mapStateToProps = state => ({\r\n  dataset: state.dataset,\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onFetchStructureEnable: datasetId => dispatch(enableDatasetStructureFetch(datasetId)),\r\n  fetchStructure: ({nodeId, datasetId, viewId, isAccessible, defaultLanguage, languages}) =>\r\n    dispatch(fetchDatasetStructure(nodeId, datasetId, viewId, isAccessible, defaultLanguage, languages)),\r\n  onDatasetReset: () => dispatch(resetDataset())\r\n});\r\n\r\nconst DatasetDomain = ({\r\n                         dataset,\r\n                         defaultLanguage,\r\n                         languages,\r\n                         hub,\r\n                         node,\r\n                         nodeCode,\r\n                         catalog,\r\n                         categoryPath,\r\n                         isAccessible,\r\n                         datasetId,\r\n                         datasetTitle,\r\n                         notes,\r\n                         attachedFiles,\r\n                         referenceMetadataUrl,\r\n                         viewId,\r\n                         onFetchStructureEnable,\r\n                         fetchStructure,\r\n                         onDatasetReset\r\n                       }) => {\r\n\r\n  const [isFetchEnabled, setIsFetchEnabled] = useState(false);\r\n\r\n  useEffect(() => {\r\n    onDatasetReset();\r\n    if (hub && node && catalog && node.nodeId === catalog.nodeId && node.code.toLowerCase() === nodeCode.toLowerCase()) {\r\n      setIsFetchEnabled(true);\r\n    }\r\n  }, [onDatasetReset, hub, node, catalog, nodeCode, categoryPath, datasetId, datasetTitle, viewId]);\r\n\r\n  useEffect(() => {\r\n    if (isFetchEnabled) {\r\n      onFetchStructureEnable(datasetId);\r\n      setIsFetchEnabled(false);\r\n    }\r\n  }, [isFetchEnabled, onFetchStructureEnable, datasetId]);\r\n\r\n  return (\r\n    <Call\r\n      cb={fetchStructure}\r\n      cbParam={{nodeId: node ? node.nodeId : null, datasetId, viewId, isAccessible, defaultLanguage, languages}}\r\n      disabled={!node || !node.nodeId || !datasetId || !dataset || dataset.isFetchStructureDisabled}\r\n    >\r\n      <Data\r\n        hub={hub}\r\n        node={node}\r\n        catalog={catalog}\r\n        categoryPath={categoryPath}\r\n        isAccessible={isAccessible}\r\n        datasetId={datasetId}\r\n        datasetTitle={datasetTitle}\r\n        notes={notes}\r\n        attachedFiles={attachedFiles}\r\n        referenceMetadataUrl={referenceMetadataUrl}\r\n        dataset={dataset}\r\n        viewId={viewId}\r\n      />\r\n    </Call>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DatasetDomain);","import React, {Fragment, useState} from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport {getNode, getNodes, getNodesAtDepth} from \"../../utils/tree\";\r\nimport {getDashboardDynamicFilterLabelTranslations} from \"../../constants/getDashboardDynamicFilterLabelTranslations\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  filter: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"bottom\",\r\n    marginRight: 16,\r\n    \"& label\": {\r\n      fontSize: 16\r\n    }\r\n  },\r\n  item: {\r\n    fontSize: 14\r\n  },\r\n  dialogContent: {\r\n    padding: \"8px !important\"\r\n  },\r\n});\r\n\r\nconst getLabelsMap = tree => {\r\n  const map = {};\r\n  getNodes(tree, \"children\", () => true).forEach(({id, name}) => map[id] = name);\r\n\r\n  return map;\r\n}\r\n\r\nfunction DashboardFilters(props) {\r\n  const {\r\n    classes,\r\n    filters,\r\n    isFilterEnabled,\r\n    selectValues,\r\n    setSelectValues,\r\n    lastValorizedIdx,\r\n    setLastValorizedIdx,\r\n    filterLevels,\r\n    onFilterApply\r\n  } = props;\r\n\r\n  const {\r\n    labels,\r\n    values\r\n  } = filters;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isApplyDisabled, setIsApplyDisable] = useState(false);\r\n\r\n  const [visibleId, setVisibleId] = useState(null);\r\n\r\n  const [labelsMap] = useState(getLabelsMap(values));\r\n\r\n  const handleFilterSelect = (dimension, value) => {\r\n    const newSelectedValues = {};\r\n    let found = false;\r\n    labels.forEach(label => {\r\n      if (!found) {\r\n        if (label !== dimension) {\r\n          newSelectedValues[label] = selectValues[label];\r\n        } else {\r\n          found = true;\r\n          newSelectedValues[label] = value;\r\n        }\r\n      } else {\r\n        newSelectedValues[label] = \"\";\r\n      }\r\n    })\r\n    setSelectValues(newSelectedValues);\r\n    setLastValorizedIdx(visibleId);\r\n    setVisibleId(null);\r\n    setIsApplyDisable(false);\r\n  };\r\n\r\n  let data = [];\r\n  if (visibleId !== null) {\r\n    data = visibleId === 0\r\n      ? values\r\n      : getNode(values, \"children\", ({id}) => id === selectValues[labels[visibleId - 1]]).children\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.root}>\r\n        {(() => {\r\n          const getTextWidthEl = $('<span>').css({\r\n            visibility: 'hidden',\r\n            position: 'absolute',\r\n            fontSize: 16\r\n          }).appendTo('body').get(0);\r\n\r\n          const selects = [];\r\n\r\n          for (let i = 0; i <= Math.min(lastValorizedIdx + 1, labels.length - 1); i++) {\r\n            const label = labels[i];\r\n            const minWidth = getTextWidth(label, getTextWidthEl) + 32;\r\n\r\n            selects.push(\r\n              <div key={i} className={classes.filter}>\r\n                <FormControl style={{display: \"inline-block\", verticalAlign: \"bottom\"}}>\r\n                  <InputLabel>{getDashboardDynamicFilterLabelTranslations(t)[label]}</InputLabel>\r\n                  <Select\r\n                    open={false}\r\n                    style={{minWidth: minWidth}}\r\n                    value={isFilterEnabled ? (selectValues[label] || \"\") : \"-\"}\r\n                    renderValue={value => isFilterEnabled ? labelsMap[value] : \"---\"}\r\n                    className={classes.item}\r\n                    onOpen={() => setVisibleId(i)}\r\n                    disabled={!isFilterEnabled}\r\n                  >\r\n                    {isFilterEnabled\r\n                      ? getNodesAtDepth(values, \"children\", (i + 1)).map(({id}, idx) => (\r\n                        <MenuItem key={idx} value={id}>{id}</MenuItem>\r\n                      ))\r\n                      : <MenuItem key={\"-\"} value={\"-\"}/>\r\n                    }\r\n                  </Select>\r\n                </FormControl>\r\n              </div>\r\n            )\r\n          }\r\n\r\n          $(getTextWidthEl).remove();\r\n\r\n          if (isFilterEnabled) {\r\n            selects.push(\r\n              <Button\r\n                key={labels.length}\r\n                onClick={() => {\r\n                  onFilterApply(selectValues[labels[lastValorizedIdx]]);\r\n                  setIsApplyDisable(true);\r\n                }}\r\n                disabled={isApplyDisabled || lastValorizedIdx < 0 || filterLevels?.[labels[lastValorizedIdx]] === false}\r\n              >\r\n                {t(\"commons.confirm.apply\")}\r\n              </Button>\r\n            );\r\n          }\r\n\r\n          return selects\r\n        })()}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={visibleId !== null}\r\n        onClose={() => setVisibleId(null)}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent className={classes.dialogContent}>\r\n          <InfiniteScrollTable\r\n            data={data}\r\n            getRowKey={({id}) => id}\r\n            showHeader={false}\r\n            columns={[\r\n              {\r\n                title: \"ID\",\r\n                dataIndex: \"id\",\r\n                minWidth: 100\r\n              },\r\n              {\r\n                title: \"Label\",\r\n                dataIndex: \"name\",\r\n                minWidth: 150\r\n              }\r\n            ]}\r\n            onRowClick={rowData => handleFilterSelect(labels[visibleId], rowData.id)}\r\n            getRowStyle={rowData => ({\r\n              background: rowData.id === selectValues[labels[visibleId]]\r\n                ? \"#fff9e5\"\r\n                : undefined\r\n            })}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setVisibleId(null)} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(DashboardFilters);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {\r\n  clearDashboardsDashboards,\r\n  downloadViewCsv,\r\n  fetchDashboardsDashboard,\r\n  fetchDashboardsDataset,\r\n  fetchDashboardsMapGeometries,\r\n  setDashboardsDatasetFetchEnableStatus\r\n} from \"../state/dashboard/dashboardActions\";\r\nimport Call from \"../hocs/call\";\r\nimport Dashboard from \"../components/dashboard\";\r\nimport filters from \"../dummy/filters.json\";\r\nimport DashboardFilters from \"../components/dashboard-filters\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../utils/dashboards\";\r\nimport _ from \"lodash\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport CustomEmpty from \"../components/custom-empty\";\r\nimport NodeHeader from \"../components/node-header\";\r\nimport {localizeI18nObj} from \"../utils/i18n\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst COMMONS_FILTERS_HEIGHT = 80;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    backgroundColor: \"white\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n  },\r\n  fullWidthContainer: {\r\n    padding: 8,\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  commonsFilters: {\r\n    height: COMMONS_FILTERS_HEIGHT,\r\n    padding: \"16px 8px\"\r\n  },\r\n  dashboardHeader: {\r\n    padding: \"0 8px\"\r\n  },\r\n  dashboardTabs: {\r\n    marginBottom: 16\r\n  },\r\n  dashboardTitle: {\r\n    padding: \"8px 0\",\r\n    marginBottom: 4,\r\n    fontSize: 20,\r\n    fontWeight: 500\r\n  },\r\n  dashboard: {\r\n    overflow: \"auto\",\r\n    margin: \"0 8px\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  languages: state.app.languages,\r\n  defaultLanguage: state.app.language,\r\n  dashboards: state.dashboard.dashboards,\r\n  isFetchDatasetDisabled: state.dashboard.isFetchDatasetDisabled,\r\n  jsonStats: state.dashboard.jsonStats,\r\n  maps: state.dashboard.maps\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboard: dashboardId => dispatch(fetchDashboardsDashboard(dashboardId)),\r\n  clearDashboards: () => dispatch(clearDashboardsDashboards()),\r\n  setDatasetFetchEnableStatus: enabled => dispatch(setDashboardsDatasetFetchEnableStatus(enabled)),\r\n  fetchDataset: (dashboardId, nodeId, datasetId, criteria, requestIds) =>\r\n    dispatch(fetchDashboardsDataset(dashboardId, nodeId, datasetId, criteria, requestIds)),\r\n  fetchMapGeometries: (dashboardId, idList, requestId) => dispatch(fetchDashboardsMapGeometries(dashboardId, idList, requestId)),\r\n  downloadCsv: (nodeId, datasetId, viewTitle, criteria) => dispatch(downloadViewCsv(nodeId, datasetId, viewTitle, criteria)),\r\n});\r\n\r\nconst handleHeight = () => {\r\n  const headerHeight = document.getElementById(\"node-header\")\r\n    ? document.getElementById(\"node-header\").offsetHeight\r\n    : 0;\r\n\r\n  if (document.getElementById(\"dashboards-container\")) {\r\n    document.getElementById(\"dashboards-container\").setAttribute(\"style\", `padding-top: ${headerHeight}px`);\r\n  }\r\n};\r\n\r\nconst getIsFilterEnabled = dashboard => {\r\n  let isFilterEnabled = false;\r\n  dashboard.dashboardConfig.forEach(row => {\r\n    row.forEach(col => {\r\n      if ((col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || \"\").length > 0) {\r\n        isFilterEnabled = true;\r\n      }\r\n    });\r\n  });\r\n\r\n  return isFilterEnabled\r\n};\r\n\r\nfunction DashboardsDomain(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    hub,\r\n    node,\r\n    nodeId,\r\n    catalog,\r\n    dashboardId,\r\n    dashboards,\r\n    isFetchDatasetDisabled,\r\n    jsonStats,\r\n    maps,\r\n    fetchDashboard,\r\n    clearDashboards,\r\n    setDatasetFetchEnableStatus,\r\n    fetchDataset,\r\n    fetchMapGeometries,\r\n    downloadCsv\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [filterValue, setFilterValue] = useState(\"\");\r\n  const [selectValues, setSelectValues] = useState({});\r\n  const [lastValorizedIdx, setLastValorizedIdx] = useState(-1);\r\n\r\n  const [allowedDashboards, setAllowedDashboards] = useState(null);\r\n  const [currentDashboardId, setCurrentDashboardId] = useState(null);\r\n\r\n  const [fetchedDashboards, setFetchedDashboards] = useState(null);\r\n\r\n  const [tabIdx, setTabIdx] = useState(0);\r\n\r\n  // const {\r\n  //   labels\r\n  // } = filters;\r\n\r\n  useEffect(() => {\r\n    clearDashboards();\r\n    setFilterValue(\"\");\r\n    handleHeight();\r\n  }, [clearDashboards, nodeId, dashboardId]);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", handleHeight);\r\n    return () => window.removeEventListener(\"resize\", handleHeight)\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const nodeDashboards = nodeId ? (hub.nodes.find(node => node.nodeId === nodeId).dashboards || []) : []\r\n    const hubDashboards = (hub.hub.dashboards || [])\r\n\r\n    setAllowedDashboards(dashboardId\r\n      ? [{id: dashboardId}]\r\n      : nodeId\r\n        ? hubDashboards.concat(nodeDashboards)\r\n        : hubDashboards\r\n    );\r\n  }, [hub, nodeId, dashboardId]);\r\n\r\n  useEffect(() => {\r\n    if (allowedDashboards) {\r\n      const newCurrentDashboardId = dashboardId\r\n        ? dashboardId\r\n        : allowedDashboards[tabIdx].id\r\n          ? allowedDashboards[tabIdx].id\r\n          : null;\r\n      setCurrentDashboardId(newCurrentDashboardId);\r\n    }\r\n  }, [allowedDashboards, dashboardId, tabIdx]);\r\n\r\n  useEffect(() => {\r\n    if (allowedDashboards) {\r\n      const newFetchedDashboards = {};\r\n      allowedDashboards.forEach(({id}) => newFetchedDashboards[id] = {static: false, dynamic: false});\r\n      setFetchedDashboards(newFetchedDashboards);\r\n    }\r\n  }, [allowedDashboards]);\r\n\r\n  const handleFilterApply = value => {\r\n    if (value !== filterValue) {\r\n      setFilterValue(value);\r\n      setDatasetFetchEnableStatus(true);\r\n\r\n      const newFetchedDashboard = _.cloneDeep(fetchedDashboards);\r\n      allowedDashboards.forEach(({id}) => newFetchedDashboard[id] = {...fetchedDashboards[id], dynamic: false});\r\n      setFetchedDashboards(newFetchedDashboard);\r\n    }\r\n  };\r\n\r\n  const handleFetchDatasets = ({dashboardId, fetchStatic, fetchDynamic, dynamicFilterValue}) => {\r\n\r\n    const newFetchedDashboards = _.cloneDeep(fetchedDashboards);\r\n    if (fetchStatic) {\r\n      newFetchedDashboards[dashboardId].static = true;\r\n    }\r\n    if (fetchDynamic && dynamicFilterValue) {\r\n      newFetchedDashboards[dashboardId].dynamic = true;\r\n    }\r\n    setFetchedDashboards(newFetchedDashboards);\r\n\r\n    const requests = [];\r\n    dashboards[dashboardId].dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n\r\n          const view = dashboards[dashboardId].views[col[DASHBOARD_ELEM_VALUE_KEY]];\r\n\r\n          let newCriteria = view?.criteria ? view.criteria : {};\r\n\r\n          let addRequest = false;\r\n\r\n          if (!col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY].length === 0) {\r\n            addRequest = fetchStatic\r\n\r\n          } else {\r\n            if (fetchDynamic) {\r\n              addRequest = true;\r\n              if (dynamicFilterValue) {\r\n                newCriteria = {\r\n                  ...newCriteria,\r\n                  [col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY]]: [dynamicFilterValue]\r\n                };\r\n              } else {\r\n                newCriteria = {\r\n                  ...newCriteria,\r\n                  [col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY]]: [filters.defaultFilterValue]\r\n                };\r\n              }\r\n            }\r\n          }\r\n\r\n          if (addRequest) {\r\n            const request = requests.find(({nodeId, datasetId, criteria}) => {\r\n              return (\r\n                nodeId === view.nodeId &&\r\n                datasetId === view.datasetId &&\r\n                _.isEqual(criteria, newCriteria)\r\n              )\r\n            });\r\n\r\n            if (request === undefined) {\r\n              requests.push({\r\n                nodeId: view.nodeId,\r\n                datasetId: view.datasetId,\r\n                criteria: newCriteria,\r\n                requestIds: [getViewIdxFromRowAndCol(rowIdx, colIdx)]\r\n              });\r\n            } else {\r\n              request.requestIds.push(getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n    requests.forEach(({nodeId, datasetId, criteria, requestIds}) => fetchDataset(dashboardId, nodeId, datasetId, criteria, requestIds));\r\n  };\r\n\r\n  // const resetFilter = () => {\r\n  //   setFilterValue(\"\");\r\n  //   setSelectValues({});\r\n  //   setLastValorizedIdx(-1);\r\n  //   if (allowedDashboards) {\r\n  //     const newFetchedDashboards = {};\r\n  //     allowedDashboards.forEach(({id}) => newFetchedDashboards[id] = {static: fetchedDashboards[id].static, dynamic: false});\r\n  //     setFetchedDashboards(newFetchedDashboards);\r\n  //   }\r\n  // };\r\n\r\n  return (\r\n    <div key={dashboardId} className={classes.root}>\r\n      {nodeId\r\n        ? (\r\n          <NodeHeader\r\n            hub={hub.hub}\r\n            nodes={hub?.nodes}\r\n            node={node}\r\n            nodeId={nodeId}\r\n            shortName={node?.code}\r\n            title={node?.name}\r\n            catalog={catalog}\r\n            defaultNodeConfigOpen={props.defaultNodeConfigOpen}\r\n            defaultAppConfigOpen={props.defaultAppConfigOpen}\r\n            defaultUserConfigOpen={props.defaultUserConfigOpen}\r\n            defaultNodesConfigOpen={props.defaultNodesConfigOpen}\r\n          />\r\n        )\r\n        : (\r\n          <NodeHeader\r\n            noNode\r\n            hub={hub.hub}\r\n            nodes={hub.nodes}\r\n            defaultNodeConfigOpen={props.defaultNodeConfigOpen}\r\n            defaultAppConfigOpen={props.defaultAppConfigOpen}\r\n            defaultUserConfigOpen={props.defaultUserConfigOpen}\r\n            defaultNodesConfigOpen={props.defaultNodesConfigOpen}\r\n          />\r\n        )\r\n      }\r\n      <div className={classes.fullWidthContainer} id=\"dashboards-container\">\r\n        {currentDashboardId\r\n          ? (\r\n            <Call\r\n              cb={fetchDashboard}\r\n              cbParam={currentDashboardId}\r\n              disabled={!currentDashboardId || (dashboards && dashboards[currentDashboardId] !== null && dashboards[currentDashboardId] !== undefined)}\r\n            >\r\n              {(() => {\r\n                return (\r\n                  <Call\r\n                    cb={handleFetchDatasets}\r\n                    cbParam={{\r\n                      dashboardId: currentDashboardId,\r\n                      fetchStatic: true,\r\n                      fetchDynamic: !filterValue,\r\n                      dynamicFilterValue: null\r\n                    }}\r\n                    disabled={!dashboards || !dashboards[currentDashboardId] || fetchedDashboards[currentDashboardId].static === true}\r\n                  >\r\n                    <Fragment>\r\n                      <div className={classes.commonsFilters}>\r\n                        <DashboardFilters\r\n                          filters={filters}\r\n                          isFilterEnabled={dashboards?.[currentDashboardId] ? getIsFilterEnabled(dashboards[currentDashboardId]) : null}\r\n                          selectValues={selectValues}\r\n                          setSelectValues={setSelectValues}\r\n                          lastValorizedIdx={lastValorizedIdx}\r\n                          setLastValorizedIdx={setLastValorizedIdx}\r\n                          filterLevels={dashboards?.[currentDashboardId] ? dashboards[currentDashboardId].filterLevels : null}\r\n                          onFilterApply={filterValue => handleFilterApply(filterValue)}\r\n                        />\r\n                      </div>\r\n                      {(() => {\r\n                        if (dashboards?.[currentDashboardId]) {\r\n\r\n                          let newFilterValue = filterValue;\r\n\r\n                          // if (lastValorizedIdx >= 0 && dashboards[currentDashboardId].filterLevels && dashboards[currentDashboardId].filterLevels?.[labels[lastValorizedIdx]] === false) {\r\n                          //   newFilterValue = \"\";\r\n                          //   resetFilter();\r\n                          // }\r\n\r\n                          return (\r\n                            <Call\r\n                              cb={handleFetchDatasets}\r\n                              cbParam={{\r\n                                dashboardId: currentDashboardId,\r\n                                fetchStatic: false,\r\n                                fetchDynamic: !!newFilterValue,\r\n                                dynamicFilterValue: newFilterValue\r\n                              }}\r\n                              disabled={isFetchDatasetDisabled || fetchedDashboards[currentDashboardId].dynamic === true || fetchedDashboards[currentDashboardId].static !== true}\r\n                            >\r\n                              <Fragment>\r\n                                <div className={classes.dashboardHeader}>\r\n                                  {(allowedDashboards.length > 1)\r\n                                    ? (\r\n                                      <AppBar position=\"static\" color=\"default\" className={classes.dashboardTabs}>\r\n                                        <Tabs\r\n                                          value={tabIdx}\r\n                                          variant=\"scrollable\"\r\n                                          scrollButtons=\"auto\"\r\n                                          indicatorColor=\"primary\"\r\n                                          textColor=\"primary\"\r\n                                          onChange={(_, newValue) => setTabIdx(newValue)}\r\n                                        >\r\n                                          {allowedDashboards.map(({id, title}, idx) =>\r\n                                            <Tab key={idx} label={title}/>\r\n                                          )}\r\n                                        </Tabs>\r\n                                      </AppBar>\r\n                                    )\r\n                                    : (\r\n                                      <div className={classes.dashboardTitle}>\r\n                                        {localizeI18nObj(dashboards[currentDashboardId].title, defaultLanguage, languages)}\r\n                                      </div>\r\n                                    )\r\n                                  }\r\n                                </div>\r\n                                <div\r\n                                  className={classes.dashboard}\r\n                                  style={{height: `calc(100% - ${COMMONS_FILTERS_HEIGHT + (allowedDashboards.length > 1 ? 64 : 48)}px)`}}\r\n                                >\r\n                                  {dashboards[currentDashboardId] && (\r\n                                    <Dashboard\r\n                                      key={currentDashboardId}\r\n                                      dashboard={dashboards[currentDashboardId]}\r\n                                      filterValue={filterValue}\r\n                                      jsonStats={(jsonStats && jsonStats[currentDashboardId]) ? jsonStats[currentDashboardId] : null}\r\n                                      maps={maps ? maps[currentDashboardId] : null}\r\n                                      fetchMapGeometries={(idList, requestId) => fetchMapGeometries(currentDashboardId, idList, requestId)}\r\n                                      downloadCsv={downloadCsv}\r\n                                    />\r\n                                  )}\r\n                                </div>\r\n                              </Fragment>\r\n                            </Call>\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </Fragment>\r\n                  </Call>\r\n                )\r\n              })()}\r\n            </Call>\r\n          )\r\n          : (\r\n            <CustomEmpty\r\n              text={nodeId\r\n                ? t(\"scenes.dashboard.noDashboard.node\")\r\n                : t(\"scenes.dashboard.noDashboard.hub\")\r\n              }\r\n            />\r\n          )\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withStyles(styles)\r\n)(DashboardsDomain);","import {useEffect} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport {setAppLanguage} from \"../state/app/appActions\";\r\nimport {useLocation} from \"react-router\";\r\nimport {goToHome} from \"../links\";\r\n\r\nconst mapStateToProps = state => ({\r\n  appLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  node: state.node\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  setAppLanguage: (language, nodeId) => dispatch(setAppLanguage(language, nodeId)),\r\n});\r\n\r\nconst MultiLanguageDomain = ({language, languages, appLanguage, setAppLanguage, children, node}) => {\r\n\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    if (language && appLanguage !== language && languages.includes(language)) {\r\n      setAppLanguage(language, node ? node.nodeId : null);\r\n    } else if (!languages.includes(language)) {\r\n      goToHome();\r\n    }\r\n  }, [language, languages, setAppLanguage, appLanguage, node, location.pathname]);\r\n\r\n  return children;\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MultiLanguageDomain);\r\n","export const APP_LANGUAGE_SET = \"app/languageSet\";\r\n\r\nexport const setAppLanguage = (language: string, nodeId: number) => ({\r\n  type: APP_LANGUAGE_SET,\r\n  payload: {\r\n    language,\r\n    nodeId\r\n  }\r\n});\r\n","import React, {Fragment, useEffect} from 'react';\r\nimport {Route, Switch} from \"react-router\";\r\nimport Node from \"../components/node\";\r\nimport {fetchNode} from \"../state/node/nodeActions\";\r\nimport {fetchCatalog} from \"../state/catalog/catalogActions\";\r\nimport Results from \"../components/results\";\r\nimport DatasetDomain from \"./DatasetDomain\";\r\nimport {connect} from \"react-redux\";\r\nimport DashboardsDomain from \"./DashboardsDomain\";\r\nimport {goToNode} from \"../links\";\r\nimport MultiLanguageDomain from \"./MultiLanguageDomain\";\r\n\r\nconst mapStateToProps = state => ({\r\n  node: state.node,\r\n  catalog: state.catalog\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchNode: nodeId => dispatch(fetchNode(nodeId)),\r\n  fetchCatalog: nodeId => dispatch(fetchCatalog(nodeId))\r\n});\r\n\r\nconst NodeDomain = ({hub, nodeCode, node, catalog, fetchNode, fetchCatalog}) => {\r\n\r\n  useEffect(() => {\r\n\r\n    if (hub && (!node || nodeCode.toLowerCase() !== node.code.toLowerCase())) {\r\n      const nodeHavingCode = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n      if (nodeHavingCode) {\r\n        fetchNode(nodeHavingCode.nodeId);\r\n        fetchCatalog(nodeHavingCode.nodeId);\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [hub, nodeCode, node]);\r\n\r\n\r\n  const Recursive = ({path, match}) =>\r\n    <Switch>\r\n      <Route\r\n        exact\r\n        path={match.url}\r\n        render={({location}) => {\r\n\r\n          const viewParam = new URLSearchParams(location.search).get(\"view\");\r\n          const a11yParam = new URLSearchParams(location.search).get(\"accessible\");\r\n\r\n          if (path.length === 1 && catalog.datasets[path[0]]) {\r\n            return (\r\n              <DatasetDomain\r\n                hub={hub}\r\n                node={node}\r\n                nodeCode={nodeCode}\r\n                catalog={catalog}\r\n                categoryPath={[]}\r\n                datasetId={path[0]}\r\n                datasetTitle={catalog.datasets[path[0]].title}\r\n                notes={catalog.datasets[path[0]]?.note}\r\n                attachedFiles={catalog.datasets[path[0]]?.attachedDataFiles}\r\n                referenceMetadataUrl={catalog.datasets[path[0]]?.referenceMetadata}\r\n                viewId={viewParam || undefined}\r\n                isAccessible={!!a11yParam}\r\n              />\r\n            );\r\n          } else if (path.length === 1 && catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[0])) {\r\n\r\n            const dataset = catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[0]);\r\n\r\n            return (\r\n              <DatasetDomain\r\n                hub={hub}\r\n                node={node}\r\n                nodeCode={nodeCode}\r\n                catalog={catalog}\r\n                categoryPath={[]}\r\n                datasetId={path[0]}\r\n                datasetTitle={dataset.title}\r\n                notes={dataset?.note}\r\n                attachedFiles={dataset?.attachedDataFiles}\r\n                referenceMetadataUrl={dataset?.referenceMetadata}\r\n                viewId={viewParam || undefined}\r\n                isAccessible={!!a11yParam}\r\n              />\r\n            );\r\n          } else if (path.length > 0 && path[0] === \"uncategorized\" &&\r\n            catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0) {\r\n\r\n            if (path.length === 1) {\r\n\r\n              return (<Results hub={hub} node={node} nodeCode={nodeCode} catalog={catalog}\r\n                               categoryPath={path}\r\n                               datasets={catalog.uncategorizedDatasets.map(ds => ({\r\n                                 ...ds,\r\n                                 categoryPath: path\r\n                               }))}/>);\r\n\r\n            } else if (path.length === 2) {\r\n\r\n              const dataset = catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[1]);\r\n\r\n              if (dataset) {\r\n                return (\r\n                  <DatasetDomain\r\n                    hub={hub}\r\n                    node={node}\r\n                    nodeCode={nodeCode}\r\n                    catalog={catalog}\r\n                    categoryPath={path.slice(0, -1)}\r\n                    datasetId={dataset.identifier}\r\n                    datasetTitle={dataset.title}\r\n                    notes={dataset?.note}\r\n                    attachedFiles={dataset?.attachedDataFiles}\r\n                    referenceMetadataUrl={dataset?.referenceMetadata}\r\n                    isAccessible={!!a11yParam}\r\n                  />\r\n                );\r\n              }\r\n\r\n            }\r\n          } else if (catalog.categoryGroups.length > 0) {\r\n\r\n            const getDatasetsIdsAndSubcategoriesOrDatasetId = (categoryPath = [], categories = [], datasetsIds = []) => {\r\n\r\n              if (categoryPath.length > 0) {\r\n\r\n                if (categoryPath.length === 1) {\r\n\r\n                  const datasetId = datasetsIds.find(id => id === categoryPath[0]);\r\n\r\n                  if (datasetId) {\r\n                    return datasetId;\r\n                  } else {\r\n\r\n                    const lastCategory = categories.find(({id}) => id === categoryPath[0]);\r\n                    if (lastCategory) {\r\n                      return {\r\n                        datasetIds: lastCategory.datasetIdentifiers,\r\n                        subCategories: lastCategory.categories || lastCategory.childrenCategories\r\n                      }\r\n                    }\r\n\r\n                  }\r\n\r\n                } else {\r\n                  const nextCategory = categories.find(({id}) => id === categoryPath[0]);\r\n\r\n                  if (nextCategory) {\r\n                    return getDatasetsIdsAndSubcategoriesOrDatasetId(categoryPath.slice(1), nextCategory.categories || nextCategory.childrenCategories, nextCategory.datasetIdentifiers);\r\n                  }\r\n                }\r\n              }\r\n\r\n              return null;\r\n            };\r\n\r\n            const datasetsIdsOrDatasetId = getDatasetsIdsAndSubcategoriesOrDatasetId(\r\n              path,\r\n              catalog.categoryGroups.length === 1 ? catalog.categoryGroups[0].categories : catalog.categoryGroups,\r\n              []\r\n            );\r\n\r\n            if (datasetsIdsOrDatasetId?.datasetIds) {\r\n              return (\r\n                <Results hub={hub} node={node} nodeCode={nodeCode} catalog={catalog}\r\n                         categoryPath={path}\r\n                         datasets={datasetsIdsOrDatasetId.datasetIds.map(id => ({\r\n                           ...catalog.datasets[id],\r\n                           identifier: id,\r\n                           categoryPath: path\r\n                         }))} subCategories={datasetsIdsOrDatasetId.subCategories}\r\n                />);\r\n            } else if (datasetsIdsOrDatasetId) {\r\n              return (\r\n                <DatasetDomain\r\n                  hub={hub} node={node}\r\n                  nodeCode={nodeCode}\r\n                  catalog={catalog}\r\n                  categoryPath={path.slice(0, -1)}\r\n                  datasetId={datasetsIdsOrDatasetId}\r\n                  datasetTitle={catalog.datasets[datasetsIdsOrDatasetId].title}\r\n                  notes={catalog.datasets[datasetsIdsOrDatasetId]?.note}\r\n                  attachedFiles={catalog.datasets[datasetsIdsOrDatasetId]?.attachedDataFiles}\r\n                  referenceMetadataUrl={catalog.datasets[datasetsIdsOrDatasetId]?.referenceMetadata}\r\n                  isAccessible={!!a11yParam}\r\n                />\r\n              );\r\n            } else {\r\n              goToNode(nodeCode);\r\n            }\r\n          }\r\n\r\n          goToNode(nodeCode);\r\n        }}/>\r\n      <Route\r\n        path={`${match.url}/:categoryId`}\r\n        render={({match}) => <Recursive match={match} path={[...path, match.params.categoryId]}/>}\r\n      />\r\n    </Switch>;\r\n\r\n  return (\r\n    <Fragment>\r\n      <Switch>\r\n        <Route\r\n          exact\r\n          path='/:lang/:nodeCode'\r\n          render={props =>\r\n            <MultiLanguageDomain language={props.match.params.lang}>\r\n              <Node\r\n                {...props}\r\n                nodeCode={nodeCode}\r\n                hub={hub}\r\n                node={node}\r\n                catalog={catalog}\r\n              />\r\n            </MultiLanguageDomain>\r\n          }\r\n        />\r\n        <Route\r\n          exact\r\n          path={['/:lang/:nodeCode/dashboards', '/:nodeCode/dashboards']}\r\n          render={({match}) => (\r\n            <MultiLanguageDomain language={match.params.lang}>\r\n              <DashboardsDomain\r\n                hub={hub}\r\n                node={node}\r\n                nodeId={node?.nodeId}\r\n                catalog={catalog}\r\n              />\r\n            </MultiLanguageDomain>\r\n          )}\r\n        />\r\n        {node && nodeCode.toLowerCase() === node.code.toLowerCase() && catalog && (\r\n          <Route\r\n            path='/:lang/:nodeCode/search'\r\n            render={({location, match}) => {\r\n              const query = new URLSearchParams(location.search).get(\"q\");\r\n              const filters =\r\n                (new URLSearchParams(location.search).get(\"c\") || \"\")\r\n                  .split(\"//\").filter(str => str.length > 0).map(decodeURIComponent)\r\n                  .map(filter => filter.split(\"/\")).filter(path => path.length > 0);\r\n\r\n              let filteredCatIds = [];\r\n              filters.forEach(filter => filter.forEach(id => filteredCatIds.push(id)));\r\n              filteredCatIds = [...new Set(filteredCatIds)];\r\n\r\n              if (query && query.length > 0) {\r\n\r\n                const datasetSatisfyQueryOrKeywords = ds =>\r\n                  (ds.title || \"\").toLowerCase().includes(query.toLowerCase()) ||\r\n                  !!ds.keywords?.find(keyword => keyword.toLowerCase().includes(query.toLowerCase()));\r\n\r\n                const categorySatisfyFilters = cat => filteredCatIds.length === 0 || filteredCatIds.includes(cat.id);\r\n\r\n                const datasetsSatisfyQueryOrKeywords = [];\r\n                const datasetsSatisfyFilters = [];\r\n\r\n                // uncategorized datasets\r\n                if (catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0) {\r\n                  catalog.uncategorizedDatasets\r\n                    .map(ds => ({\r\n                          ...ds,\r\n                          categoryPath: [\"uncategorized\"]\r\n                        }))\r\n                        .filter(datasetSatisfyQueryOrKeywords)\r\n                        .forEach(ds => {\r\n                          datasetsSatisfyQueryOrKeywords.push(ds);\r\n                          if (filteredCatIds.length === 0 || filteredCatIds.includes(\"uncategorized\")) {\r\n                            datasetsSatisfyFilters.push(ds);\r\n                          }\r\n                        });\r\n                    }\r\n\r\n                    const searchRecursive = (categories, categoryPath, parentCategorySatisfyFilters) => {\r\n\r\n                      categories.forEach(c => {\r\n\r\n                        const catSatisfyFilters =\r\n                          filteredCatIds.length === 0 ||\r\n                          parentCategorySatisfyFilters ||\r\n                          categorySatisfyFilters(c);\r\n\r\n                        c.datasetIdentifiers\r\n                          .map(id => ({\r\n                            ...catalog.datasets[id],\r\n                            identifier: id\r\n                          }))\r\n                          .filter(datasetSatisfyQueryOrKeywords)\r\n                          .map(ds => ({\r\n                            ...ds,\r\n                            categoryPath: [...categoryPath, c.id]\r\n                          }))\r\n                          .forEach(ds => {\r\n                            datasetsSatisfyQueryOrKeywords.push(ds);\r\n\r\n                            if (catSatisfyFilters) {\r\n                              datasetsSatisfyFilters.push(ds);\r\n                            }\r\n                          });\r\n\r\n                        searchRecursive(c.childrenCategories, [...categoryPath, c.id], catSatisfyFilters);\r\n                      });\r\n                    };\r\n\r\n                    if (catalog.categoryGroups.length > 1) {\r\n                      catalog.categoryGroups.map(group =>\r\n                        searchRecursive(\r\n                          group.categories,\r\n                          [group.id],\r\n                          filteredCatIds.length === 0 || filteredCatIds.includes(group.id)\r\n                        ));\r\n                    } else if (catalog.categoryGroups.length === 1) {\r\n                      searchRecursive(catalog.categoryGroups[0].categories, [], false);\r\n                    }\r\n\r\n                    // for each category, count datasets which satisfy query or keywords in the subtree of that category\r\n\r\n                    const datasetsSatisfyQueryOrKeywordsMap = {};\r\n                    datasetsSatisfyQueryOrKeywords.forEach(ds => datasetsSatisfyQueryOrKeywordsMap[ds.identifier] = ds);\r\n\r\n                    const recursiveCountAndFilterZero = tree => tree.map(node => {\r\n\r\n                      const children = recursiveCountAndFilterZero(node.childrenCategories || node.categories).filter(({count}) => count > 0);\r\n\r\n                      return ({\r\n                        ...node,\r\n                        childrenCategories: node.childrenCategories ? children : undefined,\r\n                        categories: node.categories ? children : undefined,\r\n                        count:\r\n                          children.reduce((acc, node) => acc + node.count, 0) +\r\n                          (node.datasetIdentifiers?.filter(dsId => datasetsSatisfyQueryOrKeywordsMap[dsId] !== undefined).length || 0)\r\n                      });\r\n                    }).filter(({count}) => count > 0);\r\n\r\n                    const categoryGroupsWithCount = recursiveCountAndFilterZero(catalog.categoryGroups);\r\n\r\n                    const uncategorizedDatasetsCount = catalog.uncategorizedDatasets.filter(({identifier}) => datasetsSatisfyQueryOrKeywordsMap[identifier] !== undefined).length;\r\n\r\n                    // remove duplicates from datasetsSatisfyFilters ( O(2n) )\r\n                    const datasetsSatisfyFiltersMap = {};\r\n                    datasetsSatisfyFilters.forEach(ds => {\r\n                      datasetsSatisfyFiltersMap[ds.identifier] = ds\r\n                    });\r\n                    const uniqueDatasets = Object.keys(datasetsSatisfyFiltersMap).map(id => datasetsSatisfyFiltersMap[id]);\r\n\r\n                    return (\r\n                      <MultiLanguageDomain language={match.params.lang}>\r\n                        <Results query={query}\r\n                                 filters={filters}\r\n                                 filtered\r\n                                 hub={hub}\r\n                                 node={node}\r\n                                 nodeCode={nodeCode}\r\n                                 catalog={catalog}\r\n                                 datasets={uniqueDatasets}\r\n                                 categoryGroupsWithCount={categoryGroupsWithCount}\r\n                                 uncategorizedDatasetsCount={uncategorizedDatasetsCount}\r\n                        />\r\n                      </MultiLanguageDomain>\r\n                    );\r\n              } else {\r\n                goToNode(nodeCode);\r\n              }\r\n            }}\r\n          />\r\n        )}\r\n        {node && nodeCode.toLowerCase() === node.code.toLowerCase() && catalog && (\r\n          <Route\r\n            path='/:lang/:nodeCode/:path'\r\n            render={({match}) =>\r\n              <MultiLanguageDomain language={match.params.lang}>\r\n                <Recursive match={match} path={[match.params.path]}/>\r\n              </MultiLanguageDomain>\r\n            }\r\n          />\r\n        )}\r\n      </Switch>\r\n    </Fragment>\r\n  )\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(NodeDomain);","import React, {Fragment, useEffect} from 'react';\r\nimport {Route, Switch} from \"react-router\";\r\nimport Home from \"../components/home\";\r\nimport {connect} from \"react-redux\";\r\nimport {fetchHub} from \"../state/hub/hubActions\";\r\nimport NodeDomain from \"./NodeDomain\";\r\nimport {HashRouter} from \"react-router-dom\";\r\nimport DashboardsDomain from \"./DashboardsDomain\";\r\nimport {goToHome} from \"../links\";\r\nimport Call from \"../hocs/call\";\r\nimport MultiLanguageDomain from \"./MultiLanguageDomain\";\r\nimport {showUserSetPasswordForm} from \"../state/user/userActions\";\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub,\r\n  defaultLanguage: state.app.language\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchHub: () => dispatch(fetchHub()),\r\n  onUserSetPasswordFormShow: token => dispatch(showUserSetPasswordForm(token))\r\n});\r\n\r\nconst HubDomain = ({hub, fetchHub, onUserSetPasswordFormShow}) => {\r\n\r\n  useEffect(() => {\r\n    if (!hub) {\r\n      fetchHub();\r\n    }\r\n  }, [hub, fetchHub]);\r\n\r\n  return (\r\n    <Fragment>\r\n      {hub && (\r\n        <HashRouter>\r\n          <Switch>\r\n            <Route path='/' exact render={props =>\r\n              <Home {...props} hub={hub}/>\r\n            }/>\r\n            <Route path='/:lang' exact render={props =>\r\n              <MultiLanguageDomain language={props.match.params.lang}>\r\n                <Home {...props} hub={hub}/>\r\n              </MultiLanguageDomain>\r\n            }/>\r\n            <Route\r\n              path='/:lang/dashboards'\r\n              exact\r\n              render={props =>\r\n                <MultiLanguageDomain language={props.match.params.lang}>\r\n                  <DashboardsDomain {...props} hub={hub}/>\r\n                </MultiLanguageDomain>\r\n              }\r\n            />\r\n            <Route\r\n              path='/:lang/dashboards/:dashboardId'\r\n              render={props =>\r\n                <MultiLanguageDomain language={props.match.params.lang}>\r\n                  <DashboardsDomain {...props} hub={hub}\r\n                                    dashboardId={props.match.params.dashboardId}/>\r\n                </MultiLanguageDomain>\r\n              }\r\n            />\r\n            <Route path='/:lang/resetPassword'\r\n                   render={props => {\r\n\r\n                     const tokenParam = new URLSearchParams(props.location.search).get(\"token\");\r\n\r\n                     if (tokenParam) {\r\n\r\n                       return (\r\n                         <MultiLanguageDomain language={props.match.params.lang}>\r\n                           <Call cb={onUserSetPasswordFormShow} cbParam={tokenParam}>\r\n                             <Home {...props} hub={hub}/>\r\n                           </Call>\r\n                         </MultiLanguageDomain>\r\n                       );\r\n                     } else {\r\n                       goToHome();\r\n                     }\r\n                   }}\r\n            />\r\n            <Route path='/:lang/:nodeCode'\r\n                   render={props => {\r\n                     if (hub.nodes.find(({code}) => code.toLowerCase() === props.match.params.nodeCode.toLowerCase())) {\r\n                       return (\r\n                         <MultiLanguageDomain language={props.match.params.lang}>\r\n                           <NodeDomain\r\n                             {...props}\r\n                             hub={hub}\r\n                             nodeCode={props.match.params.nodeCode}\r\n                           />\r\n                         </MultiLanguageDomain>\r\n                       );\r\n                     } else {\r\n                       goToHome();\r\n                     }\r\n                   }}\r\n            />\r\n          </Switch>\r\n        </HashRouter>\r\n      )}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(HubDomain);\r\n","import React from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport {DialogActions} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {closeDeleteConflictModal} from \"../../state/delete-conflict-modal/deleteConflictModalActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst getObjectTranslation = t => ({\r\n  dashboard: t(\"components.deleteConflictModal.objectType.dashboard\"),\r\n  view: t(\"components.deleteConflictModal.objectType.view\"),\r\n  node: t(\"components.deleteConflictModal.objectType.node\"),\r\n});\r\n\r\nconst DeleteConflictModal = ({\r\n                               response,\r\n                               onClose,\r\n                               onForce\r\n                             }) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={!!response}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n      onClose={onClose}\r\n    >\r\n      <DialogTitle>\r\n        {t(\"components.deleteConflictModal.title\")}\r\n      </DialogTitle>\r\n      {response?.usedBy?.length > 0 && (\r\n        <DialogContent>\r\n          {onForce\r\n            ? <p>{t(\"components.deleteConflictModal.contentTitleWithForce\")}</p>\r\n            : <p>{t(\"components.deleteConflictModal.contentTitle\")}</p>\r\n          }\r\n          <div>\r\n            {response.usedBy.map(({type, title, id}, index) =>\r\n              <ul key={index}>{getObjectTranslation(t)[type]} {id} - {title}</ul>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      )}\r\n      <DialogActions>\r\n        <Button onClick={onClose}>\r\n          {t(\"commons.confirm.close\")}\r\n        </Button>\r\n        {onForce && (\r\n          <Button onClick={onForce}>\r\n            {t(\"components.deleteConflictModal.force\")}\r\n          </Button>\r\n        )}\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default connect(\r\n  state => ({\r\n    response: state.deleteConflictModal.response\r\n  }),\r\n  dispatch => ({\r\n    onClose: () => dispatch(closeDeleteConflictModal())\r\n  })\r\n)(DeleteConflictModal);","export const DELETE_CONFLICT_MODAL_CLOSE = \"deleteConflictModal/close\";\r\n\r\nexport const closeDeleteConflictModal = () => ({\r\n    type: DELETE_CONFLICT_MODAL_CLOSE\r\n});","import React from 'react';\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {goToHome} from \"../../links\";\r\n\r\nconst styles = theme => ({\r\n  container: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    height: \"100%\",\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    overflow: \"hidden\",\r\n    fontSize: 24\r\n  },\r\n  icon: {\r\n    marginBottom: theme.spacing(1),\r\n    fontSize: 38\r\n  },\r\n  goHome: {\r\n    marginTop: theme.spacing(2),\r\n    textDecoration: \"underline\",\r\n    cursor: \"pointer\",\r\n    color: theme.palette.secondary.main\r\n  }\r\n});\r\n\r\nclass ErrorBoundary extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {hasError: false};\r\n  }\r\n\r\n  componentDidCatch(error, info) {\r\n    this.setState({hasError: true});\r\n  }\r\n\r\n  render() {\r\n\r\n    const {classes} = this.props;\r\n\r\n    if (this.state.hasError) {\r\n\r\n      return (\r\n        <div className={classes.container} style={{color: \"white\"}}>\r\n          <div>\r\n            <Grid container justify=\"center\" className={classes.icon}>\r\n              <Grid item>\r\n                <ErrorOutlineIcon fontSize=\"inherit\"/>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container justify=\"center\">\r\n              <Grid item>\r\n                Something went wrong\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container justify=\"center\" className={classes.goHome}>\r\n              <Grid item>\r\n                <div onClick={() => {\r\n                  goToHome();\r\n                  window.location.reload();\r\n                }}>\r\n                  Go to home\r\n                </div>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </div>\r\n      );\r\n\r\n    } else {\r\n      return this.props.children;\r\n    }\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(ErrorBoundary);","import React, {forwardRef, Fragment, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\nimport {setUserPassword} from \"../../../state/user/userActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch} = useForm();\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showPasswordConfirm, setShowPasswordConfirm] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        onSubmit(val);\r\n        f(val);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"email\"\r\n            label={t(\"components.userSetPasswordDialog.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowPassword(!showPassword)}\r\n                  >\r\n                    {showPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"password\"\r\n            label={t(\"components.userSetPasswordDialog.fields.password\")}\r\n            error={!!errors.password}\r\n            helperText={errors.password?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showPassword ? undefined : \"password\"}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowPassword(!showPassword)}\r\n                  >\r\n                    {showPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"passwordConfirm\"\r\n            label={t(\"components.userSetPasswordDialog.fields.passwordConfirm\")}\r\n            error={!!errors.passwordConfirm}\r\n            helperText={errors.passwordConfirm?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showPasswordConfirm ? undefined : \"password\"}\r\n            inputRef={\r\n              register({\r\n                required: t(\"commons.validation.required\"),\r\n                validate: val =>\r\n                  val === watch('password') ||\r\n                  t(\"components.userSetPasswordDialog.validation.passwordMustBeEqual\")\r\n              })}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowPasswordConfirm(!showPasswordConfirm)}\r\n                  >\r\n                    {showPasswordConfirm ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  sendConfig: (token, config) => dispatch(setUserPassword(config.email, token, config.password)),\r\n});\r\n\r\nconst UserSetPasswordForm = ({config, token, sendConfig, userErrors}, ref) => {\r\n\r\n  return (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>)\r\n      )}\r\n      <Form\r\n        ref={ref}\r\n        onSubmit={config => sendConfig(token, config)}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserSetPasswordForm);\r\n","import React, {useRef} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport UserSetPasswordForm from \"./user-set-password-form\";\r\nimport {hideUserSetPasswordForm} from \"../../state/user/userActions\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onClose: () => dispatch(hideUserSetPasswordForm())\r\n});\r\n\r\nconst UserSetPasswordDialog = ({user, onClose}) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const setPasswordFormRef = useRef();\r\n\r\n  return (\r\n    <SettingsDialog\r\n      title={t(\"components.userSetPasswordDialog.title\")}\r\n      maxWidth={\"xs\"}\r\n      open={user.isSetPasswordDialogOpen || false}\r\n      onClose={() => {\r\n        if (setPasswordFormRef.current) {\r\n          setPasswordFormRef.current.cancel(() => {\r\n            onClose();\r\n          });\r\n        } else {\r\n          onClose();\r\n        }\r\n      }}\r\n      onSubmit={() => {\r\n        if (setPasswordFormRef.current) {\r\n          setPasswordFormRef.current.submit(() => {\r\n          });\r\n        }\r\n      }}\r\n      hasSubmit\r\n      noMinHeight\r\n    >\r\n      <UserSetPasswordForm ref={setPasswordFormRef} token={user.setPasswordToken}/>\r\n    </SettingsDialog>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserSetPasswordDialog);\r\n","import React from 'react';\r\nimport {ThemeProvider} from \"@material-ui/core/styles\";\r\nimport {createMuiTheme, CssBaseline} from \"@material-ui/core\";\r\nimport NotImplementedSnackbar from \"./components/not-implemented-snackbar/NotImplementedSnackbar\";\r\nimport Spinner from \"./components/spinner/Spinner\";\r\nimport ErrorSnackbar from \"./components/error-snackbar/ErrorSnackbar\";\r\nimport HubDomain from \"./domains/HubDomain\";\r\nimport Helmet from \"react-helmet\";\r\nimport {connect} from \"react-redux\";\r\nimport DeleteConflictModal from \"./components/delete-conflict-modal\";\r\nimport ErrorBoundary from \"./components/error-boundary\";\r\nimport UserSetPasswordDialog from \"./components/user-set-password-dialog\";\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    text: {\r\n      primary: \"#00295a\"\r\n    },\r\n    primary: {\r\n      main: \"#00295a\",\r\n      light: \"#3b5187\",\r\n      dark: \"#000030\",\r\n      contrastText: \"#ffffff\"\r\n    },\r\n    secondary: {\r\n      main: \"#f8a81e\",\r\n      light: \"#ffd956\",\r\n      dark: \"#c07900\",\r\n      contrastText: \"#00295a\"\r\n    }\r\n  }\r\n});\r\n\r\nconst App = ({language}) =>\r\n  <ThemeProvider theme={theme}>\r\n    <Helmet>\r\n      <html lang={language}/>\r\n    </Helmet>\r\n    <CssBaseline/>\r\n    <ErrorBoundary>\r\n      <Spinner>\r\n        <NotImplementedSnackbar/>\r\n        <ErrorSnackbar/>\r\n        <DeleteConflictModal/>\r\n        <UserSetPasswordDialog/>\r\n        <HubDomain/>\r\n      </Spinner>\r\n    </ErrorBoundary>\r\n  </ThemeProvider>;\r\n\r\nexport default connect(state => ({\r\n  language: state.app.language\r\n}))(App);","import {Reducer} from \"@reduxjs/toolkit\";\r\nimport {IHub} from \"../../model/IHub\";\r\nimport {IHubMinimalNode} from \"../../model/IHubMinimalNode\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {HUB_FETCH} from \"./hubActions\";\r\n\r\nexport type HubState = {\r\n  hub: IHub,\r\n  nodes: IHubMinimalNode[]\r\n} | null;\r\n\r\nconst hubReducer: Reducer<HubState> = (\r\n  state: HubState = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case HUB_FETCH: {\r\n          return ({\r\n            hub: action.payload.response.hub,\r\n            nodes: action.payload.response.nodes\r\n          });\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default hubReducer;","import {IHubNode} from \"../../model/IHubNode\";\r\nimport {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {NODE_FETCH} from \"./nodeActions\";\r\n\r\nexport type NodeState = IHubNode | null;\r\n\r\nconst nodeReducer: Reducer<NodeState> = (\r\n  state = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODE_FETCH: {\r\n          return action.payload.response;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodeReducer;","import {ICategoryProvider} from \"./ICategoryProvider\";\r\nimport {IFilter} from \"./IFilter\";\r\nimport {ICategoryGroup} from \"./ICategoryGroup\";\r\nimport {ICategory} from \"./ICategory\";\r\nimport {IDataset} from \"./IDataset\";\r\n\r\nexport class LocalCategoryProvider implements ICategoryProvider {\r\n\r\n  categoryGroups: Array<ICategoryGroup>;\r\n\r\n  datasets: Map<String, IDataset>;\r\n\r\n  uncategorizedDatasets: IDataset[];\r\n\r\n  nodeId: number;\r\n\r\n  constructor(categories: Array<ICategoryGroup>, datasets: Map<String, IDataset>, uncategorizedDatasets: IDataset[] = [], nodeId: number = -1) {\r\n    this.datasets = datasets || {};\r\n    this.categoryGroups = categories || [];\r\n    this.uncategorizedDatasets = uncategorizedDatasets || [];\r\n    this.nodeId = nodeId || -1;\r\n  }\r\n\r\n  searchCategories(filter?: IFilter): Array<ICategory> {\r\n\r\n    let result: Array<ICategory> = [];\r\n\r\n    let searchText: string;\r\n    if (filter) {\r\n      searchText = filter.text.toLowerCase();\r\n    }\r\n\r\n    this.categoryGroups.forEach(categ => {\r\n\r\n      if (!searchText) {\r\n        result.push(...categ.categories);\r\n      } else {\r\n        categ.categories.forEach(category => {\r\n          let matchFound: boolean = category.label.toLowerCase().indexOf(searchText) >= 0;\r\n\r\n          if (matchFound) {\r\n            result.push(category);\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  searchDataset(filter?: IFilter): IDataset[] {\r\n    return [];\r\n  }\r\n}","import {ReducersMapObject} from \"redux\";\r\nimport hubReducer from \"./hub/hubReducer\";\r\nimport nodeReducer from \"./node/nodeReducer\";\r\nimport catalogReducer from \"./catalog/catalogReducer\";\r\nimport datasetReducer from \"./dataset/datasetReducer\";\r\nimport appReducer from \"./app/appReducer\";\r\nimport hubConfigReducer from \"./hubConfig/hubConfigReducer\";\r\nimport spinnerReducer from \"./spinner/spinnerReducer\";\r\nimport appConfigReducer from \"./appConfig/appConfigReducer\";\r\nimport nodesConfigReducer from \"./nodesConfig/nodesConfigReducer\";\r\nimport cacheReducer from \"./cache/cacheReducer\";\r\nimport otherConfigReducer from \"./otherConfig/otherConfigReducer\";\r\nimport nodeTemplatesConfigReducer from \"./noteTemplatesConfig/nodeTemplatesConfigReducer\";\r\nimport userReducer from './user/userReducer';\r\nimport usersConfigReducer from \"./usersConfig/usersConfigReducer\";\r\nimport dashboardReducer from \"./dashboard/dashboardReducer\";\r\nimport nodePermissionsConfigReducer from './nodePermissionsConfig/nodePermissionsConfigReducer';\r\nimport deleteConflictModalReducer from './delete-conflict-modal/deleteConflictModalReducer';\r\n\r\nconst rootReducer: ReducersMapObject = ({\r\n  spinner: spinnerReducer,\r\n  config: appConfigReducer,\r\n  app: appReducer,\r\n  hub: hubReducer,\r\n  node: nodeReducer,\r\n  nodeTemplatesConfig: nodeTemplatesConfigReducer,\r\n  catalog: catalogReducer,\r\n  dataset: datasetReducer,\r\n  hubConfig: hubConfigReducer,\r\n  nodesConfig: nodesConfigReducer,\r\n  cacheConfig: cacheReducer,\r\n  otherConfig: otherConfigReducer,\r\n  user: userReducer,\r\n  usersConfig: usersConfigReducer,\r\n  dashboard: dashboardReducer,\r\n  nodePermissionsConfig: nodePermissionsConfigReducer,\r\n  deleteConflictModal: deleteConflictModalReducer\r\n});\r\n\r\nexport default rootReducer;","import {Reducer} from \"redux\";\r\nimport {\r\n  SPINNER_FLUSH,\r\n  SPINNER_MESSAGE_ADD,\r\n  SPINNER_MESSAGE_REMOVE,\r\n  SPINNER_TIMEOUT_CLEAR,\r\n  SPINNER_TIMEOUT_SET\r\n} from \"./spinnerActions\";\r\n\r\nexport type SpinnerState = {\r\n  messages: any[],\r\n  timeout: any\r\n};\r\n\r\nconst spinnerReducer: Reducer<SpinnerState> = (\r\n  state = {\r\n    messages: [],\r\n    timeout: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case SPINNER_MESSAGE_ADD: {\r\n      return {\r\n        ...state,\r\n        messages: [...state.messages, ({uid: action.payload.uid, message: action.payload.message, removed: false})]\r\n      };\r\n    }\r\n    case SPINNER_MESSAGE_REMOVE: {\r\n      return {\r\n        ...state,\r\n        messages: [\r\n          ...state.messages.map(message => message.uid !== action.payload.uid ? message : ({...message, removed: true, isError: action.payload.isError}))\r\n        ]\r\n      };\r\n    }\r\n    case SPINNER_TIMEOUT_SET: {\r\n      return {\r\n        ...state,\r\n        timeout: action.payload.timeout\r\n      };\r\n    }\r\n    case SPINNER_TIMEOUT_CLEAR: {\r\n      return {\r\n        ...state,\r\n        timeout: null\r\n      };\r\n    }\r\n    case SPINNER_FLUSH: {\r\n      if (state.timeout) {\r\n        clearTimeout(state.timeout);\r\n      }\r\n      return {\r\n        ...state,\r\n        timeout: null,\r\n        messages: []\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default spinnerReducer;","import {Reducer} from \"redux\";\r\nimport {INIT} from '../rootActions';\r\n\r\nexport type AppConfigState = {\r\n  baseURL: string\r\n} | null;\r\n\r\nconst appConfigReducer: Reducer<AppConfigState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n  switch (action.type) {\r\n    case INIT: {\r\n      return {\r\n        baseURL: action.payload.baseURL\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default appConfigReducer;","import {Reducer} from \"redux\";\r\nimport {APP_LANGUAGE_SET} from \"./appActions\";\r\nimport {INIT} from '../rootActions';\r\nimport {PERSISTENCE_ACTION_KEY} from '../../middlewares/persistence/middleware';\r\nimport _ from \"lodash\";\r\n\r\nexport type AppState = {\r\n    language: string,\r\n    languages: string[]\r\n} | null\r\n    ;\r\nconst appReducer: Reducer<AppState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT:\r\n            const initialState = {\r\n                language: action.payload.defaultLanguage,\r\n                languages: action.payload.supportedLanguages\r\n            };\r\n            return _.merge(initialState, action.payload[PERSISTENCE_ACTION_KEY].app) || initialState;\r\n        case APP_LANGUAGE_SET: {\r\n            return {\r\n                ...state,\r\n                language: action.payload.language\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default appReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {NODE_TEMPLATES_CONFIG_CLEAR, NODE_TEMPLATES_CONFIG_FETCH} from \"./nodeTemplatesConfigActions\";\r\n\r\nexport type NodesConfigState = {\r\n  templates: any[] | null\r\n};\r\n\r\nconst nodeTemplatesConfigReducer: Reducer<NodesConfigState> = (\r\n  state = {\r\n    templates: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODE_TEMPLATES_CONFIG_CLEAR: {\r\n      return {\r\n        ...state,\r\n        templates: null\r\n      };\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODE_TEMPLATES_CONFIG_FETCH: {\r\n          return {\r\n            ...state,\r\n            templates: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodeTemplatesConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {CATALOG_FETCH} from \"./catalogActions\";\r\nimport {ICategoryProvider} from \"../../model/ICategoryProvider\";\r\nimport {LocalCategoryProvider} from \"../../model/LocalCategoryProvider\";\r\n\r\nexport type CatalogState = ICategoryProvider | null;\r\n\r\nconst catalogReducer: Reducer<CatalogState> = (\r\n  state = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case CATALOG_FETCH: {\r\n          return null;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case CATALOG_FETCH: {\r\n          return new LocalCategoryProvider(\r\n            action.payload.response.categoryGroups,\r\n            action.payload.response.datasetMap,\r\n            action.payload.response.datasetUncategorized,\r\n            action.payload.extra.nodeId\r\n          );\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default catalogReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  HUB_CONFIG_CLEAR,\r\n  HUB_CONFIG_DASHBOARDS_CLEAR,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n  HUB_CONFIG_DASHBOARDS_FETCH,\r\n  HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n  HUB_CONFIG_FETCH,\r\n  HUB_CONFIG_SEND,\r\n  HUB_CONFIG_DASHBOARDS_CLEAR_ALL,\r\n  HUB_CONFIG_DASHBOARDS_FETCH_ALL\r\n} from \"./hubConfigActions\";\r\n\r\nexport type HubConfigState = {\r\n  hub: any | null,\r\n  hubDashboards: any[] | null,\r\n  allDashboards: any[] | null\r\n};\r\n\r\nconst hubConfigReducer: Reducer<HubConfigState> = (\r\n    state = {\r\n      hub: null,\r\n      hubDashboards: null,\r\n      allDashboards: null\r\n    },\r\n    action\r\n) => {\r\n  switch (action.type) {\r\n    case HUB_CONFIG_CLEAR: {\r\n      return {\r\n        ...state,\r\n        hub: null\r\n      };\r\n    }\r\n    case HUB_CONFIG_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        hubDashboards: null\r\n      };\r\n    }\r\n    case HUB_CONFIG_DASHBOARDS_CLEAR_ALL: {\r\n      return {\r\n        ...state,\r\n        allDashboards: null\r\n      };\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case HUB_CONFIG_FETCH: {\r\n          return {\r\n            ...state,\r\n            hub: action.payload.response[0]\r\n          }\r\n        }\r\n        case HUB_CONFIG_SEND: {\r\n          return {\r\n            ...state,\r\n            hub: null,\r\n            hubDashboards: null\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            hubDashboards: action.payload.response\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_FETCH_ALL: {\r\n          return {\r\n            ...state,\r\n            allDashboards: action.payload.response\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD:\r\n          return {\r\n            ...state,\r\n            allDashboards: null,\r\n            hubDashboards: null\r\n          };\r\n        case HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE:\r\n        case HUB_CONFIG_DASHBOARDS_ORDERS_SEND:\r\n          return {\r\n            ...state,\r\n            hubDashboards: null\r\n          }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default hubConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_START, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  NODES_CONFIG_NODE_CLEAR,\r\n  NODES_CONFIG_NODE_CREATE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_CLEAR,\r\n  NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_FETCH,\r\n  NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL,\r\n  NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n  NODES_CONFIG_NODE_EDIT,\r\n  NODES_CONFIG_NODE_FETCH,\r\n  NODES_CONFIG_NODES_CLEAR,\r\n  NODES_CONFIG_NODES_FETCH\r\n} from \"./nodesConfigActions\";\r\nimport {IHubNode} from \"../../model/IHubNode\";\r\n\r\nexport type NodesConfigState = {\r\n  nodes: IHubNode[] | null,\r\n  node: IHubNode | null,\r\n  nodeDashboards: any[] | null,\r\n  allDashboards: any[] | null\r\n};\r\n\r\nconst nodesConfigReducer: Reducer<NodesConfigState> = (\r\n  state = {\r\n    nodes: null,\r\n    node: null,\r\n    nodeDashboards: null,\r\n    allDashboards: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODES_CONFIG_NODES_CLEAR: {\r\n      return {\r\n        ...state,\r\n        nodes: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_CLEAR: {\r\n      return {\r\n        ...state,\r\n        node: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        nodeDashboards: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL: {\r\n      return {\r\n        ...state,\r\n        allDashboards: null\r\n      };\r\n    }\r\n    case REQUEST_START: {\r\n      switch (action.payload.label) {\r\n        case NODES_CONFIG_NODE_EDIT: {\r\n          return {\r\n            ...state,\r\n            node: null\r\n          };\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODES_CONFIG_NODES_FETCH: {\r\n          return {\r\n            ...state,\r\n            nodes: action.payload.response\r\n          };\r\n        }\r\n        case NODES_CONFIG_NODE_FETCH: {\r\n          return {\r\n            ...state,\r\n            node: action.payload.response\r\n          }\r\n        }\r\n        case NODES_CONFIG_NODE_CREATE:\r\n        case NODES_CONFIG_NODE_EDIT:\r\n          return {\r\n            ...state,\r\n            node: null\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_FETCH:\r\n          return {\r\n            ...state,\r\n            nodeDashboards: action.payload.response\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL:\r\n          return {\r\n            ...state,\r\n            allDashboards: action.payload.response\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD:\r\n          return {\r\n            ...state,\r\n            allDashboards: null,\r\n            nodeDashboards: null\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE:\r\n        case NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND:\r\n          return {\r\n            ...state,\r\n            nodeDashboards: null\r\n          }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodesConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {IDataflowCache} from \"../../model/IDataflowCache\";\r\nimport {\r\n  DATAFLOW_CACHE_CLEAR,\r\n  DATAFLOW_CACHE_CREATE,\r\n  DATAFLOW_CACHE_DELETE,\r\n  DATAFLOW_CACHE_FETCH,\r\n  DATAFLOW_CACHE_UPDATE\r\n} from \"./cacheActions\";\r\n\r\nexport type DataflowCacheState =  IDataflowCache[] | null;\r\n\r\nconst cacheReducer: Reducer<DataflowCacheState> = (\r\n  state =  null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DATAFLOW_CACHE_FETCH: {\r\n          return action.payload.response;\r\n        }\r\n        case DATAFLOW_CACHE_UPDATE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.id === action.payload.extra.cacheId && e.nodeId === action.payload.extra.nodeId) {\r\n                  e.ttl = action.payload.extra.ttl;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        case DATAFLOW_CACHE_CREATE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.dataflowId === action.payload.extra.oldData.dataflowId && e.nodeId === action.payload.extra.oldData.nodeId) {\r\n                  e.ttl = action.payload.response.ttl;\r\n                  e.id = action.payload.response.id;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        case DATAFLOW_CACHE_DELETE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.id === action.payload.extra.cacheId && e.nodeId === action.payload.extra.nodeId) {\r\n                  e.cacheSize = 0;\r\n                  e.cachedDataflow = 0;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DATAFLOW_CACHE_FETCH: {\r\n          return null;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case DATAFLOW_CACHE_CLEAR: {\r\n      return null;\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default cacheReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  OTHER_CONFIG_DASHBOARD_CHANGE,\r\n  OTHER_CONFIG_DASHBOARD_CREATE,\r\n  OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT,\r\n  OTHER_CONFIG_DASHBOARD_DATASET_CLEAR,\r\n  OTHER_CONFIG_DASHBOARD_DATASET_FETCH,\r\n  OTHER_CONFIG_DASHBOARD_DELETE,\r\n  OTHER_CONFIG_DASHBOARD_HIDE,\r\n  OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR,\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_FETCH,\r\n  OTHER_CONFIG_DASHBOARDS_CLEAR,\r\n  OTHER_CONFIG_DASHBOARDS_FETCH,\r\n  OTHER_CONFIG_VIEW_DELETE,\r\n  OTHER_CONFIG_VIEWS_CLEAR,\r\n  OTHER_CONFIG_VIEWS_FETCH\r\n} from \"./otherConfigActions\";\r\nimport _ from \"lodash\"\r\nimport {DASHBOARD_VIEW_STATE_ERROR, DASHBOARD_VIEW_STATE_FETCHING} from \"../dashboard/dashboardReducer\";\r\n\r\nexport type OtherConfigState = {\r\n  views: any[] | null,\r\n  needDashboards: boolean,\r\n  dashboards: any[] | null,\r\n  dashboard: any[] | null,\r\n  dashboardViews: any[] | null,\r\n  dashboardJsonStats: any,\r\n  dashboardMaps: any,\r\n};\r\n\r\nconst otherConfigReducer: Reducer<OtherConfigState> = (\r\n  state = {\r\n    views: null,\r\n    needDashboards: false,\r\n    dashboards: null,\r\n    dashboard: null,\r\n    dashboardViews: null,\r\n    dashboardJsonStats: null,\r\n    dashboardMaps: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case OTHER_CONFIG_VIEWS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        views: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboardViews: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboards: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_CREATE: {\r\n      return {\r\n        ...state,\r\n        dashboard: action.payload.dashboard\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_CHANGE: {\r\n      return {\r\n        ...state,\r\n        dashboard: action.payload.dashboard\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_HIDE: {\r\n      return {\r\n        ...state,\r\n        dashboard: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_DATASET_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboardJsonStats: null,\r\n        dashboardMaps: null\r\n      };\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            needDashboards: false\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: DASHBOARD_VIEW_STATE_FETCHING\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_VIEWS_FETCH: {\r\n          return {\r\n            ...state,\r\n            views: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_VIEWS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboardViews: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        case OTHER_CONFIG_VIEW_DELETE: {\r\n          return {\r\n            ...state,\r\n            views: null\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboards: action.payload.response\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_UPDATE: {\r\n          return {\r\n            ...state,\r\n            dashboard: {\r\n              ...action.payload.response,\r\n              dashboardConfig: action.payload.response?.dashboardConfig\r\n                ? JSON.parse(action.payload.response.dashboardConfig)\r\n                : {},\r\n              filterLevels: action.payload.response?.filterLevels\r\n                ? JSON.parse(action.payload.response.filterLevels)\r\n                : {}\r\n            }\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DELETE:\r\n        case OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT:\r\n        case OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            needDashboards: true\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n          const jsonStat = (action.payload.response?.id || []).length > 0\r\n            ? action.payload.response\r\n            : \"\";\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: jsonStat\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats\r\n          }\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any, idx: number) => val.nutsLevel)\r\n            .reduce((acc: any, val: any) => {\r\n              if (!acc[val]) {\r\n                const label = \"Nuts level \" + val;\r\n                acc[val] = {level: val, counter: 0, label: label};\r\n              }\r\n              acc[val].counter++;\r\n              return acc;\r\n            }, []);\r\n\r\n          return {\r\n            ...state,\r\n            dashboardMaps: {\r\n              ...state.dashboardMaps,\r\n              [action.payload.extra.requestId]: {\r\n                geometries: action.payload.response,\r\n                geometryDetailLevels: detailLevels\r\n              }\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_ERROR:\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboards: action.payload.statusCode === 404 ? [] : null\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: DASHBOARD_VIEW_STATE_ERROR\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default otherConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_START, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    USERS_CONFIG_USER_CLEAR,\r\n    USERS_CONFIG_USER_CREATE,\r\n    USERS_CONFIG_USER_EDIT,\r\n    USERS_CONFIG_USER_FETCH,\r\n    USERS_CONFIG_USERS_CLEAR,\r\n    USERS_CONFIG_USERS_FETCH,\r\n    USER_CONFIG_FORM_SHOW, USER_CONFIG_FORM_HIDE\r\n} from \"./usersConfigActions\";\r\n\r\nexport type User = {\r\n\r\n};\r\n\r\nexport type UsersConfigState = {\r\n    users: User[] | null,\r\n    user: User | null,\r\n    userErrors: string[] | null,\r\n    userId: number | null,\r\n    isSetPasswordDialogOpen: boolean,\r\n    setPasswordToken: string | null\r\n};\r\n\r\nconst usersConfigReducer: Reducer<UsersConfigState> = (\r\n    state = {\r\n        users: null,\r\n        user: null,\r\n        userErrors: null,\r\n        userId: null,\r\n        isSetPasswordDialogOpen: false,\r\n        setPasswordToken: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case USER_CONFIG_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                userId: action.payload.userId\r\n            };\r\n        case USER_CONFIG_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                user: null,\r\n                userId: null,\r\n                userErrors: null\r\n            };\r\n        case USERS_CONFIG_USERS_CLEAR: {\r\n            return {\r\n                ...state,\r\n                users: null\r\n            };\r\n        }\r\n        case USERS_CONFIG_USER_CLEAR: {\r\n            return {\r\n                ...state,\r\n                user: null\r\n            };\r\n        }\r\n        case REQUEST_START: {\r\n            switch (action.payload.label) {\r\n                case USERS_CONFIG_USER_EDIT: {\r\n                    return {\r\n                        ...state,\r\n                        user: null\r\n                    };\r\n                }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case USERS_CONFIG_USERS_FETCH: {\r\n                    return {\r\n                        ...state,\r\n                        users: action.payload.response\r\n                    };\r\n                }\r\n                case USERS_CONFIG_USER_FETCH: {\r\n                    return {\r\n                        ...state,\r\n                        user: action.payload.response\r\n                    }\r\n                }\r\n                case USERS_CONFIG_USER_CREATE:\r\n                case USERS_CONFIG_USER_EDIT:\r\n                    if (action.payload.response.haveError) {\r\n                        return {\r\n                            ...state,\r\n                            userErrors: action.payload.response.errors\r\n                        };\r\n                    } else {\r\n                        return {\r\n                            ...state,\r\n                            user: null,\r\n                            userErrors: null,\r\n                            userId: null\r\n                        };\r\n                    }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default usersConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    NODE_PERMISSIONS_CONFIG_CLEAR,\r\n    NODE_PERMISSIONS_CONFIG_FETCH,\r\n    NODE_PERMISSIONS_CONFIG_SEND\r\n} from './nodePermissionsConfigActions';\r\n\r\nexport type NodePermissionsConfigState = {\r\n    permissions: any[] | null\r\n};\r\n\r\nconst nodePermissionsConfigReducer: Reducer<NodePermissionsConfigState> = (\r\n    state = {\r\n        permissions: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case NODE_PERMISSIONS_CONFIG_CLEAR: {\r\n            return {\r\n                ...state,\r\n                permissions: null\r\n            };\r\n        }\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case NODE_PERMISSIONS_CONFIG_FETCH: {\r\n                    return {\r\n                        state,\r\n                        permissions: action.payload.response\r\n                    };\r\n                }\r\n                case NODE_PERMISSIONS_CONFIG_SEND:\r\n                    return {permissions: null};\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default nodePermissionsConfigReducer;","import {Reducer} from 'redux';\r\nimport {REQUEST_ERROR, RequestMethod} from '../../middlewares/request/requestActions';\r\nimport {DELETE_CONFLICT_MODAL_CLOSE} from './deleteConflictModalActions';\r\n\r\ntype DeleteConflictModalState = {\r\n    response: any | null,\r\n    onForce: any | null\r\n};\r\n\r\nconst deleteConflictModalReducer: Reducer<DeleteConflictModalState> = (\r\n    state = {\r\n        response: null,\r\n        onForce: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case REQUEST_ERROR:\r\n            if (action.payload.statusCode === 409 && action.payload.method === RequestMethod.DELETE) {\r\n                return {\r\n                    ...state,\r\n                    response: action.payload.response,\r\n                    onForce: action.payload.extra?.onDeleteConflictForce || null\r\n                };\r\n            } else {\r\n                return state;\r\n            }\r\n        case DELETE_CONFLICT_MODAL_CLOSE:\r\n            return {\r\n                ...state,\r\n                response: null,\r\n                onForce: null\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default deleteConflictModalReducer;","import {\r\n  clearUser,\r\n  showUserLoginForm,\r\n  USER_PASSWORD_CHANGE, USER_PASSWORD_SET,\r\n  USER_REFRESH, USER_RESET_PASSWORD_EMAIL_SEND\r\n} from \"../../state/user/userActions\";\r\nimport {REQUEST_INIT, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {HUB_FETCH} from \"../../state/hub/hubActions\";\r\nimport {NODE_FETCH} from \"../../state/node/nodeActions\";\r\nimport {goToHome} from \"../../links\";\r\n\r\nconst userMiddlewareFactory = t => ({dispatch, getState}) => next => action => {\r\n\r\n  const state = getState();\r\n\r\n  let result;\r\n\r\n  // if a request is starting but auth token is expired\r\n  if (\r\n    action.type === REQUEST_INIT &&\r\n    action.payload.label !== HUB_FETCH &&\r\n    action.payload.label !== NODE_FETCH &&\r\n    action.payload.label !== USER_REFRESH &&\r\n    state.user.isAuthenticated &&\r\n    state.user.tokenReceivedTime !== null &&\r\n    state.user.tokenTTL !== null &&\r\n    new Date(new Date().getTime() - state.user.tokenReceivedTime).getMinutes()\r\n    >= state.user.tokenTTL - 1\r\n  ) {\r\n\r\n    /*\r\n      result = next(refreshUser()); // block current request dispatching, and replace it with token refresh request\r\n      dispatch(setUserDelayedRequestWhenTokenExpired(action)); // delay current (request) action\r\n    */\r\n\r\n    result = next(({type: \"NOP\"}));\r\n    if (window.error) {\r\n      window.error.show(`${t(\"middlewares.user.sessionExpired\")} <a href=\"./#/\">${t(\"middlewares.user.backToHome\")}</a>`);\r\n    }\r\n    dispatch(clearUser());\r\n\r\n  } else {\r\n\r\n    result = next(action); // do nothing, continue action dispatching as normal\r\n\r\n  }\r\n\r\n  // if sent token is expired (in some cases it can happen, even if i checked expiration in the previous code)\r\n  if (action.payload?.extra?.responseHeaders && action.payload.extra.responseHeaders[\"token-expired\"]) {\r\n    /*\r\n      dispatch(clearUser()); // init user state\r\n      dispatch(showUserLoginForm(\"Authentication is expired. Please log in again.\")); // show login form with alert\r\n     */\r\n\r\n    if (window.error) {\r\n      window.error.show(`${t(\"middlewares.user.sessionExpired\")} <a href=\"./#/\">${t(\"middlewares.user.backToHome\")}</a>`);\r\n    }\r\n    dispatch(clearUser());\r\n\r\n  }\r\n\r\n  // if token has been refreshed and delayed request is pending\r\n  if (action.type === REQUEST_SUCCESS && action.payload?.label === USER_REFRESH && state.user.delayedRequest) {\r\n    dispatch(state.user.delayedRequest); // dispatch pending (request) action\r\n  }\r\n\r\n  if (action.type === REQUEST_SUCCESS && (\r\n    action.payload.label === USER_PASSWORD_CHANGE ||\r\n    action.payload.label === USER_PASSWORD_SET\r\n  )) {\r\n    window.error.show(t(\"middlewares.user.passwordChangedLoginNecessary\"), false);\r\n    goToHome();\r\n    dispatch(showUserLoginForm());\r\n  } else if (action.type === REQUEST_INIT && action.payload.label === USER_RESET_PASSWORD_EMAIL_SEND) {\r\n    window.error.show(t(\"middlewares.user.resetPasswordEmailSent\"), false);\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport default userMiddlewareFactory;","import {errorRequest, REQUEST_INIT, RequestActionPayload, startRequest, successRequest} from './requestActions';\r\nimport axios, {AxiosResponse} from 'axios';\r\nimport {Middleware} from 'redux';\r\nimport {PayloadAction} from \"@reduxjs/toolkit\";\r\n\r\nconst requestMiddlewareFactory = (\r\n  options: {\r\n    onSuccess?: (requestAction: object, data?: any, extra?: any) => void,\r\n    onManagedServerError?: (requestAction: RequestActionPayload, statusCode: number, managedServerError: any) => void,\r\n    onGenericError?: (requestAction: RequestActionPayload, statusCode?: number) => void\r\n  }\r\n): Middleware =>\r\n  ({dispatch, getState}) => next => action => {\r\n\r\n    const handleSuccess = (requestAction: RequestActionPayload, response: AxiosResponse) => {\r\n\r\n      if (options.onSuccess) {\r\n        options.onSuccess(requestAction, response.data, {\r\n          responseHeaders: response.headers\r\n        });\r\n      }\r\n\r\n      dispatch(successRequest(requestAction, response.data, {\r\n        responseHeaders: response.headers,\r\n        status: response.status\r\n      }));\r\n    };\r\n\r\n    const handleManagedServerError = (requestAction: RequestActionPayload, response: AxiosResponse) => {\r\n\r\n      if (options.onManagedServerError && (!requestAction?.getHideErrorMessage || !requestAction.getHideErrorMessage(response?.status))) {\r\n        options.onManagedServerError(requestAction, response.status, response.data);\r\n      }\r\n\r\n        dispatch(errorRequest(requestAction, response.status, response.data, {responseHeaders: response.headers}));\r\n    };\r\n\r\n      const handleGenericError = (requestAction: RequestActionPayload, response?: AxiosResponse) => {\r\n\r\n          if (options.onGenericError && (!requestAction?.getHideErrorMessage || !requestAction.getHideErrorMessage(response?.status))) {\r\n              options.onGenericError(requestAction, response?.status);\r\n          }\r\n\r\n          dispatch(errorRequest(requestAction, response?.status, response?.data, {responseHeaders: response?.headers}));\r\n      };\r\n\r\n    const handleError = (requestAction: RequestActionPayload, response?: AxiosResponse) => {\r\n\r\n      if (response?.data) {\r\n\r\n          if (response.data.usedBy !== undefined) {\r\n              handleManagedServerError(requestAction, response);\r\n          } else {\r\n              handleGenericError(requestAction, response);\r\n          }\r\n      } else {\r\n          handleGenericError(requestAction, response);\r\n      }\r\n    };\r\n\r\n    const result = next(action);\r\n\r\n    if (action.type !== REQUEST_INIT) {\r\n      return result;\r\n    }\r\n\r\n      const requestAction: PayloadAction<RequestActionPayload> = action;\r\n\r\n      dispatch(startRequest(requestAction.payload));\r\n\r\n      let {\r\n          method,\r\n          url,\r\n          data,\r\n          baseURL,\r\n          contentType\r\n      } = requestAction.payload;\r\n\r\n      const token = getState().user.token;\r\n\r\n      axios.request({\r\n          method,\r\n          url: ((baseURL && baseURL.length > 0) ? baseURL : getState().config.baseURL) + url,\r\n          data,\r\n          headers: {\r\n              \"UserLang\": getState().app.language,\r\n              \"Authorization\": token ? `bearer ${token}` : undefined,\r\n              \"Content-Type\": contentType || undefined\r\n          },\r\n          withCredentials: true\r\n      }).then((response: AxiosResponse) => {\r\n      if (response.status.toString()[0] === \"2\") {\r\n        handleSuccess(requestAction.payload, response);\r\n      } else {\r\n        handleError(requestAction.payload, response);\r\n      }\r\n    }).catch(error => {\r\n      console.log(error);\r\n      handleError(requestAction.payload, error.response);\r\n    });\r\n\r\n    return result;\r\n  };\r\n\r\nexport default requestMiddlewareFactory;\r\n","export const showGenericError = () => {\r\n  if (window && window.error) {\r\n    window.error.show(\"An error occurred while contacting the server.\");\r\n  }\r\n};\r\n\r\nexport const showTranslatedGenericErrorFactory = t => () => {\r\n  if (window && window.error) {\r\n    window.error.show(t(\"errors.generic\"));\r\n  }\r\n};","import {REQUEST_START, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {\r\n  fetchHubConfigDashboards,\r\n  HUB_CONFIG_CLOSE,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n  HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n  HUB_CONFIG_SEND\r\n} from \"../../state/hubConfig/hubConfigActions\";\r\nimport {fetchHub} from \"../../state/hub/hubActions\";\r\nimport {\r\n  fetchNodesConfigNodeDashboards,\r\n  fetchNodesConfigNodes,\r\n  NODES_CONFIG_CLOSE,\r\n  NODES_CONFIG_NODE_CREATE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n  NODES_CONFIG_NODE_DELETE,\r\n  NODES_CONFIG_NODE_EDIT,\r\n  NODES_CONFIG_NODES_ORDER_SEND\r\n} from \"../../state/nodesConfig/nodesConfigActions\";\r\nimport {\r\n  fetchUsersConfigUsers,\r\n  USERS_CONFIG_USER_CREATE,\r\n  USERS_CONFIG_USER_DELETE,\r\n  USERS_CONFIG_USER_EDIT,\r\n} from \"../../state/usersConfig/usersConfigActions\";\r\nimport {goToHome} from \"../../links\";\r\nimport {\r\n  fetchOtherConfigViews,\r\n  OTHER_CONFIG_DASHBOARDS_CLOSE,\r\n  OTHER_CONFIG_VIEW_DELETE\r\n} from \"../../state/otherConfig/otherConfigActions\";\r\nimport {\r\n  fetchNodeTemplatesConfig,\r\n  NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE\r\n} from \"../../state/noteTemplatesConfig/nodeTemplatesConfigActions\";\r\nimport {\r\n  DATAFLOW_CACHE_DELETE_ALL,\r\n  DATAFLOW_CACHE_DELETE_CATALOG,\r\n  fetchDataflowCache\r\n} from \"../../state/cache/cacheActions\";\r\nimport {fetchCatalog} from \"../../state/catalog/catalogActions\";\r\nimport {fetchNode} from \"../../state/node/nodeActions\";\r\n\r\nconst configMiddleware = ({dispatch, getState}) => next => action => {\r\n\r\n  const state = getState();\r\n\r\n  const res = next(action);\r\n\r\n  if (action.type === REQUEST_START && action.payload.label === NODES_CONFIG_NODE_DELETE) {\r\n    if (state.node && state.node.nodeId === action.payload.extra?.nodeId) {\r\n      goToHome();\r\n    }\r\n  }\r\n\r\n  if (\r\n    action.type === NODES_CONFIG_CLOSE ||\r\n    action.type === HUB_CONFIG_CLOSE ||\r\n    action.type === OTHER_CONFIG_DASHBOARDS_CLOSE\r\n  ) {\r\n    goToHome();\r\n    dispatch(fetchHub());\r\n  } else if (action.type === REQUEST_SUCCESS) {\r\n    switch (action.payload.label) {\r\n      case HUB_CONFIG_SEND: {\r\n        goToHome();\r\n        dispatch(fetchHub());\r\n        break;\r\n      }\r\n      case HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD:\r\n      case HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE:\r\n      case HUB_CONFIG_DASHBOARDS_ORDERS_SEND: {\r\n        dispatch(fetchHubConfigDashboards());\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD:\r\n      case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE:\r\n      case NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND: {\r\n        dispatch(fetchNodesConfigNodeDashboards(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODES_ORDER_SEND: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_EDIT: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        if (state.node && state.node.nodeId === action.payload.extra.nodeId) {\r\n          goToHome();\r\n          dispatch(fetchNode(action.payload.extra.nodeId));\r\n        }\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_CREATE:\r\n      case NODES_CONFIG_NODE_DELETE: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        break;\r\n      }\r\n      case USERS_CONFIG_USER_EDIT:\r\n      case USERS_CONFIG_USER_DELETE: {\r\n        if (!action.payload.response.haveError && !action.payload.extra?.isAnonymous) {\r\n          dispatch(fetchUsersConfigUsers());\r\n        }\r\n        break;\r\n      }\r\n      case USERS_CONFIG_USER_CREATE:\r\n        if (!action.payload.response.haveError && !action.payload.extra?.isAnonymous) {\r\n          dispatch(fetchUsersConfigUsers());\r\n        } else if (!action.payload.response.haveError && action.payload.extra?.isAnonymous) {\r\n          goToHome();\r\n          window.location.reload();\r\n        }\r\n        break;\r\n      case OTHER_CONFIG_VIEW_DELETE: {\r\n        dispatch(fetchOtherConfigViews());\r\n        break;\r\n      }\r\n      case NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE: {\r\n        dispatch(fetchNodeTemplatesConfig(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case DATAFLOW_CACHE_DELETE_ALL: {\r\n        dispatch(fetchDataflowCache(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case DATAFLOW_CACHE_DELETE_CATALOG: {\r\n        if (state.node && state.node.nodeId === action.payload.extra.nodeId) {\r\n          goToHome();\r\n          dispatch(fetchCatalog(action.payload.extra.nodeId));\r\n        }\r\n        break;\r\n      }\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport default configMiddleware;","import {REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport FileSaver from \"file-saver\";\r\nimport {QUERY_LOG_DOWNLOAD} from \"../../components/settings-select/actions\";\r\nimport {DATASET_DOWNLOAD_SUBMIT} from \"../../state/dataset/datasetActions\";\r\n\r\nconst fileSaveMiddleware = () => next => action => {\r\n\r\n  const result = next(action);\r\n\r\n  if (action.type === REQUEST_SUCCESS && action.payload.extra.fileSave) {\r\n    if (\r\n      action.payload.label === QUERY_LOG_DOWNLOAD ||\r\n      action.payload.label === DATASET_DOWNLOAD_SUBMIT\r\n    ) {\r\n\r\n      let name = action.payload.extra.fileSave.name;\r\n\r\n      FileSaver.saveAs(\r\n        new Blob(\r\n          action.payload?.extra?.stringifyResponse\r\n            ? [JSON.stringify(action.payload.response, null, 2)]\r\n            : [action.payload.response],\r\n          {type: action.payload.extra.fileSave.type}\r\n        ),\r\n        name\r\n      )\r\n    }\r\n  }\r\n\r\n  return result;\r\n\r\n};\r\n\r\nexport default fileSaveMiddleware;\r\n","import {APP_LANGUAGE_SET} from \"../../state/app/appActions\";\r\nimport i18n from 'i18next';\r\nimport {INIT} from \"../../state/rootActions\";\r\nimport {PERSISTENCE_ACTION_KEY} from \"../persistence/middleware\";\r\n\r\nconst i18nMiddleware = ({getState}) => next => action => {\r\n\r\n  const res = next(action);\r\n\r\n  window.language = getState().app.language;\r\n\r\n  if (action.type === APP_LANGUAGE_SET) {\r\n    i18n.changeLanguage(action.payload.language, () => {\r\n      window.location.reload();\r\n    });\r\n  }\r\n\r\n  if (\r\n    action.type === INIT &&\r\n    action.payload[PERSISTENCE_ACTION_KEY]?.app?.language\r\n  ) {\r\n    if (getState().app.languages.includes(action.payload[PERSISTENCE_ACTION_KEY]?.app?.language)) {\r\n      window.language = action.payload[PERSISTENCE_ACTION_KEY].app.language;\r\n      i18n.changeLanguage(action.payload[PERSISTENCE_ACTION_KEY].app.language)\r\n    }\r\n  }\r\n\r\n  return res;\r\n\r\n};\r\n\r\nexport default i18nMiddleware;","import {REQUEST_ERROR, REQUEST_START, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {\r\n  addSpinnerMessage,\r\n  clearSpinnerTimeout,\r\n  flushSpinner,\r\n  markSpinnerMessage,\r\n  setSpinnerTimeout,\r\n  SPINNER_MESSAGE_ADD,\r\n  SPINNER_MESSAGE_REMOVE\r\n} from \"../../state/spinner/spinnerActions\";\r\n\r\nconst SPINNER_TIMEOUT = 1000;\r\n\r\nconst requestSpinnerMiddlewareFactory = t => ({dispatch, getState}) => next => action => {\r\n\r\n  if ((action.type === REQUEST_START || action.type === REQUEST_SUCCESS || action.type === REQUEST_ERROR) && action.payload.messages) {\r\n\r\n    const messages = action.payload.messages(t);\r\n\r\n    if (messages.onStart) {\r\n      if (action.type === REQUEST_START && !action.payload.hideSpinner) {\r\n        dispatch(addSpinnerMessage(action.payload.uuid, messages.onStart));\r\n      } else if (action.type === REQUEST_SUCCESS && !action.payload.response?.haveError) {\r\n        dispatch(markSpinnerMessage(action.payload.uuid));\r\n      } else if (action.type === REQUEST_ERROR || (action.type === REQUEST_SUCCESS && action.payload.response?.haveError)) {\r\n        dispatch(markSpinnerMessage(action.payload.uuid, true));\r\n      }\r\n    }\r\n  }\r\n\r\n  const result = next(action);\r\n\r\n  const spinnerState = getState().spinner;\r\n\r\n  if (action.type === SPINNER_MESSAGE_ADD) {\r\n    if (spinnerState.timeout) {\r\n      clearTimeout(spinnerState.timeout);\r\n      dispatch(clearSpinnerTimeout());\r\n    }\r\n  } else if (action.type === SPINNER_MESSAGE_REMOVE && !spinnerState.timeout && spinnerState.messages.length > 0 &&\r\n    spinnerState.messages.filter(({removed}) => !removed).length === 0\r\n  ) {\r\n    dispatch(setSpinnerTimeout(setTimeout(() => dispatch(flushSpinner()), SPINNER_TIMEOUT)));\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport default requestSpinnerMiddlewareFactory;","import {CATALOG_FETCH} from \"../../state/catalog/catalogActions\";\r\nimport {REQUEST_SUCCESS} from \"../request/requestActions\";\r\n\r\nconst feedbackMiddlewareFactory = t => ({getState}) => next => action => {\r\n\r\n  const res = next(action);\r\n\r\n  const state = getState();\r\n\r\n  if (\r\n    action.type === REQUEST_SUCCESS &&\r\n    action.payload.label === CATALOG_FETCH &&\r\n    (!state.catalog.uncategorizedDatasets || state.catalog.uncategorizedDatasets.length === 0) &&\r\n    (!state.catalog.datasets || Object.keys(state.catalog.datasets).length === 0)\r\n  ) {\r\n    window.error.show(t('middlewares.feedback.emptyCatalog'));\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport default feedbackMiddlewareFactory;","import {REQUEST_INIT, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {DATASET_FETCH} from \"../../state/dataset/datasetActions\";\r\nimport {errorFetchDatasetAsyncHandler, initFetchDatasetAsyncHandler, successFetchDatasetAsyncHandler} from \"./actions\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nexport const WORKERS_MIDDLEWARE = \"workers/middleware\";\r\n\r\nconst fetchDatasetAsyncHandlerMiddlewareFactory = t => ({dispatch}) => next => action => {\r\n\r\n  const result = next(action);\r\n\r\n  if (action?.payload?.label === DATASET_FETCH) {\r\n\r\n    if (action.type === REQUEST_INIT) {\r\n      dispatch(initFetchDatasetAsyncHandler());\r\n\r\n    } else if (action.type === REQUEST_SUCCESS) {\r\n\r\n      const spinnerUuid = uuidv4();\r\n      dispatch(addSpinnerMessage(spinnerUuid, t(\"middlewares.fetchDatasetAsyncHandlerMiddlewareFactory.spinners.layoutHandling\")));\r\n\r\n      const myWorker = new Worker(\"./workers/fetchDatasetAsyncHandlerWorker.js\");\r\n      myWorker.onmessage = event => {\r\n        const {\r\n          cellCount,\r\n          isResponseNotValid,\r\n          initialTableLayout,\r\n          initialMapLayout,\r\n          initialChartLayout\r\n        } = event.data;\r\n        dispatch(successFetchDatasetAsyncHandler(action.payload.response, action.payload.extra.status, action.payload.extra.responseHeaders, cellCount, isResponseNotValid, initialTableLayout, initialMapLayout, initialChartLayout, myWorker));\r\n        dispatch(markSpinnerMessage(spinnerUuid));\r\n      }\r\n      myWorker.postMessage({\r\n        response: action.payload.response,\r\n        extra: action.payload.extra\r\n      });\r\n\r\n    } else if (action.type === REQUEST_SUCCESS) {\r\n      dispatch(errorFetchDatasetAsyncHandler(action.payload.statusCode));\r\n    }\r\n  }\r\n\r\n  return result;\r\n\r\n};\r\n\r\nexport default fetchDatasetAsyncHandlerMiddlewareFactory;\r\n","import {configureStore} from \"@reduxjs/toolkit\";\r\nimport rootReducer from \"./state/rootReducer\";\r\nimport userMiddlewareFactory from \"./middlewares/user/userMiddlewareFactory\";\r\nimport requestMiddlewareFactory from \"./middlewares/request/requestMiddlewareFactory\";\r\nimport {showGenericError, showTranslatedGenericErrorFactory} from \"./utils/other\";\r\nimport configMiddleware from \"./middlewares/config/configMiddleware\";\r\nimport fileSaveMiddleware from \"./middlewares/file-save/middleware\";\r\nimport persistenceMiddleware from \"./middlewares/persistence/middleware\";\r\nimport i18nMiddleware from \"./middlewares/i18n-middleware/middleware\";\r\nimport i18n from \"i18next\";\r\nimport {initReactI18next} from \"react-i18next\";\r\nimport {init as initAction} from \"./state/rootActions\";\r\nimport requestSpinnerMiddlewareFactory\r\n  from \"./middlewares/request-spinner/requestSpinnerMiddlewareFactory\";\r\nimport {getAppConfigUrl, getHubMinimalInfoUrl} from \"./serverApi/urls\";\r\nimport feedbackMiddlewareFactory from \"./middlewares/feedback/feedbackMiddleware\";\r\nimport fetchDatasetAsyncHandlerMiddlewareFactory from \"./middlewares/fetchDatasetAsyncHandler/middlewareFactory\";\r\n\r\nconst init = cb => {\r\n\r\n  fetch(`./${getAppConfigUrl()}`)\r\n    .then(response => response.json())\r\n    .then(({baseURL}) => {\r\n\r\n      fetch(`${baseURL}${getHubMinimalInfoUrl()}`)\r\n        .then(response => response.json())\r\n        .then(({hub}) => {\r\n\r\n          Promise.all(\r\n            hub.supportedLanguages.map(code =>\r\n              fetch(`./i18n/${code}.json?buildID=${window.buildID}`)\r\n                .then(response =>\r\n                  response.headers.get(\"content-type\").indexOf(\"application/json\") !== -1\r\n                    ? response.json()\r\n                    : null\r\n                )\r\n                .catch(showGenericError)\r\n            )\r\n          )\r\n            .then(translations => {\r\n\r\n              let resources = {};\r\n\r\n              hub.supportedLanguages.forEach((code, idx) => {\r\n                if (translations[idx]) {\r\n                  resources[code] = {translation: translations[idx]}\r\n                }\r\n              });\r\n\r\n              const supportedAndTranslatedLanguages = Object.keys(resources);\r\n              const defaultLanguage =\r\n                resources[hub.defaultLanguage]\r\n                  ? hub.defaultLanguage\r\n                  : supportedAndTranslatedLanguages[0];\r\n\r\n              i18n\r\n                .use(initReactI18next)\r\n                .init({\r\n                  lng: defaultLanguage,\r\n                  resources,\r\n                  returnEmptyString: false,\r\n                  interpolation: {\r\n                    escapeValue: false\r\n                  }\r\n                });\r\n\r\n              const store = configureStore({\r\n                reducer: rootReducer,\r\n                middleware: [\r\n                  userMiddlewareFactory(i18n.t.bind(i18n)),\r\n                  requestMiddlewareFactory({\r\n                    onGenericError: showTranslatedGenericErrorFactory(i18n.t.bind(i18n))\r\n                  }),\r\n                  requestSpinnerMiddlewareFactory(i18n.t.bind(i18n)),\r\n                  fileSaveMiddleware,\r\n                  persistenceMiddleware,\r\n                  i18nMiddleware,\r\n                  configMiddleware,\r\n                  feedbackMiddlewareFactory(i18n.t.bind(i18n)),\r\n                  fetchDatasetAsyncHandlerMiddlewareFactory(i18n.t.bind(i18n))\r\n                ]\r\n              });\r\n\r\n              store.dispatch(initAction(baseURL, supportedAndTranslatedLanguages, defaultLanguage));\r\n\r\n              cb(store);\r\n\r\n            })\r\n            .catch(showGenericError);\r\n        })\r\n        .catch(showGenericError);\r\n    })\r\n    .catch(showGenericError);\r\n};\r\n\r\nexport default init;","import {showGenericError} from \"../other\";\r\n\r\n// https://stackoverflow.com/questions/179355/clearing-all-cookies-with-javascript\r\nfunction deleteAllCookies() {\r\n  var cookies = document.cookie.split(\";\");\r\n\r\n  for (var i = 0; i < cookies.length; i++) {\r\n    var cookie = cookies[i];\r\n    var eqPos = cookie.indexOf(\"=\");\r\n    var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;\r\n    document.cookie = name + \"=;expires=Thu, 01 Jan 1970 00:00:00 GMT\";\r\n  }\r\n}\r\n\r\nfetch('buildID.json?random=' + Math.floor(Math.random()*16777215).toString(16))\r\n  .then(res => res.json())\r\n  .then(buildID => {\r\n    if (buildID !== window.buildID) {\r\n      console.log(\"buildID is not equal\");\r\n      localStorage.clear();\r\n      deleteAllCookies();\r\n      window.location.reload(true);\r\n    }\r\n  })\r\n  .catch(showGenericError);\r\n\r\n\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport 'typeface-roboto';\r\nimport \"fontsource-do-hyeon\";\r\nimport \"./style.css\";\r\nimport 'flag-icon-css/css/flag-icon.css';\r\nimport {Provider} from 'react-redux'\r\nimport init from \"./init\";\r\nimport \"./utils/buildID/buildIDChecker\";\r\n\r\ninit(store =>\r\n  ReactDOM.render(\r\n    <Provider store={store}>\r\n      <App/>\r\n    </Provider>,\r\n    document.getElementById('root')\r\n  ));\r\n"],"sourceRoot":""}