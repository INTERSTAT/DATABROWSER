{"version":3,"sources":["middlewares/request/requestActions.ts","components/not-implemented-snackbar/NotImplementedSnackbar.jsx","state/spinner/spinnerActions.ts","components/spinner/Spinner.jsx","components/sanitized-html/index.jsx","components/error-snackbar/ErrorSnackbar.jsx","components/hero/index.jsx","components/cards-grid/index.jsx","components/page-section/index.jsx","components/page/index.jsx","state/user/userReducer.ts","serverApi/urls.ts","state/user/userActions.ts","components/settings-dialog/index.jsx","components/user-login-dialog/user-recover-password-form/index.jsx","constants/getUserErrorsTranslations.js","components/user-login-dialog/index.jsx","state/usersConfig/usersConfigActions.ts","utils/i18n.js","components/settings-select/users-settings-form/user-settings-form/index.jsx","components/button-select/index.jsx","components/user-select/user-change-password-form/index.jsx","components/user-select/index.jsx","links.js","components/categories-tree/index.jsx","state/hubConfig/hubConfigActions.ts","components/file-input/index.jsx","components/custom-material-table/index.jsx","components/dashboards-manager/index.jsx","state/rootActions.ts","middlewares/persistence/middleware.js","utils/user.ts","components/i18n-input-adornment-select/index.jsx","components/i18n-text-field/index.jsx","components/html-editor/index.jsx","components/i18n-html-editor/index.jsx","components/settings-select/app-settings-form/index.jsx","state/nodesConfig/nodesConfigActions.ts","utils/jsonStat.js","components/label-format-selector/constants.js","utils/criteria.js","components/info-tooltip/index.jsx","components/form-label-with-tooltip/index.jsx","utils/download.js","components/settings-select/nodes-settings-form/node-settings-form/index.jsx","state/dataset/datasetActions.ts","state/cache/cacheActions.ts","components/settings-select/nodes-settings-form/cache-setting-form/index.jsx","state/noteTemplatesConfig/nodeTemplatesConfigActions.ts","components/settings-select/nodes-settings-form/templates-settings-form/index.jsx","components/settings-select/nodes-settings-form/permissions-settings-form/index.jsx","state/nodePermissionsConfig/nodePermissionsConfigActions.ts","components/settings-select/nodes-settings-form/dashboards-settings-form/index.jsx","components/settings-select/nodes-settings-form/index.jsx","components/settings-select/users-settings-form/index.jsx","components/settings-select/index.jsx","components/settings-select/actions.js","components/search-input/index.jsx","components/search-dialog/index.jsx","utils/dashboards.js","state/otherConfig/otherConfigActions.ts","components/other-settings-select/views-settings-form/index.jsx","utils/style.js","components/infinite-scroll-table/sort-buttons/index.jsx","components/infinite-scroll-table/contants.js","components/infinite-scroll-table/utils.js","components/auto-search-input/index.jsx","components/infinite-scroll-table/pre-header/index.jsx","components/infinite-scroll-table/footer/index.jsx","components/custom-empty/index.jsx","components/infinite-scroll-table/filter-button/index.jsx","components/infinite-scroll-table/index.jsx","components/selector/index.jsx","components/i18n-delayed-text-field/index.jsx","constants/getDashboardDynamicFilterLabelTranslations.js","components/dashboard-builder/index.jsx","hocs/call/index.jsx","utils/formatters.js","components/table/jsonStatTable.js","components/table/Scrollbars.jsx","components/table/index.jsx","components/attribute-list/index.jsx","utils/tree.js","middlewares/fetchDatasetAsyncHandler/actions.js","constants/getNutsLevelTranslations.js","state/dataset/datasetReducer.ts","constants/getTimingsLabelTranslation.js","components/data-viewer/Timings.jsx","components/data-viewer/ViewBuilder.jsx","components/data-viewer/TemplateBuilder.jsx","components/data-viewer/Header.jsx","components/data-viewer/Sidebar.jsx","components/data-viewer/Footer.jsx","components/dataset-filters/index.jsx","components/enhanced-tree/index.jsx","components/criteria/TimePeriod.jsx","components/criteria/index.jsx","components/table-layout/index.jsx","components/font-size-selector/index.jsx","components/chart-layout/index.jsx","components/map/index.jsx","components/label-format-selector/index.jsx","components/chart/index.jsx","components/data-viewer/index.jsx","state/dashboard/dashboardReducer.ts","state/dashboard/dashboardActions.ts","components/dashboard/index.jsx","components/other-settings-select/user-dashboards-settings-form/index.jsx","components/other-settings-select/index.jsx","components/app-language-select/index.jsx","components/node-header/index.jsx","components/footer/index.jsx","components/home/index.jsx","state/hub/hubActions.ts","components/categories-lists/index.jsx","components/node/index.jsx","state/node/nodeActions.ts","state/catalog/catalogActions.ts","components/results/ResultTree.jsx","components/results/getDownloadButtonStyle.js","components/results/DatasetCard.jsx","components/results/index.jsx","components/data/index.jsx","domains/DatasetDomain.jsx","components/dashboard-filters/index.jsx","domains/DashboardsDomain.jsx","domains/NodeDomain.jsx","domains/MultiLanguageDomain.jsx","state/app/appActions.ts","domains/HubDomain.jsx","components/delete-conflict-modal/index.jsx","state/delete-conflict-modal/deleteConflictModalActions.ts","components/error-boundary/index.jsx","components/user-set-password-dialog/user-set-password-form/index.jsx","components/user-set-password-dialog/index.jsx","components/app-theme/index.jsx","App.jsx","state/hub/hubReducer.ts","state/node/nodeReducer.ts","model/LocalCategoryProvider.ts","state/rootReducer.ts","state/spinner/spinnerReducer.ts","state/appConfig/appConfigReducer.ts","state/config/configReducer.ts","state/app/appReducer.ts","state/noteTemplatesConfig/nodeTemplatesConfigReducer.ts","state/catalog/catalogReducer.ts","state/hubConfig/hubConfigReducer.ts","state/nodesConfig/nodesConfigReducer.ts","state/cache/cacheReducer.ts","state/otherConfig/otherConfigReducer.ts","state/usersConfig/usersConfigReducer.ts","state/nodePermissionsConfig/nodePermissionsConfigReducer.ts","state/delete-conflict-modal/deleteConflictModalReducer.ts","middlewares/user/userMiddlewareFactory.js","middlewares/request/requestMiddlewareFactory.ts","utils/other.js","middlewares/config/configMiddleware.js","middlewares/file-save/middleware.js","middlewares/i18n-middleware/middleware.js","middlewares/request-spinner/requestSpinnerMiddlewareFactory.js","middlewares/feedback/feedbackMiddleware.js","middlewares/fetchDatasetAsyncHandler/middlewareFactory.js","init.js","index.jsx"],"names":["RequestMethod","withTranslation","t","useState","isOpen","setIsOpen","isInitialized","setIsInitialized","useEffect","window","notImplemented","show","Snackbar","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","ClickAwayListenerProps","onClickAway","Alert","severity","addSpinnerMessage","uid","message","type","payload","markSpinnerMessage","isError","compose","withStyles","theme","container","width","height","overlay","position","zIndex","progressContainer","display","alignItems","justifyContent","progress","maxWidth","messagesContainer","textAlign","messages","marginTop","childrenContainer","top","messageRow","withTheme","connect","state","spinner","dispatch","flushSpinner","classes","children","isHandlerOn","setIsHandlerOn","addEventListener","Box","className","id","length","style","background","palette","primary","main","LinearProgress","color","map","removed","Grid","key","justify","filter","spacing","item","Typography","error","success","fontSize","overflow","SanitizedHTML","props","html","undefined","dangerouslySetInnerHTML","__html","sanitize","ErrorSnackbar","isVisible","setIsVisible","setMessage","setIsError","onExited","component","root","flexDirection","objectFit","textContainer","padding","lightTextContainer","buttonsContainer","margin","logo","maxHeight","title","slogan","Helmet","variant","paddingTop","card","list","onClick","squareImage","hasImage","find","c","image","i","xs","Card","CardActionArea","CardMedia","label","alt","CardContent","gutterBottom","PageSection","sectiontitle","Divider","Page","transparent","isOldBrowserWarningVisible","handleScroll","scrollTop","pageYOffset","document","documentElement","setState","closeWarning","ref","current","scrollIntoView","behavior","alignToTop","scroll","left","isIE","documentMode","isEdge","StyleMedia","this","removeEventListener","oldBrowserWarning","href","target","rel","IconButton","Zoom","in","Fab","fab","ArrowUpward","Component","right","bottom","appBar","paddingBottom","lineHeight","REQUEST_SUCCESS","UserRoles","UserPermissions","initRequest","url","method","GET","data","extra","baseURL","getHideErrorMessage","hideSpinner","contentType","doNotTransformResponse","uuid","uuidv4","errorRequest","requestActionPayload","statusCode","response","getDatasetUrl","nodeId","datasetId","getDatasetDownloadUrl","format","zipped","getNodeDeleteUrl","force","getDashboardsUrl","dashboardId","showUserLoginForm","alert","SettingsDialog","onSubmit","hasSubmit","noMinHeight","useTranslation","Dialog","disableEscapeKeyDown","disableBackdropClick","fullWidth","DialogTitle","DialogContent","minHeight","DialogActions","Button","Form","field","paper","tabContent","overflowY","overflowX","forwardRef","config","useForm","register","errors","handleSubmit","useImperativeHandle","submit","f","val","cancel","FormControl","TextField","marginBottom","name","email","helperText","required","inputRef","usersConfig","user","userErrors","sendConfig","POST","onStart","str","getUserErrorsTranslations","InvalidLogin","PasswordRequiresDigit","PasswordTooShort","PasswordRequiresNonAlphanumeric","PasswordRequiresUpper","PasswordRequiresLower","InvalidEmail","translations","recoverPassword","textDecoration","secondary","cursor","onHide","onRegister","isRecoverPasswordModalOpen","setIsRecoverPasswordModalOpen","recoverPasswordFormRef","useRef","password","marginLeft","fetchUsersConfigUsers","validateI18nObj","obj","_","pickBy","keys","value","localizeI18nObj","prefLang","langs","code","Object","getI18nObjCustomFilterAndSearch","language","languages","row","toLowerCase","includes","disclaimerLink","onCancel","isAnonymous","hub","types","defaultValues","isActive","disclaimerAccepted","watch","setValue","showPassword","setShowPassword","showPasswordConfirm","setShowPasswordConfirm","isDisclaimerModalOpen","setIsDisclaimerModalOpen","validate","disabled","emailConfirm","FormControlLabel","control","Checkbox","checked","onChange","e","select","MenuItem","firstName","lastName","organization","InputProps","endAdornment","InputAdornment","Visibility","VisibilityOff","inputProps","autoComplete","passwordConfirm","FormHelperText","disclaimer","appConfig","app","fetchConfig","userId","getUserConfigGetUrl","sendConfigCreate","sendUsersConfigUserCreate","PUT","sendUsersConfigUserEdit","clearConfig","needConfig","setNeedConfig","index","typeOptions","ButtonSelect","anchorEl","setAnchorEl","el","handleMenu","event","currentTarget","handleClose","icon","tooltip","selectedIdx","Boolean","Item","isSelected","startIcon","endIcon","keepMounted","transformOrigin","showOldPassword","setShowOldPassword","showNewPassword","setShowNewPassword","showNewPasswordConfirm","setShowNewPasswordConfirm","oldPassword","newPassword","newPasswordConfirm","btoa","onLogin","Email","Password","fetchUser","onLogout","onLoginFormShow","onLoginFormHide","isChangePasswordModalOpen","setIsChangePasswordModalOpen","isRegisterModalOpen","setIsRegisterModalOpen","registerFormRef","changePasswordFormRef","isAuthenticated","isLoginDialogOpen","goToDatasets","nodeCode","categoryPath","join","goToData","viewId","a11y","goToDatasetsSearch","query","filters","encodeURIComponent","goToNode","goToHome","noLanguage","goToHubDashboards","goToNodeDashboards","CategoriesTree","expanded","selectedCategoryPath","onExpand","node","catalog","getTreeItems","tree","prevPath","cat","TreeItem","nodeIcon","hasAnnotation","size","onDialogOpen","selectedItem","datasetIdentifiers","childrenCategories","Link","datasetsCount","categoryGroups","categories","TreeView","defaultCollapseIcon","defaultExpandIcon","onNodeToggle","nodeIds","uncategorizedDatasets","content","fetchHubConfigDashboards","startAdornment","marginRight","fileInput","substring","lastIndexOf","fileName","setFileName","accept","file","files","fileFormData","FormData","append","fetch","body","headers","token","credentials","then","res","json","filePath","catch","htmlFor","CustomMaterialTable","customProps","localization","emptyDataSourceMessage","header","actions","toolbar","searchPlaceholder","searchTooltip","mergedProps","merge","tableIcons","Search","ResetSearch","SortArrow","tableToolbar","buttonAction","typography","button","defaultLanguage","dashboards","allDashboards","fetchDashboards","fetchAllDashboards","addDashboard","removeDashboard","sendDashboardsOrders","clearDashboards","clearAllDashboards","needFetch","setNeedFetch","destroy","orderedDashboardsIds","components","Container","columns","render","customFilterAndSearch","assigned","dashboard","AddIcon","options","paging","draggable","actionsColumnIndex","searchFieldAlignment","maxBodyHeight","showTitle","icons","Toolbar","tableData","ArrowDropUpIcon","rowIndex","slice","ArrowDropDownIcon","DeleteIcon","INIT","persistenceMiddleware","getState","next","action","JSON","parse","localStorage","getItem","result","setItem","stringify","isSetPasswordDialogOpen","supportedLanguages","initialState","roles","permissions","refreshTokenExpiration","tokenTTL","tokenReceivedTime","delayedRequest","userReducer","setPasswordToken","Date","getTime","request","status","getPermissionStr","permission","canDisplayAppSettingsForm","Administrator","canCreateNode","canSortNodes","canDisplayNodesSettingsForm","p","startsWith","ManageCache","ManageTemplate","ManageConfig","canDisplayUsersSettingsForm","canDisplayCacheSettingForm","canDisplayTemplatesSettingsForm","canSaveTemplate","canEditNode","canDisplayUserViews","canSaveAsView","canGetQueryLog","canDisplayPermissionsSettingsForm","canManagePersonalDashboards","canManageAppDashboards","canDeleteNodes","CUSTOM_LANG_TO_COUNTRY","en","langToCountry","setLangToCountry","forEach","langCode","CountryLanguage","getLanguageCountries","err","countries","code_2","lang","data-value","ConnectedComponent","textFieldProps","setLanguage","I18nTextField","HtmlEditor","getInitState","handleEditorChange","bind","editor","getData","items","readOnly","onBeforeLoad","CKEDITOR","disableAutoInline","React","preToolbar","htmlEditorProps","I18nHtmlEditor","disclaimerLabel","tab","setTab","dashboardsManagerRef","createRef","configExtras","extras","pageSize","PageSize","min","Tabs","Tab","Autocomplete","multiple","freeSolo","renderTags","getTagProps","option","Chip","renderInput","params","placeholder","maxObservationsAfterCriteria","maxCells","hubConfig","hubDashboards","sendHubConfig","getAddHubDashboardUrl","addHubConfigDashboardsDashboard","getRemoveHubDashboardUrl","DELETE","removeHubConfigDashboardsDashboard","orderedDashboarIds","fetchNodesConfigNodes","fetchNodesConfigNodeDashboards","getNodeDashboardsUrl","FREQ_DIMENSION_KEY","toUpperCaseFirst","string","toUpperCase","getDimensionLabelFromJsonStat","jsonStat","dimension","getDimensionValueLabelFromJsonStat","category","getDataIdxFromDimensionsArray","dimensions","dataIdx","multiplier","getJsonStatTableSize","layout","count","colCount","cols","col","indexOf","rowCount","rows","sections","section","getCombinationArray","dimsArrays","test","max","ret","helper","arr","j","l","a","push","getInitialFiltersValue","fixedFiltersValue","primaryDim","primaryDimArr","primaryDimValues","secondaryDim","secondaryDimArr","secondaryDimValues","dims","concat","uniq","dim","indexesMap","getDimensionValuesIndexesMap","primaryDimValuesIndexes","secondaryDimValuesIndexes","dimsIndexesArrays","idx","reverse","unorderedDimCombination","combination","orderedDims","unorderedDims","orderedDimCombination","isValorized","filtersValue","getUpdatedLayout","newLayout","cloneDeep","getChartDimensionValues","fixedFilters","tmpLayout","getDimensionFiltersValue","values","dimValue","dimensionsNotInFilters","dimensionsPostFilter","dimensionsNotInFiltersAndPostFilters","addedValues","dataIndexArr","combinationValue","observation","isPrimaryDim","getAttributeObjects","attributeList","attributeObj","hiddenAttributes","attributes","ids","hasAsterisk","attr","valueId","valueLabel","getDimensionAttributeMap","getIdsHtmlString","series","extension","seriesIndexes","dimensionAttributesMap","coordinates","dimIdx","findIndex","dimValueIdx","attributeObjects","htmlString","frequencies","getTimePeriod","initialTimePeriod","criteria","timePeriodCodelist","freqCodelist","minAndMax","moment","add","missingRange","getMinAndMax","minDate","maxDate","freq","fromDate","from","toDate","to","getFreq","freqValues","filterValues","getCriteriaArrayFromObject","criteriaObj","criteriaArr","getCriteriaObjectFromArray","dimensionCriteria","placement","aria-label","transform","FormLabelWithTooltip","tooltipOnRight","Tooltip","pointerEvents","downloadFormats","genericdata","genericdata20","compactdata","structurespecificdata","jsondata","csv","getDownloadFormatLabelFromFormat","getDownloadFormatExtensionFromFormat","exportChartJpeg","canvasId","canvas","getElementById","link","createElement","download","toDataURL","appendChild","click","removeChild","mustChangeTabOnErrors","setMustChangeTabOnErrors","active","annotationConfig","showCategoryLevels","decimalNumber","decimalSeparator","catalogNavigationMode","restDataResponseXml","supportPostFilters","enableHttpAuth","enableProxy","optimizeCallWithSoap","namespaceV20","namespaceV21","isPublic","validator","isPort","firstFieldWithErrors","textTransform","agency","Paper","sm","criteriaSelectionMode","endPoint","authHttpUsername","proxyAddress","proxyPort","ttlCatalog","ttlDataflow","getOptionLabel","nodesConfig","getNodeConfigGetUrl","fetchNodesConfigNode","sendNodesConfigNodeEdit","fetchDataflowCache","getDataflowsCacheListUrl","Delete","Edit","Check","Clear","Add","wellFormattedTimeString","days","hours","mins","sec","cacheConfig","fetchCache","clearCache","updateCache","cacheId","ttl","getDataflowsCacheUpdateUrl","updateDataflowCache","createCache","getDataflowsCreateCacheUrl","oldData","createDataflowCache","deleteFromCache","getDataflowsClearCacheUrl","deleteDataflowCache","deleteAllFromCache","getDataflowsClearAllCacheUrl","deleteAllDataflowCache","deleteCatalogCache","getClearNodeCatalogMemoryCacheUrl","hideEmptyDataflowCache","setEmptyDataflowCacheHidden","emptyRowsCounter","setEmptyRowsCounter","rowsCounter","setRowsCounter","cacheSize","editable","rowData","totalSeconds","Math","floor","minutes","seconds","round","secondsToHms","onRowUpdate","newData","Promise","resolve","reject","onRowDelete","dataDelete","splice","editRow","deleteText","editTooltip","deleteTooltip","fetchNodeTemplatesConfig","getNodeTemplatesUrl","templates","nodeTemplatesConfig","fetchTemplates","deleteTemplate","getDeleteTemplateUrl","deleteNodeTemplatesConfigTemplate","clearTemplates","nodes","defaultNodeOpen","onTemplatesClose","needTemplates","setNeedTemplates","deleteTemplateId","setDeleteTemplateId","location","viewTemplateId","autoFocus","styles","PERMISSIONS","getPermissionsTranslations","userVal","nodePermissions","ev","nodePermissionsConfig","getNodePermissionsConfigGetUrl","fetchNodePermissionsConfig","getNodePermissionsConfigPutUrl","sendNodePermissionsConfig","nodeDashboards","getAddNodeDashboardUrl","addNodesConfigDashboardsNodeDashboard","getRemoveNodeDashboardUrl","removeNodesConfigDashboardsNodeDashboard","dashboardsIds","getOrderNodeDashboardsUrl","sendNodesConfigDashboardsNodeOrders","sendOrders","orderedIds","sendNodesConfigNodesOrder","deleteNode","onForce","deleteNodesConfigNode","onNodesClose","isNodeFormVisible","setNodeFormVisibility","nodeFormNodeId","setNodeFormNodeId","nodeDeleteFormNodeId","setNodeDeleteFormNodeId","cacheFormNodeId","setCacheFormNodeId","isCacheFormVisible","setCacheFormVisibility","templatesNodeId","setTemplatesNodeId","permissionsNodeId","setPermissionsNodeId","dashboardsNodeId","setDashboardsNodeId","nodeFormRef","cacheFormRef","templatesRef","permissionsRef","dashboardsRef","orderedNodes","sort","b","order","orderedNodesIds","PersonIcon","canManageNodeDashboards","DashboardIcon","EditIcon","false","users","deleteUser","getUserDeleteUrl","deleteUsersConfigUser","onUserFormShow","showUserConfigForm","onUserFormHide","userDeleteFormUserId","setUserDeleteFormUserId","userFormRef","SettingsSelect","isAppOpen","isNodesOpen","isUsersOpen","appSettingsRef","nodesSettingsRef","usersSettingsRef","isLogDownloadOpen","logLimit","onAppOpen","onAppClose","showSnackbar","isAppSubmitSnackbarVisible","onNodesOpen","onUsersOpen","onUsersClose","onLogDownloadOpen","onLogDownloadClose","onLogLimitSet","isNaN","onLogDownload","Input","limit","getQueryLog","fileSave","stringifyResponse","downloadQueryLog","onCacheClear","borderRadius","shape","backgroundColor","borderColor","borderWidth","inputRoot","inputInput","input","defaultValue","onKeyDown","preventDefault","$","jQuery","fade","common","white","dialogTop","modalWidth","onRendered","focus","PaperProps","emptyDashboardElem","getViewIdxFromRowAndCol","rowIdx","colIdx","fetchOtherConfigViews","getNewDashboard","newDashboard","dashboardConfig","filterDimension","newFilterLevels","labels","filterLevels","viewIds","views","otherConfig","fetchViews","clearViews","deleteView","getDeleteViewUrl","deleteOtherConfigView","onViewsClose","needViews","setNeedViews","deleteViewId","setDeleteViewId","deleteViewNodeId","setDeleteViewNodeId","getScrollBarWidth","temp","css","visibility","appendTo","widthWithScroll","outerWidth","remove","getTextWidth","text","element","innerText","offsetWidth","SortButtons","CHECKBOX_WIDTH","DATA_INDEX_CHECKED","DEFAULT_PAGE_SIZE","getIndexesFromPaginationParams","pageNum","startIdx","stopIdx","AutoSearchInput","tempValue","timeout","onClear","clearTimeout","onSearch","setTimeout","nextProps","searchText","selectedRowCount","tableActions","renderTableAction","leftActions","rightActions","isLoading","isHidden","rowNumStart","rowNumEnd","CircularProgress","fontStyle","textStyle","FilterButton","Popover","InfiniteScrollTable","onSearchTextChange","onFiltersChange","onSortChange","getSelectedRowKeys","onRowSelectionChange","getCols","getNormalizedTableActions","renderActions","renderGridRow","renderFixedActions","renderHeaderCells","renderCheckboxTitle","renderCheckbox","getPopulatedRows","getColWidths","getQueriedRows","getRenderedRows","onRenderedRowsChange","gridKeyForRefresh","scrollLeft","gridScrollbarWidth","sortCol","sortByDesc","selectedRowKeys","rowSelection","populatedRows","colWidths","renderedRows","queriedRows","isResizing","resizeTimeout","pageRequestTimeout","isPaginating","isPaginated","pageRequestParams","viewStartIdx","viewEndIdx","viewIndexesUpdateTimeout","doNotCallOnChangeOnNextRenderedRowsChange","multilangStrDataIndexes","fixedActions","altActions","getIsAltRow","getActionsObjs","populatedRow","dataIndex","getTextWidthEl","get","colTitleWidth","noFilter","noSort","CELL_PADDING","widthToContent","minWidthToContent","renderText","minWidth","isVariableSizeCol","variableSizeCols","colWidthsSum","availableWidth","getIsVerticalScrollbarVisible","widthToAdd","colWidth","colIndex","colsWidths","getRowKey","resRow","getFilteredGridRows","getSearchTextFilteredGridRows","getSortedGridRows","prevProps","isArrayPropertyChangedLazy","newCols","newPopulatedRows","newColWidths","newRenderedRows","newQueriedRows","newScrollTop","$grid","updateRenderedRows","_this","addClass","on","newScrollLeft","off","nextState","nextContext","newFilters","newPageRequestParams","applyQueryChange","newSearchText","colDataIndex","direction","newSortCol","newSortByDesc","rowKey","selected","getIsDisabledRow","onSelect","onSelectAll","newSelectedRowKeys","selRowKey","titleRender","noSearchText","getNormalizedFixedActions","disableOnRowClickForCell","getNormalizedActions","getNormalizedAltActions","hasOwnProperty","withValuesFilter","isValuePassingSearchText","column","_a","_b","sorter","defaultSorter","onRowClick","getRowStyle","cellData","isRowClickDisabled","colLeftAttr","rowStyle","ROW_HEIGHT","columnWidths","stopPropagation","isCheckDisabled","checkboxProps","getCheckboxProps","overscanStartIdx","overscanEndIdx","currentPageIndexes","pageRowsThird","MAX_PAGE_SIZE","newPaginationParams","maxIdx","minPageSize","maxPageSize","pageNumForMinPageSize","Number","isInteger","minPageNum","ceil","maxPageNum","indexes","getPaginationParamsFromIndexes","rowNum","showHeader","autoSearch","sum","itemSize","itemCount","initialScrollOffset","onItemsRendered","visibleStartIndex","visibleStopIndex","overscanStartIndex","overscanStopIndex","String","prevProp","prop","isDesc","normalize","withSize","iconStyle","Selector","callOnChange","detailTitle","selectTitle","resetTitle","onDetail","onReset","emptyValue","getInitialInternalValue","internalValue","setInternalValue","timeoutId","setTimeoutId","setValueForLanguage","newInternalValue","I18nDelayedTextField","getDashboardDynamicFilterLabelTranslations","Region","Province","Municipality","getStrippedHtmlText","$span","innerHTML","textContent","DashboardBuilderCol","onColRemove","onTypeReset","onViewReset","onTextEdit","onShowTitleChange","onEnableFiltersChange","onFilterDimensionChange","colContainer","viewContainer","view","formLabel","labelPlacement","dynamicViewInput","htmlInput","multiline","viewAction","colActions","DashboardBuilderRow","onRowRemove","onColAdd","rowContainer","rowActions","rowAction","border","verticalAlign","VIEW_ACTION_WIDTH","onViewsHide","selectedRowIdx","setSelectedRowIdx","selectedColIdx","setSelectedColIdx","isEditTextVisible","setEditTextVisibility","tempTextValue","setTempTextValue","handleRowRemove","handleColAdd","handleColRemove","handleTypeReset","handleViewReset","handleEditTextShow","handleEditTextHide","handleShowTitleChange","handleEnableFiltersChange","handleFilterDimensionChange","__originalRow","handleViewSet","handleTextChange","Call","cb","cbParam","numberFormatter","Intl","NumberFormat","getFormattedInt","separator","subStrs","pop","subStr","getFormattedValue","decimalPlaces","emptyChar","intSeparator","int","decimal","toFixed","getValorizedElCount","array","getCorrespondingIndexInFilteredArray","n","lastIdx","found","getTableRightPadding","timeoutID","intervalID","isOnMouseDownOnSliderThumb","CustomSlider","orientation","maxValue","onIncrement","ticks","isVerticalScrollbarVisible","onMouseUp","clearInterval","handleChange","newValue","sliderId","step","containerRect","getBoundingClientRect","clientY","clientX","isEventInContainer","setInterval","sliderButton","onMouseDown","Slider","track","verticalSlider","SLIDER_WIDTH","horizontalSlider","opacity","spinnerOverlay","verticalValue","verticalMaxValue","verticalTicks","onVerticalScroll","horizontalValue","horizontalMaxValue","horizontalTicks","onHorizontalScroll","isHorizontalScrollbarVisible","setRow","setCol","setIsPaginating","handleSliderScroll","isVertical","getIncrementedValue","prevValue","delta","isIncrement","handleIncrement","prevRow","prevCol","handleWheelScroll","useCallback","wheelDeltaY","wheelDelta","wheelDeltaX","isBetween","newRow","newCol","fontWeight","isFirstRender","isTimeToUpdate","isElementInContainer","checkOnlyVertical","elementRect","getAttributesValueString","onTimeSet","time","setDatasetHtmlGeneratingTime","addSpinner","removeSpinner","table","labelFormat","isFullscreen","isPreview","removeEmptyLines","isStickyHeader","spinnerUuid","tableSupportStructures","setTableSupportStructures","htmlTable","setHtmlTable","visibleRowCount","setVisibleRowCount","visibleColCount","setVisibleColCount","tableRightPadding","setTableRightPadding","setHorizontalScrollbarVisibility","setVerticalScrollbarVisibility","setAttributes","isCopiedVisible","setCopiedVisibility","Worker","worker","terminate","handleStyle","$tooltip","hover","$elem","rect","observationAttributesMap","split","x","innerWidth","empty","cell","cellFontSize","cellPaddingLeft","cellPaddingRight","each","stickyRowCount","stickyColCount","tops","$headerRows","lefts","$firstBodyRowThs","handleScrollbar","updateVisibleRowAndColCount","$tableContainer","$table","prevIsVerticalScrollbarVisible","prevIsHorizontalScrollbarVisible","onmessage","hasAttributeObservationError","postMessage","func","colsObj","rowsObj","combinations","valorizedCols","valorizedRows","valorizedRowsPerSection","sectionsLength","rowEnd","colEnd","paginationParams","origColStart","colStart","origColEnd","rowStart","t0","performance","now","colVisited","cc","fullColSpan","repCount","colSpan","sectionLabel","r","rr","sectionsStarts","subHeaderHandled","currentSectionIdx","getSectionRow","sectionRow","currentSectionIdxClone","subHeader","rowSpan","getDataCell","dataObj","t1","getJsonStatTableHtml","prevVal","copy","Attribute","attribute","cardTitle","datasetAttributesCard","datasetAttributes","seriesAttributes","attributeGroup","otherAttributes","CardHeader","disableTypography","getNodesAtDepth","childrenKey","depth","recursive","subTree","currDepth","getTreeFromArray","parentKey","mappedArr","errorFetchDatasetAsyncHandler","getNutsLevelTranslations","0","1","2","3","4","5","6","7","8","9","selectorType","periods","dataset","accessibleDataset","isPartialData","isEmptyData","isTooBigData","isCriteriaVisible","isCriteriaAlertVisible","mode","viewerIdx","template","hasViewLayout","hasTemplateLayout","hasAnnotationLayout","tableLayout","mapLayout","chartLayout","initialCriteria","enableCriteria","enableLayout","maxAllowedCells","codes","isCodesFlat","codelists","areCodelistsFlat","codelistsLength","timePeriod","timings","isFetchStructureDisabled","isFetchDatasetDisabled","isDownloadWarningVisible","isUnavailableViewWarningVisible","isCriteriaLengthWarningVisible","geometries","geometryDetailLevels","backup","isViewVisible","isViewErrorVisible","viewErrorMessage","isTemplateVisible","datasetReducer","defaultView","getViewerTypeFromIdx","layouts","tableEmptyChar","newCriteria","period","cellCount","isResponseNotValid","responseHeaders","backendtimers","isPayloadTooLarge","isView","criteriaView","VIEW_KEY","TEMPLATE_KEY","viewTemplate","hasBackup","viewTemplateLayouts","templateLayouts","structureCriteria","filterData","getViewerIdxFromType","defaultlanguage","emptyCellPlaceHolder","isAccessible","maxTableCells","dimensionCodelist","flatCodes","codelistIdx","newCodelistsLength","parentId","dimensionCodelists","dimensionId","flatCodelists","codelist","timePeriodIdx","freqIdx","detailLevels","nutsLevel","reduce","acc","level","counter","v","console","log","getTimingsLabelTranslations","nsiResponse","nsiResponseDownload","getRow","isTitle","divider","viewer","viewers","tabId","setTabId","AppBar","scrollButtons","indicatorColor","textColor","titleTypographyProps","enableVariation","tableDefaultLayout","getEmptyViewTemplate","titleContainer","subtitle","attributeIcon","fontFamily","layoutIcon","onViewTemplateShow","showDatasetViewTemplate","onViewTemplateHide","hideDatasetViewTemplate","onViewErrorHide","nodeDownloadFormats","datasetTitle","structureView","structureTemplate","notes","attachedFiles","onViewTemplateSubmit","onDownloadSubmit","chartId","mapId","initialView","setInitialView","setView","initialTemplate","setInitialTemplate","setTemplate","isAttributesVisible","setAttributesVisibility","isNotesVisible","setNotesVisibility","isTimingsVisible","setTimingsVisibility","setDownloadFormats","isUpdatingView","setIsUpdatingView","actionsWidth","setAttribute","newDownloadFormats","isDownloadFormatValid","handleViewOpen","isUpdate","handleViewClose","handleTemplateClose","dataSet","datasetIndexes","dimsId","dimsValueId","attrs","currentFilters","dimLabel","canViewTemplateOrAnnotationIcon","canViewTimesLog","handleTemplateOpen","canShare","attachedFile","LMap","exportPng","handleViewSubmit","fullScreen","outline","floatingMenuOption","floatingMenuOptionSelected","categoryTitle","referenceMetadataIcon","iFrame","navigationActionDisabled","isCriteriaDisabled","isLayoutDisabled","isTableDisabled","isChartDisabled","isMapDisabled","referenceMetadataUrl","onViewerSelect","onCriteriaOpen","onLayoutOpen","isRefMetaVisible","setRefMetaVisibility","handleViewerSelect","MenuList","BottomNavigation","showLabels","BottomNavigationAction","src","whiteSpace","sheet","setData","isConfirmOpen","setConfirmVisibility","deleteIcon","onDelete","getFormattedName","isMultiSelectDim","dialogContent","itemDisabled","dimensionTitle","visibleId","setVisibleId","checkedKeys","setCheckedKeys","setDimensionAttributesMap","dataSpinnerUuid","handleFilterClose","InputLabel","Select","renderValue","onOpen","handleFilterOpen","getKeys","getNodeKey","handleHeight","withLevelSelector","actionHeight","levelSelectorHeight","treeActions","treeNode","treeNodeCheckbox","treeNodeLabel","textOverflow","levelTreeNodeLabel","treeNodeAction","showMoreNode","labelKey","getNodeLabel","checkable","defaultExpandedKeys","nodeActions","withoutSearch","withoutCheckControls","withoutExpandControls","withoutPagination","getIsCheckable","isLabelNotMultilingual","setSearchText","expandedKeys","setExpandedKeys","showMoreKeyClicks","setShowMoreKeyClicks","handleCheck","checkedNode","newCheckedKeys","onCheck","handleLevelCheck","nodesAtDepth","filteredTree","handleExpand","getShowMoreNode","parent","remaining","more","getTreeNode","isLevelTree","act","some","child","filterNode","search","subtree","filteredChildren","getFilteredTree","levelTree","maxTreeDepth","getMaxTreeDepth","TREE_NODE_KEY_OF_LEVEL_PREFIX","Array","pointer","disableSelection","year","S1","start","end","endOf","S2","Q1","Q2","Q3","Q4","getYearsArray","startYear","endYear","startYearNumeric","endYearNumeric","getPeriod","date","dateMoment","getNewTimePeriodFromYear","minYear","maxYear","minPeriod","maxPeriod","isFrom","newDate","isSameOrAfter","isSameOrBefore","handleSetTimePeriod","newTimePeriod","onSetTimePeriod","setCriteriaValidity","selectContainer","formControl","timePeriodInput","typeSelectorContainer","typeSelectorLabel","typeSelectorSwitch","lastPeriodsLabel","lastPeriodsInput","isCriteriaValid","fromYear","toYear","fromPeriod","toPeriod","fromPeriods","toPeriods","Switch","utils","DateFnsUtils","DatePicker","openTo","clearable","criteriaContainer","codelistInfo","codelistContainer","emptyContainer","timePeriodContainer","fetchCodelist","flatCriteria","getDatasetStructureDynamicCodelistUrl","isFull","getDatasetStructureCodelistUrl","fetchDatasetStructureCodelist","fetchCodelists","getDatasetStructureCodelistsUrl","fetchDatasetStructureCodelists","onSetCriteria","setDatasetStructureCodelistCriteria","setDatasetStructureCodelistTimePeriod","isCallDisabled","setIsCallDisabled","tmpCriteria","setTmpCriteria","tmpTabId","setTmpTabId","criteriaToRemove","handleTabChange","DataStructureRef","isSelectable","childrenKeys","unselectedChildrenKeys","onDragEnd","setDimensions","source","destination","newDimensions","droppableId","startIndex","endIndex","reorder","droppableSource","droppableDestination","move","Section","Icon","sectionHeaderIcon","sectionHeaderTitle","sectionHeaderContainer","provided","snapshot","sectionContentWrapper","isDraggingOver","draggingHover","innerRef","sectionContent","draggableId","draggableProps","dragHandleProps","isDragging","draggableStyle","userSelect","sectionItem","sectionContainer","previewContainer","setLayout","getFontSizeIcon","styleClasses","fontSizeIcon","fontSizeIconSm","fontSizeIconMd","fontSizeIconLg","fontSizeSelected","boxShadow","setFontSize","sourceArr","destinationArr","removedSrc","removedDst","swap","sectionClasses","isDragDisabled","sectionLeft","sectionRight","markSpinner","onGeometryFetch","currentDetailLevel","setCurrentDetailLevel","filteredGeometries","setFilteredGeometries","dispatchEvent","Event","firstNotEmptyLevelIndex","destroyMap","mapTranslations","configure","apply","classification","equalInterval","naturalBreaks","quantile","numberOfClasses","startColor","endColor","preview","layerOptions","srid","legendSettings","paletteStartColor","paletteEndColor","paletteCardinality","pointStartRadius","pointEndRadius","pointRadiusCardinality","classificationMethod","onDataRender","valueFormatter","centerMarker","centerMarkerText","selectedCenterMarker","mapOptions","baseMap","baseMapToGray","onLoadingStart","onLoadingFinish","legendFontFamily","WebFont","load","google","families","initMap","addLayer","geometryMap","g","missingGeometryList","territoryDim","geomId","missingEntry","filtersValues","territoryDimName","dimensionFilterValues","levelsCounter","dimValueArray","valueIdx","geom","uniqueId","wkt","float","lev","menuItem","setLabelFormat","colors","hexToRGBA","hex","alpha","parseInt","getChartType","isBarOrLineGraph","getOptions","chartType","datasets","abs","responsive","maintainAspectRatio","scales","xAxes","gridLines","beginAtZero","callback","stacked","yAxes","tooltips","enabled","callbacks","tooltipItem","getValue","datasetIndex","plugins","datalabels","anchor","align","clip","formatter","removeEmptyValues","valorizedDataMap","secondaryDimValue","fill","valorizedDataArr","secDimIdx","primaryDimValue","primDimIdx","valorizedValues","secDim","colorArr","lineTension","getDefaultRemoveEmptyValues","Chart","chartRef","ChartJs","defaults","global","defaultFontFamily","myChart","beforeDraw","chart","ctx","fillStyle","fillRect","isEqual","update","hideChart","viewerType","titleHeight","offsetHeight","headerHeight","footerHeight","filtersAndActionsHeight","page","sidebar","viewerContainer","filtersAndActions","footer","warningAlert","criteriaContent","fetchDataset","checkCriteriaLength","fetchAccessibleDataset","onFetchDatasetEnable","onCriteriaShow","onCriteriaHide","onCriteriaAlertHide","onViewerSet","setDatasetViewer","onTableLayoutSet","submitDatasetTableLayout","onMapLayoutSet","submitDatasetMapLayout","onChartLayoutSet","submitDatasetChartLayout","onLabelFormatSet","setDatasetLabelFormat","submitDatasetDownload","onDownloadHide","getCreateViewUrl","getCreateTemplateUrl","submitDatasetViewTemplate","onUnavailableViewHide","onCriteriaLengthWarningHide","idList","fetchDatasetGeometries","nodeExtras","maxObservation","tmpTableLayout","setTmpTableLayout","tmpChartLayout","setTmpChartLayout","tableLayoutSpinnerUuid","isLayoutVisible","setLayoutVisibility","setFullscreen","handleLayoutClose","handleLayoutSubmit","newTableLayout","newChartLayout","handleCriteriaClose","DownloadFormats","HiddenAttributes","classList","jsonStats","maps","dashboardReducer","currentDashboardJsonStats","viewIdx","requestIds","requestId","controllersHeight","DashboardCol","filterValue","viewLayouts","fetchMapGeometries","downloadCsv","widthPercentage","viewCard","viewPlaceholder","staticFilters","viewControllers","viewTitle","viewStaticFilters","viewStaticFilter","viewActiveFilters","DashboardRow","setViewLayouts","prevViewLayouts","newViewLayouts","initialLayout","dimArraysKey","getFilteredLayoutObject","handleFilterSelect","getStaticDashboard","staticDashboard","initialDashboard","needDashboards","dashboardViews","dashboardJsonStats","dashboardMaps","createDashboard","createOtherConfigDashboard","updateDashboard","updateOtherConfigDashboard","changeDashboard","changeOtherConfigDashboard","submitDashboardCreate","submitOtherConfigDashboardCreate","submitDashboardUpdate","getUpdateDashboardUrl","submitOtherConfigDashboardUpdate","deleteDashboard","getDeleteDashboardUrl","deleteOtherConfigDashboard","hideDashboard","fetchOtherConfigDashboardsDataset","fetchOtherConfigDashboardsMapGeometries","clearDatasets","onDashboardsClose","deleteDashboardId","setDeleteDashboardId","updateDashboardId","setUpdateDashboardId","isPreviewVisible","setPreviewVisibility","VisibilityIcon","goToDashboard","requests","OtherSettingsSelect","isViewsOpen","isDashboardsOpen","viewsSettigsRef","dashboardsSettingsRef","onViewsOpen","onDashboardsOpen","onDatasetBackup","useLocation","pathname","replace","NodeHeader","isDrawerOpen","defaultTreeOpen","onDrawerOpen","onDrawerClose","shortName","defaultAppConfigOpen","defaultUsersConfigOpen","defaultNodesConfigOpen","defaultNodeConfigOpen","noNode","leftContainer","leftToolbar","menuButton","edge","centerContainer","logoURL","sistanLogo","rightContainer","canClearServerCache","defaultAppOpen","defaultNodesOpen","defaultUsersOpen","Drawer","drawer","drawerHeader","drawerHeaderTitle","underline","drawerCategories","drawerCategoriesTitle","flexGrow","breakpoints","up","mixins","withRouter","textOnly","Home","info","nodesRef","isListMode","defaultUserConfigOpen","backgroundMediaURL","match","autoPlay","muted","loop","description","fullWidthContainer","anchorContainer","nodesContainer","footerContent","transition","toolbarButtons","fetchHub","paddingLeft","paddingRight","cardContainer","default","categoriesChunk","rootCategory","fontSizes","Subtree","parentPath","ListItem","ListItemText","Node","configIsListMode","categorySchemeTab","onListModeToggle","setCategorySchemeTab","nodeMinimalInfo","uncategorizedCategory","identifier","categoriesForExplore","categoriesContainer","categorySchemesTabs","fetchNode","getNodeUrl","fetchCatalog","getNodeCatalogUrl","resCount","checkbox","categoryGroupsWithCount","uncategorizedDatasetsCount","setExpanded","uncategorizedSelected","noCheckbox","flexWrap","path","getDownloadButtonStyle","rdf","xml","xls","collapsedDescription","expandedDescription","resultSource","cardContent","downloadChipDeleteIcon","isExpanded","onViewDataset","onCollapse","isDownloadModalOpen","setIsDownloadModalOpen","downloadModal","setDownloadModal","groupedAttachments","attachedDataFiles","group","urls","headerContent","Avatar","deleteIconSmall","catalogType","keywords","keyword","expandIcon","Results","expandedIndexes","isA11yMode","expand","collapse","onA11yModeToggle","subCategories","categoryPathLabels","Breadcrumbs","results","subCat","hubExtras","onFetchStructureEnable","enableDatasetStructureFetch","fetchStructure","getDatasetStructureUrl","fetchDatasetStructure","onDatasetReset","isTheSameData","getLabelsMap","getNodes","selectValues","setSelectValues","lastValorizedIdx","setLastValorizedIdx","onFilterApply","isApplyDisabled","setIsApplyDisable","labelsMap","getNode","foundNodes","foundNodesInChild","selects","lastLavorizableIdx","newSelectedValues","nodeHeaderHeight","dashboardsHeaderHeight","dashboardsFiltersHeight","fetchDashboard","fetchDashboardsDashboard","setDatasetFetchEnableStatus","setDashboardsDatasetFetchEnableStatus","fetchDashboardsDataset","fetchDashboardsMapGeometries","downloadViewCsv","commonsFilters","dashboardHeader","dashboardTabs","dashboardTitle","setFilterValue","allowedDashboards","setAllowedDashboards","currentDashboardId","setCurrentDashboardId","fetchedDashboards","setFetchedDashboards","tabIdx","setTabIdx","newCurrentDashboardId","newFetchedDashboards","static","dynamic","handleFilterApply","newFetchedDashboard","handleFetchDatasets","fetchStatic","fetchDynamic","dynamicFilterValue","addRequest","defaultFilterValue","isEnable","hasDynamicView","getIsFilterEnabled","FilterComponent","newFilterValue","nodeHavingCode","Recursive","exact","viewParam","URLSearchParams","a11yParam","note","referenceMetadata","ds","datasetsIdsOrDatasetId","getDatasetsIdsAndSubcategoriesOrDatasetId","datasetsIds","lastCategory","datasetIds","nextCategory","categoryId","filtersParams","decodeURIComponent","Set","testDSForQuery","testCatForFilters","dssForCount","dssForResults","searchRecursive","overrideCatSatisfyFilters","catSatisfyFilters","dssSatisfyQueryMap","recursiveCountAndFilterZero","dsId","resultsMap","filtered","appLanguage","setAppLanguage","onUserSetPasswordFormShow","showUserSetPasswordForm","tokenParam","deleteConflictModal","usedBy","getObjectTranslation","ErrorBoundary","hasError","goHome","reload","username","setUserPassword","setPasswordFormRef","defaultTheme","light","dark","contrastText","AppTheme","setTheme","doc","implementation","createHTMLDocument","styleEl","customTheme","cssRules","selectorText","colorString","rgb","substr","createMuiTheme","ThemeProvider","CssBaseline","hubReducer","nodeReducer","LocalCategoryProvider","categ","rootReducer","datasetMap","datasetUncategorized","newState","dataflowId","cachedDataflow","haveError","onDeleteConflictForce","userMiddlewareFactory","getMinutes","requestMiddlewareFactory","handleSuccess","requestAction","onSuccess","successRequest","handleGenericError","onGenericError","handleError","onManagedServerError","handleManagedServerError","axios","withCredentials","transformResponse","toString","showGenericError","configMiddleware","fileSaveMiddleware","FileSaver","saveAs","Blob","i18nMiddleware","i18n","changeLanguage","requestSpinnerMiddlewareFactory","spinnerState","feedbackMiddlewareFactory","fetchDatasetAsyncHandlerMiddlewareFactory","myWorker","successFetchDatasetAsyncHandler","onerror","all","random","resources","translation","supportedAndTranslatedLanguages","use","initReactI18next","init","lng","returnEmptyString","interpolation","escapeValue","store","configureStore","reducer","middleware","initAction","ReactDOM"],"mappings":"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","file":"static/js/main.477201c5.chunk.js","sourcesContent":["import {v4 as uuidv4} from 'uuid';\r\n\r\nexport const REQUEST_INIT = \"request/init\";\r\nexport const REQUEST_START = \"request/start\";\r\nexport const REQUEST_ERROR = \"request/error\";\r\nexport const REQUEST_SUCCESS = \"request/success\";\r\n\r\nexport enum RequestMethod {\r\n  GET = \"GET\",\r\n  POST = \"POST\",\r\n  PUT = \"PUT\",\r\n  DELETE = \"DELETE\"\r\n}\r\n\r\ntype RequestMessages = (t: (str: string, options?: any) => string) => {\r\n  onStart?: string,\r\n  onSuccess?: string,\r\n  onError?: string\r\n};\r\n\r\nexport interface RequestActionPayload {\r\n  label: string,\r\n  url: string,\r\n  method: RequestMethod,\r\n  data?: any,\r\n  messages?: RequestMessages,\r\n  extra?: any,\r\n  baseURL?: string,\r\n  getHideErrorMessage?: any,\r\n  hideSpinner?: boolean,\r\n  uuid: string,\r\n  contentType?: string,\r\n  doNotTransformResponse?: boolean\r\n}\r\n\r\nexport const initRequest = (\r\n  label: string,\r\n  url: string,\r\n  method: RequestMethod = RequestMethod.GET,\r\n  data?: any,\r\n  messages?: RequestMessages,\r\n  extra?: any,\r\n  baseURL?: string,\r\n  getHideErrorMessage?: any,\r\n  hideSpinner?: boolean,\r\n  contentType?: string,\r\n  doNotTransformResponse?: boolean\r\n) => ({\r\n  type: REQUEST_INIT,\r\n  payload: {\r\n    uuid: uuidv4(),\r\n    label,\r\n    url,\r\n    method,\r\n    data,\r\n    messages,\r\n    extra,\r\n    baseURL,\r\n    getHideErrorMessage,\r\n    hideSpinner,\r\n    contentType,\r\n    doNotTransformResponse\r\n  }\r\n});\r\n\r\nexport const startRequest = (initRequestPayload: RequestActionPayload) => ({\r\n  type: REQUEST_START,\r\n  payload: initRequestPayload\r\n});\r\n\r\nexport const successRequest = (requestActionPayload: RequestActionPayload, response?: any, extra?: any) => ({\r\n  type: REQUEST_SUCCESS,\r\n  payload: {\r\n    ...requestActionPayload,\r\n    response,\r\n    extra: {\r\n      ...extra,\r\n      ...requestActionPayload.extra\r\n    }\r\n  }\r\n});\r\n\r\nexport type ManagedServerError = {\r\n  errorCode: number,\r\n  stackTrace?: string\r\n};\r\n\r\nexport const errorRequest = (\r\n  requestActionPayload: RequestActionPayload,\r\n  statusCode?: number,\r\n  response?: any,\r\n  extra?: any\r\n) => ({\r\n  type: REQUEST_ERROR,\r\n  payload: {\r\n    ...requestActionPayload,\r\n    statusCode,\r\n    response,\r\n    extra: {\r\n      ...extra,\r\n      ...requestActionPayload.extra\r\n    }\r\n  }\r\n});\r\n","import React, {useEffect, useState} from 'react';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\n\r\nconst NotImplementedSnackbar = ({t}) => {\r\n\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isInitialized) {\r\n      window.notImplemented = {\r\n        show: () => {\r\n          setIsOpen(true);\r\n        }\r\n      };\r\n      setIsInitialized(true);\r\n    }\r\n  }, [isInitialized]);\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{vertical: 'top', horizontal: 'center'}}\r\n      open={isOpen}\r\n      autoHideDuration={5000}\r\n      onClose={() => setIsOpen(false)}\r\n      ClickAwayListenerProps={{\r\n        onClickAway: () => {\r\n        }\r\n      }}\r\n    >\r\n      <Alert severity=\"warning\">{t(\"components.notImplementedSnackbar.label\")}</Alert>\r\n    </Snackbar>\r\n  );\r\n};\r\n\r\nexport default withTranslation()(NotImplementedSnackbar);","export const SPINNER_MESSAGE_ADD = \"spinner/addMessage\";\r\nexport const SPINNER_MESSAGE_REMOVE = \"spinner/removeMessage\";\r\nexport const SPINNER_TIMEOUT_SET = \"spinner/setTimeout\";\r\nexport const SPINNER_TIMEOUT_CLEAR = \"spinner/clearTimeout\";\r\nexport const SPINNER_FLUSH = \"spinner/flush\";\r\n\r\nexport const addSpinnerMessage = (uid: any, message: any) => ({\r\n  type: SPINNER_MESSAGE_ADD,\r\n  payload: {\r\n    uid,\r\n    message\r\n  }\r\n});\r\n\r\nexport const markSpinnerMessage = (uid: any, isError?: boolean) => ({\r\n  type: SPINNER_MESSAGE_REMOVE,\r\n  payload: {\r\n    uid,\r\n    isError\r\n  }\r\n});\r\n\r\nexport const setSpinnerTimeout = (timeout: any) => ({\r\n  type: SPINNER_TIMEOUT_SET,\r\n  payload: {\r\n    timeout\r\n  }\r\n});\r\n\r\nexport const clearSpinnerTimeout = () => ({\r\n  type: SPINNER_TIMEOUT_CLEAR\r\n});\r\n\r\nexport const flushSpinner = () => ({\r\n  type: SPINNER_FLUSH\r\n});\r\n\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {withStyles, withTheme} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport \"./style.css\";\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\nimport {flushSpinner} from \"../../state/spinner/spinnerActions\";\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\n\r\nconst OVERLAY_OPACITY_HEX = \"CC\";\r\n\r\nconst styles = theme => ({\r\n  container: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  overlay: {\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    zIndex: 2000\r\n  },\r\n  progressContainer: {\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\"\r\n  },\r\n  progress: {\r\n    width: 320,\r\n    maxWidth: \"50%\"\r\n  },\r\n  messagesContainer: {\r\n    position: \"relative\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    textAlign: \"center\"\r\n  },\r\n  messages: {\r\n    display: \"inline-block\",\r\n    marginTop: \"calc(50vh + 48px)\"\r\n  },\r\n  childrenContainer: {\r\n    position: \"absolute\",\r\n    top: 0,\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  messageRow: {\r\n    height: 32\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  messages: state.spinner.messages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  flushSpinner: () => dispatch(flushSpinner())\r\n});\r\n\r\nconst Spinner = ({classes, theme, children, messages, flushSpinner}) => {\r\n\r\n  const [isHandlerOn, setIsHandlerOn] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isHandlerOn) {\r\n      window.addEventListener('popstate', () => {\r\n        flushSpinner();\r\n      });\r\n      setIsHandlerOn(true);\r\n    }\r\n  }, [flushSpinner, isHandlerOn]);\r\n\r\n  return (\r\n    <Box className={classes.container}>\r\n      <Box\r\n        id=\"spinner\"\r\n        className={classes.overlay + \" \" + (messages.length === 0 ? \"invisible\" : \"\")}\r\n        style={{\r\n          background: theme.palette.primary.main + OVERLAY_OPACITY_HEX,\r\n        }}\r\n      >\r\n        <Box className={classes.progressContainer}>\r\n          <LinearProgress className={classes.progress} color=\"secondary\"/>\r\n        </Box>\r\n        <Box className={classes.messagesContainer}>\r\n          <Box className={classes.messages}>\r\n            {messages.map(({uid, message, removed, isError}) =>\r\n              <Grid container key={uid}\r\n                    justify={messages.filter(({removed}) => removed).length > 0 ? \"space-between\" : \"center\"}\r\n                    className={classes.messageRow}\r\n                    spacing={2}>\r\n                <Grid item>\r\n                  <Typography color=\"secondary\">\r\n                    {message} {!removed && \"...\"}\r\n                  </Typography>\r\n                </Grid>\r\n                {removed && (\r\n                  <Grid item style={{color: isError ? theme.palette.error.main : theme.palette.success.main}}>\r\n                    {isError ? <CancelIcon fontSize=\"small\"/> : <CheckCircleIcon fontSize=\"small\"/>}\r\n                  </Grid>\r\n                )}\r\n              </Grid>\r\n            )}\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n      <Box className={classes.childrenContainer} style={{overflow: messages.length > 0 ? \"hidden\" : \"initial\"}}>\r\n        {children}\r\n      </Box>\r\n    </Box>\r\n  )\r\n    ;\r\n};\r\n\r\nexport default compose(withStyles(styles), withTheme, connect(mapStateToProps, mapDispatchToProps))(Spinner);","import React from 'react';\r\nimport {sanitize} from \"dompurify\";\r\nimport Box from \"@material-ui/core/Box\";\r\n\r\nconst SanitizedHTML = props =>\r\n  <Box\r\n    {...props}\r\n    html={undefined}\r\n    dangerouslySetInnerHTML={{__html: sanitize(props.html)}}\r\n  />;\r\n\r\nexport default SanitizedHTML;","import React, {useEffect, useState} from 'react';\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\n\r\n\r\nconst ErrorSnackbar = () => {\r\n\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [message, setMessage] = useState(null);\r\n  const [isError, setIsError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (!isInitialized) {\r\n      window.error = {\r\n        show: (message, isError) => {\r\n          setIsVisible(true);\r\n          setMessage(message);\r\n          setIsError(isError !== undefined ? isError : true);\r\n        }\r\n      };\r\n      setIsInitialized(true);\r\n    }\r\n  }, [isInitialized]);\r\n\r\n  return (\r\n    <Snackbar\r\n      open={isVisible}\r\n      autoHideDuration={5000}\r\n      onClose={() => {\r\n        setIsVisible(false);\r\n      }}\r\n      onExited={() => {\r\n        setMessage(null);\r\n        setIsError(null);\r\n      }}\r\n      ClickAwayListenerProps={{\r\n        onClickAway: () => {\r\n        }\r\n      }}\r\n      anchorOrigin={{vertical: 'top', horizontal: 'center'}}\r\n    >\r\n      <Alert severity={isError ? \"error\" : \"success\"}>\r\n        <SanitizedHTML component=\"span\" html={message}/>\r\n      </Alert>\r\n    </Snackbar>\r\n  );\r\n};\r\n\r\nexport default ErrorSnackbar;","import React, {Fragment} from 'react'\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {Helmet} from \"react-helmet\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  background: {\r\n    \"&, & > *\": {\r\n      position: \"fixed\",\r\n      width: \"100%\",\r\n      height: \"100%\",\r\n      objectFit: \"cover\",\r\n      zIndex: -9999\r\n    }\r\n  },\r\n  textContainer: {\r\n    color: \"white\",\r\n    textAlign: \"center\",\r\n    padding: 24,\r\n    background: \"rgba(0,0,0,0.5)\"\r\n  },\r\n  lightTextContainer: {\r\n    color: theme.palette.primary.main,\r\n    textAlign: \"center\",\r\n    width: \"80%\"\r\n  },\r\n  buttonsContainer: {\r\n    marginTop: theme.spacing(3),\r\n    '& > *': {\r\n      margin: '8px !important'\r\n    }\r\n  },\r\n  logo: {\r\n    position: \"absolute\",\r\n    top: \"80%\",\r\n    width: \"80%\",\r\n    textAlign: \"center\",\r\n    \"& > *\": {\r\n      maxWidth: 340,\r\n      maxHeight: 64\r\n    }\r\n  }\r\n});\r\n\r\nconst Hero = ({classes, title, slogan, logo, background, children}) =>\r\n  <Fragment>\r\n    <Helmet>\r\n      <style type=\"text/css\">\r\n        {`\r\n          html, body, #root {\r\n            height: 100%\r\n          }\r\n        `}\r\n      </style>\r\n    </Helmet>\r\n    <div className={classes.root}>\r\n      <div className={classes.background}>\r\n        {background}\r\n      </div>\r\n      <div className={classes.textContainer}>\r\n        <Typography variant=\"h2\">\r\n          {title}\r\n        </Typography>\r\n        {slogan?.length > 0 && (\r\n          <Typography variant=\"h3\"\r\n                      style={{fontSize: 24, paddingTop: 16}}>\r\n            {slogan}\r\n          </Typography>\r\n        )}\r\n      </div>\r\n      <Box className={classes.buttonsContainer}>\r\n        {children}\r\n      </Box>\r\n      <Box className={classes.logo}>\r\n        {logo}\r\n      </Box>\r\n    </div>\r\n  </Fragment>;\r\n\r\nexport default withStyles(styles)(Hero);","import React from 'react';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardMedia from \"@material-ui/core/CardMedia\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = () => ({\r\n  card: {\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\nconst CardsGrid = ({list, onClick, classes, squareImage}) =>\r\n  <Grid container spacing={2}>\r\n    {(() => {\r\n      const hasImage = squareImage && list.find(c => c.image);\r\n      return list.map((c, i) =>\r\n        <Grid key={i} item xs={hasImage ? 3 : 4}>\r\n          <Card className={classes.card} id={`cards-grid__card-${c.id}`}>\r\n            <CardActionArea onClick={() => onClick(c)}>\r\n              {c.image && (\r\n                <CardMedia\r\n                  component=\"img\"\r\n                  height={hasImage ? 232 : (squareImage ? 315 : 177)}\r\n                  title={c.label}\r\n                  image={c.image}\r\n                  alt={c.label}\r\n                />\r\n              )}\r\n              <CardContent>\r\n                <Typography gutterBottom variant=\"h5\" style={{fontSize: 20}}>\r\n                  {c.label}\r\n                </Typography>\r\n              </CardContent>\r\n            </CardActionArea>\r\n          </Card>\r\n        </Grid>\r\n      );\r\n    })()}\r\n  </Grid>;\r\n\r\nexport default withStyles(styles)(CardsGrid);","import React, {Fragment} from 'react';\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport Box from \"@material-ui/core/Box\";\r\n\r\nconst PageSection = props =>\r\n  <Box {...props}>\r\n    {props.sectiontitle && (\r\n      <Fragment>\r\n        <Typography variant=\"h4\" gutterBottom margin={4} style={{fontSize: 34}}>\r\n          {props.sectiontitle}\r\n        </Typography>\r\n        <Divider/>\r\n      </Fragment>\r\n    )}\r\n    {props.children}\r\n  </Box>;\r\n\r\nexport default PageSection;","import React, {Component} from 'react';\r\nimport Zoom from \"@material-ui/core/Zoom\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport {ArrowUpward} from \"@material-ui/icons\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n  },\r\n  fab: {\r\n    position: 'fixed',\r\n    right: 8,\r\n    bottom: 55,\r\n    height: '50px',\r\n    width: '50px',\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  childrenContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    '& > *:last-child': {\r\n      paddingBottom: theme.spacing(10)\r\n    }\r\n  },\r\n  oldBrowserWarning: {\r\n    position: \"fixed\",\r\n    bottom: 0,\r\n    left: 0,\r\n    zIndex: 1999,\r\n    height: 48,\r\n    width: \"100%\",\r\n    background: \"rgba(0, 0, 0, 0.7)\",\r\n    fontSize: 16,\r\n    lineHeight: \"34px\",\r\n    color: \"white\",\r\n    padding: 8\r\n  }\r\n});\r\n\r\nclass Page extends Component {\r\n\r\n  state = {\r\n    transparent: true,\r\n    isOldBrowserWarningVisible: false\r\n  };\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true,\r\n    });\r\n  }\r\n\r\n  scrollTop() {\r\n    window.scroll({top: 0, left: 0, behavior: 'smooth'});\r\n  }\r\n\r\n  handleScroll = () => {\r\n    const {transparent} = this.state;\r\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n\r\n    if (scrollTop > 50 && transparent) {\r\n      this.setState({transparent: false});\r\n    }\r\n\r\n    if (scrollTop <= 50 && !transparent) {\r\n      this.setState({transparent: true});\r\n    }\r\n  };\r\n\r\n  closeWarning = () => {\r\n    this.setState({isOldBrowserWarningVisible: false});\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Internet Explorer 6-11\r\n    const isIE = !!document.documentMode;\r\n\r\n    // Edge 20+\r\n    const isEdge = !isIE && !!window.StyleMedia;\r\n\r\n    this.setState({isOldBrowserWarningVisible: (isIE || isEdge)});\r\n\r\n    window.scroll({top: 0, left: 0});\r\n\r\n    window.addEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  render() {\r\n\r\n    const {classes, children} = this.props;\r\n    const {transparent, isOldBrowserWarningVisible} = this.state;\r\n\r\n    return (\r\n      <div className={classes.root}>\r\n        {isOldBrowserWarningVisible && (\r\n          <div className={classes.oldBrowserWarning}>\r\n            <Grid container justify=\"space-between\">\r\n              <Grid item>\r\n                This browser in not completely supported, please consider to install the new version\r\n                of <a href=\"https://www.microsoft.com/edge\" target=\"_blank\" rel=\"noopener noreferrer\"\r\n                      style={{color: \"white\"}}>Microsoft Edge</a>\r\n              </Grid>\r\n              <Grid item>\r\n                <IconButton onClick={this.closeWarning} style={{color: \"white\", padding: 7}}>\r\n                  <ClearIcon fontSize=\"small\"/>\r\n                </IconButton>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        )}\r\n        <Zoom in={!transparent}>\r\n          <Fab className={classes.fab} color=\"secondary\" onClick={this.scrollTop}>\r\n            <ArrowUpward/>\r\n          </Fab>\r\n        </Zoom>\r\n        <div className={classes.childrenContainer}>\r\n          {children}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(Page);","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    USER_CLEAR,\r\n    USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR,\r\n    USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET,\r\n    USER_FETCH,\r\n    USER_LOGIN_FORM_HIDE,\r\n    USER_LOGIN_FORM_SHOW,\r\n    USER_REFRESH,\r\n    USER_SET_PASSWORD_FORM_HIDE,\r\n    USER_SET_PASSWORD_FORM_SHOW\r\n} from './userActions';\r\nimport {INIT} from '../rootActions';\r\nimport {PERSISTENCE_ACTION_KEY} from '../../middlewares/persistence/middleware';\r\nimport {USER_ERRORS_INVALID_LOGIN} from '../../constants/getUserErrorsTranslations';\r\n\r\nexport enum UserRoles {\r\n    Administrator= \"Administrator\",\r\n    User = \"User\"\r\n}\r\n\r\nexport enum UserPermissions {\r\n    ManageCache = \"ManageCache\",\r\n    ManageTemplate = \"ManageTemplate\",\r\n    ManageConfig = \"ManageConfig\",\r\n    ManageView = \"ManageView\"\r\n}\r\n\r\nexport type UserState = {\r\n    isAuthenticated: boolean,\r\n    email: string | null,\r\n    roles: UserRoles[],\r\n    permissions: string[],\r\n    token: string | null, // auth token\r\n    refreshTokenExpiration: string | null, // refresh token expiration time (utc)\r\n    tokenTTL: number | null // auth token expiration ttl (minutes)\r\n    tokenReceivedTime: number | null // auth token received time (ms from unix epoch)\r\n    isLoginDialogOpen: boolean,\r\n    delayedRequest: object | null,\r\n    message: string | null\r\n};\r\n\r\nconst initialState = {\r\n    isAuthenticated: false,\r\n    email: null,\r\n    roles: [],\r\n    permissions: [],\r\n    token: null,\r\n    refreshTokenExpiration: null,\r\n    tokenTTL: null,\r\n    tokenReceivedTime: null,\r\n    isLoginDialogOpen: false,\r\n    delayedRequest: null,\r\n    message: null\r\n};\r\n\r\nconst userReducer: Reducer<UserState> = (\r\n    state = initialState,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT:\r\n            return action.payload[PERSISTENCE_ACTION_KEY].user\r\n                ? ({\r\n                    ...initialState,\r\n                    ...action.payload[PERSISTENCE_ACTION_KEY].user\r\n                })\r\n                : initialState;\r\n        case USER_LOGIN_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                isLoginDialogOpen: true,\r\n                message: action.payload?.alert\r\n            };\r\n        case USER_LOGIN_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                isLoginDialogOpen: false,\r\n                message: undefined\r\n            };\r\n        case USER_SET_PASSWORD_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                isSetPasswordDialogOpen: true,\r\n                setPasswordToken: action.payload.token\r\n            };\r\n        case USER_SET_PASSWORD_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                isSetPasswordDialogOpen: false,\r\n                message: undefined\r\n            };\r\n        case USER_CLEAR:\r\n            return initialState;\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case USER_FETCH: {\r\n                    const response = action.payload.response;\r\n                    return {\r\n                        ...response,\r\n                        isLoginDialogOpen: !response.isAuthenticated,\r\n                        tokenReceivedTime: new Date().getTime()\r\n                    };\r\n                }\r\n                case USER_REFRESH:\r\n                    const response = action.payload.response;\r\n                    return {\r\n                        ...response,\r\n                        isLoginDialogOpen: state.isLoginDialogOpen,\r\n                        tokenReceivedTime: new Date().getTime()\r\n                    };\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        case USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET:\r\n            return {\r\n                ...state,\r\n                delayedRequest: action.payload.request\r\n            };\r\n        case USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR:\r\n            return {\r\n                ...state,\r\n                delayedRequest: null\r\n            };\r\n        case REQUEST_ERROR: {\r\n            switch (action.payload.label) {\r\n                case USER_FETCH: {\r\n                    if (action.payload.response.status === 401) {\r\n                        return {\r\n                            ...state,\r\n                            message: USER_ERRORS_INVALID_LOGIN\r\n                        };\r\n                    }\r\n                    return state;\r\n                }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default userReducer;","/* config.json */\r\nexport const getInitConfigUrl = () => \"config.json\";\r\nexport const getAppConfigUrl = () => \"appConfig.json\";\r\n\r\n/* hub */\r\nexport const getHubMinimalInfoUrl = () => \"hub/minimalInfo\";\r\n\r\n/* node */\r\nexport const getNodeUrl = (nodeId: number) => `nodes/${nodeId}`;\r\nexport const getNodeCatalogUrl = (nodeId: number) => `nodes/${nodeId}/catalog`;\r\n\r\n/* cache */\r\nexport const getClearMemoryCacheUrl = () => \"MemoryCache/Clear\";\r\nexport const getDataflowsCacheListUrl = (nodeId: number) => `DataflowCache/DataflowData/Nodes/${nodeId}`;\r\nexport const getDataflowsCacheUpdateUrl = (nodeId: number, cacheId: string) => `DataflowCache/DataflowData/${cacheId}/Nodes/${nodeId}`;\r\nexport const getDataflowsCreateCacheUrl = (nodeId: number) => `DataflowCache/DataflowData/Nodes/${nodeId}`;\r\nexport const getDataflowsClearCacheUrl = (nodeId: number, cacheId: string) => `DataflowCache/Clear/${cacheId}/Nodes/${nodeId}`;\r\nexport const getDataflowsClearAllCacheUrl = (nodeId: number) => `DataflowCache/ClearAll/Nodes/${nodeId}`;\r\nexport const getClearNodeCatalogMemoryCacheUrl = (nodeId: number) => `MemoryCache/Clear/CatalogTree/Nodes/${nodeId}`;\r\n\r\n/* templates */\r\nexport const getNodeTemplatesUrl = (nodeId: number) => `nodes/${nodeId}/templates`;\r\nexport const getCreateTemplateUrl = (nodeId: number) => `nodes/${nodeId}/templates`;\r\nexport const getDeleteTemplateUrl = (nodeId: number, id: number) => `nodes/${nodeId}/templates/${id}`;\r\n\r\n/* views */\r\nexport const getViewsUrl = () => `views`;\r\nexport const getCreateViewUrl = (nodeId: number) => `nodes/${nodeId}/views`;\r\nexport const getDeleteViewUrl = (nodeId: number, id: number) => `nodes/${nodeId}/views/${id}`;\r\n\r\n/* dataset */\r\nexport const getDatasetUrl = (nodeId: number, datasetId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/data`;\r\nexport const getDatasetStructureUrl = (nodeId: number, datasetId: string, viewId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/structure${viewId ? `/${viewId}` : \"\"}`;\r\nexport const getDatasetStructureCodelistUrl = (nodeId: number, datasetId: string, dimensionId: string, isFull: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/column/${dimensionId}/${isFull ? \"full\" : \"partial\"}/values`;\r\nexport const getDatasetStructureDynamicCodelistUrl = (nodeId: number, datasetId: string, dimensionId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/PartialCodelists/${dimensionId}`;\r\nexport const getDatasetStructureCodelistsUrl = (nodeId: number, datasetId: string, isFull: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/columns/${isFull ? \"full\" : \"partial\"}/values`;\r\nexport const getDatasetDownloadUrl = (nodeId: number, datasetId: string, format: string, zipped?: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/${zipped === true ? \"downloadZip\" : \"download\"}/${format}`;\r\n\r\n/* config */\r\nexport const getHubConfigGetUrl = () => \"hub/config\";\r\nexport const getHubConfigPutUrl = () => \"hub\";\r\nexport const getNodesConfigUrl = () => \"nodes/config\";\r\nexport const getNodesOrderPutUrl = () => \"nodes/order\";\r\nexport const getNodeConfigGetUrl = (nodeId: number) => `nodes/${nodeId}/config`;\r\nexport const getNodesConfigPostUrl = () => 'nodes';\r\nexport const getNodesConfigPutUrl = (nodeId: number) => `nodes/${nodeId}`;\r\nexport const getNodeDeleteUrl = (nodeId: number, force?: boolean) => `nodes/${nodeId}${force ? \"/true\" : \"\"}`;\r\n\r\n/* log */\r\nexport const getQueryLog = (limit: number) => `tracing/limit/${limit}`;\r\n\r\n/* files */\r\nexport const getFileUploadUrl = () => 'File/Upload';\r\n\r\n/* authentication */\r\nexport const getTokenUrl = () => 'auth/token';\r\nexport const getRefreshTokenUrl = () => 'auth/refreshToken';\r\n\r\n/* users management */\r\nexport const getUsersConfigGetUrl = () => \"users\";\r\nexport const getUserConfigGetUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserConfigPostUrl = () => \"users/register\";\r\nexport const getUserConfigPutUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserDeleteUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserSendResetPasswordMailUrl = () => 'Users/RecoveryPassword';\r\nexport const getUserResetPasswordUrl = () => 'Users/ResetPassword';\r\nexport const getUserChangePasswordUrl = () => 'Users/ChangePassword';\r\n\r\n/* Geometry */\r\nexport const getGeometryUrl = () => `Geometry`;\r\n\r\n/* permissions */\r\nexport const getNodePermissionsConfigGetUrl = (nodeId: number) => `Users/Permissions/Nodes/${nodeId}`;\r\nexport const getNodePermissionsConfigPutUrl = (nodeId: number) => `Users/Permissions/Nodes/${nodeId}`;\r\n\r\n/* dashboards */\r\nexport const getUserDashboardsUrl = () => \"Dashboards\";\r\nexport const getDashboardsUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getDeleteDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getCreateDashboardUrl = () => `Dashboards/`;\r\nexport const getUpdateDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getHubDashboardsUrl = () => \"Dashboards/Hub\";\r\nexport const getNodeDashboardsUrl = (nodeId: number) => `Dashboards/Nodes/${nodeId}`;\r\nexport const getAddHubDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}/Hub`;\r\nexport const getRemoveHubDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}/Hub`;\r\nexport const getOrderHubDashboardsUrl = () => 'Dashboards/Order/Hub';\r\nexport const getAddNodeDashboardUrl = (nodeId: number, dashboardId: number) => `Dashboards/${dashboardId}/Nodes/${nodeId}`;\r\nexport const getRemoveNodeDashboardUrl = (nodeId: number, dashboardId: number) => `Dashboards/${dashboardId}/Nodes/${nodeId}`;\r\nexport const getOrderNodeDashboardsUrl = (nodeId: number) => `Dashboards/Order/Nodes/${nodeId}`;","import {initRequest, RequestMethod} from '../../middlewares/request/requestActions';\r\nimport {\r\n    getRefreshTokenUrl,\r\n    getTokenUrl,\r\n    getUserChangePasswordUrl,\r\n    getUserResetPasswordUrl,\r\n    getUserSendResetPasswordMailUrl\r\n} from '../../serverApi/urls';\r\n\r\nexport const USER_FETCH = 'USER_FETCH';\r\nexport const USER_REFRESH = 'USER_REFRESH';\r\nexport const USER_CLEAR = 'USER_CLEAR';\r\nexport const USER_LOGIN_FORM_SHOW = 'USER_LOGIN_FORM_SHOW';\r\nexport const USER_LOGIN_FORM_HIDE = 'USER_LOGIN_FORM_HIDE';\r\nexport const USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET = 'USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET';\r\nexport const USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR = 'USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR';\r\nexport const USER_SET_PASSWORD_FORM_SHOW = 'USER_SET_PASSWORD_FORM_SHOW';\r\nexport const USER_SET_PASSWORD_FORM_HIDE = 'USER_SET_PASSWORD_FORM_HIDE';\r\nexport const USER_RESET_PASSWORD_EMAIL_SEND = 'USER_RESET_PASSWORD_EMAIL_SEND';\r\nexport const USER_PASSWORD_CHANGE = 'USER_PASSWORD_CHANGE';\r\nexport const USER_PASSWORD_SET = 'USER_PASSWORD_SET';\r\n\r\nexport const fetchUser = (email: string, password: string) => initRequest(\r\n    USER_FETCH,\r\n    getTokenUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        Email: email,\r\n        Password: btoa(password)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userSelect.messages.fetchUser.start\")\r\n    })\r\n);\r\n\r\nexport const refreshUser = () => initRequest(\r\n    USER_REFRESH,\r\n    getRefreshTokenUrl(),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"middlewares.user.messages.refreshUser.start\")\r\n    })\r\n);\r\n\r\nexport const clearUser = () => ({\r\n    type: USER_CLEAR\r\n});\r\n\r\nexport const showUserLoginForm = (alert: string) => ({\r\n    type: USER_LOGIN_FORM_SHOW,\r\n    payload: {\r\n        alert\r\n    }\r\n});\r\n\r\nexport const hideUserLoginForm = () => ({\r\n    type: USER_LOGIN_FORM_HIDE\r\n});\r\n\r\nexport const setUserDelayedRequestWhenTokenExpired = (request: object) => ({\r\n    type: USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET,\r\n    payload: {\r\n        request\r\n    }\r\n});\r\n\r\nexport const clearUserDelayedRequestWhenTokenExpired = () => ({\r\n    type: USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR\r\n});\r\n\r\nexport const hideUserSetPasswordForm = () => ({\r\n    type: USER_SET_PASSWORD_FORM_HIDE\r\n});\r\n\r\nexport const sendUserResetPasswordEmail = (email: string) => initRequest(\r\n    USER_RESET_PASSWORD_EMAIL_SEND,\r\n    getUserSendResetPasswordMailUrl(),\r\n    RequestMethod.POST,\r\n    email,\r\n    t => ({\r\n        onStart: t(\"components.userRecoverPassword.messages.submit.start\")\r\n    }),\r\n    undefined,\r\n    undefined,\r\n    undefined,\r\n    undefined,\r\n    \"application/json\"\r\n);\r\n\r\nexport const changeUserPassword = (oldPassword: string, newPassword: string) => initRequest(\r\n    USER_PASSWORD_CHANGE,\r\n    getUserChangePasswordUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        oldPassword: btoa(oldPassword),\r\n        newPassword: btoa(newPassword)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userChangePasswordForm.messages.submit.start\")\r\n    })\r\n);\r\n\r\nexport const setUserPassword = (email: string, token: string, password: string) => initRequest(\r\n    USER_PASSWORD_SET,\r\n    getUserResetPasswordUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        username: email,\r\n        token,\r\n        password: btoa(password)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userSetPasswordForm.messages.submit.start\")\r\n    })\r\n);\r\n\r\nexport const showUserSetPasswordForm = (token: string) => ({\r\n    type: USER_SET_PASSWORD_FORM_SHOW,\r\n    payload: {\r\n        token\r\n    }\r\n});\r\n","import React, {Fragment} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {DialogActions} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst SettingsDialog = ({title, children, onSubmit, onClose, open, maxWidth, hasSubmit, noMinHeight}) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth={maxWidth || \"md\"}\r\n      fullWidth\r\n      onClose={onClose}\r\n    >\r\n      <DialogTitle>\r\n        {title}\r\n      </DialogTitle>\r\n      <DialogContent\r\n        style={{\r\n          minHeight: noMinHeight ? undefined : 456,\r\n          paddingBottom: noMinHeight ? 16 : undefined\r\n        }}\r\n      >\r\n        {children}\r\n      </DialogContent>\r\n      <DialogActions>\r\n        {hasSubmit\r\n          ? (\r\n            <Fragment>\r\n              <Button onClick={onClose}>\r\n                {t(\"commons.confirm.cancel\")}\r\n              </Button>\r\n              <Button\r\n                onClick={onSubmit}\r\n              >\r\n                {t(\"commons.confirm.submit\")}\r\n              </Button>\r\n            </Fragment>\r\n          )\r\n          : (\r\n            <Button onClick={onClose}>\r\n              {t(\"commons.confirm.close\")}\r\n            </Button>\r\n          )}\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default SettingsDialog;\r\n","import React, {forwardRef, Fragment, useImperativeHandle} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {sendUserResetPasswordEmail} from \"../../../state/user/userActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit}, ref) => {\r\n\r\n  const {register, errors, handleSubmit} = useForm();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        onSubmit(val);\r\n        f(val);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            style={{marginBottom: 8}}\r\n            name=\"email\"\r\n            label={t(\"components.userLoginDialog.recoverPasswordModal.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  sendConfig: config => dispatch(sendUserResetPasswordEmail(config.email))\r\n});\r\n\r\nconst UserRecoverPasswordForm = ({config, sendConfig, userErrors}, ref) => {\r\n\r\n  return (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>))}\r\n      <Form\r\n        ref={ref}\r\n        onSubmit={sendConfig}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserRecoverPasswordForm);\r\n","export const USER_ERRORS_INVALID_LOGIN = \"InvalidLogin\";\r\n\r\nexport const getUserErrorsTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    InvalidLogin: t(\"errors.user.invalidLogin\"),\r\n    PasswordRequiresDigit: t(\"errors.user.passwordRequiresDigit\"),\r\n    PasswordTooShort: t(\"errors.user.passwordTooShort\"),\r\n    PasswordRequiresNonAlphanumeric: t(\"errors.user.passwordRequiresNonAlphanumeric\"),\r\n    PasswordRequiresUpper: t(\"errors.user.passwordRequiresUpper\"),\r\n    PasswordRequiresLower: t(\"errors.user.passwordRequiresLower\"),\r\n    InvalidEmail: t(\"errors.user.invalidEmail\")\r\n  });\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};\r\n","import React, {Fragment, useRef, useState} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {DialogActions, withStyles} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport {useForm} from \"react-hook-form\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport UserRecoverPasswordForm from \"./user-recover-password-form\";\r\nimport {getUserErrorsTranslations} from \"../../constants/getUserErrorsTranslations\";\r\n\r\nconst styles = theme => ({\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  recoverPassword: {\r\n    textDecoration: \"underline\",\r\n    color: theme.palette.secondary.main,\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\nconst UserLoginDialog = ({open, onSubmit, onHide, onRegister, classes, alert}) => {\r\n\r\n  const {register, errors, handleSubmit} = useForm();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isRecoverPasswordModalOpen, setIsRecoverPasswordModalOpen] = useState(false);\r\n\r\n  const recoverPasswordFormRef = useRef();\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n      onClose={onHide}\r\n    >\r\n      <DialogTitle>\r\n        {t(\"components.userLoginDialog.title\")}\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        {alert && (\r\n          <Alert severity=\"error\">{getUserErrorsTranslations(t)[alert]}</Alert>\r\n        )}\r\n        <FormControl fullWidth className={alert ? classes.field : undefined}>\r\n          <TextField\r\n            name=\"email\"\r\n            label={t(\"components.userLoginDialog.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n        <FormControl fullWidth className={classes.field}>\r\n          <TextField\r\n            name=\"password\"\r\n            type=\"password\"\r\n            label={t(\"components.userLoginDialog.fields.password\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.password}\r\n            helperText={\r\n              <Fragment>\r\n                {errors.password?.message}\r\n                <span\r\n                  onClick={() => setIsRecoverPasswordModalOpen(true)}\r\n                  className={classes.recoverPassword}\r\n                  style={{\r\n                    marginLeft: errors.password?.message ? 2 : 0\r\n                  }}>\r\n                  {t(\"components.userLoginDialog.recoverPassword\")}\r\n                </span>\r\n              </Fragment>\r\n            }\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onHide}>\r\n          {t(\"commons.confirm.cancel\")}\r\n        </Button>\r\n        <Button onClick={onRegister}>\r\n          {t(\"components.userLoginDialog.register\")}\r\n        </Button>\r\n        <Button onClick={handleSubmit(onSubmit)}>\r\n          {t(\"components.userLoginDialog.login\")}\r\n        </Button>\r\n      </DialogActions>\r\n      <SettingsDialog\r\n        title={t(\"components.userLoginDialog.recoverPasswordModal.title\")}\r\n        maxWidth={\"xs\"}\r\n        open={isRecoverPasswordModalOpen}\r\n        onClose={() => {\r\n          if (recoverPasswordFormRef.current) {\r\n            recoverPasswordFormRef.current.cancel(() => {\r\n              setIsRecoverPasswordModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsRecoverPasswordModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (recoverPasswordFormRef.current) {\r\n            recoverPasswordFormRef.current.submit(() => {\r\n              setIsRecoverPasswordModalOpen(false);\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n        noMinHeight\r\n      >\r\n        <UserRecoverPasswordForm ref={recoverPasswordFormRef}/>\r\n      </SettingsDialog>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(UserLoginDialog);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getUserConfigGetUrl,\r\n    getUserConfigPostUrl,\r\n    getUserConfigPutUrl,\r\n    getUserDeleteUrl,\r\n    getUsersConfigGetUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const USERS_CONFIG_USERS_FETCH = \"usersConfig/fetchUsers\";\r\nexport const USERS_CONFIG_USERS_CLEAR = \"usersConfig/clearUsers\";\r\nexport const USERS_CONFIG_USER_FETCH = \"usersConfig/fetchUser\";\r\nexport const USERS_CONFIG_USER_CLEAR = \"usersConfig/clearUser\";\r\nexport const USERS_CONFIG_USER_DELETE = \"usersConfig/deleteUser\";\r\nexport const USERS_CONFIG_USER_CREATE = \"usersConfig/createUser\";\r\nexport const USERS_CONFIG_USER_EDIT = \"usersConfig/editUser\";\r\nexport const USER_CONFIG_FORM_SHOW = \"usersConfig/showForm\";\r\nexport const USER_CONFIG_FORM_HIDE = \"usersConfig/hideForm\";\r\n\r\nexport const fetchUsersConfigUsers = () => initRequest(\r\n    USERS_CONFIG_USERS_FETCH,\r\n    getUsersConfigGetUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.fetchUsers.start\")\r\n    })\r\n);\r\n\r\nexport const clearUsersConfigUsers = () => ({\r\n    type: USERS_CONFIG_USERS_CLEAR\r\n});\r\n\r\nexport const fetchUsersConfigUser = (userId: number) => initRequest(\r\n    USERS_CONFIG_USER_FETCH,\r\n    getUserConfigGetUrl(userId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.fetchUser.start\")\r\n    })\r\n);\r\n\r\nexport const clearUsersConfigUser = () => ({\r\n    type: USERS_CONFIG_USER_CLEAR\r\n});\r\n\r\nexport const deleteUsersConfigUser = (userId: number) => initRequest(\r\n    USERS_CONFIG_USER_DELETE,\r\n    getUserDeleteUrl(userId),\r\n    RequestMethod.DELETE,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.deleteUser.start\")\r\n    }),\r\n    {\r\n        userId\r\n    }\r\n);\r\n\r\nexport const sendUsersConfigUserCreate = (user: any, isAnonymous: boolean) => initRequest(\r\n    USERS_CONFIG_USER_CREATE,\r\n    getUserConfigPostUrl(),\r\n    RequestMethod.POST,\r\n    user,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.sendUserCreate.start\")\r\n    }),\r\n    {\r\n        isAnonymous\r\n    }\r\n);\r\n\r\nexport const sendUsersConfigUserEdit = (user: any) => initRequest(\r\n    USERS_CONFIG_USER_EDIT,\r\n    getUserConfigPutUrl(user.userId),\r\n    RequestMethod.PUT,\r\n    user,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.sendUserEdit.start\")\r\n    })\r\n);\r\n\r\nexport const showUserConfigForm = (userId: number) => ({\r\n    type: USER_CONFIG_FORM_SHOW,\r\n    payload: {\r\n        userId\r\n    }\r\n});\r\n\r\nexport const hideUserConfigForm = () => ({\r\n    type: USER_CONFIG_FORM_HIDE\r\n});","import _ from \"lodash\";\r\n\r\nexport const validateI18nObj = obj =>\r\n  obj !== undefined && obj !== null &&\r\n  _(obj)\r\n    .pickBy(val => val !== undefined && val !== null && val.length > 0)\r\n    .keys()\r\n    .value().length > 0;\r\n\r\nexport const localizeI18nObj = (obj, prefLang, langs) => {\r\n\r\n  if (obj === null || obj === undefined || obj === {}) {\r\n    return null\r\n  }\r\n  if (typeof (obj) === \"string\") {\r\n    return obj\r\n  }\r\n\r\n  if (obj[prefLang]) {\r\n    return obj[prefLang];\r\n  }\r\n\r\n  for (let code of langs) {\r\n    if (obj[code]) {\r\n      return obj[code];\r\n    }\r\n  }\r\n\r\n  return obj[Object.keys(obj)[0]];\r\n};\r\n\r\nexport const getI18nObjCustomFilterAndSearch = (language, languages) => (str, row, {field}) =>\r\n  localizeI18nObj(row[field], language, languages).toLowerCase().includes(str.toLowerCase());","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUsersConfigUser,\r\n  fetchUsersConfigUser,\r\n  sendUsersConfigUserCreate,\r\n  sendUsersConfigUserEdit,\r\n} from \"../../../../state/usersConfig/usersConfigActions\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\r\nimport {getUserErrorsTranslations} from \"../../../../constants/getUserErrorsTranslations\";\r\nimport SanitizedHTML from \"../../../sanitized-html\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport {localizeI18nObj} from \"../../../../utils/i18n\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  },\r\n  disclaimerLink: {\r\n    marginLeft: theme.spacing(1),\r\n    color: theme.palette.secondary.main,\r\n    textDecoration: \"underline\"\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit, onCancel, isAnonymous, hub, types, languages, language}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      isActive: true,\r\n      type: \"null\",\r\n      disclaimerAccepted: isAnonymous ? false : undefined,\r\n      ...config\r\n    }\r\n  });\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showPasswordConfirm, setShowPasswordConfirm] = useState(false);\r\n  const [isDisclaimerModalOpen, setIsDisclaimerModalOpen] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          type: val.type !== \"null\" ? val.type : null\r\n        };\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  useEffect(() => {\r\n    if (isAnonymous) {\r\n      register({\r\n          name: \"disclaimerAccepted\"\r\n        },\r\n        {\r\n          validate: val => val || t(\"scenes.usersSettings.userSettings.validation.mustAcceptDisclaimer\")\r\n        });\r\n    } else {\r\n      register(\"isActive\");\r\n      register(\"type\");\r\n    }\r\n  }, [isAnonymous, register, t]);\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={6}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            disabled={!!config}\r\n            name=\"email\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.email\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      {!config && (\r\n        <Grid item xs={6}>\r\n          <FormControl fullWidth>\r\n            <TextField\r\n              disabled={!!config}\r\n              name=\"emailConfirm\"\r\n              label={t(\"scenes.usersSettings.userSettings.fields.emailConfirm\")}\r\n              inputRef={\r\n                register({\r\n                  required: t(\"commons.validation.required\"),\r\n                  validate: val =>\r\n                    val === watch('email') ||\r\n                    t(\"scenes.usersSettings.userSettings.validation.emailsMustBeEqual\")\r\n                })\r\n              }\r\n              error={!!errors.emailConfirm}\r\n              helperText={errors.emailConfirm?.message}\r\n              variant=\"outlined\"\r\n              required\r\n            />\r\n          </FormControl>\r\n        </Grid>\r\n      )}\r\n      {!isAnonymous && (\r\n        <Fragment>\r\n          <Grid item xs={12}>\r\n            <FormControl fullWidth>\r\n              <FormControlLabel\r\n                label={t(\"scenes.usersSettings.userSettings.fields.isActive.label\")}\r\n                control={\r\n                  <Checkbox\r\n                    name=\"isActive\"\r\n                    required\r\n                    checked={watch('isActive')}\r\n                    onChange={(e, value) => setValue('isActive', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          {types && types.length > 0 && (\r\n            <Grid item xs={12}>\r\n              <FormControl fullWidth>\r\n                <TextField\r\n                  name=\"type\"\r\n                  select\r\n                  label={t(\"scenes.usersSettings.userSettings.fields.type.label\")}\r\n                  variant=\"outlined\"\r\n                  onChange={e => setValue('type', e.target.value)}\r\n                  value={watch(\"type\") || ''}\r\n                  helperText={errors.type?.message}\r\n                  error={!!errors.type}\r\n                >\r\n                  <MenuItem value=\"null\">\r\n                    <i>{t(\"scenes.usersSettings.userSettings.fields.type.values.empty\")}</i>\r\n                  </MenuItem>\r\n                  {types.map(({id, label}) =>\r\n                    <MenuItem value={id} key={id}>\r\n                      {localizeI18nObj(label, language, languages)}\r\n                    </MenuItem>\r\n                  )}\r\n                </TextField>\r\n              </FormControl>\r\n            </Grid>\r\n          )}\r\n        </Fragment>\r\n      )}\r\n      <Grid item xs={6}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"firstName\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.firstName\")}\r\n            error={!!errors.firstName}\r\n            helperText={errors.firstName?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={6}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"lastName\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.lastName\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.lastName}\r\n            helperText={errors.lastName?.message}\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"organization\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.organization\")}\r\n            error={!!errors.organization}\r\n            helperText={errors.organization?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      {!config && (\r\n        <Fragment>\r\n          <Grid item xs={6}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"password\"\r\n                label={t(\"scenes.usersSettings.userSettings.fields.password\")}\r\n                error={!!errors.password}\r\n                helperText={errors.password?.message}\r\n                variant=\"outlined\"\r\n                required\r\n                type={showPassword ? undefined : \"password\"}\r\n                inputRef={register({required: t(\"commons.validation.required\")})}\r\n                InputProps={{\r\n                  endAdornment: (\r\n                    <InputAdornment position=\"end\">\r\n                      <IconButton\r\n                        onClick={() => setShowPassword(!showPassword)}\r\n                      >\r\n                        {showPassword ? <Visibility/> : <VisibilityOff/>}\r\n                      </IconButton>\r\n                    </InputAdornment>\r\n                  )\r\n                }}\r\n                inputProps={{\r\n                  autoComplete: \"new-password\"\r\n                }}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={6}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"passwordConfirm\"\r\n                label={t(\"scenes.usersSettings.userSettings.fields.passwordConfirm\")}\r\n                error={!!errors.passwordConfirm}\r\n                helperText={errors.passwordConfirm?.message}\r\n                variant=\"outlined\"\r\n                required\r\n                type={showPasswordConfirm ? undefined : \"password\"}\r\n                inputRef={\r\n                  register({\r\n                    required: t(\"commons.validation.required\"),\r\n                    validate: val =>\r\n                      val === watch('password') ||\r\n                      t(\"scenes.usersSettings.userSettings.validation.passwordsMustBeEqual\")\r\n                  })\r\n                }\r\n                InputProps={{\r\n                  endAdornment: (\r\n                    <InputAdornment position=\"end\">\r\n                      <IconButton\r\n                        onClick={() => setShowPasswordConfirm(!showPasswordConfirm)}\r\n                      >\r\n                        {showPasswordConfirm ? <Visibility/> : <VisibilityOff/>}\r\n                      </IconButton>\r\n                    </InputAdornment>\r\n                  )\r\n                }}\r\n                inputProps={{\r\n                  autoComplete: \"new-password\"\r\n                }}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          {isAnonymous && (\r\n            <Grid item xs={12}>\r\n              <FormControl fullWidth error={!!errors.disclaimerAccepted}>\r\n                <FormControlLabel\r\n                  label={\r\n                    <Fragment>\r\n                      {t(\"scenes.usersSettings.userSettings.fields.disclaimerAccepted.label\")}\r\n                      <span\r\n                        onClick={() => setIsDisclaimerModalOpen(true)}\r\n                        className={classes.disclaimerLink}\r\n                      >\r\n                        {t(\"scenes.usersSettings.userSettings.fields.disclaimerAccepted.link\")}\r\n                      </span>\r\n                    </Fragment>\r\n                  }\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"disclaimerAccepted\"\r\n                      required\r\n                      checked={watch('disclaimerAccepted')}\r\n                      onChange={(e, value) => setValue('disclaimerAccepted', value)}\r\n                    />\r\n                  }\r\n                />\r\n                {errors.disclaimerAccepted?.message && (\r\n                  <FormHelperText id=\"my-helper-text\">\r\n                    {errors.disclaimerAccepted?.message}\r\n                  </FormHelperText>\r\n                )}\r\n              </FormControl>\r\n            </Grid>\r\n          )}\r\n          <Dialog\r\n            open={isDisclaimerModalOpen}\r\n            fullWidth\r\n            maxWidth=\"md\"\r\n            onClose={() => setIsDisclaimerModalOpen(false)}\r\n          >\r\n            <DialogTitle>\r\n              {t(\"scenes.usersSettings.userSettings.disclaimerModal.title\")}\r\n            </DialogTitle>\r\n            <DialogContent>\r\n              <SanitizedHTML html={hub.hub.disclaimer} style={{maxHeight: 460}}/>\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={() => setIsDisclaimerModalOpen(false)}>\r\n                {t(\"commons.confirm.cancel\")}\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n        </Fragment>\r\n      )}\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors,\r\n  hub: state.hub,\r\n  appConfig: state.appConfig,\r\n  languages: state.app.languages,\r\n  language: state.app.language\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchUsersConfigUser(nodeId)),\r\n  sendConfigCreate: (config, isAnonymous) => dispatch(sendUsersConfigUserCreate(config, isAnonymous)),\r\n  sendConfig: config => dispatch(sendUsersConfigUserEdit(config)),\r\n  clearConfig: () => dispatch(clearUsersConfigUser())\r\n});\r\n\r\nconst UserSettingsForm = ({config, userId, fetchConfig, sendConfigCreate, sendConfig, clearConfig, userErrors, isAnonymous, hub, appConfig, languages, language}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(userId >= 0);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(userId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, userId]);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (userId === -1 || config) && (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map((str, index) =>\r\n          <Alert\r\n            severity=\"error\"\r\n            style={{\r\n              marginBottom: index + 1 < userErrors.length ? 8 : 16\r\n            }}\r\n          >\r\n            {getUserErrorsTranslations(t)[str]}\r\n          </Alert>\r\n        ))}\r\n      <Form\r\n        config={userId === -1 ? undefined : config}\r\n        ref={ref}\r\n        onSubmit={\r\n          userId === -1\r\n            ? (config) => sendConfigCreate(config, isAnonymous)\r\n            : sendConfig\r\n        }\r\n        onCancel={clearConfig}\r\n        isAnonymous={isAnonymous}\r\n        hub={hub}\r\n        types={appConfig?.user?.typeOptions}\r\n        languages={languages}\r\n        language={language}\r\n      />\r\n    </Fragment>\r\n\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserSettingsForm);\r\n","import React, {Component, forwardRef, Fragment} from 'react';\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\n\r\nclass ButtonSelect extends Component {\r\n\r\n  state = {\r\n    anchorEl: null\r\n  };\r\n\r\n  setAnchorEl = (el) => {\r\n    this.setState({\r\n      anchorEl: el\r\n    });\r\n  };\r\n\r\n  handleMenu = (event) => {\r\n    this.setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setAnchorEl(null);\r\n  };\r\n\r\n  render() {\r\n\r\n    const {children, icon, value, color, tooltip, disabled, selectedIdx, onChange} = this.props;\r\n    const {anchorEl} = this.state;\r\n\r\n    const open = Boolean(anchorEl);\r\n\r\n    const Item = forwardRef(({c, isSelected}, ref) =>\r\n      <MenuItem\r\n        ref={ref}\r\n        onClick={() => {\r\n          if (c.props?.onClick) {\r\n            c.props.onClick();\r\n          }\r\n          if (onChange) {\r\n            onChange(c.props[\"data-value\"]);\r\n          }\r\n          this.handleClose();\r\n        }}\r\n        style={{background: isSelected ? \"#fff9e5\" : \"white\"}}\r\n      >\r\n        {c}\r\n      </MenuItem>);\r\n\r\n    return (\r\n      <Fragment>\r\n        <Tooltip title={tooltip || \"\"}>\r\n          <span>\r\n            {value\r\n              ? (\r\n                <Button\r\n                  color={color || \"inherit\"}\r\n                  onClick={this.handleMenu}\r\n                  startIcon={icon}\r\n                  endIcon={<ArrowDropDownIcon/>}\r\n                  disabled={disabled}\r\n                >\r\n                  {value}\r\n                </Button>\r\n              )\r\n              : <IconButton color={color || \"inherit\"} onClick={this.handleMenu} disabled={disabled}>{icon}</IconButton>\r\n            }\r\n          </span>\r\n        </Tooltip>\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          anchorOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          keepMounted\r\n          transformOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          open={open}\r\n          onClose={this.handleClose}\r\n        >\r\n          {children.length\r\n            ? children.filter(c => c).map((c, i) => c !== null ? <Item c={c} key={i} isSelected={i === selectedIdx}/> : null)\r\n            : <Item c={children}/>\r\n          }\r\n        </Menu>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ButtonSelect;","import React, {forwardRef, Fragment, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\nimport {changeUserPassword} from \"../../../state/user/userActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch} = useForm();\r\n\r\n  const [showOldPassword, setShowOldPassword] = useState(false);\r\n  const [showNewPassword, setShowNewPassword] = useState(false);\r\n  const [showNewPasswordConfirm, setShowNewPasswordConfirm] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        onSubmit(val);\r\n        f(val);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"oldPassword\"\r\n            label={t(\"components.userSelect.changePasswordModal.fields.oldPassword\")}\r\n            error={!!errors.oldPassword}\r\n            helperText={errors.oldPassword?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showOldPassword ? undefined : \"password\"}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowOldPassword(!showOldPassword)}\r\n                  >\r\n                    {showOldPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"newPassword\"\r\n            label={t(\"components.userSelect.changePasswordModal.fields.newPassword\")}\r\n            error={!!errors.newPassword}\r\n            helperText={errors.newPassword?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showNewPassword ? undefined : \"password\"}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowNewPassword(!showNewPassword)}\r\n                  >\r\n                    {showNewPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n            inputProps={{\r\n              autoComplete: \"new-password\"\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"newPasswordConfirm\"\r\n            label={t(\"components.userSelect.changePasswordModal.fields.newPasswordConfirm\")}\r\n            error={!!errors.newPasswordConfirm}\r\n            helperText={errors.newPasswordConfirm?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showNewPasswordConfirm ? undefined : \"password\"}\r\n            inputRef={\r\n              register({\r\n                required: t(\"commons.validation.required\"),\r\n                validate: val =>\r\n                  val === watch('newPassword') ||\r\n                  t(\"components.userSelect.changePasswordModal.validation.newPasswordMustBeEqual\")\r\n              })}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowNewPasswordConfirm(!showNewPasswordConfirm)}\r\n                  >\r\n                    {showNewPasswordConfirm ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n            inputProps={{\r\n              autoComplete: \"new-password\"\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  sendConfig: config => dispatch(changeUserPassword(config.oldPassword, config.newPassword))\r\n});\r\n\r\nconst UserChangePasswordForm = ({config, sendConfig, userErrors}, ref) => {\r\n\r\n  return (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>))}\r\n      <Form\r\n        ref={ref}\r\n        onSubmit={sendConfig}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserChangePasswordForm);\r\n","import React, {Fragment, useRef, useState} from 'react';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUser,\r\n  fetchUser,\r\n  hideUserLoginForm,\r\n  showUserLoginForm\r\n} from \"../../state/user/userActions\";\r\nimport UserLoginDialog from \"../user-login-dialog\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport UserSettingsForm from \"../settings-select/users-settings-form/user-settings-form\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport ButtonSelect from \"../button-select\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport UserChangePasswordForm from \"./user-change-password-form\";\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onLogin: (email, password) => dispatch(fetchUser(email, password)),\r\n  onLogout: () => dispatch(clearUser()),\r\n  onLoginFormShow: () => dispatch(showUserLoginForm()),\r\n  onLoginFormHide: () => dispatch(hideUserLoginForm()),\r\n});\r\n\r\nconst styles = () => ({\r\n  email: {\r\n    cursor: \"initial\",\r\n    color: \"gray\"\r\n  }\r\n});\r\n\r\nconst UserSelect = ({classes, user, onLogin, onLogout, onLoginFormShow, onLoginFormHide}) => {\r\n\r\n  const [isChangePasswordModalOpen, setIsChangePasswordModalOpen] = useState(false);\r\n  const [isRegisterModalOpen, setIsRegisterModalOpen] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const registerFormRef = useRef();\r\n  const changePasswordFormRef = useRef();\r\n\r\n  return (\r\n    <Fragment>\r\n      {user.isAuthenticated\r\n        ? (\r\n          <Tooltip title={user.email}>\r\n            <ButtonSelect value=\"\" icon={<AccountCircleIcon/>}>\r\n              <div className={classes.email}>\r\n                {user.email}\r\n              </div>\r\n              <div onClick={() => setIsChangePasswordModalOpen(true)}>\r\n                {t(\"components.userSelect.changePassword\")}\r\n              </div>\r\n              <div onClick={onLogout}>\r\n                {t(\"components.userSelect.logout\")}\r\n              </div>\r\n            </ButtonSelect>\r\n          </Tooltip>\r\n        )\r\n        : (\r\n          <Button color=\"inherit\" onClick={onLoginFormShow}>\r\n            {t(\"components.userSelect.login\")}\r\n          </Button>\r\n        )}\r\n      <UserLoginDialog open={user.isLoginDialogOpen}\r\n                       onSubmit={({email, password}) => onLogin(email, password)}\r\n                       onRegister={() => setIsRegisterModalOpen(true)}\r\n                       onHide={onLoginFormHide} alert={user.message}/>\r\n      <SettingsDialog\r\n        title={t(\"components.userSelect.registerModal.title\")}\r\n        maxWidth={\"md\"}\r\n        open={isRegisterModalOpen}\r\n        onClose={() => {\r\n          if (registerFormRef.current) {\r\n            registerFormRef.current.cancel(() => {\r\n              setIsRegisterModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsRegisterModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (registerFormRef.current) {\r\n            registerFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <UserSettingsForm ref={registerFormRef} userId={-1} isAnonymous/>\r\n      </SettingsDialog>\r\n      <SettingsDialog\r\n        title={t(\"components.userSelect.changePasswordModal.title\")}\r\n        maxWidth={\"xs\"}\r\n        open={isChangePasswordModalOpen}\r\n        onClose={() => {\r\n          if (changePasswordFormRef.current) {\r\n            changePasswordFormRef.current.cancel(() => {\r\n              setIsChangePasswordModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsChangePasswordModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (changePasswordFormRef.current) {\r\n            changePasswordFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n        noMinHeight\r\n      >\r\n        <UserChangePasswordForm ref={changePasswordFormRef}/>\r\n      </SettingsDialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(UserSelect);","export const goToDatasets = (nodeCode, categoryPath) =>\r\n  window.open(`./#/${window.language}/${nodeCode.toLowerCase()}/${categoryPath.join(\"/\")}`, '_self');\r\n\r\nexport const goToData = (nodeCode, categoryPath, datasetId, viewId, a11y) =>\r\n  window.open(\r\n    `./#/${window.language}/${nodeCode.toLowerCase()}/${categoryPath.length > 0 ? categoryPath.join(\"/\") + \"/\" : \"\"}` +\r\n    `${datasetId}${(viewId || a11y) ? '?' : ''}${viewId ? `view=${viewId}` : \"\"}${a11y ? \"accessible=true\" : \"\"}`,\r\n    '_self'\r\n  );\r\n\r\n// filters = c1/c2,c3/c4\r\nexport const goToDatasetsSearch = (nodeCode, query, filters) => {\r\n  window.open(\r\n    `./#/${window.language}/${nodeCode.toLowerCase()}/search?q=${encodeURIComponent(query)}` +\r\n    (filters && filters.length > 0 ? `&c=${encodeURIComponent(filters.map(f => encodeURIComponent(f.join(\"/\"))).join(\"//\"))}` : ''),\r\n    '_self'\r\n  );\r\n};\r\n\r\nexport const goToNode = nodeCode => window.open(`./#/${window.language}/${nodeCode}`, '_self');\r\nexport const goToHome = noLanguage => window.open(`./#/${noLanguage ? \"\" : window.language}`, '_self');\r\n\r\nexport const goToHubDashboards = () => window.open(`./#/${window.language}/dashboards`, '_self');\r\nexport const goToNodeDashboards = nodeCode => window.open(`./#/${window.language}/${nodeCode.toLowerCase()}/dashboards`, '_self');\r\nexport const goToDashboard = dashboardId => window.open(`./#/${window.language}/dashboards/${dashboardId}`, '_self');","import React, {Component, Fragment} from 'react';\r\nimport TreeView from '@material-ui/lab/TreeView';\r\nimport TreeItem from '@material-ui/lab/TreeItem';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport InfoOutlinedIcon from '@material-ui/icons/InfoOutlined';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {Link, withStyles} from \"@material-ui/core\";\r\nimport {goToDatasets} from \"../../links\";\r\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\r\nimport ListIcon from '@material-ui/icons/List';\r\nimport FolderIcon from '@material-ui/icons/Folder';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\n\r\nconst styles = () => ({\r\n  nodeIcon: {\r\n    marginTop: 5\r\n  },\r\n  selectedItem: {\r\n    background: \"rgba(0, 41, 90, 0.2) !important\"\r\n  }\r\n});\r\n\r\nclass CategoriesTree extends Component {\r\n\r\n  state = {\r\n    expanded: this.props.selectedCategoryPath || []\r\n  };\r\n\r\n  onExpand = expanded => this.setState({expanded});\r\n\r\n  render() {\r\n\r\n    const {classes, node, catalog, selectedCategoryPath = [], onClose, t} = this.props;\r\n    const {expanded} = this.state;\r\n\r\n    const getTreeItems = (tree, prevPath) =>\r\n      tree.map((cat, i) =>\r\n        <TreeItem\r\n          key={i}\r\n          nodeId={cat.id}\r\n          label={\r\n            <Grid spacing={1} container alignItems=\"center\">\r\n              <Grid item>\r\n                {(expanded.includes(cat.id))\r\n                  ? <FolderOpenIcon className={classes.nodeIcon}/>\r\n                  : <FolderIcon className={classes.nodeIcon}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                {cat.label}\r\n              </Grid>\r\n              {cat.hasAnnotation && (\r\n                <Grid item>\r\n                  <IconButton\r\n                    size=\"small\"\r\n                    onClick={this.onDialogOpen}\r\n                  >\r\n                    <InfoOutlinedIcon/>\r\n                  </IconButton>\r\n                </Grid>\r\n              )}\r\n            </Grid>\r\n          }\r\n          /* TODO: inefficente */\r\n          classes={{\r\n            label: selectedCategoryPath.includes(cat.id) ? classes.selectedItem : null\r\n          }}\r\n        >\r\n          {(\r\n            (cat.datasetIdentifiers && cat.datasetIdentifiers.length > 0) ||\r\n            (cat.childrenCategories && cat.childrenCategories.length > 0)\r\n          ) && (\r\n            <Fragment>\r\n              {(cat.datasetIdentifiers && cat.datasetIdentifiers.length > 0) && (\r\n                <TreeItem\r\n                  nodeId={cat.id + \"-results\"}\r\n                  label={\r\n                    <Link onClick={() => {\r\n                      onClose();\r\n                      goToDatasets(node.code.toLowerCase(), [...prevPath, cat.id]);\r\n                    }}>\r\n                      <Grid spacing={1} container alignItems=\"center\">\r\n                        <Grid item>\r\n                          <ListIcon className={classes.nodeIcon}/>\r\n                        </Grid>\r\n                        <Grid item>\r\n                          <i>{t(\"components.categoriesTree.goToData\", {datasetsCount: cat.datasetIdentifiers.length})}</i>\r\n                        </Grid>\r\n                      </Grid>\r\n                    </Link>\r\n                  }\r\n                />\r\n              )}\r\n              {cat.childrenCategories && cat.childrenCategories.length > 0 &&\r\n              getTreeItems(cat.childrenCategories, [...prevPath, cat.id])}\r\n            </Fragment>\r\n          )}\r\n        </TreeItem>\r\n      );\r\n\r\n    const getCategorySchemeTree = ({id, label, categories}) =>\r\n      <TreeView\r\n        defaultCollapseIcon={<ExpandMoreIcon/>}\r\n        defaultExpandIcon={<ChevronRightIcon/>}\r\n        expanded={expanded}\r\n        onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n        key={id}\r\n      >\r\n        {getTreeItems([{id, label, childrenCategories: categories}], [])}\r\n      </TreeView>;\r\n\r\n    return (\r\n      <Fragment>\r\n        {catalog.categoryGroups.length > 0 && (\r\n          catalog.categoryGroups.length > 1\r\n            ? (\r\n              <Fragment>\r\n                {catalog.categoryGroups.map(getCategorySchemeTree)}\r\n              </Fragment>\r\n            )\r\n            : (\r\n              <TreeView\r\n                defaultCollapseIcon={<ExpandMoreIcon/>}\r\n                defaultExpandIcon={<ChevronRightIcon/>}\r\n                expanded={expanded}\r\n                onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n              >\r\n                {getTreeItems(catalog.categoryGroups[0].categories, [])}\r\n              </TreeView>\r\n            )\r\n        )}\r\n        {catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0 && (\r\n          <TreeView\r\n            defaultCollapseIcon={<ExpandMoreIcon/>}\r\n            defaultExpandIcon={<ChevronRightIcon/>}\r\n            expanded={expanded}\r\n            onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n          >\r\n            <TreeItem\r\n              key={\"uncategorized\"}\r\n              nodeId={\"uncategorized\"}\r\n              label={\r\n                <Grid spacing={1} container alignItems=\"center\">\r\n                  <Grid item>\r\n                    {(expanded.includes(\"uncategorized\")\r\n                        ? <FolderOpenIcon className={classes.nodeIcon}/>\r\n                        : <FolderIcon className={classes.nodeIcon}/>\r\n                    )}\r\n                  </Grid>\r\n                  <Grid item>\r\n                    {t(\"commons.catalog.uncategorized\")}\r\n                  </Grid>\r\n                </Grid>\r\n              }\r\n              /* TODO: inefficente */\r\n              classes={{\r\n                content: selectedCategoryPath.includes(\"uncategorized\") ? classes.selectedItem : null\r\n              }}\r\n            >\r\n              <TreeItem\r\n                nodeId={\"uncategorized-results\"}\r\n                label={\r\n                  <Link onClick={() => {\r\n                    onClose();\r\n                    goToDatasets(node.code.toLowerCase(), [\"uncategorized\"]);\r\n                  }}>\r\n                    <Grid spacing={1} container alignItems=\"center\">\r\n                      <Grid item>\r\n                        <ListIcon className={classes.nodeIcon}/>\r\n                      </Grid>\r\n                      <Grid item>\r\n                        <i>{t(\"components.categoriesTree.goToData\", {datasetsCount: catalog.uncategorizedDatasets.length})}</i>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Link>\r\n                }\r\n              />\r\n            </TreeItem>\r\n          </TreeView>\r\n        )}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(CategoriesTree);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getAddHubDashboardUrl,\r\n    getHubConfigGetUrl,\r\n    getHubConfigPutUrl,\r\n    getHubDashboardsUrl,\r\n    getOrderHubDashboardsUrl,\r\n    getRemoveHubDashboardUrl,\r\n    getUserDashboardsUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const HUB_CONFIG_FETCH = \"hubConfig/fetch\";\r\nexport const HUB_CONFIG_SEND = \"hubConfig/send\";\r\nexport const HUB_CONFIG_CLEAR = \"hubConfig/clear\";\r\nexport const HUB_CONFIG_DASHBOARDS_FETCH = \"hubConfig/dashboards/fetch\";\r\nexport const HUB_CONFIG_DASHBOARDS_FETCH_ALL = \"hubConfig/dashboards/fetchAll\";\r\nexport const HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD = \"hubConfig/dashboards/addDashboard\";\r\nexport const HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE = \"hubConfig/dashboards/removeDashboard\";\r\nexport const HUB_CONFIG_DASHBOARDS_ORDERS_SEND = \"hubConfig/dashboards/sendOrders\";\r\nexport const HUB_CONFIG_DASHBOARDS_CLEAR = \"hubConfig/dashboards/clear\";\r\nexport const HUB_CONFIG_DASHBOARDS_CLEAR_ALL = \"hubConfig/dashboards/clearAll\";\r\nexport const HUB_CONFIG_CLOSE = \"hubConfig/close\";\r\n\r\nexport const fetchHubConfig = () => initRequest(\r\n    HUB_CONFIG_FETCH,\r\n    getHubConfigGetUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchConfig.start\")\r\n    })\r\n);\r\n\r\nexport const sendHubConfig = (config: any) => initRequest(\r\n  HUB_CONFIG_SEND,\r\n  getHubConfigPutUrl(),\r\n    RequestMethod.PUT,\r\n    config,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.sendConfig.start\")\r\n    })\r\n);\r\n\r\nexport const clearHubConfig = () => ({\r\n    type: HUB_CONFIG_CLEAR\r\n});\r\n\r\nexport const fetchHubConfigDashboards = () => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_FETCH,\r\n    getHubDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const fetchAllHubConfigDashboards = () => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_FETCH_ALL,\r\n    getUserDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchAllDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const addHubConfigDashboardsDashboard = (dashboardId: number) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n    getAddHubDashboardUrl(dashboardId),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.addDashboard.start\")\r\n    })\r\n);\r\n\r\nexport const removeHubConfigDashboardsDashboard = (dashboardId: number) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n    getRemoveHubDashboardUrl(dashboardId),\r\n    RequestMethod.DELETE,\r\n    null,\r\n    t => ({\r\n        onStart:t(\"scenes.appSettings.messages.removeDashboard.start\")\r\n    })\r\n);\r\n\r\nexport const sendHubConfigDashboardsOrders = (orderedDashboardsIds: number[]) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n    getOrderHubDashboardsUrl(),\r\n    RequestMethod.POST,\r\n    orderedDashboardsIds,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.sendDashboardsOrders.start\")\r\n    })\r\n)\r\n\r\nexport const clearHubConfigDashboards = () => ({\r\n    type: HUB_CONFIG_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const clearAllHubConfigDashboards = () => ({\r\n    type: HUB_CONFIG_DASHBOARDS_CLEAR_ALL\r\n});\r\n\r\nexport const closeHubConfig = () => ({\r\n    type: HUB_CONFIG_CLOSE\r\n});","import React, {Fragment, useState} from 'react';\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport CancelIcon from \"@material-ui/icons/Cancel\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport PublishIcon from '@material-ui/icons/Publish';\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport {connect} from \"react-redux\";\r\nimport {getFileUploadUrl} from \"../../serverApi/urls\";\r\nimport {compose} from \"redux\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  startAdornment: {\r\n    marginRight: theme.spacing(2)\r\n  },\r\n  fileInput: {\r\n    display: \"none\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL,\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  addSpinnerMessage: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  markSpinnerMessage: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\nconst FileInput = ({label, value, onChange, classes, baseURL, error, helperText, required, addSpinnerMessage, markSpinnerMessage, user}) => {\r\n\r\n  const [id] = useState(uuidv4());\r\n  const [fileName, setFileName] = useState(value?.substring(value.lastIndexOf('/') + 1) || '');\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Fragment>\r\n      <input\r\n        accept=\"image/*, video/*\"\r\n        className={classes.fileInput}\r\n        id={id}\r\n        type=\"file\"\r\n        onChange={e => {\r\n          const file = e.target.files[0];\r\n\r\n          let fileFormData = new FormData();\r\n          fileFormData.append('files', file);\r\n\r\n          const uuid = uuidv4();\r\n\r\n          addSpinnerMessage(uuid, t(\"components.fileInput.messages.upload.start\"));\r\n\r\n          fetch(baseURL + getFileUploadUrl(), {\r\n            method: 'POST',\r\n            body: fileFormData,\r\n            headers: {\r\n              \"Authorization\": user.token ? `bearer ${user.token}` : undefined\r\n            },\r\n            credentials: 'include'\r\n          })\r\n            .then(res => res.json())\r\n            .then(res => {\r\n              markSpinnerMessage(uuid);\r\n              const filePath = res[0];\r\n              onChange(filePath);\r\n              setFileName(filePath.substring(filePath.lastIndexOf('/') + 1));\r\n            })\r\n            .catch(() => {\r\n              markSpinnerMessage(uuid, true);\r\n              window.error.show(t(\"components.fileInput.messages.upload.error\"));\r\n            });\r\n        }}\r\n      />\r\n      <TextField\r\n        variant=\"outlined\"\r\n        label={label}\r\n        value={fileName}\r\n        InputProps={{\r\n          startAdornment: (\r\n            <InputAdornment className={classes.startAdornment} position=\"start\">\r\n              <label htmlFor={id}>\r\n                <Button startIcon={<PublishIcon/>} variant=\"outlined\" disabled={!!value}\r\n                        title=\"Upload new file\" component=\"span\">\r\n                  {t(\"components.fileInput.upload\")}\r\n                </Button>\r\n              </label>\r\n            </InputAdornment>\r\n          ),\r\n          endAdornment:\r\n            value && (\r\n              <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  title= {t(\"components.fileInput.reset\")}\r\n                  onClick={() => {\r\n                    setFileName('');\r\n                    onChange('');\r\n                  }}\r\n                >\r\n                  <CancelIcon/>\r\n                </IconButton>\r\n              </InputAdornment>\r\n            ),\r\n        }}\r\n        error={error}\r\n        required={required}\r\n        helperText={helperText}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(FileInput);","import React from 'react';\r\nimport MaterialTable from \"material-table\";\r\nimport _ from 'lodash';\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst CustomMaterialTable = props => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  // these props are meant to be used for customizing material table all spread the app\r\n  const customProps = {\r\n    localization: {\r\n      body: {\r\n        emptyDataSourceMessage: t(\"components.customMaterialTable.empty\"),\r\n      },\r\n      header: {\r\n        actions: \"\"\r\n      },\r\n      toolbar: {\r\n        searchPlaceholder: t(\"components.customMaterialTable.search.placeholder\"),\r\n        searchTooltip: t(\"components.customMaterialTable.search.tooltip\")\r\n      }\r\n    }\r\n  };\r\n\r\n  // props passed to this component are merged with and can override the custom props\r\n  const mergedProps = _.merge(customProps, props);\r\n\r\n  return <MaterialTable {...mergedProps}/>;\r\n};\r\n\r\nexport default CustomMaterialTable;\r\n","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {compose} from \"redux\";\r\nimport {Box, Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport ArrowDropUpIcon from \"@material-ui/icons/ArrowDropUp\";\r\nimport ArrowDropDownIcon from \"@material-ui/icons/ArrowDropDown\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../utils/i18n\";\r\nimport {MTableToolbar} from \"material-table\";\r\nimport \"./style.css\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  languages: state.app.languages,\r\n  defaultLanguage: state.app.language\r\n});\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst DashboardsManager = ({\r\n                             classes,\r\n                             defaultLanguage,\r\n                             languages,\r\n                             dashboards,\r\n                             allDashboards,\r\n                             fetchDashboards,\r\n                             fetchAllDashboards,\r\n                             addDashboard,\r\n                             removeDashboard,\r\n                             sendDashboardsOrders,\r\n                             clearDashboards,\r\n                             clearAllDashboards\r\n                           }, ref) => {\r\n\r\n  const [needFetch, setNeedFetch] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    if (needFetch) {\r\n      setNeedFetch(false);\r\n      fetchDashboards();\r\n    }\r\n  }, [dashboards, needFetch, setNeedFetch, fetchDashboards]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    destroy(f) {\r\n      clearDashboards();\r\n      if (f) {\r\n        f();\r\n      }\r\n    }\r\n  }));\r\n\r\n  const orderedDashboardsIds = (dashboards || []).map(({dashboardId}) => dashboardId);\r\n\r\n  const moveUp = rowIndex =>\r\n    sendDashboardsOrders([\r\n      ...orderedDashboardsIds.slice(0, rowIndex - 1),\r\n      orderedDashboardsIds[rowIndex],\r\n      orderedDashboardsIds[rowIndex - 1],\r\n      ...orderedDashboardsIds.slice(rowIndex + 1)\r\n    ]);\r\n\r\n  const moveDown = rowIndex =>\r\n    sendDashboardsOrders([\r\n      ...orderedDashboardsIds.slice(0, rowIndex),\r\n      orderedDashboardsIds[rowIndex + 1],\r\n      orderedDashboardsIds[rowIndex],\r\n      ...orderedDashboardsIds.slice(rowIndex + 2)\r\n    ]);\r\n\r\n  return dashboards !== null && (\r\n    <Fragment>\r\n      <Dialog\r\n        open={allDashboards !== null}\r\n        disableEscapeKeyDown\r\n        disableBackdropClick\r\n        maxWidth=\"md\"\r\n        fullWidth\r\n        onClose={() => {\r\n          clearAllDashboards();\r\n        }}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardsManager.modals.addDashboard.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{minHeight: 456}}>\r\n          {allDashboards !== null && (\r\n            <CustomMaterialTable\r\n              components={{\r\n                Container: Box\r\n              }}\r\n              columns={[\r\n                {\r\n                  field: \"title\",\r\n                  title: t(\"components.dashboardsManager.modals.addDashboard.table.columns.dashboardTitle\"),\r\n                  render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n                  customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n                }\r\n              ]}\r\n              data={allDashboards}\r\n              actions={[\r\n                ({dashboardId}) => {\r\n                  const assigned = !!dashboards.find(dashboard => dashboard.dashboardId === dashboardId)\r\n                  return ({\r\n                    icon: AddIcon,\r\n                    tooltip:\r\n                      assigned\r\n                        ? t(\"components.dashboardsManager.modals.addDashboard.table.actions.addDashboard.tooltip.assigned\")\r\n                        : t(\"components.dashboardsManager.modals.addDashboard.table.actions.addDashboard.tooltip.notAssigned\"),\r\n                    onClick: (_, {dashboardId}) => addDashboard(dashboardId),\r\n                    disabled: assigned\r\n                  });\r\n                }\r\n              ]}\r\n              options={{\r\n                paging: false,\r\n                draggable: true,\r\n                actionsColumnIndex: 2,\r\n                searchFieldAlignment: \"left\",\r\n                maxBodyHeight: 400,\r\n                showTitle: false\r\n              }}\r\n              icons={tableIcons}\r\n            />\r\n          )}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => clearAllDashboards()}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n      <FormControlLabel\r\n        label={t(\"components.dashboardsManager.fields.showHubDashboards.label\")}\r\n        control={\r\n          <Checkbox\r\n            name=\"showHubDashboards\"\r\n            checked\r\n            disabled\r\n          />\r\n        }\r\n      />\r\n      <Box className=\"dashboards-manager__table\">\r\n        <CustomMaterialTable\r\n          title=\"\"\r\n          components={{\r\n            Container: Box,\r\n            Toolbar: props =>\r\n              <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n                <Grid item>\r\n                  <MTableToolbar {...props} />\r\n                </Grid>\r\n                <Grid item>\r\n                  <Button\r\n                    size=\"small\"\r\n                    startIcon={<AddIcon/>}\r\n                    onClick={() => {\r\n                      fetchAllDashboards();\r\n                    }}>\r\n                    {t(\"components.dashboardsManager.addDashboard\")}\r\n                  </Button>\r\n                </Grid>\r\n              </Grid>\r\n          }}\r\n          columns={[\r\n            {\r\n              field: \"title\",\r\n              title: t(\"components.dashboardsManager.table.columns.dashboardTitle\"),\r\n              render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n              customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n            }\r\n          ]}\r\n          data={dashboards}\r\n          actions={[\r\n            ({tableData}) => ({\r\n              icon: ArrowDropUpIcon,\r\n              tooltip: t(\"components.dashboardsManager.table.actions.dashboardOrderMoveUp\"),\r\n              onClick: (_, {tableData}) => moveUp(tableData.id), // tableData.id is the rowIndex\r\n              disabled: tableData.id === 0\r\n            }),\r\n            ({tableData}) => ({\r\n              icon: ArrowDropDownIcon,\r\n              tooltip: t(\"components.dashboardsManager.table.actions.dashboardOrderMoveDown\"),\r\n              onClick: (_, {tableData}) => moveDown(tableData.id), // tableData.id is the rowIndex\r\n              disabled: tableData.id === dashboards.length - 1\r\n            }),\r\n            {\r\n              icon: DeleteIcon,\r\n              tooltip: t(\"components.dashboardsManager.table.actions.removeDashboard\"),\r\n              onClick: (_, {dashboardId}) => removeDashboard(dashboardId)\r\n            }\r\n          ]}\r\n          options={{\r\n            paging: false,\r\n            draggable: true,\r\n            actionsColumnIndex: 2,\r\n            searchFieldAlignment: \"left\",\r\n            maxBodyHeight: 320\r\n          }}\r\n          icons={tableIcons}\r\n        />\r\n      </Box>\r\n    </Fragment>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, null, null, {forwardRef: true}),\r\n  forwardRef\r\n)(DashboardsManager);","export const INIT = \"INIT\";\r\n\r\nexport const init = (baseURL: string, supportedLanguages: string[], defaultLanguage: string, appConfig: object) => ({\r\n    type: INIT,\r\n    payload: {\r\n        baseURL,\r\n        supportedLanguages,\r\n        defaultLanguage,\r\n        appConfig\r\n    }\r\n});\r\n","import {INIT} from \"../../state/rootActions\";\r\nimport {REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {HUB_CONFIG_SEND} from \"../../state/hubConfig/hubConfigActions\";\r\n\r\nexport const PERSISTENCE_LOCAL_STORAGE_KEY = \"state\";\r\nexport const PERSISTENCE_ACTION_KEY = \"persistentState\";\r\n\r\nconst persistenceMiddleware = ({getState}) => next => action => {\r\n\r\n  // when init action is dispatched\r\n  if (action.type === INIT) {\r\n    if (!action.payload) {\r\n      action.payload = {};\r\n    }\r\n    // attach persistent state to the action\r\n    action.payload[PERSISTENCE_ACTION_KEY] = JSON.parse(localStorage.getItem(PERSISTENCE_LOCAL_STORAGE_KEY) || \"{}\");\r\n  }\r\n\r\n  const result = next(action);\r\n\r\n  const state = getState();\r\n\r\n  // any time an action is dispatched, update persistent state (localStorage is fast)\r\n  localStorage.setItem(\r\n    PERSISTENCE_LOCAL_STORAGE_KEY,\r\n    JSON.stringify({\r\n      user: {\r\n        ...state.user,\r\n        isSetPasswordDialogOpen: undefined\r\n      },\r\n      app: {\r\n        language:\r\n          action.type === REQUEST_SUCCESS &&\r\n          action.payload.label === HUB_CONFIG_SEND &&\r\n          !action.payload.data.supportedLanguages.includes(state.app.language)\r\n            ? action.payload.data.defaultLanguage\r\n            : state.app.language\r\n      }\r\n    })\r\n  );\r\n\r\n  return result;\r\n};\r\n\r\nexport default persistenceMiddleware;","import {UserPermissions, UserRoles, UserState} from '../state/user/userReducer';\r\n\r\ntype UserChecker = (user: UserState, nodeId?: number) => boolean;\r\ntype UserNodeChecker = (user: UserState, nodeId: number) => boolean;\r\n\r\nconst getPermissionStr = (permission: UserPermissions, nodeId: number) => `${permission}_SingleNode_${nodeId}`;\r\n\r\nexport const canDisplayAppSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canCreateNode: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canSortNodes: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayNodesSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageCache}_SingleNode`)) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageTemplate}_SingleNode`)) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageConfig}_SingleNode`))\r\n    );\r\n\r\nexport const canDisplayUsersSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayCacheSettingForm: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageCache, nodeId))\r\n    );\r\n\r\nexport const canDisplayTemplatesSettingsForm: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n    );\r\n\r\nexport const canSaveTemplate: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n    );\r\n\r\nexport const canEditNode: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n    );\r\n\r\nexport const canDisplayUserViews: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canShare: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canSaveAsView: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canClearServerCache: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canGetQueryLog: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayPermissionsSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canManagePersonalDashboards: UserChecker = user =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageConfig}_SingleNode`))\r\n    );\r\n\r\nexport const canManageAppDashboards: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canManageNodeDashboards: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n  );\r\n\r\nexport const canDeleteNodes: UserChecker = user =>\r\n  user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canViewTimesLog: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n  );\r\n\r\nexport const canViewTemplateOrAnnotationIcon: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n  );","import React, {useEffect, useState} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport {connect} from \"react-redux\";\r\nimport CountryLanguage from 'country-language';\r\n\r\nconst CUSTOM_LANG_TO_COUNTRY = {\r\n  en: \"gb\"\r\n};\r\n\r\nconst I18nInputAdornmentSelect = ({value, onChange, languages}) => {\r\n\r\n  const [langToCountry, setLangToCountry] = useState(null);\r\n\r\n  useEffect(() => {\r\n\r\n    let res = {};\r\n\r\n    languages.forEach(langCode =>\r\n      CountryLanguage.getLanguageCountries(langCode, (err, countries) => {\r\n        if (!err) {\r\n          res[langCode] =\r\n            CUSTOM_LANG_TO_COUNTRY[langCode] ||\r\n            countries.find(({code_2}) => code_2.toLowerCase() === langCode)?.code_2.toLowerCase() ||\r\n            countries[0].code_2.toLowerCase();\r\n        }\r\n      }));\r\n\r\n    setLangToCountry(res);\r\n\r\n  }, [languages]);\r\n\r\n  return langToCountry && (\r\n    <ButtonSelect value={<span className={`flag-icon flag-icon-${langToCountry[value]}`}/>}\r\n                  onChange={onChange}>\r\n      {languages.map(lang =>\r\n        <span key={lang} className={`flag-icon flag-icon-${langToCountry[lang]}`} data-value={lang}/>\r\n      )}\r\n    </ButtonSelect>\r\n  );\r\n};\r\n\r\nexport default connect(state => ({\r\n  languages: state.app.languages\r\n}))(I18nInputAdornmentSelect);","import React, {useState} from 'react';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst Component = ({\r\n                     textFieldProps,\r\n                     defaultLanguage,\r\n                     languages,\r\n                     children\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n\r\n  return (\r\n    <TextField\r\n      {...textFieldProps}\r\n      value={\r\n        textFieldProps.value && textFieldProps.value[language]\r\n          ? textFieldProps.value[language]\r\n          : \"\"\r\n      }\r\n      onChange={({target}) => {\r\n        const res = {};\r\n        languages.forEach(lang => {\r\n          if (textFieldProps.value[lang]) {\r\n            res[lang] = textFieldProps.value[lang];\r\n          }\r\n        });\r\n        res[language] = target.value;\r\n        textFieldProps.onChange(res);\r\n      }}\r\n      InputProps={{\r\n        startAdornment: (\r\n          <InputAdornment position=\"start\">\r\n            <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n          </InputAdornment>\r\n        )\r\n      }}\r\n    >\r\n      {textFieldProps.children}\r\n    </TextField>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nTextField = props =>\r\n  <ConnectedComponent textFieldProps={props}/>;\r\n\r\nexport default I18nTextField;","import React, {Fragment} from 'react';\r\nimport CKEditor from 'ckeditor4-react';\r\nimport './style.css'\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  preToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nclass HtmlEditor extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = HtmlEditor.getInitState(props);\r\n    this.handleEditorChange = this.handleEditorChange.bind(this);\r\n  }\r\n\r\n  static getInitState(props) {\r\n    return {\r\n      value: props ? (props.value || '') : ''\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromProps(props) {\r\n    if (props.value !== null && props.value !== undefined) {\r\n      return {\r\n        value: props.value\r\n      };\r\n\r\n    } else {\r\n      return HtmlEditor.getInitState(props);\r\n    }\r\n  }\r\n\r\n  handleEditorChange(event) {\r\n    const data = event.editor.getData();\r\n    if (this.props.onChange) {\r\n      this.props.onChange(data);\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      value\r\n    } = this.state;\r\n\r\n    const {\r\n      disabled,\r\n    } = this.props;\r\n\r\n    return (\r\n      <Fragment>\r\n        {/* <Grid container className={classes.preToolbar}>\r\n          <Grid item>\r\n            <I18nInputAdornmentSelect/>\r\n          </Grid>\r\n        </Grid>*/}\r\n        <CKEditor\r\n          data={value}\r\n          config={{\r\n            defaultLanguage: 'en',\r\n            language: 'en',\r\n            toolbar: [\r\n              {name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike']},\r\n              {name: 'format', items: ['RemoveFormat']},\r\n              {name: 'colors', items: ['TextColor', 'BGColor']},\r\n              {name: 'insert', items: ['Table']},\r\n              {name: 'links', items: ['Link', 'Unlink']},\r\n              {name: 'paragraph', items: ['NumberedList', 'BulletedList']},\r\n              {name: 'indent', items: ['Outdent', 'Indent']},\r\n              {\r\n                name: 'justify',\r\n                items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']\r\n              },\r\n              {name: 'clipboard', items: ['Cut', 'Copy', 'Paste']},\r\n              {name: 'history', items: ['Undo', 'Redo']}\r\n            ]\r\n          }}\r\n          readOnly={disabled ? disabled : false}\r\n          onChange={this.handleEditorChange}\r\n          onBeforeLoad={(CKEDITOR) => (CKEDITOR.disableAutoInline = true)} // needed to fix \"Error code: editor-element-conflict.\"\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(HtmlEditor);\r\n","import React, {Fragment, useState} from 'react';\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport HtmlEditor from \"../html-editor\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nconst Component = ({\r\n                     htmlEditorProps,\r\n                     defaultLanguage,\r\n                     languages\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid container justify=\"flex-end\" style={{marginBottom: 4}}>\r\n        <Grid item>\r\n          <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n        </Grid>\r\n      </Grid>\r\n      <HtmlEditor\r\n        {...htmlEditorProps}\r\n        value={\r\n          htmlEditorProps.value && htmlEditorProps.value[language]\r\n            ? htmlEditorProps.value[language]\r\n            : \"\"\r\n        }\r\n        onChange={val => {\r\n          const res = {};\r\n          languages.forEach(lang => {\r\n            if (htmlEditorProps.value && htmlEditorProps.value[lang]) {\r\n              res[lang] = htmlEditorProps.value[lang];\r\n            }\r\n          });\r\n          res[language] = val;\r\n          htmlEditorProps.onChange(res);\r\n        }}\r\n\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nHtmlEditor = props =>\r\n  <ConnectedComponent htmlEditorProps={props}/>;\r\n\r\nexport default I18nHtmlEditor;","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {\r\n  addHubConfigDashboardsDashboard,\r\n  clearAllHubConfigDashboards,\r\n  clearHubConfig,\r\n  clearHubConfigDashboards,\r\n  closeHubConfig,\r\n  fetchAllHubConfigDashboards,\r\n  fetchHubConfig,\r\n  fetchHubConfigDashboards,\r\n  removeHubConfigDashboardsDashboard,\r\n  sendHubConfig,\r\n  sendHubConfigDashboardsOrders\r\n} from \"../../../state/hubConfig/hubConfigActions\";\r\nimport {connect} from \"react-redux\";\r\nimport FileInput from \"../../file-input\";\r\nimport DashboardsManager from \"../../dashboards-manager\";\r\nimport {canManageAppDashboards} from \"../../../utils/user\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nTextField from \"../../i18n-text-field\";\r\nimport {validateI18nObj} from \"../../../utils/i18n\";\r\nimport I18nHtmlEditor from \"../../i18n-html-editor\";\r\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  disclaimerLabel: {\r\n    fontSize: \"1rem\",\r\n    marginTop: theme.spacing(3)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.hubConfig.hub,\r\n  user: state.user,\r\n  dashboards: state.hubConfig.hubDashboards,\r\n  allDashboards: state.hubConfig.allDashboards\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  clearConfig: () => dispatch(clearHubConfig()),\r\n  fetchConfig: () => dispatch(fetchHubConfig()),\r\n  sendConfig: config => dispatch(sendHubConfig(config)),\r\n  fetchDashboards: () => dispatch(fetchHubConfigDashboards()),\r\n  fetchAllDashboards: () => dispatch(fetchAllHubConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearHubConfigDashboards()),\r\n  clearAllDashboards: () => dispatch(clearAllHubConfigDashboards()),\r\n  addDashboard: dashboardId => dispatch(addHubConfigDashboardsDashboard(dashboardId)),\r\n  removeDashboard: dashboardId => dispatch(removeHubConfigDashboardsDashboard(dashboardId)),\r\n  sendDashboardsOrders: orderedDashboarIds => dispatch(sendHubConfigDashboardsOrders(orderedDashboarIds)),\r\n  onClose: () => dispatch(closeHubConfig())\r\n});\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({\r\n                                                        classes,\r\n                                                        config,\r\n                                                        onSubmit,\r\n                                                        onCancel,\r\n                                                        user,\r\n                                                        dashboards,\r\n                                                        allDashboards,\r\n                                                        fetchDashboards,\r\n                                                        fetchAllDashboards,\r\n                                                        clearDashboards,\r\n                                                        clearAllDashboards,\r\n                                                        addDashboard,\r\n                                                        removeDashboard,\r\n                                                        sendDashboardsOrders\r\n                                                      }, ref) => {\r\n\r\n  const [tab, setTab] = useState(\"general\");\r\n  const dashboardsManagerRef = React.createRef();\r\n  const {t} = useTranslation();\r\n\r\n  const configExtras = config.extras ? JSON.parse(config.extras) : {};\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      ...config,\r\n      pageSize: configExtras.PageSize\r\n    }\r\n  });\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          pageSize: undefined\r\n        };\r\n\r\n        data.extras = JSON.stringify({\r\n          ...JSON.parse(data.extras || \"{}\"),\r\n          PageSize: val.pageSize\r\n        });\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n        if (dashboardsManagerRef.current) {\r\n          dashboardsManagerRef.current.destroy();\r\n        }\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n      if (dashboardsManagerRef.current) {\r\n        dashboardsManagerRef.current.destroy();\r\n      }\r\n    }\r\n  }));\r\n\r\n  /* custom register */\r\n  useEffect(() => {\r\n    register({\r\n      name: 'title'\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({name: 'slogan'});\r\n    register({\r\n      name: 'supportedLanguages'\r\n    }, {\r\n      validate: val => val.length > 0 || t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: 'defaultLanguage'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: 'maxObservationsAfterCriteria'\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      min: {\r\n        value: 1,\r\n        message: t(\"commons.validation.positiveInteger\")\r\n      }\r\n    })\r\n    register({\r\n      name: \"maxCells\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      min: {\r\n        value: 1,\r\n        message: t(\"commons.validation.positiveInteger\")\r\n      }\r\n    })\r\n    register({name: 'backgroundMediaURL'});\r\n    register({name: 'logoURL'});\r\n    register({name: 'description'});\r\n    register({\r\n      name: 'pageSize'\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: \"disclaimer\"\r\n    });\r\n  }, [register, t]);\r\n\r\n  const defaultLanguage = watch('defaultLanguage');\r\n  const supportedLanguages = watch('supportedLanguages');\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <Tabs\r\n        value={tab}\r\n        onChange={(_, tab) => {\r\n          setTab(tab)\r\n        }}\r\n      >\r\n        <Tab value=\"general\" label={t(\"scenes.appSettings.tabs.general\")}/>\r\n        <Tab value=\"infos\" label={t(\"scenes.appSettings.tabs.information\")}/>\r\n        <Tab value=\"users\" label={t(\"scenes.appSettings.tabs.users\")}/>\r\n        {canManageAppDashboards(user) && (<Tab value=\"dashboards\" label={t(\"scenes.appSettings.tabs.dashboards\")}/>)}\r\n      </Tabs>\r\n      <div className={classes.tabContent}>\r\n        {tab === \"general\" && (\r\n          <Fragment>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"title\"\r\n                label={t(\"scenes.appSettings.fields.title.label\")}\r\n                required\r\n                error={!!errors.title}\r\n                helperText={errors.title?.message}\r\n                variant=\"outlined\"\r\n                value={watch('title') || {}}\r\n                onChange={value => setValue('title', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"slogan\"\r\n                label={t(\"scenes.appSettings.fields.slogan.label\")}\r\n                variant=\"outlined\"\r\n                value={watch('slogan') || {}}\r\n                onChange={value => setValue('slogan', value)}\r\n              />\r\n            </FormControl>\r\n            <Autocomplete\r\n              multiple\r\n              variant=\"outlined\"\r\n              freeSolo\r\n              options={[]}\r\n              value={supportedLanguages || []}\r\n              renderTags={(value, getTagProps) =>\r\n                value.map((option, index) => (\r\n                  <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n                ))\r\n              }\r\n              required\r\n              onChange={(e, val) => {\r\n                setValue('supportedLanguages', val);\r\n                if (defaultLanguage && !val.includes(defaultLanguage)) {\r\n                  setValue('defaultLanguage', \"\");\r\n                }\r\n              }}\r\n              renderInput={params => (\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    label={t(\"scenes.appSettings.fields.supportedLanguages.label\")}\r\n                    {...params}\r\n                    variant=\"outlined\"\r\n                    placeholder={t(\"scenes.appSettings.fields.supportedLanguages.placeholder\")}\r\n                    error={!!errors.supportedLanguages}\r\n                    helperText={\r\n                      errors.supportedLanguages?.message || (\r\n                        <Fragment>\r\n                          {t(\"scenes.appSettings.fields.supportedLanguages.helper.text\")}\r\n                          <a\r\n                            href=\"https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes\"\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            style={{marginLeft: 4}}\r\n                          >\r\n                            {t(\"scenes.appSettings.fields.supportedLanguages.helper.linkText\")}\r\n                          </a>\r\n                        </Fragment>\r\n                      )}\r\n                  />\r\n                </FormControl>\r\n              )}\r\n            />\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"defaultLanguage\"\r\n                select\r\n                required\r\n                label={t(\"scenes.nodeSettings.fields.defaultLanguage.label\")}\r\n                onChange={e => setValue('defaultLanguage', e.target.value)}\r\n                value={watch(\"defaultLanguage\") || ''}\r\n                error={!!errors.defaultLanguage}\r\n                helperText={errors.defaultLanguage?.message || t(\"scenes.nodeSettings.fields.defaultLanguage.helper\")}\r\n                variant=\"outlined\"\r\n              >\r\n                {supportedLanguages.map((val, index) =>\r\n                  <MenuItem key={index} value={val}>{val}</MenuItem>\r\n                )}\r\n              </TextField>\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"maxObservationsAfterCriteria\"\r\n                label={t(\"scenes.appSettings.fields.maxObservationsAfterCriteria.label\")}\r\n                required\r\n                type=\"number\"\r\n                error={!!errors.maxObservationsAfterCriteria}\r\n                helperText={errors.maxObservationsAfterCriteria?.message}\r\n                variant=\"outlined\"\r\n                value={watch('maxObservationsAfterCriteria') || ''}\r\n                onChange={({target}) => setValue('maxObservationsAfterCriteria', target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"maxCells\"\r\n                label={t(\"scenes.appSettings.fields.maxCells.label\")}\r\n                required\r\n                error={!!errors.maxCells}\r\n                helperText={errors.maxCells?.message}\r\n                variant=\"outlined\"\r\n                type=\"number\"\r\n                value={watch('maxCells') || ''}\r\n                onChange={({target}) => setValue('maxCells', target.value)}\r\n              />\r\n            </FormControl>\r\n            {/*<FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"pageSize\"\r\n                label={t(\"scenes.appSettings.fields.pageSize.label\")}\r\n                variant=\"outlined\"\r\n                type=\"number\"\r\n                error={!!errors.pageSize}\r\n                helperText={errors.pageSize?.message}\r\n                value={watch('pageSize') || ''}\r\n                onChange={({target}) => setValue('pageSize', Number(target.value))}\r\n              />\r\n            </FormControl>*/}\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.appSettings.fields.backgroundMediaURL.label\")}\r\n                value={watch('backgroundMediaURL')}\r\n                onChange={value => setValue('backgroundMediaURL', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.appSettings.fields.logoURL.label\")}\r\n                value={watch('logoURL')}\r\n                onChange={value => setValue('logoURL', value)}\r\n              />\r\n            </FormControl>\r\n          </Fragment>\r\n        )}\r\n        {tab === \"infos\" && (\r\n          <I18nHtmlEditor\r\n            value={watch('description')}\r\n            onChange={val => setValue('description', val)}\r\n          />\r\n        )}\r\n        {tab === \"users\" && (\r\n          <Fragment>\r\n            {/* <Autocomplete\r\n              multiple\r\n              variant=\"outlined\"\r\n              freeSolo\r\n              options={[]}\r\n              value={watch('userTypes') || []}\r\n              renderTags={(value, getTagProps) =>\r\n                value.map((option, index) => (\r\n                  <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n                ))\r\n              }\r\n              required\r\n              onChange={(e, val) => setValue('userTypes', val)}\r\n              renderInput={params => (\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    label={t(\"scenes.appSettings.fields.userTypes.label\")}\r\n                    {...params}\r\n                    variant=\"outlined\"\r\n                    placeholder={t(\"scenes.appSettings.fields.userTypes.placeholder\")}\r\n                    error={!!errors.userTypes}\r\n                    helperText={errors.userTypes?.message}\r\n                  />\r\n                </FormControl>\r\n              )}\r\n            />*/}\r\n            <div className={classes.disclaimerLabel}>\r\n              {t(\"scenes.appSettings.fields.disclaimer.label\")}:\r\n            </div>\r\n            <I18nHtmlEditor\r\n              value={watch('disclaimer')}\r\n              onChange={val => setValue('disclaimer', val)}\r\n            />\r\n          </Fragment>\r\n        )}\r\n        {canManageAppDashboards(user) && tab === \"dashboards\" && (\r\n          <DashboardsManager\r\n            dashboards={dashboards}\r\n            allDashboards={allDashboards}\r\n            fetchDashboards={fetchDashboards}\r\n            fetchAllDashboards={fetchAllDashboards}\r\n            clearDashboards={clearDashboards}\r\n            clearAllDashboards={clearAllDashboards}\r\n            addDashboard={addDashboard}\r\n            removeDashboard={removeDashboard}\r\n            sendDashboardsOrders={sendDashboardsOrders}\r\n            ref={dashboardsManagerRef}\r\n          />\r\n        )}\r\n      </div>\r\n    </Box>\r\n  );\r\n});\r\n\r\nconst AppSettingsForm = ({\r\n                           config,\r\n                           fetchConfig,\r\n                           sendConfig,\r\n                           clearConfig,\r\n                           user,\r\n                           dashboards,\r\n                           allDashboards,\r\n                           fetchDashboards,\r\n                           fetchAllDashboards,\r\n                           clearDashboards,\r\n                           clearAllDashboards,\r\n                           addDashboard,\r\n                           removeDashboard,\r\n                           sendDashboardsOrders,\r\n                           onClose\r\n                         }, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  return (config &&\r\n    <Form\r\n      config={config}\r\n      ref={ref}\r\n      onSubmit={sendConfig}\r\n      onCancel={() => {\r\n        clearConfig();\r\n        onClose();\r\n      }}\r\n      user={user}\r\n      dashboards={dashboards}\r\n      allDashboards={allDashboards}\r\n      fetchDashboards={fetchDashboards}\r\n      fetchAllDashboards={fetchAllDashboards}\r\n      clearDashboards={clearDashboards}\r\n      clearAllDashboards={clearAllDashboards}\r\n      addDashboard={addDashboard}\r\n      removeDashboard={removeDashboard}\r\n      sendDashboardsOrders={sendDashboardsOrders}\r\n    />);\r\n\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(AppSettingsForm);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getAddNodeDashboardUrl,\r\n    getNodeConfigGetUrl,\r\n    getNodeDashboardsUrl,\r\n    getNodeDeleteUrl,\r\n    getNodesConfigPostUrl,\r\n    getNodesConfigPutUrl,\r\n    getNodesConfigUrl,\r\n    getNodesOrderPutUrl,\r\n    getOrderNodeDashboardsUrl,\r\n    getRemoveNodeDashboardUrl,\r\n    getUserDashboardsUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const NODES_CONFIG_NODES_FETCH = \"nodesConfig/fetchNodes\";\r\nexport const NODES_CONFIG_NODES_CLEAR = \"nodesConfig/clearNodes\";\r\nexport const NODES_CONFIG_NODE_FETCH = \"nodesConfig/fetchNode\";\r\nexport const NODES_CONFIG_NODE_CLEAR = \"nodesConfig/clearNode\";\r\nexport const NODES_CONFIG_NODES_ORDER_SEND = \"nodesConfig/sendNodesOrder\";\r\nexport const NODES_CONFIG_NODE_DELETE = \"nodesConfig/deleteNode\";\r\nexport const NODES_CONFIG_NODE_CREATE = \"nodesConfig/createNode\";\r\nexport const NODES_CONFIG_NODE_EDIT = \"nodesConfig/editNode\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_FETCH = \"nodesConfig/nodeDashboards/fetch\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL = \"nodesConfig/nodeDashboards/fetchAll\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD = \"nodesConfig/nodeDashboards/addDashboard\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE = \"nodesConfig/nodeDashboards/removeDashboard\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND = \"nodesConfig/nodeDashboards/sendOrders\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_CLEAR = \"nodesConfig/nodeDashboards/clear\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL = \"nodesConfig/nodeDashboards/clearAll\";\r\nexport const NODES_CONFIG_CLOSE = \"nodesConfig/close\";\r\n\r\nexport const fetchNodesConfigNodes = () => initRequest(\r\n    NODES_CONFIG_NODES_FETCH,\r\n    getNodesConfigUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchNodes.start\")\r\n    })\r\n);\r\n\r\nexport const clearNodesConfigNodes = () => ({\r\n  type: NODES_CONFIG_NODES_CLEAR\r\n});\r\n\r\nexport const sendNodesConfigNodesOrder = (orderedIds: number[]) => initRequest(\r\n  NODES_CONFIG_NODES_ORDER_SEND,\r\n  getNodesOrderPutUrl(),\r\n  RequestMethod.PUT,\r\n  orderedIds,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.sendNodesOrder.start\")\r\n  })\r\n);\r\n\r\nexport const deleteNodesConfigNode = (nodeId: number) => initRequest(\r\n  NODES_CONFIG_NODE_DELETE,\r\n  getNodeDeleteUrl(nodeId),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.deleteNode.start\")\r\n  }),\r\n  {\r\n      nodeId,\r\n      onForce: () => initRequest(\r\n          NODES_CONFIG_NODE_DELETE,\r\n          getNodeDeleteUrl(nodeId, true),\r\n          RequestMethod.DELETE,\r\n          undefined,\r\n          t => ({\r\n              onStart: t(\"scenes.nodesSettings.messages.deleteNode.start\")\r\n          }),\r\n          {\r\n              nodeId\r\n          }\r\n      )\r\n  }\r\n);\r\n\r\nexport const fetchNodesConfigNode = (nodeId: number) => initRequest(\r\n  NODES_CONFIG_NODE_FETCH,\r\n  getNodeConfigGetUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.fetchNode.start\")\r\n  })\r\n);\r\n\r\nexport const clearNodesConfigNode = () => ({\r\n  type: NODES_CONFIG_NODE_CLEAR\r\n});\r\n\r\nexport const sendNodesConfigNodeCreate = (node: any) => initRequest(\r\n  NODES_CONFIG_NODE_CREATE,\r\n  getNodesConfigPostUrl(),\r\n  RequestMethod.POST,\r\n  node,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.sendNodeCreate.start\")\r\n  })\r\n);\r\n\r\nexport const sendNodesConfigNodeEdit = (node: any) => initRequest(\r\n    NODES_CONFIG_NODE_EDIT,\r\n    getNodesConfigPutUrl(node.nodeId),\r\n    RequestMethod.PUT,\r\n    node,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.sendNodeEdit.start\")\r\n    }),\r\n    {\r\n        nodeId: node.nodeId\r\n    }\r\n);\r\n\r\nexport const fetchNodesConfigNodeDashboards = (nodeId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_FETCH,\r\n    getNodeDashboardsUrl(nodeId),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchNodeDashboards.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const fetchAllNodeConfigDashboards = () => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL,\r\n    getUserDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchAllDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const addNodesConfigDashboardsNodeDashboard = (nodeId: number, dashboardId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n    getAddNodeDashboardUrl(nodeId, dashboardId),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.addNodeDashboard.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const removeNodesConfigDashboardsNodeDashboard = (nodeId: number, dashboardId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n    getRemoveNodeDashboardUrl(nodeId, dashboardId),\r\n    RequestMethod.DELETE,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.removeNodeDashboard.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const sendNodesConfigDashboardsNodeOrders = (nodeId: number, orderedDashboardsIds: number[]) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n    getOrderNodeDashboardsUrl(nodeId),\r\n    RequestMethod.POST,\r\n    orderedDashboardsIds,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.sendNodeDashboardsOrders.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n)\r\n\r\nexport const clearNodesConfigNodeDashboards = () => ({\r\n    type: NODES_CONFIG_NODE_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const clearAllNodesConfigNodeDashboards = () => ({\r\n    type: NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL\r\n});\r\n\r\nexport const closeNodesConfig = () => ({\r\n    type: NODES_CONFIG_CLOSE\r\n});","import _ from \"lodash\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"../components/label-format-selector/constants\";\r\n\r\nexport const TIME_PERIOD_DIMENSION_KEY = \"TIME_PERIOD\";\r\nexport const FREQ_DIMENSION_KEY = \"FREQ\";\r\n\r\nconst MAX_COL_COUNT = 10000;\r\nconst MAX_ROW_COUNT = 10000;\r\n\r\nconst toUpperCaseFirst = string => (string !== null && string.length > 0)\r\n  ? string[0].toUpperCase() + string.slice(1)\r\n  : string;\r\n\r\nexport const getDimensionLabelFromJsonStat = (jsonStat, dimension, format) => {\r\n  const name = toUpperCaseFirst(jsonStat.dimension[dimension].label);\r\n  const id = dimension;\r\n\r\n  return (name || id);\r\n};\r\n\r\nexport const getDimensionValueLabelFromJsonStat = (jsonStat, dimension, value, format) => {\r\n  const name = toUpperCaseFirst(jsonStat.dimension[dimension].category.label[value]);\r\n  const id = value;\r\n\r\n  if (dimension === TIME_PERIOD_DIMENSION_KEY) {\r\n    return name;\r\n  }\r\n\r\n  switch (format) {\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME:\r\n      return name;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID:\r\n      return id;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH:\r\n      return `[${id}] ${name}`;\r\n    default:\r\n      return name;\r\n  }\r\n};\r\n\r\nexport const getDataIdxFromDimensionsArray = (dimensions, size) => {\r\n  let dataIdx = 0;\r\n  let multiplier = 1;\r\n\r\n  for (let i = 0; i < dimensions.length; i++) {\r\n    multiplier *= (i > 0) ? size[dimensions.length - i] : 1;\r\n    dataIdx += multiplier * dimensions[dimensions.length - i - 1];\r\n  }\r\n\r\n  return dataIdx;\r\n};\r\n\r\nexport const getJsonStatTableSize = (jsonStat, layout) => {\r\n  if (jsonStat) {\r\n    let count = 1;\r\n\r\n    if (!layout) {\r\n      jsonStat.size.forEach(el => count *= el);\r\n\r\n    } else {\r\n      let colCount = 1;\r\n      layout.cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n      let rowCount = 1;\r\n      layout.rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n      layout.sections.forEach(section => rowCount *= jsonStat.size[jsonStat.id.indexOf(section)]);\r\n      count = colCount * rowCount;\r\n    }\r\n\r\n    return count;\r\n\r\n  } else {\r\n    return 0\r\n  }\r\n};\r\n\r\nexport const getCombinationArrays = arrays => {\r\n  if (!arrays || arrays.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  const ret = [];\r\n  const max = arrays.length - 1;\r\n\r\n  function helper(arr, i) {\r\n    for (let j = 0, l = arrays[i].length; j < l; j++) {\r\n      const a = arr.slice(0); // clone arr\r\n      a.push(arrays[i][j]);\r\n      if (i === max) {\r\n        ret.push(a);\r\n      } else {\r\n        helper(a, i + 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  helper([], 0);\r\n  return ret;\r\n};\r\n\r\nconst getCombinationArray = (jsonStat, dimsArrays, test) => {\r\n  if (!dimsArrays || dimsArrays.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  const max = dimsArrays.length - 1;\r\n  let ret = null\r\n\r\n  function helper(arr, i) {\r\n    if (!ret) {\r\n      for (let j = 0, l = dimsArrays[i].length; j < l; j++) {\r\n        if (!ret) {\r\n          const a = arr.slice(0); // clone arr\r\n          a.push(dimsArrays[i][j]);\r\n          if (i === max) {\r\n            if (!test || test(a)) {\r\n              ret = ret || a;\r\n            }\r\n          } else {\r\n            helper(a, i + 1);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  helper([], 0);\r\n  return ret;\r\n};\r\n\r\nexport const getInitialFiltersValue = (jsonStat, layout, fixedFiltersValue) => {\r\n  if (!jsonStat.id || jsonStat.id.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const {\r\n    filters = [],\r\n    primaryDim: primaryDimArr = [],\r\n    primaryDimValues = [],\r\n    secondaryDim: secondaryDimArr = [],\r\n    secondaryDimValues = []\r\n  } = layout || {};\r\n  const primaryDim = primaryDimArr?.[0] || null;\r\n  const secondaryDim = secondaryDimArr?.[0] || null;\r\n\r\n  let dims = [];\r\n  if (primaryDim) {\r\n    dims.push(primaryDim);\r\n  }\r\n  if (secondaryDim) {\r\n    dims.push(secondaryDim);\r\n  }\r\n  if (filters.includes(TIME_PERIOD_DIMENSION_KEY)) {\r\n    dims.push(TIME_PERIOD_DIMENSION_KEY)\r\n  }\r\n  dims = dims.concat(filters).concat(jsonStat.id);\r\n  dims = _.uniq(dims);\r\n  dims = dims.filter(dim => jsonStat.id.includes(dim));\r\n\r\n  const indexesMap = (fixedFiltersValue || primaryDim || secondaryDim)\r\n    ? getDimensionValuesIndexesMap(jsonStat)\r\n    : null;\r\n\r\n  const primaryDimValuesIndexes = primaryDimValues.map(value => indexesMap[primaryDim][value]);\r\n  const secondaryDimValuesIndexes = secondaryDimValues.map(value => indexesMap[secondaryDim][value]);\r\n\r\n  const dimsIndexesArrays = dims.map(dim => (primaryDim && dim === primaryDim)\r\n    ? primaryDimValuesIndexes\r\n    : (secondaryDim && dim === secondaryDim)\r\n      ? secondaryDimValuesIndexes\r\n      : (!fixedFiltersValue || !Object.keys(fixedFiltersValue).includes(dim))\r\n        ? jsonStat.dimension[dim].category.index.map((_, idx) => idx)\r\n        : [indexesMap[dim][fixedFiltersValue[dim]]]\r\n  );\r\n  dimsIndexesArrays[dims.indexOf(TIME_PERIOD_DIMENSION_KEY)].reverse();\r\n\r\n  const isValorized = (orderedDims, unorderedDims, unorderedDimCombination) => {\r\n    const orderedDimCombination = orderedDims.map(dim => unorderedDimCombination[unorderedDims.indexOf(dim)]);\r\n    const dataIdx = getDataIdxFromDimensionsArray(orderedDimCombination, jsonStat.size);\r\n    const value = jsonStat.value[dataIdx];\r\n    return (value !== null && value !== undefined);\r\n  }\r\n  const unorderedDimCombination = getCombinationArray(jsonStat, dimsIndexesArrays, combination => isValorized(jsonStat.id, dims, combination));\r\n  const orderedDimCombination = jsonStat.id.map(dim => unorderedDimCombination[dims.indexOf(dim)]);\r\n\r\n  const filtersValue = {};\r\n  jsonStat.id.forEach((dim, idx) => {\r\n    if (filters.includes(dim)) {\r\n      filtersValue[dim] = jsonStat.dimension[dim].category.index[orderedDimCombination[idx]];\r\n    }\r\n  });\r\n\r\n  return filtersValue;\r\n};\r\n\r\nexport const getInitialTableLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null;\r\n  }\r\n\r\n  let dimensions = [...jsonStat.id];\r\n\r\n  let rows = dimensions.filter(dim => dim === TIME_PERIOD_DIMENSION_KEY);\r\n  dimensions = dimensions.filter(dim => !rows.includes(dim));\r\n\r\n  let territoryDim = (jsonStat.role?.geo || []).length > 0 ? jsonStat.role.geo[0] : null;\r\n\r\n  let cols = territoryDim ? [territoryDim] : [];\r\n  dimensions = dimensions.filter(dim => !cols.includes(dim));\r\n\r\n  let filters = dimensions.filter(dim => jsonStat.size[jsonStat.id.indexOf(dim)] === 1);\r\n  dimensions = dimensions.filter(dim => !filters.includes(dim));\r\n\r\n  if (dimensions.includes(FREQ_DIMENSION_KEY)) {\r\n    rows = [FREQ_DIMENSION_KEY, ...rows];\r\n    dimensions = dimensions.filter(dim => !rows.includes(dim));\r\n  }\r\n\r\n  if (rows.length === 1 && jsonStat.size[jsonStat.id.indexOf(rows[0])] === 1 && cols.length === 1) {\r\n    filters = filters.concat(rows);\r\n    rows = [...cols];\r\n    cols = [];\r\n  }\r\n\r\n  let colCount = 1;\r\n  cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  let rowCount = 1;\r\n  rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n\r\n  dimensions.forEach(dim => {\r\n    const newColCount = colCount * jsonStat.size[jsonStat.id.indexOf(dim)];\r\n\r\n    if (newColCount > MAX_COL_COUNT) {\r\n      const newRowCount = rowCount * jsonStat.size[jsonStat.id.indexOf(dim)];\r\n\r\n      if (newRowCount > MAX_ROW_COUNT) {\r\n        filters.push(dim);\r\n\r\n      } else {\r\n        rows = [dim].concat(rows);\r\n        rowCount = newRowCount;\r\n      }\r\n\r\n    } else {\r\n      cols.push(dim);\r\n      colCount = newColCount;\r\n    }\r\n  });\r\n\r\n  const layout = {\r\n    rows: rows,\r\n    cols: cols,\r\n    sections: [],\r\n    filters: filters\r\n  }\r\n\r\n  return {\r\n    ...layout,\r\n    filtersValue: getInitialFiltersValue(jsonStat, layout)\r\n  }\r\n};\r\n\r\nexport const getInitialChartLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null\r\n  }\r\n\r\n  let primaryDim = jsonStat.id.find(dim => dim === TIME_PERIOD_DIMENSION_KEY);\r\n  if (!primaryDim) {\r\n    primaryDim = jsonStat.id[0];\r\n  }\r\n  const filters = jsonStat.id.filter(dim => dim !== primaryDim);\r\n\r\n  let layout = {\r\n    primaryDim: [primaryDim],\r\n    secondaryDim: [],\r\n    secondaryDimValues: [],\r\n    filters: filters\r\n  }\r\n\r\n  layout = {\r\n    ...layout,\r\n    primaryDimValues: getChartDimensionValues(jsonStat, layout, true, 10)\r\n  }\r\n\r\n  return {\r\n    ...layout,\r\n    filtersValue: getInitialFiltersValue(jsonStat, layout),\r\n  }\r\n};\r\n\r\nexport const getInitialMapLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null\r\n  }\r\n\r\n  let territoryDim = (jsonStat.role?.geo || []).length > 0 ? jsonStat.role.geo[0] : null;\r\n\r\n  if (!territoryDim) {\r\n    return null\r\n  }\r\n\r\n  const layout = {\r\n    territoryDim: territoryDim,\r\n    filters: jsonStat.id.filter(dim => dim !== territoryDim)\r\n  }\r\n\r\n  return {\r\n    ...layout,\r\n    filtersValue: getInitialFiltersValue(jsonStat, layout)\r\n  }\r\n};\r\n\r\nexport const getFilteredLayoutObject = (jsonStat, initialLayout) => {\r\n  if (!initialLayout) {\r\n    return null\r\n  }\r\n\r\n  const layout = _.cloneDeep(initialLayout);\r\n  const dimArraysKey = [\"rows\", \"cols\", \"filters\", \"sections\", \"primaryDim\", \"secondaryDim\", \"territoryDim\"];\r\n\r\n  if (layout.territoryDim) {\r\n    layout.territoryDim = [layout.territoryDim];\r\n  }\r\n\r\n  // removing dimensions from layout not present in jsonStat\r\n  for (let key in layout) {\r\n    if (layout.hasOwnProperty(key)) {\r\n      if (dimArraysKey.includes(key)) {\r\n        layout[key] = (layout[key] || []).filter(dim => jsonStat.id.includes(dim));\r\n      }\r\n    }\r\n  }\r\n\r\n  // adding missing dimensions to layout\r\n  jsonStat.id.forEach(dim => {\r\n    let found = false;\r\n    for (let key in layout) {\r\n      if (layout.hasOwnProperty(key)) {\r\n        if (!found && dimArraysKey.includes(key)) {\r\n          found = layout[key].includes(dim);\r\n        }\r\n      }\r\n    }\r\n    if (!found) {\r\n      layout.filters.push(dim);\r\n      layout.filtersValue[dim] = jsonStat.dimension[dim].category.index[0];\r\n    }\r\n  });\r\n\r\n  // checking selected filtersValue\r\n  if (layout.filtersValue) {\r\n    for (let dim in layout.filtersValue) {\r\n      if (layout.filtersValue.hasOwnProperty(dim)) {\r\n        if (!layout.filters.includes(dim)) {\r\n          layout.filtersValue[dim] = undefined;\r\n        } else if (!jsonStat.dimension[dim].category.index.includes(layout.filtersValue[dim])) {\r\n          layout.filtersValue[dim] = jsonStat.dimension[dim].category.index[0];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // checking selected primaryDimValues\r\n  if (layout.primaryDim && layout.primaryDimValues) {\r\n    layout.primaryDimValues = layout.primaryDimValues.filter(value =>\r\n      jsonStat.dimension[layout.primaryDim].category.index.includes(value));\r\n  }\r\n\r\n  // checking selected secondaryDimValues\r\n  if (layout.secondaryDim && layout.secondaryDimValues) {\r\n    layout.secondaryDimValues = layout.secondaryDimValues.filter(value =>\r\n      jsonStat.dimension[layout.secondaryDim].category.index.includes(value));\r\n  }\r\n\r\n  if (layout.territoryDim) {\r\n    layout.territoryDim = layout.territoryDim[0];\r\n  }\r\n\r\n  return layout\r\n};\r\n\r\nexport const getUpdatedLayout = (jsonStat, layout, dimension, value) => {\r\n  let newLayout = _.cloneDeep(layout);\r\n\r\n  if ((newLayout.primaryDim || []).includes(dimension)) {\r\n    newLayout.primaryDimValues = value;\r\n    newLayout.secondaryDimValues = getChartDimensionValues(jsonStat, newLayout, false, 10);\r\n\r\n  } else if ((newLayout.secondaryDim || []).includes(dimension)) {\r\n    newLayout.secondaryDimValues = value;\r\n\r\n  } else if ((newLayout.filters || []).includes(dimension)) {\r\n    newLayout.filtersValue[dimension] = value\r\n  }\r\n\r\n  const filters = (newLayout.filters || []).filter(filter => jsonStat.size[jsonStat.id.indexOf(filter)] > 1);\r\n  const fixedFilters = filters.slice(0, filters.indexOf(dimension) + 1);\r\n  const fixedFiltersValue = {};\r\n  fixedFilters.forEach(filter => fixedFiltersValue[filter] = newLayout.filtersValue[filter]);\r\n\r\n  const tmpLayout = {\r\n    ...newLayout,\r\n    filters: filters.slice(filters.indexOf(dimension) + 1)\r\n  };\r\n\r\n  newLayout.filtersValue = {\r\n    ...newLayout.filtersValue,\r\n    ...getInitialFiltersValue(jsonStat, tmpLayout, fixedFiltersValue)\r\n  };\r\n\r\n  return newLayout\r\n};\r\n\r\nexport const getDimensionFiltersValue = (jsonStat, dimension, layout) => {\r\n  const {\r\n    filters = [],\r\n    filtersValue = {},\r\n    primaryDim: primaryDimArr = [],\r\n    primaryDimValues = [],\r\n    secondaryDim: secondaryDimArr = [],\r\n    secondaryDimValues = []\r\n  } = layout || {};\r\n  const primaryDim = primaryDimArr?.[0] || null;\r\n  const secondaryDim = secondaryDimArr?.[0] || null;\r\n\r\n  const values = [];\r\n\r\n  if ((dimension === primaryDim) || (!primaryDim && !secondaryDim && filters.filter(filter => jsonStat.size[jsonStat.id.indexOf(filter)] > 1)[0] === dimension)) {\r\n    jsonStat.dimension[dimension].category.index.forEach(dimValue => values.push({\r\n      id: dimValue,\r\n      label: jsonStat.dimension[dimension].category.label[dimValue]\r\n    }));\r\n    return values\r\n\r\n  } else {\r\n    const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n    const dimensionsNotInFilters = jsonStat.id.filter(dim => !filters.includes(dim));\r\n    const dimensionsPostFilter = filters.slice(filters.indexOf(dimension) + 1);\r\n    const dimensionsNotInFiltersAndPostFilters = dimensionsNotInFilters.concat(dimensionsPostFilter).filter(dim => dim !== dimension);\r\n\r\n    jsonStat.dimension[dimension].category.index.forEach(dimValue => {\r\n      const dimsArrays = jsonStat.id.map(dim => {\r\n        if (dimension === dim) {\r\n          return [dimValue]\r\n        } else if (dimensionsNotInFiltersAndPostFilters.includes(dim)) {\r\n          if (dim === primaryDim) {\r\n            return primaryDimValues\r\n          } else if (dim === secondaryDim) {\r\n            return secondaryDimValues\r\n          } else {\r\n            return jsonStat.dimension[dim].category.index\r\n          }\r\n        } else { // dimension in filters preceding the selected one\r\n          return [filtersValue[dim]]\r\n        }\r\n      });\r\n      const addedValues = {};\r\n      const isValorized = combination => {\r\n        const dataIndexArr = combination.map((combinationValue, idx) => indexesMap[jsonStat.id[idx]][combinationValue]);\r\n        const observation = jsonStat.value[getDataIdxFromDimensionsArray(dataIndexArr, jsonStat.size)];\r\n        return (observation !== null && observation !== undefined && !addedValues[dimValue])\r\n      };\r\n      const combinationArray = getCombinationArray(jsonStat, dimsArrays, isValorized);\r\n      if (combinationArray) {\r\n        values.push({\r\n          id: dimValue,\r\n          label: jsonStat.dimension[dimension].category.label[dimValue]\r\n        });\r\n        addedValues[dimValue] = true;\r\n      }\r\n    });\r\n    return values;\r\n  }\r\n};\r\n\r\nexport const getChartDimensionValues = (jsonStat, layout, isPrimaryDim, count) => {\r\n  const primaryDim = layout?.primaryDim?.[0] || null;\r\n  const secondaryDim = layout?.secondaryDim?.[0] || null;\r\n\r\n  if ((isPrimaryDim && !primaryDim) || (!isPrimaryDim && !secondaryDim)) {\r\n    return [];\r\n  }\r\n\r\n  const values = isPrimaryDim\r\n    ? jsonStat.dimension[primaryDim].category.index\r\n    : getDimensionFiltersValue(jsonStat, secondaryDim, layout).map(({id}) => id);\r\n\r\n  return values.slice(0, count ? count : undefined);\r\n};\r\n\r\nexport const getDimensionValuesIndexesMap = jsonStat => {\r\n  const indexesMap = {};\r\n\r\n  jsonStat.id.forEach(dim => {\r\n    indexesMap[dim] = {};\r\n    jsonStat.dimension[dim].category.index.forEach((dimValue, idx) => indexesMap[dim][dimValue] = idx);\r\n  });\r\n\r\n  return indexesMap;\r\n};\r\n\r\nexport const getAttributeObjects = (attributeList, attributeObj, hiddenAttributes) => {\r\n  const attributes = [];\r\n  const ids = [];\r\n  let hasAsterisk = false;\r\n\r\n  try {\r\n    (attributeList || []).forEach((attr, idx) => {\r\n      if (attr !== null && !(hiddenAttributes || []).includes(attributeObj[idx].id)) {\r\n        const valueId = attributeObj[idx].values[attr].id;\r\n        const valueLabel = attributeObj[idx].values[attr].name;\r\n\r\n        attributes.push({\r\n          id: attributeObj[idx].id,\r\n          label: attributeObj[idx].name,\r\n          valueId: valueId,\r\n          valueLabel: valueLabel\r\n        });\r\n\r\n        if (valueId !== valueLabel && valueId.length <= 5) {\r\n          ids.push(valueId);\r\n        } else {\r\n          hasAsterisk = true;\r\n        }\r\n      }\r\n    });\r\n\r\n    if (hasAsterisk) {\r\n      ids.push(\"(*)\");\r\n    }\r\n\r\n    return (attributes.length > 0 && ids.length > 0)\r\n      ? {\r\n        attributes,\r\n        ids\r\n      }\r\n      : null\r\n\r\n  } catch (error) {\r\n    return -1\r\n  }\r\n\r\n\r\n};\r\n\r\nexport const getDimensionAttributeMap = (jsonStat, hiddenAttributes, getIdsHtmlString) => {\r\n  if (!jsonStat) {\r\n    return null;\r\n  }\r\n\r\n  const series = (jsonStat?.extension?.attributes?.series || []);\r\n  const seriesIndexes = (jsonStat?.extension?.attributes?.index?.series || []);\r\n  const dimensionAttributesMap = {};\r\n\r\n  jsonStat.id.forEach(dim => dimensionAttributesMap[dim] = {});\r\n  if (series && series.length > 0 && seriesIndexes && seriesIndexes.length > 0) {\r\n    seriesIndexes\r\n      .filter(({coordinates}) => (coordinates || []).filter(c => c !== null).length === 1)\r\n      .forEach(index => {\r\n        const dimIdx = index.coordinates.findIndex(el => el !== null);\r\n        const dim = jsonStat.id[dimIdx];\r\n        const dimValueIdx = index.coordinates.find(el => el !== null);\r\n        const dimValue = jsonStat.dimension[dim].category.index[dimValueIdx];\r\n\r\n        const attributeObjects = getAttributeObjects(index.attributes, series, hiddenAttributes);\r\n        if (attributeObjects !== null && attributeObjects !== -1) {\r\n          dimensionAttributesMap[dim][dimValue] = {\r\n            attributes: attributeObjects.attributes,\r\n            ids: attributeObjects.ids,\r\n            htmlString: getIdsHtmlString\r\n              ? getIdsHtmlString(attributeObjects.ids, dim, dimValue)\r\n              : null\r\n          };\r\n        }\r\n      });\r\n  }\r\n\r\n  return dimensionAttributesMap;\r\n};\r\n\r\nexport const getCompleteTableLayout = (jsonStat, initialLayout) => {\r\n  const layout = _.cloneDeep(initialLayout);\r\n\r\n  layout.rows = (initialLayout.rows || []).filter(dim => jsonStat.id.includes(dim));\r\n  layout.cols = (initialLayout.cols || []).filter(dim => jsonStat.id.includes(dim));\r\n  layout.sections = (initialLayout.sections || []).filter(dim => jsonStat.id.includes(dim));\r\n\r\n  layout.filters = [];\r\n  jsonStat.id.forEach(dim => {\r\n    if (!layout.rows.includes(dim) && !layout.cols.includes(dim) && !layout.sections.includes(dim)) {\r\n      layout.filters.push(dim);\r\n    }\r\n  })\r\n\r\n  layout.filtersValue = getInitialFiltersValue(jsonStat, layout);\r\n\r\n  return layout\r\n};","export const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME = \"LABEL_FORMAT_SELECTOR_FORMAT_NAME\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID = \"LABEL_FORMAT_SELECTOR_FORMAT_ID\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH = \"LABEL_FORMAT_SELECTOR_FORMAT_BOTH\";","import moment from \"moment\";\r\nimport {FREQ_DIMENSION_KEY, TIME_PERIOD_DIMENSION_KEY} from \"./jsonStat\";\r\n\r\nexport const CRITERIA_FILTER_TYPE_CODES = \"CodeValues\";\r\nexport const CRITERIA_FILTER_TYPE_STRING = \"StringValues\";\r\nexport const CRITERIA_FILTER_TYPE_RANGE = \"TimeRange\";\r\nexport const CRITERIA_FILTER_TYPE_PERIODS = \"TimePeriod\";\r\n\r\nexport const FREQ_ANNUAL = \"A\";\r\nexport const FREQ_SEMESTER = \"S\";\r\nexport const FREQ_QUARTERLY = \"Q\";\r\nexport const FREQ_MONTHLY = \"M\";\r\nconst frequencies = [FREQ_MONTHLY, FREQ_QUARTERLY, FREQ_SEMESTER, FREQ_ANNUAL];\r\n\r\nexport const getDimensionCriteria = (criteria, dimensionId) => (criteria || []).find(({id}) => id === dimensionId) || null;\r\n\r\nconst getMinAndMax = timePeriodCodelist => {\r\n  let min = moment().add(-20, 'y').format(\"YYYY\") + \"-01-01\";\r\n  let max = moment().add(10, 'y').format(\"YYYY\") + \"-12-31\";\r\n\r\n  return {\r\n    min: timePeriodCodelist.values && timePeriodCodelist.values[0] && timePeriodCodelist.values[0].id\r\n      ? moment(timePeriodCodelist.values[0].id).format(\"YYYY-MM-DD\")\r\n      : min,\r\n    max: timePeriodCodelist.values && timePeriodCodelist.values[1] && timePeriodCodelist.values[1].id\r\n      ? moment(timePeriodCodelist.values[1].id).format(\"YYYY-MM-DD\")\r\n      : max,\r\n    missingRange: (!timePeriodCodelist.values || timePeriodCodelist.values.length !== 2)\r\n  }\r\n};\r\n\r\nexport const getTimePeriod = (initialTimePeriod, criteria, timePeriodCodelist, freqCodelist) => {\r\n\r\n  const minAndMax = timePeriodCodelist\r\n    ? getMinAndMax(timePeriodCodelist)\r\n    : {\r\n      min: initialTimePeriod.minDate,\r\n      max: initialTimePeriod.maxDate,\r\n      missingRange: initialTimePeriod.missingRange,\r\n    };\r\n\r\n  let freq = initialTimePeriod.freq;\r\n  if (freqCodelist !== null) {\r\n    freq = (frequencies.find(freq => (freqCodelist.values || []).map(({id}) => id).includes(freq)) || null)\r\n  }\r\n\r\n  return {\r\n    minDate: minAndMax.min,\r\n    maxDate: minAndMax.max,\r\n    missingRange: minAndMax.missingRange,\r\n    fromDate: (criteria?.[TIME_PERIOD_DIMENSION_KEY]?.from || minAndMax.min),\r\n    toDate: (criteria?.[TIME_PERIOD_DIMENSION_KEY]?.to || minAndMax.max),\r\n    freq: freq\r\n  }\r\n};\r\n\r\nexport const getFreq = criteria => {\r\n  const freqValues = (criteria && criteria[FREQ_DIMENSION_KEY])\r\n    ? (criteria[FREQ_DIMENSION_KEY].filterValues || [])\r\n    : [];\r\n  return (frequencies.find(freq => freqValues.includes(freq)) || null)\r\n};\r\n\r\nexport const getCriteriaArrayFromObject = criteriaObj => {\r\n  const criteriaArr = [];\r\n  Object.keys(criteriaObj).forEach(key => {\r\n    if (criteriaObj[key] !== null && criteriaObj[key] !== undefined) {\r\n      criteriaArr.push(criteriaObj[key])\r\n    }\r\n  });\r\n\r\n  return criteriaArr;\r\n};\r\n\r\nexport const getCriteriaObjectFromArray = criteriaArr => {\r\n  let criteriaObj = {};\r\n  (criteriaArr || []).forEach((dimensionCriteria) => {\r\n    criteriaObj = {\r\n      ...criteriaObj,\r\n      [dimensionCriteria.id]: dimensionCriteria\r\n    }\r\n  });\r\n\r\n  return criteriaObj;\r\n};","import React from \"react\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport withTheme from \"@material-ui/core/styles/withTheme\";\r\n\r\nconst InfoTooltip = ({children, theme}) => {\r\n\r\n  return children\r\n    ? (\r\n      <Tooltip title={children} placement=\"top\">\r\n        <IconButton\r\n          aria-label=\"info\"\r\n          style={{\r\n            color: theme.palette.primary.main,\r\n            padding: 0,\r\n            transform: \"translateY(-1px)\"\r\n          }}\r\n        >\r\n          <InfoIcon fontSize=\"small\"/>\r\n        </IconButton>\r\n      </Tooltip>\r\n    )\r\n    : (\r\n      <IconButton\r\n        aria-label=\"info\"\r\n        style={{\r\n          color: theme.palette.primary.main,\r\n          padding: 0,\r\n          transform: \"translateY(-1px)\"\r\n        }}\r\n      >\r\n        <InfoIcon fontSize=\"small\"/>\r\n      </IconButton>\r\n    );\r\n};\r\n\r\nexport default withTheme(InfoTooltip);","import React, {Fragment} from 'react';\r\nimport InfoTooltip from \"../info-tooltip\";\r\n\r\nconst FormLabelWithTooltip = ({children, tooltip, tooltipOnRight}) => {\r\n\r\n  const Tooltip = () =>\r\n    <span\r\n      style={{\r\n        pointerEvents: \"auto\",\r\n        marginLeft: tooltipOnRight ? 10 : null,\r\n        marginRight: !tooltipOnRight ? 10 : null,\r\n      }}\r\n    >\r\n        <InfoTooltip>\r\n          {tooltip}\r\n        </InfoTooltip>\r\n     </span>;\r\n\r\n  return (\r\n    <Fragment>\r\n      {!tooltipOnRight && <Tooltip/>}\r\n      <span style={{pointerEvents: \"none\"}}>\r\n        {children}\r\n      </span>\r\n      {tooltipOnRight && <Tooltip/>}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default FormLabelWithTooltip;","export const downloadFormats = t => ({\r\n  genericdata: {\r\n    label: t ? t(\"commons.downloadFormat.genericdata\") : \"genericdata\",\r\n    extension: \"xml\"\r\n  },\r\n  genericdata20: {\r\n    label: t ? t(\"commons.downloadFormat.genericdata20\") : \"genericdata20\",\r\n    extension: \"xml\"\r\n  },\r\n  compactdata: {\r\n    label: t ? t(\"commons.downloadFormat.compactdata\") : \"compactdata\",\r\n    extension: \"xml\"\r\n  },\r\n  structurespecificdata: {\r\n    label: t ? t(\"commons.downloadFormat.structurespecificdata\") : \"structurespecificdata\",\r\n    extension: \"xml\"\r\n  },\r\n  jsondata: {\r\n    label: t ? t(\"commons.downloadFormat.jsondata\") : \"jsondata\",\r\n    extension: \"json\"\r\n  },\r\n  csv: {\r\n    label: t ? t(\"commons.downloadFormat.csv\") : \"csv\",\r\n    extension: \"csv\"\r\n  }\r\n});\r\n\r\nexport const isDownloadFormatValid = format => downloadFormats()?.[format] !== undefined\r\n\r\nexport const getDownloadFormatLabels = t => {\r\n  const labels = [];\r\n\r\n  for (let format in downloadFormats) {\r\n    if (downloadFormats.hasOwnProperty(format)) {\r\n      labels.push(downloadFormats(t)[format].label);\r\n    }\r\n  }\r\n\r\n  return labels;\r\n};\r\n\r\nexport const getDownloadFormatLabelFromFormat = (format, t) => downloadFormats(t)[format]?.label;\r\n\r\nexport const getDownloadFormatExtensionFromFormat = (format, t) => downloadFormats(t)[format]?.extension;\r\n\r\nexport const exportChartJpeg = (canvasId, fileName) => {\r\n  const canvas = document.getElementById(canvasId);\r\n\r\n  const link = document.createElement(\"a\");\r\n  link.download = fileName;\r\n  link.target = \"_blank\";\r\n  link.href = canvas.toDataURL(\"image/jpeg\");\r\n\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport {useForm} from 'react-hook-form'\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport {compose} from \"redux\";\r\nimport validator from \"validator\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearNodesConfigNode,\r\n  fetchNodesConfigNode,\r\n  sendNodesConfigNodeCreate,\r\n  sendNodesConfigNodeEdit\r\n} from \"../../../../state/nodesConfig/nodesConfigActions\";\r\nimport {\r\n  ALL_FULL,\r\n  ALL_PARTIAL,\r\n  STEP_BY_STEP_DYNAMIC,\r\n  STEP_BY_STEP_FULL,\r\n  STEP_BY_STEP_PARTIAL\r\n} from \"../../../../state/dataset/datasetActions\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport FileInput from \"../../../file-input\";\r\nimport FormLabelWithTooltip from \"../../../form-label-with-tooltip\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nTextField from \"../../../i18n-text-field\";\r\nimport {validateI18nObj} from \"../../../../utils/i18n\";\r\nimport I18nHtmlEditor from \"../../../i18n-html-editor\";\r\nimport {downloadFormats} from \"../../../../utils/download\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit, onCancel}, ref) => {\r\n\r\n  const [tab, setTab] = useState(\"general\");\r\n  const [mustChangeTabOnErrors, setMustChangeTabOnErrors] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      active: false,\r\n      ...config,\r\n      annotationConfig:\r\n        config?.extras?.find(({key}) => key === \"AnnotationConfig\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"AnnotationConfig\").value)\r\n          : {\r\n            \"ORDER\": \"ORDER\",\r\n            \"ORDER_CATEGORY\": \"ORDER\",\r\n            \"ORDER_CODELIST\": \"ORDER\",\r\n            \"NOT_DISPLAYED\": \"NOT_DISPLAYED\",\r\n            \"DEFAULT\": \"DEFAULT\",\r\n            \"LAYOUT_ROW\": \"LAYOUT_ROW\",\r\n            \"LAYOUT_COLUMN\": \"LAYOUT_COLUMN\",\r\n            \"LAYOUT_FILTER\": \"LAYOUT_FILTER\",\r\n            \"LAYOUT_ROW_SECTION\": \"LAYOUT_ROW_SECTION\",\r\n            \"CRITERIA_SELECTION\": \"CRITERIA_SELECTION\",\r\n            \"ATTACHED_DATA_FILES\": \"ATTACHED_DATA_FILES\",\r\n            \"LAYOUT_DECIMAL_SEPARATOR\": \"LAYOUT_DECIMAL_SEPARATOR\",\r\n            \"LAYOUT_NUMBER_OF_DECIMALS\": \"LAYOUT_NUMBER_OF_DECIMALS\",\r\n            \"LAYOUT_EMPTY_CELL_PLACEHOLDER\": \"LAYOUT_EMPTY_CELL_PLACEHOLDER\",\r\n            \"DATAFLOW_NOTES\": \"DATAFLOW_NOTES\",\r\n            \"DATAFLOW_SOURCE\": \"DATAFLOW_SOURCE\",\r\n            \"METADATA_URL\": \"METADATA_URL\",\r\n            \"KEYWORDS\": \"KEYWORDS\",\r\n            \"DEFAULT_VIEW\": \"DEFAULT_VIEW\",\r\n            \"GEO_ID\": \"GEO_ID\",\r\n            \"LAST_UPDATE\": \"LAST_UPDATE\",\r\n            \"VIRTUAL_DATAFLOW_NODE\": \"VIRTUAL_DATAFLOW_NODE\",\r\n            \"DATAFLOW_CATALOG_TYPE\": \"DATAFLOW_CATALOG_TYPE\"\r\n          },\r\n      showCategoryLevels: config?.showCategoryLevels || 1,\r\n      decimalNumber: config?.decimalNumber || 1,\r\n      decimalSeparator: config?.decimalSeparator || {en: \",\"},\r\n      catalogNavigationMode: config?.catalogNavigationMode || \"List\",\r\n      hiddenAttributes:\r\n        config?.extras?.find(({key}) => key === \"HiddenAttributes\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"HiddenAttributes\").value)\r\n          : [],\r\n      pageSize:\r\n        config?.extras?.find(({key}) => key === \"PageSize\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"PageSize\").value)\r\n          : \"\",\r\n      restDataResponseXml:\r\n        config?.extras?.find(({key}) => key === \"RestDataResponseXml\") && (\r\n          config.extras.find(({key}) => key === \"RestDataResponseXml\").value === \"false\" ||\r\n          config.extras.find(({key}) => key === \"RestDataResponseXml\").value === \"true\"\r\n        )\r\n          ? config.extras.find(({key}) => key === \"RestDataResponseXml\").value\r\n          : \"\",\r\n      downloadFormats:\r\n        config?.extras?.find(({key}) => key === \"DownloadFormats\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"DownloadFormats\").value)\r\n          : [],\r\n      supportPostFilters:\r\n        config?.extras?.find(({key}) => key === \"SupportPostFilters\") && (\r\n          config.extras.find(({key}) => key === \"SupportPostFilters\").value === \"false\" ||\r\n          config.extras.find(({key}) => key === \"SupportPostFilters\").value === \"true\"\r\n        )\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"SupportPostFilters\").value)\r\n          : false\r\n    }\r\n  });\r\n\r\n  const enableHttpAuth = watch(\"enableHttpAuth\");\r\n  const enableProxy = watch(\"enableProxy\");\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      setMustChangeTabOnErrors(true);\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          type: \"SDMX-REST\",\r\n          annotationConfig: undefined,\r\n          restDataResponseXml: undefined,\r\n          optimizeCallWithSoap: undefined,\r\n          namespaceV20: undefined,\r\n          namespaceV21: undefined,\r\n          hiddenAttributes: undefined,\r\n          pageSize: undefined,\r\n          downloadFormats: undefined\r\n        };\r\n\r\n        if (data.extras?.find(({key}) => key === \"AnnotationConfig\")) {\r\n          data.extras.find(({key}) => key === \"AnnotationConfig\").value = JSON.stringify(val.annotationConfig)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"AnnotationConfig\",\r\n            value: JSON.stringify(val.annotationConfig),\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"RestDataResponseXml\")) {\r\n          data.extras.find(({key}) => key === \"RestDataResponseXml\").value = val.restDataResponseXml\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"RestDataResponseXml\",\r\n            value: val.restDataResponseXml,\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"SupportPostFilters\")) {\r\n          data.extras.find(({key}) => key === \"SupportPostFilters\").value = JSON.stringify(val.supportPostFilters)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"SupportPostFilters\",\r\n            value: JSON.stringify(val.supportPostFilters),\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"HiddenAttributes\")) {\r\n          data.extras.find(({key}) => key === \"HiddenAttributes\").value = JSON.stringify(val.hiddenAttributes)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"HiddenAttributes\",\r\n            value: JSON.stringify(val.hiddenAttributes),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"PageSize\")) {\r\n          data.extras.find(({key}) => key === \"PageSize\").value = JSON.stringify(val.pageSize)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"PageSize\",\r\n            value: JSON.stringify(val.pageSize),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"DownloadFormats\")) {\r\n          data.extras.find(({key}) => key === \"DownloadFormats\").value = JSON.stringify(val.downloadFormats)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"DownloadFormats\",\r\n            value: JSON.stringify(val.downloadFormats),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  /* custom register */\r\n  useEffect(() => {\r\n\r\n    register({\r\n      name: \"code\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n    });\r\n    register({\r\n      name: \"title\"\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({\r\n      name: \"agency\"\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    })\r\n    register({name: 'active'});\r\n    register({name: \"slogan\"});\r\n    register({name: 'backgroundMediaURL'});\r\n    register({name: 'logo'});\r\n    register({name: 'description'});\r\n    register({\r\n      name: 'criteriaSelectionMode'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"endPoint\"\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"supportPostFilters\"\r\n    });\r\n    register({name: 'enableHttpAuth'});\r\n    register({name: 'enableProxy'});\r\n    register({name: 'annotationConfig.ORDER'});\r\n    register({name: 'annotationConfig.ORDER_CATEGORY'});\r\n    register({name: 'annotationConfig.ORDER_CODELIST'});\r\n    register({name: 'annotationConfig.NOT_DISPLAYED'});\r\n    register({name: 'annotationConfig.DEFAULT'});\r\n    register({name: 'annotationConfig.LAYOUT_ROW'});\r\n    register({name: 'annotationConfig.LAYOUT_COLUMN'});\r\n    register({name: 'annotationConfig.LAYOUT_FILTER'});\r\n    register({name: 'annotationConfig.LAYOUT_ROW_SECTION'});\r\n    register({name: 'annotationConfig.CRITERIA_SELECTION'});\r\n    register({name: 'annotationConfig.ATTACHED_DATA_FILES'});\r\n    register({name: 'annotationConfig.LAYOUT_DECIMAL_SEPARATOR'});\r\n    register({name: 'annotationConfig.LAYOUT_NUMBER_OF_DECIMALS'});\r\n    register({name: 'annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER'});\r\n    register({name: 'annotationConfig.DATAFLOW_NOTES'});\r\n    register({name: 'annotationConfig.DATAFLOW_SOURCE'});\r\n    register({name: 'annotationConfig.METADATA_URL'});\r\n    register({name: 'annotationConfig.KEYWORDS'});\r\n    register({name: 'annotationConfig.DEFAULT_VIEW'});\r\n    register({name: 'annotationConfig.GEO_ID'});\r\n    register({name: 'annotationConfig.LAST_UPDATE'});\r\n    register({name: 'annotationConfig.VIRTUAL_DATAFLOW_NODE'});\r\n    register({name: 'annotationConfig.DATAFLOW_CATALOG_TYPE'});\r\n    register({\r\n      name: \"ttlCatalog\"\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: \"ttlDataflow\"\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({name: 'showDataflowUncategorized'});\r\n    register({\r\n      name: 'showCategoryLevels'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"decimalNumber\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: 'decimalSeparator'\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({name: 'labelDimensionTerritorials'});\r\n    register({name: 'labelDimensionTemporals'});\r\n    register({name: 'categorySchemaExcludes'});\r\n    register({\r\n      name: 'catalogNavigationMode'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({name: 'hiddenAttributes'});\r\n    register({\r\n      name: 'pageSize'\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: 'restDataResponseXml'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({name: 'downloadFormats'});\r\n  }, [register, t]);\r\n\r\n  /* register enableHttpAuth fieldset */\r\n  useEffect(() => {\r\n\r\n    if (enableHttpAuth) {\r\n      register({\r\n        name: \"authHttpUsername\"\r\n      }, {\r\n        required: t(\"commons.validation.required\")\r\n      });\r\n      register({\r\n        name: \"authHttpPassword\"\r\n      });\r\n      register({\r\n        name: \"authHttpDomain\"\r\n      });\r\n    }\r\n\r\n  }, [register, enableHttpAuth, t]);\r\n\r\n  /* register enableProxy fieldset */\r\n  useEffect(() => {\r\n\r\n    if (enableProxy) {\r\n      register({\r\n        name: \"proxyAddress\"\r\n      }, {\r\n        required: t(\"commons.validation.required\")\r\n      });\r\n      register({\r\n        name: \"proxyPort\"\r\n      }, {\r\n        required: t(\"commons.validation.required\"),\r\n        validate: val => validator.isPort(val) || t(\"scenes.nodeSettings.fields.proxyPort.validation\")\r\n      });\r\n      register({name: \"proxyUsername\"});\r\n      register({name: \"proxyPassword\"});\r\n    }\r\n  }, [register, enableProxy, t]);\r\n\r\n  /* switch to first tab with errors */\r\n  if (Object.keys(errors).length > 0 && mustChangeTabOnErrors) {\r\n\r\n    setMustChangeTabOnErrors(false);\r\n\r\n    const firstFieldWithErrors = Object.keys(errors)[0];\r\n    if (firstFieldWithErrors === \"code\" || firstFieldWithErrors === \"agency\" || firstFieldWithErrors === \"title\" || firstFieldWithErrors === \"slogan\") {\r\n      if (tab !== \"general\") {\r\n        setTab(\"general\")\r\n      }\r\n    } else if (\r\n      firstFieldWithErrors === \"showCategoryLevels\" ||\r\n      firstFieldWithErrors === \"decimalNumber\" ||\r\n      firstFieldWithErrors === \"decimalSeparator\" ||\r\n      firstFieldWithErrors === \"labelDimensionTerritorials\" ||\r\n      firstFieldWithErrors === \"labelDimensionTemporals\" ||\r\n      firstFieldWithErrors === \"categorySchemaExcludes\" ||\r\n      firstFieldWithErrors === \"catalogNavigationMode\" ||\r\n      firstFieldWithErrors === \"hiddenAttributes\" ||\r\n      firstFieldWithErrors === \"pageSize\" ||\r\n      firstFieldWithErrors === \"downloadFormats\"\r\n    ) {\r\n\r\n      if (tab !== \"view\") {\r\n        setTab(\"view\")\r\n      }\r\n\r\n    } else if (firstFieldWithErrors) {\r\n\r\n      if (tab !== \"endpoint\") {\r\n        setTab(\"endpoint\");\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <Tabs\r\n        value={tab}\r\n        onChange={(_, tab) => setTab(tab)}\r\n      >\r\n        <Tab value=\"general\" label={t(\"scenes.nodeSettings.tabs.general.label\")}/>\r\n        <Tab value=\"infos\" label={t(\"scenes.nodeSettings.tabs.information.label\")}/>\r\n        <Tab value=\"endpoint\" label={t(\"scenes.nodeSettings.tabs.endpoint.label\")}/>\r\n        <Tab value=\"annotations\" label={t(\"scenes.nodeSettings.tabs.annotations.label\")}/>\r\n        <Tab value=\"view\" label={t(\"scenes.nodeSettings.tabs.view.label\")}/>\r\n        <Tab value=\"cache\" label={t(\"scenes.nodeSettings.tabs.cache.label\")}/>\r\n      </Tabs>\r\n      <div className={classes.tabContent}>\r\n        <Box style={tab !== \"general\" ? {display: \"none\"} : undefined}>\r\n          <Fragment>\r\n            <Grid container spacing={3}>\r\n              <Grid item xs={3}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    disabled={!!config}\r\n                    name=\"code\"\r\n                    variant=\"outlined\"\r\n                    label={\r\n                      <FormLabelWithTooltip tooltip={t(\"scenes.nodeSettings.fields.code.tooltip\")}>\r\n                        {t(\"scenes.nodeSettings.fields.code.label\")}\r\n                      </FormLabelWithTooltip>\r\n                    }\r\n                    required\r\n                    error={!!errors.code}\r\n                    helperText={errors.code?.message}\r\n                    value={watch('code') || \"\"}\r\n                    onChange={({target}) => setValue('code', (target.value || \"\").toUpperCase())}\r\n                    inputProps={{\r\n                      style: {textTransform: \"uppercase\"}\r\n                    }}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <I18nTextField\r\n                    name=\"title\"\r\n                    label={t(\"scenes.nodeSettings.fields.title.label\")}\r\n                    required\r\n                    error={!!errors.title}\r\n                    helperText={errors.title?.message}\r\n                    variant=\"outlined\"\r\n                    value={watch('title') || {}}\r\n                    onChange={value => setValue('title', value)}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={3}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    name=\"agency\"\r\n                    label={t(\"scenes.nodeSettings.fields.agency.label\")}\r\n                    required\r\n                    error={!!errors.agency}\r\n                    helperText={errors.agency?.message}\r\n                    variant=\"outlined\"\r\n                    value={watch('agency') || \"\"}\r\n                    onChange={({target}) => setValue('agency', target.value)}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FormControlLabel\r\n                label={\r\n                  <FormLabelWithTooltip\r\n                    tooltip={t(\"scenes.nodeSettings.fields.active.tooltip\")}\r\n                    tooltipOnRight\r\n                  >\r\n                    {t(\"scenes.nodeSettings.fields.active.label\")}\r\n                  </FormLabelWithTooltip>\r\n                }\r\n                control={\r\n                  <Checkbox\r\n                    name=\"active\"\r\n                    required\r\n                    checked={watch('active')}\r\n                    onChange={(e, value) => setValue('active', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"slogan\"\r\n                label={t(\"scenes.nodeSettings.fields.slogan.label\")}\r\n                variant=\"outlined\"\r\n                value={watch('slogan') || {}}\r\n                onChange={value => setValue('slogan', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.nodeSettings.fields.backgroundMediaURL.label\")}\r\n                value={watch('backgroundMediaURL')}\r\n                onChange={value => setValue('backgroundMediaURL', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.nodeSettings.fields.logo.label\")}\r\n                value={watch('logo')}\r\n                onChange={value => setValue('logo', value)}\r\n              />\r\n            </FormControl>\r\n          </Fragment>\r\n        </Box>\r\n        <Box style={tab !== \"infos\" ? {display: \"none\"} : undefined}>\r\n          <I18nHtmlEditor\r\n            value={watch('description')}\r\n            onChange={val => setValue('description', val)}\r\n          />\r\n        </Box>\r\n        <Box style={tab !== \"endpoint\" ? {display: \"none\"} : undefined}>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={12}>\r\n                <FormControl fullWidth>\r\n                  <TextField\r\n                    name=\"type\"\r\n                    select\r\n                    label={t(\"scenes.nodeSettings.fields.type.label\")}\r\n                    value=\"SDMX-REST\"\r\n                    variant=\"outlined\"\r\n                  >\r\n                    <MenuItem value=\"SDMX-REST\">SDMX-REST</MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item sm={12}>\r\n                <FormControl fullWidth>\r\n                  <TextField\r\n                    name=\"criteriaSelectionMode\"\r\n                    select\r\n                    label={\r\n                      <FormLabelWithTooltip\r\n                        tooltip={t(\"scenes.nodeSettings.fields.criteriaSelectionMode.tooltip\")}\r\n                      >\r\n                        {t(\"scenes.nodeSettings.fields.criteriaSelectionMode.label\")}\r\n                      </FormLabelWithTooltip>\r\n                    }\r\n                    variant=\"outlined\"\r\n                    onChange={e => setValue('criteriaSelectionMode', e.target.value)}\r\n                    value={watch(\"criteriaSelectionMode\") || ''}\r\n                    helperText={errors.criteriaSelectionMode?.message}\r\n                    error={!!errors.criteriaSelectionMode}\r\n                  >\r\n                    <MenuItem value={ALL_FULL}>ALL_FULL</MenuItem>\r\n                    <MenuItem value={ALL_PARTIAL}>ALL_PARTIAL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_FULL}>STEP_BY_STEP_FULL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_PARTIAL}>STEP_BY_STEP_PARTIAL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_DYNAMIC}>STEP_BY_STEP_DYNAMIC</MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n          </Paper>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"endPoint\"\r\n                label={t(\"scenes.nodeSettings.fields.endPoint.label\")}\r\n                required\r\n                error={!!errors.endPoint}\r\n                helperText={errors.endPoint?.message}\r\n                variant=\"outlined\"\r\n                value={watch('endPoint') || \"\"}\r\n                onChange={({target}) => setValue('endPoint', target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                select\r\n                label={t(\"scenes.nodeSettings.fields.responseFormat.label\")}\r\n                value={watch(\"restDataResponseXml\") || \"\"}\r\n                required\r\n                variant=\"outlined\"\r\n                error={!!errors.restDataResponseXml}\r\n                helperText={errors.restDataResponseXml?.message}\r\n                onChange={({target}) => setValue('restDataResponseXml', target.value)}\r\n              >\r\n                <MenuItem value=\"true\">XML</MenuItem>\r\n                <MenuItem value=\"false\">JSON</MenuItem>\r\n              </TextField>\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FormControlLabel\r\n                label={t(\"scenes.nodeSettings.fields.supportPostFilters.label\")}\r\n                control={\r\n                  <Checkbox\r\n                    name=\"supportPostFilters\"\r\n                    required\r\n                    checked={watch('supportPostFilters') || false}\r\n                    onChange={(e, value) => setValue('supportPostFilters', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n          </Paper>\r\n          {/*<Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label=\"SOAP endpoint\"\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"optimizeCallWithSoap\"\r\n                      checked={watch('optimizeCallWithSoap')}\r\n                      onChange={(e, value) => setValue('optimizeCallWithSoap', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {optimizeCallWithSoap && (\r\n                <Fragment>\r\n                  <Grid item sm={8}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"namespaceV20\"\r\n                        label=\"Endpoint V20\"\r\n                        required\r\n                        inputRef={register({\r\n                          required: REQUIRED_MESSAGE\r\n                        })}\r\n                        error={!!errors.namespaceV20}\r\n                        helperText={errors.namespaceV20?.message}\r\n                        variant=\"outlined\"\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}></Grid>\r\n                  <Grid item sm={8}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"namespaceV21\"\r\n                        label=\"Endpoint V21\"\r\n                        required\r\n                        inputRef={register({\r\n                          required: REQUIRED_MESSAGE\r\n                        })}\r\n                        error={!!errors.namespaceV21}\r\n                        helperText={errors.namespaceV21?.message}\r\n                        variant=\"outlined\"\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>*/}\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label={t(\"scenes.nodeSettings.fields.enableHttpAuth.label\")}\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"enableHttpAuth\"\r\n                      checked={enableHttpAuth || false}\r\n                      onChange={(e, value) => setValue('enableHttpAuth', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {enableHttpAuth && (\r\n                <Fragment>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpUsername\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpUsername.label\")}\r\n                        required\r\n                        error={!!errors.authHttpUsername}\r\n                        helperText={errors.authHttpUsername?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpUsername') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpUsername', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpPassword\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpPassword.label\")}\r\n                        type=\"password\"\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpPassword') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpPassword', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}/>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpDomain\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpDomain.label\")}\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpDomain') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpDomain', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label={t(\"scenes.nodeSettings.fields.enableProxy.label\")}\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"enableProxy\"\r\n                      checked={enableProxy || false}\r\n                      onChange={(e, value) => setValue('enableProxy', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {enableProxy && (\r\n                <Fragment>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyAddress\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyAddress.label\")}\r\n                        required\r\n                        error={!!errors.proxyAddress}\r\n                        helperText={errors.proxyAddress?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyAddress') || \"\"}\r\n                        onChange={({target}) => setValue('proxyAddress', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyPort\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyPort.label\")}\r\n                        required\r\n                        error={!!errors.proxyPort}\r\n                        helperText={errors.proxyPort?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyPort') || \"\"}\r\n                        onChange={({target}) => setValue('proxyPort', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}/>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyUsername\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyUsername.label\")}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyUsername') || \"\"}\r\n                        onChange={({target}) => setValue('proxyUsername', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyPassword\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyPassword.label\")}\r\n                        type=\"password\"\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyPassword') || \"\"}\r\n                        onChange={e => setValue('proxyPassword', e.target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>\r\n        </Box>\r\n        <Box style={tab !== \"annotations\" ? {display: \"none\"} : undefined}>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER_CATEGORY\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER_CATEGORY.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER_CATEGORY') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER_CATEGORY', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER_CODELIST\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER_CODELIST.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER_CODELIST') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER_CODELIST', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.NOT_DISPLAYED\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.NOT_DISPLAYED.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.NOT_DISPLAYED') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.NOT_DISPLAYED', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DEFAULT\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DEFAULT.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DEFAULT') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DEFAULT', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_ROW\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_ROW.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_ROW') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_ROW', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_COLUMN\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_COLUMN.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_COLUMN') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_COLUMN', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_FILTER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_FILTER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_FILTER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_FILTER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_ROW_SECTION\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_ROW_SECTION.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_ROW_SECTION') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_ROW_SECTION', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.CRITERIA_SELECTION\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.CRITERIA_SELECTION.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.CRITERIA_SELECTION') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.CRITERIA_SELECTION', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ATTACHED_DATA_FILES\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ATTACHED_DATA_FILES.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ATTACHED_DATA_FILES') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ATTACHED_DATA_FILES', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_DECIMAL_SEPARATOR\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_DECIMAL_SEPARATOR.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_DECIMAL_SEPARATOR') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_DECIMAL_SEPARATOR', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_NUMBER_OF_DECIMALS\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_NUMBER_OF_DECIMALS.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_NUMBER_OF_DECIMALS') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_NUMBER_OF_DECIMALS', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_EMPTY_CELL_PLACEHOLDER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_NOTES\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_NOTES.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_NOTES') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_NOTES', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_SOURCE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_SOURCE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_SOURCE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_SOURCE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.METADATA_URL\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.METADATA_URL.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.METADATA_URL') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.METADATA_URL', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.KEYWORDS\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.KEYWORDS.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.KEYWORDS') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.KEYWORDS', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DEFAULT_VIEW\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DEFAULT_VIEW.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DEFAULT_VIEW') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DEFAULT_VIEW', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.GEO_ID\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.GEO_ID.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.GEO_ID') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.GEO_ID', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAST_UPDATE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAST_UPDATE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAST_UPDATE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAST_UPDATE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.VIRTUAL_DATAFLOW_NODE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.VIRTUAL_DATAFLOW_NODE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.VIRTUAL_DATAFLOW_NODE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.VIRTUAL_DATAFLOW_NODE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_CATALOG_TYPE\"\r\n              label={\r\n                <FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_CATALOG_TYPE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_CATALOG_TYPE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_CATALOG_TYPE', target.value)}\r\n            />\r\n          </FormControl>\r\n        </Box>\r\n        <Box style={tab !== \"cache\" ? {display: \"none\"} : undefined}>\r\n\r\n\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"ttlCatalog\"\r\n              variant=\"outlined\"\r\n              helperText={errors.ttlCatalog?.message}\r\n              label={\r\n                <FormLabelWithTooltip tooltip={t(\"scenes.nodeSettings.fields.catalogCacheValidity.tooltip\")}>\r\n                  {t(\"scenes.nodeSettings.fields.catalogCacheValidity.label\")}\r\n                </FormLabelWithTooltip>\r\n              }\r\n              error={!!errors.ttlCatalog}\r\n              value={watch('ttlCatalog') || \"\"}\r\n              onChange={({target}) => setValue('ttlCatalog', target.value)}\r\n            />\r\n          </FormControl>\r\n\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"ttlDataflow\"\r\n              variant=\"outlined\"\r\n              helperText={errors.ttlDataflow?.message}\r\n              label={\r\n                <FormLabelWithTooltip tooltip={t(\"scenes.nodeSettings.fields.dataflowCacheValidity.tooltip\")}>\r\n                  {t(\"scenes.nodeSettings.fields.dataflowCacheValidity.label\")}\r\n                </FormLabelWithTooltip>\r\n              }\r\n              error={!!errors.ttlDataflow}\r\n              value={watch('ttlDataflow') || \"\"}\r\n              onChange={({target}) => setValue('ttlDataflow', target.value)}\r\n            />\r\n          </FormControl>\r\n\r\n\r\n        </Box>\r\n        <Box style={tab !== \"view\" ? {display: \"none\"} : undefined}>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <FormControlLabel\r\n              label={t(\"scenes.nodeSettings.fields.showDataflowUncategorized.label\")}\r\n              control={\r\n                <Checkbox\r\n                  name=\"showDataflowUncategorized\"\r\n                  required\r\n                  checked={watch('showDataflowUncategorized') || false}\r\n                  onChange={(e, value) => setValue('showDataflowUncategorized', value)}\r\n                />\r\n              }\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"showCategoryLevels\"\r\n              select\r\n              required\r\n              label={t(\"scenes.nodeSettings.fields.showCategoryLevels.label\")}\r\n              onChange={e => setValue('showCategoryLevels', e.target.value)}\r\n              value={watch(\"showCategoryLevels\") || ''}\r\n              error={!!errors.showCategoryLevels}\r\n              helperText={errors.showCategoryLevels?.message}\r\n              variant=\"outlined\"\r\n            >\r\n              <MenuItem value={1}>1</MenuItem>\r\n              <MenuItem value={5}>5</MenuItem>\r\n            </TextField>\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"decimalNumber\"\r\n              label={t(\"scenes.nodeSettings.fields.decimalNumber.label\")}\r\n              variant=\"outlined\"\r\n              required\r\n              type=\"number\"\r\n              error={!!errors.decimalNumber}\r\n              helperText={errors.decimalNumber?.message}\r\n              value={watch('decimalNumber') || ''}\r\n              onChange={({target}) => setValue('decimalNumber', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <I18nTextField\r\n              name=\"decimalSeparator\"\r\n              select\r\n              required\r\n              label={t(\"scenes.nodeSettings.fields.decimalSeparator.label\")}\r\n              onChange={value => setValue('decimalSeparator', value)}\r\n              value={watch(\"decimalSeparator\") || ''}\r\n              helper={t(\"scenes.nodeSettings.fields.decimalSeparator.helper\")}\r\n              error={!!errors.decimalSeparator}\r\n              helperText={errors.decimalSeparator?.message}\r\n              variant=\"outlined\"\r\n            >\r\n              <MenuItem value=\".\">Dot</MenuItem>\r\n              <MenuItem value=\",\">Comma</MenuItem>\r\n            </I18nTextField>\r\n          </FormControl>\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('labelDimensionTerritorials') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('labelDimensionTerritorials', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.labelDimensionTerritorials.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.labelDimensionTerritorials.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('labelDimensionTemporals') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('labelDimensionTemporals', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.labelDimensionTemporals.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.labelDimensionTemporals.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('categorySchemaExcludes') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('categorySchemaExcludes', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.categorySchemaExcludes.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.categorySchemaExcludes.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              select\r\n              label={t(\"scenes.nodeSettings.fields.catalogNavigationMode.label\")}\r\n              onChange={e => setValue('catalogNavigationMode', e.target.value)}\r\n              value={watch(\"catalogNavigationMode\") || ''}\r\n              required\r\n              variant=\"outlined\"\r\n              error={!!errors.catalogNavigationMode}\r\n              helperText={errors.catalogNavigationMode?.message}\r\n            >\r\n              <MenuItem value=\"Card\">{t(\"scenes.nodeSettings.fields.catalogNavigationMode.values.card\")}</MenuItem>\r\n              <MenuItem value=\"List\">{t(\"scenes.nodeSettings.fields.catalogNavigationMode.values.list\")}</MenuItem>\r\n            </TextField>\r\n          </FormControl>\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('hiddenAttributes') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('hiddenAttributes', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.hiddenAttributes.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.hiddenAttributes.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          {/*<FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"pageSize\"\r\n              label={t(\"scenes.nodeSettings.fields.pageSize.label\")}\r\n              variant=\"outlined\"\r\n              type=\"number\"\r\n              value={watch('pageSize') || \"\"}\r\n              onChange={({target}) => setValue('pageSize', Number(target.value))}\r\n            />\r\n          </FormControl>*/}\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            options={Object.keys(downloadFormats(t))}\r\n            getOptionLabel={option => downloadFormats(t)[option].label}\r\n            value={watch('downloadFormats') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip\r\n                  variant=\"outlined\"\r\n                  label={downloadFormats(t)[option].label}\r\n                  {...getTagProps({index})}\r\n                />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('downloadFormats', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.downloadFormats.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.downloadFormats.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n        </Box>\r\n      </div>\r\n    </Box>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodesConfig.node\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchNodesConfigNode(nodeId)),\r\n  sendConfigCreate: config => dispatch(sendNodesConfigNodeCreate(config)),\r\n  sendConfig: config => dispatch(sendNodesConfigNodeEdit(config)),\r\n  clearConfig: () => dispatch(clearNodesConfigNode())\r\n});\r\n\r\nconst NodeSettingsForm = ({config, nodeId, fetchConfig, sendConfigCreate, sendConfig, clearConfig}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(nodeId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, nodeId]);\r\n\r\n  return ((nodeId === null || config) && (\r\n    <Form\r\n      config={nodeId === null ? undefined : config}\r\n      ref={ref}\r\n      onSubmit={nodeId === null ? sendConfigCreate : sendConfig}\r\n      onCancel={clearConfig}\r\n    />\r\n  ));\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(NodeSettingsForm);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  getCreateTemplateUrl,\r\n  getCreateViewUrl,\r\n  getDatasetDownloadUrl,\r\n  getDatasetStructureCodelistsUrl,\r\n  getDatasetStructureCodelistUrl,\r\n  getDatasetStructureDynamicCodelistUrl,\r\n  getDatasetStructureUrl,\r\n  getDatasetUrl,\r\n  getGeometryUrl\r\n} from \"../../serverApi/urls\";\r\nimport {getCriteriaArrayFromObject} from \"../../utils/criteria\";\r\n\r\nexport const DATASET_STRUCTURE_FETCH_ENABLE = \"dataset/structure/fetch/enable\";\r\nexport const DATASET_STRUCTURE_FETCH = \"dataset/structure/fetch\";\r\nexport const DATASET_FETCH_ENABLE = \"dataset/fetch/enable\";\r\nexport const DATASET_FETCH = \"dataset/fetch\";\r\nexport const DATASET_ACCESSIBLE_FETCH = \"dataset/accessible/fetch\";\r\nexport const DATASET_CRITERIA_LENGTH_WARNING_SHOW = \"dataset/criteria/length/warning/show\";\r\nexport const DATASET_CRITERIA_LENGTH_WARNING_HIDE = \"dataset/criteria/length/warning/hide\";\r\nexport const DATASET_CRITERIA_SHOW = \"dataset/criteria/show\";\r\nexport const DATASET_CRITERIA_HIDE = \"dataset/criteria/hide\";\r\nexport const DATASET_CRITERIA_ALERT_HIDE = \"dataset/criteria/alert/hide\";\r\nexport const DATASET_STRUCTURE_CODELIST_FETCH = \"dataset/structure/codelist/fetch\";\r\nexport const DATASET_STRUCTURE_CODELISTS_FETCH = \"dataset/structure/codelists/fetch\";\r\nexport const DATASET_STRUCTURE_CODELIST_CRITERIA_SET = \"dataset/structure/codelist/criteria/set\";\r\nexport const DATASET_STRUCTURE_CODELIST_TIME_PERIOD_SET = \"dataset/structure/codelist/timePeriod/set\";\r\n\r\nexport const DATASET_STATE_BACKUP = \"dataset/state/backup\";\r\nexport const DATASET_STATE_RESET = \"dataset/state/reset\";\r\n\r\nexport const DATASET_VIEWER_SET = \"dataset/viewer/set\";\r\n\r\nexport const DATASET_TABLE_LAYOUT_SUBMIT = \"dataset/table/layout/submit\";\r\nexport const DATASET_MAP_LAYOUT_SUBMIT = \"dataset/map/layout/submit\";\r\nexport const DATASET_CHART_LAYOUT_SUBMIT = \"dataset/chart/layout/submit\";\r\n\r\nexport const DATASET_LABEL_FORMAT_SET = \"dataset/label/format/set\";\r\n\r\nexport const DATASET_DOWNLOAD_SUBMIT = \"dataset/download/submit\";\r\nexport const DATASET_DOWNLOAD_WARNING_HIDE = \"dataset/download/warning/hide\";\r\n\r\nexport const DATASET_VIEW_TEMPLATE_SHOW = \"dataset/view/template/show\";\r\nexport const DATASET_VIEW_TEMPLATE_HIDE = \"dataset/view/template/hide\";\r\nexport const DATASET_VIEW_TEMPLATE_SUBMIT = \"dataset/view/template/submit\";\r\nexport const DATASET_VIEW_ERROR_HIDE = \"dataset/view/error/hide\";\r\n\r\nexport const DATASET_UNAVAILABLE_VIEW_WARNING_HIDE = \"dataset/unavailable/view/warning/hide\";\r\n\r\nexport const DATASET_HTML_GENERATING_TIME_SET = \"dataset/html/generating/time/set\";\r\n\r\nexport const DATASET_TERRITORY_FETCH = \"dataset/territory/fetch\";\r\n\r\nexport const ALL_FULL = \"FullAll\"\r\nexport const ALL_PARTIAL = \"PartialAll\"\r\nexport const STEP_BY_STEP_FULL = \"FullStep\"\r\nexport const STEP_BY_STEP_PARTIAL = \"PartialStep\"\r\nexport const STEP_BY_STEP_DYNAMIC = \"Dynamic\"\r\n\r\nexport const CRITERIA_SELECTION_MODE_STEP_BY_STEP = \"stepByStep\"\r\nexport const CRITERIA_SELECTION_MODE_ALL = \"all\"\r\n\r\nexport const CRITERIA_SELECTION_TYPE_FULL = \"full\"\r\nexport const CRITERIA_SELECTION_TYPE_PARTIAL = \"partial\"\r\nexport const CRITERIA_SELECTION_TYPE_DYNAMIC = \"dynamic\"\r\n\r\nconst ENDPOINT_STRING_LENGTH = 100;\r\nconst MAX_CRITERIA_STRING_LENGTH = 2000;\r\n\r\nexport const enableDatasetStructureFetch = (nodeCode: string, categoryPath: string[], datasetId: string, viewId: string) => ({\r\n  type: DATASET_STRUCTURE_FETCH_ENABLE,\r\n  payload: {\r\n    datasetId: datasetId,\r\n    nodeCode: nodeCode,\r\n    categoryPath: categoryPath,\r\n    viewId: viewId\r\n  }\r\n});\r\n\r\nexport const fetchDatasetStructure = (nodeId: number, datasetId: string, viewId: string, isAccessible: boolean, defaultLanguage: string, languages: string[]) => initRequest(\r\n  DATASET_STRUCTURE_FETCH,\r\n  getDatasetStructureUrl(nodeId, datasetId, viewId),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDatasetStructure\")\r\n  }),\r\n  {\r\n    viewId: viewId,\r\n    isAccessible: isAccessible,\r\n    defaultLanguage: defaultLanguage,\r\n    languages: languages\r\n  }\r\n);\r\n\r\nexport const enableDatasetFetch = () => ({\r\n  type: DATASET_FETCH_ENABLE\r\n});\r\n\r\nexport const fetchDataset = (nodeId: number, datasetId: string, criteria: any, datasetTitle: string, checkCriteriaLength: boolean, tableLayout: any, chartLayout: any, mapLayout: any, maxAllowedCells: number, hasAnnotationLayout: boolean) => {\r\n  return (checkCriteriaLength && ((JSON.stringify(criteria).length + ENDPOINT_STRING_LENGTH) > MAX_CRITERIA_STRING_LENGTH))\r\n    ? {\r\n      type: DATASET_CRITERIA_LENGTH_WARNING_SHOW\r\n    }\r\n    : initRequest(\r\n      DATASET_FETCH,\r\n      getDatasetUrl(nodeId, datasetId),\r\n      RequestMethod.POST,\r\n      getCriteriaArrayFromObject(criteria),\r\n      t => ({\r\n        onStart: t(\"scenes.dataset.actions.fetchingDataset\", {title: datasetTitle})\r\n      }),\r\n      {\r\n        tableLayout: tableLayout,\r\n        chartLayout: chartLayout,\r\n        mapLayout: mapLayout,\r\n        maxAllowedCells: maxAllowedCells,\r\n        hasAnnotationLayout: hasAnnotationLayout\r\n      },\r\n      \"\",\r\n      (statusCode: number) => statusCode === 413\r\n    );\r\n};\r\n\r\nexport const fetchAccessibleDataset = (nodeId: number, datasetId: string, criteria: any, datasetTitle: string) => initRequest(\r\n  DATASET_ACCESSIBLE_FETCH,\r\n  getDatasetDownloadUrl(nodeId, datasetId, \"csv\"),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.fetchingDataset\", {title: datasetTitle})\r\n  })\r\n);\r\n\r\nexport const hideDatasetCriteriaLengthWarning = () => ({\r\n  type: DATASET_CRITERIA_LENGTH_WARNING_HIDE\r\n});\r\n\r\nexport const showDatasetCriteria = () => ({\r\n  type: DATASET_CRITERIA_SHOW\r\n});\r\n\r\nexport const hideDatasetCriteria = () => ({\r\n  type: DATASET_CRITERIA_HIDE\r\n});\r\n\r\nexport const hideDatasetCriteriaAlert = () => ({\r\n  type: DATASET_CRITERIA_ALERT_HIDE\r\n});\r\n\r\nexport const fetchDatasetStructureCodelist = (nodeId: number, datasetId: string, dimensionId: string, type: string, criteria: any) => {\r\n\r\n  let flatCriteria = getCriteriaArrayFromObject(criteria);\r\n  // @ts-ignore\r\n  flatCriteria = flatCriteria.filter(({id}) => id !== dimensionId)\r\n\r\n  return type === CRITERIA_SELECTION_TYPE_DYNAMIC\r\n    ? (\r\n      initRequest(\r\n        DATASET_STRUCTURE_CODELIST_FETCH,\r\n        getDatasetStructureDynamicCodelistUrl(nodeId, datasetId, dimensionId),\r\n        RequestMethod.POST,\r\n        flatCriteria,\r\n        t => ({\r\n          onStart: t(\"scenes.dataset.actions.fetchingCodelist\")\r\n        })\r\n      )\r\n    )\r\n    : (\r\n      initRequest(\r\n        DATASET_STRUCTURE_CODELIST_FETCH,\r\n        getDatasetStructureCodelistUrl(nodeId, datasetId, dimensionId, type === CRITERIA_SELECTION_TYPE_FULL),\r\n        undefined,\r\n        undefined,\r\n        t => ({\r\n          onStart: t(\"scenes.dataset.actions.fetchingCodelist\")\r\n        })\r\n      )\r\n    );\r\n};\r\n\r\nexport const fetchDatasetStructureCodelists = (nodeId: number, datasetId: string, type: string) => initRequest(\r\n  DATASET_STRUCTURE_CODELISTS_FETCH,\r\n  getDatasetStructureCodelistsUrl(nodeId, datasetId, type === CRITERIA_SELECTION_TYPE_FULL),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.fetchingCodelists\")\r\n  })\r\n);\r\n\r\nexport const setDatasetStructureCodelistCriteria = (criteria: any) => ({\r\n  type: DATASET_STRUCTURE_CODELIST_CRITERIA_SET,\r\n  criteria\r\n});\r\n\r\nexport const setDatasetStructureCodelistTimePeriod = (timePeriod: any) => ({\r\n  type: DATASET_STRUCTURE_CODELIST_TIME_PERIOD_SET,\r\n  timePeriod\r\n});\r\n\r\nexport const backupDatasetState = () => ({\r\n  type: DATASET_STATE_BACKUP\r\n});\r\n\r\nexport const resetDatasetState = () => ({\r\n  type: DATASET_STATE_RESET\r\n});\r\n\r\nexport const setDatasetViewer = (viewerIdx: number) => ({\r\n  type: DATASET_VIEWER_SET,\r\n  viewerIdx\r\n});\r\n\r\nexport const submitDatasetTableLayout = (layout: any) => ({\r\n  type: DATASET_TABLE_LAYOUT_SUBMIT,\r\n  layout\r\n});\r\n\r\nexport const submitDatasetMapLayout = (layout: any) => ({\r\n  type: DATASET_MAP_LAYOUT_SUBMIT,\r\n  layout\r\n});\r\n\r\nexport const submitDatasetChartLayout = (layout: any) => ({\r\n  type: DATASET_CHART_LAYOUT_SUBMIT,\r\n  layout\r\n});\r\n\r\nexport const setDatasetLabelFormat = (labelFormat: string) => ({\r\n  type: DATASET_LABEL_FORMAT_SET,\r\n  labelFormat\r\n});\r\n\r\nexport const submitDatasetDownload = (nodeId: number, datasetId: string, datasetTitle: string, criteria: any, format: string, extension: string, zipped?: boolean) => initRequest(\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  getDatasetDownloadUrl(nodeId, datasetId, format, zipped),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.downloadingDataset\")\r\n  }),\r\n  {\r\n    fileSave: {\r\n      name: `${datasetTitle}.${extension}`,\r\n      type: \"text/plain;charset=utf-8\"\r\n    }\r\n  },\r\n  \"\",\r\n  (statusCode: number) => statusCode === 406,\r\n  undefined,\r\n  undefined,\r\n  format === \"jsondata\"\r\n);\r\n\r\nexport const hideDatasetDownloadWarning = () => ({\r\n  type: DATASET_DOWNLOAD_WARNING_HIDE\r\n});\r\n\r\nexport const showDatasetViewTemplate = (isView: boolean) => ({\r\n  type: DATASET_VIEW_TEMPLATE_SHOW,\r\n  isView\r\n});\r\n\r\nexport const hideDatasetViewTemplate = (isView: boolean) => ({\r\n  type: DATASET_VIEW_TEMPLATE_HIDE,\r\n  isView\r\n});\r\n\r\nexport const submitDatasetViewTemplate = (nodeId: number, viewTemplate: any, isView: boolean) => initRequest(\r\n  DATASET_VIEW_TEMPLATE_SUBMIT,\r\n  isView\r\n    ? getCreateViewUrl(nodeId)\r\n    : getCreateTemplateUrl(nodeId),\r\n  RequestMethod.POST,\r\n  viewTemplate,\r\n  t => ({\r\n    onStart: isView\r\n      ? t(\"scenes.dataset.actions.savingView\")\r\n      : t(\"scenes.dataset.actions.savingTemplate\")\r\n  }),\r\n  {\r\n    isView: isView\r\n  },\r\n  \"\",\r\n  (statusCode: number) => statusCode === 409,\r\n);\r\n\r\nexport const hideDatasetViewError = () => ({\r\n  type: DATASET_VIEW_ERROR_HIDE\r\n});\r\n\r\nexport const hideDatasetUnavailableViewWarning = () => ({\r\n  type: DATASET_UNAVAILABLE_VIEW_WARNING_HIDE\r\n});\r\n\r\nexport const setDatasetHtmlGeneratingTime = (time: number) => ({\r\n  type: DATASET_HTML_GENERATING_TIME_SET,\r\n  time\r\n});\r\n\r\n\r\nexport const fetchDatasetGeometries = (idList: string[], t: any) => initRequest(\r\n  DATASET_TERRITORY_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dataset.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    t\r\n  }\r\n);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getClearNodeCatalogMemoryCacheUrl,\r\n    getDataflowsCacheListUrl,\r\n    getDataflowsCacheUpdateUrl,\r\n    getDataflowsClearAllCacheUrl,\r\n    getDataflowsClearCacheUrl,\r\n    getDataflowsCreateCacheUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const DATAFLOW_CACHE_FETCH = \"cache/fetch\";\r\nexport const DATAFLOW_CACHE_CLEAR = \"cache/clear\";\r\nexport const DATAFLOW_CACHE_UPDATE = \"cache/update\";\r\nexport const DATAFLOW_CACHE_CREATE = \"cache/create\";\r\nexport const DATAFLOW_CACHE_DELETE = \"cache/delete\";\r\nexport const DATAFLOW_CACHE_DELETE_ALL = \"cache/deleteAll\";\r\nexport const DATAFLOW_CACHE_DELETE_CATALOG = \"cache/deleteCatalog\";\r\n\r\n\r\nexport const fetchDataflowCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_FETCH,\r\n  getDataflowsCacheListUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.cacheSettings.messages.fetchDataflowCache.start\")\r\n  })\r\n);\r\n\r\nexport const updateDataflowCache = (nodeId: number, cacheId: string, ttl: number) => initRequest(\r\n  DATAFLOW_CACHE_UPDATE,\r\n  getDataflowsCacheUpdateUrl(nodeId, cacheId),\r\n  RequestMethod.PUT,\r\n  {ttl: ttl},\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.updateDataflowCache.start\")\r\n  }),\r\n  {\r\n    ttl: ttl,\r\n    nodeId: nodeId,\r\n    cacheId: cacheId\r\n  }\r\n);\r\n\r\nexport const createDataflowCache = (nodeId: number, data:any) => initRequest(\r\n    DATAFLOW_CACHE_CREATE,\r\n    getDataflowsCreateCacheUrl(nodeId),\r\n    RequestMethod.POST,\r\n    data,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.cacheSettings.messages.createDataflowCache.start\")\r\n    }),\r\n    {\r\n      oldData: data,\r\n    }\r\n);\r\n\r\nexport const deleteDataflowCache = (nodeId: number, cacheId: string) => initRequest(\r\n  DATAFLOW_CACHE_DELETE,\r\n  getDataflowsClearCacheUrl(nodeId, cacheId),\r\n  RequestMethod.POST,\r\n  {},\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteDataflowCache.start\")\r\n  }),\r\n  {\r\n    nodeId: nodeId,\r\n    cacheId: cacheId\r\n  }\r\n);\r\n\r\nexport const clearDataflowCache = () => ({\r\n  type: DATAFLOW_CACHE_CLEAR\r\n});\r\n\r\nexport const deleteAllDataflowCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_DELETE_ALL,\r\n  getDataflowsClearAllCacheUrl(nodeId),\r\n  RequestMethod.POST,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteAllDataflowCache.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n\r\nexport const deleteCatalogCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_DELETE_CATALOG,\r\n  getClearNodeCatalogMemoryCacheUrl(nodeId),\r\n  RequestMethod.POST,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteCatalogCache.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n","import React, {forwardRef, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport CheckIcon from \"@material-ui/icons/Check\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport ArrowUpwardIcon from \"@material-ui/icons/ArrowUpward\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {\r\n  clearDataflowCache,\r\n  createDataflowCache,\r\n  deleteAllDataflowCache,\r\n  deleteCatalogCache,\r\n  deleteDataflowCache,\r\n  fetchDataflowCache,\r\n  updateDataflowCache\r\n} from \"../../../../state/cache/cacheActions\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport {Checkbox, withStyles, withTheme} from \"@material-ui/core\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\n\r\n\r\nconst tableIcons = {\r\n  Delete: forwardRef((props, ref) => <DeleteIcon {...props} ref={ref}/>),\r\n  Edit: forwardRef((props, ref) => <EditIcon {...props} ref={ref}/>),\r\n  Check: forwardRef((props, ref) => <CheckIcon {...props} ref={ref}/>),\r\n  Clear: forwardRef((props, ref) => <ClearIcon {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <ClearIcon {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpwardIcon {...props} ref={ref}/>),\r\n  Search: forwardRef((props, ref) => <SearchIcon {...props} ref={ref}/>),\r\n  Add: forwardRef((props, ref) => <AddIcon {...props} ref={ref}/>)\r\n};\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.cacheConfig\r\n});\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchCache: nodeId => dispatch(fetchDataflowCache(nodeId)),\r\n  clearCache: () => dispatch(clearDataflowCache()),\r\n  updateCache: (nodeId, cacheId, ttl) => dispatch(updateDataflowCache(nodeId, cacheId, ttl)),\r\n  createCache: (nodeId, data) => dispatch(createDataflowCache(nodeId, data)),\r\n  deleteFromCache: (nodeId, cacheId) => dispatch(deleteDataflowCache(nodeId, cacheId)),\r\n  deleteAllFromCache: (nodeId) => dispatch(deleteAllDataflowCache(nodeId)),\r\n  deleteCatalogCache: (nodeId) => dispatch(deleteCatalogCache(nodeId))\r\n});\r\n\r\n\r\nconst SECONDS_PER_DAY = 86400;\r\nconst SECONDS_PER_HOUR = 3600;\r\n\r\n\r\n/**\r\n * Convert seconds to HH:MM:SS\r\n * If seconds exceeds 24 hours, hours will be greater than 24 (30:05:10)\r\n *\r\n * @param {number} seconds\r\n * @returns {string}\r\n */\r\nconst secondsToHms = (totalSeconds) => {\r\n\r\n  if (!totalSeconds) {\r\n    return \"0 s\";\r\n  }\r\n\r\n  var days = Math.floor(totalSeconds / SECONDS_PER_DAY);\r\n  var hours = Math.floor((totalSeconds - (days * SECONDS_PER_DAY)) / SECONDS_PER_HOUR);\r\n  var minutes = Math.floor((totalSeconds - (days * SECONDS_PER_DAY) - (hours * SECONDS_PER_HOUR)) / 60);\r\n  var seconds = totalSeconds - (days * SECONDS_PER_DAY) - (hours * SECONDS_PER_HOUR) - (minutes * 60);\r\n\r\n  // round seconds\r\n  seconds = Math.round(seconds * 100) / 100\r\n\r\n  return wellFormattedTimeString(days, hours, minutes, seconds);\r\n};\r\n\r\nconst wellFormattedTimeString = (days, hours, mins, sec) => {\r\n  var result = \"\";\r\n  result += (days > 0 ? days + \"d \" : \"\"); // hide days if 0\r\n  result += (hours < 10 ? \" \" + hours : hours) + \"h \";\r\n  result += (mins < 10 ? \" \" + mins : mins) + \"m \";\r\n\r\n  if (days === 0) { // truncate if days is greater than zero\r\n    result += (sec < 10 ? \" \" + sec : sec) + \"s\";\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nconst CacheSettingsForm = ({classes, config, nodeId, fetchCache, createCache, updateCache, clearCache, deleteFromCache, deleteAllFromCache, deleteCatalogCache}, ref) => {\r\n//const CacheSettingsForm = compose(withStyles(styles), forwardRef)(({classes, config, nodeId, fetchCache, updateCache, clearCache, deleteFromCache}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null && (!config || config.length === 0));\r\n  const [hideEmptyDataflowCache, setEmptyDataflowCacheHidden] = useState(true);\r\n  const [emptyRowsCounter, setEmptyRowsCounter] = useState(0);\r\n  const [rowsCounter, setRowsCounter] = useState(0);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (!config || config.length === 0) {\r\n      setRowsCounter(0);\r\n      setEmptyRowsCounter(0);\r\n      return;\r\n    }\r\n    setRowsCounter(config.length);\r\n    setEmptyRowsCounter(config.filter(val => val?.cacheSize === 0).length);\r\n  }, [config]);\r\n\r\n  useEffect(() => {\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchCache(nodeId);\r\n    }\r\n\r\n\r\n  }, [config, fetchCache, nodeId, needConfig, setNeedConfig]);\r\n  /*\r\n      const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n          defaultValues: {\r\n              ...config\r\n          }\r\n      });\r\n  */\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      f();\r\n    },\r\n    cancel(f) {\r\n      clearCache();\r\n      f();\r\n    }\r\n  }));\r\n\r\n\r\n  return (\r\n\r\n    <Grid container>\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n\r\n            <Grid container spacing={2}>\r\n\r\n\r\n              <Grid item xs={4}>\r\n                <FormControl fullWidth>\r\n                  <Button container style={{marginRight: 24}} size=\"large\" variant=\"contained\"\r\n                          color=\"primary\" onClick={() => deleteCatalogCache(nodeId)}>\r\n                    {t(\"scenes.nodeSettings.cacheSettings.deleteCatalogCache\")}\r\n                  </Button>\r\n                </FormControl>\r\n              </Grid>\r\n              {/* <Grid item xs={4}>\r\n                                <FormControl fullWidth>\r\n                                    <Button size=\"large\" variant=\"contained\" color=\"primary\"\r\n                                            onClick={window.notImplemented.show}>\r\n                                        Refresh catalog cache\r\n                                    </Button>\r\n                                </FormControl>\r\n                            </Grid>\r\n                            <Grid item xs={4}/>*/}\r\n            </Grid>\r\n          </Paper>\r\n\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={1}>\r\n              <Grid item xs={4}>\r\n                <FormControl fullWidth>\r\n                  <Button container style={{marginRight: 24}} size=\"large\" variant=\"contained\"\r\n                          color=\"primary\" onClick={() => deleteAllFromCache(nodeId)}>\r\n                    {t(\"scenes.nodeSettings.cacheSettings.deleteAllDataflowCache\")}\r\n                  </Button>\r\n                </FormControl>\r\n              </Grid>\r\n              {/*<Grid item xs={4} >*/}\r\n              {/*    <FormControl fullWidth>*/}\r\n              {/*        <Button disabled size=\"large\" variant=\"contained\" color=\"primary\"*/}\r\n              {/*                onClick={window.notImplemented.show}>*/}\r\n              {/*            Refresh dataflow cache*/}\r\n              {/*        </Button>*/}\r\n              {/*    </FormControl>*/}\r\n              {/*</Grid>*/}\r\n              <Grid item xs={4}/>\r\n              <Grid item xs={4}/>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.nodeSettings.cacheSettings.hideEmptyEntries\")}\r\n                    control={\r\n                      <Checkbox\r\n                        name=\"active\"\r\n                        required\r\n                        disabled={emptyRowsCounter === 0 || rowsCounter === 0}\r\n                        checked={hideEmptyDataflowCache}\r\n                        onChange={(e, value) => setEmptyDataflowCacheHidden(value)}\r\n                      />\r\n                    }\r\n                  />\r\n                  {/*<FormHelperText>*/}\r\n                  {/*    { (!hideEmptyDataflowCache? \"Hide\" : \"Show\") + \" cache entries which size is 0 Kb.\" }*/}\r\n                  {/*</FormHelperText>*/}\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <CustomMaterialTable\r\n                components={{\r\n                  Container: Box\r\n                }}\r\n                icons={tableIcons}\r\n                columns={[\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowTitle\"),\r\n                    field: \"title\",\r\n                    editable: 'never'\r\n                  },\r\n                  /*{title: \"Title\", field: \"dataflowId\", editable: 'never'},*/\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowValidity\"),\r\n                    field: \"ttl\",\r\n                    type: \"numeric\",\r\n                    editable: 'onUpdate',\r\n                    render: rowData => secondsToHms(rowData.ttl)\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowFiles\"),\r\n                    field: \"cachedDataflow\",\r\n                    type: \"numeric\",\r\n                    editable: 'never'\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowSize\"),\r\n                    field: \"cacheSize\",\r\n                    type: \"numeric\",\r\n                    editable: 'never',\r\n                    render: rowData => rowData.cacheSize + \" Kb\"\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowAccess\"),\r\n                    field: \"cachedDataAccess\",\r\n                    type: \"numeric\",\r\n                    editable: 'never'\r\n                  }\r\n\r\n                ]}\r\n                data={config?.filter(val => !hideEmptyDataflowCache || val.cacheSize > 0) || []}\r\n                editable={{\r\n                  onRowUpdate: (newData, oldData) =>\r\n                    new Promise((resolve, reject) => {\r\n                      if (newData.ttl < 0) { // invalid ttl\r\n                        reject();\r\n                        return;\r\n                      }\r\n\r\n                      if (newData.ttl === oldData.ttl) { //no update is needed here\r\n                        resolve();\r\n                        return;\r\n                      }\r\n\r\n                      const dataUpdate = [...config];\r\n                      const index = oldData.tableData.id;\r\n                      dataUpdate[index] = newData;\r\n\r\n                      if (!newData.id || newData.id === '00000000-0000-0000-0000-000000000000') {\r\n                        createCache(nodeId, newData);\r\n                      } else {\r\n                        updateCache(nodeId, newData.id, newData.ttl)\r\n                      }\r\n\r\n\r\n                      // config([...dataUpdate]);\r\n\r\n                      resolve();\r\n                    }),\r\n                  onRowDelete: oldData =>\r\n                    new Promise((resolve, reject) => {\r\n                      const dataDelete = [...config];\r\n                      const index = oldData.tableData.id;\r\n                      dataDelete.splice(index, 1);\r\n\r\n                      //data does not exists. no need to make a server call\r\n                      if (!oldData.id || oldData.id === '00000000-0000-0000-0000-000000000000') {\r\n                        resolve();\r\n                        return;\r\n                      }\r\n\r\n                      deleteFromCache(nodeId, oldData.id)\r\n                      //setCacheConfig([...dataDelete]);\r\n\r\n                      resolve();\r\n                    }),\r\n                }}\r\n                /*actions={[\r\n                  {\r\n                    icon: EditIcon,\r\n                    tooltip: 'Edit node',\r\n                    onClick: (_, {id}) => {window.notImplemented.show();}\r\n                  },\r\n                  {\r\n                    icon: DeleteIcon,\r\n                    tooltip: 'Delete node',\r\n                    onClick: (_, {id}) => {window.notImplemented.show();}\r\n                  }]}\r\n                 */\r\n                options={{\r\n                  paging: false,\r\n                  draggable: true,\r\n                  actionsColumnIndex: -1,\r\n                  searchFieldAlignment: \"left\",\r\n                  //maxBodyHeight: 400,\r\n                  showTitle: false\r\n                }}\r\n                localization={{\r\n                  body: {\r\n                    editRow: {\r\n                      deleteText: t(\"scenes.nodesSettings.cacheSettings.modals.deleteDataflowCache.title\")\r\n                    },\r\n                    editTooltip: t(\"scenes.nodeSettings.cacheSettings.table.actions.editRow\"),\r\n                    deleteTooltip: t(\"scenes.nodeSettings.cacheSettings.table.actions.deleteRow\")\r\n                  }\r\n                }}\r\n              />\r\n            </Grid>\r\n\r\n          </Paper>\r\n\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n\r\n\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), withTheme, compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}),\r\n  forwardRef))(CacheSettingsForm);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getDeleteTemplateUrl, getNodeTemplatesUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_TEMPLATES_CONFIG_FETCH = \"nodeTemplatesConfig/fetch\";\r\nexport const NODE_TEMPLATES_CONFIG_CLEAR = \"nodeTemplatesConfig/clear\";\r\nexport const NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE = \"nodeTemplatesConfig/deleteTemplate\";\r\n\r\nexport const fetchNodeTemplatesConfig = (nodeId: number) => initRequest(\r\n  NODE_TEMPLATES_CONFIG_FETCH,\r\n  getNodeTemplatesUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.templatesSettings.fetchConfig.start\")\r\n  })\r\n);\r\n\r\nexport const clearNodeTemplatesConfig = () => ({\r\n  type: NODE_TEMPLATES_CONFIG_CLEAR\r\n});\r\n\r\nexport const deleteNodeTemplatesConfigTemplate = (nodeId: number, id: number) => initRequest(\r\n  NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE,\r\n  getDeleteTemplateUrl(nodeId, id),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.templatesSettings.deleteTemplate.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {Visibility} from \"@material-ui/icons\";\r\nimport {\r\n  clearNodeTemplatesConfig,\r\n  deleteNodeTemplatesConfigTemplate,\r\n  fetchNodeTemplatesConfig\r\n} from \"../../../../state/noteTemplatesConfig/nodeTemplatesConfigActions\";\r\nimport {goToData} from \"../../../../links\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  templates: state.nodeTemplatesConfig.templates\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchTemplates: nodeId => dispatch(fetchNodeTemplatesConfig(nodeId)),\r\n  deleteTemplate: (nodeId, id) => dispatch(deleteNodeTemplatesConfigTemplate(nodeId, id)),\r\n  clearTemplates: () => dispatch(clearNodeTemplatesConfig())\r\n});\r\n\r\nconst TemplatesSettingsForm = ({\r\n                                 classes,\r\n                                 defaultLanguage,\r\n                                 languages,\r\n                                 nodes,\r\n                                 nodeId,\r\n                                 defaultNodeOpen,\r\n                                 templates,\r\n                                 fetchTemplates,\r\n                                 deleteTemplate,\r\n                                 clearTemplates,\r\n                                 onTemplatesClose\r\n                               }, ref) => {\r\n\r\n  const [needTemplates, setNeedTemplates] = useState(true);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needTemplates) {\r\n      setNeedTemplates(false);\r\n      fetchTemplates(nodeId);\r\n    }\r\n  }, [templates, needTemplates, setNeedTemplates, fetchTemplates, nodeId]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearTemplates();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [deleteTemplateId, setDeleteTemplateId] = useState(null);\r\n\r\n  return templates && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"datasetId\",\r\n            title: t(\"scenes.nodeSettings.templatesSettings.table.columns.datasetId\")\r\n          },\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.nodeSettings.templatesSettings.table.columns.templateName\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          }\r\n        ]}\r\n        data={templates}\r\n        actions={[\r\n          {\r\n            icon: Visibility,\r\n            tooltip: t(\"scenes.nodeSettings.templatesSettings.table.actions.viewData\"),\r\n            onClick: (_, {nodeId, datasetId}) => {\r\n              const nodeCode = nodes.find(node => node.nodeId === nodeId).code.toLowerCase();\r\n              return (window.location.href.toLowerCase().includes(nodeCode) && window.location.href.toLowerCase().includes(datasetId.toLowerCase()))\r\n                ? onTemplatesClose()\r\n                : goToData(nodeCode, [], datasetId)\r\n            }\r\n\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.nodeSettings.templatesSettings.table.actions.deleteTemplate\"),\r\n            onClick: (_, {viewTemplateId}) => setDeleteTemplateId(viewTemplateId)\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 3,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteTemplateId !== null}\r\n      >\r\n        <DialogTitle> {t(\"scenes.nodeSettings.templatesSettings.modals.deleteTemplate.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.nodeSettings.templatesSettings.modals.deleteTemplate.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setDeleteTemplateId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteTemplate(nodeId, deleteTemplateId);\r\n            setDeleteTemplateId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(TemplatesSettingsForm);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearNodePermissionsConfig,\r\n  fetchNodePermissionsConfig,\r\n  sendNodePermissionsConfig\r\n} from \"../../../../state/nodePermissionsConfig/nodePermissionsConfigActions\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport {useForm} from \"react-hook-form\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst PERMISSIONS = [\r\n  \"ManageCache\",\r\n  \"ManageTemplate\",\r\n  \"ManageConfig\"\r\n];\r\n\r\nconst getPermissionsTranslations = t => ({\r\n  ManageCache: t(\"scenes.nodeSettings.permissions.table.columns.manageCache\"),\r\n  ManageTemplate: t(\"scenes.nodeSettings.permissions.table.columns.manageTemplate\"),\r\n  ManageConfig: t(\"scenes.nodeSettings.permissions.table.columns.manageConfig\")\r\n});\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, nodeId, onSubmit, onCancel}, ref) => {\r\n\r\n  const {register, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      config: config?.map((user, index) => {\r\n        let res = {...user};\r\n        PERMISSIONS.forEach(p => {\r\n          res[p] = config[index].permission.includes(`${p}_SingleNode_${nodeId}`) === true;\r\n        });\r\n        return res;\r\n      })\r\n    }\r\n  });\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    if (config) {\r\n      config.forEach((user, index) =>\r\n        PERMISSIONS.forEach(p =>\r\n          register({name: `config[${index}].${p}`})))\r\n    }\r\n  }, [register, config]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n\r\n        const data = val.config.map((userVal, index) => {\r\n          let res = {\r\n            userId: config[index].userId,\r\n            nodePermissions: []\r\n          };\r\n          PERMISSIONS.forEach(p => {\r\n            if (userVal[p] === true) {\r\n              res.nodePermissions.push(p);\r\n            }\r\n          });\r\n          res.tableData = undefined;\r\n          return res;\r\n        });\r\n\r\n        onSubmit(nodeId, data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return config && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"firstName\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userFirstName\")\r\n          },\r\n          {\r\n            field: \"lastName\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userLastName\")\r\n          },\r\n          {\r\n            field: \"organization\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userOrganization\")\r\n          },\r\n          {\r\n            field: \"email\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userEmail\")\r\n          },\r\n          ...PERMISSIONS.map(p => ({\r\n            title: getPermissionsTranslations(t)[p],\r\n            render: ({tableData}) =>\r\n              <Grid container justify=\"center\">\r\n                <Grid item>\r\n                  <Checkbox\r\n                    checked={watch(`config[${tableData.id}].${p}`)}\r\n                    onChange={(ev, value) => setValue(`config[${tableData.id}].${p}`, value)}\r\n                  />\r\n                </Grid>\r\n              </Grid>\r\n          }))\r\n        ]}\r\n        data={config}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          searchFieldAlignment: \"left\",\r\n          maxBodyHeight: 400,\r\n          showTitle: false\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n    </Fragment>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodePermissionsConfig.permissions\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchNodePermissionsConfig(nodeId)),\r\n  sendConfig: (nodeId, config) => dispatch(sendNodePermissionsConfig(nodeId, config)),\r\n  clearConfig: () => dispatch(clearNodePermissionsConfig())\r\n});\r\n\r\nconst PermissionsSettingsForm = ({config, nodeId, fetchConfig, sendConfig, clearConfig}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(nodeId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, nodeId]);\r\n\r\n  return ((nodeId === null || config) && (\r\n    <Form\r\n      nodeId={nodeId}\r\n      config={nodeId === null ? undefined : config}\r\n      ref={ref}\r\n      onSubmit={sendConfig}\r\n      onCancel={clearConfig}\r\n    />\r\n  ));\r\n};\r\n\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(PermissionsSettingsForm);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getNodePermissionsConfigGetUrl, getNodePermissionsConfigPutUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_PERMISSIONS_CONFIG_FETCH = \"nodePermissionsConfig/fetch\";\r\nexport const NODE_PERMISSIONS_CONFIG_CLEAR = \"nodePermissionsConfig/clear\";\r\nexport const NODE_PERMISSIONS_CONFIG_SEND = \"nodePermissionsConfig/send\";\r\n\r\nexport const fetchNodePermissionsConfig = (nodeId: number) => initRequest(\r\n    NODE_PERMISSIONS_CONFIG_FETCH,\r\n    getNodePermissionsConfigGetUrl(nodeId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.permissionsSettings.fetchConfig.start\")\r\n    })\r\n);\r\n\r\nexport const sendNodePermissionsConfig = (nodeId: number, config: any) => initRequest(\r\n    NODE_PERMISSIONS_CONFIG_SEND,\r\n    getNodePermissionsConfigPutUrl(nodeId),\r\n    RequestMethod.PUT,\r\n    config,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.permissionsSettings.sendConfig.start\")\r\n    })\r\n);\r\n\r\nexport const clearNodePermissionsConfig = () => ({\r\n    type: NODE_PERMISSIONS_CONFIG_CLEAR\r\n});\r\n","import React, {forwardRef} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport DashboardsManager from \"../../../dashboards-manager\";\r\nimport {\r\n  addNodesConfigDashboardsNodeDashboard,\r\n  clearAllNodesConfigNodeDashboards,\r\n  clearNodesConfigNodeDashboards,\r\n  fetchAllNodeConfigDashboards,\r\n  fetchNodesConfigNodeDashboards,\r\n  removeNodesConfigDashboardsNodeDashboard,\r\n  sendNodesConfigDashboardsNodeOrders\r\n} from \"../../../../state/nodesConfig/nodesConfigActions\";\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.hubConfig.hub,\r\n  user: state.user,\r\n  dashboards: state.nodesConfig.nodeDashboards,\r\n  allDashboards: state.nodesConfig.allDashboards\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboards: nodeId => dispatch(fetchNodesConfigNodeDashboards(nodeId)),\r\n  fetchAllDashboards: () => dispatch(fetchAllNodeConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearNodesConfigNodeDashboards()),\r\n  clearAllDashboards: () => dispatch(clearAllNodesConfigNodeDashboards()),\r\n  addDashboard: (nodeId, dashboardId) => dispatch(addNodesConfigDashboardsNodeDashboard(nodeId, dashboardId)),\r\n  removeDashboard: (nodeId, dashboardId) => dispatch(removeNodesConfigDashboardsNodeDashboard(nodeId, dashboardId)),\r\n  sendDashboardsOrders: (nodeId, dashboardsIds) => dispatch(sendNodesConfigDashboardsNodeOrders(nodeId, dashboardsIds))\r\n});\r\n\r\nconst DashboardsSettingsForm = ({\r\n                                  dashboards,\r\n                                  allDashboards,\r\n                                  fetchDashboards,\r\n                                  fetchAllDashboards,\r\n                                  clearDashboards,\r\n                                  clearAllDashboards,\r\n                                  addDashboard,\r\n                                  removeDashboard,\r\n                                  sendDashboardsOrders,\r\n                                  nodeId\r\n                                }, ref) =>\r\n  <DashboardsManager\r\n    dashboards={dashboards}\r\n    allDashboards={allDashboards}\r\n    fetchDashboards={() => fetchDashboards(nodeId)}\r\n    fetchAllDashboards={fetchAllDashboards}\r\n    clearDashboards={clearDashboards}\r\n    clearAllDashboards={clearAllDashboards}\r\n    addDashboard={dashboardId => addDashboard(nodeId, dashboardId)}\r\n    removeDashboard={dashboardId => removeDashboard(nodeId, dashboardId)}\r\n    sendDashboardsOrders={dashboardsIds => sendDashboardsOrders(nodeId, dashboardsIds)}\r\n    ref={ref}\r\n  />;\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(DashboardsSettingsForm);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useRef, useState} from 'react';\r\nimport NodeSettingsForm from \"./node-settings-form\";\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport SettingsDialog from \"../../settings-dialog\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {\r\n  clearNodesConfigNodes,\r\n  closeNodesConfig,\r\n  deleteNodesConfigNode,\r\n  fetchNodesConfigNodes,\r\n  sendNodesConfigNodesOrder\r\n} from \"../../../state/nodesConfig/nodesConfigActions\";\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {compose} from \"redux\";\r\nimport CacheSettingsForm from \"./cache-setting-form/index\";\r\nimport TemplatesSettingsForm from \"./templates-settings-form\";\r\nimport {\r\n  canCreateNode,\r\n  canDeleteNodes,\r\n  canDisplayCacheSettingForm,\r\n  canDisplayPermissionsSettingsForm,\r\n  canDisplayTemplatesSettingsForm,\r\n  canEditNode,\r\n  canManageNodeDashboards,\r\n  canSortNodes\r\n} from \"../../../utils/user\";\r\nimport PermissionsSettingsForm from \"./permissions-settings-form\";\r\nimport PersonIcon from '@material-ui/icons/Person';\r\nimport DashboardIcon from \"@material-ui/icons/Dashboard\";\r\nimport DashboardsSettingsForm from \"./dashboards-settings-form\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../utils/i18n\";\r\nimport \"./style.css\";\r\nimport {MTableToolbar} from \"material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodesConfig.nodes,\r\n  user: state.user,\r\n  language: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: () => dispatch(fetchNodesConfigNodes()),\r\n  sendOrders: orderedIds => dispatch(sendNodesConfigNodesOrder(orderedIds)),\r\n  deleteNode: nodeId => dispatch(deleteNodesConfigNode(nodeId)),\r\n  clearConfig: () => dispatch(clearNodesConfigNodes()),\r\n  onClose: () => dispatch(closeNodesConfig())\r\n});\r\n\r\nconst NodesSettingsForm = ({\r\n                             classes,\r\n                             defaultNodeOpen,\r\n                             config,\r\n                             fetchConfig,\r\n                             sendOrders,\r\n                             deleteNode,\r\n                             clearConfig,\r\n                             nodes,\r\n                             user,\r\n                             onClose,\r\n                             language,\r\n                             languages,\r\n                             onNodesClose\r\n                           }, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearConfig();\r\n      onClose();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [isNodeFormVisible, setNodeFormVisibility] = useState(defaultNodeOpen || false);\r\n  const [nodeFormNodeId, setNodeFormNodeId] = useState(null);\r\n  const [nodeDeleteFormNodeId, setNodeDeleteFormNodeId] = useState(null);\r\n  const [cacheFormNodeId, setCacheFormNodeId] = useState(null);\r\n  const [isCacheFormVisible, setCacheFormVisibility] = useState(false);\r\n  const [templatesNodeId, setTemplatesNodeId] = useState(null);\r\n  const [permissionsNodeId, setPermissionsNodeId] = useState(null);\r\n  const [dashboardsNodeId, setDashboardsNodeId] = useState(null);\r\n\r\n  const nodeFormRef = useRef();\r\n  const cacheFormRef = useRef();\r\n  const templatesRef = useRef();\r\n  const permissionsRef = useRef();\r\n  const dashboardsRef = useRef();\r\n\r\n  const allowedNodes = (config || []).filter(({nodeId}) =>\r\n    canCreateNode(user) ||\r\n    canSortNodes(user) ||\r\n    canDisplayCacheSettingForm(user, nodeId) ||\r\n    canDisplayTemplatesSettingsForm(user, nodeId) ||\r\n    canDisplayPermissionsSettingsForm(user) ||\r\n    canEditNode(user, nodeId) ||\r\n    canDeleteNodes(user)\r\n  );\r\n  const orderedNodes = (allowedNodes || []).sort((a, b) => a.order - b.order)\r\n  const orderedNodesIds = orderedNodes.map(({nodeId}) => nodeId);\r\n\r\n  const moveUp = rowIndex =>\r\n    sendOrders([\r\n      ...orderedNodesIds.slice(0, rowIndex - 1),\r\n      orderedNodesIds[rowIndex],\r\n      orderedNodesIds[rowIndex - 1],\r\n      ...orderedNodesIds.slice(rowIndex + 1)\r\n    ]);\r\n\r\n  const moveDown = rowIndex =>\r\n    sendOrders([\r\n      ...orderedNodesIds.slice(0, rowIndex),\r\n      orderedNodesIds[rowIndex + 1],\r\n      orderedNodesIds[rowIndex],\r\n      ...orderedNodesIds.slice(rowIndex + 2)\r\n    ]);\r\n\r\n  return config && (\r\n    <Fragment>\r\n      <Box className=\"nodes-settings-form__table\">\r\n        <CustomMaterialTable\r\n          components={{\r\n            Container: Box,\r\n            Toolbar: props =>\r\n              <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n                <Grid item>\r\n                  <MTableToolbar {...props} />\r\n                </Grid>\r\n                {canCreateNode(user) && (\r\n                  <Grid item>\r\n                    <Button\r\n                      size=\"small\"\r\n                      startIcon={<AddIcon/>}\r\n                      onClick={() => {\r\n                        setNodeFormNodeId(null);\r\n                        setNodeFormVisibility(true);\r\n                        setCacheFormVisibility(false);\r\n                      }}>\r\n                      {t(\"scenes.nodesSettings.createNode\")}\r\n                    </Button>\r\n                  </Grid>\r\n                )}\r\n              </Grid>\r\n          }}\r\n          columns={[\r\n            {\r\n              field: \"code\",\r\n              title: t(\"scenes.nodesSettings.table.columns.nodeCode\")\r\n            },\r\n            {\r\n              field: \"title\",\r\n              title: t(\"scenes.nodesSettings.table.columns.nodeName\"),\r\n              render: ({title}) => localizeI18nObj(title, language, languages),\r\n              customFilterAndSearch: getI18nObjCustomFilterAndSearch(language, languages)\r\n            },\r\n            {\r\n              field: \"active\",\r\n              title: t(\"scenes.nodesSettings.table.columns.isNodeActive.title\"),\r\n              render: ({active}) =>\r\n                active\r\n                  ? t(\"scenes.nodesSettings.table.columns.isNodeActive.values.true\")\r\n                  : t(\"scenes.nodesSettings.table.columns.isNodeActive.values.false\")\r\n            }\r\n          ]}\r\n          data={orderedNodes}\r\n          actions={[\r\n            ({tableData}) =>\r\n              canSortNodes(user)\r\n                ? {\r\n                  icon: ArrowDropUpIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeOrderMoveUp\"),\r\n                  onClick: (_, {tableData}) => moveUp(tableData.id), // tableData.id is the rowIndex\r\n                  disabled: tableData.id === 0\r\n                }\r\n                : null,\r\n            ({tableData}) =>\r\n              canSortNodes(user)\r\n                ? {\r\n                  icon: ArrowDropDownIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeOrderMoveDown\"),\r\n                  onClick: (_, {tableData}) => moveDown(tableData.id), // tableData.id is the rowIndex\r\n                  disabled: tableData.id === config.length - 1\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canDisplayCacheSettingForm(user, nodeId)\r\n                ? {\r\n                  icon: () =>\r\n                    <div className={classes.buttonAction}>\r\n                      {t(\"scenes.nodesSettings.table.actions.nodeDataflowsCache.label\")}\r\n                    </div>,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeDataflowsCache.tooltip\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setCacheFormNodeId(nodeId);\r\n                    setNodeFormVisibility(false);\r\n                    setCacheFormVisibility(true);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canDisplayTemplatesSettingsForm(user, nodeId)\r\n                ? {\r\n                  icon: () =>\r\n                    <div className={classes.buttonAction}>\r\n                      {t(\"scenes.nodesSettings.table.actions.nodeTemplates.label\")}\r\n                    </div>,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeTemplates.tooltip\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setTemplatesNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            () =>\r\n              canDisplayPermissionsSettingsForm(user)\r\n                ? {\r\n                  icon: PersonIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodePermissions\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setPermissionsNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canManageNodeDashboards(user, nodeId)\r\n                ? {\r\n                  icon: DashboardIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeDashboards\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setDashboardsNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canEditNode(user, nodeId)\r\n                ? {\r\n                  icon: EditIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.editNode\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setNodeFormNodeId(nodeId);\r\n                    setNodeFormVisibility(true);\r\n                    setCacheFormVisibility(false);\r\n                  }\r\n                }\r\n                : null,\r\n            () =>\r\n              canDeleteNodes(user)\r\n                ? {\r\n                  icon: DeleteIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.deleteNode\"),\r\n                  onClick: (_, {nodeId}) => setNodeDeleteFormNodeId(nodeId)\r\n                }\r\n                : null\r\n          ]}\r\n          options={{\r\n            paging: false,\r\n            draggable: true,\r\n            actionsColumnIndex: 3,\r\n            searchFieldAlignment: \"left\",\r\n            maxBodyHeight: 400,\r\n            showTitle: false\r\n          }}\r\n          icons={tableIcons}\r\n        />\r\n      </Box>\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.editNode\")}\r\n        open={isNodeFormVisible}\r\n        onClose={() => {\r\n          if (nodeFormRef.current) {\r\n            nodeFormRef.current.cancel(() => {\r\n              setNodeFormVisibility(false);\r\n              setNodeFormNodeId(null);\r\n            });\r\n          } else {\r\n            setNodeFormVisibility(false);\r\n            setNodeFormNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (nodeFormRef.current) {\r\n            nodeFormRef.current.submit(() => {\r\n              setNodeFormVisibility(false);\r\n              setNodeFormNodeId(null);\r\n            });\r\n          } else {\r\n            setNodeFormVisibility(false);\r\n            setNodeFormNodeId(null);\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <NodeSettingsForm ref={nodeFormRef} nodeId={nodeFormNodeId}/>\r\n\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeCache\", {nodeCode: config.find(node => node.nodeId === cacheFormNodeId)?.code})}\r\n        open={isCacheFormVisible}\r\n        onClose={() => {\r\n          if (cacheFormRef.current) {\r\n            cacheFormRef.current.cancel(() => {\r\n              setCacheFormVisibility(false);\r\n              setCacheFormNodeId(null);\r\n            });\r\n          } else {\r\n            setCacheFormVisibility(false);\r\n            setCacheFormNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (cacheFormRef.current) {\r\n            cacheFormRef.current.submit(() => {\r\n              setCacheFormVisibility(false);\r\n              setCacheFormNodeId(null);\r\n            });\r\n          } else {\r\n            setCacheFormVisibility(false);\r\n            setCacheFormNodeId(null);\r\n          }\r\n        }}\r\n        false\r\n      >\r\n        <CacheSettingsForm ref={cacheFormRef} nodeId={cacheFormNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeTemplates\", {nodeCode: config.find(node => node.nodeId === templatesNodeId)?.code})}\r\n        open={templatesNodeId !== null}\r\n        onClose={() => {\r\n          if (templatesRef.current) {\r\n            templatesRef.current.cancel(() => setTemplatesNodeId(null));\r\n          } else {\r\n            setTemplatesNodeId(null);\r\n          }\r\n        }}\r\n        maxWidth=\"md\"\r\n      >\r\n        <TemplatesSettingsForm\r\n          ref={templatesRef}\r\n          nodeId={templatesNodeId}\r\n          nodes={config}\r\n          onTemplatesClose={() => {\r\n            setTemplatesNodeId(null);\r\n            onNodesClose();\r\n          }}\r\n        />\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodePermissions\", {nodeCode: config.find(node => node.nodeId === permissionsNodeId)?.code})}\r\n        open={permissionsNodeId !== null}\r\n        onClose={() => {\r\n          if (permissionsRef.current) {\r\n            permissionsRef.current.cancel(() => {\r\n              setPermissionsNodeId(null);\r\n            });\r\n          } else {\r\n            setPermissionsNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (permissionsRef.current) {\r\n            permissionsRef.current.submit(() => {\r\n              setPermissionsNodeId(null);\r\n            });\r\n          } else {\r\n            setPermissionsNodeId(null);\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <PermissionsSettingsForm ref={permissionsRef} nodeId={permissionsNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeDashboards\", {nodeCode: config.find(node => node.nodeId === dashboardsNodeId)?.code})}\r\n        open={dashboardsNodeId !== null}\r\n        onClose={() => {\r\n          if (dashboardsRef.current) {\r\n            dashboardsRef.current.destroy(() => {\r\n              setDashboardsNodeId(null);\r\n            });\r\n          } else {\r\n            setDashboardsNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (dashboardsRef.current) {\r\n            dashboardsRef.current.destroy(() => {\r\n              setDashboardsNodeId(null);\r\n            });\r\n          } else {\r\n            setDashboardsNodeId(null);\r\n          }\r\n        }}\r\n      >\r\n        <DashboardsSettingsForm ref={dashboardsRef} nodeId={dashboardsNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={nodeDeleteFormNodeId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.nodesSettings.modals.nodeDelete.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.nodesSettings.modals.nodeDelete.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setNodeDeleteFormNodeId(null);\r\n            setCacheFormNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteNode(nodeDeleteFormNodeId);\r\n            setNodeDeleteFormNodeId(null);\r\n            setCacheFormNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(NodesSettingsForm);","import React, {forwardRef, useEffect, useImperativeHandle, useRef, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport SettingsDialog from \"../../settings-dialog\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {compose} from \"redux\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport UserSettingsForm from \"./user-settings-form\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUsersConfigUsers,\r\n  deleteUsersConfigUser,\r\n  fetchUsersConfigUsers,\r\n  hideUserConfigForm,\r\n  showUserConfigForm\r\n} from \"../../../state/usersConfig/usersConfigActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {MTableToolbar} from \"material-table\";\r\nimport \"./style.css\";\r\nimport {localizeI18nObj} from \"../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.users,\r\n  userErrors: state.usersConfig.userErrors,\r\n  userId: state.usersConfig.userId,\r\n  appConfig: state.appConfig,\r\n  languages: state.app.languages,\r\n  language: state.app.language\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: () => dispatch(fetchUsersConfigUsers()),\r\n  deleteUser: userId => dispatch(deleteUsersConfigUser(userId)),\r\n  clearConfig: () => dispatch(clearUsersConfigUsers()),\r\n  onUserFormShow: userId => dispatch(showUserConfigForm(userId)),\r\n  onUserFormHide: () => dispatch(hideUserConfigForm())\r\n});\r\n\r\nconst UsersSettingsForm = ({classes, config, fetchConfig, deleteUser, clearConfig, users, userErrors, userId, onUserFormShow, onUserFormHide, appConfig, languages, language}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearConfig();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [userDeleteFormUserId, setUserDeleteFormUserId] = useState(null);\r\n\r\n  const userFormRef = useRef();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return config && (\r\n    <div className=\"users-settings-form__table\">\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n          Toolbar: props =>\r\n            <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n              <Grid item>\r\n                <MTableToolbar {...props} />\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  size=\"small\"\r\n                  startIcon={<AddIcon/>}\r\n                  onClick={() => onUserFormShow(-1)}>\r\n                  {t(\"scenes.usersSettings.createUser\")}\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n        }}\r\n        columns={[\r\n          {field: \"firstName\", title: t(\"scenes.usersSettings.table.columns.userFirstName\")},\r\n          {field: \"lastName\", title: t(\"scenes.usersSettings.table.columns.userLastName\")},\r\n          {\r\n            field: \"type\",\r\n            title: t(\"scenes.usersSettings.table.columns.type\"),\r\n            render: ({type}) => localizeI18nObj(appConfig?.user?.typeOptions?.find(({id}) => type === id)?.label, language, languages)\r\n          },\r\n          {field: \"organization\", title: t(\"scenes.usersSettings.table.columns.userOrganization\")},\r\n          {field: \"email\", title: t(\"scenes.usersSettings.table.columns.userEmail\")},\r\n          {\r\n            field: \"isActive\",\r\n            title: t(\"scenes.usersSettings.table.columns.isActive.title\"),\r\n            render: ({isActive}) =>\r\n              isActive\r\n                ? t(\"scenes.usersSettings.table.columns.isActive.values.true\")\r\n                : t(\"scenes.usersSettings.table.columns.isActive.values.false\")\r\n          }\r\n        ]}\r\n        data={config}\r\n        actions={[\r\n          {\r\n            icon: EditIcon,\r\n            tooltip: t(\"scenes.usersSettings.table.actions.editUser\"),\r\n            onClick: (_, {userId}) => {\r\n              onUserFormShow(userId);\r\n            }\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.usersSettings.table.actions.deleteUser\"),\r\n            onClick: (_, {userId}) => {\r\n              setUserDeleteFormUserId(userId);\r\n            }\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 5,\r\n          searchFieldAlignment: \"left\",\r\n          maxBodyHeight: 400,\r\n          showTitle: false\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n      <SettingsDialog\r\n        title={\r\n          userId === -1\r\n            ? t(\"scenes.usersSettings.modals.createUser\")\r\n            : t(\"scenes.usersSettings.modals.editUser\")\r\n        }\r\n        maxWidth={\"sm\"}\r\n        open={userId !== null || userErrors !== null}\r\n        onClose={() => {\r\n          if (userFormRef.current) {\r\n            userFormRef.current.cancel(() => {\r\n              onUserFormHide();\r\n            });\r\n          } else {\r\n            onUserFormHide();\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (userFormRef.current) {\r\n            userFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <UserSettingsForm ref={userFormRef} userId={userId}/>\r\n      </SettingsDialog>\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={userDeleteFormUserId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.usersSettings.modals.deleteUser.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.usersSettings.modals.deleteUser.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setUserDeleteFormUserId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteUser(userDeleteFormUserId);\r\n            setUserDeleteFormUserId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}),\r\n  forwardRef\r\n)(UsersSettingsForm);","import React, {Fragment} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport AppSettingsForm from \"./app-settings-form\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport NodesSettingsForm from \"./nodes-settings-form\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {clearMemoryCache, downloadQueryLog} from \"./actions\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport Input from \"@material-ui/core/Input\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport UsersSettingsForm from \"./users-settings-form\";\r\nimport {\r\n  canDisplayAppSettingsForm,\r\n  canDisplayNodesSettingsForm,\r\n  canDisplayUsersSettingsForm,\r\n  canGetQueryLog\r\n} from \"../../utils/user\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  option: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onLogDownload: limit => dispatch(downloadQueryLog(limit)),\r\n  onCacheClear: () => dispatch(clearMemoryCache())\r\n});\r\n\r\nclass SettingsSelect extends React.Component {\r\n\r\n  state = {\r\n    isAppOpen: false,\r\n    isNodesOpen: false,\r\n    isUsersOpen: false,\r\n    appSettingsRef: React.createRef(),\r\n    nodesSettingsRef: React.createRef(),\r\n    usersSettingsRef: React.createRef(),\r\n    isLogDownloadOpen: false,\r\n    logLimit: 5,\r\n  };\r\n\r\n  onAppOpen = () => this.setState({\r\n    ...this.state,\r\n    isAppOpen: true\r\n  });\r\n\r\n  onAppClose = showSnackbar => this.setState({\r\n    ...this.state,\r\n    isAppOpen: false,\r\n    isAppSubmitSnackbarVisible: showSnackbar || false\r\n  });\r\n\r\n  onNodesOpen = () => this.setState({\r\n    ...this.state,\r\n    isNodesOpen: true\r\n  });\r\n\r\n  onNodesClose = () => this.setState({\r\n    ...this.state,\r\n    isNodesOpen: false\r\n  });\r\n\r\n  onUsersOpen = () => this.setState({\r\n    ...this.state,\r\n    isUsersOpen: true\r\n  });\r\n\r\n  onUsersClose = () => this.setState({\r\n    ...this.state,\r\n    isUsersOpen: false\r\n  });\r\n\r\n  onLogDownloadOpen = () => this.setState({\r\n    ...this.state,\r\n    isLogDownloadOpen: true\r\n  });\r\n\r\n  onLogDownloadClose = () => this.setState({\r\n    ...this.state,\r\n    isLogDownloadOpen: false,\r\n    logLimit: 5\r\n  });\r\n\r\n  onLogLimitSet = logLimit => {\r\n    if (!isNaN(logLimit)) {\r\n      this.setState({\r\n        ...this.state,\r\n        logLimit: logLimit\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      onLogDownload,\r\n      nodes,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {\r\n      isAppOpen,\r\n      isNodesOpen,\r\n      isUsersOpen,\r\n      appSettingsRef,\r\n      nodesSettingsRef,\r\n      usersSettingsRef,\r\n      isLogDownloadOpen,\r\n      logLimit\r\n    } = this.state;\r\n\r\n    return (\r\n      <Fragment>\r\n        <ButtonSelect value=\"\" icon={<SettingsIcon/>}>\r\n          {canDisplayAppSettingsForm(user) && (\r\n            <div onClick={this.onAppOpen} className={classes.option}>{t(\"components.header.settings.app\")}</div>\r\n          )}\r\n          {canDisplayUsersSettingsForm(user) && (\r\n            <div onClick={this.onUsersOpen} className={classes.option}>{t(\"components.header.settings.users\")}</div>\r\n          )}\r\n          {canDisplayNodesSettingsForm(user) && (\r\n            <div onClick={this.onNodesOpen} className={classes.option}>{t(\"components.header.settings.nodes\")}</div>\r\n          )}\r\n          {canGetQueryLog(user) && (\r\n            <div onClick={this.onLogDownloadOpen}\r\n                 className={classes.option}>{t(\"components.header.settings.queriesLog\")}</div>\r\n          )}\r\n          {/*{canClearServerCache(user) && (\r\n            <div onClick={onCacheClear}\r\n                 className={classes.option}>{t(\"components.header.settings.clearServerCache\")}</div>\r\n          )}*/}\r\n        </ButtonSelect>\r\n        <SettingsDialog\r\n          title={t(\"scenes.appSettings.title\")}\r\n          open={isAppOpen}\r\n          onClose={() => {\r\n            if (appSettingsRef.current) {\r\n              appSettingsRef.current.cancel(() => this.onAppClose());\r\n            } else {\r\n              this.onAppClose();\r\n            }\r\n          }}\r\n          onSubmit={() => {\r\n            if (appSettingsRef.current) {\r\n              appSettingsRef.current.submit(() => {\r\n                this.onAppClose();\r\n              });\r\n            } else {\r\n              this.onAppClose();\r\n            }\r\n          }}\r\n          hasSubmit\r\n        >\r\n          <AppSettingsForm ref={appSettingsRef}/>\r\n        </SettingsDialog>\r\n        <SettingsDialog\r\n          title={t(\"scenes.nodesSettings.title\")}\r\n          open={isNodesOpen}\r\n          onClose={() => {\r\n            if (nodesSettingsRef.current) {\r\n              nodesSettingsRef.current.cancel(() => this.onNodesClose());\r\n            } else {\r\n              this.onNodesClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <NodesSettingsForm ref={nodesSettingsRef} nodes={nodes} onNodesClose={this.onNodesClose}/>\r\n        </SettingsDialog>\r\n\r\n        <SettingsDialog\r\n          title={t(\"scenes.usersSettings.title\")}\r\n          open={isUsersOpen}\r\n          onClose={() => {\r\n            if (usersSettingsRef.current) {\r\n              usersSettingsRef.current.cancel(() => this.onUsersClose());\r\n            } else {\r\n              this.onUsersClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <UsersSettingsForm ref={usersSettingsRef}/>\r\n        </SettingsDialog>\r\n\r\n        <Dialog\r\n          open={isLogDownloadOpen}\r\n          onClose={this.onLogDownloadClose}\r\n        >\r\n          <DialogContent>\r\n            <Grid container spacing={2} style={{width: 400}}>\r\n              <Grid item xs={12}>\r\n                <div>{t(\"components.header.settings.queriesLogModal.content\")}:</div>\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <Input\r\n                  value={logLimit}\r\n                  onChange={ev => this.onLogLimitSet(ev.target.value)}\r\n                  style={{width: \"100%\"}}\r\n                />\r\n              </Grid>\r\n            </Grid>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={this.onLogDownloadClose}>\r\n              {t(\"commons.confirm.cancel\")}\r\n            </Button>\r\n            <Button\r\n              autoFocus\r\n              onClick={() => {\r\n                this.onLogDownloadClose()\r\n                onLogDownload(logLimit);\r\n              }}\r\n              color=\"primary\">\r\n              {t(\"commons.confirm.download\")}\r\n            </Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(SettingsSelect);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getClearMemoryCacheUrl, getQueryLog} from \"../../serverApi/urls\";\r\n\r\nexport const QUERY_LOG_DOWNLOAD = \"query/log/download\";\r\nexport const MEMORY_CACHE_CLEAR = \"memory/cache/clear\";\r\n\r\nexport const downloadQueryLog = limit => initRequest(\r\n  QUERY_LOG_DOWNLOAD,\r\n  getQueryLog(limit),\r\n  RequestMethod.GET,\r\n  null,\r\n  null,\r\n  {\r\n    fileSave: {\r\n      name: \"sdmx-query-log.txt\",\r\n      type: \"text/plain;charset=utf-8\"\r\n    },\r\n    stringifyResponse: true\r\n  }\r\n);\r\n\r\nexport const clearMemoryCache = () => initRequest(\r\n  MEMORY_CACHE_CLEAR,\r\n  getClearMemoryCacheUrl(),\r\n  RequestMethod.POST,\r\n  null,\r\n  t => ({\r\n    onStart: t(\"components.header.settings.clearServerCacheAction.messages.clear.start\")\r\n  })\r\n);\r\n","import React, {useRef} from 'react';\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\n\r\nconst styles = theme => ({\r\n  button: {\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: \"#f5f5f5\",\r\n    borderColor: theme.palette.primary.main,\r\n    borderWidth: 1,\r\n    position: \"relative\",\r\n    height: 35,\r\n  },\r\n  icon: {\r\n    width: theme.spacing(6),\r\n    height: 35,\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    position: 'absolute',\r\n    width: `calc(100% - ${theme.spacing(6)})`,\r\n    left: theme.spacing(6)\r\n  },\r\n  inputInput: {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n  }\r\n});\r\n\r\nconst SearchInput = ({classes, query = \"\", onSubmit}) => {\r\n\r\n  const input = useRef(null);\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <div className={classes.button} style={{width: 320}}>\r\n      <label htmlFor=\"search-input\" style={{display: \"none\"}}>\r\n        {t(\"components.searchInput.label\")}\r\n      </label>\r\n      <TextField\r\n        id=\"search-input\"\r\n        fullWidth\r\n        size=\"small\"\r\n        variant=\"outlined\"\r\n        placeholder={t(\"components.searchInput.placeholder\")}\r\n        defaultValue={query}\r\n        InputProps={{\r\n          startAdornment:\r\n            <InputAdornment position=\"start\">\r\n              <SearchIcon/>\r\n            </InputAdornment>,\r\n          inputRef: input,\r\n        }}\r\n        onKeyDown={\r\n          e => {\r\n            if (e.key === \"Enter\" && input.current.value && input.current.value.length > 0) {\r\n              e.preventDefault();\r\n              onSubmit(input.current.value);\r\n            }\r\n          }\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(SearchInput);","import React, {useState} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {fade, withStyles} from \"@material-ui/core\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport SearchInput from \"../search-input\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  button: {\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.15),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.25),\r\n    },\r\n    position: \"relative\",\r\n    height: 35,\r\n  },\r\n  icon: {\r\n    width: theme.spacing(6),\r\n    height: 35,\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    position: 'absolute',\r\n    width: `calc(100% - ${theme.spacing(6)})`,\r\n    left: theme.spacing(6)\r\n  },\r\n  inputInput: {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n  }\r\n});\r\n\r\nconst SearchDialog = ({classes, dialogTop, modalWidth, query, onSubmit}) => {\r\n\r\n  const [uuid] = useState(uuidv4());\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  return (\r\n    <div>\r\n      <IconButton color=\"inherit\" onClick={() => setIsOpen(true)}>\r\n        <SearchIcon/>\r\n      </IconButton>\r\n      <Dialog\r\n        open={isOpen}\r\n        onClose={() => setIsOpen(false)}\r\n        onRendered={() => $(`#search-dialog__dialog__${uuid} input`).focus()}\r\n        PaperProps={{\r\n          style: {\r\n            position: \"absolute\",\r\n            top: dialogTop,\r\n            height: 40\r\n          }\r\n        }}\r\n      >\r\n        <div id={`search-dialog__dialog__${uuid}`}>\r\n          <SearchInput\r\n            query={query}\r\n            onSubmit={value => {\r\n              setIsOpen(false);\r\n              onSubmit(value);\r\n            }}\r\n          />\r\n        </div>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(SearchDialog);","export const DASHBOARD_ELEM_TYPE_KEY = \"type\";\r\nexport const DASHBOARD_ELEM_VALUE_KEY = \"value\";\r\nexport const DASHBOARD_ELEM_WIDTH_KEY = \"widthPercentage\";\r\nexport const DASHBOARD_ELEM_SHOW_TITLE_KEY = \"showTitle\";\r\nexport const DASHBOARD_ELEM_ENABLE_FILTERS_KEY = \"enableFilters\";\r\nexport const DASHBOARD_ELEM_FILTER_DIMENSION_KEY = \"filterDimension\";\r\n\r\nexport const DASHBOARD_ELEM_TYPE_VALUE_VIEW = \"view\";\r\nexport const DASHBOARD_ELEM_TYPE_VALUE_TEXT = \"text\";\r\n\r\nexport const emptyDashboardElem = {\r\n  [DASHBOARD_ELEM_TYPE_KEY]: null,\r\n  [DASHBOARD_ELEM_VALUE_KEY]: null,\r\n  [DASHBOARD_ELEM_WIDTH_KEY]: 100,\r\n  [DASHBOARD_ELEM_SHOW_TITLE_KEY]: true,\r\n  [DASHBOARD_ELEM_ENABLE_FILTERS_KEY]: false,\r\n  [DASHBOARD_ELEM_FILTER_DIMENSION_KEY]: null\r\n};\r\n\r\nexport const getViewIdxFromRowAndCol = (rowIdx, colIdx) => `${rowIdx}+${colIdx}`;\r\n\r\nexport const getFilterDimensionId = (layout, filterDimensionIds) => {\r\n  const dimArraysKey = [\"rows\", \"cols\", \"filters\", \"sections\", \"primaryDim\", \"secondaryDim\", \"territoryDim\"];\r\n  let viewDims = [];\r\n\r\n  dimArraysKey.forEach(key => viewDims = viewDims.concat(layout[key] || []));\r\n\r\n  return (filterDimensionIds.find(dimId => viewDims.includes(dimId)) || null);\r\n};","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  getCreateDashboardUrl,\r\n  getDashboardsUrl,\r\n  getDatasetUrl,\r\n  getDeleteDashboardUrl,\r\n  getDeleteViewUrl,\r\n  getGeometryUrl,\r\n  getUpdateDashboardUrl,\r\n  getUserDashboardsUrl,\r\n  getViewsUrl\r\n} from \"../../serverApi/urls\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY\r\n} from \"../../utils/dashboards\";\r\nimport {getCriteriaArrayFromObject} from \"../../utils/criteria\";\r\nimport _ from \"lodash\"\r\nimport filters from \"../../dummy/filters.json\";\r\n\r\nexport const OTHER_CONFIG_VIEWS_FETCH = \"otherConfig/fetchViews\";\r\nexport const OTHER_CONFIG_VIEWS_CLEAR = \"otherConfig/clearViews\";\r\nexport const OTHER_CONFIG_VIEW_DELETE = \"otherConfig/deleteView\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARDS_FETCH = \"otherConfig/fetchDashboards\";\r\nexport const OTHER_CONFIG_DASHBOARDS_CLEAR = \"otherConfig/clearDashboards\";\r\nexport const OTHER_CONFIG_DASHBOARDS_CLOSE = \"otherConfig/closeDashboards\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_CREATE = \"otherConfig/dashboard/create\";\r\nexport const OTHER_CONFIG_DASHBOARD_UPDATE = \"otherConfig/dashboard/update\";\r\nexport const OTHER_CONFIG_DASHBOARD_CHANGE = \"otherConfig/dashboard/change\";\r\nexport const OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT = \"otherConfig/dashboard/create/submit\";\r\nexport const OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT = \"otherConfig/dashboard/update/submit\";\r\nexport const OTHER_CONFIG_DASHBOARD_HIDE = \"otherConfig/dashboard/hide\";\r\nexport const OTHER_CONFIG_DASHBOARD_DELETE = \"otherConfig/dashboard/create\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_VIEWS_FETCH = \"otherConfig/dashboard/views/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR = \"otherConfig/dashboard/views/clear\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_DATASET_FETCH = \"otherConfig/dashboard/dataset/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH = \"otherConfig/dashboard/map/geometry/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_DATASET_CLEAR = \"otherConfig/dashboard/dataset/clear\";\r\n\r\nexport const fetchOtherConfigViews = () => initRequest(\r\n  OTHER_CONFIG_VIEWS_FETCH,\r\n  getViewsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.viewsConfig.messages.fetchViews.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigViews = () => ({\r\n  type: OTHER_CONFIG_VIEWS_CLEAR\r\n});\r\n\r\nexport const deleteOtherConfigView = (nodeId: number, id: number) => initRequest(\r\n  OTHER_CONFIG_VIEW_DELETE,\r\n  getDeleteViewUrl(nodeId, id),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.viewsConfig.messages.deleteView.start\")\r\n  })\r\n);\r\n\r\nexport const fetchOtherConfigDashboards = () => initRequest(\r\n  OTHER_CONFIG_DASHBOARDS_FETCH,\r\n  getUserDashboardsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboards.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigDashboards = () => ({\r\n  type: OTHER_CONFIG_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const closeOtherConfigDashboard = () => ({\r\n  type: OTHER_CONFIG_DASHBOARDS_CLOSE\r\n});\r\n\r\nexport const createOtherConfigDashboard = (dashboard: any) => ({\r\n  type: OTHER_CONFIG_DASHBOARD_CREATE,\r\n  payload: {\r\n    dashboard: dashboard\r\n  }\r\n});\r\n\r\nexport const updateOtherConfigDashboard = (dashboardId: number) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_UPDATE,\r\n  getDashboardsUrl(dashboardId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboard.start\")\r\n  })\r\n);\r\n\r\nexport const changeOtherConfigDashboard = (dashboard: any) => ({\r\n  type: OTHER_CONFIG_DASHBOARD_CHANGE,\r\n  payload: {\r\n    dashboard: dashboard\r\n  }\r\n});\r\n\r\nconst getNewDashboard = (dashboard: any, dashboardId?: number) => {\r\n  const newDashboard = _.cloneDeep(dashboard);\r\n  const ids: string[] = [];\r\n\r\n  newDashboard.dashboardConfig.forEach((row: any, rowIdx: number) => {\r\n    row.forEach((col: any, colIdx: number) => {\r\n      const type = col[DASHBOARD_ELEM_TYPE_KEY];\r\n      const value = col[DASHBOARD_ELEM_VALUE_KEY];\r\n      const filterDimension = col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY]\r\n\r\n      if (type === DASHBOARD_ELEM_TYPE_VALUE_VIEW && value !== null && value !== undefined && !ids.includes(value)) {\r\n        ids.push(value)\r\n      }\r\n      if (filterDimension === \"\") {\r\n        newDashboard.dashboardConfig[rowIdx][colIdx].filterDimension = null;\r\n      }\r\n    });\r\n  });\r\n\r\n  let newFilterLevels = {};\r\n  filters.labels.forEach((label: string) => {\r\n    newFilterLevels = {\r\n      ...newFilterLevels,\r\n      [label]: (newDashboard.filterLevels[label] || false)\r\n    }\r\n  });\r\n\r\n  return {\r\n    dashboardId: dashboardId,\r\n    title: newDashboard.title,\r\n    dashboardConfig: JSON.stringify(newDashboard.dashboardConfig),\r\n    viewIds: ids,\r\n    filterLevels: JSON.stringify(newFilterLevels)\r\n  }\r\n};\r\n\r\nexport const submitOtherConfigDashboardCreate = (dashboard: any) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT,\r\n  getCreateDashboardUrl(),\r\n  RequestMethod.POST,\r\n  getNewDashboard(dashboard),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.submitDashboardCreate.start\")\r\n  })\r\n);\r\n\r\nexport const submitOtherConfigDashboardUpdate = (dashboardId: number, dashboard: any) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  getUpdateDashboardUrl(dashboardId),\r\n  RequestMethod.PUT,\r\n  getNewDashboard(dashboard, dashboardId),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.submitDashboardUpdate.start\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId\r\n  }\r\n);\r\n\r\nexport const deleteOtherConfigDashboard = (dashboardId: number) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_DELETE,\r\n  getDeleteDashboardUrl(dashboardId),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.deleteDashboard.start\")\r\n  })\r\n);\r\n\r\nexport const hideOtherConfigDashboard = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_HIDE\r\n});\r\n\r\nexport const fetchOtherConfigDashboardViews = () => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_FETCH,\r\n  getViewsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboardViews.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigDashboardViews = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR\r\n});\r\n\r\nexport const fetchOtherConfigDashboardsDataset = (nodeId: number, datasetId: string, criteria: any, requestIds: string[]) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_DATASET_FETCH,\r\n  getDatasetUrl(nodeId, datasetId),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDataset\")\r\n  }),\r\n  {\r\n    requestIds: requestIds,\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const fetchOtherConfigDashboardsMapGeometries = (idList: string[], requestId: string) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dashboard.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    requestId: requestId\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const clearOtherConfigDashboardsDataset = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_DATASET_CLEAR\r\n});","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {Visibility} from \"@material-ui/icons\";\r\nimport {\r\n  clearOtherConfigViews,\r\n  deleteOtherConfigView,\r\n  fetchOtherConfigViews\r\n} from \"../../../state/otherConfig/otherConfigActions\";\r\nimport {goToData} from \"../../../links\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  views: state.otherConfig.views\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchViews: () => dispatch(fetchOtherConfigViews()),\r\n  clearViews: () => dispatch(clearOtherConfigViews()),\r\n  deleteView: (nodeId, id) => dispatch(deleteOtherConfigView(nodeId, id))\r\n});\r\n\r\nconst ViewsSettingsForm = ({\r\n                             classes,\r\n                             defaultLanguage,\r\n                             languages,\r\n                             views,\r\n                             fetchViews,\r\n                             clearViews,\r\n                             deleteView,\r\n                             nodes,\r\n                             onViewsClose\r\n                           }, ref) => {\r\n\r\n  const [needViews, setNeedViews] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needViews) {\r\n      setNeedViews(false);\r\n      fetchViews();\r\n    }\r\n  }, [views, needViews, setNeedViews, fetchViews]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearViews();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [deleteViewId, setDeleteViewId] = useState(null);\r\n  const [deleteViewNodeId, setDeleteViewNodeId] = useState(null);\r\n\r\n  return nodes && views && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"nodeId\",\r\n            title: t(\"scenes.viewsSettings.table.columns.viewNodeId\"),\r\n            render: ({nodeId}) => nodes.find(node => node.nodeId === nodeId).code,\r\n            customFilterAndSearch: (str, {nodeId}) =>\r\n              nodes.find(node => node.nodeId === nodeId).code.toLowerCase()\r\n                .includes(str.toLowerCase())\r\n          },\r\n          {field: \"datasetId\", title: t(\"scenes.viewsSettings.table.columns.viewDatasetId\")},\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.viewsSettings.table.columns.viewTitle\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          },\r\n        ]}\r\n        data={views}\r\n        actions={[\r\n          {\r\n            icon: Visibility,\r\n            tooltip: t(\"scenes.viewsSettings.table.actions.viewView\"),\r\n            onClick: (_, {nodeId, datasetId, viewTemplateId}) => window.location.href.toLowerCase().includes(`view=${viewTemplateId}`)\r\n              ? onViewsClose()\r\n              : goToData(nodes.find(node => node.nodeId === nodeId).code, [], datasetId, viewTemplateId)\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.viewsSettings.table.actions.deleteView\"),\r\n            onClick: (_, {nodeId, viewTemplateId}) => {\r\n              setDeleteViewId(viewTemplateId);\r\n              setDeleteViewNodeId(nodeId);\r\n            }\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 3,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteViewId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.viewsSettings.modals.deleteView.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.viewsSettings.modals.deleteView.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setDeleteViewId(null);\r\n            setDeleteViewNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteView(deleteViewNodeId, deleteViewId);\r\n            setDeleteViewId(null);\r\n            setDeleteViewNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(ViewsSettingsForm);","const $ = window.jQuery;\r\n\r\n/* https://stackoverflow.com/questions/986937/how-can-i-get-the-browsers-scrollbar-sizes */\r\nexport function getScrollBarWidth() {\r\n  const temp = $('<div>').css({visibility: 'hidden', width: 100, overflow: 'scroll'}).appendTo('body');\r\n  const widthWithScroll = $('<div>').css({width: '100%'}).appendTo(temp).outerWidth();\r\n  temp.remove();\r\n  return 100 - widthWithScroll;\r\n}\r\n\r\nexport function getTextWidth(text, element) {\r\n  if (typeof (text) === \"string\" && text.length > 0) {\r\n    element.innerText = text;\r\n    return element.offsetWidth;\r\n  } else {\r\n    return 0;\r\n  }\r\n}\r\n","import React, {Fragment} from 'react';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport \"./style.css\";\r\n\r\nexport const SORT_DIRECTION_ASC = 'SORT_DIRECTION_ASC';\r\nexport const SORT_DIRECTION_DESC = 'SORT_DIRECTION_DESC';\r\n\r\nconst SortButtons = ({\r\n                       value,\r\n                       onChange\r\n                     }) =>\r\n  <Fragment>\r\n    <div className=\"infinite-scroll-table__header__sort-buttons__icon-container\">\r\n      <IconButton\r\n        onClick={() => onChange(value !== SORT_DIRECTION_ASC ? SORT_DIRECTION_ASC : SORT_DIRECTION_DESC)}\r\n        style={{padding: 4, top: -4}}\r\n      >\r\n        {\r\n          value === SORT_DIRECTION_ASC\r\n            ? <ArrowUpwardIcon className=\"infinite-scroll-table__header__icon\"/>\r\n            : <ArrowDownwardIcon className=\"infinite-scroll-table__header__icon\"/>\r\n        }\r\n      </IconButton>\r\n    </div>\r\n  </Fragment>;\r\n\r\nexport default SortButtons;\r\n","export const DEFAULT_TABLE_HEIGHT = 340;\r\nexport const ROW_HEIGHT = 40;\r\nexport const TABLE_TOTAL_BORDER = 2;\r\n\r\nexport const ACTIONS_GUTTER = 4;\r\nexport const ACTION_WIDTH = 24;\r\nexport const CELL_PADDING = 8;\r\nexport const CHECKBOX_WIDTH = 40;\r\nexport const COL_WIDTH_SAFE = 4;\r\nexport const HEADER_CELL_PADDING = 8;\r\nexport const HEADER_CELL_GUTTER = 4;\r\nexport const HEADER_CELL_CONTROLS_GUTTER = 4;\r\nexport const FILTER_BUTTON_WIDTH = 16;\r\nexport const SORT_BUTTON_WIDTH = 16;\r\n\r\nexport const DATA_INDEX_ACTIONS_OBJS = \"_actions\";\r\nexport const DATA_INDEX_FIXED_ACTIONS_OBJS = \"_fixedActions\";\r\nexport const DATA_INDEX_CHECKED = \"_checked\";\r\nexport const DATA_INDEX_RENDERED = \"__rendered\";\r\nexport const DATA_INDEX_ORIGINAL_ROW = \"__originalRow\";\r\nexport const DATA_INDEX_ORIGINAL_TRANSLATED_ROW = \"__originalTranslatedRow\";\r\n\r\nexport const RESIZE_TIMEOUT = 1000;\r\nexport const PAGINATION_TIMEOUT = 500;\r\nexport const VIEW_INDEXES_UPDATE_TIMEOUT = 200;\r\n\r\nexport const MAX_PAGE_SIZE = 200;\r\n\r\nexport const DEFAULT_PAGE_SIZE = Math.floor(MAX_PAGE_SIZE / 3) * 3;\r\nexport const DEFAULT_PAGE_NUM = 1;\r\n\r\nexport const TABLE_PLACEHOLDER_BGCOLOR = \"#fafafa\";\r\n","export const getIndexesFromPaginationParams = (pageSize, pageNum) => ({\r\n  startIdx: pageSize * (pageNum - 1),\r\n  stopIdx: (pageSize * pageNum) - 1\r\n});\r\n\r\nexport const getPaginationParamsFromIndexes = (startIdx, stopIdx, maxIdx) => {\r\n\r\n  const minPageSize = stopIdx - startIdx + 1;\r\n  const maxPageSize = maxIdx + 1;\r\n\r\n  const pageNumForMinPageSize = (stopIdx + 1) / minPageSize;\r\n\r\n  if (Number.isInteger(pageNumForMinPageSize)) {\r\n    return ({\r\n      pageSize: minPageSize,\r\n      pageNum: pageNumForMinPageSize\r\n    });\r\n  } else {\r\n\r\n    for (let pageSize = minPageSize + 1; pageSize <= maxPageSize; pageSize++) {\r\n\r\n      const minPageNum = Math.ceil((stopIdx + 1) / pageSize);\r\n      const maxPageNum = Math.floor((startIdx / pageSize) + 1);\r\n\r\n      for (let pageNum = minPageNum; pageNum <= maxPageNum; pageNum++) {\r\n\r\n        const indexes = getIndexesFromPaginationParams(pageSize, pageNum);\r\n\r\n        if (indexes.startIdx <= startIdx && stopIdx <= indexes.stopIdx) {\r\n          return ({\r\n            pageSize,\r\n            pageNum\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n","import React from 'react';\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst AUTO_SEARCH_INPUT_TIMEOUT = 500;\r\n\r\nclass AutoSearchInput extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      tempValue: props.value || \"\",\r\n      value: props.value || \"\",\r\n      timeout: null\r\n    };\r\n    this.onChange = this.onChange.bind(this);\r\n    this.onClear = this.onClear.bind(this);\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, state) {\r\n\r\n    if (nextProps.value !== undefined && (nextProps.value !== state.value)) {\r\n      if (state.timeout) {\r\n        clearTimeout(state.timeout)\r\n      }\r\n      return ({\r\n        tempValue: null,\r\n        value: nextProps.value\r\n      });\r\n    } else {\r\n      return null;\r\n    }\r\n\r\n  }\r\n\r\n  onClear() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n    this.setState({\r\n      tempValue: null,\r\n      value: \"\",\r\n      timeout: null\r\n    });\r\n    this.props.onSearch(\"\");\r\n  }\r\n\r\n  onChange(value) {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n    this.setState({\r\n      tempValue: value,\r\n      timeout: setTimeout(\r\n        () => {\r\n          this.setState({\r\n            tempValue: null,\r\n            value\r\n          });\r\n          this.props.onSearch(value);\r\n        },\r\n        AUTO_SEARCH_INPUT_TIMEOUT\r\n      ),\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      t,\r\n      placeholder\r\n    } = this.props;\r\n\r\n    const {\r\n      tempValue,\r\n      value\r\n    } = this.state;\r\n\r\n    return (\r\n      <TextField\r\n        value={tempValue !== null ? tempValue : value}\r\n        placeholder={placeholder || (t(\"components.autoSearchInput.placeholder\") + \"...\")}\r\n        onChange={({target}) => this.onChange(target.value)}\r\n        InputProps={{\r\n          startAdornment: (\r\n            <InputAdornment position=\"start\">\r\n              <SearchIcon/>\r\n            </InputAdornment>\r\n          ),\r\n          endAdornment: (\r\n            <InputAdornment position=\"end\">\r\n              <IconButton\r\n                disabled={!value || value.length === 0}\r\n                onClick={this.onClear}\r\n                style={{padding: 6}}\r\n              >\r\n                <ClearIcon fontSize=\"small\"/>\r\n              </IconButton>\r\n            </InputAdornment>\r\n          )\r\n        }}\r\n        style={{width: \"100%\"}}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default withTranslation()(AutoSearchInput);\r\n","import React, {Fragment} from \"react\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport AutoSearchInput from \"../../auto-search-input\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nconst PreHeader = ({\r\n                     t,\r\n                     searchText,\r\n                     onSearch,\r\n                     selectedRowCount,\r\n                     tableActions,\r\n                     renderTableAction,\r\n                     leftActions,\r\n                     rightActions\r\n                   }) =>\r\n  <Grid container style={{marginBottom: 4}}>\r\n    <Grid item xs={6}>\r\n      <Grid container justify=\"space-between\">\r\n        <Grid item>\r\n          {leftActions}\r\n        </Grid>\r\n        <Grid item>\r\n          <Grid container justify=\"flex-end\">\r\n            {tableActions && selectedRowCount > 0 && (\r\n              <Fragment>\r\n                <Grid item style={{padding: \"14px 16px 14px 8px\"}}>\r\n                  {selectedRowCount > 1\r\n                    ? t(\"components.infiniteScrollTable.preHeader.selectedCount_plural\", {selectedRowCount})\r\n                    : t(\"components.infiniteScrollTable.preHeader.selectedCount\", {selectedRowCount})\r\n                  }\r\n                </Grid>\r\n                {tableActions.map((action, index) =>\r\n                  <Grid item key={index}>\r\n                    {renderTableAction(action)}\r\n                  </Grid>\r\n                )}\r\n              </Fragment>\r\n            )}\r\n            {rightActions && (\r\n              <Grid item>\r\n                {rightActions}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n    <Grid item xs={6} style={{padding: \"8px 0\"}}>\r\n      <AutoSearchInput\r\n        value={searchText}\r\n        onSearch={onSearch}\r\n      />\r\n    </Grid>\r\n\r\n  </Grid>;\r\n\r\nexport default withTranslation()(PreHeader);\r\n","import React from \"react\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\n\r\nconst Footer = ({\r\n                  t,\r\n                  isLoading,\r\n                  isHidden,\r\n                  rowNumStart,\r\n                  rowNumEnd,\r\n                  rowCount\r\n                }) =>\r\n  <Grid container justify=\"flex-end\" style={{marginTop: 8}}>\r\n    <Grid item>\r\n      {!isHidden\r\n        ? (\r\n          isLoading\r\n            ? (\r\n              <CircularProgress\r\n                size=\"small\"\r\n                className=\"infinite-scroll-table__footer__spinner\"\r\n                style={{\r\n                  fontSize: 10,\r\n                  width: 13,\r\n                  height: 13,\r\n                  marginRight: 2\r\n                }}\r\n              />\r\n            )\r\n            : t(\"components.infiniteScrollTable.footer.rowCount\", {rowNumStart, rowNumEnd, rowCount})\r\n        )\r\n        : <span/>\r\n      }\r\n    </Grid>\r\n  </Grid>;\r\n\r\nexport default withTranslation()(Footer);\r\n","import React from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"relative\",\r\n    height: \"100%\"\r\n  },\r\n  text: {\r\n    fontStyle: \"italic\",\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%)\"\r\n  },\r\n  image: {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -100%)\",\r\n    paddingBottom: 16\r\n  }\r\n});\r\n\r\nconst CustomEmpty = ({\r\n  t,\r\n                       classes,\r\n                       text,\r\n                       textStyle,\r\n                       width,\r\n                       backgroundColor,\r\n                       color,\r\n                       image\r\n                     }) =>\r\n  <div className={classes.root} style={{width: width || \"100%\", backgroundColor, color}}>\r\n    <div style={{width: width || \"100%\"}}>\r\n      {image && (\r\n        <div className={classes.image}>\r\n          {image}\r\n        </div>\r\n      )}\r\n      <div className={classes.text} style={{...textStyle}}>\r\n        {text || t(\"components.customEmpty.placeholder\")}\r\n      </div>\r\n    </div>\r\n  </div>;\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(CustomEmpty);\r\n","import React, {Fragment, useState} from 'react';\r\nimport \"./style.css\";\r\nimport AutoSearchInput from \"../../auto-search-input\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Popover from \"@material-ui/core/Popover\";\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\n\r\nconst FilterButton = ({\r\n                        value,\r\n                        onChange,\r\n                        options\r\n                      }) => {\r\n\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n\r\n  const handleOpen = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <div className=\"infinite-scroll-table__header__filter-button__icon-container\">\r\n        <IconButton\r\n          onClick={handleOpen}\r\n          style={{padding: 4, top: -4}}\r\n        >\r\n          <FilterListIcon className=\"infinite-scroll-table__header__icon\"/>\r\n        </IconButton>\r\n      </div>\r\n\r\n      <Popover\r\n        open={Boolean(anchorEl)}\r\n        anchorEl={anchorEl}\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'center',\r\n        }}\r\n        transformOrigin={{\r\n          vertical: 'top',\r\n          horizontal: 'center',\r\n        }}\r\n        onClose={handleClose}\r\n      >\r\n        {options && options.length\r\n          ? (\r\n            options.map((option, index) =>\r\n              <Grid\r\n                container\r\n                className=\"infinite-scroll-table__header__filter-button__option\"\r\n                key={index}\r\n              >\r\n                <Grid item>\r\n                  <Checkbox\r\n                    checked={(value || []).find(val => val === option.value) !== undefined}\r\n                    onChange={({target}) => target.checked\r\n                      ? onChange([...(value || []), option.value])\r\n                      : onChange((value || []).filter(val => val !== option.value))\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item>\r\n                  <div style={{height: 42, lineHeight: \"42px\", marginRight: 16}}>\r\n                    {option.text}\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n          )\r\n          : (\r\n            <div style={{padding: 8}}>\r\n              <AutoSearchInput onSearch={onChange} value={value}/>\r\n            </div>\r\n          )\r\n        }\r\n      </Popover>\r\n\r\n    </Fragment>\r\n  )\r\n};\r\n\r\nexport default FilterButton;\r\n","import React, {Component, Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport \"./style.css\";\r\nimport {getScrollBarWidth, getTextWidth} from \"../../utils/style\";\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport SortButtons, {SORT_DIRECTION_ASC, SORT_DIRECTION_DESC} from './sort-buttons';\r\nimport _ from \"lodash\";\r\nimport {FixedSizeList} from \"react-window\";\r\nimport {\r\n  ACTION_WIDTH,\r\n  ACTIONS_GUTTER,\r\n  CELL_PADDING,\r\n  CHECKBOX_WIDTH,\r\n  COL_WIDTH_SAFE,\r\n  DATA_INDEX_ACTIONS_OBJS,\r\n  DATA_INDEX_CHECKED,\r\n  DATA_INDEX_FIXED_ACTIONS_OBJS,\r\n  DATA_INDEX_ORIGINAL_ROW,\r\n  DATA_INDEX_ORIGINAL_TRANSLATED_ROW,\r\n  DATA_INDEX_RENDERED,\r\n  DEFAULT_PAGE_NUM,\r\n  DEFAULT_PAGE_SIZE,\r\n  DEFAULT_TABLE_HEIGHT,\r\n  FILTER_BUTTON_WIDTH,\r\n  HEADER_CELL_CONTROLS_GUTTER,\r\n  HEADER_CELL_GUTTER,\r\n  HEADER_CELL_PADDING,\r\n  MAX_PAGE_SIZE,\r\n  PAGINATION_TIMEOUT,\r\n  RESIZE_TIMEOUT,\r\n  ROW_HEIGHT,\r\n  SORT_BUTTON_WIDTH,\r\n  TABLE_TOTAL_BORDER,\r\n  VIEW_INDEXES_UPDATE_TIMEOUT\r\n} from \"./contants\";\r\nimport {getIndexesFromPaginationParams, getPaginationParamsFromIndexes} from \"./utils\";\r\nimport PreHeader from \"./pre-header\";\r\nimport Footer from \"./footer\";\r\nimport {withSize} from \"react-sizeme\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport FilterButton from \"./filter-button\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nexport const numberStringSorter = (a, b) => Number(a) - Number(b);\r\n\r\nclass InfiniteScrollTable extends Component {\r\n\r\n  constructor(props) {\r\n\r\n    super(props);\r\n\r\n    this.onSearchTextChange = this.onSearchTextChange.bind(this);\r\n    this.onFiltersChange = this.onFiltersChange.bind(this);\r\n    this.onSortChange = this.onSortChange.bind(this);\r\n    this.getSelectedRowKeys = this.getSelectedRowKeys.bind(this);\r\n    this.onRowSelectionChange = this.onRowSelectionChange.bind(this);\r\n    this.getCols = this.getCols.bind(this);\r\n    this.getNormalizedTableActions = this.getNormalizedTableActions.bind(this);\r\n    this.renderActions = this.renderActions.bind(this);\r\n    this.renderGridRow = this.renderGridRow.bind(this);\r\n    this.renderFixedActions = this.renderFixedActions.bind(this);\r\n    this.renderHeaderCells = this.renderHeaderCells.bind(this);\r\n    this.renderCheckboxTitle = this.renderCheckboxTitle.bind(this);\r\n    this.renderCheckbox = this.renderCheckbox.bind(this);\r\n    this.getPopulatedRows = this.getPopulatedRows.bind(this);\r\n    this.getColWidths = this.getColWidths.bind(this);\r\n    this.getQueriedRows = this.getQueriedRows.bind(this);\r\n    this.getRenderedRows = this.getRenderedRows.bind(this);\r\n    this.onRenderedRowsChange = this.onRenderedRowsChange.bind(this);\r\n\r\n    this.state = {\r\n      uuid: uuidv4(),\r\n\r\n      gridKeyForRefresh: uuidv4(),\r\n      scrollTop: 0,\r\n      scrollLeft: 0,\r\n\r\n      gridScrollbarWidth: getScrollBarWidth(),\r\n\r\n      searchText: \"\",\r\n      sortCol: null,\r\n      sortByDesc: false,\r\n      filters: {},\r\n\r\n      selectedRowKeys:\r\n        props.rowSelection && props.rowSelection.selectedRowKeys\r\n          ? props.rowSelection.selectedRowKeys\r\n          : [],\r\n\r\n      cols: null,\r\n\r\n      populatedRows: null,\r\n\r\n      colWidths: null,\r\n\r\n      renderedRows: null,\r\n\r\n      queriedRows: null,\r\n\r\n      isResizing: false,\r\n      resizeTimeout: null,\r\n\r\n      pageSize: null,\r\n      pageNum: null,\r\n      pageRequestTimeout: null,\r\n\r\n      isPaginating: props.isPaginated,\r\n      pageRequestParams: null,\r\n\r\n      viewStartIdx: null,\r\n      viewEndIdx: null,\r\n      viewIndexesUpdateTimeout: null,\r\n\r\n      doNotCallOnChangeOnNextRenderedRowsChange: false\r\n    };\r\n\r\n    if (props.isPaginated) {\r\n      this.state.pageRequestParams = {\r\n        pageSize: DEFAULT_PAGE_SIZE,\r\n        pageNum: DEFAULT_PAGE_NUM,\r\n        filters: this.state.filters,\r\n        searchText: this.state.searchText,\r\n        sortCol: this.state.sortCol,\r\n        sortByDesc: this.state.sortByDesc\r\n      };\r\n    }\r\n\r\n    if (props.onChange && props.isPaginated) {\r\n      props.onChange(this.state.pageRequestParams);\r\n    }\r\n  }\r\n\r\n  static isValuePassingSearchText(value, searchText) {\r\n    return String(value).toLowerCase().includes(searchText.toLowerCase())\r\n  }\r\n\r\n  static defaultSorter = (a, b, isDesc) => {\r\n\r\n    const normalize = val => typeof (val) === \"string\" ? val.toLowerCase() : Number(val);\r\n    const _a = normalize(a);\r\n    const _b = normalize(b);\r\n\r\n    return (isDesc ? (_b < _a) : (_a < _b)) ? -1 : 1\r\n  };\r\n\r\n  static isArrayPropertyChangedLazy(prevProp, prop) {\r\n    return (\r\n      (prevProp !== prop) ||\r\n      ((prevProp === null || prevProp === undefined) && prop !== null && prop !== undefined) ||\r\n      (prevProp && prop && prevProp.length !== prop.length)\r\n    );\r\n  }\r\n\r\n  /* === Hooks === */\r\n\r\n  getPopulatedRows(rows) {\r\n\r\n    const {\r\n      defaultLanguage,\r\n      languages,\r\n      multilangStrDataIndexes,\r\n      actions,\r\n      fixedActions,\r\n      altActions,\r\n      getIsAltRow\r\n    } = this.props;\r\n\r\n    const getActionsObjs = (actions, row) =>\r\n      (actions || [])\r\n        .filter(action => action !== null)\r\n        .map(action => typeof (action) === \"function\" ? action(row) : action)\r\n        .filter(action => action !== null)\r\n        .map(action => ({...action, row}));\r\n\r\n    return (rows !== null && rows !== undefined)\r\n      ? rows.map(row => {\r\n\r\n        const populatedRow = {...row};\r\n\r\n        populatedRow[DATA_INDEX_ORIGINAL_ROW] = {...populatedRow};\r\n\r\n        if (multilangStrDataIndexes) {\r\n          for (let dataIndex of multilangStrDataIndexes) {\r\n            populatedRow[dataIndex] = localizeI18nObj(populatedRow[dataIndex], defaultLanguage, languages);\r\n          }\r\n        }\r\n\r\n        populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW] = {...populatedRow};\r\n\r\n        populatedRow[DATA_INDEX_FIXED_ACTIONS_OBJS] =\r\n          fixedActions\r\n            ? getActionsObjs(fixedActions, populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW])\r\n            : null;\r\n\r\n        populatedRow[DATA_INDEX_ACTIONS_OBJS] =\r\n          (actions || altActions)\r\n            ? getActionsObjs(\r\n            (getIsAltRow && getIsAltRow(populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW])) ? altActions : actions,\r\n            populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW]\r\n            )\r\n            : null;\r\n\r\n        return populatedRow;\r\n\r\n      })\r\n      : null;\r\n  }\r\n\r\n  getColWidths(rows, cols) {\r\n\r\n    const {\r\n      size\r\n    } = this.props;\r\n\r\n    const {\r\n      gridScrollbarWidth\r\n    } = this.state;\r\n\r\n    if (cols === null) {\r\n      return null;\r\n    }\r\n\r\n    const getTextWidthEl = $('<span>').css({visibility: 'hidden', position: 'absolute'}).appendTo('body').get(0);\r\n\r\n    let colWidths = cols.map(col => {\r\n\r\n      let colWidth = 0;\r\n\r\n      const colTitleWidth =\r\n        getTextWidth(col.title, getTextWidthEl) +\r\n        ((!col.noFilter || !col.noSort) ? HEADER_CELL_GUTTER : 0) +\r\n        (col.noFilter ? 0 : FILTER_BUTTON_WIDTH) +\r\n        (col.noSort ? 0 : SORT_BUTTON_WIDTH) +\r\n        ((!col.noFilter && !col.noSort) ? HEADER_CELL_CONTROLS_GUTTER : 0) +\r\n        CELL_PADDING * 2 + COL_WIDTH_SAFE;\r\n\r\n      if (col.width) {\r\n\r\n        colWidth = Math.max(colTitleWidth, col.width);\r\n\r\n      } else if ((col.widthToContent || col.minWidthToContent) && rows.length > 0) {\r\n\r\n        colWidth = Math.max(\r\n          colTitleWidth,\r\n          ...rows.map(row =>\r\n            getTextWidth(\r\n              col.renderText\r\n                ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][col.dataIndex])\r\n                : row[col.dataIndex],\r\n              getTextWidthEl\r\n            ) +\r\n            (CELL_PADDING * 2) +\r\n            COL_WIDTH_SAFE\r\n          )\r\n        );\r\n\r\n      } else if (col.minWidth) {\r\n\r\n        colWidth = Math.max(colTitleWidth, col.minWidth);\r\n\r\n      } else {\r\n\r\n        colWidth = colTitleWidth;\r\n\r\n      }\r\n\r\n      return colWidth;\r\n    });\r\n\r\n    $(getTextWidthEl).remove();\r\n\r\n    const isVariableSizeCol = col => !col.width && (rows.length > 0 ? !col.widthToContent : true);\r\n    const variableSizeCols = cols.filter(isVariableSizeCol);\r\n\r\n    let colWidthsSum = 0;\r\n    colWidths.forEach(width => colWidthsSum += width);\r\n\r\n    const availableWidth = size.width - colWidthsSum -\r\n      ((rows !== null && this.getIsVerticalScrollbarVisible(rows.length)) ? gridScrollbarWidth : 0) -\r\n      TABLE_TOTAL_BORDER;\r\n\r\n    if (variableSizeCols.length > 0 && availableWidth > 0) {\r\n\r\n      const widthToAdd = availableWidth / variableSizeCols.length;\r\n\r\n      colWidths = colWidths.map((colWidth, colIndex) =>\r\n        isVariableSizeCol(cols[colIndex])\r\n          ? colWidth + widthToAdd\r\n          : colWidth\r\n      );\r\n    }\r\n\r\n    return colWidths;\r\n  }\r\n\r\n  getRenderedRows(rows, cols, colsWidths, selectedRowKeys) {\r\n\r\n    const {\r\n      rowSelection,\r\n      tableActions,\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    return rows !== null\r\n      ? rows.map(row => {\r\n\r\n        const resRow = {...row};\r\n\r\n        if (rowSelection || tableActions) {\r\n          resRow[DATA_INDEX_CHECKED] = selectedRowKeys.includes(getRowKey(row))\r\n        }\r\n\r\n        return ({\r\n          ...resRow,\r\n          [DATA_INDEX_RENDERED]: this.renderGridRow(resRow, cols, colsWidths)\r\n        });\r\n      })\r\n      : null;\r\n  }\r\n\r\n  getQueriedRows(rows, cols, filters, searchText, sortCol, sortByDesc) {\r\n\r\n    const {\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    if (isPaginated) {\r\n      return rows;\r\n    } else {\r\n      let queriedRows = this.getFilteredGridRows(rows, cols, filters);\r\n      queriedRows = this.getSearchTextFilteredGridRows(queriedRows, cols, searchText);\r\n      return this.getSortedGridRows(queriedRows, cols, sortCol, sortByDesc);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    const {\r\n      data,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    if (data !== null) {\r\n      const cols = this.getCols();\r\n      const populatedRows = this.getPopulatedRows(data);\r\n      const colWidths = this.getColWidths(populatedRows, cols);\r\n      const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, this.getSelectedRowKeys());\r\n      const queriedRows = this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc, isPaginated);\r\n\r\n      this.setState({\r\n        cols,\r\n        populatedRows,\r\n        colWidths,\r\n        renderedRows,\r\n        queriedRows\r\n      });\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n\r\n    const {\r\n      isPaginated,\r\n      rowSelection,\r\n      data\r\n    } = this.props;\r\n\r\n    const {\r\n      uuid,\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc,\r\n      scrollLeft,\r\n      scrollTop,\r\n      resizeTimeout,\r\n      colWidths,\r\n      cols,\r\n      pageSize,\r\n      pageNum,\r\n      pageRequestParams\r\n    } = this.state;\r\n\r\n    if (InfiniteScrollTable.isArrayPropertyChangedLazy(prevProps.data, data)) { // todo: check for lang change\r\n\r\n      let newCols = null;\r\n      let newPopulatedRows = null;\r\n      let newColWidths = null;\r\n      let newRenderedRows = null;\r\n      let newQueriedRows = null;\r\n      let newScrollTop = null;\r\n\r\n      if (data !== null) {\r\n\r\n        newCols = this.getCols();\r\n        newPopulatedRows = this.getPopulatedRows(this.props.data);\r\n\r\n        newColWidths =\r\n          colWidths !== null && cols !== null && (\r\n            (prevProps.data === null && data === null) ||\r\n            ((prevProps.data !== null && prevProps.data.length === 0) && (data !== null && data.length === 0))\r\n          )\r\n            ? colWidths\r\n            : this.getColWidths(newPopulatedRows, newCols);\r\n        newRenderedRows = this.getRenderedRows(newPopulatedRows, newCols, newColWidths, this.getSelectedRowKeys());\r\n        newQueriedRows = this.getQueriedRows(\r\n          newRenderedRows,\r\n          newCols,\r\n          filters,\r\n          searchText,\r\n          sortCol,\r\n          sortByDesc\r\n        );\r\n      } else {\r\n\r\n        const $grid = $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid`);\r\n        if ($grid) {\r\n          newScrollTop = $grid.scrollTop();\r\n        }\r\n      }\r\n\r\n      this.setState({\r\n        cols: newCols,\r\n        populatedRows: newPopulatedRows,\r\n        colWidths: newColWidths,\r\n        renderedRows: newRenderedRows,\r\n        queriedRows: newQueriedRows,\r\n        pageNum: isPaginated && pageRequestParams ? pageRequestParams.pageNum : pageNum,\r\n        pageSize: isPaginated && pageRequestParams ? pageRequestParams.pageSize : pageSize,\r\n        isPaginating: false,\r\n        pageRequestParams: null,\r\n        scrollTop: newScrollTop,\r\n        selectedRowKeys: this.getSelectedRowKeys()\r\n      });\r\n\r\n    } else if (\r\n      rowSelection &&\r\n      InfiniteScrollTable.isArrayPropertyChangedLazy(\r\n        prevProps.rowSelection.selectedRowKeys,\r\n        rowSelection.selectedRowKeys\r\n      )\r\n    ) {\r\n\r\n      this.setState({\r\n        selectedRowKeys: rowSelection.selectedRowKeys,\r\n      });\r\n      this.updateRenderedRows(rowSelection.selectedRowKeys);\r\n\r\n    } else if (prevProps.size && this.props.size && prevProps.size.width !== this.props.size.width) {\r\n\r\n      if (resizeTimeout) {\r\n        clearTimeout(resizeTimeout);\r\n      }\r\n\r\n      let newScrollTop = null;\r\n      const $grid = $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid`);\r\n      if ($grid) {\r\n        newScrollTop = $grid.scrollTop();\r\n      }\r\n\r\n      this.setState({\r\n        isResizing: true,\r\n        scrollTop: newScrollTop || scrollTop,\r\n        resizeTimeout: setTimeout(\r\n          () => {\r\n            this.setState(state => {\r\n\r\n              const {\r\n                populatedRows,\r\n                cols\r\n              } = state;\r\n\r\n              const colWidths = this.getColWidths(populatedRows, cols);\r\n              const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, this.getSelectedRowKeys());\r\n              const queriedRows = this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc);\r\n\r\n              return {\r\n                gridKeyForRefresh: uuidv4(),\r\n                isResizing: false,\r\n                resizeTimeout: null,\r\n                colWidths,\r\n                renderedRows,\r\n                queriedRows\r\n              };\r\n            });\r\n          },\r\n          RESIZE_TIMEOUT\r\n        )\r\n      });\r\n    }\r\n\r\n    const $grid =\r\n      $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid:not(.infinite-scroll-table__grid--with-event-handlers)`);\r\n\r\n    if ($grid.length) {\r\n\r\n      const _this = this;\r\n\r\n      $grid\r\n        .scrollLeft(scrollLeft)\r\n        .addClass('infinite-scroll-table__grid--with-event-handlers')\r\n        .on('scroll', function () {\r\n          const newScrollLeft = $(this).scrollLeft();\r\n          if (newScrollLeft !== _this.state.scrollLeft) {\r\n            $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__header`).scrollLeft(newScrollLeft);\r\n            _this.setState({\r\n              scrollLeft: newScrollLeft\r\n            });\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n\r\n    const {\r\n      uuid,\r\n      resizeTimeout,\r\n      pageRequestTimeout,\r\n      viewIndexesUpdateTimeout\r\n    } = this.state;\r\n\r\n    const $grid =\r\n      $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid--with-event-handlers`);\r\n\r\n    if ($grid.length) {\r\n      $grid.off('scroll');\r\n    }\r\n\r\n    if (resizeTimeout) {\r\n      clearTimeout(resizeTimeout);\r\n    }\r\n\r\n    if (pageRequestTimeout) {\r\n      clearTimeout(pageRequestTimeout);\r\n    }\r\n\r\n    if (viewIndexesUpdateTimeout) {\r\n      clearTimeout(viewIndexesUpdateTimeout);\r\n    }\r\n\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n    if (this.state.gridKeyForRefresh === nextState.gridKeyForRefresh && this.state.scrollLeft !== nextState.scrollLeft) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  /* === Event handlers === */\r\n\r\n  updateRenderedRows(selectedRowKeys) {\r\n\r\n    const {\r\n      populatedRows,\r\n      cols,\r\n      colWidths,\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, selectedRowKeys);\r\n\r\n    this.setState({\r\n      renderedRows,\r\n      queriedRows: this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc)\r\n    });\r\n  }\r\n\r\n  applyQueryChange(filters, searchText, sortCol, sortByDesc) {\r\n\r\n    const {\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      renderedRows,\r\n      cols,\r\n      queriedRows\r\n    } = this.state;\r\n\r\n    this.setState({\r\n      scrollTop: 0,\r\n      gridKeyForRefresh: uuidv4(),\r\n      queriedRows: isPaginated\r\n        ? queriedRows\r\n        : this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc)\r\n    });\r\n  }\r\n\r\n  onFiltersChange(dataIndex, value) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated,\r\n    } = this.props;\r\n\r\n    const {\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const newFilters = this.state.filters;\r\n\r\n    if (value !== null && value.length > 0) {\r\n      newFilters[dataIndex] = value;\r\n    } else {\r\n      delete newFilters[dataIndex];\r\n    }\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText,\r\n      filters: newFilters,\r\n      sortCol,\r\n      sortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      filters: newFilters,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n\r\n    this.applyQueryChange(newFilters, searchText, sortCol, sortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onSearchTextChange(value) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const newSearchText = value;\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText: newSearchText,\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      searchText: newSearchText,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n    this.applyQueryChange(filters, newSearchText, sortCol, sortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onSortChange(colDataIndex, direction) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      searchText,\r\n      filters\r\n    } = this.state;\r\n\r\n    const newSortCol = direction ? colDataIndex : null;\r\n    const newSortByDesc = direction === SORT_DIRECTION_DESC;\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText,\r\n      filters,\r\n      sortCol: newSortCol,\r\n      sortByDesc: newSortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      sortCol: newSortCol,\r\n      sortByDesc: newSortByDesc,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n\r\n    this.applyQueryChange(filters, searchText, newSortCol, newSortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onRowSelectionChange(rowKey, selected) {\r\n\r\n    const {\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc,\r\n      filters,\r\n    } = this.state;\r\n\r\n    const {\r\n      rowSelection,\r\n      getRowKey,\r\n      getIsDisabledRow\r\n    } = this.props;\r\n\r\n    if (rowSelection && (rowSelection.onSelect || rowSelection.onSelectAll)) {\r\n\r\n      if (rowKey !== null && rowSelection.onSelect) {\r\n        rowSelection.onSelect(rowKey, selected);\r\n      }\r\n\r\n      if (rowKey === null && rowSelection.onSelectAll) {\r\n        rowSelection.onSelectAll(\r\n          selected,\r\n          {\r\n            searchText,\r\n            sortCol,\r\n            sortByDesc,\r\n            filters\r\n          }\r\n        );\r\n      }\r\n\r\n    } else {\r\n\r\n      const {\r\n        selectedRowKeys,\r\n        queriedRows\r\n      } = this.state;\r\n\r\n      let newSelectedRowKeys = null;\r\n\r\n      if (rowKey !== null) {\r\n        newSelectedRowKeys =\r\n          selected\r\n            ? [...selectedRowKeys, rowKey]\r\n            : selectedRowKeys.filter(selRowKey => selRowKey !== rowKey);\r\n      } else {\r\n        newSelectedRowKeys =\r\n          selected\r\n            ? queriedRows.map(row => row[DATA_INDEX_ORIGINAL_ROW]).filter(row => !getIsDisabledRow || !getIsDisabledRow(row)).map(row => getRowKey(row))\r\n            : [];\r\n      }\r\n\r\n      if (rowSelection && rowSelection.onChange) {\r\n        rowSelection.onChange(newSelectedRowKeys);\r\n      }\r\n\r\n      this.setState({\r\n        selectedRowKeys: newSelectedRowKeys,\r\n      });\r\n      this.updateRenderedRows(newSelectedRowKeys);\r\n    }\r\n  }\r\n\r\n  /* === Getters === */\r\n\r\n  getCols() {\r\n\r\n    const {\r\n      columns,\r\n      rowSelection\r\n    } = this.props;\r\n\r\n    if (columns === null) {\r\n      return null;\r\n    } else {\r\n\r\n      let res = columns.filter(col => col !== null);\r\n\r\n      if (rowSelection || this.getNormalizedTableActions().length > 0) {\r\n\r\n        res = [\r\n          {\r\n            dataIndex: DATA_INDEX_CHECKED,\r\n            render: this.renderCheckbox,\r\n            titleRender: this.renderCheckboxTitle,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            width: CHECKBOX_WIDTH,\r\n            renderText: () => \"\"\r\n          },\r\n          ...res\r\n        ];\r\n      }\r\n\r\n      if (this.getNormalizedFixedActions().length > 0) {\r\n        res = [\r\n          ...res,\r\n          {\r\n            dataIndex: DATA_INDEX_FIXED_ACTIONS_OBJS,\r\n            render: this.renderFixedActions,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            disableOnRowClickForCell: true,\r\n            renderText: () => \"\",\r\n            width: this.getNormalizedFixedActions().length * (ACTION_WIDTH + ACTIONS_GUTTER) - ACTIONS_GUTTER + COL_WIDTH_SAFE + 2 * CELL_PADDING\r\n          }\r\n        ];\r\n      }\r\n\r\n      if (this.getNormalizedActions().length > 0 || this.getNormalizedAltActions().length > 0) {\r\n        res = [\r\n          ...res,\r\n          {\r\n            dataIndex: DATA_INDEX_ACTIONS_OBJS,\r\n            render: this.renderActions,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            disableOnRowClickForCell: true,\r\n            renderText: () => \"\",\r\n            width: Math.max(this.getNormalizedActions().length, this.getNormalizedAltActions().length) * (ACTION_WIDTH + ACTIONS_GUTTER) - ACTIONS_GUTTER + COL_WIDTH_SAFE + 2 * CELL_PADDING\r\n          }\r\n        ];\r\n      }\r\n\r\n      return res;\r\n    }\r\n  }\r\n\r\n  getNormalizedTableActions() {\r\n\r\n    const {\r\n      tableActions\r\n    } = this.props;\r\n\r\n    return (tableActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedActions() {\r\n\r\n    const {\r\n      actions\r\n    } = this.props;\r\n\r\n    return (actions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedAltActions() {\r\n\r\n    const {\r\n      altActions\r\n    } = this.props;\r\n\r\n    return (altActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedFixedActions() {\r\n\r\n    const {\r\n      fixedActions\r\n    } = this.props;\r\n\r\n    return (fixedActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getSelectedRowKeys() {\r\n\r\n    const {\r\n      rowSelection\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return rowSelection && rowSelection.selectedRowKeys\r\n      ? rowSelection.selectedRowKeys\r\n      : selectedRowKeys;\r\n  }\r\n\r\n  /* === Data manipulation === */\r\n\r\n  getFilteredGridRows(rows, cols, filters) {\r\n\r\n    return Object.keys(filters).length > 0\r\n      ? rows.filter(row => {\r\n\r\n        for (let dataIndex in filters) {\r\n          if (filters.hasOwnProperty(dataIndex)) {\r\n\r\n            const col = cols.find(col => col.dataIndex === dataIndex);\r\n\r\n            const testPassed =\r\n              col.withValuesFilter\r\n                ? filters[dataIndex].includes(row[dataIndex])\r\n                : (\r\n                  InfiniteScrollTable.isValuePassingSearchText(\r\n                    col.renderText\r\n                      ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][dataIndex])\r\n                      : row[dataIndex],\r\n                    filters[dataIndex]\r\n                  )\r\n                );\r\n\r\n            if (!testPassed) {\r\n              return false;\r\n            }\r\n\r\n          }\r\n        }\r\n\r\n        return true;\r\n\r\n      })\r\n      : rows;\r\n  }\r\n\r\n  getSearchTextFilteredGridRows(rows, cols, searchText) {\r\n\r\n    return searchText !== null\r\n      ? (\r\n        rows !== null\r\n          ? rows.filter(row => {\r\n            for (let col of cols) {\r\n              if (!col.noSearchText && typeof (row[col.dataIndex]) !== 'boolean' &&\r\n                InfiniteScrollTable.isValuePassingSearchText(\r\n                  col.renderText\r\n                    ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][col.dataIndex])\r\n                    : row[col.dataIndex],\r\n                  searchText\r\n                )) {\r\n                return true;\r\n              }\r\n            }\r\n            return false;\r\n          })\r\n          : null\r\n      )\r\n      : rows;\r\n  }\r\n\r\n  getSortedGridRows(rows, cols, sortCol, sortByDesc) {\r\n\r\n    const column = sortCol !== null ? cols.find(col => col.dataIndex === sortCol) : null;\r\n\r\n    return column\r\n      ? rows.sort((a, b) => {\r\n        const _a =\r\n          column.renderText\r\n            ? column.renderText(a[DATA_INDEX_ORIGINAL_ROW][column.dataIndex])\r\n            : a[column.dataIndex];\r\n        const _b =\r\n          column.renderText\r\n            ? column.renderText(b[DATA_INDEX_ORIGINAL_ROW][column.dataIndex])\r\n            : b[column.dataIndex];\r\n        return (\r\n          column.sorter\r\n            ? column.sorter(_a, _b) * (sortByDesc ? -1 : 1)\r\n            : InfiniteScrollTable.defaultSorter(_a, _b, sortByDesc)\r\n        );\r\n      })\r\n      : rows;\r\n  }\r\n\r\n  /* === Rendering ==== */\r\n\r\n  renderGridRow(row, cols, colWidths) {\r\n\r\n    const {\r\n      onRowClick,\r\n      getIsDisabledRow,\r\n      getRowStyle\r\n    } = this.props;\r\n\r\n    return (\r\n      <div className=\"infinite-scroll-table__grid__row\" style={{width: \"100%\", height: ROW_HEIGHT}}>\r\n        {cols.map((col, colIndex) => {\r\n          const cellData = row[col.dataIndex];\r\n          const isRowClickDisabled =\r\n            !onRowClick || col.disableOnRowClickForCell ||\r\n            (getIsDisabledRow && getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW]));\r\n          let colLeftAttr = 0;\r\n          cols\r\n            .slice(0, colIndex)\r\n            .map((_, index) => index)\r\n            .forEach(index => colLeftAttr += colWidths[index]);\r\n          const rowStyle = getRowStyle ? getRowStyle(row[DATA_INDEX_ORIGINAL_ROW]) : null;\r\n          return (\r\n            <Tooltip key={colIndex} title={col.renderText ? col.renderText(cellData) : cellData}>\r\n              <div\r\n                className={\r\n                  'infinite-scroll-table__grid__cell' +\r\n                  (getIsDisabledRow && getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW])\r\n                    ? ' infinite-scroll-table__grid__cell--disabled'\r\n                    : '')\r\n                }\r\n                style={{\r\n                  position: \"absolute\",\r\n                  width: colWidths[colIndex],\r\n                  height: ROW_HEIGHT,\r\n                  lineHeight: `${ROW_HEIGHT - CELL_PADDING - CELL_PADDING}px`,\r\n                  top: 0,\r\n                  left: colLeftAttr,\r\n                  cursor: !isRowClickDisabled ? \"pointer\" : null,\r\n                  ...rowStyle\r\n                }}\r\n                onClick={!isRowClickDisabled ? () => onRowClick(row[DATA_INDEX_ORIGINAL_TRANSLATED_ROW]) : null}\r\n              >\r\n                {col.render\r\n                  ? col.render(cellData, row[DATA_INDEX_ORIGINAL_ROW])\r\n                  : cellData\r\n                }\r\n              </div>\r\n            </Tooltip>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderHeaderCells(cols, columnWidths, rows) {\r\n\r\n    const {\r\n      data\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    return (cols || []).map((col, index) =>\r\n      <div\r\n        key={index}\r\n        className=\"infinite-scroll-table__header__cell\"\r\n        style={{\r\n          width: columnWidths[index],\r\n          height: ROW_HEIGHT,\r\n          padding: HEADER_CELL_PADDING\r\n        }}\r\n      >\r\n        <Grid container justify=\"space-between\">\r\n          {(col.title || col.titleRender) && (\r\n            <Grid item style={{marginRight: (!col.noFilter || !col.noSort) ? HEADER_CELL_GUTTER : 0}}>\r\n              <div\r\n                style={{\r\n                  height: (ROW_HEIGHT - (2 * HEADER_CELL_PADDING)),\r\n                  lineHeight: `${(ROW_HEIGHT - (2 * HEADER_CELL_PADDING))}px`,\r\n                  textAlign: \"center\"\r\n                }}\r\n              >\r\n                {col.titleRender ? col.titleRender(rows) : col.title}\r\n              </div>\r\n            </Grid>\r\n          )}\r\n          {(!col.noFilter || !col.noSort)\r\n            ? (\r\n              <Grid item>\r\n                <Grid container>\r\n                  {!col.noSort && (\r\n                    <Grid item style={{marginRight: !col.noFilter ? HEADER_CELL_CONTROLS_GUTTER : 0}}>\r\n                      <SortButtons\r\n                        value={\r\n                          col.dataIndex === sortCol\r\n                            ? (sortByDesc ? SORT_DIRECTION_DESC : SORT_DIRECTION_ASC)\r\n                            : null\r\n                        }\r\n                        onChange={value => this.onSortChange(col.dataIndex, value)}\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                  {!col.noFilter && (\r\n                    <Grid item>\r\n                      <FilterButton\r\n                        value={filters[col.dataIndex]}\r\n                        onChange={value => this.onFiltersChange(col.dataIndex, value)}\r\n                        options={\r\n                          col.withValuesFilter\r\n                            ? (\r\n                              _.uniq(\r\n                                (data || []).map(row => row[col.dataIndex])\r\n                              ).map(option => ({\r\n                                value: option,\r\n                                text: col.renderText\r\n                                  ? col.renderText(option)\r\n                                  : option\r\n                              })).sort((a, b) =>\r\n                                col.sorter\r\n                                  ? col.sorter(a.text, b.text)\r\n                                  : InfiniteScrollTable.defaultSorter(a.text, b.text)\r\n                              )\r\n                            )\r\n                            : null\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n            : <span/>\r\n          }\r\n        </Grid>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderFixedActions(actions) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return (\r\n      <Grid container>\r\n        {(actions || []).map((action, index) =>\r\n          <Grid item key={index} style={{marginLeft: index === 0 ? 0 : ACTIONS_GUTTER}}>\r\n            <Tooltip title={action.title}>\r\n              <IconButton\r\n                {...action}\r\n                key={index}\r\n                size=\"small\"\r\n                onClick={\r\n                  e => {\r\n                    e.stopPropagation();\r\n                    action.onClick(\r\n                      action.row,\r\n                      () => this.setState({\r\n                        selectedRowKeys: selectedRowKeys.filter(key => key !== getRowKey(action.row))\r\n                      })\r\n                    );\r\n                  }}\r\n              >\r\n                {action.icon}\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  renderActions(actions) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return (\r\n      <Grid\r\n        container\r\n        className=\"infinite-scroll-table__grid__cell__actions-container\"\r\n        justify=\"flex-end\"\r\n      >\r\n        {(actions || []).map((action, index) =>\r\n          <Grid item key={index} style={{marginLeft: index === 0 ? 0 : ACTIONS_GUTTER}}>\r\n            <Tooltip title={action.title}>\r\n              <IconButton\r\n                className={`infinite-scroll-table__grid__cell__action ${action.className || \"\"}`}\r\n                style={{\r\n                  width: ACTION_WIDTH,\r\n                  height: ACTION_WIDTH,\r\n                  padding: 0\r\n                }}\r\n                disabled={action.disabled}\r\n                onClick={\r\n                  e => {\r\n                    e.stopPropagation();\r\n                    action.onClick(\r\n                      action.row,\r\n                      () => this.setState({\r\n                        selectedRowKeys: selectedRowKeys.filter(key => key !== getRowKey(action.row))\r\n                      })\r\n                    );\r\n                  }}\r\n              >\r\n                {action.icon}\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  renderTableAction(action, rows) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    return (\r\n      <Button\r\n        type=\"primary\"\r\n        className={action.className}\r\n        startIcon={action.icon}\r\n        title={action.title}\r\n        disabled={action.disabled}\r\n        onClick={\r\n          e => {\r\n            e.stopPropagation();\r\n            action.onClick(\r\n              rows.filter(row => this.getSelectedRowKeys().includes(getRowKey(row[DATA_INDEX_ORIGINAL_ROW]))),\r\n              () => this.onRowSelectionChange(null, false)\r\n            )\r\n          }}\r\n      >\r\n        {action.title}\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  renderCheckbox(checked, row) {\r\n    const {\r\n      getRowKey,\r\n      rowSelection,\r\n      getIsDisabledRow,\r\n      isCheckDisabled\r\n    } = this.props;\r\n\r\n    const checkboxProps =\r\n      rowSelection && rowSelection.getCheckboxProps\r\n        ? rowSelection.getCheckboxProps(row)\r\n        : ({\r\n          disabled: (isCheckDisabled || (getIsDisabledRow && getIsDisabledRow(row)))\r\n        });\r\n\r\n    return (\r\n      <Checkbox\r\n        checked={checked}\r\n        onChange={e => {\r\n          e.stopPropagation();\r\n          this.onRowSelectionChange(getRowKey(row), !checked)\r\n        }}\r\n        style={{padding: 0}}\r\n        {...checkboxProps}\r\n      />\r\n    );\r\n  }\r\n\r\n  renderCheckboxTitle(rows) {\r\n    const {\r\n      getRowKey,\r\n      getIsDisabledRow,\r\n      isCheckDisabled\r\n    } = this.props;\r\n\r\n    const selectedRowKeys = this.getSelectedRowKeys();\r\n\r\n    const checked =\r\n      rows !== null &&\r\n      rows.length > 0 &&\r\n      rows\r\n        .filter(row => !getIsDisabledRow || !getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW]))\r\n        .map(row => getRowKey(row[DATA_INDEX_ORIGINAL_ROW]))\r\n        .filter(rowKey => !selectedRowKeys.includes(rowKey))\r\n        .length === 0;\r\n\r\n    return (\r\n      <Checkbox\r\n        checked={checked}\r\n        onChange={() => this.onRowSelectionChange(null, !checked)}\r\n        style={{padding: 0}}\r\n        disabled={isCheckDisabled}\r\n      />\r\n    );\r\n  }\r\n\r\n  onRenderedRowsChange(viewStartIdx, viewEndIdx, overscanStartIdx, overscanEndIdx) {\r\n\r\n    const {\r\n      onChange,\r\n      rowCount,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      pageRequestTimeout,\r\n      pageSize,\r\n      pageNum,\r\n      isPaginating,\r\n      viewIndexesUpdateTimeout,\r\n      doNotCallOnChangeOnNextRenderedRowsChange\r\n    } = this.state;\r\n\r\n    if (viewIndexesUpdateTimeout) {\r\n      clearTimeout(viewIndexesUpdateTimeout);\r\n    }\r\n\r\n    this.setState({\r\n      viewIndexesUpdateTimeout: setTimeout(\r\n        () => this.setState({\r\n          viewStartIdx,\r\n          viewEndIdx,\r\n          viewIndexesUpdateTimeout: null\r\n        }),\r\n        VIEW_INDEXES_UPDATE_TIMEOUT\r\n      )\r\n    });\r\n\r\n    if (isPaginated && !doNotCallOnChangeOnNextRenderedRowsChange) {\r\n\r\n      const currentPageIndexes = getIndexesFromPaginationParams(\r\n        pageSize || DEFAULT_PAGE_SIZE,\r\n        pageNum || DEFAULT_PAGE_NUM\r\n      );\r\n\r\n      if (\r\n        isPaginating ||\r\n        (overscanStartIdx < currentPageIndexes.startIdx || overscanEndIdx > currentPageIndexes.stopIdx)\r\n      ) {\r\n\r\n        if (pageRequestTimeout !== null) {\r\n          clearTimeout(pageRequestTimeout);\r\n        }\r\n\r\n        const safePageSize = MAX_PAGE_SIZE / 2; // getPaginationParamsFromIndexes can double the size of a page\r\n        const pageRowsThird = Math.floor(safePageSize / 3);\r\n        const newPaginationParams =\r\n          getPaginationParamsFromIndexes(\r\n            Math.max(overscanStartIdx - pageRowsThird, 0),\r\n            Math.min(overscanStartIdx + 2 * pageRowsThird - 1, rowCount - 1),\r\n            rowCount\r\n          );\r\n\r\n        const newPageRequestParams = {\r\n          pageSize: newPaginationParams.pageSize,\r\n          pageNum: newPaginationParams.pageNum,\r\n          filters: this.state.filters,\r\n          searchText: this.state.searchText,\r\n          sortCol: this.state.sortCol,\r\n          sortByDesc: this.state.sortByDesc\r\n        };\r\n\r\n        this.setState({\r\n          isPaginating: true,\r\n          pageRequestTimeout: setTimeout(\r\n            () => {\r\n              onChange(newPageRequestParams);\r\n              this.setState({\r\n                pageRequestParams: newPageRequestParams\r\n              })\r\n            },\r\n            PAGINATION_TIMEOUT\r\n          )\r\n        });\r\n      }\r\n    } else if (isPaginated) {\r\n      this.setState({\r\n        doNotCallOnChangeOnNextRenderedRowsChange: false\r\n      });\r\n    }\r\n  }\r\n\r\n  getIsVerticalScrollbarVisible(rowNum) {\r\n\r\n    const {\r\n      height = DEFAULT_TABLE_HEIGHT\r\n    } = this.props;\r\n\r\n    return rowNum * ROW_HEIGHT > height;\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      t,\r\n      size,\r\n      leftActions,\r\n      rightActions,\r\n      showHeader = true,\r\n      rowCount,\r\n      isPaginated = false,\r\n      height = DEFAULT_TABLE_HEIGHT,\r\n      selectedRowCount,\r\n      autoSearch = true\r\n    } = this.props;\r\n\r\n    const {\r\n      uuid,\r\n      cols,\r\n      gridKeyForRefresh,\r\n      scrollTop,\r\n      gridScrollbarWidth,\r\n      populatedRows,\r\n      queriedRows,\r\n      isResizing,\r\n      colWidths,\r\n      pageSize,\r\n      pageNum,\r\n      isPaginating,\r\n      viewStartIdx,\r\n      viewEndIdx,\r\n      viewIndexesUpdateTimeout,\r\n      searchText\r\n    } = this.state;\r\n\r\n    const currentPageIndexes = getIndexesFromPaginationParams(\r\n      pageSize || DEFAULT_PAGE_SIZE,\r\n      pageNum || DEFAULT_PAGE_NUM\r\n    );\r\n\r\n    return (\r\n      <div className={`infinite-scroll-table infinite-scroll-table__${uuid}`}>\r\n        <PreHeader\r\n          searchText={searchText}\r\n          autoSearch={autoSearch}\r\n          onSearch={this.onSearchTextChange}\r\n          selectedRowCount={selectedRowCount ? selectedRowCount : this.getSelectedRowKeys().length}\r\n          tableActions={this.getNormalizedTableActions()}\r\n          renderTableAction={action => this.renderTableAction(action, populatedRows)}\r\n          leftActions={leftActions}\r\n          rightActions={rightActions}\r\n        />\r\n        <Fragment>\r\n          {showHeader && (\r\n            isResizing\r\n              ? <div className=\"infinite-scroll-table__header-placeholder\" style={{height: ROW_HEIGHT}}/>\r\n              : (\r\n                <div className=\"infinite-scroll-table__header\" style={{height: ROW_HEIGHT}}>\r\n                  {queriedRows !== null\r\n                    ? (\r\n                      <Fragment>\r\n                        <div className=\"infinite-scroll-table__header__cells-container\">\r\n                          {this.renderHeaderCells(cols, colWidths, queriedRows)}\r\n                        </div>\r\n                        <div\r\n                          className=\"infinite-scroll-table__header__scrollbar-padding\"\r\n                          style={{width: gridScrollbarWidth, height: ROW_HEIGHT}}\r\n                        >\r\n                        </div>\r\n                      </Fragment>\r\n                    )\r\n                    : (\r\n                      <div\r\n                        className=\"infinite-scroll-table__header-placeholder\"\r\n                        style={{height: ROW_HEIGHT, width: size.width}}\r\n                      />\r\n                    )\r\n                  }\r\n                </div>\r\n              )\r\n          )}\r\n          {isResizing || queriedRows === null || queriedRows.length === 0\r\n            ? (\r\n              <div style={{height}} className=\"infinite-scroll-table__grid-container-placeholder\">\r\n                <CustomEmpty\r\n                  width={(!isResizing && queriedRows !== null) ? _.sum(colWidths) : undefined}\r\n                  text={\r\n                    isResizing\r\n                      ? t(\"components.infiniteScrollTable.resizing\") + \"...\"\r\n                      : (\r\n                        queriedRows === null\r\n                          ? t(\"components.infiniteScrollTable.updating\") + \"...\"\r\n                          : undefined\r\n                      )}\r\n                  image={isResizing\r\n                    ? <CircularProgress/>\r\n                    : <span/>\r\n                  }\r\n                />\r\n              </div>\r\n            )\r\n            : (\r\n              <div className=\"infinite-scroll-table__grid-container\" style={{position: \"relative\", height}}>\r\n                {isPaginating && (\r\n                  <div\r\n                    style={{\r\n                      position: \"absolute\",\r\n                      width: Math.min(_.sum(colWidths), size.width),\r\n                      height,\r\n                    }}\r\n                  >\r\n                    <CustomEmpty\r\n                      text={t(\"components.infiniteScrollTable.updating\") + \"...\"}\r\n                    />\r\n                  </div>\r\n                )}\r\n                <FixedSizeList\r\n                  className=\"infinite-scroll-table__grid\"\r\n                  key={gridKeyForRefresh}\r\n                  width={size.width}\r\n                  height={height}\r\n                  itemSize={ROW_HEIGHT}\r\n                  itemCount={rowCount || queriedRows.length}\r\n                  initialScrollOffset={scrollTop}\r\n                  onItemsRendered={\r\n                    ({visibleStartIndex, visibleStopIndex, overscanStartIndex, overscanStopIndex}) =>\r\n                      this.onRenderedRowsChange(\r\n                        visibleStartIndex,\r\n                        visibleStopIndex,\r\n                        overscanStartIndex,\r\n                        overscanStopIndex\r\n                      )\r\n                  }\r\n                >\r\n                  {({index, style}) =>\r\n                    <div\r\n                      style={{...style, width: _.sum(colWidths)}}\r\n                      className={`infinite-scroll-table__grid__row infinite-scroll-table__grid__row--${index % 2 ? 'odd' : 'even'}`}\r\n                    >\r\n                      {\r\n                        !isPaginated ||\r\n                        (\r\n                          !isPaginating &&\r\n                          currentPageIndexes.startIdx <= index &&\r\n                          index <= currentPageIndexes.stopIdx &&\r\n                          (index - currentPageIndexes.startIdx < queriedRows.length)\r\n                        )\r\n                          ? (\r\n                            queriedRows[\r\n                              isPaginated\r\n                                ? (index - currentPageIndexes.startIdx)\r\n                                : index\r\n                              ][DATA_INDEX_RENDERED]\r\n                          )\r\n                          : <span/>\r\n                      }\r\n                    </div>\r\n                  }\r\n                </FixedSizeList>\r\n              </div>\r\n            )}\r\n          <Footer\r\n            isHidden={queriedRows === null || queriedRows.length === 0}\r\n            isLoading={isPaginating || viewIndexesUpdateTimeout}\r\n            rowNumStart={viewStartIdx + 1}\r\n            rowNumEnd={viewEndIdx + 1}\r\n            rowCount={rowCount || (queriedRows ? queriedRows.length : null)}\r\n          />\r\n        </Fragment>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withSize(),\r\n  withTranslation(),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(InfiniteScrollTable);\r\n","import React from 'react';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\n\r\nconst iconStyle = {\r\n  cursor: 'pointer'\r\n};\r\n\r\n/* Based on https://ant.design/components/form/#components-form-demo-customized-form-controls */\r\nclass Selector extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      value: null\r\n    };\r\n    this.callOnChange = this.callOnChange.bind(this);\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, state) {\r\n    if (nextProps.value !== state.value) {\r\n      return {\r\n        value: nextProps.value\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  callOnChange(value) {\r\n    if (this.props.onChange) {\r\n      this.props.onChange(value);\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      disabled,\r\n      detailTitle,\r\n      selectTitle,\r\n      resetTitle,\r\n      onDetail,\r\n      onSelect,\r\n      onReset,\r\n      render,\r\n      variant,\r\n      className\r\n    } = this.props;\r\n\r\n    const {\r\n      value\r\n    } = this.state;\r\n\r\n    return (\r\n      <TextField\r\n        value={render ? render(value) : value}\r\n        onChange={f => f}\r\n        variant={variant || \"outlined\"}\r\n        InputProps={{\r\n          readOnly: true,\r\n          endAdornment: disabled\r\n            ? undefined\r\n            : value !== null\r\n              ? resetTitle\r\n                ? (\r\n                  <Tooltip title={resetTitle}>\r\n                    <CloseIcon onClick={onReset} style={iconStyle}/>\r\n                  </Tooltip>\r\n                )\r\n                : <CloseIcon onClick={onReset} style={iconStyle}/>\r\n              : selectTitle\r\n                ? (\r\n                  <Tooltip title={selectTitle}>\r\n                    <AddIcon onClick={onSelect} style={iconStyle}/>\r\n                  </Tooltip>\r\n                )\r\n                : <AddIcon onClick={onSelect} style={iconStyle}/>,\r\n          startAdornment: (onDetail && value !== null)\r\n            ? detailTitle\r\n              ? (\r\n                <Tooltip title={detailTitle}>\r\n                  <VisibilityIcon onClick={onDetail} style={iconStyle}/>\r\n                </Tooltip>\r\n              )\r\n              : <VisibilityIcon onClick={onDetail} style={iconStyle}/>\r\n            : undefined\r\n        }}\r\n        className={className}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Selector;\r\n","import React, {useState} from 'react';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport _ from \"lodash\";\r\n\r\nconst ON_CHANGE_TIMEOUT = 500;\r\n\r\nconst getInitialInternalValue = (value, languages) => {\r\n  const emptyValue = {};\r\n  languages.forEach(lang => emptyValue[lang] = \"\");\r\n\r\n  return _.merge(emptyValue, value)\r\n};\r\n\r\nconst Component = ({\r\n                     textFieldProps,\r\n                     defaultLanguage,\r\n                     languages\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n  const [internalValue, setInternalValue] = useState(getInitialInternalValue(textFieldProps.value, languages));\r\n  const [timeoutId, setTimeoutId] = useState(null);\r\n\r\n  const callOnChange = value => {\r\n    if (textFieldProps.onChange) {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId)\r\n      }\r\n      setTimeoutId(setTimeout(\r\n        () => {\r\n          textFieldProps.onChange(value);\r\n        },\r\n        ON_CHANGE_TIMEOUT\r\n      ));\r\n    }\r\n  };\r\n\r\n  const setValueForLanguage = value => {\r\n    let newInternalValue = _.cloneDeep(internalValue);\r\n    newInternalValue[language] = value;\r\n\r\n    setInternalValue(newInternalValue);\r\n    callOnChange(newInternalValue);\r\n  };\r\n\r\n  return (\r\n    <TextField\r\n      {...textFieldProps}\r\n      value={(internalValue && internalValue[language])\r\n        ? internalValue[language]\r\n        : \"\"\r\n      }\r\n      onChange={({target}) => setValueForLanguage(target.value)}\r\n      InputProps={{\r\n        startAdornment: (\r\n          <InputAdornment position=\"start\">\r\n            <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n          </InputAdornment>\r\n        )\r\n      }}\r\n    >\r\n      {textFieldProps.children}\r\n    </TextField>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nDelayedTextField = props =>\r\n  <ConnectedComponent textFieldProps={props}/>;\r\n\r\nexport default I18nDelayedTextField;","export const getDashboardDynamicFilterLabelTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    Region: t('dashboards.dynamicFilterLabels.region'),\r\n    Province: t('dashboards.dynamicFilterLabels.province'),\r\n    Municipality: t('dashboards.dynamicFilterLabels.municipality'),\r\n  });\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};","import React, {Fragment, useState} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport _ from \"lodash\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport Selector from \"../selector\";\r\nimport {\r\n  DASHBOARD_ELEM_ENABLE_FILTERS_KEY,\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_SHOW_TITLE_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_TEXT,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  DASHBOARD_ELEM_WIDTH_KEY,\r\n  emptyDashboardElem\r\n} from \"../../utils/dashboards\";\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport I18nDelayedTextField from \"../i18n-delayed-text-field\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nHtmlEditor from \"../i18n-html-editor\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport filters from \"../../dummy/filters.json\";\r\nimport {getDashboardDynamicFilterLabelTranslations} from \"../../constants/getDashboardDynamicFilterLabelTranslations\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst MAX_VIEW_PER_ROW = 4;\r\n\r\nconst ROW_ACTION_WIDTH = 48;\r\nconst COL_ACTION_WIDTH = 48;\r\nconst VIEW_ACTION_WIDTH = 48;\r\n\r\nconst styles = theme => ({\r\n  filterLevels: {\r\n    fontSize: 16\r\n  },\r\n  rowContainer: {\r\n    width: \"100%\",\r\n    marginTop: 8\r\n  },\r\n  row: {\r\n    width: `calc(100% - ${2 * ROW_ACTION_WIDTH}px)`,\r\n    height: 164,\r\n    display: \"inline-block\"\r\n  },\r\n  rowActions: {\r\n    width: (2 * ROW_ACTION_WIDTH),\r\n    display: \"inline-block\",\r\n    margin: \"5px 0\"\r\n  },\r\n  rowAction: {\r\n    width: ROW_ACTION_WIDTH\r\n  },\r\n  colContainer: {\r\n    border: \"1px solid rgba(0, 0, 0, 0.2)\",\r\n    marginRight: 8,\r\n    padding: 16,\r\n    height: \"100%\",\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  col: {\r\n    width: `calc(100% - ${COL_ACTION_WIDTH}px)`,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  colActions: {\r\n    width: COL_ACTION_WIDTH,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  viewContainer: {\r\n    width: \"100%\"\r\n  },\r\n  view: {\r\n    width: `calc(100% - ${VIEW_ACTION_WIDTH + 4}px)`,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  viewAction: {\r\n    width: VIEW_ACTION_WIDTH,\r\n    marginLeft: 4,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  input: {\r\n    width: \"100%\",\r\n    \"& > div\": {\r\n      width: \"100%\"\r\n    },\r\n    \"& input\": {\r\n      padding: 10,\r\n      height: 20\r\n    },\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  dynamicViewInput: {\r\n    marginLeft: 16,\r\n    \"& input\": {\r\n      padding: 10,\r\n      height: 20\r\n    }\r\n  },\r\n  htmlInput: {\r\n    \"& > div\": {\r\n      height: 130\r\n    }\r\n  },\r\n  formLabel: {\r\n    marginLeft: 0,\r\n    marginRight: 0\r\n  }\r\n});\r\n\r\nconst getStrippedHtmlText = html => {\r\n  const $span = $('<span>').get(0);\r\n\r\n  $span.innerHTML = html;\r\n  const text = $span.textContent || $span.innerText || \"\";\r\n\r\n  $($span).remove();\r\n\r\n  return text;\r\n}\r\n\r\nconst DashboardBuilderCol = ({\r\n                               t,\r\n                               classes,\r\n                               defaultLanguage,\r\n                               languages,\r\n                               dashboard,\r\n                               rowIdx,\r\n                               colIdx,\r\n                               col,\r\n                               onColRemove,\r\n                               onTypeReset,\r\n                               fetchViews,\r\n                               onViewReset,\r\n                               onTextEdit,\r\n                               onShowTitleChange,\r\n                               onEnableFiltersChange,\r\n                               onFilterDimensionChange\r\n                             }) =>\r\n  <div\r\n    className={classes.colContainer}\r\n    style={{width: `calc(${col[DASHBOARD_ELEM_WIDTH_KEY]}% - ${2 * 4}px)`}}\r\n  >\r\n    <div className={classes.col}>\r\n      {col[DASHBOARD_ELEM_TYPE_KEY] === null\r\n        ? (\r\n          <Grid container justify=\"center\" style={{margin: \"47px 0\"}}>\r\n            <Grid item>\r\n              <Button onClick={() => fetchViews(rowIdx, colIdx)}>\r\n                {t(\"components.dashboardBuilder.actions.addView\")}\r\n              </Button>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button onClick={() => onTextEdit(rowIdx, colIdx, \"\")}>\r\n                {t(\"components.dashboardBuilder.actions.addText\")}\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        )\r\n        : (\r\n          <div className={classes.viewContainer}>\r\n            <div className={classes.view}>\r\n              {col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW\r\n                ? (\r\n                  <Grid container>\r\n                    <Grid item xs={12} style={{marginBottom: 8}}>\r\n                      <Selector\r\n                        value={col[DASHBOARD_ELEM_VALUE_KEY] ? dashboard.views[col[DASHBOARD_ELEM_VALUE_KEY]] : null}\r\n                        render={view => view?.title ? localizeI18nObj(view.title, defaultLanguage, languages) : \"\"}\r\n                        variant=\"standard\"\r\n                        className={classes.input}\r\n                        selectTitle={t(\"components.dashboardBuilder.actions.selectView\")}\r\n                        onSelect={() => fetchViews(rowIdx, colIdx)}\r\n                        resetTitle={t(\"components.dashboardBuilder.actions.deselectView\")}\r\n                        onReset={() => onViewReset(rowIdx, colIdx, col[DASHBOARD_ELEM_VALUE_KEY])}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={12}>\r\n                      <Grid container>\r\n                        <Grid item style={{marginRight: 8}}>\r\n                          <FormControlLabel\r\n                            className={classes.formLabel}\r\n                            label={t(\"components.dashboardBuilder.actions.showTitle\")}\r\n                            control={\r\n                              <Checkbox\r\n                                style={{padding: 5}}\r\n                                checked={col[DASHBOARD_ELEM_SHOW_TITLE_KEY]}\r\n                                onChange={(ev, checked) => onShowTitleChange(rowIdx, colIdx, checked)}\r\n                              />\r\n                            }\r\n                          />\r\n                        </Grid>\r\n                        <Grid item>\r\n                          <FormControlLabel\r\n                            className={classes.formLabel}\r\n                            label={t(\"components.dashboardBuilder.actions.enableFilters\")}\r\n                            control={\r\n                              <Checkbox\r\n                                style={{padding: 5}}\r\n                                checked={col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY]}\r\n                                onChange={(ev, checked) => onEnableFiltersChange(rowIdx, colIdx, checked)}\r\n                              />\r\n                            }\r\n                          />\r\n                        </Grid>\r\n                      </Grid>\r\n                    </Grid>\r\n                    <Grid item xs={12} style={{marginTop: 8}}>\r\n                      <FormControlLabel\r\n                        className={classes.formLabel}\r\n                        style={{marginLeft: 8}}\r\n                        label={t(\"components.dashboardBuilder.filterDimension.label\") + \":\"}\r\n                        labelPlacement=\"start\"\r\n                        control={\r\n                          <TextField\r\n                            value={col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || \"\"}\r\n                            placeholder={t(\"components.dashboardBuilder.filterDimension.noOne\")}\r\n                            className={classes.dynamicViewInput}\r\n                            variant=\"outlined\"\r\n                            onChange={({target}) => onFilterDimensionChange(rowIdx, colIdx, target.value)}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  </Grid>\r\n                )\r\n                : (\r\n                  <TextField\r\n                    value={getStrippedHtmlText(localizeI18nObj(col[DASHBOARD_ELEM_VALUE_KEY], defaultLanguage, languages) || \"\")}\r\n                    className={`${classes.input} ${classes.htmlInput}`}\r\n                    multiline\r\n                    rows={5}\r\n                    InputProps={{\r\n                      readOnly: true,\r\n                      endAdornment: (\r\n                        <Tooltip title={t(\"components.dashboardBuilder.actions.editText\")}>\r\n                          <EditIcon\r\n                            style={{cursor: \"pointer\", marginLeft: 4}}\r\n                            onClick={() => onTextEdit(rowIdx, colIdx, col[DASHBOARD_ELEM_VALUE_KEY])}\r\n                          />\r\n                        </Tooltip>\r\n                      )\r\n                    }}\r\n                  />\r\n                )\r\n              }\r\n            </div>\r\n            <Tooltip title={t(\"components.dashboardBuilder.actions.resetColumn\")}>\r\n              <IconButton\r\n                className={classes.viewAction}\r\n                onClick={() => onTypeReset(rowIdx, colIdx)}\r\n              >\r\n                <CloseIcon/>\r\n              </IconButton>\r\n            </Tooltip>\r\n          </div>\r\n        )\r\n      }\r\n    </div>\r\n    <Tooltip title={t(\"components.dashboardBuilder.actions.removeColumn\")}>\r\n      <span>\r\n        <IconButton\r\n          className={classes.colActions}\r\n          onClick={() => onColRemove(rowIdx, colIdx)}\r\n          disabled={dashboard.dashboardConfig[rowIdx].length === 1}\r\n        >\r\n          <DeleteIcon/>\r\n        </IconButton>\r\n      </span>\r\n    </Tooltip>\r\n  </div>;\r\n\r\nconst DashboardBuilderRow = ({\r\n                               t,\r\n                               classes,\r\n                               defaultLanguage,\r\n                               languages,\r\n                               dashboard,\r\n                               row,\r\n                               rowIdx,\r\n                               onRowRemove,\r\n                               onColAdd,\r\n                               onColRemove,\r\n                               onTypeReset,\r\n                               fetchViews,\r\n                               onViewReset,\r\n                               onTextEdit,\r\n                               onShowTitleChange,\r\n                               onEnableFiltersChange,\r\n                               onFilterDimensionChange\r\n                             }) =>\r\n  <div className={classes.rowContainer}>\r\n    <div className={classes.row}>\r\n      {row.map((col, idx) =>\r\n        <DashboardBuilderCol\r\n          key={idx}\r\n          t={t}\r\n          classes={classes}\r\n          defaultLanguage={defaultLanguage}\r\n          languages={languages}\r\n          dashboard={dashboard}\r\n          rowIdx={rowIdx}\r\n          colIdx={idx}\r\n          col={col}\r\n          onColRemove={onColRemove}\r\n          onTypeReset={onTypeReset}\r\n          fetchViews={fetchViews}\r\n          onViewReset={onViewReset}\r\n          onTextEdit={onTextEdit}\r\n          onShowTitleChange={onShowTitleChange}\r\n          onEnableFiltersChange={onEnableFiltersChange}\r\n          onFilterDimensionChange={onFilterDimensionChange}\r\n        />\r\n      )}\r\n    </div>\r\n    <div className={classes.rowActions}>\r\n      <Tooltip title={t(\"components.dashboardBuilder.actions.addColumn\")}>\r\n        <span>\r\n          <IconButton\r\n            className={classes.rowAction}\r\n            onClick={() => onColAdd(rowIdx)}\r\n            disabled={row.length === MAX_VIEW_PER_ROW}\r\n          >\r\n            <AddIcon/>\r\n          </IconButton>\r\n        </span>\r\n      </Tooltip>\r\n      <Tooltip title={t(\"components.dashboardBuilder.actions.removeRow\")}>\r\n        <IconButton\r\n          className={classes.rowAction}\r\n          onClick={() => onRowRemove(rowIdx)}\r\n        >\r\n          <DeleteIcon/>\r\n        </IconButton>\r\n      </Tooltip>\r\n    </div>\r\n  </div>;\r\n\r\nfunction DashboardBuilder(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    nodes,\r\n    dashboard,\r\n    onChange,\r\n    views,\r\n    fetchViews,\r\n    onViewsHide\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [selectedRowIdx, setSelectedRowIdx] = useState(null);\r\n  const [selectedColIdx, setSelectedColIdx] = useState(null);\r\n\r\n  const [isEditTextVisible, setEditTextVisibility] = useState(false);\r\n  const [tempTextValue, setTempTextValue] = useState(null);\r\n\r\n  const handleRowAdd = () => {\r\n    const newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig.push([emptyDashboardElem]);\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleRowRemove = rowIdx => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig = newDashboard.dashboardConfig.filter((_, idx) => idx !== rowIdx);\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleColAdd = rowIdx => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx].push(emptyDashboardElem)\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].map(col => ({\r\n      ...col,\r\n      [DASHBOARD_ELEM_WIDTH_KEY]: Math.floor(100 / newDashboard.dashboardConfig[rowIdx].length)\r\n    }));\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleColRemove = (rowIdx, colIdx) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].filter((_, idx) => idx !== colIdx);\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].map(col => ({\r\n      ...col,\r\n      [DASHBOARD_ELEM_WIDTH_KEY]: (100 / newDashboard.dashboardConfig[rowIdx].length)\r\n    }));\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleTypeReset = (rowIdx, colIdx) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = null;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = null;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleViewSet = (rowIdx, colIdx, view) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = DASHBOARD_ELEM_TYPE_VALUE_VIEW;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = view.viewTemplateId;\r\n    newDashboard.views[view.viewTemplateId] = view;\r\n    onChange(newDashboard);\r\n    onViewsHide();\r\n  };\r\n\r\n  const handleViewReset = (rowIdx, colIdx, viewId) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = null;\r\n    onChange(newDashboard);\r\n    onViewsHide();\r\n  };\r\n\r\n  const handleEditTextShow = (rowIdx, colIdx, text) => {\r\n    setSelectedRowIdx(rowIdx);\r\n    setSelectedColIdx(colIdx);\r\n    setTempTextValue(text);\r\n    setEditTextVisibility(true);\r\n  };\r\n\r\n  const handleEditTextHide = () => {\r\n    setSelectedRowIdx(null);\r\n    setSelectedColIdx(null);\r\n    setTempTextValue(null);\r\n    setEditTextVisibility(false);\r\n  };\r\n\r\n  const handleTextChange = (rowIdx, colIdx, text) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = DASHBOARD_ELEM_TYPE_VALUE_TEXT;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = text;\r\n    onChange(newDashboard);\r\n    setEditTextVisibility(false);\r\n  };\r\n\r\n  const handleShowTitleChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_SHOW_TITLE_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleEnableFiltersChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_ENABLE_FILTERS_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleFilterDimensionChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_FILTER_DIMENSION_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      {dashboard && (\r\n        <Grid container spacing={1}>\r\n          <Grid item xs={12}>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nDelayedTextField\r\n                label={t(\"components.dashboardBuilder.title\")}\r\n                value={dashboard.title}\r\n                variant=\"outlined\"\r\n                required\r\n                onChange={value => onChange({...dashboard, title: value})}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Grid container>\r\n              <Grid item className={classes.filterLevels} style={{marginRight: 16, lineHeight: \"34px\"}}>\r\n                {t(\"components.dashboardBuilder.filterLevels\")}:\r\n              </Grid>\r\n              <Grid item>\r\n                <Grid container>\r\n                  {filters.labels.map((label, idx) =>\r\n                    <Grid item key={idx} style={{marginRight: 8}}>\r\n                      <FormControlLabel\r\n                        className={classes.formLabel}\r\n                        label={getDashboardDynamicFilterLabelTranslations(t)[label]}\r\n                        control={\r\n                          <Checkbox\r\n                            style={{padding: 5}}\r\n                            checked={!!dashboard.filterLevels[label]}\r\n                            onChange={(ev, checked) => onChange({\r\n                              ...dashboard,\r\n                              filterLevels: {\r\n                                ...dashboard.filterLevels,\r\n                                [label]: checked\r\n                              }\r\n                            })}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            {(dashboard.dashboardConfig || []).map((row, idx) =>\r\n              <DashboardBuilderRow\r\n                key={idx}\r\n                t={t}\r\n                classes={classes}\r\n                defaultLanguage={defaultLanguage}\r\n                languages={languages}\r\n                dashboard={dashboard}\r\n                row={row}\r\n                rowIdx={idx}\r\n                onRowRemove={handleRowRemove}\r\n                onColAdd={handleColAdd}\r\n                onColRemove={handleColRemove}\r\n                onTypeReset={handleTypeReset}\r\n                fetchViews={(rowIdx, colIdx) => {\r\n                  fetchViews();\r\n                  setSelectedRowIdx(rowIdx);\r\n                  setSelectedColIdx(colIdx);\r\n                }}\r\n                onViewReset={handleViewReset}\r\n                onTextEdit={handleEditTextShow}\r\n                onShowTitleChange={handleShowTitleChange}\r\n                onEnableFiltersChange={handleEnableFiltersChange}\r\n                onFilterDimensionChange={handleFilterDimensionChange}\r\n              />\r\n            )}\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Grid container justify=\"center\">\r\n              <Button endIcon={<AddIcon/>} onClick={handleRowAdd}>\r\n                {t(\"components.dashboardBuilder.actions.addRow\")}\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n      )}\r\n\r\n      <Dialog\r\n        open={views !== null && views !== undefined}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={onViewsHide}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.views.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <InfiniteScrollTable\r\n            data={(views || [])}\r\n            getRowKey={({viewTemplateId}) => viewTemplateId}\r\n            columns={[\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.node\"),\r\n                dataIndex: 'nodeId',\r\n                render: (_, {nodeId}) => nodes.find(node => node.nodeId === nodeId).code,\r\n                renderText: nodeId => nodes.find(node => node.nodeId === nodeId).code,\r\n                minWidthToContent: true\r\n              },\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.datasetId\"),\r\n                dataIndex: 'datasetId',\r\n                minWidthToContent: true\r\n              },\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.name\"),\r\n                dataIndex: 'title',\r\n                minWidthToContent: true\r\n              }\r\n            ]}\r\n            multilangStrDataIndexes={[\"title\"]}\r\n            onRowClick={({__originalRow: view}) => {\r\n              handleViewSet(selectedRowIdx, selectedColIdx, view);\r\n              setSelectedRowIdx(null);\r\n              setSelectedColIdx(null);\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              onViewsHide();\r\n              setSelectedRowIdx(null);\r\n              setSelectedColIdx(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isEditTextVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={handleEditTextHide}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.text.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <I18nHtmlEditor\r\n            value={tempTextValue}\r\n            onChange={setTempTextValue}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleEditTextHide}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => handleTextChange(selectedRowIdx, selectedColIdx, tempTextValue)}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(DashboardBuilder);","import React from 'react';\r\n\r\n/* Calls a function right after the WrappedComponent has been mounted and updated (if props changed) */\r\nclass Call extends React.Component {\r\n\r\n  componentDidMount() {\r\n    /* children has been mounted */\r\n    if (this.props.disabled === undefined || !this.props.disabled) {\r\n      this.props.cb(this.props.cbParam);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate({cb, cbParam, disabled}) {\r\n    /* children has been updated */\r\n    if (\r\n      (this.props.disabled === undefined || !this.props.disabled)\r\n      &&\r\n      (\r\n        JSON.stringify(cbParam) !== JSON.stringify(this.props.cbParam)\r\n        ||\r\n        (this.props.disabled !== undefined && disabled === true && this.props.disabled === false)\r\n      )\r\n    ) {\r\n      this.props.cb(this.props.cbParam);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default Call;\r\n","export const numberFormatter = (new Intl.NumberFormat()).format;\r\n\r\nexport const DECIMAL_SEPARATOR_DEFAULT = \",\";\r\nexport const DECIMAL_PLACES_DEFAULT = 2;\r\nexport const EMPTY_CHAR_DEFAULT = \"\";\r\n\r\nconst getFormattedInt = (value, separator) => {\r\n  let str = value + \"\";\r\n  let subStrs = [];\r\n\r\n  while (str.length > 3) {\r\n    subStrs.push(str.slice(-3));\r\n    str = str.slice(0, -3)\r\n    subStrs.push((separator || \".\"));\r\n  }\r\n  if (str.length > 0) {\r\n    subStrs.push(str);\r\n  } else {\r\n    subStrs.pop()\r\n  }\r\n  subStrs.reverse();\r\n\r\n  let ret = \"\";\r\n  subStrs.forEach(subStr => ret += subStr);\r\n\r\n  return ret;\r\n};\r\n\r\nexport const getFormattedValue = (value, decimalSeparator, decimalPlaces, emptyChar) => {\r\n\r\n  if (value === null || value === undefined || (typeof value === \"string\" && value.length === 0)) {\r\n    return (emptyChar || EMPTY_CHAR_DEFAULT);\r\n  }\r\n\r\n  if (isNaN(value)) {\r\n    return value;\r\n  }\r\n\r\n  const intSeparator = decimalSeparator === \".\" ? \",\" : \".\";\r\n\r\n  if (Number.isInteger(value)) {\r\n    return getFormattedInt(value, intSeparator);\r\n  }\r\n\r\n  const int = Math.floor(value);\r\n\r\n  if (decimalPlaces === 0 || DECIMAL_PLACES_DEFAULT === 0) {\r\n    return getFormattedInt(int, intSeparator);\r\n  }\r\n\r\n  const decimal = (value - int).toFixed(decimalPlaces || DECIMAL_PLACES_DEFAULT).slice(2);\r\n\r\n  return getFormattedInt(int, intSeparator) + (decimalSeparator || DECIMAL_SEPARATOR_DEFAULT) + decimal;\r\n}","import {\r\n  getAttributeObjects,\r\n  getCombinationArrays,\r\n  getDataIdxFromDimensionsArray,\r\n  getDimensionAttributeMap,\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat\r\n} from \"../../utils/jsonStat\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport {getFormattedValue} from \"../../utils/formatters\";\r\nimport _ from \"lodash\";\r\n\r\nconst JSONSTAT_TABLE_PREVIEW_PLACEHOLDER = \"xxx\";\r\nconst JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR = '<svg height=\"6px\" width=\"6px\" fill=\"#00295a\"><path d=\"M 0 0 H 6 V 6 H 0 Z\"/></svg>';\r\n\r\nconst extendArr = (array, n) => {\r\n  let arrays = Array.apply(null, new Array(n / array.length));\r\n  arrays = arrays.map(() => array);\r\n  return [].concat.apply([], arrays);\r\n};\r\n\r\nconst getObj = (jsonStat, arr, length, isPreview) => {\r\n  const obj = {};\r\n  arr.forEach((el, idx) => {\r\n    const repCount = idx === 0\r\n      ? length / jsonStat.size[jsonStat.id.indexOf(el)]\r\n      : obj[arr[idx - 1]].repCount / jsonStat.size[jsonStat.id.indexOf(el)];\r\n\r\n    obj[el] = {\r\n      repCount: repCount,\r\n      ids: [],\r\n      labels: [],\r\n      indexesMap: {}\r\n    };\r\n    if (!isPreview) {\r\n      jsonStat.dimension[el].category.index.forEach((value, idx) => {\r\n        for (let j = 0; j < repCount; j++) {\r\n          obj[el].ids.push(value);\r\n          obj[el].labels.push(jsonStat.dimension[el].category.label[value]);\r\n          obj[el].indexesMap[value] = idx;\r\n        }\r\n      })\r\n    }\r\n  });\r\n  if (!isPreview) {\r\n    arr.forEach(el => {\r\n      if (obj[el].ids.length < length) {\r\n        obj[el].ids = extendArr(obj[el].ids, length);\r\n        obj[el].labels = extendArr(obj[el].labels, length);\r\n      }\r\n    });\r\n  }\r\n\r\n  return obj\r\n};\r\n\r\nconst getValorizedElCount = array => {\r\n  let count = 0;\r\n\r\n  array.forEach(el => {\r\n    if (el === true) {\r\n      count++;\r\n    }\r\n  });\r\n\r\n  return count;\r\n};\r\n\r\nconst getCorrespondingIndexInFilteredArray = (array, n) => {\r\n  let count = 0;\r\n  let res = 0;\r\n  let lastIdx = 0;\r\n  let found = false;\r\n\r\n  array.forEach((el, idx) => {\r\n    if (el === true) {\r\n      count++;\r\n      lastIdx = idx;\r\n      if (count === n + 1) {\r\n        res = idx;\r\n        found = true;\r\n      }\r\n    }\r\n  });\r\n\r\n  return found ? res : (lastIdx + 1);\r\n};\r\n\r\nexport const getJsonStatLayoutObjects = (jsonStat, rows, cols, sections, filters, filtersValue, isPreview) => {\r\n\r\n  /** rows handling **/\r\n  let rowCount = 1;\r\n  (rows || []).forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n  const rowsObj = (rows || []).length > 0\r\n    ? getObj(jsonStat, rows, rowCount, isPreview)\r\n    : {};\r\n\r\n  /** cols handling **/\r\n  let colCount = 1;\r\n  (cols || []).forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  const colsObj = (cols || []).length > 0\r\n    ? getObj(jsonStat, cols, colCount, isPreview)\r\n    : {};\r\n\r\n  /** sections handling **/\r\n  const sectionArray = [];\r\n  (sections || []).forEach(section => sectionArray.push(jsonStat.dimension[section].category.index));\r\n  const combinations = sectionArray.length > 0\r\n    ? getCombinationArrays(sectionArray)\r\n    : [];\r\n\r\n  /** indexes map handling **/\r\n  const indexesMap = {};\r\n  rows.forEach(row => indexesMap[row] = rowsObj[row].indexesMap);\r\n  cols.forEach(col => indexesMap[col] = colsObj[col].indexesMap);\r\n  sections.forEach(section => {\r\n    indexesMap[section] = {};\r\n    jsonStat.dimension[section].category.index.forEach((val, idx) => indexesMap[section][val] = idx);\r\n  });\r\n  filters.forEach(filter => {\r\n    indexesMap[filter] = {};\r\n    jsonStat.dimension[filter].category.index.forEach((val, idx) => indexesMap[filter][val] = idx);\r\n  });\r\n\r\n  return {\r\n    rowCount,\r\n    rowsObj,\r\n    colCount,\r\n    colsObj,\r\n    combinations,\r\n    indexesMap\r\n  }\r\n};\r\n\r\nconst getCellAttributeIdsElem = (ids, id, isDataCell) => {\r\n  let idElems = \"\";\r\n  const astElem = ' <span class=\"ct-a\">(*)</span> ';\r\n\r\n  if (!ids || ids.length === 0) {\r\n    return \"\";\r\n\r\n  } else {\r\n    if (ids.join(\"\").length > 7) {\r\n      idElems += astElem;\r\n    } else {\r\n      ids.forEach(id => {\r\n        idElems += ` <span class=\"${id === \"(*)\" ? 'ct-a' : 'ct-c'}\">${id}</span> `;\r\n      })\r\n    }\r\n  }\r\n\r\n  return ` <span id=\"${id}\" class=\"ct ${isDataCell ? 'ctd' : 'ctsh'}\">${idElems}</span> `\r\n};\r\n\r\nexport const getJsonStatTableSupportStructures = (jsonStat, layout, isPreview, removeEmptyLines, hiddenAttributes) => {\r\n  const {\r\n    rows,\r\n    cols,\r\n    filters,\r\n    filtersValue,\r\n    sections\r\n  } = layout;\r\n\r\n  const {\r\n    rowCount,\r\n    rowsObj,\r\n    colCount,\r\n    colsObj,\r\n    combinations,\r\n    indexesMap\r\n  } = getJsonStatLayoutObjects(jsonStat, rows, cols, sections, filters, filtersValue, isPreview);\r\n\r\n  /** empty rows & cols handling **/\r\n\r\n  let valorizedRowsPerSection = (combinations && combinations.length > 0)\r\n    ? combinations.map(() => [])\r\n    : [[]];\r\n  let valorizedCols = [];\r\n\r\n  if (removeEmptyLines) {\r\n    valorizedRowsPerSection = valorizedRowsPerSection.map(() => new Array(rowCount).fill(false));\r\n    valorizedCols = new Array(colCount).fill(false);\r\n\r\n    const setValorizedLines = (combination, idx) => {\r\n\r\n      const dataObj = {\r\n        ...filtersValue\r\n      };\r\n      sections.forEach((section, idx) => dataObj[section] = combination[idx]);\r\n\r\n      for (let r = 0; r < rowCount; r++) {\r\n\r\n        rows.forEach(row => dataObj[row] = rowsObj[row].ids[r]);\r\n\r\n        for (let c = 0; c < colCount; c++) {\r\n\r\n          if (!(valorizedRowsPerSection[idx][r] === true && valorizedCols[c] === true)) {\r\n\r\n            cols.forEach(col => dataObj[col] = colsObj[col].ids[c]);\r\n\r\n            const dataIndexArr = jsonStat.id.map(dim => indexesMap[dim][dataObj[dim]]);\r\n\r\n            const value = jsonStat.value[getDataIdxFromDimensionsArray(dataIndexArr, jsonStat.size)];\r\n\r\n            if (value !== null && value !== undefined) {\r\n              valorizedRowsPerSection[idx][r] = true;\r\n              valorizedCols[c] = true;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    if (sections && sections.length > 0) {\r\n      combinations.forEach((combination, idx) => setValorizedLines(combination, idx));\r\n    } else {\r\n      setValorizedLines(null, 0)\r\n    }\r\n\r\n  } else {\r\n    valorizedRowsPerSection = valorizedRowsPerSection.map(() => new Array(rowCount).fill(true));\r\n    valorizedCols = new Array(colCount).fill(true);\r\n  }\r\n\r\n  let totalRowCount = 0;\r\n  valorizedRowsPerSection.forEach(section => totalRowCount += getValorizedElCount(section))\r\n\r\n  let valorizedRows;\r\n  if (Array.prototype.flat) {\r\n    valorizedRows = valorizedRowsPerSection.flat();\r\n  } else {\r\n    valorizedRows = [];\r\n    valorizedRowsPerSection.forEach(section => valorizedRows = valorizedRows.concat(section));\r\n  }\r\n\r\n  /** dimension attributes handling **/\r\n  const dimensionAttributesMap = getDimensionAttributeMap(\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    (ids, dim, dimValue) => getCellAttributeIdsElem(ids, `${dim},${dimValue}`, false)\r\n  );\r\n\r\n  /** observation attributes handling **/\r\n  const observations = (jsonStat?.extension?.attributes?.observation || []);\r\n  const observationIndexes = (jsonStat?.extension?.attributes?.index?.observation || {});\r\n  const observationAttributesMap = _.cloneDeep(observationIndexes);\r\n\r\n  let hasAttributeObservationError = false;\r\n  for (let key in observationAttributesMap) {\r\n    if (observationAttributesMap.hasOwnProperty(key)) {\r\n      const attributeObjects = getAttributeObjects(observationAttributesMap[key], observations, hiddenAttributes);\r\n      if (attributeObjects !== null && attributeObjects !== -1) {\r\n        observationAttributesMap[key] = {\r\n          attributes: attributeObjects.attributes,\r\n          ids: attributeObjects.ids,\r\n          htmlString: getCellAttributeIdsElem(attributeObjects.ids, key, true)\r\n        };\r\n      } else if (attributeObjects === -1) {\r\n        hasAttributeObservationError = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  return {\r\n    rows,\r\n    cols,\r\n    sections,\r\n    filters,\r\n    filtersValue,\r\n    colCount: getValorizedElCount(valorizedCols),\r\n    rowCount: (combinations && combinations.length > 0)\r\n      ? totalRowCount\r\n      : getValorizedElCount(valorizedRowsPerSection[0]),\r\n    colsObj,\r\n    rowsObj,\r\n    combinations,\r\n    indexesMap,\r\n    valorizedCols,\r\n    valorizedRows,\r\n    valorizedRowsPerSection,\r\n    sectionsLength: valorizedRowsPerSection[0].length,\r\n    dimensionAttributesMap,\r\n    observationAttributesMap,\r\n    hasAttributeObservationError\r\n  }\r\n};\r\n\r\nconst getTableRightPadding = padding => padding\r\n  ? `<td class=\"c c-rb\" style=\"min-width: ${padding}px;\">`\r\n  : \"\";\r\n\r\nexport const getJsonStatTableHtml = (\r\n  jsonStat,\r\n  rows,\r\n  cols,\r\n  sections,\r\n  filters,\r\n  filtersValue,\r\n  colCount,\r\n  rowCount,\r\n  colsObj,\r\n  rowsObj,\r\n  combinations,\r\n  indexesMap,\r\n  valorizedCols,\r\n  valorizedRows,\r\n  valorizedRowsPerSection,\r\n  sectionsLength,\r\n  labelFormat,\r\n  fontSize,\r\n  decimalSeparator,\r\n  decimalPlaces,\r\n  emptyChar,\r\n  isPreview,\r\n  paginationParams,\r\n  dimensionAttributesMap,\r\n  observationAttributesMap,\r\n  onTimeSet\r\n) => {\r\n\r\n  /** pagination **/\r\n\r\n  const origColStart = paginationParams ? paginationParams.colStart : 0;\r\n  const origColEnd = paginationParams ? paginationParams.colEnd : colCount;\r\n\r\n  const rowStart = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedRows, paginationParams.rowStart)\r\n    : getCorrespondingIndexInFilteredArray(valorizedRows, 0);\r\n\r\n  const rowEnd = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedRows, paginationParams.rowEnd)\r\n    : getValorizedElCount(valorizedRows);\r\n\r\n  const colStart = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedCols, paginationParams.colStart)\r\n    : getCorrespondingIndexInFilteredArray(valorizedCols, 0);\r\n\r\n  const colEnd = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedCols, paginationParams.colEnd)\r\n    : getValorizedElCount(valorizedCols);\r\n\r\n  const t0 = performance.now();\r\n\r\n  /** HTML generating **/\r\n\r\n  let table = `<table id=\"${uuidv4()}\">`;\r\n\r\n  /** table head **/\r\n\r\n  table += '<thead>';\r\n\r\n  cols.forEach((col, idx) => {\r\n    table += `<tr data-row-key=\"h-${idx}\">`;\r\n    table += `<th class=\"c cf${fontSize} ch cl0\" colspan=\"${rows.length}\">${getDimensionLabelFromJsonStat(jsonStat, col, labelFormat)}</th>`;\r\n\r\n    if (!isPreview) {\r\n\r\n      let c = colStart;\r\n      let colVisited = origColStart;\r\n      while (colVisited < origColEnd) {\r\n\r\n        const cc = c;\r\n        let fullColSpan = colsObj[col].ids.slice(c, c + colsObj[col].repCount).filter(el => el === colsObj[col].ids[cc]).length;\r\n\r\n        let colSpan = valorizedCols.slice(c, c + fullColSpan).filter(el => el === true).length;\r\n\r\n        if (colVisited + colSpan > origColEnd) {\r\n          colSpan = origColEnd - colVisited;\r\n        }\r\n\r\n        if (colSpan > 0) {\r\n\r\n          const htmlString = (dimensionAttributesMap?.[col]?.[colsObj[col].ids[c]]?.htmlString || \"\");\r\n\r\n          table += (\r\n            `<th class=\"c cf${fontSize} csh ${htmlString.length > 0 ? 'ca' : ''}\" colspan=\"${colSpan}\">` +\r\n            getDimensionValueLabelFromJsonStat(jsonStat, col, colsObj[col].ids[c], labelFormat) +\r\n            htmlString +\r\n            `</th>`\r\n          );\r\n        }\r\n\r\n        c += fullColSpan;\r\n        colVisited += colSpan;\r\n      }\r\n\r\n    } else {\r\n      for (let c = 0; c < 3; c++) {\r\n        table += `<th class=\"c cf${fontSize} csh\" colspan=\"1\">${JSONSTAT_TABLE_PREVIEW_PLACEHOLDER}</th>`;\r\n      }\r\n    }\r\n\r\n    table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n    table += '</tr>';\r\n  });\r\n\r\n  if (rows.length > 0) {\r\n    table += `<tr data-row-key=\"hh\">`;\r\n    rows.forEach((row, idx) => table += `<th class=\"c cf${fontSize} ch cl${idx}\">${getDimensionLabelFromJsonStat(jsonStat, row, labelFormat)}</th>`);\r\n    if (!isPreview) {\r\n      table += `<th class=\"c cf${fontSize} csh\" colspan=\"${origColEnd - origColStart}\"/>`;\r\n    } else {\r\n      table += `<th class=\"c cf${fontSize} csh\" colspan=\"${cols.length > 0 ? 3 : 1}\"/>`;\r\n    }\r\n    table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n    table += '</tr>';\r\n  }\r\n\r\n  table += '</thead>';\r\n\r\n  /** table body **/\r\n\r\n  table += '<tbody id=\"body\">';\r\n\r\n  if (!isPreview) {\r\n\r\n    const sectionsStarts = [0];\r\n    valorizedRowsPerSection.forEach((valorizedRows, idx) => sectionsStarts.push(sectionsStarts[idx] + valorizedRows.length));\r\n\r\n    const subHeaderHandled = {};\r\n    rows.forEach(row => subHeaderHandled[row] = -1);\r\n\r\n    let currentSectionIdx = 0;\r\n    for (let i = 0; i < sectionsStarts.length; i++) {\r\n      if (rowStart >= sectionsStarts[i] && (i === sectionsStarts.length - 1 || rowStart < sectionsStarts[i + 1])) {\r\n        currentSectionIdx = i;\r\n      }\r\n    }\r\n\r\n    const getSectionRow = currentSectionIdx => {\r\n      let sectionRow = `<tr data-row-key=\"s-${currentSectionIdx}\" class=\"rs\">`;\r\n      let sectionLabel = \"\";\r\n      const currentSectionIdxClone = currentSectionIdx;\r\n      sections.forEach((section, idx) => {\r\n\r\n        const htmlString = (dimensionAttributesMap?.[section]?.[combinations[currentSectionIdxClone][idx]]?.htmlString || \"\");\r\n\r\n        sectionLabel += (\r\n          `<span class=\"${htmlString.length > 0 ? 'ca' : ''}\" style=\"display: inline-block;\">` +\r\n          `<span class=\"cs-d\">${getDimensionLabelFromJsonStat(jsonStat, section, labelFormat)}:</span> ${getDimensionValueLabelFromJsonStat(jsonStat, section, combinations[currentSectionIdxClone][idx], labelFormat)}` +\r\n          htmlString +\r\n          '</span>'\r\n        );\r\n        sectionLabel += idx < (sections.length - 1) ? `<span style=\"display: inline-block; margin: 0 8px\">${JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR}</span>` : '';\r\n      });\r\n\r\n      sectionRow += `<th class=\"c cf${fontSize} cs\" colspan=\"${origColEnd - origColStart + (rows.length || 1)}\">${sectionLabel}</th>`;\r\n\r\n      sectionRow += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n      sectionRow += '</tr>';\r\n\r\n      return sectionRow;\r\n    }\r\n\r\n    if (sections && sections.length > 0) {\r\n      table += getSectionRow(currentSectionIdx);\r\n    }\r\n\r\n    for (let r = rowStart; r < rowEnd; r++) {\r\n\r\n      if (sections && sections.length > 0) {\r\n        if (r > rowStart && sectionsStarts.indexOf(r) !== -1) {\r\n          currentSectionIdx = sectionsStarts.indexOf(r);\r\n          table += getSectionRow(currentSectionIdx);\r\n        }\r\n      }\r\n\r\n      if (valorizedRows[r] === true) {\r\n\r\n        table += `<tr data-row-key=\"r-${r}\">`;\r\n\r\n        let subHeader = \"\";\r\n\r\n        if (rows.length > 0) {\r\n          for (let rr = 0; rr < rows.length; rr++) {\r\n\r\n            const htmlString = (dimensionAttributesMap?.[rows[rr]]?.[rowsObj[rows[rr]].ids[r % sectionsLength]]?.htmlString || \"\");\r\n\r\n            if (r > subHeaderHandled[rows[rr]]) {\r\n\r\n              let rowSpan = valorizedRows.slice(r, r + (rowsObj[rows[rr]].repCount - (r % rowsObj[rows[rr]].repCount))).filter(el => el === true).length;\r\n              if (r + rowSpan > rowEnd) {\r\n                rowSpan = rowEnd - r;\r\n              }\r\n\r\n              subHeaderHandled[rows[rr]] = r + (rowsObj[rows[rr]].repCount - (r % rowsObj[rows[rr]].repCount)) - 1;\r\n\r\n              if (rowSpan > 0) {\r\n                subHeader += (\r\n                  `<th class=\"c cf${fontSize} csh cl${rr} ${htmlString.length > 0 ? 'ca' : ''}\" rowspan=\"${rowSpan}\">` +\r\n                  getDimensionValueLabelFromJsonStat(jsonStat, rows[rr], rowsObj[rows[rr]].ids[r % sectionsLength], labelFormat) +\r\n                  htmlString +\r\n                  `</th>`\r\n                );\r\n              }\r\n            }\r\n          }\r\n\r\n        } else {\r\n          subHeader += `<th class=\"c cf${fontSize} csh cl0\"/>`\r\n        }\r\n\r\n        table += subHeader;\r\n\r\n        const getDataCell = (c, currentSectionIdx) => {\r\n\r\n          const dataObj = {\r\n            ...filtersValue\r\n          };\r\n          rows.forEach(row => dataObj[row] = rowsObj[row].ids[r % sectionsLength]);\r\n          cols.forEach(col => dataObj[col] = colsObj[col].ids[c]);\r\n          sections.forEach((section, idx) => dataObj[section] = combinations[currentSectionIdx][idx]);\r\n\r\n          const dataIndexArr = jsonStat.id.map(dim => indexesMap[dim][dataObj[dim]]);\r\n\r\n          const dataIdx = getDataIdxFromDimensionsArray(dataIndexArr, jsonStat.size);\r\n          const value = jsonStat.value[dataIdx];\r\n\r\n          const htmlString = (observationAttributesMap[dataIdx]?.htmlString || \"\");\r\n\r\n          return (\r\n            `<td id=\"${dataIdx}\" class=\"c cf${fontSize} ${htmlString.length > 0 ? 'ca' : ''}\">` +\r\n            htmlString +\r\n            getFormattedValue(value, decimalSeparator, decimalPlaces, emptyChar) +\r\n            `</td>`\r\n          );\r\n        }\r\n\r\n        if (valorizedRows[r] === true) {\r\n          for (let c = colStart; c < colEnd; c++) {\r\n            if (valorizedCols[c] === true) {\r\n              table += getDataCell(c, currentSectionIdx);\r\n            }\r\n          }\r\n\r\n        } else {\r\n          for (let c = colStart; c < colEnd; c++) {\r\n            table += getDataCell(c, currentSectionIdx);\r\n          }\r\n        }\r\n\r\n        table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n        table += '</tr>';\r\n      }\r\n\r\n    }\r\n\r\n    table += `<tr><td class=\"c c-bb\" colspan=\"${rows.length + (origColEnd - origColStart + (rows.length > 0 ? 0 : 1))}\"></td></tr>`;\r\n\r\n  } else {\r\n\r\n    if (sections && sections.length > 0) {\r\n      table += `<tr data-row-key=\"s-0\" class=\"rs\">`;\r\n      let sectionLabel = \"\";\r\n      sections.forEach((section, idx) => {\r\n        sectionLabel += `<span style=\"display: inline-block;\"><span class=\"cs-d\">${getDimensionLabelFromJsonStat(jsonStat, section, labelFormat)}:</span> ${JSONSTAT_TABLE_PREVIEW_PLACEHOLDER}</span>`;\r\n        sectionLabel += idx < (sections.length - 1) ? `<span style=\"display: inline-block; margin: 0 8px\">${JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR}</span>` : '';\r\n      });\r\n      table += `<th class=\"c cf${fontSize} cs\" colspan=\"${(rows.length || 1) + (cols.length > 0 ? 3 : 1)}\">${sectionLabel}</th>`;\r\n      table += getTableRightPadding(1);\r\n      table += '</tr>';\r\n    }\r\n    for (let r = 0; r < (rows.length > 0 ? 3 : 1); r++) {\r\n      table += `<tr data-row-key=\"r-${r}\">`;\r\n      if (rows.length > 0) {\r\n        for (let rr = 0; rr < rows.length; rr++) {\r\n          table += `<th class=\"c cf${fontSize} csh cl${rr}\">xxx</th>`;\r\n        }\r\n      } else {\r\n        table += `<th class=\"c cf${fontSize} csh cl0\">&nbsp;</th>`\r\n      }\r\n      for (let c = 0; c < (cols.length > 0 ? 3 : 1); c++) {\r\n        table += `<td class=\"c cf${fontSize}\"/>`;\r\n      }\r\n      table += getTableRightPadding(1);\r\n      table += '</tr>';\r\n    }\r\n    table += `<tr><td class=\"c c-bb\" colspan=\"${(rows.length || 1) + (cols.length > 0 ? 3 : 1)}\"></td></tr>`;\r\n  }\r\n\r\n  table += '</tbody>';\r\n\r\n  table += '</table>';\r\n\r\n  table += '<div id=\"jsonstat-table__tooltip\" class=\"ctt\"/>'\r\n\r\n  const t1 = performance.now();\r\n  if (!isPreview) {\r\n    onTimeSet(Math.round((t1 - t0) * 100) / 100);\r\n  }\r\n\r\n  return table;\r\n};","import React, {useCallback, useEffect, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport ArrowLeftIcon from '@material-ui/icons/ArrowLeft';\r\nimport ArrowRightIcon from '@material-ui/icons/ArrowRight';\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nlet timeoutID = null;\r\nconst SCROLLBARS_TIMEOUT = 100;\r\nlet intervalID = null;\r\nconst SCROLLBARS_INTERVAL = 200;\r\n\r\nlet isOnMouseDownOnSliderThumb = null;\r\n\r\nconst WHEEL_DELTA = 1;\r\n\r\nexport const SLIDER_WIDTH = 32;\r\nconst SLIDER_MARGIN = 4;\r\n\r\nconst SLIDER_RAIL_COLOR = \"#cfcfcf\";\r\nconst SLIDER_POINTER_COLOR = \"#808080\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sliderButton: {\r\n    width: SLIDER_WIDTH,\r\n    height: SLIDER_WIDTH,\r\n    padding: 0,\r\n    \"& svg\": {\r\n      width: SLIDER_WIDTH,\r\n      height: SLIDER_WIDTH,\r\n    }\r\n  },\r\n  horizontalSlider: {\r\n    color: SLIDER_POINTER_COLOR,\r\n    \"& span.MuiSlider-rail\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    },\r\n    \"& span.MuiSlider-track\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    }\r\n  },\r\n  verticalSlider: {\r\n    color: SLIDER_POINTER_COLOR,\r\n    \"& span.MuiSlider-rail\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    },\r\n    \"& span.MuiSlider-track\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    }\r\n  },\r\n  spinnerOverlay: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    position: \"absolute\",\r\n    top: 0,\r\n    left: 0\r\n  }\r\n});\r\n\r\nconst isEventInContainer = (ev, container) => {\r\n  const containerRect = container.getBoundingClientRect();\r\n  const BUFFER = 32;\r\n\r\n  return (\r\n    ev.clientY >= (containerRect.top - BUFFER) &&\r\n    ev.clientY <= (containerRect.bottom + BUFFER) &&\r\n    ev.clientX >= (containerRect.left - BUFFER) &&\r\n    ev.clientX <= (containerRect.right + BUFFER)\r\n  );\r\n};\r\n\r\nfunction CustomSlider(props) {\r\n  const {\r\n    uuid,\r\n    classes,\r\n    orientation,\r\n    value,\r\n    maxValue,\r\n    onChange,\r\n    onIncrement,\r\n    ticks,\r\n    isVerticalScrollbarVisible\r\n  } = props;\r\n\r\n  useEffect(() => {\r\n    const onMouseUp = () => {\r\n      clearInterval(intervalID);\r\n      isOnMouseDownOnSliderThumb = null;\r\n    }\r\n    window.addEventListener(\"mouseup\", onMouseUp);\r\n    return () => window.removeEventListener(\"mouseup\", onMouseUp);\r\n  }, []);\r\n\r\n  const handleChange = (value, ev, newValue, sliderId) => {\r\n    const step = Math.ceil(ticks / 10);\r\n\r\n    if (ev.type === \"mousedown\") {\r\n\r\n      isOnMouseDownOnSliderThumb = isEventInContainer(ev, $(`#${sliderId} span.MuiSlider-thumb`)[0]);\r\n\r\n      if (newValue < value) {\r\n        if ((value - step) > newValue) {\r\n          onIncrement(false, step, newValue);\r\n          clearInterval(intervalID);\r\n          intervalID = setInterval(\r\n            () => onIncrement(false, step, newValue),\r\n            SCROLLBARS_INTERVAL\r\n          );\r\n        } else {\r\n          onChange(newValue);\r\n        }\r\n      } else {\r\n        if ((value + step) < newValue) {\r\n          onIncrement(true, step, newValue);\r\n          clearInterval(intervalID);\r\n          intervalID = setInterval(\r\n            () => onIncrement(true, step, newValue),\r\n            SCROLLBARS_INTERVAL\r\n          );\r\n        } else {\r\n          onChange(newValue);\r\n        }\r\n      }\r\n\r\n    } else if (ev.type === \"mousemove\" && isOnMouseDownOnSliderThumb) {\r\n      onChange(newValue);\r\n    }\r\n  };\r\n\r\n  return orientation === \"vertical\"\r\n    ? (\r\n      <div style={{width: SLIDER_WIDTH, height: \"100%\", display: \"inline-block\", verticalAlign: \"top\"}}>\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          onMouseDown={() => {\r\n            if (value > 0) {\r\n              onIncrement(false, 1);\r\n              intervalID = setInterval(\r\n                () => onIncrement(false, 1),\r\n                SCROLLBARS_INTERVAL\r\n              );\r\n            }\r\n          }}\r\n          disabled={value === 0}\r\n        >\r\n          <ArrowDropUpIcon/>\r\n        </IconButton>\r\n        <Slider\r\n          id={`sliders__custom-sliders__vertical__${uuid}`}\r\n          orientation=\"vertical\"\r\n          value={ticks - value}\r\n          min={0}\r\n          max={ticks}\r\n          onChange={(ev, newValue) => {\r\n            const invertedValue = (ticks - newValue);\r\n            handleChange(value, ev, invertedValue, `sliders__custom-sliders__vertical__${uuid}`)\r\n          }}\r\n          track=\"inverted\"\r\n          className={classes.verticalSlider}\r\n          style={{\r\n            height: `calc(100% - ${SLIDER_WIDTH + SLIDER_WIDTH + SLIDER_MARGIN + SLIDER_MARGIN}px)`,\r\n            padding: \"0 15px\",\r\n            margin: `${SLIDER_MARGIN}px 0`\r\n          }}\r\n        />\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          onMouseDown={() => {\r\n            if (value < (maxValue - 1)) {\r\n              onIncrement(true, 1);\r\n              intervalID = setInterval(\r\n                () => onIncrement(true, 1),\r\n                SCROLLBARS_INTERVAL\r\n              );\r\n            }\r\n          }}\r\n          disabled={value >= (maxValue - 1)}\r\n        >\r\n          <ArrowDropDownIcon/>\r\n        </IconButton>\r\n      </div>\r\n    )\r\n    : (\r\n      <div style={{width: \"100%\", height: SLIDER_WIDTH, display: \"inline-block\", verticalAlign: \"middle\"}}>\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          style={{display: \"inline-block\", verticalAlign: \"middle\"}}\r\n          onMouseDown={() => {\r\n            onIncrement(false, 1);\r\n            intervalID = setInterval(\r\n              () => onIncrement(false, 1),\r\n              SCROLLBARS_INTERVAL\r\n            );\r\n          }}\r\n          disabled={value === 0}\r\n        >\r\n          <ArrowLeftIcon fontSize=\"small\"/>\r\n        </IconButton>\r\n        <Slider\r\n          id={`sliders__custom-sliders__horizontal__${uuid}`}\r\n          orientation=\"horizontal\"\r\n          value={value}\r\n          min={0}\r\n          max={ticks}\r\n          onChange={(ev, newValue) => handleChange(value, ev, newValue, `sliders__custom-sliders__horizontal__${uuid}`)}\r\n          className={classes.horizontalSlider}\r\n          style={{\r\n            width: `calc(100% - ${SLIDER_WIDTH + SLIDER_WIDTH + SLIDER_MARGIN + SLIDER_MARGIN + (isVerticalScrollbarVisible ? SLIDER_WIDTH : 0)}px)`,\r\n            padding: \"15px 0\",\r\n            display: \"inline-block\",\r\n            verticalAlign: \"middle\",\r\n            margin: `0 ${SLIDER_MARGIN}px`\r\n          }}\r\n        />\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          style={{display: \"inline-block\", verticalAlign: \"middle\"}}\r\n          onMouseDown={() => {\r\n            onIncrement(true, 1);\r\n            intervalID = setInterval(\r\n              () => onIncrement(true, 1),\r\n              SCROLLBARS_INTERVAL\r\n            );\r\n          }}\r\n          disabled={value >= (maxValue - 1)}\r\n        >\r\n          <ArrowRightIcon/>\r\n        </IconButton>\r\n        {isVerticalScrollbarVisible && (\r\n          <div style={{width: SLIDER_WIDTH, height: SLIDER_WIDTH, display: \"inline-block\", verticalAlign: \"middle\"}}/>\r\n        )}\r\n      </div>\r\n    )\r\n}\r\n\r\nfunction Scrollbars(props) {\r\n  const {\r\n    classes,\r\n    children,\r\n    verticalValue,\r\n    verticalMaxValue,\r\n    verticalTicks,\r\n    onVerticalScroll,\r\n    isVerticalScrollbarVisible,\r\n    horizontalValue,\r\n    horizontalMaxValue,\r\n    horizontalTicks,\r\n    onHorizontalScroll,\r\n    isHorizontalScrollbarVisible\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [row, setRow] = useState(verticalValue);\r\n  const [col, setCol] = useState(horizontalValue);\r\n\r\n  const [isPaginating, setIsPaginating] = useState(false);\r\n\r\n  const handleSliderScroll = (value, isVertical) => {\r\n    if (isVertical) {\r\n      setRow(value);\r\n      if (value !== row) {\r\n        setIsPaginating(true);\r\n      }\r\n    } else {\r\n      setCol(value);\r\n      if (value !== col) {\r\n        setIsPaginating(true);\r\n      }\r\n    }\r\n  };\r\n\r\n  const getIncrementedValue = (prevValue, delta, isIncrement, limit) => isIncrement\r\n    ? (prevValue + delta) > limit\r\n      ? limit\r\n      : (prevValue + delta)\r\n    : (prevValue - delta) < limit\r\n      ? limit\r\n      : (prevValue - delta);\r\n\r\n  const handleIncrement = (isIncrement, isVertical, delta, limit) => isVertical\r\n    ? setRow(prevRow => isIncrement\r\n      ? getIncrementedValue(prevRow, delta, isIncrement, (limit || (verticalMaxValue - 1)))\r\n      : getIncrementedValue(prevRow, delta, isIncrement, (limit || 0))\r\n    )\r\n    : setCol(prevCol => isIncrement\r\n      ? getIncrementedValue(prevCol, delta, isIncrement, (limit || (horizontalMaxValue - 1)))\r\n      : getIncrementedValue(prevCol, delta, isIncrement, (limit || 0))\r\n    );\r\n\r\n  const handleWheelScroll = useCallback(\r\n    ev => {\r\n      const isVertical = ev.wheelDeltaY !== 0;\r\n      const wheelDelta = isVertical\r\n        ? ev.wheelDeltaY > 0 ? -WHEEL_DELTA : WHEEL_DELTA\r\n        : ev.wheelDeltaX > 0 ? -WHEEL_DELTA : WHEEL_DELTA\r\n\r\n      const isBetween = (val, min, max) => (val >= min && val < max);\r\n\r\n      if (isVertical) {\r\n        setRow(prevRow => {\r\n          const newRow = isBetween(prevRow + wheelDelta, 0, verticalMaxValue) ? (prevRow + wheelDelta) : prevRow\r\n          return isVerticalScrollbarVisible\r\n            ? newRow\r\n            : prevRow\r\n        });\r\n      } else {\r\n        setCol(prevCol => {\r\n          const newCol = isBetween(prevCol + wheelDelta, 0, horizontalMaxValue) ? (prevCol + wheelDelta) : prevCol;\r\n          return isHorizontalScrollbarVisible\r\n            ? newCol\r\n            : prevCol\r\n        });\r\n      }\r\n    },\r\n    [isVerticalScrollbarVisible, isHorizontalScrollbarVisible, verticalMaxValue, horizontalMaxValue, setRow, setCol],\r\n  );\r\n\r\n  useEffect(() => {\r\n    document.getElementById(`scrollbars-container__${uuid}`).addEventListener(\"wheel\", handleWheelScroll);\r\n    return () => document.getElementById(`scrollbars-container__${uuid}`).removeEventListener(\"wheel\", handleWheelScroll);\r\n  }, [uuid, handleWheelScroll]);\r\n\r\n  useEffect(() => {\r\n    if (timeoutID) {\r\n      clearTimeout(timeoutID);\r\n    }\r\n\r\n    timeoutID = setTimeout(\r\n      () => {\r\n        onVerticalScroll(row);\r\n        onHorizontalScroll(col);\r\n        setIsPaginating(false);\r\n      },\r\n      SCROLLBARS_TIMEOUT\r\n    );\r\n  }, [row, col, onVerticalScroll, onHorizontalScroll, setIsPaginating]);\r\n\r\n  useEffect(() => {\r\n    setRow(verticalValue);\r\n    setCol(horizontalValue);\r\n  }, [verticalValue, horizontalValue, setRow, setCol]);\r\n\r\n  return (\r\n    <div id={`scrollbars-container__${uuid}`} style={{width: \"100%\", height: \"100%\"}}>\r\n      <div style={{width: \"100%\", height: `calc(100% - ${isHorizontalScrollbarVisible ? SLIDER_WIDTH : 0}px)`}}>\r\n        <div\r\n          style={{\r\n            width: `calc(100% - ${isVerticalScrollbarVisible ? SLIDER_WIDTH : 0}px)`,\r\n            height: \"100%\",\r\n            display: \"inline-block\",\r\n            verticalAlign: \"top\",\r\n            position: \"relative\"\r\n          }}\r\n        >\r\n          <div className={classes.spinnerOverlay} style={{filter: isPaginating ? \"blur(1px)\" : \"\"}}>{children}</div>\r\n          {isPaginating && (\r\n            <div className={classes.spinnerOverlay}>\r\n              <CustomEmpty\r\n                text={t(\"components.table.scrollbars.loading\") + \"...\"}\r\n                textStyle={{fontWeight: \"bold\"}}\r\n                color=\"#ffffff\"\r\n                backgroundColor=\"rgba(0, 0, 0, 0.1)\"\r\n                image={<CircularProgress style={{color: \"#ffffff\"}}/>}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n        {isVerticalScrollbarVisible && (\r\n          <CustomSlider\r\n            uuid={uuid}\r\n            classes={classes}\r\n            orientation=\"vertical\"\r\n            value={row}\r\n            maxValue={verticalMaxValue}\r\n            onChange={value => handleSliderScroll(value, true)}\r\n            onIncrement={(isIncrement, delta, limit) => handleIncrement(isIncrement, true, delta, limit)}\r\n            ticks={verticalTicks}\r\n            isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n          />\r\n        )}\r\n      </div>\r\n      {\r\n        isHorizontalScrollbarVisible && (\r\n          <CustomSlider\r\n            uuid={uuid}\r\n            classes={classes}\r\n            orientation=\"horizontal\"\r\n            value={col}\r\n            maxValue={horizontalMaxValue}\r\n            onChange={value => handleSliderScroll(value, false)}\r\n            onIncrement={(isIncrement, delta, limit) => handleIncrement(isIncrement, false, delta, limit)}\r\n            ticks={horizontalTicks}\r\n            isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n          />\r\n        )\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(Scrollbars)","import React, {Fragment, useCallback, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {getJsonStatTableHtml} from \"./jsonStatTable\";\r\nimport \"./style.css\"\r\nimport {setDatasetHtmlGeneratingTime} from \"../../state/dataset/datasetActions\";\r\nimport Scrollbars, {SLIDER_WIDTH} from \"./Scrollbars\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport copy from \"copy-to-clipboard\";\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../label-format-selector/constants\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {sanitize} from \"dompurify\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nexport const JSONSTAT_TABLE_FONT_SIZE_SM = \"s\";\r\nexport const JSONSTAT_TABLE_FONT_SIZE_MD = \"m\";\r\nexport const JSONSTAT_TABLE_FONT_SIZE_LG = \"l\";\r\n\r\nconst COLS_PER_PAGE = 30;\r\nconst ROWS_PER_PAGE = 50;\r\n\r\nconst SLIDER_SAFETY_MARGIN_PERCENTAGE = 20;\r\n\r\nconst TABLE_RIGHT_PADDING_CELL_WIDTH = 100;\r\n\r\nlet isFirstRender = false;\r\nlet isTimeToUpdate = false;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  table: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onTimeSet: time => dispatch(setDatasetHtmlGeneratingTime(time)),\r\n  addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  removeSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError)),\r\n});\r\n\r\nconst isElementInContainer = (el, container, isVerticalScrollbarVisible, isHorizontalScrollbarVisible, checkOnlyVertical) => {\r\n  const containerRect = container.getBoundingClientRect();\r\n  const elementRect = el.getBoundingClientRect();\r\n\r\n  return (\r\n    elementRect.top >= containerRect.top &&\r\n    elementRect.bottom <= (containerRect.bottom - (isHorizontalScrollbarVisible ? SLIDER_WIDTH : 0)) &&\r\n    (checkOnlyVertical === true || (\r\n      elementRect.left >= containerRect.left &&\r\n      elementRect.right <= (containerRect.right - (isVerticalScrollbarVisible ? SLIDER_WIDTH : 0))\r\n    ))\r\n  );\r\n}\r\n\r\nconst getAttributesValueString = (valueId, valueLabel) => `${(valueLabel || valueId)}${(valueLabel !== valueId) ? ` [${valueId}]` : ''}`\r\n\r\nfunction JsonStatTable(props) {\r\n  const {\r\n    classes,\r\n    jsonStat,\r\n    layout,\r\n    labelFormat = LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME,\r\n    fontSize,\r\n    isFullscreen,\r\n    isPreview = false,\r\n    removeEmptyLines = !isPreview,\r\n    isPaginated = !isPreview,\r\n    isStickyHeader = true,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    hiddenAttributes,\r\n    addSpinner,\r\n    removeSpinner,\r\n    hideSpinner = false,\r\n    onTimeSet\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n  const [spinnerUuid] = useState(uuidv4());\r\n\r\n  const [tableSupportStructures, setTableSupportStructures] = useState(null);\r\n  const [htmlTable, setHtmlTable] = useState(\"\");\r\n\r\n  const [row, setRow] = useState(0);\r\n  const [col, setCol] = useState(0);\r\n\r\n  const [visibleRowCount, setVisibleRowCount] = useState(1);\r\n  const [visibleColCount, setVisibleColCount] = useState(1);\r\n\r\n  const [tableRightPadding, setTableRightPadding] = useState(0);\r\n\r\n  const [isHorizontalScrollbarVisible, setHorizontalScrollbarVisibility] = useState(null);\r\n  const [isVerticalScrollbarVisible, setVerticalScrollbarVisibility] = useState(null);\r\n\r\n  const [attributes, setAttributes] = useState(null);\r\n  const [isCopiedVisible, setCopiedVisibility] = useState(false);\r\n\r\n  const [worker] = useState(() => new Worker(\"./workers/getJsonStatTableSupportStructuresWorker.js\"));\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (worker) {\r\n        worker.terminate();\r\n      }\r\n    }\r\n  }, [worker]);\r\n\r\n  const handleStyle = useCallback(\r\n    (isFirstRender, isResizing) => {\r\n      if (!isPreview && tableSupportStructures) {\r\n\r\n        if (!isResizing) {\r\n\r\n          /** attribute's tooltip handling **/\r\n          const $tooltip = $(`.jsonstat-table__${uuid} #jsonstat-table__tooltip`);\r\n          $(`.jsonstat-table__${uuid} .ca .ct`)\r\n            .hover(\r\n              function () {\r\n                const $elem = $(this).get(0);\r\n                const rect = $elem.getBoundingClientRect();\r\n\r\n                const attributes = $elem.className.includes(\"ctd\")\r\n                  ? tableSupportStructures.observationAttributesMap[$elem.id].attributes\r\n                  : tableSupportStructures.dimensionAttributesMap[$elem.id.split(\",\")[0]][$elem.id.split(\",\")[1]].attributes;\r\n\r\n                const ATTRIBUTE_HEIGHT = 18;\r\n\r\n                attributes.forEach(({id, label, valueId, valueLabel}) => {\r\n                  $tooltip.append($(`<li class=\"cttt\"><b>${(label || id)}</b>: ${getAttributesValueString(valueId, valueLabel)}</li>`))\r\n                })\r\n\r\n                const left = rect.x < (window.innerWidth / 2)\r\n                  ? rect.left\r\n                  : rect.left - $tooltip.innerWidth();\r\n\r\n                $tooltip.css({\r\n                  visibility: \"visible\",\r\n                  top: rect.top - (ATTRIBUTE_HEIGHT * attributes.length) - 30,\r\n                  left: left\r\n                });\r\n              },\r\n              function () {\r\n                $tooltip.empty().css({visibility: \"hidden\"});\r\n              }\r\n            )\r\n            .click(\r\n              function () {\r\n                const $elem = $(this).get(0);\r\n\r\n                const attributes = $elem.className.includes(\"ctd\")\r\n                  ? tableSupportStructures.observationAttributesMap[$elem.id].attributes\r\n                  : tableSupportStructures.dimensionAttributesMap[$elem.id.split(\",\")[0]][$elem.id.split(\",\")[1]].attributes;\r\n\r\n                setAttributes(attributes);\r\n              }\r\n            );\r\n\r\n          /** header's height handling **/\r\n          const cell = $(`.jsonstat-table__${uuid} th.c:first`);\r\n          if ((cell.css(\"minWidth\") || \"\") === \"\" || (cell.css(\"minWidth\") || \"\") === \"0px\") {\r\n\r\n            const cellFontSize = cell.css(\"fontSize\")\r\n            const cellPaddingLeft = Number(cell.css(\"paddingLeft\").split(\"px\")[0])\r\n            const cellPaddingRight = Number(cell.css(\"paddingRight\").split(\"px\")[0])\r\n\r\n            const getTextWidthEl = $('<span>').css({\r\n              visibility: 'hidden',\r\n              position: 'absolute',\r\n              fontSize: cellFontSize\r\n            }).appendTo('body').get(0);\r\n\r\n            $(`.jsonstat-table__${uuid} table thead th`).each(function () {\r\n              const minWidth = getTextWidth($(this).text(), getTextWidthEl);\r\n              $(this).css({minWidth: ((minWidth / 2) + cellPaddingLeft + cellPaddingRight + 24)})\r\n            })\r\n\r\n            $(getTextWidthEl).remove();\r\n          }\r\n        }\r\n\r\n        if (!isPaginated) {\r\n\r\n          const stickyRowCount = (layout.cols.length + 1);\r\n          const stickyColCount = layout.rows.length;\r\n\r\n          if (isStickyHeader) {\r\n\r\n            /** header **/\r\n            const tops = [0];\r\n            const $headerRows = $(`.jsonstat-table__${uuid} thead tr`);\r\n            for (let i = 0; i < $headerRows.length; i++) {\r\n              tops.push(tops[i] + $headerRows[i].getBoundingClientRect().height);\r\n            }\r\n            for (let i = 0; i < (tops.length - 1); i++) {\r\n              $(`.jsonstat-table__${uuid} thead tr:nth-child(${i + 1}) th`).css(\"top\", tops[i]);\r\n            }\r\n\r\n            /** columns **/\r\n            const lefts = [0];\r\n            const $firstBodyRowThs = $(`.jsonstat-table__${uuid} tbody tr:not(.rs):first th`);\r\n            for (let i = 0; i < $firstBodyRowThs.length; i++) {\r\n              lefts.push(lefts[i] + $firstBodyRowThs[i].getBoundingClientRect().width);\r\n            }\r\n            for (let i = 0; i < (lefts.length - 1); i++) {\r\n              // the class \"clX\" is assigned during the html generation to the x-th column for each row, if this column have to be sticky\r\n              $(`.jsonstat-table__${uuid} th.cl${i}`).css(\"left\", lefts[i]);\r\n            }\r\n\r\n            /** sections **/\r\n            $(`.jsonstat-table__${uuid} .cs`).css({top: tops[tops.length - 1], left: 0});\r\n\r\n          } else {\r\n\r\n            if (!isFirstRender) {\r\n\r\n              /** header **/\r\n              for (let i = 0; i < stickyRowCount; i++) {\r\n                $(`.jsonstat-table__${uuid} thead tr:nth-child(${i + 1}) th`).css(\"top\", \"auto\");\r\n              }\r\n\r\n              /** columns **/\r\n              for (let i = 0; i < stickyColCount; i++) {\r\n                // the class \"clX\" is assigned during the html generation to the x-th column for each row, if this column have to be sticky\r\n                $(`.jsonstat-table__${uuid} th.cl${i}`).css(\"left\", \"auto\");\r\n              }\r\n\r\n              /** sections **/\r\n              $(`.jsonstat-table__${uuid} .cs`).css({top: \"auto\", left: \"auto\"});\r\n            }\r\n          }\r\n        }\r\n\r\n        removeSpinner(spinnerUuid);\r\n      }\r\n    },\r\n    [uuid, tableSupportStructures, layout, isPreview, isStickyHeader, isPaginated, removeSpinner, spinnerUuid]\r\n  );\r\n\r\n  const handleScrollbar = useCallback(\r\n    updateVisibleRowAndColCount => {\r\n      let $tableContainer = $(`.jsonstat-table__${uuid}`);\r\n\r\n      if ($tableContainer && tableSupportStructures) {\r\n\r\n        let isVerticalScrollbarVisible = null;\r\n        let isHorizontalScrollbarVisible = null;\r\n\r\n        const {rowCount, colCount} = tableSupportStructures;\r\n        const $table = $(`.jsonstat-table__${uuid} table`);\r\n\r\n        setVerticalScrollbarVisibility(prevIsVerticalScrollbarVisible => {\r\n          isVerticalScrollbarVisible = (row !== null && row !== undefined && row !== 0)\r\n            ? prevIsVerticalScrollbarVisible\r\n            : ((rowCount > ROWS_PER_PAGE) || (rowCount <= ROWS_PER_PAGE && $table.height() > $tableContainer.height()));\r\n          return isVerticalScrollbarVisible;\r\n        });\r\n\r\n        setHorizontalScrollbarVisibility(prevIsHorizontalScrollbarVisible => {\r\n          isHorizontalScrollbarVisible = (col !== null && col !== undefined && col !== 0)\r\n            ? prevIsHorizontalScrollbarVisible\r\n            : ((colCount > COLS_PER_PAGE) || (colCount <= COLS_PER_PAGE && ($table.width() - tableRightPadding) > $tableContainer.width()));\r\n          return isHorizontalScrollbarVisible;\r\n        });\r\n\r\n        let visibleColCount = 0;\r\n        $(`.jsonstat-table__${uuid} tbody tr:not(.rs):first td`).each((idx, el) => {\r\n          if (isElementInContainer(el, $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible)) {\r\n            visibleColCount++;\r\n          }\r\n        });\r\n        if (updateVisibleRowAndColCount) {\r\n          setVisibleColCount(visibleColCount);\r\n        }\r\n\r\n        let visibleRowCount = 0;\r\n        $(`.jsonstat-table__${uuid} tbody tr:not(.rs)`).each((idx, el) => {\r\n          if (isElementInContainer($(el).children(\"td\")[0], $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible)) {\r\n            visibleRowCount++;\r\n          }\r\n        });\r\n        $(`.jsonstat-table__${uuid} tbody tr.rs`).each((idx, el) => {\r\n          if (isElementInContainer(el, $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible, true)) {\r\n            visibleRowCount++;\r\n          }\r\n        });\r\n        if (updateVisibleRowAndColCount) {\r\n          setVisibleRowCount(visibleRowCount);\r\n        }\r\n      }\r\n    },\r\n    [uuid, tableSupportStructures, tableRightPadding, row, col]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (jsonStat && layout) {\r\n      isTimeToUpdate = false;\r\n      setTableSupportStructures(null);\r\n      setHtmlTable(\"\");\r\n\r\n      if (!hideSpinner && !isPreview) {\r\n        addSpinner(spinnerUuid, t(\"components.table.spinners.rendering\"));\r\n      }\r\n\r\n      worker.onmessage = event => {\r\n        isTimeToUpdate = true;\r\n        setTableSupportStructures(event.data);\r\n        if (event.data.hasAttributeObservationError) {\r\n          window.error.show(t(\"components.table.error.observationAttribute\"));\r\n        }\r\n      };\r\n      worker.postMessage({\r\n        jsonStat,\r\n        layout,\r\n        isPreview,\r\n        removeEmptyLines,\r\n        hiddenAttributes\r\n      });\r\n\r\n      setRow(0);\r\n      setCol(0);\r\n      isFirstRender = true;\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [jsonStat, layout, isPreview, removeEmptyLines, hideSpinner, addSpinner, spinnerUuid, t]); // TODO: include \"hiddenAttributes\" in deps array\r\n\r\n  useEffect(() => {\r\n    if (isTimeToUpdate && tableSupportStructures) {\r\n      const func = () => {\r\n        handleStyle(false, true);\r\n        handleScrollbar(true);\r\n      }\r\n      window.addEventListener(\"resize\", func);\r\n      return () => window.removeEventListener(\"resize\", func);\r\n    }\r\n  }, [tableSupportStructures, handleStyle, handleScrollbar]);\r\n\r\n  useEffect(() => {\r\n    if (isTimeToUpdate && tableSupportStructures) {\r\n      const {\r\n        rows,\r\n        cols,\r\n        sections,\r\n        filters,\r\n        filtersValue,\r\n        colCount,\r\n        rowCount,\r\n        colsObj,\r\n        rowsObj,\r\n        combinations,\r\n        indexesMap,\r\n        valorizedCols,\r\n        valorizedRows,\r\n        valorizedRowsPerSection,\r\n        sectionsLength,\r\n        dimensionAttributesMap,\r\n        observationAttributesMap\r\n      } = tableSupportStructures;\r\n\r\n      const rowEnd = (row + ROWS_PER_PAGE) >= rowCount ? rowCount : (row + ROWS_PER_PAGE);\r\n      const colEnd = (col + COLS_PER_PAGE) >= colCount ? colCount : (col + COLS_PER_PAGE);\r\n\r\n      const tableRightPadding = (COLS_PER_PAGE - (colEnd - col)) * TABLE_RIGHT_PADDING_CELL_WIDTH;\r\n      setTableRightPadding(tableRightPadding);\r\n\r\n      setHtmlTable(getJsonStatTableHtml(\r\n        jsonStat,\r\n        rows,\r\n        cols,\r\n        sections,\r\n        filters,\r\n        filtersValue,\r\n        colCount,\r\n        rowCount,\r\n        colsObj,\r\n        rowsObj,\r\n        combinations,\r\n        indexesMap,\r\n        valorizedCols,\r\n        valorizedRows,\r\n        valorizedRowsPerSection,\r\n        sectionsLength,\r\n        labelFormat,\r\n        (fontSize || JSONSTAT_TABLE_FONT_SIZE_MD),\r\n        decimalSeparator,\r\n        decimalPlaces,\r\n        sanitize(emptyChar),\r\n        isPreview,\r\n        isPaginated\r\n          ? {\r\n            rowStart: row,\r\n            rowEnd: rowEnd,\r\n            colStart: col,\r\n            colEnd: colEnd,\r\n            tableRightPadding: !isPreview ? tableRightPadding : 1\r\n          }\r\n          : null,\r\n        dimensionAttributesMap,\r\n        observationAttributesMap,\r\n        onTimeSet\r\n      ));\r\n\r\n      $(`.jsonstat-table__${uuid}`).scrollTop(0).scrollLeft(0);\r\n    }\r\n  }, [uuid, tableSupportStructures, jsonStat, labelFormat, fontSize, isFullscreen, decimalSeparator, decimalPlaces, emptyChar, isPreview, isPaginated, onTimeSet, row, col]);\r\n\r\n  useEffect(() => {\r\n    if (isTimeToUpdate && htmlTable && htmlTable.length > 0) {\r\n      handleStyle(isFirstRender, false);\r\n      handleScrollbar(isFirstRender);\r\n\r\n      isFirstRender = false;\r\n    }\r\n  }, [htmlTable, handleStyle, handleScrollbar]);\r\n\r\n  return (\r\n    <Fragment>\r\n      {tableSupportStructures\r\n        ? (\r\n          <div className={classes.root}>\r\n            {isPaginated\r\n              ? (\r\n                <Scrollbars\r\n                  verticalValue={row}\r\n                  verticalMaxValue={tableSupportStructures.rowCount}\r\n                  verticalTicks={tableSupportStructures.rowCount - (visibleRowCount - Math.floor(visibleRowCount / 100 * SLIDER_SAFETY_MARGIN_PERCENTAGE))}\r\n                  onVerticalScroll={setRow}\r\n                  isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n                  horizontalValue={col}\r\n                  horizontalMaxValue={tableSupportStructures.colCount}\r\n                  horizontalTicks={tableSupportStructures.colCount - (visibleColCount - Math.floor(visibleColCount / 100 * SLIDER_SAFETY_MARGIN_PERCENTAGE))}\r\n                  onHorizontalScroll={setCol}\r\n                  isHorizontalScrollbarVisible={isHorizontalScrollbarVisible}\r\n                >\r\n                  <div\r\n                    className={`${classes.table} jsonstat-table jsonstat-table__${uuid}`}\r\n                    style={{overflow: \"hidden\"}}\r\n                    dangerouslySetInnerHTML={{__html: htmlTable}}\r\n                  />\r\n                </Scrollbars>\r\n              )\r\n              : (\r\n                <div\r\n                  className={`${classes.table} jsonstat-table jsonstat-table__${uuid}`}\r\n                  style={{overflow: \"auto\"}}\r\n                  dangerouslySetInnerHTML={{__html: htmlTable}}\r\n                />\r\n              )\r\n            }\r\n          </div>\r\n        )\r\n        : (\r\n          <CustomEmpty text={t(\"components.table.initializing\") + \"...\"}/>\r\n        )\r\n      }\r\n      <Snackbar\r\n        open={isCopiedVisible}\r\n        autoHideDuration={2000}\r\n        onClose={() => setCopiedVisibility(prevVal => !prevVal)}\r\n      >\r\n        <Alert severity=\"success\" onClose={() => setCopiedVisibility(prevVal => !prevVal)}>\r\n          {t(\"components.table.alerts.attributeCopied\")}\r\n        </Alert>\r\n      </Snackbar>\r\n      <Dialog\r\n        open={attributes !== null}\r\n        onClose={() => setAttributes(null)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.table.dialogs.observationAttributes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{width: 480}}>\r\n          <Grid container spacing={2}>\r\n            {(attributes || []).map(({id, label, valueId, valueLabel}, idx) =>\r\n              <Grid item key={idx} xs={12}>\r\n                <b>{label || id}</b>{`: ${getAttributesValueString(valueId, valueLabel)}`}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setAttributes(null)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n          <Button\r\n            color=\"primary\"\r\n            autoFocus\r\n            onClick={() => {\r\n              copy(attributes\r\n                .map(({id, label, valueId, valueLabel}) => `${(label || id)}: ${getAttributesValueString(valueId, valueLabel)}`)\r\n                .join(\", \")\r\n              );\r\n              setCopiedVisibility(prevVal => !prevVal)();\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.copy\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(null, mapDispatchToProps),\r\n  withStyles(styles)\r\n)(JsonStatTable);","import React from \"react\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  cardTitle: {\r\n    fontSize: 17,\r\n    fontWeight: \"bold\"\r\n  },\r\n  datasetAttributesCard: {\r\n    background: \"#F5F5F5\"\r\n  },\r\n  datasetAttributes: {\r\n    margin: 0,\r\n    padding: \"0 16px 16px\"\r\n  },\r\n  seriesAttributes: {\r\n    margin: 0,\r\n    padding: \"0 0 16px\"\r\n  },\r\n  attributeGroup: {\r\n    margin: 0,\r\n    padding: \"0 16px\"\r\n  }\r\n});\r\n\r\nconst Attribute = ({attribute, list}) =>\r\n  <Grid item xs={12}>\r\n    {`${list ? \"- \" : \"\"}${attribute.id}: ${attribute.value}`}\r\n  </Grid>;\r\n\r\nfunction AttributeList(props) {\r\n\r\n  const {\r\n    classes,\r\n    datasetAttributes,\r\n    otherAttributes\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {datasetAttributes.length > 0 && (\r\n        <Card variant=\"outlined\" className={classes.datasetAttributesCard}>\r\n          <CardHeader\r\n            title={\r\n              <div className={classes.cardTitle}>\r\n                {t(\"components.attributeList.datasetInformation.title\")}:\r\n              </div>\r\n            }\r\n            disableTypography\r\n          />\r\n          <Grid container spacing={2} className={classes.datasetAttributes}>\r\n            {datasetAttributes.map((attribute, idx) =>\r\n              <Attribute\r\n                key={idx}\r\n                attribute={attribute}\r\n              />\r\n            )}\r\n          </Grid>\r\n        </Card>\r\n      )}\r\n      {otherAttributes.length > 0 && (\r\n        <Card variant=\"outlined\" style={{marginTop: 16}}>\r\n          <CardHeader\r\n            title={\r\n              <div className={classes.cardTitle}>\r\n                {t(\"components.attributeList.seriesInformation.title\")}:\r\n              </div>\r\n            }\r\n            disableTypography\r\n          />\r\n          <Grid container spacing={2} className={classes.seriesAttributes}>\r\n            {otherAttributes.map(({dims, attributes}, idx) =>\r\n              <Grid\r\n                container\r\n                key={idx}\r\n                spacing={2}\r\n                className={classes.attributeGroup}\r\n                style={{background: idx % 2 ? \"#FFFFFF\" : \"#F5F5F5\"}}\r\n              >\r\n                <Grid item xs={12}>\r\n                  {dims.map(({id, value}, idx) =>\r\n                    <div key={idx} style={{display: \"inline-block\", marginRight: 8}}>\r\n                      <b>{id}</b>: <i>{value}</i>{idx < dims.length - 1 ? \",\" : \"\"}\r\n                    </div>\r\n                  )}\r\n                </Grid>\r\n                {attributes.map((attribute, idx) =>\r\n                  <Attribute\r\n                    key={idx}\r\n                    attribute={attribute}\r\n                    list\r\n                  />\r\n                )}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(AttributeList)","import _ from \"lodash\"\r\n\r\nexport function getMaxTreeDepth(tree, childrenKey) {\r\n\r\n  const recursive = node =>\r\n    node\r\n      ? 1 + Math.max(...(node[childrenKey] || []).map(recursive), 0)\r\n      : 0;\r\n\r\n  return tree\r\n    ? Math.max(...tree.map(recursive), 0)\r\n    : 0;\r\n}\r\n\r\nexport function getNodesAtDepth(tree, childrenKey, depth) {\r\n\r\n  const res = [];\r\n\r\n  const recursive = (subTree, currDepth) =>\r\n    subTree\r\n      ? (\r\n        subTree.map(node => {\r\n          if (depth === currDepth) {\r\n            res.push(_.cloneDeep(node));\r\n          }\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            recursive(node[childrenKey], currDepth + 1);\r\n          }\r\n          return null;\r\n        })\r\n      )\r\n      : [];\r\n\r\n  recursive(tree, 1);\r\n\r\n  return res;\r\n}\r\n\r\nexport function getTreeFromArray(arr, parentKey, childrenKey) {\r\n  const mappedArr = {};\r\n  const tree = [];\r\n\r\n  // first map the nodes of the array to an object -> create a hash table.\r\n  arr.forEach(el => {\r\n    el[childrenKey] = [];\r\n    mappedArr[el.id] = el;\r\n  });\r\n\r\n  arr.forEach(el => {\r\n    if (el[parentKey]) {\r\n      // if the element is not at the root level, add it to its parent array of children.\r\n      mappedArr[el[parentKey]][childrenKey].push(el);\r\n    } else {\r\n      // if the element is at the root level, add it to first level elements array.\r\n      tree.push(el);\r\n    }\r\n  });\r\n\r\n  return tree;\r\n}\r\n\r\nexport function getNode(tree, childrenKey, test) {\r\n\r\n  if (!(tree !== null && tree.length)) return null;\r\n\r\n  const foundNodes = tree.filter(test);\r\n\r\n  if (foundNodes.length) {\r\n    return foundNodes[0];\r\n  } else {\r\n    const foundNodesInChild =\r\n      tree\r\n        .filter(node => node[childrenKey])\r\n        .map(node => getNode(node[childrenKey], childrenKey, test))\r\n        .filter(result => result !== null);\r\n\r\n    if (foundNodesInChild.length) {\r\n      return foundNodesInChild[0];\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getNodes(tree, childrenKey, test) {\r\n\r\n  const res = [];\r\n\r\n  const recursive = subTree =>\r\n    subTree\r\n      ? (\r\n        subTree.map(node => {\r\n          if (test && test(node)) {\r\n            res.push(_.cloneDeep(node));\r\n          }\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            recursive(node[childrenKey]);\r\n          }\r\n          return null;\r\n        })\r\n      )\r\n      : [];\r\n\r\n  recursive(tree);\r\n\r\n  return res;\r\n}","export const FETCH_DATASET_ASYNC_HANDLER_INIT = \"fetch/dataset/async/handler/init\"\r\nexport const FETCH_DATASET_ASYNC_HANDLER_SUCCESS = \"fetch/dataset/async/handler/success\"\r\nexport const FETCH_DATASET_ASYNC_HANDLER_ERROR = \"fetch/dataset/async/handler/error\"\r\n\r\nexport const initFetchDatasetAsyncHandler = () => ({\r\n  type: FETCH_DATASET_ASYNC_HANDLER_INIT\r\n});\r\n\r\nexport const successFetchDatasetAsyncHandler = (response, statusCode, responseHeaders, cellCount, isResponseNotValid, tableLayout, mapLayout, chartLayout, worker) => ({\r\n  type: FETCH_DATASET_ASYNC_HANDLER_SUCCESS,\r\n  payload: {\r\n    response,\r\n    statusCode,\r\n    responseHeaders,\r\n    cellCount,\r\n    isResponseNotValid,\r\n    tableLayout,\r\n    mapLayout,\r\n    chartLayout,\r\n    worker\r\n  }\r\n});\r\n\r\nexport const errorFetchDatasetAsyncHandler = statusCode => ({\r\n  type: FETCH_DATASET_ASYNC_HANDLER_ERROR,\r\n  payload: {\r\n    statusCode\r\n  }\r\n});","export const getNutsLevelTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    0: t(\"nutsLevel0\"),\r\n    1: t(\"nutsLevel1\"),\r\n    2: t(\"nutsLevel2\"),\r\n    3: t(\"nutsLevel3\"),\r\n    4: t(\"nutsLevel4\"),\r\n    5: t(\"nutsLevel5\"),\r\n    6: t(\"nutsLevel6\"),\r\n    7: t(\"nutsLevel7\"),\r\n    8: t(\"nutsLevel8\"),\r\n    9: t(\"nutsLevel9\")\r\n  })\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};","import {Reducer} from \"@reduxjs/toolkit\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  ALL_FULL,\r\n  ALL_PARTIAL,\r\n  CRITERIA_SELECTION_MODE_ALL,\r\n  CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n  CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n  CRITERIA_SELECTION_TYPE_FULL,\r\n  CRITERIA_SELECTION_TYPE_PARTIAL,\r\n  DATASET_ACCESSIBLE_FETCH,\r\n  DATASET_CHART_LAYOUT_SUBMIT,\r\n  DATASET_CRITERIA_ALERT_HIDE,\r\n  DATASET_CRITERIA_HIDE,\r\n  DATASET_CRITERIA_LENGTH_WARNING_HIDE,\r\n  DATASET_CRITERIA_LENGTH_WARNING_SHOW,\r\n  DATASET_CRITERIA_SHOW,\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  DATASET_DOWNLOAD_WARNING_HIDE,\r\n  DATASET_FETCH_ENABLE,\r\n  DATASET_HTML_GENERATING_TIME_SET,\r\n  DATASET_LABEL_FORMAT_SET,\r\n  DATASET_MAP_LAYOUT_SUBMIT,\r\n  DATASET_STATE_BACKUP,\r\n  DATASET_STATE_RESET,\r\n  DATASET_STRUCTURE_CODELIST_CRITERIA_SET,\r\n  DATASET_STRUCTURE_CODELIST_FETCH,\r\n  DATASET_STRUCTURE_CODELIST_TIME_PERIOD_SET,\r\n  DATASET_STRUCTURE_CODELISTS_FETCH,\r\n  DATASET_STRUCTURE_FETCH,\r\n  DATASET_STRUCTURE_FETCH_ENABLE,\r\n  DATASET_TABLE_LAYOUT_SUBMIT,\r\n  DATASET_TERRITORY_FETCH,\r\n  DATASET_UNAVAILABLE_VIEW_WARNING_HIDE,\r\n  DATASET_VIEW_ERROR_HIDE,\r\n  DATASET_VIEW_TEMPLATE_HIDE,\r\n  DATASET_VIEW_TEMPLATE_SHOW,\r\n  DATASET_VIEW_TEMPLATE_SUBMIT,\r\n  DATASET_VIEWER_SET,\r\n  STEP_BY_STEP_FULL,\r\n  STEP_BY_STEP_PARTIAL\r\n} from \"./datasetActions\";\r\nimport {getTreeFromArray} from \"../../utils/tree\";\r\nimport {FREQ_DIMENSION_KEY, TIME_PERIOD_DIMENSION_KEY} from \"../../utils/jsonStat\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../../components/label-format-selector/constants\";\r\nimport {getViewerIdxFromType, getViewerTypeFromIdx} from \"../../components/data-viewer\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  FETCH_DATASET_ASYNC_HANDLER_ERROR,\r\n  FETCH_DATASET_ASYNC_HANDLER_INIT,\r\n  FETCH_DATASET_ASYNC_HANDLER_SUCCESS\r\n} from \"../../middlewares/fetchDatasetAsyncHandler/actions\";\r\nimport {\r\n  CRITERIA_FILTER_TYPE_CODES,\r\n  CRITERIA_FILTER_TYPE_PERIODS,\r\n  CRITERIA_FILTER_TYPE_RANGE,\r\n  getCriteriaArrayFromObject,\r\n  getCriteriaObjectFromArray,\r\n  getFreq,\r\n  getTimePeriod\r\n} from \"../../utils/criteria\";\r\nimport _ from \"lodash\";\r\nimport {getNutsLevelTranslations} from \"../../constants/getNutsLevelTranslations\";\r\n\r\nexport const GENERATING_HTML_TIME_KEY = \"generatingHtml\";\r\nexport const OBSERVATION_COUNT_KEY = \"observationCount\";\r\nexport const SERVER_TIMINGS_KEY = \"serverTimings\";\r\n\r\nconst MAX_ALLOWED_CELLS = 1000000;\r\n\r\ntype TimePeriod = {\r\n  selectorType: string,\r\n  freq: string | null,\r\n  minDate: string | null,\r\n  maxDate: string | null,\r\n  fromDate: string | null,\r\n  toDate: string | null,\r\n  periods: number | null,\r\n  missingRange: boolean\r\n};\r\n\r\nconst initialTimePeriod = {\r\n  selectorType: CRITERIA_FILTER_TYPE_RANGE,\r\n  freq: null,\r\n  minDate: null,\r\n  maxDate: null,\r\n  fromDate: null,\r\n  toDate: null,\r\n  periods: null,\r\n  missingRange: false\r\n};\r\n\r\ntype DatasetState = {\r\n  datasetId: string | null,\r\n  nodeCode: string | null\r\n  categoryPath: string[] | null,\r\n  viewId: string | null,\r\n  dataset: any | null,\r\n  accessibleDataset: string | null,\r\n  isPartialData: boolean,\r\n  isEmptyData: boolean,\r\n  isTooBigData: boolean,\r\n  isCriteriaVisible: boolean,\r\n  isCriteriaAlertVisible: boolean,\r\n  dimensions: any[] | null,\r\n  mode: string | null,\r\n  type: string | null,\r\n  viewerIdx: number,\r\n  view: any | null,\r\n  template: any | null,\r\n  hasViewLayout: boolean,\r\n  hasTemplateLayout: boolean,\r\n  hasAnnotationLayout: boolean,\r\n  tableLayout: any | null,\r\n  mapLayout: any | null,\r\n  chartLayout: any | null,\r\n  labelFormat: string | null,\r\n  criteria: object,\r\n  initialCriteria: any | null,\r\n  decimalSeparator: string | null,\r\n  decimalPlaces: number | null\r\n  emptyChar: string | null,\r\n  enableCriteria: boolean,\r\n  enableLayout: boolean,\r\n  maxAllowedCells: number,\r\n  codes: any[] | null,\r\n  isCodesFlat: boolean,\r\n  codelists: any[] | null,\r\n  areCodelistsFlat: boolean[],\r\n  codelistsLength: number[] | null,\r\n  timePeriod: TimePeriod,\r\n  timings: any | null,\r\n  isFetchStructureDisabled: boolean,\r\n  isFetchDatasetDisabled: boolean,\r\n  isDownloadWarningVisible: boolean,\r\n  isUnavailableViewWarningVisible: boolean,\r\n  isCriteriaLengthWarningVisible: boolean,\r\n  geometries: any | null,\r\n  geometryDetailLevels: any | null,\r\n  backup: any | null,\r\n  isViewVisible: boolean,\r\n  isViewErrorVisible: boolean,\r\n  viewErrorMessage: string | null,\r\n  isTemplateVisible: boolean\r\n};\r\n\r\nconst initialState = {\r\n  datasetId: null,\r\n  nodeCode: null,\r\n  categoryPath: null,\r\n  viewId: null,\r\n  dataset: null,\r\n  accessibleDataset: null,\r\n  isPartialData: false,\r\n  isEmptyData: false,\r\n  isTooBigData: false,\r\n  isCriteriaVisible: false,\r\n  isCriteriaAlertVisible: false,\r\n  dimensions: null,\r\n  mode: null,\r\n  type: null,\r\n  viewerIdx: 0,\r\n  view: null,\r\n  template: null,\r\n  hasViewLayout: false,\r\n  hasTemplateLayout: false,\r\n  hasAnnotationLayout: false,\r\n  tableLayout: null,\r\n  mapLayout: null,\r\n  chartLayout: null,\r\n  labelFormat: null,\r\n  criteria: {},\r\n  initialCriteria: null,\r\n  decimalSeparator: null,\r\n  decimalPlaces: null,\r\n  emptyChar: null,\r\n  enableCriteria: true,\r\n  enableLayout: true,\r\n  maxAllowedCells: MAX_ALLOWED_CELLS,\r\n  codes: null,\r\n  isCodesFlat: false,\r\n  codelists: null,\r\n  areCodelistsFlat: [],\r\n  codelistsLength: null,\r\n  timePeriod: initialTimePeriod,\r\n  timings: null,\r\n  isFetchStructureDisabled: true,\r\n  isFetchDatasetDisabled: true,\r\n  isDownloadWarningVisible: false,\r\n  isUnavailableViewWarningVisible: false,\r\n  isCriteriaLengthWarningVisible: false,\r\n  geometries: null,\r\n  geometryDetailLevels: null,\r\n  backup: null,\r\n  isViewVisible: false,\r\n  isViewErrorVisible: false,\r\n  viewErrorMessage: null,\r\n  isTemplateVisible: false\r\n};\r\n\r\nconst datasetReducer: Reducer<DatasetState> = (\r\n  state = initialState,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case DATASET_STATE_BACKUP: {\r\n      return {\r\n        ...initialState,\r\n        backup: {\r\n          viewId: state.viewId,\r\n          datasetId: state.datasetId,\r\n          nodeCode: state.nodeCode,\r\n          categoryPath: state.categoryPath,\r\n          template: {\r\n            defaultView: getViewerTypeFromIdx(state.viewerIdx),\r\n            criteria: getCriteriaArrayFromObject(state.criteria),\r\n            layouts: JSON.stringify({\r\n              labelFormat: state.labelFormat,\r\n              tableLayout: state.tableLayout,\r\n              tableEmptyChar: state.emptyChar,\r\n              mapLayout: state.mapLayout,\r\n              chartLayout: state.chartLayout\r\n            })\r\n          }\r\n        }\r\n      }\r\n    }\r\n    case DATASET_STATE_RESET: {\r\n      return {\r\n        ...initialState,\r\n        backup: state.backup\r\n      }\r\n    }\r\n    case DATASET_STRUCTURE_FETCH_ENABLE: {\r\n      return {\r\n        ...state,\r\n        isFetchStructureDisabled: false,\r\n        datasetId: action.payload.datasetId,\r\n        nodeCode: action.payload.nodeCode,\r\n        categoryPath: action.payload.categoryPath,\r\n        viewId: (action.payload.viewId || null)\r\n      }\r\n    }\r\n    case DATASET_FETCH_ENABLE: {\r\n      return {\r\n        ...state,\r\n        isFetchDatasetDisabled: false\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_SHOW: {\r\n      return {\r\n        ...state,\r\n        isCriteriaVisible: true\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaVisible: false,\r\n        criteria: state.initialCriteria,\r\n        codes: null,\r\n        isCodesFlat: false,\r\n        codelists: null,\r\n        areCodelistsFlat: [],\r\n        timePeriod: initialTimePeriod\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_ALERT_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaAlertVisible: false\r\n      }\r\n    }\r\n    case DATASET_STRUCTURE_CODELIST_CRITERIA_SET: {\r\n      return {\r\n        ...state,\r\n        criteria: action.criteria,\r\n        timePeriod: {\r\n          ...state.timePeriod,\r\n          freq: action.criteria[FREQ_DIMENSION_KEY]\r\n            ? getFreq(action.criteria)\r\n            : state.timePeriod.freq\r\n        }\r\n      }\r\n    }\r\n    case DATASET_STRUCTURE_CODELIST_TIME_PERIOD_SET: {\r\n      let newCriteria = _.cloneDeep(state.criteria);\r\n      const type = (action.timePeriod.selectorType || CRITERIA_FILTER_TYPE_RANGE);\r\n\r\n      newCriteria = {\r\n        ...newCriteria,\r\n        [TIME_PERIOD_DIMENSION_KEY]: (type === CRITERIA_FILTER_TYPE_PERIODS && action.timePeriod.periods === null)\r\n          ? undefined\r\n          : {\r\n            id: TIME_PERIOD_DIMENSION_KEY,\r\n            type: type,\r\n            filterValues: null,\r\n            period: type === CRITERIA_FILTER_TYPE_PERIODS ? action.timePeriod.periods : null,\r\n            from: type === CRITERIA_FILTER_TYPE_RANGE ? action.timePeriod.fromDate : null,\r\n            to: type === CRITERIA_FILTER_TYPE_RANGE ? action.timePeriod.toDate : null\r\n          }\r\n      };\r\n\r\n      return {\r\n        ...state,\r\n        timePeriod: action.timePeriod,\r\n        criteria: newCriteria\r\n      }\r\n    }\r\n    case DATASET_VIEWER_SET: {\r\n      return {\r\n        ...state,\r\n        viewerIdx: action.viewerIdx\r\n      }\r\n    }\r\n    case DATASET_TABLE_LAYOUT_SUBMIT: {\r\n      return {\r\n        ...state,\r\n        tableLayout: action.layout\r\n      }\r\n    }\r\n    case DATASET_MAP_LAYOUT_SUBMIT: {\r\n      return {\r\n        ...state,\r\n        mapLayout: action.layout\r\n      }\r\n    }\r\n    case DATASET_CHART_LAYOUT_SUBMIT: {\r\n      return {\r\n        ...state,\r\n        chartLayout: action.layout\r\n      }\r\n    }\r\n    case DATASET_LABEL_FORMAT_SET: {\r\n      return {\r\n        ...state,\r\n        labelFormat: action.labelFormat\r\n      }\r\n    }\r\n    case DATASET_DOWNLOAD_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isDownloadWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_UNAVAILABLE_VIEW_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isUnavailableViewWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_LENGTH_WARNING_SHOW: {\r\n      return {\r\n        ...state,\r\n        isCriteriaLengthWarningVisible: true,\r\n        isFetchDatasetDisabled: true\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_LENGTH_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaLengthWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_HTML_GENERATING_TIME_SET: {\r\n      return {\r\n        ...state,\r\n        timings: {\r\n          ...state.timings,\r\n          [GENERATING_HTML_TIME_KEY]: action.time\r\n        }\r\n      }\r\n    }\r\n    case FETCH_DATASET_ASYNC_HANDLER_INIT: {\r\n      return {\r\n        ...state,\r\n        dataset: null,\r\n        isFetchDatasetDisabled: true\r\n      }\r\n    }\r\n    case FETCH_DATASET_ASYNC_HANDLER_SUCCESS: {\r\n      if (action.payload.worker) {\r\n        action.payload.worker.terminate();\r\n      }\r\n      return {\r\n        ...state,\r\n        dataset: (action.payload.response?.id || \"\").length !== 0 ? action.payload.response : null,\r\n\r\n        isTooBigData: action.payload.cellCount > state.maxAllowedCells,\r\n        isEmptyData: (action.payload.statusCode === 204 || (action.payload.response?.id || \"\").length === 0),\r\n        isPartialData: action.payload.statusCode === 206,\r\n\r\n        isCriteriaVisible: action.payload.isResponseNotValid,\r\n        isCriteriaAlertVisible: action.payload.isResponseNotValid,\r\n\r\n        tableLayout: action.payload.tableLayout,\r\n        mapLayout: action.payload.mapLayout,\r\n        chartLayout: action.payload.chartLayout,\r\n\r\n        initialCriteria: action.payload.isResponseNotValid ? state.initialCriteria : state.criteria,\r\n\r\n        codes: action.payload.isResponseNotValid ? state.codes : null,\r\n        isCodesFlat: action.payload.isResponseNotValid ? state.isCodesFlat : false,\r\n        codelists: action.payload.isResponseNotValid ? state.codelists : null,\r\n        areCodelistsFlat: action.payload.isResponseNotValid ? state.areCodelistsFlat : [],\r\n        // timePeriod: action.payload.isResponseNotValid\r\n        //   ? initialTimePeriod\r\n        //   : state.timePeriod,\r\n        isCriteriaLengthWarningVisible: false,\r\n        timings: {\r\n          [OBSERVATION_COUNT_KEY]: action.payload.response?.value ? Object.keys(action.payload.response.value).length : null,\r\n          [SERVER_TIMINGS_KEY]: action.payload.responseHeaders.backendtimers\r\n            ? JSON.parse(action.payload.responseHeaders.backendtimers)\r\n            : null\r\n        }\r\n      }\r\n    }\r\n    case FETCH_DATASET_ASYNC_HANDLER_ERROR: {\r\n      const isPayloadTooLarge = action.payload.statusCode === 413\r\n      return {\r\n        ...state,\r\n        dataset: null,\r\n        accessibleDataset: null,\r\n        isPartialData: false,\r\n        isEmptyData: false,\r\n        isTooBigData: isPayloadTooLarge,\r\n        isCriteriaAlertVisible: isPayloadTooLarge\r\n      }\r\n    }\r\n    case DATASET_VIEW_TEMPLATE_SHOW: {\r\n      return {\r\n        ...state,\r\n        isViewVisible: action.isView ? true : state.isViewVisible,\r\n        isTemplateVisible: !action.isView ? true : state.isTemplateVisible\r\n      }\r\n    }\r\n    case DATASET_VIEW_TEMPLATE_HIDE: {\r\n      return {\r\n        ...state,\r\n        isViewVisible: action.isView ? false : state.isViewVisible,\r\n        isTemplateVisible: !action.isView ? false : state.isTemplateVisible\r\n      }\r\n    }\r\n    case DATASET_VIEW_ERROR_HIDE: {\r\n      return {\r\n        ...state,\r\n        isViewErrorVisible: false,\r\n        viewErrorMessage: null\r\n      }\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          return {\r\n            ...state,\r\n            isFetchStructureDisabled: true\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n          return {\r\n            ...state,\r\n            codes: null,\r\n            isCodesFlat: false\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          const criteriaView = action.payload.response.criteriaView;\r\n\r\n          const VIEW_KEY = \"view\";\r\n          const TEMPLATE_KEY = \"template\";\r\n\r\n          let viewTemplate = action.payload.response[VIEW_KEY]\r\n            ? action.payload.response[VIEW_KEY]\r\n            : action.payload.response[TEMPLATE_KEY]\r\n              ? action.payload.response[TEMPLATE_KEY]\r\n              : null;\r\n\r\n          const hasBackup = state.backup !== null && (\r\n            state.backup.nodeCode === state.nodeCode &&\r\n            (state.backup.categoryPath || []).join() === (state.categoryPath || []).join() &&\r\n            state.backup.datasetId === state.datasetId &&\r\n            (state.backup.viewId || \"\") === (state.viewId || \"\")\r\n          );\r\n\r\n          if (viewTemplate && hasBackup) {\r\n            viewTemplate = {\r\n              ...viewTemplate,\r\n              ...state.backup?.template\r\n            }\r\n          }\r\n\r\n          let viewTemplateLayouts = viewTemplate\r\n            ? JSON.parse(viewTemplate.layouts)\r\n            : null;\r\n\r\n          if (action.payload.response[VIEW_KEY]) {\r\n            if (action.payload.response[TEMPLATE_KEY]) {\r\n              const templateLayouts = JSON.parse(action.payload.response[TEMPLATE_KEY].layouts);\r\n\r\n              viewTemplate = {\r\n                ...viewTemplate,\r\n                enableCriteria: action.payload.response[TEMPLATE_KEY].enableCriteria,\r\n                enableLayout: action.payload.response[TEMPLATE_KEY].enableLayout,\r\n                decimalNumber: action.payload.response[TEMPLATE_KEY].decimalNumber,\r\n                decimalSeparator: action.payload.response[TEMPLATE_KEY].decimalSeparator,\r\n              }\r\n              viewTemplateLayouts = {\r\n                ...viewTemplateLayouts,\r\n                tableLayout: (viewTemplateLayouts.tableLayout || templateLayouts.tableLayout),\r\n                tableEmptyChar: templateLayouts.tableEmptyChar,\r\n                mapLayout: (viewTemplateLayouts.mapLayout || templateLayouts.mapLayout),\r\n                chartLayout: (viewTemplateLayouts.chartLayout || templateLayouts.chartLayout)\r\n              }\r\n\r\n            } else {\r\n              viewTemplate = {\r\n                ...viewTemplate,\r\n                enableCriteria: true,\r\n                enableLayout: true\r\n              }\r\n            }\r\n          }\r\n\r\n          const tableLayout = viewTemplateLayouts?.tableLayout\r\n            ? viewTemplateLayouts.tableLayout\r\n            : action.payload.response.layout\r\n              ? action.payload.response.layout\r\n              : null;\r\n\r\n          const mapLayout = viewTemplateLayouts?.mapLayout\r\n            ? viewTemplateLayouts.mapLayout\r\n            : null;\r\n\r\n          const chartLayout = viewTemplateLayouts?.chartLayout\r\n            ? viewTemplateLayouts.chartLayout\r\n            : null;\r\n\r\n          let structureCriteria = viewTemplate\r\n            ? viewTemplate.criteria\r\n            : (action.payload.response.filters && action.payload.response.filters.filterData)\r\n              ? action.payload.response.filters.filterData\r\n              : null;\r\n\r\n          const criteria = getCriteriaObjectFromArray(structureCriteria);\r\n\r\n          return {\r\n            ...state,\r\n            backup: null,\r\n            hasViewLayout: !!action.payload.response[VIEW_KEY],\r\n            hasTemplateLayout: !!action.payload.response[TEMPLATE_KEY],\r\n            hasAnnotationLayout: !!action.payload.response.layout,\r\n            view: action.payload.response[VIEW_KEY]\r\n              ? {\r\n                ...action.payload.response[VIEW_KEY],\r\n                layouts: JSON.parse(action.payload.response[VIEW_KEY].layouts)\r\n              }\r\n              : null,\r\n            template: action.payload.response[TEMPLATE_KEY]\r\n              ? {\r\n                ...action.payload.response[TEMPLATE_KEY],\r\n                layouts: JSON.parse(action.payload.response[TEMPLATE_KEY].layouts)\r\n              }\r\n              : null,\r\n            dimensions: action.payload.response.criteria,\r\n            mode: (criteriaView === ALL_FULL || criteriaView === ALL_PARTIAL)\r\n              ? CRITERIA_SELECTION_MODE_ALL\r\n              : CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n            type: (criteriaView === ALL_FULL || criteriaView === STEP_BY_STEP_FULL)\r\n              ? CRITERIA_SELECTION_TYPE_FULL\r\n              : (criteriaView === ALL_PARTIAL || criteriaView === STEP_BY_STEP_PARTIAL)\r\n                ? CRITERIA_SELECTION_TYPE_PARTIAL\r\n                : CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n            codelistsLength: state.codelistsLength ? state.codelistsLength : action.payload.response.criteria.map(() => null),\r\n            isCriteriaVisible: (tableLayout === null && chartLayout === null && mapLayout === null && structureCriteria === null),\r\n            viewerIdx: viewTemplate ? getViewerIdxFromType(viewTemplate.defaultView) : 0,\r\n            isUnavailableViewWarningVisible: (!!action.payload.extra?.viewId && !action.payload.response?.[VIEW_KEY]),\r\n            tableLayout: tableLayout,\r\n            mapLayout: mapLayout,\r\n            chartLayout: chartLayout,\r\n            labelFormat: (viewTemplateLayouts?.labelFormat || LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME),\r\n            criteria: criteria,\r\n            initialCriteria: criteria,\r\n            decimalSeparator: (Object.keys(viewTemplate?.decimalSeparator || {}).length > 0)\r\n              ? localizeI18nObj(viewTemplate.decimalSeparator, action.payload.extra.defaultlanguage, action.payload.extra.languages)\r\n              : action.payload.response.decimalSeparator,\r\n            decimalPlaces: (viewTemplate?.decimalNumber || action.payload.response.decimalPlaces),\r\n            emptyChar: (viewTemplateLayouts?.tableEmptyChar || action.payload.response.emptyCellPlaceHolder),\r\n            enableCriteria: viewTemplate?.enableCriteria !== false,\r\n            enableLayout: viewTemplate?.enableLayout !== false,\r\n            isFetchDatasetDisabled: !(action.payload.extra.isAccessible || !!tableLayout || !!chartLayout || !!mapLayout || !!structureCriteria),\r\n            timePeriod: {\r\n              ...state.timePeriod,\r\n              freq: getFreq(structureCriteria)\r\n            },\r\n            maxAllowedCells: (action.payload.response.maxTableCells || MAX_ALLOWED_CELLS)\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n\r\n          const dimensionCodelist = action.payload.response.criteria[0] || {};\r\n\r\n          let flatCodes = dimensionCodelist.values ? dimensionCodelist.values : [];\r\n          const codelistIdx = dimensionCodelist.id ? (state.dimensions || []).map(({id}: any) => id).indexOf(dimensionCodelist.id) : -1;\r\n\r\n          const newCodelistsLength = state.codelistsLength ? [...state.codelistsLength] : [];\r\n          if (codelistIdx >= 0 && dimensionCodelist.id !== TIME_PERIOD_DIMENSION_KEY) {\r\n            newCodelistsLength[codelistIdx] = flatCodes.length;\r\n          }\r\n\r\n          let isCodesFlat = true;\r\n          flatCodes.forEach((item: any) => {\r\n            if (isCodesFlat && item.parentId !== null && item.parentId !== undefined) {\r\n              isCodesFlat = false;\r\n            }\r\n          });\r\n\r\n          let newCriteria = _.cloneDeep(state.criteria);\r\n          if (dimensionCodelist.id !== TIME_PERIOD_DIMENSION_KEY && flatCodes.length === 1) {\r\n            newCriteria = {\r\n              ...newCriteria,\r\n              [dimensionCodelist.id]: {\r\n                id: dimensionCodelist.id,\r\n                type: CRITERIA_FILTER_TYPE_CODES,\r\n                filterValues: [flatCodes[0].id],\r\n              }\r\n            }\r\n          }\r\n\r\n          return {\r\n            ...state,\r\n            codes: getTreeFromArray((flatCodes || []), \"parentId\", \"children\"),\r\n            isCodesFlat: isCodesFlat,\r\n            timePeriod: {\r\n              ...state.timePeriod,\r\n              ...getTimePeriod(\r\n                state.timePeriod,\r\n                state.criteria,\r\n                dimensionCodelist.id === TIME_PERIOD_DIMENSION_KEY ? dimensionCodelist : null,\r\n                dimensionCodelist.id === FREQ_DIMENSION_KEY ? dimensionCodelist : null\r\n              )\r\n            },\r\n            codelistsLength: newCodelistsLength,\r\n            criteria: newCriteria\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELISTS_FETCH: {\r\n\r\n          const dimensionCodelists = (state.dimensions || []).map(({id: dimensionId}) => {\r\n            const found = action.payload.response.criteria.find((criteria: any) => criteria.id === dimensionId);\r\n            return {\r\n              id: dimensionId,\r\n              values: (found?.values || [])\r\n            }\r\n          });\r\n\r\n          const flatCodelists = dimensionCodelists ? dimensionCodelists.map(({values}: any) => (values || [])) : [];\r\n\r\n          let areCodelistsFlat = flatCodelists.map(() => true);\r\n          flatCodelists.forEach((codelist: any, idx: number) => {\r\n            codelist.forEach((item: any) => {\r\n              if (areCodelistsFlat[idx] && item.parentId !== null && item.parentId !== undefined) {\r\n                areCodelistsFlat[idx] = false;\r\n              }\r\n            })\r\n          })\r\n\r\n          const timePeriodIdx = (state.dimensions || []).map(({id}: any) => id).indexOf(TIME_PERIOD_DIMENSION_KEY);\r\n          const freqIdx = (state.dimensions || []).map(({id}: any) => id).indexOf(FREQ_DIMENSION_KEY);\r\n\r\n          let newCriteria = _.cloneDeep(state.criteria);\r\n          dimensionCodelists.forEach((dimensionCodelist, idx) => {\r\n            if (dimensionCodelist.id !== TIME_PERIOD_DIMENSION_KEY && flatCodelists[idx].length === 1) {\r\n              newCriteria = {\r\n                ...newCriteria,\r\n                [dimensionCodelist.id]: {\r\n                  id: dimensionCodelist.id,\r\n                  type: CRITERIA_FILTER_TYPE_CODES,\r\n                  filterValues: [flatCodelists[idx][0].id],\r\n                }\r\n              }\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            codelists: flatCodelists.map((flatCodes: any) => getTreeFromArray((flatCodes || []), \"parentId\", \"children\")),\r\n            areCodelistsFlat: areCodelistsFlat,\r\n            timePeriod: {\r\n              ...state.timePeriod,\r\n              ...getTimePeriod(\r\n                state.timePeriod,\r\n                state.criteria,\r\n                dimensionCodelists[timePeriodIdx],\r\n                dimensionCodelists[freqIdx]\r\n              )\r\n            },\r\n            codelistsLength: flatCodelists.map((codelist: any, idx: number) => idx !== timePeriodIdx ? codelist.length : null),\r\n            criteria: newCriteria\r\n          }\r\n        }\r\n        case DATASET_ACCESSIBLE_FETCH: {\r\n          return {\r\n            ...state,\r\n            accessibleDataset: action.payload.response\r\n          }\r\n        }\r\n        case DATASET_TERRITORY_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any) => val.nutsLevel)\r\n            .reduce((acc: any, level: any) => {\r\n              if (!acc[level]) {\r\n                // @ts-ignore\r\n                const label = getNutsLevelTranslations(action.payload.extra.t)[level];\r\n                acc[level] = {level: level, counter: 0, label: (label || `nutsLevel${level}`)};\r\n              }\r\n              acc[level].counter++;\r\n              return acc;\r\n            }, [])\r\n            .filter((v: any) => {\r\n              if (!v) {\r\n                return false\r\n              }\r\n              if (v.counter <= 1) {\r\n                console.log(\"hiding NUTS level \" + v.level + \" (size = \" + v.counter + \")\");\r\n              }\r\n              return v.counter > 1\r\n            })\r\n            .sort((a: any, b: any) => a.level - b.level);\r\n\r\n          return {\r\n            ...state,\r\n            geometries: action.payload.response,\r\n            geometryDetailLevels: detailLevels\r\n          }\r\n        }\r\n        case DATASET_VIEW_TEMPLATE_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            isViewVisible: false,\r\n            isTemplateVisible: false\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          return {\r\n            ...initialState,\r\n            enableCriteria: false,\r\n            enableLayout: false\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n          return {\r\n            ...state\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELISTS_FETCH: {\r\n          return {\r\n            ...state\r\n          }\r\n        }\r\n        case DATASET_DOWNLOAD_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            isDownloadWarningVisible: action.payload.statusCode === 406\r\n          }\r\n        }\r\n        case DATASET_VIEW_TEMPLATE_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            isViewErrorVisible: !!(action.payload.extra.isView && action.payload.statusCode === 409 && action.payload.response),\r\n            viewErrorMessage: action.payload.response\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\nexport default datasetReducer;","export const NSI_RESPONSE_DOWNLOAD_SIZE_KEY = \"nsiResponseDownloadSize\";\r\nexport const TOTAL_KEY = \"total\";\r\n\r\nexport const getTimingsLabelTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    nsiResponse: t(\"timings.nsiResponse\"),\r\n    nsiResponseDownload: t(\"timings.nsiResponseDownload\"),\r\n    [NSI_RESPONSE_DOWNLOAD_SIZE_KEY]: t(\"timings.nsiResponseDownloadSize\"),\r\n    jsonToJsonStat: t(\"timings.jsonToJsonStat\"),\r\n    xmlToJsonStat: t(\"timings.xmlToJsonStat\"),\r\n    others: t(\"timings.others\"),\r\n    [TOTAL_KEY]: t(\"timings.total\"),\r\n    cacheRead: t(\"timings.cacheRead\")\r\n  });\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};","import React, {Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {GENERATING_HTML_TIME_KEY, OBSERVATION_COUNT_KEY, SERVER_TIMINGS_KEY} from \"../../state/dataset/datasetReducer\";\r\nimport {\r\n  getTimingsLabelTranslations,\r\n  NSI_RESPONSE_DOWNLOAD_SIZE_KEY,\r\n  TOTAL_KEY\r\n} from \"../../constants/getTimingsLabelTranslation\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  divider: {\r\n    margin: \"16px 0\"\r\n  }\r\n});\r\n\r\nconst getRow = (label, value, isTitle) => (\r\n  <Grid\r\n    container\r\n    key={label}\r\n    justify=\"space-between\"\r\n    spacing={2}\r\n    style={{\r\n      height: isTitle ? 40 : undefined\r\n    }}\r\n  >\r\n    <Grid\r\n      item\r\n      style={isTitle\r\n        ? {\r\n          fontSize: 15,\r\n          fontWeight: \"bold\",\r\n          textDecoration: \"underline\"\r\n        }\r\n        : undefined\r\n      }\r\n    >\r\n      {label}\r\n    </Grid>\r\n    {value && (\r\n      <Grid item><b>{value}</b></Grid>\r\n    )}\r\n  </Grid>\r\n);\r\n\r\nconst DataViewerTimings = ({\r\n                             t,\r\n                             classes,\r\n                             timings\r\n                           }) => {\r\n  const rows = [];\r\n\r\n  if (timings) {\r\n    if (timings[GENERATING_HTML_TIME_KEY] !== null && timings[GENERATING_HTML_TIME_KEY] !== undefined) {\r\n      rows.push(getRow(t(\"timings.observationCount\"), timings[OBSERVATION_COUNT_KEY], true));\r\n      rows.push(<Divider className={classes.divider} key=\"divider1\"/>);\r\n    }\r\n\r\n    /** server side **/\r\n    if (timings[SERVER_TIMINGS_KEY]) {\r\n\r\n      rows.push(getRow(t(\"timings.serverTimings\"), null, true));\r\n\r\n      for (const key in timings[SERVER_TIMINGS_KEY]) {\r\n        if (timings[SERVER_TIMINGS_KEY].hasOwnProperty(key)) {\r\n          if (key !== TOTAL_KEY && key !== NSI_RESPONSE_DOWNLOAD_SIZE_KEY) {\r\n            rows.push(getRow(getTimingsLabelTranslations(t)[key], timings[SERVER_TIMINGS_KEY][key]))\r\n          }\r\n        }\r\n      }\r\n      rows.push(getRow(getTimingsLabelTranslations(t)[TOTAL_KEY], timings[SERVER_TIMINGS_KEY][TOTAL_KEY], true));\r\n      rows.push(<Divider className={classes.divider} key=\"divider2\"/>);\r\n\r\n      if (timings[SERVER_TIMINGS_KEY][NSI_RESPONSE_DOWNLOAD_SIZE_KEY]) {\r\n        rows.push(getRow(getTimingsLabelTranslations(t)[NSI_RESPONSE_DOWNLOAD_SIZE_KEY], timings[SERVER_TIMINGS_KEY][NSI_RESPONSE_DOWNLOAD_SIZE_KEY], true));\r\n        rows.push(<Divider className={classes.divider} key=\"divider3\"/>);\r\n      }\r\n    }\r\n\r\n    /** client side **/\r\n    if (timings[GENERATING_HTML_TIME_KEY] !== null && timings[GENERATING_HTML_TIME_KEY] !== undefined) {\r\n      rows.push(getRow(t(\"timings.clientTimings\"), null, true));\r\n      rows.push(getRow(t(\"timings.generatingHtml\"), `${timings[GENERATING_HTML_TIME_KEY]}ms`));\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      {rows}\r\n    </Fragment>\r\n  )\r\n}\r\n\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(DataViewerTimings)","import React from 'react';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport I18nTextField from \"../i18n-text-field\";\r\n\r\nconst ViewBuilder = ({\r\n                       t,\r\n                       view,\r\n                       onChange\r\n                     }) =>\r\n  <Grid container spacing={2}>\r\n    <Grid item xs={12}>\r\n      <FormControl fullWidth>\r\n        <I18nTextField\r\n          label={t(\"scenes.dataViewer.viewBuilder.form.title.label\")}\r\n          required\r\n          variant=\"outlined\"\r\n          value={view.title}\r\n          onChange={value => onChange({...view, title: value})}\r\n        />\r\n      </FormControl>\r\n    </Grid>\r\n  </Grid>\r\n\r\nexport default withTranslation()(ViewBuilder);","import React, {Fragment, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport I18nTextField from \"../i18n-text-field\";\r\nimport JsonStatTable from \"../table\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\n\r\nconst styles = theme => ({\r\n  card: {\r\n    padding: theme.spacing(2)\r\n  },\r\n  viewer: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 16px - 64px)\",\r\n    marginTop: 16\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 48px)\",\r\n    paddingTop: 16\r\n  }\r\n});\r\n\r\nfunction TemplateBuilder(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    template,\r\n    onChange,\r\n    viewers,\r\n    jsonStat,\r\n    labelFormat,\r\n    tableLayout,\r\n    hiddenAttributes\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [tabId, setTabId] = useState(0);\r\n\r\n  return (\r\n    <Fragment>\r\n      <AppBar position=\"static\" color=\"default\">\r\n        <Tabs\r\n          value={tabId}\r\n          variant=\"scrollable\"\r\n          scrollButtons=\"auto\"\r\n          indicatorColor=\"primary\"\r\n          textColor=\"primary\"\r\n          onChange={(event, newValue) => setTabId(newValue)}\r\n        >\r\n          <Tab key={0} label={t(\"scenes.dataViewer.templateBuilder.tabs.options.label\")}/>\r\n          <Tab key={1} label={t(\"scenes.dataViewer.templateBuilder.tabs.table.label\")}/>\r\n          <Tab key={2} label={t(\"scenes.dataViewer.templateBuilder.tabs.chart.label\")}/>\r\n          <Tab key={3} label={t(\"scenes.dataViewer.templateBuilder.tabs.map.label\")}/>\r\n        </Tabs>\r\n      </AppBar>\r\n      <div className={classes.tabContent}>\r\n        {tabId === 0 && (\r\n          <Fragment>\r\n            <Card variant=\"outlined\">\r\n              <CardHeader\r\n                title={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.title\")}\r\n                titleTypographyProps={{variant: \"subtitle1\"}}\r\n              />\r\n              <Grid container spacing={3} className={classes.card}>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <I18nTextField\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.title\")}\r\n                      required\r\n                      variant=\"outlined\"\r\n                      value={template.title}\r\n                      onChange={value => onChange({...template, title: value})}\r\n                    />\r\n                  </FormControl>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <TextField\r\n                      select\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.defaultView\")}\r\n                      defaultValue=\"table\"\r\n                      value={template.defaultView}\r\n                      variant=\"outlined\"\r\n                      onChange={ev => onChange({...template, defaultView: ev.target.value})}\r\n                    >\r\n                      {viewers.map(({type, title}, idx) =>\r\n                        <MenuItem key={idx} value={type}>{title}</MenuItem>\r\n                      )}\r\n                    </TextField>\r\n                  </FormControl>\r\n                </Grid>\r\n                <Grid item xs={3}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.enableCriteria\")}\r\n                    className={classes.field}\r\n                    control={\r\n                      <Checkbox\r\n                        checked={template.enableCriteria}\r\n                        onChange={(ev, value) => onChange({...template, enableCriteria: value})}\r\n                      />\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={3}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.enableLayout\")}\r\n                    className={classes.field}\r\n                    control={\r\n                      <Checkbox\r\n                        checked={template.enableLayout}\r\n                        onChange={(ev, value) => onChange({...template, enableLayout: value})}\r\n                      />\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={3}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.enableVariation\") + \" (*)\"}\r\n                    className={classes.field}\r\n                    control={\r\n                      <Checkbox\r\n                        checked={true} // template.enableVariation\r\n                        onChange={(ev, value) => onChange({...template, enableVariation: value})}\r\n                        disabled\r\n                      />\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item xs={3}/>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <TextField\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.decimalPlaces\")}\r\n                      value={template.decimalNumber}\r\n                      variant=\"outlined\"\r\n                      required\r\n                      onChange={ev => onChange({...template, decimalNumber: ev.target.value})}\r\n                    />\r\n                  </FormControl>\r\n                </Grid>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <I18nTextField\r\n                      select\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.decimalSeparator.label\")}\r\n                      value={template.decimalSeparator}\r\n                      defaultValue=\".\"\r\n                      variant=\"outlined\"\r\n                      required\r\n                      onChange={value => onChange({...template, decimalSeparator: value})}\r\n                    >\r\n                      <MenuItem value=\".\">\r\n                        {t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.decimalSeparator.values.dot\")}\r\n                      </MenuItem>\r\n                      <MenuItem value=\",\">\r\n                        {t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.general.form.decimalSeparator.values.comma\")}\r\n                      </MenuItem>\r\n                    </I18nTextField>\r\n                  </FormControl>\r\n                </Grid>\r\n              </Grid>\r\n            </Card>\r\n            <Card variant=\"outlined\" style={{marginTop: 16}}>\r\n              <CardHeader\r\n                title={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.table.title\")}\r\n                titleTypographyProps={{variant: \"subtitle1\"}}\r\n              />\r\n              <Grid container spacing={2} className={classes.card}>\r\n                <Grid item xs={6}>\r\n                  <FormControl fullWidth className={classes.field}>\r\n                    <TextField\r\n                      label={t(\"scenes.dataViewer.templateBuilder.tabs.options.cards.table.form.emptyCellPlaceholder\")}\r\n                      value={template.layouts.tableEmptyChar}\r\n                      variant=\"outlined\"\r\n                      required\r\n                      onChange={ev => onChange({\r\n                        ...template,\r\n                        layouts: {\r\n                          ...template.layouts,\r\n                          tableEmptyChar: ev.target.value\r\n                        }\r\n                      })}\r\n                    />\r\n                  </FormControl>\r\n                </Grid>\r\n                <Grid item xs={6}/>\r\n              </Grid>\r\n            </Card>\r\n            <div\r\n              style={{marginTop: 16}}>{\"(*): \" + t(\"scenes.dataViewer.templateBuilder.tabs.options.notImplemented\")}</div>\r\n          </Fragment>\r\n        )}\r\n        {tabId === 1 && (\r\n          <Fragment>\r\n            <Grid container spacing={2}>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    select\r\n                    label={t(\"scenes.dataViewer.templateBuilder.tabs.table.form.defaultLayout.label\")}\r\n                    value={template.layouts.tableDefaultLayout}\r\n                    variant=\"outlined\"\r\n                    onChange={ev => onChange({\r\n                      ...template,\r\n                      layouts: {\r\n                        ...template.layouts,\r\n                        tableDefaultLayout: ev.target.value,\r\n                        tableLayout: ev.target.value === \"custom\"\r\n                          ? tableLayout\r\n                          : null\r\n                      }\r\n                    })}\r\n                  >\r\n                    <MenuItem value=\"custom\">\r\n                      {t(\"scenes.dataViewer.templateBuilder.tabs.table.form.defaultLayout.values.custom\")}\r\n                    </MenuItem>\r\n                    <MenuItem value=\"default\">\r\n                      {t(\"scenes.dataViewer.templateBuilder.tabs.table.form.defaultLayout.values.default\")}\r\n                    </MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <div className={classes.viewer}>\r\n              {template.layouts.tableDefaultLayout === \"custom\"\r\n                ? (\r\n                  <JsonStatTable\r\n                    jsonStat={jsonStat}\r\n                    layout={tableLayout}\r\n                    labelFormat={labelFormat}\r\n                    decimalSeparator={localizeI18nObj(template.decimalSeparator, defaultLanguage, languages)}\r\n                    decimalPlaces={template.decimalNumber}\r\n                    emptyChar={template.layouts.tableEmptyChar}\r\n                    hiddenAttributes={hiddenAttributes}\r\n                  />\r\n                )\r\n                : (\r\n                  <CustomEmpty\r\n                    text={t(\"scenes.dataViewer.templateBuilder.tabs.table.form.defaultLayout.defaultPlaceholder\")}/>\r\n                )\r\n              }\r\n            </div>\r\n          </Fragment>\r\n        )}\r\n        {tabId === 2 && (\r\n          <CustomEmpty text={t(\"commons.notImplemented\")}/>\r\n        )}\r\n        {tabId === 3 && (\r\n          <CustomEmpty text={t(\"commons.notImplemented\")}/>\r\n        )}\r\n      </div>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(TemplateBuilder);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport ShareIcon from '@material-ui/icons/Share';\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {goToNode} from \"../../links\";\r\nimport HomeIcon from \"@material-ui/icons/Home\";\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport AccessTimeIcon from '@material-ui/icons/AccessTime';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport AttributeList from \"../attribute-list\";\r\nimport {\r\n  getDimensionAttributeMap,\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat\r\n} from \"../../utils/jsonStat\";\r\nimport {DECIMAL_PLACES_DEFAULT, DECIMAL_SEPARATOR_DEFAULT, EMPTY_CHAR_DEFAULT} from \"../../utils/formatters\";\r\nimport {\r\n  canSaveAsView,\r\n  canSaveTemplate,\r\n  canShare,\r\n  canViewTemplateOrAnnotationIcon,\r\n  canViewTimesLog\r\n} from \"../../utils/user\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {validateI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  exportChartJpeg,\r\n  getDownloadFormatExtensionFromFormat,\r\n  getDownloadFormatLabelFromFormat,\r\n  isDownloadFormatValid\r\n} from \"../../utils/download\";\r\nimport DataViewerTimings from \"./Timings\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../label-format-selector/constants\";\r\nimport ViewBuilder from \"./ViewBuilder\";\r\nimport TemplateBuilder from \"./TemplateBuilder\";\r\nimport {getCriteriaArrayFromObject} from \"../../utils/criteria\";\r\nimport {\r\n  hideDatasetViewError,\r\n  hideDatasetViewTemplate,\r\n  showDatasetViewTemplate\r\n} from \"../../state/dataset/datasetActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px 0\"\r\n  },\r\n  titleContainer: {\r\n    marginRight: 8\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 500\r\n  },\r\n  subtitle: {\r\n    padding: \"0 12px 8px 48px\"\r\n  },\r\n  attributeIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontSize: 23,\r\n    fontWeight: \"bold\",\r\n    fontFamily: \"Do Hyeon\"\r\n  },\r\n  layoutIcon: {\r\n    width: 48,\r\n    height: 48,\r\n    padding: 12,\r\n    color: \"rgba(0, 0, 0, 0.54)\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user,\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  view: state.dataset.view,\r\n  template: state.dataset.template,\r\n  isViewVisible: state.dataset.isViewVisible,\r\n  isViewErrorVisible: state.dataset.isViewErrorVisible,\r\n  viewErrorMessage: state.dataset.viewErrorMessage,\r\n  isTemplateVisible: state.dataset.isTemplateVisible\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onViewTemplateShow: isView => dispatch(showDatasetViewTemplate(isView)),\r\n  onViewTemplateHide: isView => dispatch(hideDatasetViewTemplate(isView)),\r\n  onViewErrorHide: isView => dispatch(hideDatasetViewError(isView))\r\n});\r\n\r\nconst getEmptyViewTemplate = (viewTemplate, datasetId, emptyChar, decimalPlaces, decimalSeparator, defaultLanguage) => ({\r\n  datasetId: datasetId,\r\n  type: \"\",\r\n  title: {},\r\n  defaultView: \"table\",\r\n  criteria: {},\r\n  layouts: {\r\n    labelFormat: LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME,\r\n    tableDefaultLayout: \"custom\",\r\n    tableLayout: {},\r\n    tableEmptyChar: (emptyChar !== null && emptyChar !== undefined) ? emptyChar : EMPTY_CHAR_DEFAULT,\r\n    mapLayout: {},\r\n    chartLayout: {}\r\n  },\r\n  decimalNumber: (decimalPlaces !== null && decimalPlaces !== undefined) ? decimalPlaces : DECIMAL_PLACES_DEFAULT,\r\n  decimalSeparator: {\r\n    [defaultLanguage]: (decimalSeparator || DECIMAL_SEPARATOR_DEFAULT)\r\n  },\r\n  enableCriteria: true,\r\n  enableLayout: true,\r\n  ...viewTemplate\r\n});\r\n\r\nfunction DataViewerHeader(props) {\r\n\r\n  const {\r\n    classes,\r\n    user,\r\n    defaultLanguage,\r\n    languages,\r\n    nodeId,\r\n    nodeCode,\r\n    nodeDownloadFormats,\r\n    datasetId,\r\n    datasetTitle,\r\n    viewId,\r\n    hasViewLayout,\r\n    hasTemplateLayout,\r\n    hasAnnotationLayout,\r\n    view: structureView,\r\n    template: structureTemplate,\r\n    notes,\r\n    attachedFiles,\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    labelFormat,\r\n    tableLayout,\r\n    chartLayout,\r\n    mapLayout,\r\n    criteria,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    viewers,\r\n    viewerIdx,\r\n    isViewVisible,\r\n    isViewErrorVisible,\r\n    viewErrorMessage,\r\n    isTemplateVisible,\r\n    onViewTemplateShow,\r\n    onViewTemplateHide,\r\n    onViewTemplateSubmit,\r\n    onViewErrorHide,\r\n    onDownloadSubmit,\r\n    timings,\r\n    chartId,\r\n    mapId\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [initialView, setInitialView] = useState(null);\r\n  const [view, setView] = useState(null);\r\n\r\n  const [initialTemplate, setInitialTemplate] = useState(null);\r\n  const [template, setTemplate] = useState(null);\r\n\r\n  const [isAttributesVisible, setAttributesVisibility] = useState(false);\r\n  const [isNotesVisible, setNotesVisibility] = useState(false);\r\n  const [isTimingsVisible, setTimingsVisibility] = useState(false);\r\n\r\n  const [downloadFormats, setDownloadFormats] = useState([]);\r\n\r\n  const [isUpdatingView, setIsUpdatingView] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const actionsWidth = document.getElementById(\"dataset-viewer-header__actions\")\r\n      ? document.getElementById(\"dataset-viewer-header__actions\").offsetWidth\r\n      : 0;\r\n    document.getElementById(\"dataset-viewer-header__title\").setAttribute(\"style\", `width: calc(100% - ${actionsWidth}px - 8px)`);\r\n  });\r\n\r\n  useEffect(() => {\r\n    const template = getEmptyViewTemplate(structureTemplate, datasetId, emptyChar, decimalPlaces, decimalSeparator, defaultLanguage);\r\n    setInitialTemplate(template);\r\n    setTemplate(template)\r\n    const view = getEmptyViewTemplate(structureView, datasetId, emptyChar, decimalPlaces, decimalSeparator, defaultLanguage);\r\n    setInitialView(view);\r\n    setView(view);\r\n  }, [structureView, structureTemplate, datasetId, emptyChar, decimalPlaces, decimalSeparator, defaultLanguage]);\r\n\r\n  useEffect(() => {\r\n    const newDownloadFormats = [];\r\n    (nodeDownloadFormats || []).forEach(format => {\r\n      if (isDownloadFormatValid(format)) {\r\n        newDownloadFormats.push({\r\n          label: getDownloadFormatLabelFromFormat(format, t),\r\n          format: format,\r\n          extension: getDownloadFormatExtensionFromFormat(format, t)\r\n        })\r\n      }\r\n    });\r\n    setDownloadFormats(newDownloadFormats);\r\n  }, [nodeDownloadFormats, t]);\r\n\r\n  const handleViewOpen = (defaultLanguage, isUpdate) => {\r\n    onViewTemplateShow(true);\r\n    setView({\r\n      ...initialView,\r\n      title: isUpdate\r\n        ? view.title\r\n        : {\r\n          [defaultLanguage]: datasetTitle\r\n        },\r\n      defaultView: viewers[viewerIdx].type,\r\n      criteria: criteria,\r\n      layouts: {\r\n        labelFormat: labelFormat,\r\n        tableLayout: viewerIdx === 0 ? tableLayout : null,\r\n        mapLayout: viewerIdx === 1 ? mapLayout : null,\r\n        chartLayout: viewerIdx >= 2 ? chartLayout : null\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleViewClose = () => {\r\n    onViewTemplateHide(true);\r\n    setView(initialView);\r\n  };\r\n\r\n  const handleViewSubmit = viewId => {\r\n    onViewTemplateSubmit({\r\n      type: \"view\",\r\n      viewTemplateId: viewId ? Number(viewId) : undefined,\r\n      datasetId: view.datasetId,\r\n      title: view.title,\r\n      defaultView: view.defaultView,\r\n      criteria: getCriteriaArrayFromObject(view.criteria),\r\n      layouts: JSON.stringify(view.layouts)\r\n    }, true);\r\n    setView(initialView);\r\n  };\r\n\r\n  const handleTemplateOpen = (defaultLanguage, isUpdate) => {\r\n    onViewTemplateShow(false);\r\n    setTemplate({\r\n      ...initialTemplate,\r\n      title: isUpdate\r\n        ? initialTemplate.title\r\n        : {\r\n          [defaultLanguage]: datasetTitle\r\n        },\r\n      criteria: criteria,\r\n      layouts: {\r\n        ...initialTemplate.layouts,\r\n        labelFormat: labelFormat,\r\n        tableLayout: tableLayout,\r\n        mapLayout: mapLayout,\r\n        chartLayout: chartLayout\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleTemplateClose = () => {\r\n    onViewTemplateHide(false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const handleTemplateSubmit = () => {\r\n    onViewTemplateSubmit({\r\n      ...template,\r\n      type: \"template\",\r\n      criteria: getCriteriaArrayFromObject(template.criteria),\r\n      layouts: JSON.stringify(template.layouts)\r\n    }, false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const datasetAttributes = [];\r\n  const dataset = (jsonStat?.extension?.attributes?.dataSet || []);\r\n  const datasetIndexes = (jsonStat?.extension?.attributes?.index?.dataSet || []);\r\n\r\n  if (dataset && dataset.length > 0 && datasetIndexes && datasetIndexes.length > 0) {\r\n    (datasetIndexes || []).forEach((el, idx) => {\r\n      if (el !== null && !(hiddenAttributes || []).includes(dataset[idx].id)) {\r\n        datasetAttributes.push({\r\n          id: (dataset[idx].name || dataset[idx].id),\r\n          value: (dataset[idx].values[el].name || dataset[idx].values[el].id)\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  const otherAttributes = [];\r\n  const series = (jsonStat?.extension?.attributes?.series || []);\r\n  const seriesIndexes = (jsonStat?.extension?.attributes?.index?.series || []);\r\n\r\n  if (series && series.length > 0 && seriesIndexes && seriesIndexes.length > 0) {\r\n    seriesIndexes\r\n      .filter(({coordinates}) => (coordinates || []).filter(c => c !== null).length > 1)\r\n      .forEach(({coordinates, attributes}) => {\r\n        const dimsId = [];\r\n        const dimsValueId = [];\r\n        coordinates.forEach((el, idx) => {\r\n          if (el !== null) {\r\n            const dim = jsonStat.id[idx];\r\n            dimsId.push(dim);\r\n            dimsValueId.push(jsonStat.dimension[dim].category.index[el]);\r\n          }\r\n        });\r\n        const dims = dimsId.map((dim, idx) => ({\r\n          id: getDimensionLabelFromJsonStat(jsonStat, dim, labelFormat),\r\n          value: getDimensionValueLabelFromJsonStat(jsonStat, dim, dimsValueId[idx], labelFormat)\r\n        }));\r\n        const attrs = [];\r\n        attributes.forEach((attr, idx) => {\r\n          if (attr !== null && attr !== undefined && !(hiddenAttributes || []).includes(series[idx].id)) {\r\n            attrs.push({\r\n              id: (series[idx].name || series[idx].id),\r\n              value: (series[idx].values[attr].name || series[idx].values[attr].id)\r\n            })\r\n          }\r\n        });\r\n        if (dims.length > 0 && attrs.length > 0) {\r\n          otherAttributes.push({\r\n            dims: dims,\r\n            attributes: attrs\r\n          });\r\n        }\r\n      });\r\n  }\r\n\r\n  const currentFilters = (viewers[viewerIdx].key === 0 && tableLayout?.filters)\r\n    ? tableLayout.filters\r\n    : (viewers[viewerIdx].key === 1 && mapLayout?.filters)\r\n      ? mapLayout.filters\r\n      : (viewers[viewerIdx].key >= 2 && chartLayout?.filters)\r\n        ? chartLayout.filters\r\n        : [];\r\n\r\n  const subtitle = [];\r\n  if (jsonStat && currentFilters) {\r\n    currentFilters.forEach(filter => {\r\n      if (jsonStat.size[jsonStat.id.indexOf(filter)] === 1) {\r\n        subtitle.push({\r\n          dim: filter,\r\n          dimLabel: getDimensionLabelFromJsonStat(jsonStat, filter, labelFormat),\r\n          value: jsonStat.dimension[filter].category.index[0],\r\n          valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, filter, jsonStat.dimension[filter].category.index[0], labelFormat)\r\n        });\r\n      }\r\n    })\r\n  }\r\n\r\n  const dimensionAttributesMap = getDimensionAttributeMap(jsonStat, hiddenAttributes);\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid container className={classes.root}>\r\n        <Grid container justify=\"space-between\" alignItems=\"flex-start\">\r\n          <Grid item id=\"dataset-viewer-header__title\" className={classes.titleContainer}>\r\n            <Grid container alignItems=\"flex-start\">\r\n              <Grid item>\r\n                <Tooltip title={t(\"scenes.dataViewer.header.action.goHome.tooltip\")}>\r\n                  <IconButton color=\"primary\" onClick={() => goToNode(nodeCode)}>\r\n                    <HomeIcon/>\r\n                  </IconButton>\r\n                </Tooltip>\r\n              </Grid>\r\n              <Grid container style={{width: \"calc(100% - 48px)\"}}>\r\n                <Grid item className={classes.title}>\r\n                  <div style={{display: \"table\", minHeight: 48}}>\r\n                    <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n                      <span style={{marginRight: 4}}>{datasetTitle}</span>\r\n                      {notes && notes.length > 0 && (\r\n                        <Tooltip title={t(\"scenes.dataViewer.header.action.information.tooltip\")}>\r\n                          <IconButton id=\"dataset-attributes-btn\" onClick={() => setNotesVisibility(true)}>\r\n                            <InfoIcon/>\r\n                          </IconButton>\r\n                        </Tooltip>\r\n                      )}\r\n                      {datasetAttributes.concat(otherAttributes).length > 0 && (\r\n                        <Tooltip title={t(\"scenes.dataViewer.header.action.attributes.tooltip\")}>\r\n                          <IconButton id=\"dataset-attributes-btn\" onClick={() => setAttributesVisibility(true)}>\r\n                            <div className={classes.attributeIcon}>(*)</div>\r\n                          </IconButton>\r\n                        </Tooltip>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item id=\"dataset-viewer-header__actions\">\r\n            <Grid container alignItems=\"center\">\r\n              {(() => {\r\n                if (canViewTemplateOrAnnotationIcon(user, nodeId)) {\r\n\r\n                  let title = null;\r\n                  if (hasViewLayout) {\r\n                    title = t(\"scenes.dataViewer.header.action.hasViewLayout.tooltip\");\r\n                  } else if (hasTemplateLayout) {\r\n                    title = t(\"scenes.dataViewer.header.action.hasTemplateLayout.tooltip\");\r\n                  } else if (hasAnnotationLayout) {\r\n                    title = t(\"scenes.dataViewer.header.action.hasAnnotationLayout.tooltip\");\r\n                  }\r\n\r\n                  if (title) {\r\n                    return (\r\n                      <div className={classes.layoutIcon}>\r\n                        <Tooltip title={title}>\r\n                          <InfoIcon/>\r\n                        </Tooltip>\r\n                      </div>\r\n                    )\r\n                  }\r\n                }\r\n              })()}\r\n              {canViewTimesLog(user, nodeId) && (\r\n                <Grid item id=\"dataset-times-log-btn\">\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.timesLog.tooltip\")}>\r\n                    <div>\r\n                      <IconButton onClick={() => setTimingsVisibility(true)} disabled={timings === null}>\r\n                        <AccessTimeIcon/>\r\n                      </IconButton>\r\n                    </div>\r\n                  </Tooltip>\r\n                </Grid>\r\n              )}\r\n              {(canSaveAsView(user) || canSaveTemplate(user, nodeId)) && (\r\n                <Grid item id=\"dataset-save-btn\">\r\n                  <ButtonSelect\r\n                    icon={<SaveIcon/>}\r\n                    tooltip={t(\"scenes.dataViewer.header.action.save.tooltip\")}\r\n                    color=\"default\"\r\n                    disabled={!tableLayout && !chartLayout && !mapLayout}\r\n                  >\r\n                    {canSaveAsView(user) && (\r\n                      <div\r\n                        onClick={() => {\r\n                          handleViewOpen(defaultLanguage, false);\r\n                          setIsUpdatingView(false);\r\n                        }}\r\n                      >\r\n                        {t(\"scenes.dataViewer.header.action.save.values.createView\")}\r\n                      </div>\r\n                    )}\r\n                    {canSaveAsView(user) && hasViewLayout && viewId && (\r\n                      <div\r\n                        onClick={() => {\r\n                          handleViewOpen(defaultLanguage, true);\r\n                          setIsUpdatingView(true);\r\n                        }}\r\n                      >\r\n                        {t(\"scenes.dataViewer.header.action.save.values.updateView\")}\r\n                      </div>\r\n                    )}\r\n                    {canSaveTemplate(user, nodeId) && (\r\n                      <div onClick={() => handleTemplateOpen(defaultLanguage, hasTemplateLayout)}>\r\n                        {hasTemplateLayout\r\n                          ? t(\"scenes.dataViewer.header.action.save.values.updateTemplate\")\r\n                          : t(\"scenes.dataViewer.header.action.save.values.createTemplate\")\r\n                        }\r\n                      </div>\r\n                    )}\r\n                  </ButtonSelect>\r\n                </Grid>\r\n              )}\r\n              {canShare(user) && (\r\n                <Grid item id=\"dataset-share-btn\">\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.share.tooltip\")}>\r\n                    <IconButton onClick={window.notImplemented.show}>\r\n                      <ShareIcon/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                </Grid>\r\n              )}\r\n              <Grid item id=\"dataset-attachments-btn\">\r\n                <ButtonSelect\r\n                  icon={<AttachFileIcon/>}\r\n                  tooltip={t(\"scenes.dataViewer.header.action.attachments.tooltip\")}\r\n                  color=\"default\"\r\n                  onChange={({attachedFile}) => window.open(attachedFile.url)}\r\n                  disabled={!attachedFiles || attachedFiles.length === 0}\r\n                >\r\n                  {(attachedFiles || []).map((attachedFile, idx) => {\r\n                    const fileName = attachedFile.url.split(\"/\").pop();\r\n                    return (\r\n                      <div key={idx} data-value={{attachedFile}}>\r\n                        {`${fileName} (${attachedFile.format})`}\r\n                      </div>\r\n                    )\r\n                  })}\r\n                </ButtonSelect>\r\n              </Grid>\r\n              {(downloadFormats && downloadFormats.length > 0 && (\r\n                <Grid item id=\"dataset-export-btn\">\r\n                  <ButtonSelect\r\n                    icon={<GetAppIcon/>}\r\n                    tooltip={t(\"scenes.dataViewer.header.action.export.tooltip\")}\r\n                    color=\"default\"\r\n                    onChange={({format, extension}) => {\r\n                      if (format === \"png\" && viewerIdx === 1) {\r\n                        window.LMap.exportPng(mapId, `${datasetTitle}.png`);\r\n                      } else if (format === \"jpeg\" && viewerIdx >= 2) {\r\n                        exportChartJpeg(chartId, `${datasetTitle}.jpeg`);\r\n                      } else {\r\n                        onDownloadSubmit(format, extension);\r\n                      }\r\n                    }}\r\n                  >\r\n                    {(downloadFormats)\r\n                      .concat(viewerIdx === 1\r\n                        ? {format: \"png\", label: \"PNG\", extension: \"png\"}\r\n                        : viewerIdx >= 2\r\n                          ? {format: \"jpeg\", label: \"JPEG\", extension: \"jpeg\"}\r\n                          : []\r\n                      )\r\n                      .map(({format, label, extension}, idx) =>\r\n                        <div key={idx} data-value={{format, extension}}>\r\n                          {label}\r\n                        </div>\r\n                      )}\r\n                  </ButtonSelect>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n        <Grid item className={classes.subtitle} xs={12}>\r\n          {subtitle && dimensionAttributesMap && subtitle.map(({dim, dimLabel, value, valueLabel}, idx) =>\r\n            <div key={idx} style={{display: \"inline-block\", marginRight: 8}}>\r\n              <div style={{display: \"inline-block\"}}>\r\n                <b>{dimLabel}</b>: <i>{valueLabel}</i>\r\n              </div>\r\n              {dimensionAttributesMap[dim][value] && (\r\n                <div style={{display: \"inline-block\", marginLeft: 4}}>\r\n                  <Tooltip\r\n                    title={\r\n                      <div>\r\n                        {dimensionAttributesMap[dim][value].attributes.map(({id, label, valueId, valueLabel}, idx) => (\r\n                          <div\r\n                            key={idx}>{`${label || id}: ${valueLabel || valueId}${valueLabel !== valueId ? ` [${valueId}]` : ''}`}</div>\r\n                        ))}\r\n                      </div>\r\n                    }\r\n                    placement=\"top\"\r\n                  >\r\n                    <div>\r\n                      {`[${dimensionAttributesMap[dim][value].ids.join(\", \")}]`}\r\n                    </div>\r\n                  </Tooltip>\r\n                </div>\r\n              )}\r\n              <div style={{display: \"inline-block\"}}>\r\n                {idx < subtitle.length - 1 ? \",\" : \"\"}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <Dialog\r\n        open={isAttributesVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setAttributesVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.attributes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <AttributeList\r\n            datasetAttributes={datasetAttributes}\r\n            otherAttributes={otherAttributes}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setAttributesVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isTimingsVisible}\r\n        onClose={() => setTimingsVisibility(false)}\r\n      >\r\n        <DialogContent style={{width: 400}}>\r\n          <DataViewerTimings\r\n            timings={timings}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => setTimingsVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {initialView && (\r\n        <Fragment>\r\n          <Dialog\r\n            open={isViewVisible}\r\n            onClose={handleViewClose}\r\n          >\r\n            <DialogTitle>\r\n              {isUpdatingView\r\n                ? t(\"scenes.dataViewer.header.dialogs.view.title.update\")\r\n                : t(\"scenes.dataViewer.header.dialogs.view.title.create\")\r\n              }\r\n            </DialogTitle>\r\n            <DialogContent style={{width: 480}}>\r\n              <ViewBuilder\r\n                view={view}\r\n                onChange={setView}\r\n              />\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={handleViewClose}>\r\n                {t(\"commons.confirm.cancel\")}\r\n              </Button>\r\n              <Button\r\n                color=\"primary\"\r\n                autoFocus\r\n                onClick={() => handleViewSubmit(isUpdatingView ? viewId : null)}\r\n                disabled={!validateI18nObj(view.title)}\r\n              >\r\n                {t(\"commons.confirm.save\")}\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n          <Dialog\r\n            open={isViewErrorVisible}\r\n            maxWidth=\"md\"\r\n            onClose={onViewErrorHide}\r\n          >\r\n            <DialogTitle>\r\n              {t(\"scenes.dataViewer.header.dialogs.duplicateViewError.title\")}\r\n            </DialogTitle>\r\n            <DialogContent>\r\n              {viewErrorMessage && (\r\n                <Fragment>\r\n                  {t(\"scenes.dataViewer.header.dialogs.duplicateViewError.content\") + \": \"}\r\n                  <b>{Object.keys(viewErrorMessage).join(\", \")}</b>\r\n                </Fragment>\r\n              )}\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button onClick={onViewErrorHide}>\r\n                {t(\"commons.confirm.close\")}\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n        </Fragment>\r\n      )}\r\n\r\n      {initialTemplate && (\r\n        <Dialog\r\n          open={isTemplateVisible}\r\n          fullScreen\r\n          onClose={handleTemplateClose}\r\n        >\r\n          <DialogTitle>\r\n            {hasTemplateLayout\r\n              ? t(\"scenes.dataViewer.header.dialogs.template.title.update\")\r\n              : t(\"scenes.dataViewer.header.dialogs.template.title.create\")\r\n            }\r\n          </DialogTitle>\r\n          <DialogContent>\r\n            <TemplateBuilder\r\n              defaultLanguage={defaultLanguage}\r\n              languages={languages}\r\n              template={template}\r\n              onChange={setTemplate}\r\n              viewers={viewers}\r\n              jsonStat={jsonStat}\r\n              labelFormat={labelFormat}\r\n              tableLayout={tableLayout}\r\n              hiddenAttributes={hiddenAttributes}\r\n            />\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleTemplateClose}>\r\n              {t(\"commons.confirm.cancel\")}\r\n            </Button>\r\n            <Button\r\n              color=\"primary\"\r\n              autoFocus\r\n              onClick={handleTemplateSubmit}\r\n              disabled={(\r\n                !validateI18nObj(template.title) ||\r\n                !validateI18nObj(template.decimalSeparator) ||\r\n                !Number.isInteger(Number(template.decimalNumber)) || Number(template.decimalNumber) < 0 || Number(template.decimalNumber) > 20\r\n              )}\r\n            >\r\n              {t(\"commons.confirm.save\")}\r\n            </Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n      )}\r\n\r\n      <Dialog\r\n        open={isNotesVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setNotesVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.notes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          {notes}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setNotesVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(DataViewerHeader)","import React, {useState} from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport MenuList from \"@material-ui/core/MenuList\";\r\nimport BarChartIcon from '@material-ui/icons/BarChart';\r\nimport BottomNavigationAction from \"@material-ui/core/BottomNavigationAction\";\r\nimport BottomNavigation from \"@material-ui/core/BottomNavigation\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    textAlign: \"center\",\r\n    '& ul': {\r\n      padding: \"4px 0\",\r\n      outline: \"none\"\r\n    },\r\n    \"& .MuiBottomNavigation-root\": {\r\n      height: \"unset !important\",\r\n      outline: \"none\"\r\n    }\r\n  },\r\n  floatingMenuOption: {\r\n    width: 200,\r\n    color: \"gray\"\r\n  },\r\n  floatingMenuOptionSelected: {\r\n    color: theme.palette.primary.main\r\n  },\r\n  divider: {\r\n    margin: \"4px 0\"\r\n  },\r\n  categoryTitle: {\r\n    color: \"gray\",\r\n    fontSize: 11,\r\n    fontWeight: 500\r\n  },\r\n  referenceMetadataIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontSize: 22,\r\n    fontWeight: \"bold\",\r\n    display: \"table\"\r\n  },\r\n  iFrame: {\r\n    width: 960,\r\n    border: 0\r\n  },\r\n  navigationActionDisabled: {\r\n    color: \"rgba(0, 0, 0, 0.26) !important\",\r\n    \"& svg\": {\r\n      color: \"rgba(0, 0, 0, 0.26)\"\r\n    }\r\n  }\r\n});\r\n\r\nfunction DataViewerSideBar(props) {\r\n\r\n  const {\r\n    classes,\r\n    viewers,\r\n    selected,\r\n    isCriteriaDisabled,\r\n    isLayoutDisabled,\r\n    isTableDisabled,\r\n    isChartDisabled,\r\n    isMapDisabled,\r\n    referenceMetadataUrl,\r\n    onViewerSelect,\r\n    onCriteriaOpen,\r\n    onLayoutOpen\r\n  } = props;\r\n\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n\r\n  const [isRefMetaVisible, setRefMetaVisibility] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const handleViewerSelect = index => {\r\n    onViewerSelect(index);\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <MenuList>\r\n\r\n        <BottomNavigation onChange={onCriteriaOpen} showLabels>\r\n          <BottomNavigationAction\r\n            label={t(\"scenes.dataViewer.sidebar.criteria\")}\r\n            icon={<SettingsIcon/>}\r\n            className={isCriteriaDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isCriteriaDisabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation onChange={onLayoutOpen} showLabels>\r\n          <BottomNavigationAction\r\n            label={t(\"scenes.dataViewer.sidebar.layout\")}\r\n            icon={<EditIcon/>}\r\n            className={(isLayoutDisabled || selected === 1) ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isLayoutDisabled || selected === 1}\r\n          />\r\n        </BottomNavigation>\r\n\r\n        <Divider className={classes.divider}/>\r\n\r\n        {referenceMetadataUrl && (\r\n          <BottomNavigation\r\n            onChange={() => setRefMetaVisibility(true)}\r\n            showLabels style={{marginBottom: 8}}\r\n          >\r\n            <BottomNavigationAction\r\n              label={t(\"scenes.dataViewer.sidebar.referenceMetadata\")}\r\n              icon={\r\n                <div className={classes.referenceMetadataIcon}>\r\n                  <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n                    M\r\n                  </div>\r\n                </div>\r\n              }\r\n            />\r\n          </BottomNavigation>\r\n        )}\r\n\r\n        <BottomNavigation\r\n          value={selected === 0 ? 0 : null}\r\n          onChange={() => handleViewerSelect(0)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={viewers[0].title}\r\n            icon={viewers[0].icon}\r\n            className={isTableDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isTableDisabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation\r\n          value={selected >= 2 ? 0 : null}\r\n          onChange={({currentTarget}) => setAnchorEl(currentTarget)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={selected >= 2 ? viewers[selected].title : t(\"scenes.dataViewer.sidebar.chart\")}\r\n            icon={selected >= 2 ? viewers[selected].icon : <BarChartIcon/>}\r\n            className={isChartDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isChartDisabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation\r\n          value={selected === 1 ? 0 : null}\r\n          onChange={() => handleViewerSelect(1)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={viewers[1].title}\r\n            icon={viewers[1].icon}\r\n            className={isMapDisabled ? classes.navigationActionDisabled : \"\"}\r\n            disabled={isMapDisabled}\r\n          />\r\n        </BottomNavigation>\r\n\r\n      </MenuList>\r\n\r\n      <Menu\r\n        anchorEl={anchorEl}\r\n        keepMounted\r\n        open={Boolean(anchorEl)}\r\n        onClose={() => setAnchorEl(null)}\r\n      >\r\n        {viewers\r\n          .slice(2)\r\n          .map(option => (\r\n            <MenuItem\r\n              className={`${classes.floatingMenuOption} ${selected === option.key ? classes.floatingMenuOptionSelected : ''}`}\r\n              key={option.key}\r\n              selected={selected === option.key}\r\n              onClick={() => handleViewerSelect(option.key)}\r\n            >\r\n              {option.icon}\r\n              <Typography style={{marginLeft: 8}}>{option.title}</Typography>\r\n            </MenuItem>\r\n          ))}\r\n      </Menu>\r\n\r\n      <Dialog\r\n        open={isRefMetaVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setRefMetaVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.sidebar.dialogs.referenceMetadata.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{height: 480}}>\r\n          <iframe\r\n            title={\"title\"}\r\n            src={referenceMetadataUrl}\r\n            style={{\r\n              border: 0,\r\n              width: \"100%\",\r\n              height: \"calc(100% - 6px)\"\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setRefMetaVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withStyles(styles)(DataViewerSideBar)","import React, {Fragment, useState} from 'react';\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    whiteSpace: \"nowrap\"\r\n  },\r\n  sheet: {\r\n    display: \"inline-block\",\r\n    marginRight: 8\r\n  }\r\n});\r\n\r\nfunction DataViewerFooter(props) {\r\n\r\n  const {\r\n    classes,\r\n    labels,\r\n    dataIdx,\r\n    setData\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isConfirmOpen, setConfirmVisibility] = useState(false);\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <div className={classes.root}>\r\n        {labels\r\n          .map((label, idx) => ({key: idx, label: label}))\r\n          .map(sheet => (\r\n            <div key={sheet.key} className={classes.sheet}>\r\n              <Chip\r\n                label={sheet.label}\r\n                color={sheet.key === dataIdx ? \"primary\" : undefined}\r\n                onClick={() => setData(sheet.key)}\r\n                deleteIcon={\r\n                  <Tooltip title={t(\"scenes.dataViewer.footer.worksheetDelete\")}>\r\n                    <CancelIcon/>\r\n                  </Tooltip>\r\n                }\r\n                onDelete={dataIdx === sheet.key\r\n                  ? undefined\r\n                  : () => setConfirmVisibility(true)\r\n                }\r\n              />\r\n            </div>\r\n          ))}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={isConfirmOpen}\r\n        onClose={() => setConfirmVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.footer.dialogs.worksheetDelete.title\")}\r\n        </DialogTitle>\r\n        <DialogActions>\r\n          <Button onClick={() => setConfirmVisibility(false)} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => setConfirmVisibility(false)} color=\"primary\" autoFocus>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(DataViewerFooter)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport {getDimensionAttributeMap} from \"../../utils/jsonStat\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"../label-format-selector/constants\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  filter: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"bottom\",\r\n    minWidth: 120,\r\n    marginRight: 24,\r\n    marginBottom: 8\r\n  },\r\n  dialogContent: {\r\n    padding: \"8px !important\"\r\n  },\r\n  item: {\r\n    fontSize: 14\r\n  },\r\n  itemDisabled: {\r\n    pointerEvents: \"none\",\r\n    '& > svg': {\r\n      visibility: \"hidden\"\r\n    }\r\n  },\r\n  dimensionTitle: {\r\n    marginBottom: 4,\r\n    fontSize: 13,\r\n    color: theme.palette.primary.main\r\n  }\r\n});\r\n\r\nconst getFormattedName = (id, name, labelFormat) => {\r\n  switch (labelFormat) {\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME:\r\n      return name;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID:\r\n      return id;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH:\r\n      return `[${id}] ${name}`;\r\n    default:\r\n      return name;\r\n  }\r\n};\r\n\r\nconst isMultiSelectDim = (dim, layout) => (layout?.primaryDim?.[0] === dim || layout?.secondaryDim?.[0] === dim);\r\n\r\nfunction DatasetFilters(props) {\r\n  const {\r\n    classes,\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    layout,\r\n    labelFormat,\r\n    onSelect,\r\n    addSpinner,\r\n    removeSpinner\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [filters] = useState((layout?.primaryDim || []).concat((layout?.secondaryDim || [])).concat(layout?.filters || []));\r\n\r\n  const [visibleId, setVisibleId] = useState(null);\r\n  const [data, setData] = useState(null);\r\n\r\n  const [checkedKeys, setCheckedKeys] = useState(null);\r\n\r\n  const [dimensionAttributesMap, setDimensionAttributesMap] = useState(null);\r\n\r\n  const [dataSpinnerUuid] = useState(uuidv4());\r\n\r\n  const [worker] = useState(() => new Worker(\"./workers/getDimensionFiltersValueWorker.js\"));\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (worker) {\r\n        worker.terminate();\r\n      }\r\n    }\r\n  }, [worker]);\r\n\r\n  useEffect(() => {\r\n    setDimensionAttributesMap(getDimensionAttributeMap(jsonStat, hiddenAttributes))\r\n  }, [jsonStat, hiddenAttributes]);\r\n\r\n  const handleFilterOpen = visibleId => {\r\n    setVisibleId(visibleId);\r\n    const dim = filters[visibleId];\r\n\r\n    addSpinner(dataSpinnerUuid, t(\"components.datasetFilters.spinners.loading\"));\r\n    worker.onmessage = event => {\r\n      setData(event.data);\r\n      removeSpinner(dataSpinnerUuid);\r\n    }\r\n    worker.postMessage({\r\n      jsonStat,\r\n      dim,\r\n      layout\r\n    });\r\n\r\n    if (isMultiSelectDim(dim, layout)) {\r\n      if (checkedKeys === null && dim === layout?.primaryDim?.[0]) {\r\n        setCheckedKeys(layout.primaryDimValues);\r\n      } else if (checkedKeys === null && dim === layout?.secondaryDim?.[0]) {\r\n        setCheckedKeys(layout.secondaryDimValues);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleFilterClose = () => {\r\n    setVisibleId(null);\r\n    setCheckedKeys(null);\r\n    setData(null)\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.root}>\r\n        {(() => {\r\n          const getTextWidthEl = $('<span>').css({\r\n            visibility: 'hidden',\r\n            position: 'absolute',\r\n            fontSize: 16\r\n          }).appendTo('body').get(0);\r\n\r\n          const select = [];\r\n          filters.forEach((filter, idx) => {\r\n\r\n            const {\r\n              filtersValue\r\n            } = layout;\r\n\r\n            if (isMultiSelectDim(filter, layout) || jsonStat.size[jsonStat.id.indexOf(filter)] !== 1) {\r\n\r\n              const dimLabel = (jsonStat.dimension[filter].label || filter);\r\n              const minWidth = getTextWidth(dimLabel, getTextWidthEl) + 16;\r\n\r\n              select.push(\r\n                <div key={idx} className={classes.filter}>\r\n                  {isMultiSelectDim(filter, layout) && (\r\n                    <InputLabel className={classes.dimensionTitle}>\r\n                      {layout.primaryDim[0] === filter\r\n                        ? t(\"components.datasetFilters.primaryDim\")\r\n                        : t(\"components.datasetFilters.secondaryDim\")\r\n                      }\r\n                    </InputLabel>\r\n                  )}\r\n                  <FormControl style={{display: \"inline-block\", verticalAlign: \"bottom\"}}>\r\n                    <InputLabel>{dimLabel}</InputLabel>\r\n                    <Select\r\n                      open={false}\r\n                      style={{minWidth: minWidth}}\r\n                      value={isMultiSelectDim(filter, layout)\r\n                        ? layout.primaryDim[0] === filter\r\n                          ? layout.primaryDimValues\r\n                          : layout.secondaryDimValues\r\n                        : filtersValue[filter]\r\n                      }\r\n                      multiple={isMultiSelectDim(filter, layout)}\r\n                      renderValue={value => isMultiSelectDim(filter, layout)\r\n                        ? jsonStat.size[jsonStat.id.indexOf(filter)] !== 1\r\n                          ? value.length === 1\r\n                            ? t(\"components.datasetFilters.selectedCount\", {selected: value.length})\r\n                            : t(\"components.datasetFilters.selectedCount_plural\", {selected: value.length})\r\n                          : getFormattedName(value[0], jsonStat.dimension[filter].category.label[value[0]], labelFormat)\r\n                        : getFormattedName(value, jsonStat.dimension[filter].category.label[value], labelFormat)\r\n                      }\r\n                      className={`${classes.item} ${jsonStat.size[jsonStat.id.indexOf(filter)] === 1 ? classes.itemDisabled : \"\"}`}\r\n                      onOpen={() => jsonStat.size[jsonStat.id.indexOf(filter)] === 1\r\n                        ? null\r\n                        : handleFilterOpen(idx)\r\n                      }\r\n                    >\r\n                      {jsonStat.dimension[filter].category.index.map((el, idx) => (\r\n                        <MenuItem key={idx + el} value={el}>{el}</MenuItem>\r\n                      ))}\r\n                    </Select>\r\n                  </FormControl>\r\n                  {dimensionAttributesMap && dimensionAttributesMap[filter][filtersValue[filter]] && ( // TODO: attributi per dimensioni multiselezionabili\r\n                    <div style={{display: \"inline-block\", verticalAlign: \"bottom\", marginLeft: 8, marginBottom: 4}}>\r\n                      <Tooltip\r\n                        title={\r\n                          <div>\r\n                            {dimensionAttributesMap[filter][filtersValue[filter]].attributes.map(({id, label, valueId, valueLabel}, idx) => (\r\n                              <div\r\n                                key={idx}>{`${label || id}: ${valueLabel || valueId}${valueLabel !== valueId ? ` [${valueId}]` : ''}`}</div>\r\n                            ))}\r\n                          </div>\r\n                        }\r\n                        placement=\"top\"\r\n                      >\r\n                        <div>\r\n                          {`[${dimensionAttributesMap[filter][filtersValue[filter]].ids.join(\", \")}]`}\r\n                        </div>\r\n                      </Tooltip>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )\r\n            }\r\n          });\r\n\r\n          $(getTextWidthEl).remove();\r\n\r\n          return select\r\n        })()}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={data !== null}\r\n        onClose={handleFilterClose}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent className={classes.dialogContent}>\r\n          {!isMultiSelectDim(filters[visibleId], layout)\r\n            ? (\r\n              <InfiniteScrollTable\r\n                data={data}\r\n                getRowKey={({id}) => id}\r\n                showHeader={false}\r\n                columns={[\r\n                  {\r\n                    title: \"\",\r\n                    dataIndex: 'label',\r\n                    render: (_, {id, label}) => getFormattedName(id, label, labelFormat),\r\n                    minWidth: 100\r\n                  }\r\n                ]}\r\n                onRowClick={rowData => {\r\n                  onSelect(filters[visibleId], rowData.id);\r\n                  handleFilterClose();\r\n                }}\r\n                getRowStyle={rowData => ({\r\n                  background: rowData.id === layout.filtersValue[filters[visibleId]]\r\n                    ? \"#fff9e5\"\r\n                    : undefined\r\n                })}\r\n              />\r\n            )\r\n            : (\r\n              <InfiniteScrollTable\r\n                data={data}\r\n                getRowKey={({id}) => id}\r\n                columns={[\r\n                  {\r\n                    title: t(\"components.datasetFilters.table.columns.label.title\"),\r\n                    dataIndex: 'label',\r\n                    render: (_, {id, label}) => getFormattedName(id, label, labelFormat),\r\n                    minWidth: 100,\r\n                    noFilter: true\r\n                  }\r\n                ]}\r\n                rowSelection={{\r\n                  selectedRowKeys: checkedKeys,\r\n                  onChange: checkedKeys => setCheckedKeys(data.map(({id}) => id).filter(key => checkedKeys.includes(key)))\r\n                }}\r\n              />\r\n            )\r\n          }\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleFilterClose} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          {isMultiSelectDim(filters[visibleId], layout) && (\r\n            <Button\r\n              onClick={() => {\r\n                onSelect(filters[visibleId], checkedKeys);\r\n                handleFilterClose();\r\n              }}\r\n              color=\"primary\"\r\n              disabled={(checkedKeys || []).length < 1}\r\n            >\r\n              {t(\"commons.confirm.confirm\")}\r\n            </Button>\r\n          )}\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(null, dispatch => ({\r\n    addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n    removeSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError)),\r\n  })),\r\n  withStyles(styles)\r\n)(DatasetFilters);","import React, {Fragment, useEffect, useState} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport TreeItem from \"@material-ui/lab/TreeItem\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\r\nimport TreeView from \"@material-ui/lab/TreeView\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport LibraryAddCheckIcon from \"@material-ui/icons/LibraryAddCheck\";\r\nimport FilterNoneIcon from \"@material-ui/icons/FilterNone\";\r\nimport HeightIcon from \"@material-ui/icons/Height\";\r\nimport VerticalAlignCenterIcon from \"@material-ui/icons/VerticalAlignCenter\";\r\nimport AutoSearchInput from \"../auto-search-input\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {getMaxTreeDepth, getNodesAtDepth} from \"../../utils/tree\";\r\nimport _ from \"lodash\"\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst TREE_PAGE_SIZE = 10;\r\n\r\nconst TREE_NODE_KEY_OF_LEVEL_PREFIX = \"TREE_NODE_KEY_OF_LEVEL_PREFIX_\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: \"100%\"\r\n  },\r\n  tree: {\r\n    overflow: \"auto\",\r\n    \"& .MuiTreeItem-label\": {\r\n      width: \"calc(100% - 19px)\"\r\n    }\r\n  },\r\n  treeActions: {\r\n    marginBottom: 6\r\n  },\r\n  treeNode: {\r\n    height: 34,\r\n    padding: \"2px 0\"\r\n  },\r\n  treeNodeCheckbox: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    padding: \"4px 8px\"\r\n  },\r\n  treeNodeLabel: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    fontSize: 14,\r\n    color: \"rgba(0, 0, 0, 0.65)\",\r\n    whiteSpace: \"nowrap\",\r\n    overflow: \"hidden\",\r\n    textOverflow: \"ellipsis\"\r\n  },\r\n  levelTreeNodeLabel: {\r\n    color: \"rgba(0, 0, 0, 0.85)\",\r\n    fontWeight: 500\r\n  },\r\n  treeNodeAction: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginLeft: 4,\r\n    \"& > button\": {\r\n      padding: 4\r\n    }\r\n  },\r\n  divider: {\r\n    margin: \"4px 0\"\r\n  },\r\n  showMoreNode: {\r\n    marginLeft: 10,\r\n    \"& i\": {\r\n      fontSize: 14\r\n    }\r\n  }\r\n});\r\n\r\nconst getKeys = (tree, childrenKey, getNodeKey, test) => {\r\n\r\n  const res = [];\r\n\r\n  const recursive = subTree =>\r\n    subTree\r\n      ? subTree.map(node => {\r\n        if (node[childrenKey] && node[childrenKey].length) {\r\n          recursive(node[childrenKey]);\r\n        }\r\n        if (!test || test(node)) {\r\n          res.push(getNodeKey(node));\r\n        }\r\n        return null;\r\n      })\r\n      : [];\r\n\r\n  recursive(tree);\r\n\r\n  return res;\r\n}\r\n\r\nconst getFilteredTree = (tree, childrenKey, labelKey, searchText, defaultLanguage, languages, isLabelNotMultilingual) => {\r\n\r\n  const filterNode = node => {\r\n    const search = searchText.toLowerCase();\r\n    return (\r\n      (node.id && node.id.toLowerCase().indexOf(search) >= 0) ||\r\n      (isLabelNotMultilingual && node[labelKey].toLowerCase().indexOf(search) >= 0) ||\r\n      (!isLabelNotMultilingual && localizeI18nObj(node[labelKey], defaultLanguage, languages).toLowerCase().indexOf(search) >= 0)\r\n    );\r\n  };\r\n\r\n  const recursive = subtree => subtree\r\n    ? ([\r\n      ...subtree\r\n        .map(node => ({...node}))\r\n        .filter(node => {\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            if (filterNode(node)) {\r\n              return true;\r\n            } else {\r\n              const filteredChildren = [...recursive(node[childrenKey], filterNode)];\r\n              if (filteredChildren.length) {\r\n                node[childrenKey] = filteredChildren;\r\n                return true;\r\n              } else {\r\n                return false;\r\n              }\r\n            }\r\n          } else {\r\n            return filterNode(node);\r\n          }\r\n        })\r\n    ])\r\n    : null;\r\n\r\n  return recursive(tree, filterNode);\r\n}\r\n\r\nconst handleHeight = (uuid, keys, withLevelSelector) => {\r\n\r\n  const actionHeight = $(`.enhanced-tree__${uuid} .enhanced-tree__actions`).css(\"height\");\r\n\r\n  let levelSelectorHeight = 0;\r\n  if (withLevelSelector) {\r\n    levelSelectorHeight = 32 + 16;\r\n    let found = false;\r\n    for (let i = 0; i < keys.length; i++) {\r\n      if (keys.find(key => key === TREE_NODE_KEY_OF_LEVEL_PREFIX + i) && !found) {\r\n        levelSelectorHeight += 32;\r\n      } else {\r\n        found = true\r\n      }\r\n    }\r\n  }\r\n\r\n  $(`.enhanced-tree__${uuid} .enhanced-tree__tree`).css(\"height\", `calc(100% - ${actionHeight} - ${levelSelectorHeight}px)`);\r\n}\r\n\r\nfunction EnhancedTree(props) {\r\n\r\n  const {\r\n    languages,\r\n    defaultLanguage,\r\n    classes,\r\n    tree,\r\n    getNodeKey,\r\n    childrenKey,\r\n    labelKey,\r\n    getNodeLabel,\r\n    checkable,\r\n    isCheckDisabled,\r\n    defaultExpandedKeys,\r\n    nodeActions,\r\n    withoutSearch,\r\n    withoutCheckControls,\r\n    withoutExpandControls,\r\n    withLevelSelector,\r\n    withoutPagination,\r\n    getIsCheckable,\r\n    isLabelNotMultilingual\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [searchText, setSearchText] = useState(\"\");\r\n\r\n  const [checkedKeys, setCheckedKeys] = useState(props.checkedKeys || []);\r\n  const [expandedKeys, setExpandedKeys] = useState(defaultExpandedKeys || []);\r\n  const [showMoreKeyClicks, setShowMoreKeyClicks] = useState({});\r\n\r\n  useEffect(() => {\r\n    handleHeight(uuid, [], withLevelSelector)\r\n  }, [uuid, withLevelSelector])\r\n\r\n  const handleCheck = (checkedNode, checked) => {\r\n\r\n    const newCheckedKeys = [...(props.checkedKeys || checkedKeys)];\r\n    checked\r\n      ? newCheckedKeys.push(getNodeKey(checkedNode))\r\n      : newCheckedKeys.splice((props.checkedKeys || checkedKeys).indexOf(getNodeKey(checkedNode)), 1);\r\n\r\n    setCheckedKeys(newCheckedKeys);\r\n    if (props.onCheck) {\r\n      props.onCheck(newCheckedKeys)\r\n    }\r\n  }\r\n\r\n  const handleLevelCheck = (checkedNode, checked) => {\r\n\r\n    const nodesAtDepth = getNodesAtDepth(filteredTree, childrenKey, checkedNode.level + 1)\r\n      .filter(node => getIsCheckable ? getIsCheckable(node) : true)\r\n      .map(node => getNodeKey(node));\r\n\r\n    let newCheckedKeys = [...(props.checkedKeys || checkedKeys)];\r\n    newCheckedKeys = checked\r\n      ? _.uniq(newCheckedKeys.concat(nodesAtDepth))\r\n      : newCheckedKeys.filter(key => !nodesAtDepth.includes(key));\r\n\r\n    setCheckedKeys(newCheckedKeys)\r\n    if (props.onCheck) {\r\n      props.onCheck(newCheckedKeys)\r\n    }\r\n  }\r\n\r\n  const handleExpand = expandedKeys => {\r\n    setExpandedKeys(expandedKeys);\r\n    if (props.onExpand) {\r\n      props.onExpand(expandedKeys)\r\n    }\r\n  }\r\n\r\n  const handleSearch = searchText => {\r\n    setSearchText(searchText)\r\n    setExpandedKeys((searchText && searchText.length > 0)\r\n      ? getKeys(filteredTree, childrenKey, getNodeKey)\r\n      : [] // TODO: quale dovrebbe essere il comportamento corretto?\r\n    )\r\n  }\r\n\r\n  const getShowMoreNode = parent => {\r\n\r\n    const key = `${parent ? getNodeKey(parent) : 'root'}`;\r\n\r\n    const remaining = (parent ? parent[childrenKey] : filteredTree.filter(node => node != null)).length - ((showMoreKeyClicks[key] || 0) + 1) * TREE_PAGE_SIZE;\r\n\r\n    return (\r\n      <TreeItem\r\n        key={`${key}_showMore`}\r\n        nodeId={`${key}_showMore`}\r\n        className={classes.showMoreNode}\r\n        label={\r\n          <i\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              setShowMoreKeyClicks({\r\n                ...showMoreKeyClicks,\r\n                [key]:\r\n                  showMoreKeyClicks[key]\r\n                    ? showMoreKeyClicks[key] + 1\r\n                    : 1\r\n              })\r\n            }}\r\n          >\r\n            {t(\"components.enhancedTree.showMore\", {more: Math.min(remaining, TREE_PAGE_SIZE), remaining: remaining})}\r\n          </i>\r\n        }\r\n      />\r\n    );\r\n  }\r\n\r\n  const getTreeNode = (node, getNodeKey, isLevelTree, checkable, checkedKeys, onCheck, getIsCheckable) => {\r\n\r\n    const actions = (nodeActions || [])\r\n      .filter(act => act)\r\n      .map(act => typeof (act) === \"function\" ? act(node) : act)\r\n      .filter(act => act);\r\n\r\n    const label = (getNodeLabel && !isLevelTree)\r\n      ? getNodeLabel(node)\r\n      : isLabelNotMultilingual\r\n        ? node[labelKey]\r\n        : localizeI18nObj(node[labelKey], defaultLanguage, languages);\r\n\r\n    return (\r\n      <TreeItem\r\n        key={getNodeKey(node)}\r\n        nodeId={getNodeKey(node)}\r\n        label={\r\n          <div className={classes.treeNode}>\r\n            {checkable && (\r\n              <Checkbox\r\n                className={classes.treeNodeCheckbox}\r\n                checked={!isLevelTree\r\n                  ? checkedKeys.includes(getNodeKey(node))\r\n                  : !getNodesAtDepth(filteredTree, childrenKey, node.level + 1).filter(node => getIsCheckable ? getIsCheckable(node) : true).map(node => getNodeKey(node)).some(val => checkedKeys.indexOf(val) === -1)}\r\n                onClick={event => {\r\n                  onCheck(node, event.target.checked);\r\n                  event.stopPropagation();\r\n                }}\r\n                disabled={isCheckDisabled || (getIsCheckable ? !getIsCheckable(node) : false)}\r\n              />\r\n            )}\r\n            <Tooltip title={label}>\r\n              <div\r\n                className={`${classes.treeNodeLabel} ${isLevelTree ? classes.levelTreeNodeLabel : \"\"}`}\r\n                style={{width: `calc(100% - ${(checkable ? 40 : 0) + ((actions && actions.length > 0) ? 4 + (32 * actions.length) : 0)}px)`}}\r\n              >\r\n                {label}\r\n              </div>\r\n            </Tooltip>\r\n            {!isLevelTree && (\r\n              <div className={classes.treeNodeAction}>\r\n                {actions\r\n                  .filter(action => (action !== null && action !== undefined))\r\n                  .map((action, idx) =>\r\n                    <Tooltip key={idx} title={action.title}>\r\n                      <IconButton\r\n                        onClick={event => {\r\n                          action.onClick(node);\r\n                          event.stopPropagation();\r\n                        }}\r\n                      >\r\n                        {action.icon}\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        }\r\n      >\r\n        {node[childrenKey]\r\n          ? node[childrenKey]\r\n            .filter((child, index) => withoutPagination || index < TREE_PAGE_SIZE * ((showMoreKeyClicks[getNodeKey(node)] || 0) + 1))\r\n            .map(child => getTreeNode(child, getNodeKey, isLevelTree, checkable, checkedKeys, onCheck, getIsCheckable))\r\n            .concat(!withoutPagination && node[childrenKey].length > TREE_PAGE_SIZE * ((showMoreKeyClicks[getNodeKey(node)] || 0) + 1)\r\n              ? [getShowMoreNode(node)]\r\n              : []\r\n            )\r\n          : null\r\n        }\r\n      </TreeItem>\r\n    )\r\n  };\r\n\r\n  const filteredTree = getFilteredTree(tree, childrenKey, labelKey, searchText, defaultLanguage, languages, isLabelNotMultilingual);\r\n\r\n  let levelTree = []\r\n  if (withLevelSelector) {\r\n    const maxTreeDepth = getMaxTreeDepth(filteredTree, childrenKey);\r\n    levelTree = [{\r\n      id: TREE_NODE_KEY_OF_LEVEL_PREFIX + 0,\r\n      [labelKey]: isLabelNotMultilingual\r\n        ? t(\"components.enhancedTree.levelSelector\", {level: 0})\r\n        : {\r\n          [defaultLanguage]: t(\"components.enhancedTree.levelSelector\", {level: 0})\r\n        },\r\n      level: 0,\r\n    }];\r\n    if (maxTreeDepth !== null && maxTreeDepth !== 0) {\r\n      [...Array(maxTreeDepth - 1)].forEach(() => {\r\n        let pointer = levelTree[0];\r\n        let counter = 0;\r\n        while (pointer[childrenKey]) {\r\n          pointer = pointer[childrenKey][0];\r\n          counter++;\r\n        }\r\n        pointer[childrenKey] = [\r\n          {\r\n            id: TREE_NODE_KEY_OF_LEVEL_PREFIX + Number(counter + 1),\r\n            [labelKey]: isLabelNotMultilingual\r\n              ? t(\"components.enhancedTree.levelSelector\", {level: counter + 1})\r\n              : {\r\n                [defaultLanguage]: t(\"components.enhancedTree.levelSelector\", {level: counter + 1})\r\n              },\r\n            level: counter + 1\r\n          }\r\n        ]\r\n      });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={`enhanced-tree enhanced-tree__${uuid} ${classes.root}`}>\r\n      <div className={`enhanced-tree__actions ${classes.treeActions}`}>\r\n        <Grid container justify=\"space-between\">\r\n          <Grid item xs={6}>\r\n            {!withoutCheckControls\r\n              ? (\r\n                <Fragment>\r\n                  <Tooltip title={t(\"components.enhancedTree.selectAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => {\r\n                        const newCheckedKeys = getKeys(filteredTree, childrenKey, getNodeKey, getIsCheckable);\r\n                        setCheckedKeys(newCheckedKeys)\r\n                        if (props.onCheck) {\r\n                          props.onCheck(newCheckedKeys)\r\n                        }\r\n                      }}\r\n                      disabled={isCheckDisabled}\r\n                    >\r\n                      <LibraryAddCheckIcon/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                  <Tooltip title={t(\"components.enhancedTree.deselectAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => {\r\n                        setCheckedKeys([])\r\n                        if (props.onCheck) {\r\n                          props.onCheck([])\r\n                        }\r\n                      }}\r\n                      disabled={isCheckDisabled}\r\n                    >\r\n                      <FilterNoneIcon style={{padding: 1}}/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                </Fragment>\r\n              )\r\n              : null\r\n            }\r\n            {!withoutExpandControls\r\n              ? (\r\n                <Fragment>\r\n                  <Tooltip title={t(\"components.enhancedTree.expandAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => handleExpand(getKeys(filteredTree, childrenKey, getNodeKey))}><HeightIcon/></IconButton>\r\n                  </Tooltip>\r\n                  <Tooltip title={t(\"components.enhancedTree.collapseAll.tooltip\")}>\r\n                    <IconButton onClick={() => handleExpand([])}><VerticalAlignCenterIcon/></IconButton>\r\n                  </Tooltip>\r\n                </Fragment>\r\n              )\r\n              : null\r\n            }\r\n          </Grid>\r\n          <Grid item xs={6} style={{padding: \"8px 0\"}}>\r\n            {!withoutSearch\r\n              ? (\r\n                <AutoSearchInput\r\n                  onSearch={handleSearch}\r\n                />\r\n              )\r\n              : null\r\n            }\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n      {withLevelSelector && getKeys(filteredTree, childrenKey, getNodeKey).length > 1 && (\r\n        <Fragment>\r\n          <TreeView\r\n            defaultCollapseIcon={<ExpandMoreIcon/>}\r\n            defaultExpandIcon={<ChevronRightIcon/>}\r\n            disableSelection\r\n            onNodeToggle={(ev, nodeIds) => handleHeight(uuid, nodeIds, withLevelSelector)}\r\n          >\r\n            {levelTree.map(node => getTreeNode(node, ({id}) => id, true, checkable, (props.checkedKeys || checkedKeys), handleLevelCheck, getIsCheckable))}\r\n          </TreeView>\r\n          <Divider className={classes.divider}/>\r\n        </Fragment>\r\n      )}\r\n      <div className={`enhanced-tree__tree ${classes.tree}`}>\r\n        {(filteredTree && filteredTree.length > 0)\r\n          ? (\r\n            <TreeView\r\n              defaultCollapseIcon={<ExpandMoreIcon/>}\r\n              defaultExpandIcon={<ChevronRightIcon/>}\r\n              disableSelection\r\n              expanded={expandedKeys}\r\n              onNodeToggle={(ev, nodeIds) => handleExpand(nodeIds)}\r\n            >\r\n              {filteredTree.map(node => getTreeNode(node, getNodeKey, false, checkable, (props.checkedKeys || checkedKeys), handleCheck, getIsCheckable))}\r\n            </TreeView>\r\n          )\r\n          : <CustomEmpty/>\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(EnhancedTree)","import React, {Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {DatePicker, MuiPickersUtilsProvider} from '@material-ui/pickers';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport moment from \"moment\";\r\nimport _ from \"lodash\"\r\nimport {\r\n  CRITERIA_FILTER_TYPE_PERIODS,\r\n  CRITERIA_FILTER_TYPE_RANGE,\r\n  FREQ_MONTHLY,\r\n  FREQ_QUARTERLY,\r\n  FREQ_SEMESTER\r\n} from \"../../utils/criteria\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Switch from '@material-ui/core/Switch';\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  selectContainer: {},\r\n  formControl: {\r\n    width: \"100%\"\r\n  },\r\n  timePeriodInput: {\r\n    width: \"100%\"\r\n  },\r\n  alert: {\r\n    marginTop: 8\r\n  },\r\n  typeSelectorContainer: {\r\n    marginTop: 8\r\n  },\r\n  typeSelectorLabel: {\r\n    height: 38,\r\n    lineHeight: \"38px\"\r\n  },\r\n  typeSelectorSwitch: {\r\n    \"& > span.MuiSwitch-switchBase\": {\r\n      color: \"#00295a\"\r\n    },\r\n    \"& > span.MuiSwitch-track\": {\r\n      background: \"#00295a\"\r\n    }\r\n  },\r\n  lastPeriodsLabel: {\r\n    height: 48,\r\n    lineHeight: \"48px\"\r\n  },\r\n  lastPeriodsInput: {\r\n    \"& input\": {\r\n      height: 20,\r\n      padding: 14\r\n    }\r\n  }\r\n});\r\n\r\nconst periods = year => ({\r\n  [FREQ_SEMESTER]: {\r\n    values: [\"S1\", \"S2\"],\r\n    S1: {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    S2: {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  [FREQ_QUARTERLY]: {\r\n    values: [\"Q1\", \"Q2\", \"Q3\", \"Q4\"],\r\n    Q1: {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-03`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q2: {\r\n      start: `${year}-04-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q3: {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-09`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q4: {\r\n      start: `${year}-10-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  [FREQ_MONTHLY]: {\r\n    values: [\"01\", \"02\", \"03\", \"04\", \"05\", \"06\", \"07\", \"08\", \"09\", \"10\", \"11\", \"12\"],\r\n    \"01\": {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-01`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"02\": {\r\n      start: `${year}-02-01`,\r\n      end: moment(`${year}-02`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"03\": {\r\n      start: `${year}-03-01`,\r\n      end: moment(`${year}-03`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"04\": {\r\n      start: `${year}-04-01`,\r\n      end: moment(`${year}-04`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"05\": {\r\n      start: `${year}-05-01`,\r\n      end: moment(`${year}-05`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"06\": {\r\n      start: `${year}-06-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"07\": {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-07`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"08\": {\r\n      start: `${year}-08-01`,\r\n      end: moment(`${year}-08`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"09\": {\r\n      start: `${year}-09-01`,\r\n      end: moment(`${year}-09`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"10\": {\r\n      start: `${year}-10-01`,\r\n      end: moment(`${year}-10`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"11\": {\r\n      start: `${year}-11-01`,\r\n      end: moment(`${year}-11`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"12\": {\r\n      start: `${year}-12-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  }\r\n});\r\n\r\nconst getYearsArray = (startYear, endYear) => {\r\n  const res = [];\r\n\r\n  if (startYear && endYear) {\r\n    const startYearNumeric = Number(startYear);\r\n    const endYearNumeric = Number(endYear);\r\n\r\n    for (let i = startYearNumeric; i <= endYearNumeric; i++) {\r\n      res.push(i + \"\");\r\n    }\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nconst getPeriod = (freq, date) => {\r\n  if (freq && date) {\r\n    const year = date.slice(0, 4);\r\n\r\n    if (periods(year)[freq]) {\r\n      const dateMoment = moment(date, \"YYYY-MM-DD\");\r\n\r\n      return periods(year)[freq].values.find(period => {\r\n        const start = moment(periods(year)[freq][period].start, \"YYYY-MM-DD\");\r\n        const end = moment(periods(year)[freq][period].end, \"YYYY-MM-DD\");\r\n\r\n        return dateMoment.isBetween(start, end, null, \"[]\");\r\n      });\r\n    }\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\nconst getNewTimePeriodFromYear = (timePeriod, date, year, minYear, maxYear, period, minPeriod, maxPeriod, isFrom) => {\r\n  let newDate;\r\n\r\n  if (isFrom) {\r\n    if (year === minYear && period && minPeriod) {\r\n      if (moment((year + period), \"YYYY-MM-DD\").isSameOrAfter(moment(timePeriod.minDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].start;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][minPeriod].start;\r\n      }\r\n\r\n    } else if (year === maxYear && period && maxPeriod) {\r\n      if (moment((year + period), \"YYYY-MM-DD\").isSameOrBefore(moment(timePeriod.maxDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].start;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][maxPeriod].start;\r\n      }\r\n\r\n    } else {\r\n      newDate = period\r\n        ? periods(year)[timePeriod.freq][period].start\r\n        : year + \"-01-01\";\r\n    }\r\n\r\n  } else {\r\n    if (year === minYear && period && minPeriod) {\r\n      if (period && moment((year + period), \"YYYY-MM-DD\").isSameOrAfter(moment(timePeriod.minDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].end;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][minPeriod].end;\r\n      }\r\n\r\n    } else if (year === maxYear && period && maxPeriod) {\r\n      if (period && moment((year + period), \"YYYY-MM-DD\").isSameOrBefore(moment(timePeriod.maxDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].end;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][maxPeriod].end;\r\n      }\r\n\r\n    } else {\r\n      newDate = period\r\n        ? periods(year)[timePeriod.freq][period].end\r\n        : year + \"-12-31\";\r\n    }\r\n  }\r\n\r\n  return {\r\n    ...timePeriod,\r\n    fromDate: isFrom ? newDate : timePeriod.fromDate,\r\n    toDate: !isFrom ? newDate : timePeriod.toDate,\r\n  }\r\n};\r\n\r\nconst handleSetTimePeriod = (newTimePeriod, onSetTimePeriod, setCriteriaValidity) => {\r\n  onSetTimePeriod(newTimePeriod);\r\n  setCriteriaValidity(moment(newTimePeriod.fromDate, \"YYYY-MM-DD\").isSameOrBefore(moment(newTimePeriod.toDate, \"YYYY-MM-DD\")));\r\n};\r\n\r\nconst TimePeriod = ({\r\n                      t,\r\n                      classes,\r\n                      timePeriod,\r\n                      onSetTimePeriod,\r\n                      isCriteriaValid,\r\n                      setCriteriaValidity\r\n                    }) => {\r\n\r\n  const minYear = timePeriod.minDate ? moment(timePeriod.minDate).format(\"YYYY\") : null;\r\n  const maxYear = timePeriod.maxDate ? moment(timePeriod.maxDate).format(\"YYYY\") : null;\r\n  const fromYear = timePeriod.fromDate ? moment(timePeriod.fromDate).format(\"YYYY\") : null;\r\n  const toYear = timePeriod.toDate ? moment(timePeriod.toDate).format(\"YYYY\") : null;\r\n\r\n  const minPeriod = getPeriod(timePeriod.freq, timePeriod.minDate);\r\n  const maxPeriod = getPeriod(timePeriod.freq, timePeriod.maxDate);\r\n  const fromPeriod = getPeriod(timePeriod.freq, timePeriod.fromDate);\r\n  const toPeriod = getPeriod(timePeriod.freq, timePeriod.toDate);\r\n\r\n  const fromPeriods = periods(fromYear)[timePeriod.freq]\r\n    ? periods(fromYear)[timePeriod.freq].values.slice(\r\n      fromYear === minYear ? periods(fromYear)[timePeriod.freq].values.indexOf(minPeriod) : 0,\r\n      fromYear === maxYear ? periods(fromYear)[timePeriod.freq].values.indexOf(maxPeriod) + 1 : undefined\r\n    )\r\n    : [];\r\n  const toPeriods = periods(toYear)[timePeriod.freq]\r\n    ? periods(toYear)[timePeriod.freq].values.slice(\r\n      toYear === minYear ? periods(toYear)[timePeriod.freq].values.indexOf(minPeriod) : 0,\r\n      toYear === maxYear ? periods(toYear)[timePeriod.freq].values.indexOf(maxPeriod) + 1 : undefined\r\n    )\r\n    : [];\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid container spacing={3}>\r\n        <Grid item xs={12}>\r\n          {timePeriod.freq !== null && !timePeriod.missingRange && (\r\n            <Grid container spacing={2} justify=\"flex-end\">\r\n              <Grid item>\r\n                <div className={classes.typeSelectorLabel}>\r\n                  {t(\"components.criteria.timePeriod.typeSelector.selectRange\")}\r\n                </div>\r\n              </Grid>\r\n              <Grid item>\r\n                <Switch\r\n                  className={classes.typeSelectorSwitch}\r\n                  color=\"default\"\r\n                  checked={timePeriod.selectorType === CRITERIA_FILTER_TYPE_PERIODS}\r\n                  onChange={() => onSetTimePeriod({\r\n                    ...timePeriod,\r\n                    selectorType: timePeriod.selectorType === CRITERIA_FILTER_TYPE_PERIODS\r\n                      ? CRITERIA_FILTER_TYPE_RANGE\r\n                      : CRITERIA_FILTER_TYPE_PERIODS\r\n                  })}\r\n                />\r\n              </Grid>\r\n              <Grid item>\r\n                <div className={classes.typeSelectorLabel}>\r\n                  {t(\"components.criteria.timePeriod.typeSelector.selectLastPeriods\")}\r\n                </div>\r\n              </Grid>\r\n            </Grid>\r\n          )}\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          {timePeriod.selectorType === CRITERIA_FILTER_TYPE_RANGE\r\n            ? timePeriod.freq !== null\r\n              ? (\r\n                <Fragment>\r\n                  {!isCriteriaValid && (\r\n                    <Grid item xs={12} className={classes.alert}>\r\n                      <Alert severity=\"warning\">{t(\"components.criteria.timePeriod.alert.notValidRange\")}</Alert>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid container spacing={4}>\r\n                    <Grid item xs={12}>\r\n                      <Grid container spacing={2} className={classes.selectContainer}>\r\n                        <Grid item xs={12}>\r\n                          {t(\"components.criteria.timePeriod.start\")}\r\n                        </Grid>\r\n                        <Grid item xs={periods(fromYear)[timePeriod.freq] !== undefined ? 6 : 12}>\r\n                          {fromYear && minYear && toYear && (\r\n                            <FormControl className={classes.formControl}>\r\n                              <InputLabel>{t(\"components.criteria.timePeriod.year\")}</InputLabel>\r\n                              <Select\r\n                                value={fromYear}\r\n                                onChange={ev => {\r\n                                  const year = ev.target.value;\r\n                                  const newTimePeriod = getNewTimePeriodFromYear(timePeriod, timePeriod.fromDate, year, minYear, maxYear, fromPeriod, minPeriod, maxPeriod, true);\r\n                                  handleSetTimePeriod(newTimePeriod, onSetTimePeriod, setCriteriaValidity);\r\n                                }}\r\n                              >\r\n                                {getYearsArray(minYear, maxYear).map((year, idx) => (\r\n                                  <MenuItem key={idx} value={year}>{year}</MenuItem>\r\n                                ))}\r\n                              </Select>\r\n                            </FormControl>\r\n                          )}\r\n                        </Grid>\r\n                        {fromYear && periods(fromYear)[timePeriod.freq] !== undefined && fromPeriods && fromPeriod && (\r\n                          <Grid item xs={6}>\r\n                            <FormControl className={classes.formControl}>\r\n                              <InputLabel>{t(\"components.criteria.timePeriod.period\")}</InputLabel>\r\n                              <Select\r\n                                value={fromPeriod}\r\n                                onChange={ev => {\r\n                                  const period = ev.target.value;\r\n                                  const newTimePeriod = _.cloneDeep(timePeriod);\r\n                                  newTimePeriod.fromDate = periods(fromYear)[timePeriod.freq][period].start;\r\n                                  handleSetTimePeriod(newTimePeriod, onSetTimePeriod, setCriteriaValidity);\r\n                                }}\r\n                              >\r\n                                {fromPeriods.map((period, idx) => (\r\n                                  <MenuItem key={idx} value={period}>{period}</MenuItem>\r\n                                ))}\r\n                              </Select>\r\n                            </FormControl>\r\n                          </Grid>\r\n                        )}\r\n                      </Grid>\r\n                    </Grid>\r\n                    <Grid item xs={12}>\r\n                      <Grid container spacing={2} className={classes.selectContainer}>\r\n                        <Grid item xs={12}>\r\n                          {t(\"components.criteria.timePeriod.end\")}\r\n                        </Grid>\r\n                        <Grid item xs={periods(toYear)[timePeriod.freq] !== undefined ? 6 : 12}>\r\n                          {toYear && fromYear && maxYear && (\r\n                            <FormControl className={classes.formControl}>\r\n                              <InputLabel>{t(\"components.criteria.timePeriod.year\")}</InputLabel>\r\n                              <Select\r\n                                value={toYear}\r\n                                onChange={ev => {\r\n                                  const year = ev.target.value;\r\n                                  const newTimePeriod = getNewTimePeriodFromYear(timePeriod, timePeriod.toDate, year, minYear, maxYear, toPeriod, minPeriod, maxPeriod, false);\r\n                                  handleSetTimePeriod(newTimePeriod, onSetTimePeriod, setCriteriaValidity);\r\n                                }}\r\n                              >\r\n                                {getYearsArray(minYear, maxYear).map((year, idx) => (\r\n                                  <MenuItem key={idx} value={year}>{year}</MenuItem>\r\n                                ))}\r\n                              </Select>\r\n                            </FormControl>\r\n                          )}\r\n                        </Grid>\r\n                        {toYear && periods(toYear)[timePeriod.freq] !== undefined && toPeriods && toPeriod && (\r\n                          <Grid item xs={6}>\r\n                            <FormControl className={classes.formControl}>\r\n                              <InputLabel>{t(\"components.criteria.timePeriod.period\")}</InputLabel>\r\n                              <Select\r\n                                value={toPeriods.includes(toPeriod) ? toPeriod : toPeriods[toPeriods.length - 1]}\r\n                                onChange={ev => {\r\n                                  const period = ev.target.value;\r\n                                  const newTimePeriod = _.cloneDeep(timePeriod);\r\n                                  newTimePeriod.toDate = periods(toYear)[timePeriod.freq][period].end;\r\n                                  handleSetTimePeriod(newTimePeriod, onSetTimePeriod, setCriteriaValidity);\r\n                                }}\r\n                              >\r\n                                {toPeriods.map((period, idx) => (\r\n                                  <MenuItem key={idx} value={period}>{period}</MenuItem>\r\n                                ))}\r\n                              </Select>\r\n                            </FormControl>\r\n                          </Grid>\r\n                        )}\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Fragment>\r\n              )\r\n              : (\r\n                <Grid container spacing={3}>\r\n                  <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n                    <Grid item xs={6}>\r\n                      <DatePicker\r\n                        openTo=\"year\"\r\n                        format=\"yyyy-MM-dd\"\r\n                        label={t(\"components.criteria.timePeriod.from\")}\r\n                        views={[\"year\", \"month\", \"date\"]}\r\n                        clearable\r\n                        minDate={moment(timePeriod.minDate)}\r\n                        maxDate={moment(timePeriod.toDate)}\r\n                        value={moment(timePeriod.fromDate)}\r\n                        onChange={date => onSetTimePeriod({\r\n                          ...timePeriod,\r\n                          fromDate: date ? moment(date).format(\"YYYY-MM-DD\") : timePeriod.minDate\r\n                        })}\r\n                        className={classes.timePeriodInput}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <DatePicker\r\n                        openTo=\"year\"\r\n                        format=\"yyyy-MM-dd\"\r\n                        label={t(\"components.criteria.timePeriod.to\")}\r\n                        views={[\"year\", \"month\", \"date\"]}\r\n                        clearable\r\n                        minDate={moment(timePeriod.fromDate)}\r\n                        maxDate={moment(timePeriod.maxDate)}\r\n                        value={moment(timePeriod.toDate)}\r\n                        onChange={date => onSetTimePeriod({\r\n                          ...timePeriod,\r\n                          toDate: date ? moment(date).format(\"YYYY-MM-DD\") : timePeriod.maxDate\r\n                        })}\r\n                        className={classes.timePeriodInput}\r\n                      />\r\n                    </Grid>\r\n                  </MuiPickersUtilsProvider>\r\n                </Grid>\r\n              )\r\n            : (\r\n              <Grid container spacing={2} justify=\"center\">\r\n                <Grid item>\r\n                  <div className={classes.lastPeriodsLabel}>\r\n                    {t(\"components.criteria.timePeriod.selectLastPeriods.selectLast\")}\r\n                  </div>\r\n                </Grid>\r\n                <Grid item>\r\n                  <TextField\r\n                    value={timePeriod.periods || \"\"}\r\n                    placeholder={t(\"components.criteria.timePeriod.selectLastPeriods.noPeriodsSelected\")}\r\n                    type=\"number\"\r\n                    variant=\"outlined\"\r\n                    className={classes.lastPeriodsInput}\r\n                    style={{width: 400}}\r\n                    onChange={({target}) => {\r\n                      if (target.value === \"\") {\r\n                        onSetTimePeriod({\r\n                          ...timePeriod,\r\n                          periods: null\r\n                        })\r\n                      } else if (!isNaN(target.value) && Number(target.value) > 0) {\r\n                        onSetTimePeriod({\r\n                          ...timePeriod,\r\n                          periods: Number(target.value)\r\n                        })\r\n                      }\r\n                    }}\r\n                  />\r\n                </Grid>\r\n                <Grid item>\r\n                  <div className={classes.lastPeriodsLabel}>\r\n                    {t(\"components.criteria.timePeriod.selectLastPeriods.periods\")}\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n          }\r\n        </Grid>\r\n      </Grid>\r\n    </Fragment>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(TimePeriod)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Call from \"../../hocs/call\";\r\nimport {\r\n  CRITERIA_SELECTION_MODE_ALL,\r\n  CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n  CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n  fetchDatasetStructureCodelist,\r\n  fetchDatasetStructureCodelists,\r\n  setDatasetStructureCodelistCriteria,\r\n  setDatasetStructureCodelistTimePeriod\r\n} from \"../../state/dataset/datasetActions\";\r\nimport EnhancedTree from \"../enhanced-tree\";\r\nimport _ from \"lodash\"\r\nimport PlaylistAddCheckIcon from \"@material-ui/icons/PlaylistAddCheck\"\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport TimePeriod from \"./TimePeriod\";\r\nimport Typography from '@material-ui/core/Typography';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {TIME_PERIOD_DIMENSION_KEY} from \"../../utils/jsonStat\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {CRITERIA_FILTER_TYPE_CODES, CRITERIA_FILTER_TYPE_STRING} from \"../../utils/criteria\";\r\n\r\nconst CRITERIA_CONTAINER_HEIGHT = 380;\r\nconst CODELIST_INFO_HEIGHT = 40;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  criteriaContainer: {\r\n    width: \"100%\",\r\n    height: CRITERIA_CONTAINER_HEIGHT,\r\n    padding: 8\r\n  },\r\n  codelistInfo: {\r\n    width: \"100%\",\r\n    height: CODELIST_INFO_HEIGHT,\r\n    padding: \"8px 0\"\r\n  },\r\n  codelistContainer: {\r\n    width: \"100%\",\r\n    height: `calc(100% - ${CODELIST_INFO_HEIGHT}px)`,\r\n  },\r\n  emptyContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  timePeriodContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  treeActions: {\r\n    marginBottom: 8\r\n  },\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchCodelist: ({nodeId, datasetId, dimensionId, type, criteria}) => dispatch(fetchDatasetStructureCodelist(nodeId, datasetId, dimensionId, type, criteria)),\r\n  fetchCodelists: ({nodeId, datasetId, type}) => dispatch(fetchDatasetStructureCodelists(nodeId, datasetId, type)),\r\n  onSetCriteria: criteria => dispatch(setDatasetStructureCodelistCriteria(criteria)),\r\n  onSetTimePeriod: timePeriod => dispatch(setDatasetStructureCodelistTimePeriod(timePeriod)),\r\n});\r\n\r\nfunction Criteria(props) {\r\n  const {\r\n    t,\r\n    classes,\r\n    nodeId,\r\n    datasetId,\r\n    dimensions,\r\n    mode,\r\n    type,\r\n    codes,\r\n    isCodesFlat,\r\n    codelists,\r\n    areCodelistsFlat,\r\n    codelistsLength,\r\n    criteria,\r\n    timePeriod,\r\n    fetchCodelist,\r\n    fetchCodelists,\r\n    onSetCriteria,\r\n    onSetTimePeriod,\r\n    isCriteriaValid,\r\n    setCriteriaValidity\r\n  } = props;\r\n\r\n  const [tabId, setTabId] = useState(0);\r\n  const [isCallDisabled, setIsCallDisabled] = useState(false);\r\n\r\n  const [tmpCriteria, setTmpCriteria] = useState(null);\r\n  const [tmpTabId, setTmpTabId] = useState(null);\r\n\r\n  const handleTabChange = tabId => {\r\n\r\n    if (type === CRITERIA_SELECTION_TYPE_DYNAMIC && tabId < (dimensions.length - 1)) {\r\n      const newCriteria = _.cloneDeep(criteria);\r\n\r\n      const criteriaToRemove = dimensions\r\n        .map(({id}) => id)\r\n        .slice(tabId + 1)\r\n        .filter(dim => newCriteria[dim] !== null && newCriteria[dim] !== undefined);\r\n\r\n      if (criteriaToRemove.length > 0) {\r\n        criteriaToRemove.forEach(dim => newCriteria[dim] = undefined);\r\n        setTmpCriteria(newCriteria);\r\n        setTmpTabId(tabId);\r\n\r\n      } else {\r\n        setTabId(tabId);\r\n        setIsCallDisabled(false);\r\n      }\r\n\r\n    } else {\r\n      setTabId(tabId);\r\n      setIsCallDisabled(false);\r\n    }\r\n  };\r\n\r\n  const handleCheck = (checkedKeys, type) => {\r\n    const newCriteria = _.cloneDeep(criteria);\r\n    const dimensionId = dimensions[tabId].id;\r\n\r\n    newCriteria[dimensionId] = (checkedKeys || []).length > 0\r\n      ? {\r\n        id: dimensionId,\r\n        type: (type || CRITERIA_FILTER_TYPE_CODES),\r\n        filterValues: checkedKeys,\r\n        period: null,\r\n        from: null,\r\n        to: null\r\n      }\r\n      : undefined;\r\n\r\n    onSetCriteria(newCriteria);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (dimensions && isCallDisabled === false) {\r\n      setIsCallDisabled(true)\r\n    }\r\n  }, [dimensions, isCallDisabled]);\r\n\r\n  const checkedKeys = (criteria[dimensions[tabId].id]?.filterValues || []);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {dimensions && (\r\n        <Fragment>\r\n          <AppBar position=\"static\" color=\"default\">\r\n            <Tabs\r\n              value={tabId}\r\n              variant=\"scrollable\"\r\n              scrollButtons=\"auto\"\r\n              indicatorColor=\"primary\"\r\n              textColor=\"primary\"\r\n              onChange={(event, newValue) => handleTabChange(newValue)}\r\n            >\r\n              {(dimensions || []).map((dim, idx) => (\r\n                <Tab\r\n                  key={idx}\r\n                  label={\r\n                    <Tooltip title={dim.label || \"\"}>\r\n                      <span>\r\n                        {dim.id + (\r\n                          codelistsLength[idx]\r\n                            ? ` (${(criteria[dim.id]?.filterValues || []).length}/${codelistsLength[idx]})`\r\n                            : ''\r\n                        )}\r\n                      </span>\r\n                    </Tooltip>\r\n                  }\r\n                  disabled={!isCriteriaValid}\r\n                />\r\n              ))}\r\n            </Tabs>\r\n          </AppBar>\r\n          <div key={tabId} className={classes.criteriaContainer}>\r\n            <Call\r\n              cb={mode === CRITERIA_SELECTION_MODE_STEP_BY_STEP\r\n                ? fetchCodelist\r\n                : fetchCodelists\r\n              }\r\n              cbParam={{\r\n                nodeId,\r\n                datasetId,\r\n                dimensionId: dimensions[tabId].id,\r\n                mode,\r\n                type,\r\n                criteria\r\n              }}\r\n              disabled={!nodeId || !datasetId || !dimensions || (mode === CRITERIA_SELECTION_MODE_ALL && !!codelists) || isCallDisabled}\r\n            >\r\n              {(() => {\r\n                const data = mode === CRITERIA_SELECTION_MODE_STEP_BY_STEP\r\n                  ? codes\r\n                  : codelists?.[tabId];\r\n\r\n                const isCheckDisabled = ((data || []).length === 1 && (data[0].children || []).length === 0);\r\n\r\n                if (!data) {\r\n                  return (\r\n                    <div className={classes.emptyContainer}>\r\n                      <CustomEmpty/>\r\n                    </div>\r\n                  )\r\n\r\n                } else if (dimensions[tabId].id === TIME_PERIOD_DIMENSION_KEY) {\r\n                  return (\r\n                    <div className={classes.timePeriodContainer}>\r\n                      <TimePeriod\r\n                        timePeriod={timePeriod}\r\n                        onSetTimePeriod={onSetTimePeriod}\r\n                        isCriteriaValid={isCriteriaValid}\r\n                        setCriteriaValidity={setCriteriaValidity}\r\n                      />\r\n                    </div>\r\n                  )\r\n\r\n                } else {\r\n                  return (\r\n                    <Fragment>\r\n                      <Typography className={classes.codelistInfo}>\r\n                        {`${dimensions[tabId].label || dimensions[tabId].id}${dimensions[tabId]?.extra?.DataStructureRef ? ` (${dimensions[tabId].extra.DataStructureRef})` : \"\"}`}\r\n                      </Typography>\r\n                      <div className={classes.codelistContainer}>\r\n                        {(data.length === 0)\r\n                          ? (\r\n                            <Fragment>\r\n                              <div style={{margin: \"16px 0\"}}>\r\n                                {t(\"components.criteria.noCodelistAssociated.info\")}\r\n                              </div>\r\n                              <TextField\r\n                                value={checkedKeys[0] || \"\"}\r\n                                placeholder={t(\"components.criteria.noCodelistAssociated.noFilter\")}\r\n                                variant=\"outlined\"\r\n                                style={{width: \"100%\"}}\r\n                                onChange={({target}) => handleCheck([target.value], CRITERIA_FILTER_TYPE_STRING)}\r\n                              />\r\n                            </Fragment>\r\n                          )\r\n                          : (isCodesFlat === true || areCodelistsFlat?.[tabId] === true)\r\n                            ? (\r\n                              <InfiniteScrollTable\r\n                                data={data}\r\n                                getRowKey={({id}) => id}\r\n                                columns={[\r\n                                  {\r\n                                    title: t(\"components.criteria.table.columns.name.title\"),\r\n                                    dataIndex: 'name',\r\n                                    render: (_, {id, name}) => `[${id}] ${name}`,\r\n                                    minWidthToContent: true,\r\n                                    noFilter: true\r\n                                  }\r\n                                ]}\r\n                                rowSelection={{\r\n                                  selectedRowKeys: checkedKeys,\r\n                                  onChange: handleCheck,\r\n                                }}\r\n                                isCheckDisabled={isCheckDisabled}\r\n                                height={204}\r\n                              />\r\n                            )\r\n                            : (\r\n                              <EnhancedTree\r\n                                key={tabId}\r\n                                tree={data}\r\n                                getNodeKey={({id}) => id}\r\n                                childrenKey=\"children\"\r\n                                labelKey=\"name\"\r\n                                getNodeLabel={node => `[${node.id}] ${node.name}`}\r\n                                isLabelNotMultilingual\r\n                                checkable\r\n                                withLevelSelector\r\n                                checkedKeys={checkedKeys}\r\n                                getIsCheckable={node => node.isSelectable !== false}\r\n                                // defaultExpandedKeys={criteria[dimensions[tabId].id] || []}\r\n                                onCheck={handleCheck}\r\n                                isCheckDisabled={isCheckDisabled}\r\n                                nodeActions={[\r\n                                  node => (node.children && node.children.length > 0)\r\n                                    ? {\r\n                                      icon: <PlaylistAddCheckIcon/>,\r\n                                      title: t(\"components.criteria.tree.nodeActions.selectAll.title\"),\r\n                                      onClick: node => {\r\n                                        let newCheckedKeys = [...checkedKeys];\r\n                                        const childrenKeys = (node.children || []).filter(({isSelectable}) => isSelectable !== false).map(({id}) => id)\r\n                                        const unselectedChildrenKeys = childrenKeys.filter(key => !newCheckedKeys.includes(key))\r\n\r\n                                        newCheckedKeys = (unselectedChildrenKeys.length > 0)\r\n                                          ? newCheckedKeys.concat(childrenKeys)\r\n                                          : newCheckedKeys.filter(key => !childrenKeys.includes(key));\r\n                                        handleCheck(_.uniq(newCheckedKeys));\r\n                                      }\r\n                                    }\r\n                                    : null\r\n                                ]}\r\n                              />\r\n                            )\r\n                        }\r\n                      </div>\r\n                    </Fragment>\r\n                  )\r\n                }\r\n              })()}\r\n            </Call>\r\n          </div>\r\n\r\n          <Dialog\r\n            open={tmpCriteria !== null}\r\n            fullWidth\r\n            maxWidth=\"sm\"\r\n            onClose={() => setTmpCriteria(null)}\r\n          >\r\n            <DialogContent>\r\n              {t(\"components.criteria.dialogs.warning.losingFilters.title\")}\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button\r\n                onClick={() => {\r\n                  setTmpCriteria(null);\r\n                  setTmpTabId(null);\r\n                }}\r\n              >\r\n                cancel\r\n              </Button>\r\n              <Button\r\n                autoFocus\r\n                onClick={() => {\r\n                  setTmpCriteria(null);\r\n                  onSetCriteria(tmpCriteria);\r\n                  setTmpTabId(null);\r\n                  setTabId(tmpTabId);\r\n                  setIsCallDisabled(false);\r\n                }}\r\n                color=\"primary\"\r\n              >\r\n                ok\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n\r\n        </Fragment>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(null, mapDispatchToProps)\r\n)(Criteria)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport ViewCompactIcon from '@material-ui/icons/ViewCompact';\r\nimport ViewStreamIcon from '@material-ui/icons/ViewStream';\r\nimport ViewColumnIcon from '@material-ui/icons/ViewColumn';\r\nimport JsonStatTable from \"../table\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sectionContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(60% - 8px)\",\r\n    marginRight: 16\r\n  },\r\n  section: {\r\n    height: 216,\r\n    background: \"#eeeeee\"\r\n  },\r\n  sectionHeaderContainer: {\r\n    height: 48,\r\n    padding: \"16px 16px 0\"\r\n  },\r\n  sectionHeaderIcon: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginRight: 8\r\n  },\r\n  sectionHeaderTitle: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    height: 30,\r\n  },\r\n  sectionContentWrapper: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 48px)\",\r\n    padding: 16\r\n  },\r\n  draggingHover: {\r\n    border: \"1px dashed #999999\"\r\n  },\r\n  sectionContent: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\"\r\n  },\r\n  sectionItem: {\r\n    textAlign: \"center\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px\"\r\n  },\r\n  previewContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(40% - 8px)\"\r\n  },\r\n  divider: {\r\n    marginBottom: 16\r\n  }\r\n});\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n  userSelect: 'none',\r\n  height: 32,\r\n  marginBottom: 8,\r\n  ...draggableStyle\r\n});\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const [removed] = list.splice(startIndex, 1);\r\n  list.splice(endIndex, 0, removed);\r\n};\r\n\r\nconst move = (source, destination, droppableSource, droppableDestination) => {\r\n  const [removed] = source.splice(droppableSource.index, 1);\r\n  destination.splice(droppableDestination.index, 0, removed);\r\n};\r\n\r\nconst onDragEnd = (result, dimensions, setDimensions) => {\r\n\r\n  const {\r\n    source,\r\n    destination\r\n  } = result;\r\n\r\n  // dropped outside the list\r\n  if (!destination) {\r\n    return;\r\n  }\r\n\r\n  const newDimensions = JSON.parse(JSON.stringify(dimensions));\r\n\r\n  if (source.droppableId === destination.droppableId) {\r\n    reorder(\r\n      newDimensions[source.droppableId],\r\n      source.index,\r\n      destination.index\r\n    );\r\n\r\n  } else {\r\n    move(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source,\r\n      destination\r\n    );\r\n  }\r\n\r\n  setDimensions(newDimensions);\r\n};\r\n\r\nconst Section = ({\r\n                   classes,\r\n                   id,\r\n                   title,\r\n                   Icon,\r\n                   dimensions,\r\n                   jsonStat\r\n                 }) =>\r\n\r\n  <Card variant=\"outlined\" className={classes.section}>\r\n    <CardHeader\r\n      title={\r\n        <Fragment>\r\n          <div className={classes.sectionHeaderIcon}>{Icon}</div>\r\n          <Typography className={classes.sectionHeaderTitle} variant=\"button\">{title}</Typography>\r\n        </Fragment>\r\n      }\r\n      className={classes.sectionHeaderContainer}\r\n    />\r\n    <Droppable droppableId={id}>\r\n      {(provided, snapshot) => (\r\n        <div className={`${classes.sectionContentWrapper} ${snapshot.isDraggingOver ? classes.draggingHover : \"\"}`}>\r\n          <div ref={provided.innerRef} className={classes.sectionContent}>\r\n            {dimensions.map((item, idx) =>\r\n              <Draggable\r\n                key={idx}\r\n                index={idx}\r\n                draggableId={`${id}-${idx}`}\r\n              >\r\n                {(provided, snapshot) => (\r\n                  <div\r\n                    ref={provided.innerRef}\r\n                    {...provided.draggableProps}\r\n                    {...provided.dragHandleProps}\r\n                    style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\r\n                  >\r\n                    <Tooltip title={jsonStat.dimension[item].label}>\r\n                      <Paper className={classes.sectionItem}>\r\n                        {`${item} (${jsonStat.size[jsonStat.id.indexOf(item)]})`}\r\n                      </Paper>\r\n                    </Tooltip>\r\n                  </div>\r\n                )}\r\n              </Draggable>\r\n            )}\r\n            {provided.placeholder}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  </Card>;\r\n\r\nconst TableLayout = ({\r\n                       t,\r\n                       classes,\r\n                       jsonStat,\r\n                       layout,\r\n                       labelFormat,\r\n                       setLayout\r\n                     }) => {\r\n  const {\r\n    filters,\r\n    sections,\r\n    rows,\r\n    cols,\r\n  } = layout;\r\n\r\n  let colCount = 1;\r\n  cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  let rowCount = 1;\r\n  rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n  sections.forEach(section => rowCount *= jsonStat.size[jsonStat.id.indexOf(section)]);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider className={classes.divider}/>\r\n      <div className={classes.sectionContainer}>\r\n        <DragDropContext onDragEnd={result => onDragEnd(result, layout, setLayout)}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"filters\"\r\n                title={t(\"components.tableLayout.sections.filters\")}\r\n                Icon={<FilterListIcon/>}\r\n                dimensions={filters}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"sections\"\r\n                title={t(\"components.tableLayout.sections.sections\")}\r\n                Icon={<ViewCompactIcon/>}\r\n                dimensions={sections}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"rows\"\r\n                title={t(\"components.tableLayout.sections.rows\")}\r\n                Icon={<ViewStreamIcon/>}\r\n                dimensions={rows}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"cols\"\r\n                title={t(\"components.tableLayout.sections.columns\")}\r\n                Icon={<ViewColumnIcon/>}\r\n                dimensions={cols}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n        </DragDropContext>\r\n      </div>\r\n      <div className={`${classes.previewContainer}`}>\r\n        <JsonStatTable\r\n          jsonStat={jsonStat}\r\n          layout={layout}\r\n          labelFormat={labelFormat}\r\n          isPreview={true}\r\n        />\r\n        <Grid container spacing={1} style={{marginTop: 16}}>\r\n          <Grid item xs={12} style={{textAlign: \"end\"}}>\r\n            {t(\"components.tableLayout.rowCount\", {rowCount})}\r\n          </Grid>\r\n          <Grid item xs={12} style={{textAlign: \"end\"}}>\r\n            {t(\"components.tableLayout.colCount\", {colCount})}\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(TableLayout)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\n\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_SM = \"sm\";\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_MD = \"md\";\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_LG = \"lg\";\r\n\r\nconst styles = theme => ({\r\n  fontSizeIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontWeight: \"bold\",\r\n    display: \"table\"\r\n  },\r\n  fontSizeIconSm: {\r\n    fontSize: 14\r\n  },\r\n  fontSizeIconMd: {\r\n    fontSize: 16\r\n  },\r\n  fontSizeIconLg: {\r\n    fontSize: 20\r\n  },\r\n  fontSizeSelected: {\r\n    \"& div\": {\r\n      boxShadow: \"inset 0 -2px 0 0 rgba(0, 0, 0, .54)\"\r\n    }\r\n  }\r\n});\r\n\r\nconst getFontSizeIcon = styleClasses =>\r\n  <div className={styleClasses}>\r\n    <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n      A\r\n    </div>\r\n  </div>;\r\n\r\nconst FontSizeSelector = ({\r\n  t,\r\n                            classes,\r\n                            fontSize,\r\n                            setFontSize\r\n                          }) =>\r\n\r\n  <Fragment>\r\n    <Tooltip title={t(\"components.fontSizeSelector.small.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_SM ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_SM)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconSm}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n    <Tooltip title={t(\"components.fontSizeSelector.normal.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_MD ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_MD)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconMd}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n    <Tooltip title={t(\"components.fontSizeSelector.big.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_LG ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_LG)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconLg}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n  </Fragment>;\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(FontSizeSelector)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport ViewCompactIcon from '@material-ui/icons/ViewCompact';\r\nimport ViewStreamIcon from '@material-ui/icons/ViewStream';\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sectionContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(60% - 8px)\",\r\n    marginRight: 16\r\n  },\r\n  section: {\r\n    background: \"#eeeeee\"\r\n  },\r\n  sectionLeft: {\r\n    height: 416\r\n  },\r\n  sectionRight: {\r\n    height: 200\r\n  },\r\n  sectionHeaderContainer: {\r\n    height: 48,\r\n    padding: \"16px 16px 0\"\r\n  },\r\n  sectionHeaderIcon: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginRight: 8\r\n  },\r\n  sectionHeaderTitle: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    height: 30,\r\n  },\r\n  sectionContentWrapper: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 48px)\",\r\n    padding: 16\r\n  },\r\n  draggingHover: {\r\n    border: \"1px dashed #999999\"\r\n  },\r\n  sectionContent: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\"\r\n  },\r\n  sectionItem: {\r\n    textAlign: \"center\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px\"\r\n  },\r\n  divider: {\r\n    marginBottom: 16\r\n  }\r\n});\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n  userSelect: 'none',\r\n  height: 32,\r\n  marginBottom: 8,\r\n  ...draggableStyle\r\n});\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const [removed] = list.splice(startIndex, 1);\r\n  list.splice(endIndex, 0, removed);\r\n};\r\n\r\nconst move = (source, destination, droppableSource, droppableDestination) => {\r\n  const [removed] = source.splice(droppableSource.index, 1);\r\n  destination.splice(droppableDestination.index, 0, removed);\r\n};\r\n\r\nconst swap = (sourceArr, destinationArr, droppableSource) => {\r\n  const [removedSrc] = sourceArr.splice(droppableSource.index, 1);\r\n  const [removedDst] = destinationArr.splice(0, 1, removedSrc);\r\n  sourceArr.splice(sourceArr.length, 0, removedDst);\r\n};\r\n\r\nconst onDragEnd = (result, dimensions, setDimensions) => {\r\n\r\n  const {\r\n    source,\r\n    destination\r\n  } = result;\r\n\r\n  // dropped outside the list\r\n  if (!destination) {\r\n    return;\r\n  }\r\n\r\n  const newDimensions = JSON.parse(JSON.stringify(dimensions));\r\n\r\n  if (source.droppableId === destination.droppableId) {\r\n    reorder(\r\n      newDimensions[source.droppableId],\r\n      source.index,\r\n      destination.index\r\n    );\r\n\r\n  } else if (\r\n    (source.droppableId === \"secondaryDim\" && destination.droppableId === \"filters\") ||\r\n    (source.droppableId === \"filters\" && destination.droppableId === \"secondaryDim\" && newDimensions[destination.droppableId].length === 0)\r\n  ) {\r\n    move(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source,\r\n      destination\r\n    );\r\n\r\n  } else {\r\n    swap(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source\r\n    );\r\n  }\r\n\r\n  setDimensions(newDimensions);\r\n};\r\n\r\nconst Section = ({\r\n                   classes,\r\n                   sectionClasses,\r\n                   id,\r\n                   title,\r\n                   Icon,\r\n                   dimensions,\r\n                   jsonStat\r\n                 }) =>\r\n\r\n  <Card variant=\"outlined\" className={`${classes.section} ${sectionClasses}`}>\r\n    <CardHeader\r\n      title={\r\n        <Fragment>\r\n          <div className={classes.sectionHeaderIcon}>{Icon}</div>\r\n          <Typography className={classes.sectionHeaderTitle} variant=\"button\">{title}</Typography>\r\n        </Fragment>\r\n      }\r\n      className={classes.sectionHeaderContainer}\r\n    />\r\n    <Droppable droppableId={id}>\r\n      {(provided, snapshot) => (\r\n        <div className={`${classes.sectionContentWrapper} ${snapshot.isDraggingOver ? classes.draggingHover : \"\"}`}>\r\n          <div ref={provided.innerRef} className={classes.sectionContent}>\r\n            {dimensions.map((item, idx) =>\r\n              <Draggable\r\n                key={idx}\r\n                index={idx}\r\n                draggableId={`${id}-${idx}`}\r\n                isDragDisabled={id === \"primaryDim\"}\r\n              >\r\n                {(provided, snapshot) => (\r\n                  <div\r\n                    ref={provided.innerRef}\r\n                    {...provided.draggableProps}\r\n                    {...provided.dragHandleProps}\r\n                    style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\r\n                  >\r\n                    <Paper\r\n                      className={classes.sectionItem}\r\n                    >\r\n                      {`${item} (${jsonStat.size[jsonStat.id.indexOf(item)]})`}\r\n                    </Paper>\r\n                  </div>\r\n                )}\r\n              </Draggable>\r\n            )}\r\n            {provided.placeholder}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  </Card>;\r\n\r\nconst ChartLayout = ({\r\n                       t,\r\n                       classes,\r\n                       jsonStat,\r\n                       layout,\r\n                       setLayout\r\n                     }) => {\r\n\r\n  const {\r\n    primaryDim,\r\n    secondaryDim,\r\n    filters\r\n  } = layout;\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider className={classes.divider}/>\r\n      <div className={classes.sectionContainer}>\r\n        <DragDropContext onDragEnd={result => onDragEnd(result, layout, setLayout)}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                sectionClasses={classes.sectionLeft}\r\n                id=\"filters\"\r\n                title={t(\"components.chartLayout.filters.title\")}\r\n                Icon={<FilterListIcon/>}\r\n                dimensions={filters}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Grid item xs={12} style={{paddingBottom: 8}}>\r\n                <Section\r\n                  classes={classes}\r\n                  sectionClasses={classes.sectionRight}\r\n                  id=\"primaryDim\"\r\n                  title={t(\"components.chartLayout.primaryDim.title\")}\r\n                  Icon={<ViewCompactIcon/>}\r\n                  dimensions={primaryDim}\r\n                  jsonStat={jsonStat}\r\n                />\r\n              </Grid>\r\n              <Grid item xs={12} style={{paddingTop: 8}}>\r\n                <Section\r\n                  classes={classes}\r\n                  sectionClasses={classes.sectionRight}\r\n                  id=\"secondaryDim\"\r\n                  title={t(\"components.chartLayout.secondaryDim.title\")}\r\n                  Icon={<ViewStreamIcon/>}\r\n                  dimensions={secondaryDim}\r\n                  jsonStat={jsonStat}\r\n                />\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        </DragDropContext>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ChartLayout)","import React, {useEffect, useState} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport \"./style.css\";\r\nimport WebFont from 'webfontloader';\r\nimport {numberFormatter} from \"../../utils/formatters\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport Call from \"../../hocs/call/index\";\r\nimport {\r\n  getDataIdxFromDimensionsArray,\r\n  getDimensionFiltersValue,\r\n  getDimensionValuesIndexesMap\r\n} from \"../../utils/jsonStat\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  markSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\nfunction Map(props) {\r\n  const {\r\n    mapId = `map__${uuidv4()}`,\r\n    mapLayout,\r\n    jsonStat,\r\n    onGeometryFetch,\r\n    geometries,\r\n    geometryDetailLevels,\r\n    hideSpinner,\r\n    isFullscreen,\r\n    addSpinner,\r\n    markSpinner\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [currentDetailLevel, setCurrentDetailLevel] = useState(-1);\r\n\r\n  const [filteredGeometries, setFilteredGeometries] = useState(null);\r\n\r\n  const [spinnerUuid] = useState(uuidv4());\r\n\r\n  useEffect(() => {\r\n    window.dispatchEvent(new Event('resize'));\r\n  }, [isFullscreen]);\r\n\r\n  // select default detail level\r\n  useEffect(() => {\r\n\r\n    if (!geometryDetailLevels) {\r\n      return;\r\n    }\r\n\r\n    if (geometryDetailLevels && geometryDetailLevels?.length > 0) {\r\n      const firstNotEmptyLevelIndex = geometryDetailLevels.findIndex(el => el);\r\n      setCurrentDetailLevel(geometryDetailLevels[firstNotEmptyLevelIndex].level);\r\n    }\r\n\r\n    return () => {\r\n      window.LMap.destroyMap(mapId)\r\n    }\r\n  }, [mapId, geometryDetailLevels]);\r\n\r\n\r\n  // init the map with filtered geometries\r\n  useEffect(() => {\r\n\r\n    if (!filteredGeometries || filteredGeometries.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const mapTranslations = {\r\n      configure: t(\"components.map.translation.configure\"),\r\n      opacity: t(\"components.map.translation.opacity\"),\r\n      from: t(\"components.map.translation.from\"),\r\n      to: t(\"components.map.translation.to\"),\r\n      cancel: t(\"components.map.translation.cancel\"),\r\n      apply: t(\"components.map.translation.apply\"),\r\n      classification: t(\"components.map.translation.classification\"),\r\n      equalInterval: t(\"components.map.translation.equalInterval\"),\r\n      naturalBreaks: t(\"components.map.translation.naturalBreaks\"),\r\n      quantile: t(\"components.map.translation.quantile\"),\r\n      numberOfClasses: t(\"components.map.translation.numberOfClasses\"),\r\n      startColor: t(\"components.map.translation.startColor\"),\r\n      endColor: t(\"components.map.translation.endColor\"),\r\n      preview: t(\"components.map.translation.preview\")\r\n    };\r\n\r\n    const isGeometryData = false;\r\n\r\n    if (!hideSpinner) {\r\n      addSpinner(spinnerUuid, t(\"components.map.spinners.rendering\"));\r\n    }\r\n\r\n    const layerOptions = {\r\n      srid: \"EPSG:4326\",\r\n      legendSettings: {\r\n        paletteStartColor: \"#eff3ff\",\r\n        paletteEndColor: \"#2171b5\",\r\n        paletteCardinality: 9,\r\n        pointStartRadius: 1,\r\n        pointEndRadius: 9,\r\n        pointRadiusCardinality: 9,\r\n        opacity: 0.9,\r\n        classificationMethod: \"quantile\"\r\n      },\r\n      onDataRender: function () {\r\n        markSpinner(spinnerUuid);\r\n      },\r\n      borderColor: [128, 128, 128, 0.5],\r\n      valueFormatter: numberFormatter,\r\n      centerMarker:\r\n        isGeometryData\r\n          ? \"data:image/png;base64,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\"\r\n          : undefined,\r\n      centerMarkerText: isGeometryData ? \"test\" : undefined,\r\n      selectedCenterMarker:\r\n        isGeometryData\r\n          ? \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADIklEQVR4AbXXA3hrWRQF4Ixt27Zt27atcGzbto3YeUZt2zbiNau+PVVO0uzv+9+r97o4UsVT6z7iUa1D66s9q26pc6+6td6lGpK0OuMF05BVaEs6jR6h949/1vzzdjrHz1tonJ+Qgc6hbbbUulbZUuuct8ZDdqCnKJsGCISTnjODAcCmY/yUTy/SzpurnSoGSbj5KZRGUYKSGECQTWdvrXcLIeSbVxIIkgFAdXQWDYWQDrAdrSCITnveiNPp1Bcs2NHgxKZqBzZ9ZMYg6bQjSV+9Tmx8Op1J93+1GD8vKcXiwkZYc5rwtqscZ7yzHFuy4ebTh3hi5H1wxRxgI1oqNj/nZQs+dxegsy8AsVp7/HjGWIRt9a7pQqTwEWxKMQc4mNonBXjehHctOQiEwpipBoNhqH/Pw2Zqhxigk46gmANcSMGJ5kZc+54LVS09mKsKG3tw4PMLGWJSgDBdIRPgZsKYU58z4pnfUxGKRDFXBcMR3PBVBjaZ+lLellCA9625iLV0f+YnHOBiCikDvPZvJqJRzFlR/tA9P+WIASJ0lUyAo6hbOe7v/GwhOvr8mKuau/048Y2l4ovYS8fLBNiGCgljznrJjH9TKjFXfbGoClvrXOLtL6MdZAKsSt8SlCPh6ndcWFbcNO2jiPCL1txm7P/sAnEEgH7iJLS6zDww9h74xSn4srcc+NJTgKL6TrT3+tHMCSi9uhPPmYqx11O+6eaAwNjz30rnkpqON6FFBGFCIiMuecOOGz704YTXFmO3J7zDjTcXr5xoOW1Oca2GNyknJNEJz5qwjVZoPFmY7qS4l+RNyJvAcrxEuPq47sJF1BtHgH66nMRVUDrEWvR1HAF+5G1fh+ZlT7gflUoEqKSDxKtPNMRd5I8hQJDu21ztEF+8hEOsSz/EEOB3Nt5A4sWTugt7Ud4sAYpof+Wkk4wQl1LXNAF66Gr5s4B8iNXoeQorAkTpVTZeXbz1yQqxMXfHfykCmGiz5DYXHsXZL5r2POFZc9b2ekfeZhrnvmye3AOqGGIXg1115NOWY3c12E/kIVV87smvTTRu1ca0yah4638QYUyY6yhczwAAAABJRU5ErkJggg==\"\r\n          : undefined\r\n    };\r\n\r\n    const mapOptions = {\r\n      baseMap: \"osm\",\r\n      baseMapToGray: true,\r\n      onLoadingStart: function () {\r\n        console.log(\"Map creation - start\");\r\n      },\r\n      onLoadingFinish: function () {\r\n        console.log(\"Map creation - done\");\r\n      },\r\n      legendFontFamily: \"Roboto\"\r\n    };\r\n\r\n    WebFont.load({\r\n      google: {\r\n        families: ['Roboto:300,400,500,700']\r\n      },\r\n      active: () => {\r\n        window.LMap.initMap(mapId, mapOptions, mapTranslations);\r\n        window.LMap.addLayer(mapId, filteredGeometries, \"Dataset\", layerOptions);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      window.LMap.destroyMap(mapId)\r\n    }\r\n  }, [mapId, filteredGeometries, spinnerUuid, hideSpinner, addSpinner, markSpinner, t]);\r\n\r\n\r\n  // check for missing geometry ids\r\n  useEffect(() => {\r\n    if (!geometries) {\r\n      return;\r\n    }\r\n    const geometryMap = {};\r\n    geometries.forEach(g => geometryMap[g.id] = g);\r\n\r\n    const missingGeometryList = [];\r\n    jsonStat.dimension[mapLayout.territoryDim].category.index.forEach(geomId => {\r\n      if (!geometryMap[geomId]) {\r\n        const missingEntry = {id: geomId, label: jsonStat.dimension[mapLayout.territoryDim].category.label[geomId]};\r\n        missingGeometryList.push(missingEntry);\r\n      }\r\n    });\r\n    console.log(\"missing ids\", missingGeometryList);\r\n  }, [jsonStat, geometries, mapLayout.territoryDim])\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    if (!geometries || !currentDetailLevel < 0) {\r\n      return;\r\n    }\r\n\r\n    const geometryMap = {};\r\n    geometries.forEach(g => geometryMap[g.id] = g);\r\n\r\n    const filters = [...mapLayout.filters];\r\n    const filtersValues = {...mapLayout.filtersValue};\r\n    const territoryDimName = mapLayout?.territoryDim;\r\n    const dimensionFilterValues = getDimensionFiltersValue(jsonStat, mapLayout?.territoryDim, filters, filtersValues);\r\n    const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n    const data = [];\r\n    var levelsCounter = {};\r\n    dimensionFilterValues.forEach(territoryDim => {\r\n      const dimValueArray = jsonStat.id.map(dim => {\r\n        if (dim === territoryDimName) {\r\n          return territoryDim.id;\r\n        } else {\r\n          return filtersValues[dim];\r\n        }\r\n      });\r\n      const valueIdx = getDataIdxFromDimensionsArray(\r\n        dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n        jsonStat.size\r\n      );\r\n      const valueId = jsonStat.value[valueIdx];\r\n      const geom = geometryMap[territoryDim.id];\r\n\r\n      if (valueId !== null && valueId !== undefined && geom && geom.nutsLevel === +currentDetailLevel) {\r\n        data.push({\r\n          \"value\": valueId,\r\n          \"identifier\": geom.uniqueId,\r\n          \"geometry\": geom.wkt,\r\n          \"label\": territoryDim.label\r\n        });\r\n      }\r\n      if (valueId && geom?.nutsLevel >= 0) {\r\n        if (!levelsCounter[geom.nutsLevel]) {\r\n          levelsCounter[geom.nutsLevel] = 0;\r\n        }\r\n        levelsCounter[geom.nutsLevel]++;\r\n      }\r\n    });\r\n\r\n    /*\r\n    // set the first not empty level\r\n    if(data.length === 0){\r\n      const firstNotEmpty = Object.entries(levelsCounter).filter((entry) => {return entry[1] > 1;});\r\n      if(firstNotEmpty?.length > 0){\r\n        setCurrentDetailLevel(firstNotEmpty[0][0]);\r\n        return;\r\n      }\r\n    }\r\n    */\r\n\r\n    setFilteredGeometries(data);\r\n\r\n  }, [geometries, mapLayout, currentDetailLevel, jsonStat]);\r\n\r\n  return (\r\n    mapLayout?.territoryDim && jsonStat.dimension[mapLayout.territoryDim]\r\n      ? (\r\n        <Call\r\n          cb={onGeometryFetch}\r\n          cbParam={[...jsonStat.dimension[mapLayout.territoryDim].category.index]}\r\n          disabled={geometries !== null && geometries !== undefined && geometryDetailLevels !== null && geometryDetailLevels !== undefined}\r\n        >\r\n          {geometryDetailLevels && geometryDetailLevels.length > 1 && (\r\n            <div style={{float: \"left\", position: \"relative\", zIndex: 1}}>\r\n              <div style={{background: \"rgba(255, 255, 255, 0.7)\", margin: 8, padding: 8}}>\r\n                {(() => {\r\n                  const getTextWidthEl = $('<span>').css({\r\n                    visibility: 'hidden',\r\n                    position: 'absolute',\r\n                    fontSize: 16\r\n                  }).appendTo('body').get(0);\r\n\r\n                  const label = t(\"components.map.detailLevel\");\r\n                  const Component = (\r\n                    <FormControl>\r\n                      <InputLabel>{label}</InputLabel>\r\n                      <Select\r\n                        value={currentDetailLevel}\r\n                        style={{minWidth: (getTextWidth(label, getTextWidthEl) + 16)}}\r\n                        onChange={ev => setCurrentDetailLevel(ev.target.value)}\r\n                      >\r\n                        {geometryDetailLevels.map(val =>\r\n                          <MenuItem value={val.level} key={val.level}>{val.label}</MenuItem>\r\n                        )}\r\n                      </Select>\r\n                    </FormControl>\r\n                  );\r\n\r\n                  $(getTextWidthEl).remove();\r\n\r\n                  return Component\r\n                })()}\r\n              </div>\r\n            </div>\r\n          )}\r\n          {currentDetailLevel > 0 && filteredGeometries && filteredGeometries.length === 0 && (\r\n            <CustomEmpty\r\n              text={\r\n                t(\"components.map.noDataToDisplayFor\") +\r\n                \" \" +\r\n                ((geometryDetailLevels || []).find(lev => lev.level === +currentDetailLevel)?.label || \"\")\r\n              }\r\n            />\r\n          )}\r\n          <div id={mapId} style={{width: \"100%\", height: \"100%\", position: \"relative\", zIndex: 0}}/>\r\n        </Call>\r\n      )\r\n      : <CustomEmpty text={t(\"components.map.noTerritorialDim\")}/>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  connect(null, mapDispatchToProps)\r\n)(Map);\r\n","import React from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"./constants\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    margin: \"0 4px\"\r\n  },\r\n  label: {\r\n    color: \"rgba(0, 0, 0, 0.54)\",\r\n    fontSize: 13,\r\n    width: 80,\r\n    height: 40,\r\n    lineHeight: \"40px\",\r\n    marginRight: 8\r\n  },\r\n  formControl: {\r\n    margin: \"8px 0\"\r\n  },\r\n  select: {\r\n    width: 80,\r\n    \"& .MuiSelect-root.MuiSelect-select\": {\r\n      padding: \"2px 24px 3px 0\",\r\n      fontSize: 14\r\n    }\r\n  },\r\n  menuItem: {\r\n    fontSize: 14\r\n  }\r\n});\r\n\r\nconst LabelFormatSelector = ({\r\n                               t,\r\n                               classes,\r\n                               labelFormat,\r\n                               setLabelFormat\r\n                             }) =>\r\n  <Grid container className={classes.root}>\r\n    <Grid item className={classes.label}>\r\n      {t(\"components.labelFormatSelector.labelFormat.title\")}:\r\n    </Grid>\r\n    <Grid item>\r\n      <FormControl className={classes.formControl}>\r\n        <Select\r\n          className={classes.select}\r\n          value={(labelFormat || \"\")}\r\n          onChange={(ev) => setLabelFormat(ev.target.value)}\r\n        >\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.name\")}\r\n          </MenuItem>\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.id\")}\r\n          </MenuItem>\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.both\")}\r\n          </MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n    </Grid>\r\n  </Grid>\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(LabelFormatSelector)","import React, {Component, createRef, Fragment} from 'react';\r\nimport ChartJs from 'chart.js';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {getFormattedValue} from \"../../utils/formatters\";\r\nimport {\r\n  getDataIdxFromDimensionsArray,\r\n  getDimensionValueLabelFromJsonStat,\r\n  getDimensionValuesIndexesMap,\r\n  TIME_PERIOD_DIMENSION_KEY\r\n} from \"../../utils/jsonStat\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport _ from \"lodash\";\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nconst colors = [\r\n  '#1E88E5',\r\n  '#C2185B',\r\n  '#FDD835',\r\n  '#0E9D59',\r\n  '#F06292',\r\n  '#FF7043',\r\n  '#8BC34A',\r\n  '#00BCD4',\r\n  '#EA3F4D',\r\n  '#AA47BC',\r\n  '#26A69A',\r\n  '#FF9800',\r\n];\r\n\r\nconst hexToRGBA = (hex, alpha) => {\r\n  const r = parseInt(hex.slice(1, 3), 16);\r\n  const g = parseInt(hex.slice(3, 5), 16);\r\n  const b = parseInt(hex.slice(5, 7), 16);\r\n\r\n  return \"rgba(\" + r + \", \" + g + \", \" + b + \", \" + alpha + \")\";\r\n};\r\n\r\nconst getChartType = type => {\r\n  switch (type) {\r\n    case \"area\":\r\n      return \"line\"\r\n    case \"pyramid\":\r\n      return \"horizontalBar\"\r\n    default:\r\n      return type\r\n  }\r\n};\r\n\r\nconst isBarOrLineGraph = type => (\r\n  type === \"bar\" ||\r\n  type === \"horizontalBar\" ||\r\n  type === \"line\" ||\r\n  type === \"area\" ||\r\n  type === \"pyramid\"\r\n);\r\n\r\nconst getOptions = (chartType, data, decimalSeparator, decimalPlaces) => {\r\n\r\n  let max = 0;\r\n  data.datasets.forEach(dataset => dataset.data.forEach(value => max = Math.max(max, Math.abs(value))));\r\n  max += Math.floor(max / 100 * 20);\r\n\r\n  return {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    scales: isBarOrLineGraph(chartType)\r\n      ? {\r\n        xAxes: [{\r\n          gridLines: {\r\n            display: chartType !== \"bar\"\r\n          },\r\n          ticks: {\r\n            beginAtZero: (chartType === \"horizontalBar\" || chartType === \"pyramid\"),\r\n            callback: value => {\r\n              if (chartType === \"horizontalBar\" || chartType === \"pyramid\") {\r\n                if (chartType === \"pyramid\" && data.datasets.length === 2 && value < 0) {\r\n                  return getFormattedValue(-value, decimalSeparator, decimalPlaces)\r\n                } else {\r\n                  return getFormattedValue(value, decimalSeparator, decimalPlaces)\r\n                }\r\n              } else {\r\n                return value\r\n              }\r\n            },\r\n            max: chartType === \"pyramid\" ? max : undefined,\r\n            min: chartType === \"pyramid\" ? -(max) : undefined,\r\n          },\r\n          stacked: chartType === \"pyramid\",\r\n        }],\r\n        yAxes: [{\r\n          gridLines: {\r\n            display: (chartType !== \"horizontalBar\" && chartType !== \"pyramid\")\r\n          },\r\n          ticks: {\r\n            beginAtZero: (chartType !== \"horizontalBar\" && chartType !== \"pyramid\"),\r\n            callback: value => (chartType !== \"horizontalBar\" && chartType !== \"pyramid\")\r\n              ? getFormattedValue(value, decimalSeparator, decimalPlaces)\r\n              : value\r\n          },\r\n          stacked: chartType === \"pyramid\"\r\n        }]\r\n      }\r\n      : {},\r\n    tooltips: {\r\n      enabled: true,\r\n      mode: \"index\",\r\n      callbacks: {\r\n        title: (tooltipItem, data) => (data.labels[tooltipItem[0].index] || ''),\r\n        label: (tooltipItem, data) => {\r\n          const getValue = () => {\r\n            let value = dataset.data[tooltipItem.index];\r\n            if (!value) {\r\n              return null;\r\n            }\r\n            value = getFormattedValue(value, decimalSeparator, decimalPlaces);\r\n            if (chartType === \"pyramid\" && data.datasets.length === 2 && tooltipItem.datasetIndex === 0 && value[0] === \"-\") {\r\n              return value.slice(1)\r\n            } else {\r\n              return value\r\n            }\r\n          };\r\n          const dataset = data.datasets[tooltipItem.datasetIndex];\r\n          const value = getValue();\r\n          return value ? `${dataset.label}: ${getValue()}` : null\r\n        }\r\n      }\r\n    },\r\n    plugins: {\r\n      datalabels: {\r\n        anchor: \"end\",\r\n        align: \"end\",\r\n        clip: true,\r\n        formatter: value => getFormattedValue(value, decimalSeparator, decimalPlaces)\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nconst getData = (chartType, jsonStat, layout, removeEmptyValues, labelFormat) => {\r\n\r\n  const {\r\n    primaryDim,\r\n    primaryDimValues,\r\n    secondaryDim,\r\n    secondaryDimValues,\r\n    filtersValue\r\n  } = layout;\r\n\r\n  const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n  const valorizedDataMap = {};\r\n  secondaryDimValues.forEach(secondaryDimValue => {\r\n    valorizedDataMap[secondaryDimValue] = new Array(primaryDimValues.length).fill(false);\r\n  });\r\n  const valorizedDataArr = new Array(primaryDimValues.length).fill(false);\r\n\r\n  const datasets = [];\r\n\r\n  if (secondaryDimValues && secondaryDimValues.length > 0) {\r\n    secondaryDimValues.forEach((secondaryDimValue, secDimIdx) => {\r\n      const data = [];\r\n      primaryDimValues.forEach((primaryDimValue, primDimIdx) => {\r\n        const dimValueArray = jsonStat.id.map(dim => {\r\n          if (dim === primaryDim[0]) {\r\n            return primaryDimValue;\r\n          } else if (dim === secondaryDim[0]) {\r\n            return secondaryDimValue;\r\n          } else {\r\n            return filtersValue[dim];\r\n          }\r\n        });\r\n        const valueIdx = getDataIdxFromDimensionsArray(\r\n          dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n          jsonStat.size\r\n        );\r\n        const value = jsonStat.value[valueIdx];\r\n        if (value) {\r\n          if (chartType === \"pyramid\" && secondaryDimValues.length === 2 && secDimIdx === 0) {\r\n            data.push(-value);\r\n          } else {\r\n            data.push(value);\r\n          }\r\n          valorizedDataMap[secondaryDimValue][primDimIdx] = true;\r\n        } else {\r\n          data.push(null);\r\n        }\r\n      });\r\n      datasets.push({\r\n        label: getDimensionValueLabelFromJsonStat(jsonStat, secondaryDim[0], secondaryDimValue, labelFormat),\r\n        data: data\r\n      });\r\n    });\r\n\r\n  } else {\r\n    const data = [];\r\n    primaryDimValues.forEach((primaryDimValue, primDimIdx) => {\r\n      const dimValueArray = jsonStat.id.map(dim => {\r\n        if (dim === primaryDim[0]) {\r\n          return primaryDimValue;\r\n        } else {\r\n          return filtersValue[dim];\r\n        }\r\n      });\r\n      const valueIdx = getDataIdxFromDimensionsArray(\r\n        dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n        jsonStat.size\r\n      );\r\n      const value = jsonStat.value[valueIdx];\r\n      if (value) {\r\n        data.push(value);\r\n        valorizedDataArr[primDimIdx] = true;\r\n      } else {\r\n        data.push(null);\r\n      }\r\n    });\r\n    datasets.push({\r\n      label: \"\",\r\n      data: data\r\n    });\r\n  }\r\n\r\n  const labels = [];\r\n\r\n  if (removeEmptyValues) {\r\n    const valorizedValues = (secondaryDimValues && secondaryDimValues.length > 0)\r\n      ? new Array(primaryDimValues.length)\r\n      : [...valorizedDataArr];\r\n\r\n    if (secondaryDimValues && secondaryDimValues.length > 0) {\r\n      primaryDimValues.forEach((_, idx) => {\r\n        let found = false;\r\n        secondaryDimValues.forEach(secDim => {\r\n          if (!found && valorizedDataMap[secDim][idx] === true) {\r\n            found = true;\r\n          }\r\n        });\r\n        valorizedValues[idx] = found;\r\n      });\r\n    }\r\n\r\n    datasets.forEach(dataset => dataset.data = dataset.data.filter((_, idx) => valorizedValues[idx]));\r\n\r\n    primaryDimValues.forEach((value, idx) => {\r\n      if (valorizedValues[idx]) {\r\n        labels.push(getDimensionValueLabelFromJsonStat(jsonStat, primaryDim[0], value, labelFormat));\r\n      }\r\n    });\r\n\r\n  } else {\r\n    primaryDimValues.forEach(value => {\r\n      labels.push(getDimensionValueLabelFromJsonStat(jsonStat, primaryDim[0], value, labelFormat));\r\n    });\r\n  }\r\n\r\n  let colorArr = colors;\r\n  if (datasets.length > 0) {\r\n    while (colorArr.length < datasets[0].data.length) {\r\n      colorArr = colorArr.concat(colorArr);\r\n    }\r\n    if (colorArr.length > datasets[0].data.length) {\r\n      colorArr = colorArr.slice(0, datasets[0].data.length)\r\n    }\r\n  }\r\n\r\n  return {\r\n    labels: labels,\r\n    datasets: datasets.map((dataset, idx) => ({\r\n      ...dataset,\r\n      borderWidth: 1,\r\n      lineTension: chartType === \"area\" ? 0 : undefined,\r\n      fill: (chartType === \"area\" || chartType === \"radar\"),\r\n      backgroundColor: ((isBarOrLineGraph(chartType) || chartType === \"radar\") && colorArr.length > 0)\r\n        ? hexToRGBA(colors[idx % colors.length], 0.3)\r\n        : colorArr.map(col => hexToRGBA(col, 0.3)),\r\n      borderColor: ((isBarOrLineGraph(chartType) || chartType === \"radar\") && colorArr.length > 0)\r\n        ? colors[idx % colors.length]\r\n        : colorArr\r\n    }))\r\n  };\r\n};\r\n\r\nconst getDefaultRemoveEmptyValues = (type, {primaryDim}) => !((type === \"line\" || type === \"area\") && primaryDim[0] === TIME_PERIOD_DIMENSION_KEY);\r\n\r\nclass Chart extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.chartRef = createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    const {\r\n      jsonStat,\r\n      type,\r\n      layout,\r\n      removeEmptyValues = getDefaultRemoveEmptyValues(type, layout),\r\n      labelFormat,\r\n      decimalSeparator,\r\n      decimalPlaces,\r\n      backgroundColor = \"white\"\r\n    } = this.props;\r\n\r\n    ChartJs.defaults.global.defaultFontFamily = \"'Roboto', 'Helvetica', 'Arial', sans-serif\";\r\n\r\n    const data = getData(type, jsonStat, layout, removeEmptyValues, labelFormat);\r\n    this.myChart = new ChartJs(this.chartRef.current, {\r\n      type: getChartType(type),\r\n      options: getOptions(type, data, decimalSeparator, decimalPlaces),\r\n      data: data,\r\n      plugins: [\r\n        {\r\n          beforeDraw: function (chart) {\r\n            const ctx = chart.chart.ctx;\r\n            ctx.fillStyle = backgroundColor;\r\n            ctx.fillRect(0, 0, chart.chart.width, chart.chart.height);\r\n          }\r\n        }\r\n      ]\r\n    });\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    const {\r\n      jsonStat,\r\n      type,\r\n      layout,\r\n      removeEmptyValues = getDefaultRemoveEmptyValues(type, layout),\r\n      labelFormat,\r\n      decimalSeparator,\r\n      decimalPlaces\r\n    } = this.props;\r\n\r\n    if (\r\n      prevProps.jsonStat !== jsonStat ||\r\n      prevProps.type !== type ||\r\n      !_.isEqual(prevProps.layout, layout) ||\r\n      prevProps.labelFormat !== labelFormat\r\n    ) {\r\n      const data = getData(type, jsonStat, layout, removeEmptyValues, labelFormat);\r\n      this.myChart.config.type = getChartType(type);\r\n      this.myChart.options = getOptions(type, data, decimalSeparator, decimalPlaces);\r\n      this.myChart.data = data;\r\n      this.myChart.update();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      t,\r\n      chartId = `cart__${uuidv4()}`,\r\n      type,\r\n      layout\r\n    } = this.props;\r\n\r\n    const hideChart = (type === \"pyramid\" && ((layout.secondaryDim || []).length !== 1 || (layout.secondaryDimValues || []).length !== 2));\r\n\r\n    return (\r\n      <Fragment>\r\n        {hideChart && (\r\n          <CustomEmpty text={t(\"components.chart.pyramid.invalidSecondaryDimension\")}/>\r\n        )}\r\n        <canvas\r\n          id={chartId}\r\n          ref={this.chartRef}\r\n          style={{\r\n            display: hideChart ? \"none\" : \"block\"\r\n          }}\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withTranslation()(Chart);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport DataViewerHeader from \"./Header\";\r\nimport DataViewerSideBar from \"./Sidebar\";\r\nimport DataViewerFooter from \"./Footer\";\r\nimport DatasetFilters from \"../dataset-filters\";\r\nimport JsonStatTable, {\r\n  JSONSTAT_TABLE_FONT_SIZE_LG,\r\n  JSONSTAT_TABLE_FONT_SIZE_MD,\r\n  JSONSTAT_TABLE_FONT_SIZE_SM\r\n} from \"../table\";\r\nimport Criteria from \"../criteria\";\r\nimport TableLayout from \"../table-layout\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FontSizeSelector, {\r\n  FONT_SIZE_SELECTOR_FONT_SIZE_MD,\r\n  FONT_SIZE_SELECTOR_FONT_SIZE_SM\r\n} from \"../font-size-selector\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport \"./style.css\"\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport TableChartIcon from \"@material-ui/icons/TableChart\";\r\nimport MapIcon from \"@material-ui/icons/Map\";\r\nimport BarChartIcon from \"@material-ui/icons/BarChart\";\r\nimport TimelineIcon from \"@material-ui/icons/Timeline\";\r\nimport HelpIcon from \"@material-ui/icons/Help\";\r\nimport DonutLargeIcon from \"@material-ui/icons/DonutLarge\";\r\nimport PieChartIcon from \"@material-ui/icons/PieChart\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  enableDatasetFetch,\r\n  fetchAccessibleDataset,\r\n  fetchDataset,\r\n  fetchDatasetGeometries,\r\n  hideDatasetCriteria,\r\n  hideDatasetCriteriaAlert,\r\n  hideDatasetCriteriaLengthWarning,\r\n  hideDatasetDownloadWarning,\r\n  hideDatasetUnavailableViewWarning,\r\n  setDatasetLabelFormat,\r\n  setDatasetViewer,\r\n  showDatasetCriteria,\r\n  submitDatasetChartLayout,\r\n  submitDatasetDownload,\r\n  submitDatasetMapLayout,\r\n  submitDatasetTableLayout,\r\n  submitDatasetViewTemplate\r\n} from \"../../state/dataset/datasetActions\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {\r\n  getChartDimensionValues,\r\n  getInitialFiltersValue,\r\n  getJsonStatTableSize,\r\n  getUpdatedLayout\r\n} from \"../../utils/jsonStat\";\r\nimport {numberFormatter} from \"../../utils/formatters\";\r\nimport Call from \"../../hocs/call\";\r\nimport _ from \"lodash\"\r\nimport ChartLayout from \"../chart-layout\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Map from \"../map/index\";\r\nimport LabelFormatSelector from \"../label-format-selector\";\r\nimport Chart from \"../chart\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\n\r\nconst SIDEBAR_WIDTH = 80;\r\nconst TABLE_ACTIONS_WIDTH = 336;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"absolute\",\r\n    width: \"100%\"\r\n  },\r\n  header: {\r\n    width: \"100%\"\r\n  },\r\n  page: {\r\n    width: \"100%\"\r\n  },\r\n  sidebar: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\",\r\n    width: SIDEBAR_WIDTH,\r\n    height: \"100%\",\r\n    overflow: \"auto\",\r\n    marginLeft: theme.spacing(2),\r\n    padding: \"0 8px\"\r\n  },\r\n  data: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\",\r\n    width: `calc(100% - ${SIDEBAR_WIDTH + theme.spacing(2) + theme.spacing(2) + theme.spacing(2)}px)`,\r\n    height: \"100%\",\r\n    marginLeft: theme.spacing(2),\r\n    marginRight: theme.spacing(2),\r\n    padding: theme.spacing(2)\r\n  },\r\n  viewerContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  action: {\r\n    height: 40,\r\n    \"& button\": {\r\n      padding: 8\r\n    }\r\n  },\r\n  filtersAndActions: {\r\n    width: \"100%\",\r\n    paddingBottom: theme.spacing(1)\r\n  },\r\n  filters: {\r\n    width: `calc(100% - ${TABLE_ACTIONS_WIDTH}px)`,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\"\r\n  },\r\n  actions: {\r\n    width: TABLE_ACTIONS_WIDTH,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\"\r\n  },\r\n  viewer: {\r\n    width: \"100%\",\r\n    position: \"relative\"\r\n  },\r\n  attributes: {\r\n    width: \"100%\",\r\n    paddingTop: 12\r\n  },\r\n  footer: {\r\n    bottom: 0,\r\n    left: 0,\r\n    width: \"100%\",\r\n    overflowX: \"auto\",\r\n    overflowY: \"hidden\",\r\n    padding: theme.spacing(1)\r\n  },\r\n  warningAlert: {\r\n    width: \"100%\",\r\n    marginBottom: 16\r\n  },\r\n  criteriaContent: {\r\n    overflow: \"hidden !important\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = ({dataset}) => ({\r\n  dataset: dataset.dataset,\r\n  accessibleDataset: dataset.accessibleDataset,\r\n  isFetchDatasetDisabled: dataset.isFetchDatasetDisabled,\r\n  isCriteriaVisible: dataset.isCriteriaVisible,\r\n  isCriteriaAlertVisible: dataset.isCriteriaAlertVisible,\r\n  hasViewLayout: dataset.hasViewLayout,\r\n  hasTemplateLayout: dataset.hasTemplateLayout,\r\n  hasAnnotationLayout: dataset.hasAnnotationLayout,\r\n  dimensions: dataset.dimensions,\r\n  mode: dataset.mode,\r\n  type: dataset.type,\r\n  codelistsLength: dataset.codelistsLength,\r\n  viewerIdx: dataset.viewerIdx,\r\n  tableLayout: dataset.tableLayout,\r\n  mapLayout: dataset.mapLayout,\r\n  chartLayout: dataset.chartLayout,\r\n  labelFormat: dataset.labelFormat,\r\n  criteria: dataset.criteria,\r\n  decimalSeparator: dataset.decimalSeparator,\r\n  decimalPlaces: dataset.decimalPlaces,\r\n  emptyChar: dataset.emptyChar,\r\n  enableCriteria: dataset.enableCriteria,\r\n  enableLayout: dataset.enableLayout,\r\n  maxAllowedCells: dataset.maxAllowedCells,\r\n  codes: dataset.codes,\r\n  isCodesFlat: dataset.isCodesFlat,\r\n  codelists: dataset.codelists,\r\n  areCodelistsFlat: dataset.areCodelistsFlat,\r\n  timePeriod: dataset.timePeriod,\r\n  geometries: dataset.geometries,\r\n  geometryDetailLevels: dataset.geometryDetailLevels,\r\n  isPartialData: dataset.isPartialData,\r\n  isEmptyData: dataset.isEmptyData,\r\n  isTooBigData: dataset.isTooBigData,\r\n  isDownloadWarningVisible: dataset.isDownloadWarningVisible,\r\n  isUnavailableViewWarningVisible: dataset.isUnavailableViewWarningVisible,\r\n  isCriteriaLengthWarningVisible: dataset.isCriteriaLengthWarningVisible,\r\n  timings: dataset.timings\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDataset: ({nodeId, datasetId, criteria, datasetTitle, checkCriteriaLength, tableLayout, chartLayout, mapLayout, maxAllowedCells, hasAnnotationLayout}) =>\r\n    dispatch(fetchDataset(nodeId, datasetId, criteria, datasetTitle, checkCriteriaLength, tableLayout, chartLayout, mapLayout, maxAllowedCells, hasAnnotationLayout)),\r\n  fetchAccessibleDataset: ({nodeId, datasetId, criteria, datasetTitle}) => dispatch(fetchAccessibleDataset(nodeId, datasetId, criteria, datasetTitle)),\r\n  onFetchDatasetEnable: () => dispatch(enableDatasetFetch()),\r\n  onCriteriaShow: () => dispatch(showDatasetCriteria()),\r\n  onCriteriaHide: () => dispatch(hideDatasetCriteria()),\r\n  onCriteriaAlertHide: () => dispatch(hideDatasetCriteriaAlert()),\r\n  onViewerSet: viewerIdx => dispatch(setDatasetViewer(viewerIdx)),\r\n  onTableLayoutSet: layout => dispatch(submitDatasetTableLayout(layout)),\r\n  onMapLayoutSet: layout => dispatch(submitDatasetMapLayout(layout)),\r\n  onChartLayoutSet: layout => dispatch(submitDatasetChartLayout(layout)),\r\n  onLabelFormatSet: labelFormat => dispatch(setDatasetLabelFormat(labelFormat)),\r\n  onDownloadSubmit: (nodeId, datasetId, datasetTitle, criteria, format, extension) =>\r\n    dispatch(submitDatasetDownload(nodeId, datasetId, datasetTitle, criteria, format, extension)),\r\n  onDownloadHide: () => dispatch(hideDatasetDownloadWarning()),\r\n  onViewTemplateSubmit: (nodeId, viewTemplate, isView) => dispatch(submitDatasetViewTemplate(nodeId, viewTemplate, isView)),\r\n  onUnavailableViewHide: () => dispatch(hideDatasetUnavailableViewWarning()),\r\n  onCriteriaLengthWarningHide: () => dispatch(hideDatasetCriteriaLengthWarning()),\r\n  onGeometryFetch: (idList, t) => dispatch(fetchDatasetGeometries(idList, t)),\r\n  addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  removeSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\nconst viewers = t => [\r\n  {\r\n    key: 0,\r\n    type: \"table\",\r\n    title: t ? t(\"scenes.dataViewers.viewers.table\") : \"\",\r\n    icon: <TableChartIcon/>\r\n  },\r\n  {\r\n    key: 1,\r\n    title: t ? t(\"scenes.dataViewers.viewers.map\") : \"\",\r\n    type: \"map\",\r\n    icon: <MapIcon/>\r\n  },\r\n  {\r\n    key: 2,\r\n    title: t ? t(\"scenes.dataViewers.viewers.verticalBar\") : \"\",\r\n    type: \"bar\",\r\n    icon: <BarChartIcon/>,\r\n    chartType: \"bar\"\r\n  },\r\n  {\r\n    key: 3,\r\n    title: t ? t(\"scenes.dataViewers.viewers.horizontalBar\") : \"\",\r\n    type: \"horizontalBar\",\r\n    icon: <BarChartIcon style={{transform: \"rotate(90deg)\"}}/>,\r\n    chartType: \"horizontalBar\"\r\n  },\r\n  {\r\n    key: 4,\r\n    title: t ? t(\"scenes.dataViewers.viewers.line\") : \"\",\r\n    type: \"line\",\r\n    icon: <TimelineIcon/>,\r\n    chartType: \"line\"\r\n  },\r\n  {\r\n    key: 5,\r\n    title: t ? t(\"scenes.dataViewers.viewers.area\") : \"\",\r\n    type: \"area\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"area\"\r\n  },\r\n  {\r\n    key: 6,\r\n    title: t ? t(\"scenes.dataViewers.viewers.doughnut\") : \"\",\r\n    type: \"doughnut\",\r\n    icon: <DonutLargeIcon/>,\r\n    chartType: \"doughnut\"\r\n  },\r\n  {\r\n    key: 7,\r\n    title: t ? t(\"scenes.dataViewers.viewers.pie\") : \"\",\r\n    type: \"pie\",\r\n    icon: <PieChartIcon/>,\r\n    chartType: \"pie\"\r\n  },\r\n  {\r\n    key: 8,\r\n    title: t ? t(\"scenes.dataViewers.viewers.radar\") : \"\",\r\n    type: \"radar\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"radar\"\r\n  },\r\n  {\r\n    key: 9,\r\n    title: t ? t(\"scenes.dataViewers.viewers.polarArea\") : \"\",\r\n    type: \"polarArea\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"polarArea\"\r\n  },\r\n  {\r\n    key: 10,\r\n    title: t ? t(\"scenes.dataViewers.viewers.pyramid\") : \"\",\r\n    type: \"pyramid\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"pyramid\"\r\n  }\r\n];\r\n\r\nexport const getViewerIdxFromType = viewerType => {\r\n  if (!viewerType) {\r\n    return 0\r\n  }\r\n\r\n  const viewer = viewers().find(({type}) => type === viewerType);\r\n  return viewer\r\n    ? viewer.key\r\n    : 0\r\n};\r\n\r\nexport const getViewerTypeFromIdx = viewerIdx => viewers()[viewerIdx].type;\r\n\r\nconst handleHeight = () => {\r\n  const titleHeight = document.getElementById(\"node-header\")\r\n    ? document.getElementById(\"node-header\").offsetHeight\r\n    : 0;\r\n  const headerHeight = document.getElementById(\"data-viewer__header\")\r\n    ? document.getElementById(\"data-viewer__header\").offsetHeight\r\n    : 0;\r\n  const footerHeight = document.getElementById(\"data-viewer__footer\")\r\n    ? document.getElementById(\"data-viewer__footer\").offsetHeight\r\n    : 0;\r\n  const filtersAndActionsHeight = document.getElementById(\"data-viewer__page__viewer__filters-and-actions\")\r\n    ? document.getElementById(\"data-viewer__page__viewer__filters-and-actions\").offsetHeight\r\n    : 0;\r\n\r\n  if (document.getElementById(\"data-viewer\")) {\r\n    document.getElementById(\"data-viewer\").setAttribute(\"style\", `height: calc(100% - ${titleHeight}px); top: ${titleHeight}px`);\r\n  }\r\n  if (document.getElementById(\"data-viewer__page\")) {\r\n    document.getElementById(\"data-viewer__page\").setAttribute(\"style\", `height: calc(100% - ${headerHeight + footerHeight}px)`);\r\n  }\r\n  if (document.getElementById(\"data-viewer__page__viewer__viewer\")) {\r\n    document.getElementById(\"data-viewer__page__viewer__viewer\").setAttribute(\"style\", `height: calc(100% - ${filtersAndActionsHeight}px)`);\r\n  }\r\n};\r\n\r\nfunction DataViewer(props) {\r\n  const {\r\n    classes,\r\n\r\n    nodeId,\r\n    nodeCode,\r\n    isAccessible,\r\n    datasetId,\r\n    datasetTitle,\r\n    viewId,\r\n    notes,\r\n    attachedFiles,\r\n    referenceMetadataUrl,\r\n    nodeExtras,\r\n    maxObservation,\r\n\r\n    dataset,\r\n    accessibleDataset,\r\n    isFetchDatasetDisabled,\r\n    isCriteriaVisible,\r\n    isCriteriaAlertVisible,\r\n    hasViewLayout,\r\n    hasTemplateLayout,\r\n    hasAnnotationLayout,\r\n    dimensions,\r\n    mode,\r\n    type,\r\n    codelistsLength,\r\n    viewerIdx,\r\n    tableLayout,\r\n    mapLayout,\r\n    chartLayout,\r\n    labelFormat,\r\n    criteria,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    enableCriteria,\r\n    enableLayout,\r\n    maxAllowedCells,\r\n    codes,\r\n    isCodesFlat,\r\n    codelists,\r\n    areCodelistsFlat,\r\n    timePeriod,\r\n    geometries,\r\n    geometryDetailLevels,\r\n    isPartialData,\r\n    isEmptyData,\r\n    isTooBigData,\r\n    isDownloadWarningVisible,\r\n    isUnavailableViewWarningVisible,\r\n    isCriteriaLengthWarningVisible,\r\n    timings,\r\n\r\n    fetchDataset,\r\n    fetchAccessibleDataset,\r\n    onFetchDatasetEnable,\r\n    onCriteriaShow,\r\n    onCriteriaHide,\r\n    onCriteriaAlertHide,\r\n    onViewerSet,\r\n    onTableLayoutSet,\r\n    onMapLayoutSet,\r\n    onChartLayoutSet,\r\n    onLabelFormatSet,\r\n    onDownloadSubmit,\r\n    onDownloadHide,\r\n    onViewTemplateSubmit,\r\n    onUnavailableViewHide,\r\n    onGeometryFetch,\r\n    onCriteriaLengthWarningHide,\r\n    addSpinner,\r\n    removeSpinner\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [tmpTableLayout, setTmpTableLayout] = useState(null);\r\n  const [tmpChartLayout, setTmpChartLayout] = useState(null);\r\n\r\n  const [tableLayoutSpinnerUuid] = useState(uuidv4());\r\n\r\n  const [chartId] = useState(\"chart__\" + uuidv4());\r\n\r\n  const [mapId] = useState(\"map__\" + uuidv4());\r\n\r\n  const [isLayoutVisible, setLayoutVisibility] = useState(false);\r\n  const [isCriteriaValid, setCriteriaValidity] = useState(true);\r\n\r\n  const [isFullscreen, setFullscreen] = useState(false);\r\n  const [fontSize, setFontSize] = useState(FONT_SIZE_SELECTOR_FONT_SIZE_MD);\r\n\r\n  const [worker] = useState(() => new Worker(\"./workers/getInitialFiltersValueWorker.js\"));\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (worker) {\r\n        worker.terminate();\r\n      }\r\n    }\r\n  }, [worker]);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", handleHeight);\r\n    return () => window.removeEventListener(\"resize\", handleHeight)\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    handleHeight();\r\n  }, [dataset, viewerIdx, tableLayout, mapLayout, chartLayout]);\r\n\r\n  useEffect(() => {\r\n    setTmpTableLayout(tableLayout);\r\n    setTmpChartLayout(chartLayout);\r\n  }, [tableLayout, chartLayout]);\r\n\r\n  const handleSetViewer = viewerIdx => {\r\n    onViewerSet(viewerIdx);\r\n  };\r\n\r\n  const handleSetData = dataIdx => {\r\n    // fetch new data\r\n  };\r\n\r\n  const handleLayoutOpen = () => {\r\n    setLayoutVisibility(true);\r\n  };\r\n\r\n  const handleLayoutClose = () => {\r\n    setLayoutVisibility(false);\r\n    setTmpTableLayout(tableLayout);\r\n    setTmpChartLayout(chartLayout);\r\n  };\r\n\r\n  const handleLayoutSubmit = () => {\r\n    setLayoutVisibility(false);\r\n\r\n    if (viewerIdx === 0) {\r\n      const newTableLayout = _.cloneDeep(tmpTableLayout);\r\n\r\n      addSpinner(tableLayoutSpinnerUuid, t(\"scenes.dataViewer.spinners.applyingLayout\"));\r\n\r\n      worker.onmessage = event => {\r\n        newTableLayout.filtersValue = event.data;\r\n        onTableLayoutSet(newTableLayout);\r\n        removeSpinner(tableLayoutSpinnerUuid);\r\n      }\r\n      worker.postMessage({\r\n        jsonStat: dataset,\r\n        layout: newTableLayout\r\n      });\r\n\r\n    } else if (viewerIdx >= 2) {\r\n      const newChartLayout = _.cloneDeep(tmpChartLayout);\r\n\r\n      newChartLayout.primaryDimValues = chartLayout.primaryDim[0] !== newChartLayout.primaryDim[0]\r\n        ? getChartDimensionValues(dataset, newChartLayout, true, 10)\r\n        : chartLayout.primaryDimValues;\r\n\r\n      newChartLayout.secondaryDimValues = chartLayout.secondaryDim[0] !== newChartLayout.secondaryDim[0]\r\n        ? getChartDimensionValues(dataset, newChartLayout, false, 10)\r\n        : chartLayout.secondaryDimValues;\r\n\r\n      newChartLayout.filtersValue = getInitialFiltersValue(dataset, newChartLayout);\r\n\r\n      onChartLayoutSet(newChartLayout);\r\n    }\r\n  };\r\n\r\n  const handleCriteriaOpen = () => {\r\n    onCriteriaShow();\r\n  }\r\n\r\n  const handleCriteriaClose = () => {\r\n    onCriteriaHide();\r\n    setCriteriaValidity(true);\r\n  }\r\n\r\n  const handleCriteriaSubmit = () => {\r\n    onFetchDatasetEnable();\r\n  }\r\n\r\n  const handleFilterSelect = (dimension, value) => {\r\n    if (viewerIdx === 0) {\r\n      onTableLayoutSet(getUpdatedLayout(dataset, tableLayout, dimension, value));\r\n    } else if (viewerIdx === 1) {\r\n      onMapLayoutSet(getUpdatedLayout(dataset, mapLayout, dimension, value));\r\n    } else if (viewerIdx >= 2) {\r\n      onChartLayoutSet(getUpdatedLayout(dataset, chartLayout, dimension, value));\r\n    }\r\n  };\r\n\r\n  const handleFontSizeSelect = size => {\r\n    setFontSize(size);\r\n  };\r\n\r\n  const handleFullscreen = () => {\r\n    !isFullscreen\r\n      ? document.getElementById(\"data-viewer__page__viewer\").classList.add(\"data-viewer__page__viewer--fullscreen\")\r\n      : document.getElementById(\"data-viewer__page__viewer\").classList.remove(\"data-viewer__page__viewer--fullscreen\");\r\n\r\n    setFullscreen(!isFullscreen);\r\n  };\r\n\r\n  return (\r\n    <div id=\"data-viewer\" className={classes.root}>\r\n      {isAccessible\r\n        ? (\r\n          <Call\r\n            cb={fetchAccessibleDataset}\r\n            cbParam={{nodeId, datasetId, criteria, datasetTitle}}\r\n            disabled={!nodeId || !datasetId || !criteria || !datasetTitle || isFetchDatasetDisabled}\r\n          >\r\n            <div style={{height: \"100%\", width: \"100%\", overflow: \"auto\", padding: 16}}>\r\n              <span>{accessibleDataset}</span>\r\n            </div>\r\n          </Call>\r\n        )\r\n        : (\r\n          <Fragment>\r\n            <Call\r\n              cb={fetchDataset}\r\n              cbParam={{\r\n                nodeId,\r\n                datasetId,\r\n                criteria,\r\n                datasetTitle,\r\n                checkCriteriaLength: true,\r\n                tableLayout,\r\n                chartLayout,\r\n                mapLayout,\r\n                maxAllowedCells,\r\n                hasAnnotationLayout\r\n              }}\r\n              disabled={!nodeId || !datasetId || !criteria || !datasetTitle || isFetchDatasetDisabled}\r\n            >\r\n              <div id=\"data-viewer__header\" className={classes.header}>\r\n                <DataViewerHeader\r\n                  nodeId={nodeId}\r\n                  nodeCode={nodeCode}\r\n                  nodeDownloadFormats={nodeExtras?.DownloadFormats}\r\n                  datasetId={datasetId}\r\n                  datasetTitle={datasetTitle}\r\n                  viewId={viewId}\r\n                  hasViewLayout={hasViewLayout}\r\n                  hasTemplateLayout={hasTemplateLayout}\r\n                  hasAnnotationLayout={hasAnnotationLayout}\r\n                  notes={notes}\r\n                  attachedFiles={attachedFiles}\r\n                  jsonStat={dataset}\r\n                  hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                  tableLayout={tableLayout}\r\n                  mapLayout={mapLayout}\r\n                  chartLayout={chartLayout}\r\n                  labelFormat={labelFormat}\r\n                  criteria={criteria}\r\n                  decimalSeparator={decimalSeparator}\r\n                  decimalPlaces={decimalPlaces}\r\n                  emptyChar={emptyChar}\r\n                  viewers={viewers(t)}\r\n                  viewerIdx={viewerIdx}\r\n                  onViewTemplateSubmit={(viewTemplate, isView) => onViewTemplateSubmit(nodeId, viewTemplate, isView)}\r\n                  onDownloadSubmit={(format, extension) => onDownloadSubmit(nodeId, datasetId, datasetTitle, criteria, format, extension)}\r\n                  timings={timings}\r\n                  chartId={chartId}\r\n                  mapId={mapId}\r\n                />\r\n              </div>\r\n              <div id=\"data-viewer__page\" className={classes.page}>\r\n                <Card className={classes.sidebar}>\r\n                  <DataViewerSideBar\r\n                    viewers={viewers(t)}\r\n                    selected={viewerIdx}\r\n                    isCriteriaDisabled={!enableCriteria}\r\n                    isLayoutDisabled={!enableLayout || !dataset || !(!!tableLayout || !!mapLayout || !!chartLayout)}\r\n                    isTableDisabled={!dataset || !tableLayout}\r\n                    isChartDisabled={!dataset || !chartLayout}\r\n                    isMapDisabled={!dataset || !mapLayout}\r\n                    referenceMetadataUrl={referenceMetadataUrl}\r\n                    onViewerSelect={handleSetViewer}\r\n                    onCriteriaOpen={handleCriteriaOpen}\r\n                    onLayoutOpen={handleLayoutOpen}\r\n                  />\r\n                </Card>\r\n                <Card className={classes.data}>\r\n                  <div id=\"data-viewer__page__viewer\" className={classes.viewerContainer}>\r\n                    <div id=\"data-viewer__page__viewer__filters-and-actions\" className={classes.filtersAndActions}>\r\n                      {dataset && (\r\n                        <Fragment>\r\n                          {dataset && isPartialData && tableLayout && chartLayout && mapLayout && (\r\n                            <Alert severity=\"warning\" className={classes.warningAlert}>\r\n                              {t(\"scenes.dataViewer.warnings.maxObservation.label\", {maxObservation: maxObservation ? numberFormatter(maxObservation) : \"\"})}\r\n                            </Alert>\r\n                          )}\r\n                          <div className={classes.filters}>\r\n                            <DatasetFilters\r\n                              key={uuidv4()}\r\n                              jsonStat={dataset}\r\n                              hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                              layout={viewerIdx === 0\r\n                                ? tableLayout\r\n                                : viewerIdx === 1\r\n                                  ? mapLayout\r\n                                  : chartLayout\r\n                              }\r\n                              labelFormat={labelFormat}\r\n                              onSelect={handleFilterSelect}\r\n                            />\r\n                          </div>\r\n                          <div className={classes.actions}>\r\n                            <Grid container>\r\n                              <Grid item className={classes.action}>\r\n                                <LabelFormatSelector\r\n                                  labelFormat={labelFormat}\r\n                                  setLabelFormat={labelFormat => onLabelFormatSet(labelFormat)}\r\n                                />\r\n                              </Grid>\r\n                              <Grid item className={classes.action}>\r\n                                <FontSizeSelector\r\n                                  fontSize={fontSize}\r\n                                  setFontSize={handleFontSizeSelect}\r\n                                />\r\n                              </Grid>\r\n                              <Grid item className={classes.action}>\r\n                                <Tooltip\r\n                                  title={isFullscreen\r\n                                    ? t(\"scenes.dataViewer.fullscreen.exit\")\r\n                                    : t(\"scenes.dataViewer.fullscreen.enter\")\r\n                                  }\r\n                                >\r\n                                  <IconButton onClick={handleFullscreen}>\r\n                                    {isFullscreen ? <FullscreenExitIcon/> : <FullscreenIcon/>}\r\n                                  </IconButton>\r\n                                </Tooltip>\r\n                              </Grid>\r\n                            </Grid>\r\n                          </div>\r\n                        </Fragment>\r\n                      )}\r\n                    </div>\r\n                    <div id=\"data-viewer__page__viewer__viewer\" className={classes.viewer}>\r\n                      {(() => {\r\n                        if (!dataset) {\r\n                          return isEmptyData\r\n                            ? <CustomEmpty text={t(\"scenes.dataViewer.errors.emptyData\")}/>\r\n                            : <CustomEmpty text={t(\"scenes.dataViewer.errors.applyCriteria\")}/>\r\n                        }\r\n                        if (viewerIdx === 0 && tableLayout) {\r\n                          return (getJsonStatTableSize(dataset) < maxAllowedCells)\r\n                            ? (\r\n                              <JsonStatTable\r\n                                jsonStat={dataset}\r\n                                layout={tableLayout}\r\n                                isFullscreen={isFullscreen}\r\n                                labelFormat={labelFormat}\r\n                                fontSize={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_SM\r\n                                  ? JSONSTAT_TABLE_FONT_SIZE_SM\r\n                                  : fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_MD\r\n                                    ? JSONSTAT_TABLE_FONT_SIZE_MD\r\n                                    : JSONSTAT_TABLE_FONT_SIZE_LG\r\n                                }\r\n                                decimalSeparator={decimalSeparator}\r\n                                decimalPlaces={decimalPlaces}\r\n                                emptyChar={emptyChar}\r\n                                hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                              />\r\n                            )\r\n                            : (\r\n                              <CustomEmpty\r\n                                text={t(\"scenes.dataViewer.errors.tooBigData\")}\r\n                              />\r\n                            )\r\n                        } else if (viewerIdx === 1 && mapLayout) {\r\n                          return (\r\n                            <Map\r\n                              mapId={mapId}\r\n                              jsonStat={dataset}\r\n                              mapLayout={mapLayout}\r\n                              onGeometryFetch={idList => onGeometryFetch(idList, t)}\r\n                              geometries={geometries}\r\n                              geometryDetailLevels={geometryDetailLevels}\r\n                              isFullscreen={isFullscreen}\r\n                            />\r\n                          )\r\n                        } else if (viewerIdx >= 2 && chartLayout) {\r\n                          return (\r\n                            <Chart\r\n                              chartId={chartId}\r\n                              type={viewers(t)[viewerIdx].chartType}\r\n                              jsonStat={dataset}\r\n                              layout={chartLayout}\r\n                              labelFormat={labelFormat}\r\n                              decimalSeparator={decimalSeparator}\r\n                              decimalPlaces={decimalPlaces}\r\n                            />\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              </div>\r\n              <div id=\"data-viewer__footer\" className={classes.footer}>\r\n                <DataViewerFooter\r\n                  labels={dataset ? [datasetTitle] : []}\r\n                  dataIdx={0}\r\n                  setData={handleSetData}\r\n                />\r\n              </div>\r\n            </Call>\r\n\r\n            <Dialog\r\n              open={isCriteriaVisible}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleCriteriaClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.criteria.title\")}\r\n              </DialogTitle>\r\n              <DialogContent className={classes.criteriaContent}>\r\n                {dimensions && isCriteriaVisible && (\r\n                  <Fragment>\r\n\r\n                    <Criteria\r\n                      nodeId={nodeId}\r\n                      datasetId={datasetId}\r\n                      dimensions={dimensions}\r\n                      mode={mode}\r\n                      type={type}\r\n                      codes={codes}\r\n                      isCodesFlat={isCodesFlat}\r\n                      codelists={codelists}\r\n                      areCodelistsFlat={areCodelistsFlat}\r\n                      codelistsLength={codelistsLength}\r\n                      criteria={criteria}\r\n                      timePeriod={timePeriod}\r\n                      isCriteriaValid={isCriteriaValid}\r\n                      setCriteriaValidity={setCriteriaValidity}\r\n                    />\r\n\r\n                    <Dialog\r\n                      open={isCriteriaAlertVisible}\r\n                      fullWidth\r\n                      maxWidth=\"sm\"\r\n                      onClose={onCriteriaAlertHide}\r\n                    >\r\n                      {(() => {\r\n                        if (isEmptyData) {\r\n                          return (\r\n                            <DialogTitle>\r\n                              {t(\"scenes.dataViewer.errors.emptyData\")}\r\n                            </DialogTitle>\r\n                          )\r\n\r\n                        } else if (isTooBigData) {\r\n                          const count = getJsonStatTableSize(dataset);\r\n\r\n                          return (\r\n                            <Fragment>\r\n                              <DialogTitle>\r\n                                {t(\"scenes.dataViewer.dialogs.tooBigData.title\")}\r\n                              </DialogTitle>\r\n                              <DialogContent>\r\n                                {count !== 0 && (\r\n                                  <div style={{width: \"100%\", textAlign: \"end\"}}>\r\n                                    {t(\"scenes.dataViewer.dialogs.tooBigData.content.requestCells\")}: <b>{numberFormatter(count)}</b>\r\n                                  </div>\r\n                                )}\r\n                                <div style={{width: \"100%\", textAlign: \"end\"}}>\r\n                                  {t(\"scenes.dataViewer.dialogs.tooBigData.content.maxCells\")}: <b>{numberFormatter(maxAllowedCells)}</b>\r\n                                </div>\r\n                                <div style={{width: \"100%\", textAlign: \"end\", marginTop: 16}}>\r\n                                  {t(\"scenes.dataViewer.dialogs.tooBigData.content.applyCriteria\")}\r\n                                </div>\r\n                              </DialogContent>\r\n                            </Fragment>\r\n                          )\r\n\r\n                        } else {\r\n                          return (\r\n                            <DialogTitle>\r\n                              {t(\"scenes.dataViewer.errors.genericError\")}\r\n                            </DialogTitle>\r\n                          )\r\n                        }\r\n                      })()}\r\n                      <DialogActions>\r\n                        <Button autoFocus onClick={onCriteriaAlertHide} color=\"primary\">\r\n                          {t(\"commons.confirm.confirm\")}\r\n                        </Button>\r\n                      </DialogActions>\r\n                    </Dialog>\r\n\r\n                  </Fragment>\r\n                )}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleCriteriaClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button\r\n                  autoFocus\r\n                  color=\"primary\"\r\n                  onClick={handleCriteriaSubmit}\r\n                  disabled={!isCriteriaValid}\r\n                >\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isLayoutVisible && viewerIdx === 0}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleLayoutClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.tableLayout.title\")}\r\n              </DialogTitle>\r\n              <DialogContent>\r\n                <TableLayout\r\n                  jsonStat={dataset}\r\n                  layout={tmpTableLayout}\r\n                  labelFormat={labelFormat}\r\n                  setLayout={setTmpTableLayout}\r\n                />\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleLayoutClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button autoFocus onClick={handleLayoutSubmit} color=\"primary\">\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isLayoutVisible && viewerIdx >= 2}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleLayoutClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.chartLayout.title\")}\r\n              </DialogTitle>\r\n              <DialogContent>\r\n                <ChartLayout\r\n                  jsonStat={dataset}\r\n                  layout={tmpChartLayout}\r\n                  setLayout={setTmpChartLayout}\r\n                />\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleLayoutClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button autoFocus onClick={handleLayoutSubmit} color=\"primary\">\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isDownloadWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onDownloadHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.downloadFormat.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onDownloadHide}>\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isUnavailableViewWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onUnavailableViewHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.unavailableView.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onUnavailableViewHide}>\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isCriteriaLengthWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onCriteriaLengthWarningHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.tooLongQuery.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onCriteriaLengthWarningHide}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button\r\n                  onClick={() => fetchDataset({\r\n                    nodeId,\r\n                    datasetId,\r\n                    criteria,\r\n                    datasetTitle,\r\n                    checkCriteriaLength: false,\r\n                    tableLayout,\r\n                    chartLayout,\r\n                    mapLayout,\r\n                    maxAllowedCells,\r\n                    hasAnnotationLayout\r\n                  })}\r\n                >\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n          </Fragment>\r\n        )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(DataViewer)","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  DASHBOARDS_DASHBOARD_FETCH,\r\n  DASHBOARDS_DASHBOARDS_CLEAR,\r\n  DASHBOARDS_DATASET_FETCH,\r\n  DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET,\r\n  DASHBOARDS_MAP_GEOMETRIES_FETCH\r\n} from \"./dashboardActions\";\r\nimport _ from \"lodash\"\r\nimport {DASHBOARD_ELEM_FILTER_DIMENSION_KEY, getViewIdxFromRowAndCol} from \"../../utils/dashboards\";\r\nimport {getCriteriaObjectFromArray} from \"../../utils/criteria\";\r\nimport {getNutsLevelTranslations} from \"../../constants/getNutsLevelTranslations\";\r\n\r\nexport const DASHBOARD_VIEW_STATE_APPLY_FILTERS = \"DASHBOARD_VIEW_STATE_APPLY_FILTERS\"\r\nexport const DASHBOARD_VIEW_STATE_ERROR = \"DASHBOARD_VIEW_STATE_ERROR\"\r\nexport const DASHBOARD_VIEW_STATE_FETCHING = \"DASHBOARD_VIEW_STATE_FETCHING\"\r\n\r\ntype DashboardState = {\r\n  dashboards: any | null,\r\n  isFetchDatasetDisabled: boolean,\r\n  jsonStats: any | null,\r\n  maps: any | null\r\n}\r\n\r\nconst initialState = {\r\n  dashboards: null,\r\n  isFetchDatasetDisabled: true,\r\n  jsonStats: null,\r\n  maps: null\r\n};\r\n\r\nconst dashboardReducer: Reducer<DashboardState> = (\r\n  state = initialState,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case DASHBOARDS_DASHBOARDS_CLEAR: {\r\n      return initialState\r\n    }\r\n    case DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET: {\r\n      return {\r\n        ...state,\r\n        isFetchDatasetDisabled: action.payload.disabled\r\n      }\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DATASET_FETCH: {\r\n\r\n          let currentDashboardJsonStats = {};\r\n          state.dashboards[action.payload.extra.dashboardId].dashboardConfig.forEach((row: any, rowIdx: number) => {\r\n            row.forEach((col: any, colIdx: number) => {\r\n              const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n\r\n              if (!col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY].length === 0) {\r\n                currentDashboardJsonStats = {\r\n                  ...currentDashboardJsonStats,\r\n                  [viewIdx]: (state.jsonStats?.[action.payload.extra.dashboardId]?.[viewIdx] || DASHBOARD_VIEW_STATE_FETCHING)\r\n                }\r\n              } else {\r\n                currentDashboardJsonStats = {\r\n                  ...currentDashboardJsonStats,\r\n                  [viewIdx]: DASHBOARD_VIEW_STATE_FETCHING\r\n                }\r\n              }\r\n            });\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            jsonStats: {\r\n              ...state.jsonStats,\r\n              [action.payload.extra.dashboardId]: currentDashboardJsonStats\r\n            }\r\n          }\r\n        }\r\n        case DASHBOARDS_MAP_GEOMETRIES_FETCH: {\r\n          return {\r\n            ...state,\r\n            maps: {\r\n              ...state.maps,\r\n              [action.payload.extra.dashboardId]: null\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DASHBOARD_FETCH: {\r\n          const views = action.payload.response.views;\r\n          for (let key in views) {\r\n            if (views.hasOwnProperty(key)) {\r\n              views[key] = {\r\n                ...views[key],\r\n                datasetId: views[key].datasetId ? views[key].datasetId.split(\"+\").join(\",\") : undefined,\r\n                criteria: getCriteriaObjectFromArray(views[key].criteria)\r\n              }\r\n            }\r\n          }\r\n\r\n          return {\r\n            ...state,\r\n            dashboards: {\r\n              ...state.dashboards,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...action.payload.response,\r\n                dashboardConfig: action.payload.response?.dashboardConfig\r\n                  ? JSON.parse(action.payload.response.dashboardConfig)\r\n                  : {},\r\n                filterLevels: action.payload.response?.filterLevels\r\n                  ? JSON.parse(action.payload.response.filterLevels)\r\n                  : {},\r\n                views: views\r\n              }\r\n            }\r\n          }\r\n        }\r\n        case DASHBOARDS_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.jsonStats);\r\n          const jsonStat = (action.payload.response?.id || []).length > 0\r\n            ? action.payload.response\r\n            : \"\";\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...jsonStats[action.payload.extra.dashboardId],\r\n                [id]: jsonStat\r\n              }\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            jsonStats: jsonStats\r\n          }\r\n        }\r\n        case DASHBOARDS_MAP_GEOMETRIES_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any) => val.nutsLevel)\r\n            .reduce((acc: any, level: any) => {\r\n              if (!acc[level]) {\r\n                // @ts-ignore\r\n                const label = getNutsLevelTranslations(action.payload.extra.t)[level];\r\n                acc[level] = {level: level, counter: 0, label: (label || `nutsLevel${level}`)};\r\n              }\r\n              acc[level].counter++;\r\n              return acc;\r\n            }, [])\r\n            .filter((val: any) => !!val);\r\n\r\n          return {\r\n            ...state,\r\n            maps: {\r\n              ...state.maps,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...state.maps[action.payload.extra.dashboardId],\r\n                [action.payload.extra.requestId]: {\r\n                  geometries: action.payload.response,\r\n                  geometryDetailLevels: detailLevels\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.jsonStats);\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...jsonStats[action.payload.extra.dashboardId],\r\n                [id]: DASHBOARD_VIEW_STATE_ERROR\r\n              }\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            jsonStats: jsonStats\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\nexport default dashboardReducer;","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getDashboardsUrl, getDatasetDownloadUrl, getDatasetUrl, getGeometryUrl} from \"../../serverApi/urls\";\r\nimport {getCriteriaArrayFromObject} from \"../../utils/criteria\";\r\nimport {DATASET_DOWNLOAD_SUBMIT} from \"../dataset/datasetActions\";\r\n\r\nexport const DASHBOARDS_DASHBOARD_FETCH = \"dashboards/dashboard/fetch\";\r\nexport const DASHBOARDS_DASHBOARDS_CLEAR = \"dashboards/dashboards/clear\";\r\nexport const DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET = \"dashboards/dataset/fetch/enableStatus/set\";\r\nexport const DASHBOARDS_DATASET_FETCH = \"dashboards/dataset/fetch\";\r\nexport const DASHBOARDS_MAP_GEOMETRIES_FETCH = \"dashboards/map/geometries/fetch\";\r\n\r\nexport const fetchDashboardsDashboard = (dashboardId: number) => initRequest(\r\n  DASHBOARDS_DASHBOARD_FETCH,\r\n  getDashboardsUrl(dashboardId),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDashboard\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId\r\n  }\r\n);\r\n\r\nexport const clearDashboardsDashboards = () => ({\r\n  type: DASHBOARDS_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const setDashboardsDatasetFetchEnableStatus = (enabled: boolean) => ({\r\n  type: DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET,\r\n  payload: {\r\n    disabled: !enabled\r\n  }\r\n});\r\n\r\nexport const fetchDashboardsDataset = (dashboardId: number, nodeId: number, datasetId: string, criteria: any, requestIds: string[]) => initRequest(\r\n  DASHBOARDS_DATASET_FETCH,\r\n  getDatasetUrl(nodeId, datasetId),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDataset\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId,\r\n    requestIds: requestIds\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const fetchDashboardsMapGeometries = (dashboardId: number, idList: string[], requestId: string, t: any) => initRequest(\r\n  DASHBOARDS_MAP_GEOMETRIES_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dashboard.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    dashboardId: dashboardId,\r\n    requestId: requestId,\r\n    t: t\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const downloadViewCsv = (nodeId: number, datasetId: string, viewTitle: string, criteria: any) => initRequest(\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  getDatasetDownloadUrl(nodeId, datasetId, \"csv\"),\r\n  RequestMethod.POST,\r\n  getCriteriaArrayFromObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.downloadingDataset\")\r\n  }),\r\n  {\r\n    fileSave: {\r\n      name: `${viewTitle}.csv`,\r\n      type: \"text/plain;charset=utf-8\"\r\n    }\r\n  },\r\n  \"\",\r\n  (statusCode: number) => statusCode === 406\r\n);","import React, {Fragment, useEffect, useState} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {\r\n  DASHBOARD_ELEM_ENABLE_FILTERS_KEY,\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_SHOW_TITLE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_TEXT,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../utils/dashboards\";\r\nimport JsonStatTable from \"../table\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport _ from \"lodash\";\r\nimport {getViewerIdxFromType} from \"../data-viewer\";\r\nimport DatasetFilters from \"../dataset-filters\";\r\nimport Map from \"../map\";\r\nimport {\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat,\r\n  getFilteredLayoutObject,\r\n  getUpdatedLayout\r\n} from \"../../utils/jsonStat\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  DASHBOARD_VIEW_STATE_APPLY_FILTERS,\r\n  DASHBOARD_VIEW_STATE_ERROR,\r\n  DASHBOARD_VIEW_STATE_FETCHING\r\n} from \"../../state/dashboard/dashboardReducer\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport \"./style.css\"\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Chart from \"../chart\";\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport {exportChartJpeg} from \"../../utils/download\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\n\r\nconst styles = theme => ({\r\n  row: {\r\n    width: \"100%\",\r\n    marginBottom: 8\r\n  },\r\n  col: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\"\r\n  },\r\n  viewContainer: {\r\n    padding: 12,\r\n    height: 640,\r\n    width: \"100%\",\r\n    overflow: \"auto\"\r\n  },\r\n  viewCard: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    padding: 24\r\n  },\r\n  viewPlaceholder: {\r\n    height: \"100%\"\r\n  },\r\n  viewControllers: {\r\n    paddingBottom: 16\r\n  },\r\n  viewTitle: {\r\n    fontSize: 18,\r\n    marginBottom: 8\r\n  },\r\n  viewStaticFilters: {\r\n    marginBottom: 8\r\n  },\r\n  viewStaticFilter: {\r\n    display: \"inline-block\",\r\n    marginRight: 8\r\n  },\r\n  viewActiveFilters: {},\r\n  view: {\r\n    width: \"100%\",\r\n    position: \"relative\"\r\n  }\r\n});\r\n\r\nconst handleHeight = (uuid, viewIdx) => {\r\n  const controllersHeight = document.getElementById(`dashboard__view-container__${uuid}__controllers__${viewIdx}`)?.offsetHeight || 0;\r\n  const view = document.getElementById(`dashboard__view-container__${uuid}__view__${viewIdx}`);\r\n  if (view) {\r\n    view.setAttribute(\"style\", `height: calc(100% - ${controllersHeight}px)`);\r\n  }\r\n};\r\n\r\nfunction DashboardCol(props) {\r\n\r\n  const {\r\n    t,\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    dashboard,\r\n    filterValue,\r\n    rowIdx,\r\n    colIdx,\r\n    col,\r\n    jsonStats,\r\n    viewLayouts,\r\n    onSelect,\r\n    maps,\r\n    fetchMapGeometries,\r\n    downloadCsv\r\n  } = props;\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [isFullscreen, setFullscreen] = useState(false);\r\n\r\n  const [chartId] = useState(\"chart__\" + uuidv4());\r\n  const [mapId] = useState(\"map__\" + uuidv4());\r\n\r\n  useEffect(() => {\r\n    const func = () => handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n\r\n    window.addEventListener(\"resize\", func);\r\n    return () => window.removeEventListener(\"resize\", func)\r\n  }, [uuid, rowIdx, colIdx]);\r\n\r\n  useEffect(() => {\r\n    handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n  }, [uuid, rowIdx, colIdx, col, jsonStats, viewLayouts]);\r\n\r\n  const handleFullscreen = () => {\r\n    !isFullscreen\r\n      ? document.getElementById(`dashboard__view-container__${uuid}__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`).classList.add(\"dashboard__view-container--fullscreen\")\r\n      : document.getElementById(`dashboard__view-container__${uuid}__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`).classList.remove(\"dashboard__view-container--fullscreen\");\r\n    handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n\r\n    setFullscreen(!isFullscreen);\r\n  };\r\n\r\n  const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n  const jsonStat = jsonStats ? jsonStats[viewIdx] : null;\r\n  let layout = viewLayouts ? _.cloneDeep(viewLayouts[viewIdx]) : null;\r\n\r\n  const view = _.cloneDeep((dashboard.views || {})[col.value]);\r\n  const viewerIdx = view ? getViewerIdxFromType(view.defaultView) : null;\r\n\r\n  return (\r\n    <div className={classes.col} style={{width: `${col.widthPercentage}%`}}>\r\n      <div className={classes.viewContainer}>\r\n        <Card\r\n          id={`dashboard__view-container__${uuid}__${viewIdx}`}\r\n          className={classes.viewCard}\r\n        >\r\n          {(col.type === DASHBOARD_ELEM_TYPE_VALUE_VIEW && jsonStat && layout) && (\r\n            <div style={{float: \"right\"}}>\r\n              <Tooltip title={t(\"components.dashboard.actions.download\")}>\r\n                <IconButton\r\n                  color=\"primary\"\r\n                  onClick={() => {\r\n                    if (viewerIdx === 0) {\r\n                      downloadCsv(view.nodeId, view.datasetId, localizeI18nObj(view.title, defaultLanguage, languages), view.criteria);\r\n                    } else if (viewerIdx === 1) {\r\n                      window.LMap.exportPng(mapId, `${localizeI18nObj(view.title, defaultLanguage, languages)}.png`)\r\n                    } else {\r\n                      exportChartJpeg(chartId, `${localizeI18nObj(view.title, defaultLanguage, languages)}.jpeg`);\r\n                    }\r\n                  }}\r\n                >\r\n                  <GetAppIcon/>\r\n                </IconButton>\r\n              </Tooltip>\r\n            </div>\r\n          )}\r\n          {(col.type === DASHBOARD_ELEM_TYPE_VALUE_TEXT || (jsonStat && layout)) && (\r\n            <div style={{float: \"right\"}}>\r\n              <Tooltip\r\n                title={isFullscreen\r\n                  ? t(\"components.dashboard.actions.fullscreen.exit\")\r\n                  : t(\"components.dashboard.actions.fullscreen.enter\")\r\n                }\r\n              >\r\n                <IconButton\r\n                  color=\"primary\"\r\n                  onClick={handleFullscreen}\r\n                >\r\n                  {isFullscreen ? <FullscreenExitIcon/> : <FullscreenIcon/>}\r\n                </IconButton>\r\n              </Tooltip>\r\n            </div>\r\n          )}\r\n          {(() => {\r\n            if (col.type === DASHBOARD_ELEM_TYPE_VALUE_TEXT) {\r\n              return (\r\n                <SanitizedHTML html={localizeI18nObj(col.value, defaultLanguage, languages)}/>\r\n              )\r\n\r\n            } else if (jsonStats && viewLayouts) {\r\n\r\n              if (jsonStat === DASHBOARD_VIEW_STATE_ERROR) {\r\n                return (\r\n                  <div className={classes.viewPlaceholder}>\r\n                    <CustomEmpty\r\n                      text={t(\"components.dashboard.fetchingDatasetError\")}\r\n                    />\r\n                  </div>\r\n                )\r\n\r\n              } else if (jsonStat === DASHBOARD_VIEW_STATE_APPLY_FILTERS) {\r\n                return (\r\n                  <div className={classes.viewPlaceholder}>\r\n                    <CustomEmpty\r\n                      text={t(\"components.dashboard.applyFilters\")}\r\n                    />\r\n                  </div>\r\n                )\r\n\r\n              } else if (jsonStat === DASHBOARD_VIEW_STATE_FETCHING) {\r\n                return (\r\n                  <div className={classes.viewPlaceholder}>\r\n                    <CustomEmpty\r\n                      text={t(\"components.dashboard.fetching\") + \"...\"}\r\n                      image={<CircularProgress/>}\r\n                    />\r\n                  </div>\r\n                )\r\n\r\n              } else if (jsonStat === \"\") {\r\n                return (\r\n                  <div className={classes.viewPlaceholder}>\r\n                    <CustomEmpty\r\n                      text={t(\"components.dashboard.emptyView\")}\r\n                    />\r\n                  </div>\r\n                )\r\n\r\n              } else if (jsonStat && layout) {\r\n\r\n                const filter = col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY];\r\n                if (filter && filterValue) {\r\n                  if ((layout.filters || []).includes(filter)) {\r\n                    layout.filtersValue = {\r\n                      ...layout.filtersValue,\r\n                      [filter]: filterValue\r\n                    };\r\n                  } else if ((layout.primaryDim || []).includes(filter)) {\r\n                    layout.primaryDimValues = {\r\n                      ...layout.primaryDimValues,\r\n                      [filter]: filterValue\r\n                    };\r\n                  } else if ((layout.secondaryDim || []).includes(filter)) {\r\n                    layout.secondaryDimValues = {\r\n                      ...layout.secondaryDimValues,\r\n                      [filter]: filterValue\r\n                    };\r\n                  }\r\n                }\r\n\r\n                const staticFilters = [];\r\n                layout.filters.forEach(dim => {\r\n                  if (jsonStat.size[jsonStat.id.indexOf(dim)] === 1) {\r\n                    staticFilters.push({\r\n                      dim: dim,\r\n                      dimLabel: getDimensionLabelFromJsonStat(jsonStat, dim),\r\n                      value: jsonStat.dimension[dim].category.index[0],\r\n                      valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, dim, jsonStat.dimension[dim].category.index[0])\r\n                    })\r\n                  }\r\n                });\r\n                if (!col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY]) {\r\n                  layout.filters.forEach(dim => {\r\n                    if (jsonStat.size[jsonStat.id.indexOf(dim)] !== 1) {\r\n                      staticFilters.push({\r\n                        dim: dim,\r\n                        dimLabel: getDimensionLabelFromJsonStat(jsonStat, dim),\r\n                        value: layout.filtersValue[dim],\r\n                        valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, dim, layout.filtersValue[dim])\r\n                      })\r\n                    }\r\n                  });\r\n                }\r\n\r\n                return (\r\n                  <Fragment>\r\n                    <div\r\n                      id={`dashboard__view-container__${uuid}__controllers__${viewIdx}`}\r\n                      className={classes.viewControllers}\r\n                    >\r\n                      {col[DASHBOARD_ELEM_SHOW_TITLE_KEY] && (\r\n                        <div className={classes.viewTitle}>\r\n                          {localizeI18nObj(view.title, defaultLanguage, languages)}\r\n                        </div>\r\n                      )}\r\n                      <div className={classes.viewStaticFilters}>\r\n                        {staticFilters.map(({dim, dimLabel, value, valueLabel}, idx) =>\r\n                          <div key={idx} className={classes.viewStaticFilter}>\r\n                            <b>{(dimLabel || dim)}</b>: <i>{(valueLabel || value)}</i>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      {col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY] && (\r\n                        <div className={classes.viewActiveFilters}>\r\n                          <DatasetFilters\r\n                            jsonStat={jsonStat}\r\n                            layout={layout}\r\n                            onSelect={(dimension, value) => onSelect(viewIdx, dimension, value)}\r\n                          />\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div\r\n                      id={`dashboard__view-container__${uuid}__view__${viewIdx}`}\r\n                      className={classes.view}\r\n                    >\r\n                      {(() => {\r\n                        if (viewerIdx === 0) {\r\n                          return (\r\n                            <JsonStatTable\r\n                              jsonStat={jsonStat}\r\n                              layout={layout}\r\n                              isFullscreen={isFullscreen}\r\n                              labelFormat={view.layouts.labelFormat}\r\n                              decimalSeparator={\",\"} // TODO\r\n                              decimalPlaces={view.decimalNumber} // TODO\r\n                              emptyChar={\"\"} // TODO\r\n                              hideSpinner\r\n                            />\r\n                          )\r\n                        } else if (viewerIdx === 1) {\r\n                          return (\r\n                            <Map\r\n                              mapId={mapId}\r\n                              jsonStat={jsonStat}\r\n                              mapLayout={layout}\r\n                              onGeometryFetch={idList => fetchMapGeometries(idList, viewIdx)}\r\n                              geometries={maps?.[viewIdx]?.geometries || null}\r\n                              geometryDetailLevels={maps?.[viewIdx]?.geometryDetailLevels || null}\r\n                              hideSpinner\r\n                            />\r\n                          )\r\n                        } else {\r\n                          return (\r\n                            <Chart\r\n                              chartId={chartId}\r\n                              type={view.defaultView}\r\n                              jsonStat={jsonStat}\r\n                              layout={layout}\r\n                              labelFormat={view.layouts.labelFormat}\r\n                              decimalSeparator={\",\"} // TODO\r\n                              decimalPlaces={view.decimalNumber} // TODO\r\n                            />\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </div>\r\n                  </Fragment>\r\n                )\r\n              } else {\r\n                return <span/>\r\n              }\r\n            } else {\r\n              return <span/>\r\n            }\r\n          })()}\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst DashboardRow = ({\r\n                        t,\r\n                        classes,\r\n                        defaultLanguage,\r\n                        languages,\r\n                        dashboard,\r\n                        filterValue,\r\n                        row,\r\n                        rowIdx,\r\n                        jsonStats,\r\n                        viewLayouts,\r\n                        onSelect,\r\n                        maps,\r\n                        fetchMapGeometries,\r\n                        downloadCsv\r\n                      }) =>\r\n  <div className={classes.row}>\r\n    {row.map((col, idx) =>\r\n      <DashboardCol\r\n        key={idx}\r\n        t={t}\r\n        classes={classes}\r\n        defaultLanguage={defaultLanguage}\r\n        languages={languages}\r\n        dashboard={dashboard}\r\n        filterValue={filterValue}\r\n        rowIdx={rowIdx}\r\n        colIdx={idx}\r\n        col={col}\r\n        jsonStats={jsonStats}\r\n        viewLayouts={viewLayouts}\r\n        onSelect={onSelect}\r\n        maps={maps}\r\n        fetchMapGeometries={fetchMapGeometries}\r\n        downloadCsv={downloadCsv}\r\n      />\r\n    )}\r\n  </div>;\r\n\r\nfunction Dashboard(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    dashboard,\r\n    filterValue,\r\n    jsonStats,\r\n    maps,\r\n    fetchMapGeometries,\r\n    downloadCsv\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [viewLayouts, setViewLayouts] = useState(null);\r\n\r\n  useEffect(() => {\r\n    dashboard.dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col.type === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n          setViewLayouts(prevViewLayouts => {\r\n            const newViewLayouts = prevViewLayouts\r\n              ? _.cloneDeep(prevViewLayouts)\r\n              : {};\r\n\r\n            const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n            if (!jsonStats?.[viewIdx]?.id) {\r\n              return newViewLayouts;\r\n            }\r\n\r\n            const layouts = JSON.parse(dashboard.views[col.value].layouts);\r\n            let layout = (layouts.tableLayout || layouts.mapLayout || layouts.chartLayout);\r\n            layout = getFilteredLayoutObject(jsonStats[viewIdx], layout);\r\n\r\n            newViewLayouts[viewIdx] = layout;\r\n            return newViewLayouts;\r\n          });\r\n        }\r\n      })\r\n    })\r\n  }, [dashboard, jsonStats]);\r\n\r\n  const handleFilterSelect = (viewIdx, dimension, value) => {\r\n    setViewLayouts(prevViewLayouts => ({\r\n      ...prevViewLayouts,\r\n      [viewIdx]: getUpdatedLayout(jsonStats[viewIdx], prevViewLayouts[viewIdx], dimension, value)\r\n    }));\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      {(dashboard.dashboardConfig || []).map((row, idx) =>\r\n        <DashboardRow\r\n          key={idx}\r\n          t={t}\r\n          classes={classes}\r\n          defaultLanguage={defaultLanguage}\r\n          languages={languages}\r\n          dashboard={dashboard}\r\n          filterValue={filterValue}\r\n          row={row}\r\n          rowIdx={idx}\r\n          jsonStats={jsonStats}\r\n          viewLayouts={viewLayouts}\r\n          onSelect={handleFilterSelect}\r\n          maps={maps}\r\n          fetchMapGeometries={fetchMapGeometries}\r\n          downloadCsv={downloadCsv}\r\n        />\r\n      )}\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(Dashboard);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport {\r\n  changeOtherConfigDashboard,\r\n  clearOtherConfigDashboards,\r\n  clearOtherConfigDashboardsDataset,\r\n  clearOtherConfigDashboardViews,\r\n  closeOtherConfigDashboard,\r\n  createOtherConfigDashboard,\r\n  deleteOtherConfigDashboard,\r\n  fetchOtherConfigDashboards,\r\n  fetchOtherConfigDashboardsDataset,\r\n  fetchOtherConfigDashboardsMapGeometries,\r\n  fetchOtherConfigDashboardViews,\r\n  hideOtherConfigDashboard,\r\n  submitOtherConfigDashboardCreate,\r\n  submitOtherConfigDashboardUpdate,\r\n  updateOtherConfigDashboard\r\n} from \"../../../state/otherConfig/otherConfigActions\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {goToDashboard} from \"../../../links\";\r\nimport DashboardBuilder from \"../../dashboard-builder\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj, validateI18nObj} from \"../../../utils/i18n\";\r\nimport Call from \"../../../hocs/call\";\r\nimport Dashboard from \"../../dashboard\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../../utils/dashboards\";\r\nimport _ from \"lodash\"\r\nimport {MTableToolbar} from \"material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  needDashboards: state.otherConfig.needDashboards,\r\n  dashboards: state.otherConfig.dashboards,\r\n  dashboard: state.otherConfig.dashboard,\r\n  dashboardViews: state.otherConfig.dashboardViews,\r\n  dashboardJsonStats: state.otherConfig.dashboardJsonStats,\r\n  dashboardMaps: state.otherConfig.dashboardMaps\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboards: () => dispatch(fetchOtherConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearOtherConfigDashboards()),\r\n  createDashboard: dashboard => dispatch(createOtherConfigDashboard(dashboard)),\r\n  updateDashboard: dashboardId => dispatch(updateOtherConfigDashboard(dashboardId)),\r\n  changeDashboard: dashboard => dispatch(changeOtherConfigDashboard(dashboard)),\r\n  submitDashboardCreate: dashboard => dispatch(submitOtherConfigDashboardCreate(dashboard)),\r\n  submitDashboardUpdate: (dashboardId, dashboard) => dispatch(submitOtherConfigDashboardUpdate(dashboardId, dashboard)),\r\n  deleteDashboard: dashboardId => dispatch(deleteOtherConfigDashboard(dashboardId)),\r\n  hideDashboard: () => dispatch(hideOtherConfigDashboard()),\r\n  fetchViews: () => dispatch(fetchOtherConfigDashboardViews()),\r\n  clearViews: () => dispatch(clearOtherConfigDashboardViews()),\r\n  onClose: () => dispatch(closeOtherConfigDashboard()),\r\n  fetchDataset: (nodeId, datasetId, criteria, requestIds) => dispatch(fetchOtherConfigDashboardsDataset(nodeId, datasetId, criteria, requestIds)),\r\n  fetchMapGeometries: (idList, requestId) => dispatch(fetchOtherConfigDashboardsMapGeometries(idList, requestId)),\r\n  clearDatasets: () => dispatch(clearOtherConfigDashboardsDataset()),\r\n});\r\n\r\nconst getStaticDashboard = dashboard => {\r\n  if (!dashboard) {\r\n    return null\r\n  }\r\n\r\n  const staticDashboard = _.cloneDeep(dashboard);\r\n  staticDashboard.dashboardConfig.forEach(row => {\r\n    row.forEach(col => {\r\n      col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] = null\r\n    });\r\n  });\r\n\r\n  return staticDashboard\r\n};\r\n\r\nconst initialDashboard = {\r\n  title: {},\r\n  dashboardConfig: [],\r\n  viewIds: [],\r\n  views: {},\r\n  filterLevels: {}\r\n};\r\n\r\nconst UserDashboardsSettingsForm = ({\r\n                                      classes,\r\n                                      defaultLanguage,\r\n                                      languages,\r\n                                      nodes,\r\n                                      needDashboards,\r\n                                      dashboards,\r\n                                      dashboard,\r\n                                      fetchDashboards,\r\n                                      clearDashboards,\r\n                                      createDashboard,\r\n                                      updateDashboard,\r\n                                      changeDashboard,\r\n                                      submitDashboardCreate,\r\n                                      submitDashboardUpdate,\r\n                                      deleteDashboard,\r\n                                      hideDashboard,\r\n                                      dashboardViews,\r\n                                      fetchViews,\r\n                                      clearViews,\r\n                                      onClose,\r\n                                      dashboardJsonStats,\r\n                                      dashboardMaps,\r\n                                      fetchDataset,\r\n                                      fetchMapGeometries,\r\n                                      clearDatasets,\r\n                                      onDashboardsClose\r\n                                    }, ref) => {\r\n\r\n  const [deleteDashboardId, setDeleteDashboardId] = useState(null);\r\n  const [updateDashboardId, setUpdateDashboardId] = useState(null);\r\n\r\n  const [isPreviewVisible, setPreviewVisibility] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    fetchDashboards();\r\n  }, [fetchDashboards]);\r\n\r\n  useEffect(() => {\r\n    if (needDashboards) {\r\n      fetchDashboards();\r\n    }\r\n  }, [dashboards, needDashboards, fetchDashboards]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearDashboards();\r\n      onClose();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const handleFetchDatasets = () => {\r\n\r\n    const requests = [];\r\n    dashboard.dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n\r\n          const view = dashboard.views[col[DASHBOARD_ELEM_VALUE_KEY]];\r\n\r\n          let newCriteria = view.criteria;\r\n\r\n          const request = requests.find(({nodeId, datasetId, criteria}) => {\r\n            return (\r\n              nodeId === view.nodeId &&\r\n              datasetId === view.datasetId &&\r\n              _.isEqual(criteria, newCriteria)\r\n            )\r\n          });\r\n\r\n          if (request === undefined) {\r\n            requests.push({\r\n              nodeId: view.nodeId,\r\n              datasetId: view.datasetId.split(\"+\").join(\",\"),\r\n              criteria: newCriteria,\r\n              requestIds: [getViewIdxFromRowAndCol(rowIdx, colIdx)]\r\n            });\r\n          } else {\r\n            request.requestIds.push(getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n          }\r\n        }\r\n      });\r\n    });\r\n    requests.forEach(({nodeId, datasetId, criteria, requestIds}) => fetchDataset(nodeId, datasetId, criteria, requestIds));\r\n  };\r\n\r\n  return dashboards && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n          Toolbar: props =>\r\n            <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n              <Grid item>\r\n                <MTableToolbar {...props} />\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  size=\"small\"\r\n                  startIcon={<AddIcon/>}\r\n                  onClick={() => createDashboard(initialDashboard)}\r\n                >\r\n                  {t(\"scenes.dashboardsSettings.createDashboard\")}\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.dashboardsSettings.table.columns.dashboardTitle\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          }\r\n        ]}\r\n        data={dashboards}\r\n        actions={[\r\n          {\r\n            icon: VisibilityIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.viewDashboard\"),\r\n            onClick: (_, {dashboardId}) => window.location.href.toLowerCase().includes(`/dashboards/${dashboardId}`)\r\n              ? onDashboardsClose()\r\n              : goToDashboard(dashboardId)\r\n          },\r\n          {\r\n            icon: EditIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.editDashboard\"),\r\n            onClick: (_, {dashboardId}) => {\r\n              updateDashboard(dashboardId);\r\n              setUpdateDashboardId(dashboardId);\r\n            }\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.deleteDashboard\"),\r\n            onClick: (_, {dashboardId}) => setDeleteDashboardId(dashboardId)\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 1,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteDashboardId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.dashboardsSettings.modals.deleteDashboard.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.dashboardsSettings.modals.deleteDashboard.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            autoFocus\r\n            onClick={() => setDeleteDashboardId(null)}\r\n          >\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button\r\n            onClick={() => {\r\n              deleteDashboard(deleteDashboardId);\r\n              setDeleteDashboardId(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={dashboard !== null}\r\n        fullScreen\r\n        onClose={hideDashboard}\r\n      >\r\n        <DialogTitle>\r\n          {updateDashboardId\r\n            ? t(\"scenes.dashboardsSettings.modals.updateDashboard.title\")\r\n            : t(\"scenes.dashboardsSettings.modals.createDashboard.title\")\r\n          }\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <DashboardBuilder\r\n            nodes={nodes}\r\n            dashboard={dashboard}\r\n            onChange={changeDashboard}\r\n            views={dashboardViews}\r\n            fetchViews={fetchViews}\r\n            onViewsHide={clearViews}\r\n            jsonStats={dashboardJsonStats}\r\n            fetchDataset={fetchDataset}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              hideDashboard();\r\n              setUpdateDashboardId(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n          <Button\r\n            onClick={() => setPreviewVisibility(true)}\r\n          >\r\n            {t(\"commons.confirm.preview\")}\r\n          </Button>\r\n          <Button\r\n            onClick={updateDashboardId\r\n              ? () => submitDashboardUpdate(updateDashboardId, dashboard)\r\n              : () => {\r\n                submitDashboardCreate(dashboard);\r\n                hideDashboard();\r\n              }\r\n            }\r\n            disabled={dashboard && !validateI18nObj(dashboard.title)}\r\n          >\r\n            {t(\"commons.confirm.save\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isPreviewVisible}\r\n        fullScreen\r\n        onClose={() => setPreviewVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.preview.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Call cb={handleFetchDatasets}>\r\n            <Dashboard\r\n              dashboard={getStaticDashboard(dashboard)}\r\n              jsonStats={dashboardJsonStats}\r\n              maps={dashboardMaps}\r\n              fetchMapGeometries={(idList, requestId) => fetchMapGeometries(idList, requestId)}\r\n            />\r\n          </Call>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              setPreviewVisibility(false);\r\n              clearDatasets();\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserDashboardsSettingsForm);","import React, {Fragment} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport ViewsSettingsForm from \"./views-settings-form\";\r\nimport WorkIcon from '@material-ui/icons/Work';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {canDisplayUserViews, canManagePersonalDashboards} from \"../../utils/user\";\r\nimport UserDashboardsSettingsForm from \"./user-dashboards-settings-form\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  option: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nclass OtherSettingsSelect extends React.Component {\r\n\r\n  state = {\r\n    isViewsOpen: false,\r\n    isDashboardsOpen: false,\r\n    viewsSettigsRef: React.createRef(),\r\n    dashboardsSettingsRef: React.createRef()\r\n  };\r\n\r\n  onViewsOpen = () => this.setState({\r\n    ...this.state,\r\n    isViewsOpen: true\r\n  });\r\n\r\n  onViewsClose = () => this.setState({\r\n    ...this.state,\r\n    isViewsOpen: false\r\n  });\r\n\r\n  onDashboardsOpen = () => this.setState({\r\n    ...this.state,\r\n    isDashboardsOpen: true\r\n  });\r\n\r\n  onDashboardsClose = () => this.setState({\r\n    ...this.state,\r\n    isDashboardsOpen: false\r\n  });\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      nodes,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {\r\n      isViewsOpen,\r\n      isDashboardsOpen,\r\n      viewsSettigsRef,\r\n      dashboardsSettingsRef\r\n    } = this.state;\r\n\r\n    return (\r\n      <Fragment>\r\n        <ButtonSelect value=\"\" icon={<WorkIcon/>}>\r\n          {canDisplayUserViews(user) && (\r\n            <div onClick={this.onViewsOpen} className={classes.option}>\r\n              {t(\"components.header.otherSettings.views\")}\r\n            </div>\r\n          )}\r\n          {canManagePersonalDashboards(user) && (\r\n            <div onClick={this.onDashboardsOpen} className={classes.option}>\r\n              {t(\"components.header.otherSettings.dashboards\")}\r\n            </div>\r\n          )}\r\n        </ButtonSelect>\r\n        <SettingsDialog\r\n          title={t(\"scenes.viewsSettings.title\")}\r\n          open={isViewsOpen}\r\n          onClose={() => {\r\n            if (viewsSettigsRef.current) {\r\n              viewsSettigsRef.current.cancel(() => this.onViewsClose());\r\n            } else {\r\n              this.onViewsClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <ViewsSettingsForm\r\n            ref={viewsSettigsRef}\r\n            nodes={nodes}\r\n            onViewsClose={this.onViewsClose}\r\n          />\r\n        </SettingsDialog>\r\n        <SettingsDialog\r\n          title={t(\"scenes.dashboardsSettings.title\")}\r\n          open={isDashboardsOpen}\r\n          onClose={() => {\r\n            if (dashboardsSettingsRef.current) {\r\n              dashboardsSettingsRef.current.cancel(() => this.onDashboardsClose());\r\n            } else {\r\n              this.onDashboardsClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <UserDashboardsSettingsForm\r\n            ref={dashboardsSettingsRef}\r\n            nodes={nodes}\r\n            onDashboardsClose={this.onDashboardsClose}\r\n          />\r\n        </SettingsDialog>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps),\r\n  withTranslation()\r\n)(OtherSettingsSelect);","import React from 'react';\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport {useLocation} from \"react-router\";\r\nimport {backupDatasetState} from \"../../state/dataset/datasetActions\";\r\n\r\nconst mapStateToProps = state => ({\r\n  language: state.app.language\r\n});\r\nconst mapDispatchToProps = dispatch => ({\r\n  onDatasetBackup: () => dispatch(backupDatasetState())\r\n});\r\n\r\nconst AppLanguageSelect = ({language, onDatasetBackup}) => {\r\n\r\n  const location = useLocation();\r\n\r\n  return (\r\n    <I18nInputAdornmentSelect\r\n      value={language}\r\n      onChange={val => {\r\n        if (val !== language) {\r\n          onDatasetBackup();\r\n\r\n          const url = location.pathname.includes(language)\r\n            ? \"./#\" + location.pathname.replace(language, val) + location.search\r\n            : `./#/${val}`;\r\n          window.open(url, \"_self\");\r\n        }\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AppLanguageSelect);","import {Link, withStyles} from \"@material-ui/core\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport React, {Component} from \"react\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport UserSelect from \"../user-select\";\r\nimport Drawer from \"@material-ui/core/Drawer\";\r\nimport ChevronLeftIcon from \"@material-ui/icons/ChevronLeft\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport CategoriesTree from \"../categories-tree\";\r\nimport {withRouter} from \"react-router\";\r\nimport SettingsSelect from \"../settings-select\";\r\nimport SearchDialog from \"../search-dialog\";\r\nimport ButtonSelect from \"../button-select\";\r\nimport {goToDatasetsSearch, goToHome, goToNode, goToNodeDashboards} from \"../../links\";\r\nimport HomeIcon from '@material-ui/icons/Home';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport OtherSettingsSelect from \"../other-settings-select\";\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport {\r\n  canClearServerCache,\r\n  canDisplayAppSettingsForm,\r\n  canDisplayNodesSettingsForm,\r\n  canDisplayUsersSettingsForm,\r\n  canDisplayUserViews,\r\n  canGetQueryLog,\r\n  canManagePersonalDashboards\r\n} from \"../../utils/user\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport AppLanguageSelect from \"../app-language-select\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"fixed\",\r\n    width: \"100%\",\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n    display: 'none',\r\n    [theme.breakpoints.up('sm')]: {\r\n      display: 'block',\r\n    },\r\n    color: \"white\"\r\n  },\r\n  leftToolbar: {\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  leftContainer: {\r\n    width: 400\r\n  },\r\n  rightContainer: {\r\n    width: 400\r\n  },\r\n  drawer: {\r\n    minWidth: 448\r\n  },\r\n  drawerHeader: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    padding: theme.spacing(0, 1),\r\n    ...theme.mixins.toolbar,\r\n    justifyContent: 'flex-end',\r\n  },\r\n  drawerHeaderTitle: {\r\n    position: \"absolute\",\r\n    left: theme.spacing(2),\r\n  },\r\n  drawerCategories: {\r\n    margin: theme.spacing(2)\r\n  },\r\n  drawerCategoriesTitle: {\r\n    marginBottom: theme.spacing(2)\r\n  },\r\n  goToHome: {\r\n    margin: theme.spacing(2, 2, 0, 2)\r\n  },\r\n  centerContainer: {\r\n    width: \"calc(100% - 800px)\",\r\n    textAlign: \"center\"\r\n  },\r\n  sistanLogo: {\r\n    height: 32,\r\n    transform: \"translateY(3px)\"\r\n  }\r\n});\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL,\r\n  user: state.user,\r\n});\r\n\r\nclass NodeHeader extends Component {\r\n\r\n  state = {\r\n    isDrawerOpen: this.props.defaultTreeOpen || false\r\n  };\r\n\r\n  onDrawerOpen = () => {\r\n    this.setState({\r\n      isDrawerOpen: true\r\n    });\r\n  };\r\n\r\n  onDrawerClose = () => {\r\n    this.setState({\r\n      isDrawerOpen: false\r\n    });\r\n  };\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      selectedCategoryPath,\r\n      shortName,\r\n      title,\r\n      defaultAppConfigOpen,\r\n      defaultUsersConfigOpen,\r\n      defaultNodesConfigOpen,\r\n      defaultNodeConfigOpen,\r\n      nodes,\r\n      noNode,\r\n      catalog,\r\n      node,\r\n      query,\r\n      hub,\r\n      baseURL,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isDrawerOpen} = this.state;\r\n\r\n    return (\r\n      <div className={classes.root} id=\"node-header\">\r\n        <AppBar position=\"static\" color=\"primary\">\r\n          <Grid container justify=\"space-between\" alignItems=\"center\">\r\n            <Grid item className={classes.leftContainer}>\r\n              {!noNode && (\r\n                <Toolbar className={classes.leftToolbar}>\r\n                  <Grid container spacing={1} alignItems=\"center\">\r\n                    <Grid item>\r\n                      <IconButton\r\n                        className={classes.menuButton}\r\n                        edge=\"start\"\r\n                        color=\"inherit\"\r\n                        onClick={this.onDrawerOpen}\r\n                      >\r\n                        <MenuIcon/>\r\n                      </IconButton>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <ButtonSelect\r\n                        value={\r\n                          <Typography variant=\"h6\" color=\"inherit\">\r\n                            {shortName}\r\n                          </Typography>\r\n                        }\r\n                        onChange={code => goToNode(code.toLowerCase())}\r\n                      >\r\n                        {nodes.sort((a, b) => a.order - b.order).map(({code, name}, i) =>\r\n                          <span key={i} data-value={code}>\r\n                            {code} - {name}\r\n                          </span>\r\n                        )}\r\n                      </ButtonSelect>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Toolbar>\r\n              )}\r\n            </Grid>\r\n            <Grid item className={classes.centerContainer}>\r\n              <Link onClick={goToHome} style={{cursor: \"pointer\"}}>\r\n                <Grid container spacing={2} alignItems=\"center\" justify=\"center\">\r\n                  {hub.logoURL && (\r\n                    <Grid item>\r\n                      <img src={baseURL + hub.logoURL} alt={hub.name} className={classes.sistanLogo}/>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid item>\r\n                    <Typography variant=\"h6\" color=\"secondary\">\r\n                      {hub.name}\r\n                    </Typography>\r\n                  </Grid>\r\n                </Grid>\r\n              </Link>\r\n            </Grid>\r\n            <Grid item className={classes.rightContainer}>\r\n              <Toolbar>\r\n                <Grid container justify=\"flex-end\" alignItems=\"center\" spacing={1}>\r\n                  {!noNode && (\r\n                    <div>\r\n                      <SearchDialog\r\n                        query={query}\r\n                        modalWidth={320}\r\n                        dialogTop={56}\r\n                        onSubmit={value => goToDatasetsSearch(node.code, value)}\r\n                      />\r\n                    </div>\r\n                  )}\r\n                  <Grid item id=\"language-btn\">\r\n                    <AppLanguageSelect/>\r\n                  </Grid>\r\n                  {!noNode && node && node.dashboards && node.dashboards.length > 0 && (\r\n                    <Grid item id=\"dashboards-btn\">\r\n                      <IconButton onClick={() => goToNodeDashboards(node.code)} color=\"inherit\">\r\n                        <DashboardIcon/>\r\n                      </IconButton>\r\n                    </Grid>\r\n                  )}\r\n                  {(canDisplayAppSettingsForm(user) ||\r\n                    canDisplayUsersSettingsForm(user) ||\r\n                    canDisplayNodesSettingsForm(user) ||\r\n                    canGetQueryLog(user) ||\r\n                    canClearServerCache(user)\r\n                  ) && (\r\n                    <Grid item id=\"admin-settings-btn\">\r\n                      <SettingsSelect\r\n                        defaultAppOpen={defaultAppConfigOpen}\r\n                        defaultNodesOpen={defaultNodesConfigOpen}\r\n                        defaultUsersOpen={defaultUsersConfigOpen}\r\n                        defaultNodeOpen={defaultNodeConfigOpen}\r\n                        nodes={nodes}\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                  {(canDisplayUserViews(user) || canManagePersonalDashboards(user)) && (\r\n                    <Grid item id=\"other-settings-btn\">\r\n                      <OtherSettingsSelect nodes={nodes}/>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid item id=\"user-settings-btn\">\r\n                    <UserSelect/>\r\n                  </Grid>\r\n                </Grid>\r\n              </Toolbar>\r\n            </Grid>\r\n          </Grid>\r\n        </AppBar>\r\n        {!noNode && (\r\n          <Drawer\r\n            anchor=\"left\"\r\n            open={isDrawerOpen}\r\n            classes={{\r\n              paper: classes.drawer\r\n            }}\r\n            onClose={this.onDrawerClose}\r\n          >\r\n            <div className={classes.drawerHeader}>\r\n              <Typography variant=\"h6\" className={classes.drawerHeaderTitle}>\r\n                {title}\r\n              </Typography>\r\n              <IconButton onClick={this.onDrawerClose}>\r\n                <ChevronLeftIcon/>\r\n              </IconButton>\r\n            </div>\r\n            <Divider/>\r\n            <div className={classes.goToHome}>\r\n              <Link underline=\"none\" onClick={() => goToNode(node.code)} style={{cursor: \"pointer\"}}>\r\n                <Grid container spacing={1}>\r\n                  <Grid item>\r\n                    <HomeIcon/>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <Typography>\r\n                      {t(\"components.header.drawer.backToNodeHome\")}\r\n                    </Typography>\r\n                  </Grid>\r\n                </Grid>\r\n              </Link>\r\n            </div>\r\n            {catalog && (\r\n              <div className={classes.drawerCategories}>\r\n                <div className={classes.drawerCategoriesTitle}>\r\n                  <Typography>\r\n                    {t(\"components.header.drawer.categoriesTitle\")}\r\n                  </Typography>\r\n                </div>\r\n                <CategoriesTree selectedCategoryPath={selectedCategoryPath} catalog={catalog} node={node}\r\n                                onClose={this.onDrawerClose}/>\r\n              </div>\r\n            )}\r\n          </Drawer>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps),\r\n  withRouter\r\n)(NodeHeader);","import Grid from \"@material-ui/core/Grid\";\r\nimport React from \"react\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  image: {\r\n    height: 20,\r\n    margin: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst Footer = ({classes, textOnly}) =>\r\n  <Grid container type=\"flex\" justify=\"center\" alignItems=\"center\">\r\n    <Grid item>\r\n      {textOnly\r\n        ? <span>ISTAT&nbsp;</span>\r\n        : (\r\n          <img src=\"images/istat/istat-logo-gray.png\" className={classes.image} alt=\"istat logo\"/>\r\n        )}\r\n    </Grid>\r\n    <Grid item>\r\n      Data Browser v1.0\r\n    </Grid>\r\n  </Grid>;\r\n\r\nexport default withStyles(styles)(Footer);","import React, {Component} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Hero from \"../hero\";\r\nimport CardsGrid from \"../cards-grid\";\r\nimport PageSection from \"../page-section\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Page from \"../page\";\r\nimport NodeHeader from \"../node-header\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport {goToHubDashboards, goToNode} from \"../../links\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Footer from \"../footer\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\n\r\nconst styles = theme => ({\r\n  appBar: {\r\n    transition: \"opacity 1s\",\r\n  },\r\n  toolbarButtons: {\r\n    marginLeft: \"auto\",\r\n    '& > *': {\r\n      marginRight: theme.spacing(1)\r\n    }\r\n  },\r\n  anchorContainer: {\r\n    position: \"relative\"\r\n  },\r\n  anchor: {\r\n    position: \"absolute\",\r\n    top: -theme.mixins.toolbar.minHeight\r\n  },\r\n  fullWidthContainer: {\r\n    backgroundColor: \"#f5f5f5\",\r\n    width: \"100%\"\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(3),\r\n    width: 1024,\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  footer: {\r\n    paddingTop: theme.spacing(4)\r\n  },\r\n  footerContent: {\r\n    paddingTop: theme.spacing(2)\r\n  },\r\n  nodesContainer: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  centerContainer: {\r\n    width: 316,\r\n    textAlign: \"center\"\r\n  },\r\n  sistanLogo: {\r\n    width: 32,\r\n    height: 32,\r\n    transform: \"translateY(3px)\"\r\n  },\r\n  leftContainer: {\r\n    width: \"calc((100% - 316px)/2)\"\r\n  },\r\n  rightContainer: {\r\n    width: \"calc((100% - 316px)/2)\"\r\n  },\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub,\r\n  baseURL: state.config.baseURL\r\n});\r\n\r\nclass Home extends Component {\r\n\r\n  info = React.createRef();\r\n  nodesRef = React.createRef();\r\n  dashboard = React.createRef();\r\n  // explore = React.createRef();\r\n\r\n  state = {\r\n    isListMode: true,\r\n  };\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true,\r\n    });\r\n  }\r\n\r\n  /*  onListModeToggle = () => {\r\n      this.setState({isListMode: !this.state.isListMode});\r\n    };*/\r\n\r\n  render() {\r\n\r\n    const {classes, hub, baseURL, t} = this.props;\r\n    // const {isListMode} = this.state;\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          noNode\r\n          defaultNodeConfigOpen={this.props.defaultNodeConfigOpen}\r\n          defaultAppConfigOpen={this.props.defaultAppConfigOpen}\r\n          defaultUserConfigOpen={this.props.defaultUserConfigOpen}\r\n          defaultNodesConfigOpen={this.props.defaultNodesConfigOpen}\r\n          hub={hub.hub}\r\n          nodes={hub.nodes}\r\n        />\r\n        <Hero\r\n          title={hub.hub.name}\r\n          slogan={hub.hub.slogan}\r\n          logo={hub.hub.logoURL && <img src={baseURL + hub.hub.logoURL} alt={hub.hub.name}/>}\r\n          background={\r\n            hub.hub.backgroundMediaURL\r\n              ? (hub.hub.backgroundMediaURL.match(/\\.(jpeg|jpg|gif|png|JPEG|JPG|GIF|PNG)$/)\r\n                ? <img src={baseURL + hub.hub.backgroundMediaURL} alt={hub.hub.name}/>\r\n                : (\r\n                  <video autoPlay muted loop>\r\n                    <source src={baseURL + hub.hub.backgroundMediaURL}/>\r\n                  </video>\r\n                )\r\n              ) : <video autoPlay muted loop>\r\n                <source src=\"./videos/landing-background.mp4\"/>\r\n              </video>\r\n          }\r\n        >\r\n          {hub.hub.description && hub.hub.description.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.info)}>\r\n              {t(\"scenes.hub.informations\")}\r\n            </Button>\r\n          )}\r\n          <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                  onClick={() => this.scroll(this.nodesRef)}>\r\n            {t(\"scenes.hub.nodes\")}\r\n          </Button>\r\n          {hub.hub.dashboards && hub.hub.dashboards.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\" onClick={goToHubDashboards}>\r\n              {t(\"scenes.hub.dashboards\")}\r\n            </Button>\r\n          )}\r\n        </Hero>\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            {hub.hub.description && hub.hub.description.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.info}/>\r\n                <PageSection className={classes.section}\r\n                             sectiontitle={t(\"scenes.hub.informations\")}>\r\n                  <Box textAlign=\"justify\">\r\n                    <SanitizedHTML html={hub.hub.description}/>\r\n                  </Box>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n            <div className={classes.anchorContainer}>\r\n              <div className={classes.anchor} ref={this.nodesRef}/>\r\n              <PageSection className={classes.section} sectiontitle={t(\"scenes.hub.nodes\")}>\r\n                <Box className={classes.nodesContainer}>\r\n                  <CardsGrid\r\n                    list={hub.nodes.sort((a, b) => a.order - b.order).map(({code, name, backgroundMediaURL}) => ({\r\n                      code,\r\n                      id: code,\r\n                      label: name,\r\n                      image: backgroundMediaURL ? baseURL + backgroundMediaURL : \"./images/istat/istat-background.jpg\"\r\n                    }))}\r\n                    onClick={node => goToNode(node.code.toLowerCase())}\r\n                  />\r\n                </Box>\r\n              </PageSection>\r\n            </div>\r\n            <div className={classes.footer}>\r\n              <Divider/>\r\n              <div className={classes.footerContent}>\r\n                <Footer/>\r\n              </div>\r\n            </div>\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps)\r\n)(Home);","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getHubMinimalInfoUrl} from \"../../serverApi/urls\";\r\n\r\nexport const HUB_FETCH = \"hub/fetch\";\r\nexport const HUB_CLEAR = \"hub/clear\";\r\n\r\nexport const fetchHub = () => initRequest(\r\n  HUB_FETCH,\r\n  getHubMinimalInfoUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"domains.hub.messages.fetch.start\")\r\n  })\r\n);\r\n\r\nexport const clearHub = () => ({\r\n  type: HUB_CLEAR\r\n})","import React, {Fragment} from 'react';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {Link} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  list: {\r\n    paddingLeft: theme.spacing(1),\r\n    paddingRight: theme.spacing(1)\r\n  },\r\n  cardContainer: {\r\n    position: \"relative\"\r\n  },\r\n  card: {\r\n    height: \"100%\",\r\n    backgroundColor: theme.palette.background.default\r\n  },\r\n  item: {\r\n    padding: 0\r\n  },\r\n  link: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\nconst CategoriesLists = ({classes, categories, onClick}) => {\r\n\r\n  const rows = [];\r\n\r\n  const chunkSize = 3;\r\n\r\n  for (let i = 0; i < categories.length; i += chunkSize) {\r\n\r\n    const categoriesChunk = categories.slice(i, i + chunkSize);\r\n\r\n    /* first level */\r\n    rows.push(\r\n      <Grid key={i} container spacing={2}>\r\n        {categoriesChunk.map((rootCategory, i) =>\r\n          <Grid item key={i} xs={4}>\r\n            <Typography variant=\"h5\" className={classes.title} style={{fontSize: 20}}>\r\n              {rootCategory.datasetIdentifiers?.length > 0\r\n                ? (\r\n                  <Link onClick={() => onClick([rootCategory.id])} className={classes.link}>\r\n                    {rootCategory.label} ({rootCategory.datasetIdentifiers.length})\r\n                  </Link>\r\n                ) : rootCategory.label\r\n              }\r\n            </Typography>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n\r\n    const fontSizes = [18, 16, 15, 14];\r\n\r\n    /* recursively renders subtree of categories */\r\n    const Subtree = ({root, depth, fontSizes, parentPath = []}) =>\r\n      root.childrenCategories && (\r\n        <div className={classes.card}>\r\n          <List className={classes.list}>\r\n            {root.childrenCategories.map((child, i) =>\r\n              <Fragment key={i}>\r\n                <ListItem className={classes.item}>\r\n                  <ListItemText\r\n                    primary={\r\n                      <Typography style={{fontSize: fontSizes[0]}}>\r\n                        {child.datasetIdentifiers?.length > 0\r\n                          ? (\r\n                            <Link onClick={() => onClick([...parentPath, root.id, child.id])} className={classes.link}>\r\n                              {child.label} ({child.datasetIdentifiers.length})\r\n                            </Link>\r\n                          ) : child.label}\r\n                      </Typography>\r\n                    }\r\n                  />\r\n                </ListItem>\r\n                {/* recursion on subtree of child category */}\r\n                {depth > 1 && (\r\n                  <Subtree\r\n                    root={child}\r\n                    depth={depth - 1}\r\n                    fontSizes={fontSizes.slice(1)}\r\n                    parentPath={[...parentPath, root.id]}\r\n                  />\r\n                )}\r\n              </Fragment>\r\n            )}\r\n          </List>\r\n        </div>\r\n      );\r\n\r\n    /* 4 levels subtree */\r\n    rows.push(\r\n      <Grid key={i + 1} container spacing={2}>\r\n        {categoriesChunk.map((rootCategory, i) =>\r\n          <Grid item key={i} xs={4} className={classes.cardContainer}>\r\n            <Subtree root={rootCategory} depth={4} fontSizes={fontSizes}/>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  return rows;\r\n};\r\n\r\nexport default withStyles(styles)(CategoriesLists);\r\n","import React, {Component} from 'react';\r\nimport Hero from \"../hero\";\r\nimport CardsGrid from \"../cards-grid\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport PageSection from \"../page-section\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport NodeHeader from \"../node-header\";\r\nimport Page from \"../page\";\r\nimport {goToDatasets, goToNodeDashboards} from \"../../links\";\r\nimport CategoriesLists from \"../../components/categories-lists\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\n\r\nconst styles = theme => ({\r\n  anchor: {\r\n    position: \"absolute\",\r\n    top: -theme.mixins.toolbar.minHeight\r\n  },\r\n  anchorContainer: {\r\n    position: \"relative\"\r\n  },\r\n  fullWidthContainer: {\r\n    backgroundColor: \"#f5f5f5\",\r\n    width: \"100%\",\r\n    minHeight: \"100%\"\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(3),\r\n    width: 1024,\r\n  },\r\n  categoriesContainer: {\r\n    paddingTop: theme.spacing(2)\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  categorySchemesTabs: {\r\n    marginBottom: theme.spacing(2)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL\r\n});\r\n\r\nclass Node extends Component {\r\n\r\n  state = {\r\n    configIsListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5,\r\n    isListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5,\r\n    categorySchemeTab: 0\r\n  };\r\n\r\n  info = React.createRef();\r\n  nodes = React.createRef();\r\n  dashboard = React.createRef();\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true\r\n    });\r\n  }\r\n\r\n  onListModeToggle = () => {\r\n    this.setState({isListMode: !this.state.isListMode});\r\n  };\r\n\r\n  setCategorySchemeTab = tab => {\r\n    this.setState({categorySchemeTab: tab});\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n\r\n    const configIsListMode = props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5;\r\n\r\n    if (configIsListMode !== state.configIsListMode) {\r\n      return {\r\n        ...state,\r\n        configIsListMode,\r\n        isListMode: configIsListMode\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      defaultTreeOpen,\r\n      defaultNodeConfigOpen,\r\n      defaultAppConfigOpen,\r\n      defaultUserConfigOpen,\r\n      defaultNodesConfigOpen,\r\n      node,\r\n      nodeCode,\r\n      hub,\r\n      catalog,\r\n      baseURL,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isListMode, categorySchemeTab} = this.state;\r\n\r\n    const nodeMinimalInfo = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n\r\n    const uncategorizedCategory = {\r\n      id: \"uncategorized\",\r\n      label: t(\"commons.catalog.uncategorized\"),\r\n      childrenCategories: [],\r\n      datasetIdentifiers: catalog?.uncategorizedDatasets.map(({identifier}) => identifier)\r\n    };\r\n\r\n    const categoriesForExplore =\r\n      catalog\r\n        ? (\r\n          catalog.categoryGroups.length > 1\r\n            ? (\r\n              categorySchemeTab === \"uncategorized\"\r\n                ? [uncategorizedCategory]\r\n                : catalog.categoryGroups[categorySchemeTab].categories.map(c => ({\r\n                  ...c,\r\n                  image: c.image ? baseURL + c.image : undefined\r\n                }))\r\n            )\r\n            : (\r\n              catalog.uncategorizedDatasets.length > 0\r\n                ? catalog.categoryGroups[0]?.categories.map(c => ({\r\n                ...c,\r\n                image: c.image ? baseURL + c.image : undefined\r\n              })).concat([uncategorizedCategory]) || [uncategorizedCategory]\r\n                : catalog.categoryGroups[0]?.categories.map(c => ({\r\n                ...c,\r\n                image: c.image ? baseURL + c.image : undefined\r\n              })) || []\r\n            ))\r\n        : [];\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          hub={hub.hub}\r\n          nodes={hub.nodes}\r\n          catalog={catalog}\r\n          defaultTreeOpen={defaultTreeOpen}\r\n          shortName={nodeCode}\r\n          title={nodeMinimalInfo.name}\r\n          node={node}\r\n          defaultNodeConfigOpen={defaultNodeConfigOpen}\r\n          defaultAppConfigOpen={defaultAppConfigOpen}\r\n          defaultUserConfigOpen={defaultUserConfigOpen}\r\n          defaultNodesConfigOpen={defaultNodesConfigOpen}\r\n          nodeId={nodeMinimalInfo.nodeId}\r\n        />\r\n        <Hero\r\n          title={nodeMinimalInfo.name}\r\n          slogan={node && node.slogan}\r\n          logo={node && nodeMinimalInfo.logoURL &&\r\n          <img src={baseURL + nodeMinimalInfo.logoURL} alt={nodeMinimalInfo.name}/>}\r\n          background={\r\n            nodeMinimalInfo.backgroundMediaURL\r\n              ? (\r\n                nodeMinimalInfo.backgroundMediaURL.match(/\\.(jpeg|jpg|gif|png|JPEG|JPG|GIF|PNG)$/)\r\n                  ? <img src={baseURL + nodeMinimalInfo.backgroundMediaURL} alt={nodeMinimalInfo.name}/>\r\n                  : (\r\n                    <video autoPlay muted loop>\r\n                      <source src={baseURL + nodeMinimalInfo.backgroundMediaURL}/>\r\n                    </video>\r\n                  )\r\n              )\r\n              : <img src=\"./images/istat/istat-background.jpg\" alt={nodeMinimalInfo.name}/>\r\n          }\r\n        >\r\n          {node && node.description && node.description.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.info)}>\r\n              {t(\"scenes.node.informations\")}\r\n            </Button>\r\n          )}\r\n          {catalog && categoriesForExplore.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.nodes)}>\r\n              {t(\"scenes.node.explore\")}\r\n            </Button>\r\n          )}\r\n          {nodeMinimalInfo.dashboards && nodeMinimalInfo.dashboards.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => goToNodeDashboards(nodeCode)}>\r\n              {t(\"scenes.node.dashboards\")}\r\n            </Button>\r\n          )}\r\n        </Hero>\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            {node && node.description && node.description.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.info}/>\r\n                <PageSection className={classes.section} sectiontitle={t(\"scenes.node.informations\")}>\r\n                  <Box textAlign=\"justify\">\r\n                    <SanitizedHTML html={node.description}/>\r\n                  </Box>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n            {catalog && categoriesForExplore.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.nodes}/>\r\n                <PageSection className={classes.section} sectiontitle={t(\"scenes.node.explore\")}>\r\n                  <div className={classes.categoriesContainer}>\r\n                    {catalog.categoryGroups.length > 1 && (\r\n                      <Tabs\r\n                        value={categorySchemeTab}\r\n                        onChange={(_, tab) => this.setCategorySchemeTab(tab)}\r\n                        className={classes.categorySchemesTabs}\r\n                      >\r\n                        {catalog.categoryGroups.map(({label}, index) =>\r\n                          <Tab value={index} label={label} key={index}/>\r\n                        )}\r\n                        {catalog.uncategorizedDatasets?.length > 0 && (\r\n                          <Tab value=\"uncategorized\" label={t(\"commons.catalog.uncategorized\")}\r\n                               key=\"uncategorized\"/>\r\n                        )}\r\n                      </Tabs>\r\n                    )}\r\n                    {isListMode\r\n                      ? (\r\n                        <CategoriesLists\r\n                          categories={categoriesForExplore}\r\n                          onClick={\r\n                            categoryPath =>\r\n                              goToDatasets(\r\n                                node.code,\r\n                                categoryPath[0] === \"uncategorized\"\r\n                                  ? [\"uncategorized\"]\r\n                                  : catalog.categoryGroups.length > 1 ? [catalog.categoryGroups[categorySchemeTab].id, ...categoryPath] : categoryPath\r\n                              )\r\n                          }\r\n                        />\r\n                      )\r\n                      : (\r\n                        <CardsGrid\r\n                          squareImage\r\n                          list={categoriesForExplore}\r\n                          onClick={\r\n                            category =>\r\n                              goToDatasets(\r\n                                node.code,\r\n                                category.id === \"uncategorized\"\r\n                                  ? [\"uncategorized\"]\r\n                                  : catalog.categoryGroups.length > 1 ? [catalog.categoryGroups[categorySchemeTab].id, category.id] : [category.id]\r\n                              )\r\n                          }\r\n                        />\r\n                      )\r\n                    }\r\n                  </div>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps)\r\n)(Node);","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getNodeUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_FETCH = \"node/fetch\";\r\nexport const NODE_CLEAR = \"node/clear\";\r\n\r\nexport const fetchNode = (nodeId: number) =>\r\n  initRequest(\r\n    NODE_FETCH,\r\n    getNodeUrl(nodeId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n      onStart: t(\"domains.node.messages.fetch.start\")\r\n    })\r\n  );\r\n\r\nexport const clearNode = () => ({\r\n  type: NODE_CLEAR\r\n})","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getNodeCatalogUrl} from \"../../serverApi/urls\";\r\n\r\nexport const CATALOG_FETCH = \"catalog/fetch\";\r\nexport const CATALOG_CLEAR = \"catalog/clear\";\r\n\r\nexport const fetchCatalog = (nodeId: number) => initRequest(\r\n  CATALOG_FETCH,\r\n  getNodeCatalogUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"domains.catalog.messages.fetch.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n\r\nexport const clearCatalog = () => ({\r\n  type: CATALOG_CLEAR\r\n})","import React, {useState} from \"react\";\r\nimport TreeItem from \"@material-ui/lab/TreeItem\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport TreeView from \"@material-ui/lab/TreeView\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\r\nimport {goToDatasetsSearch} from \"../../links\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\n\r\nconst styles = () => ({\r\n  container: {\r\n    background: \"#F5F5F5\",\r\n    paddingTop: 8,\r\n    paddingBottom: 8\r\n  },\r\n  nodeIcon: {\r\n    marginTop: 5\r\n  },\r\n  item: {\r\n    background: \"none !important\"\r\n  },\r\n  resCount: {\r\n    fontWeight: \"bold\",\r\n    marginLeft: 4\r\n  },\r\n  checkbox: {\r\n    padding: 0,\r\n    transform: \"translateY(-2px)\"\r\n  }\r\n});\r\n\r\nfunction ResultTree(props) {\r\n  const {\r\n    classes,\r\n    catalog,\r\n    query,\r\n    node,\r\n    filters = [],\r\n    categoryGroupsWithCount,\r\n    uncategorizedDatasetsCount,\r\n    t\r\n  } = props;\r\n\r\n  const [expanded, setExpanded] = useState([]);\r\n\r\n  const getTreeItems = (tree, prevPath, noCheckbox = false) =>\r\n    tree.map((cat, i) => {\r\n\r\n      const selected = !!filters.find(filter => filter.includes(cat.id));\r\n\r\n      return (\r\n        <TreeItem\r\n          key={i}\r\n          nodeId={cat.id}\r\n          label={\r\n            <Grid spacing={1} container alignItems=\"flex-start\"\r\n                  style={{flexWrap: \"nowrap\", marginTop: 4}}>\r\n              {!noCheckbox && (\r\n                <Grid item>\r\n                  <label htmlFor={`result-tree__checkbox__${cat.id}`} style={{display: \"none\"}}>\r\n                    {cat.label}\r\n                  </label>\r\n                  <Checkbox\r\n                    id={`result-tree__checkbox__${cat.id}`}\r\n                    checked={selected}\r\n                    className={classes.checkbox}\r\n                    onClick={\r\n                      e => {\r\n                        goToDatasetsSearch(\r\n                          node.code,\r\n                          query,\r\n                          selected\r\n                            ? filters.filter(path => !path.includes(cat.id))\r\n                            : [...filters, [...prevPath, cat.id]]\r\n                        );\r\n                        e.stopPropagation();\r\n                      }}\r\n                  />\r\n                </Grid>\r\n              )}\r\n              <Grid item style={{width: \"100%\"}}>\r\n                {cat.label}\r\n                {!noCheckbox && (\r\n                  <span className={classes.resCount}> ({cat.count})</span>\r\n                )}\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n          classes={{\r\n            label: classes.item\r\n          }}\r\n        >\r\n          {cat.categories && cat.categories.length > 0 && getTreeItems(cat.categories, [...prevPath, cat.id])}\r\n        </TreeItem>\r\n      );\r\n    });\r\n\r\n  const uncategorizedSelected = !!filters.find(filter => filter.includes(\"uncategorized\"));\r\n\r\n  return (\r\n    <Box className={classes.container}>\r\n      {categoryGroupsWithCount.length > 0 && (\r\n        <TreeView\r\n          defaultCollapseIcon={<ExpandMoreIcon/>}\r\n          defaultExpandIcon={<ChevronRightIcon/>}\r\n          expanded={expanded}\r\n          onNodeToggle={(_, nodeIds) => setExpanded(nodeIds)}\r\n        >\r\n          {getTreeItems(\r\n            catalog.categoryGroups.length > 1\r\n              ? categoryGroupsWithCount\r\n              : categoryGroupsWithCount[0].categories,\r\n            [],\r\n            catalog.categoryGroups.length > 1\r\n          )}\r\n        </TreeView>\r\n      )}\r\n      {uncategorizedDatasetsCount > 0 && (\r\n        <TreeView\r\n          defaultCollapseIcon={<ExpandMoreIcon/>}\r\n          defaultExpandIcon={<ChevronRightIcon/>}\r\n          expanded={expanded}\r\n          onNodeToggle={(_, nodeIds) => setExpanded(nodeIds)}\r\n        >\r\n          <TreeItem\r\n            key={\"uncategorized\"}\r\n            nodeId={\"uncategorized\"}\r\n            label={\r\n              <Grid spacing={1} container alignItems=\"flex-start\" style={{flexWrap: \"nowrap\", marginTop: 4}}>\r\n                <Grid item>\r\n                  <label htmlFor=\"result-tree__checkbox__uncategorized\" style={{display: \"none\"}}>\r\n                    {t(\"commons.catalog.uncategorized\")}\r\n                  </label>\r\n                  <Checkbox\r\n                    id=\"result-tree__checkbox__uncategorized\"\r\n                    checked={uncategorizedSelected}\r\n                    className={classes.checkbox}\r\n                    onClick={\r\n                      e => {\r\n                        goToDatasetsSearch(\r\n                          node.code,\r\n                          query,\r\n                          uncategorizedSelected\r\n                            ? filters.filter(path => JSON.stringify(path) !== JSON.stringify([\"uncategorized\"]))\r\n                            : [...filters, [\"uncategorized\"]]\r\n                        );\r\n                        e.stopPropagation();\r\n                      }}\r\n                  />\r\n                </Grid>\r\n                <Grid style={{width: \"100%\"}} item>\r\n                  {t(\"commons.catalog.uncategorized\")} <span\r\n                  className={classes.resCount}>({uncategorizedDatasetsCount})</span>\r\n                </Grid>\r\n              </Grid>\r\n            }\r\n            classes={{label: classes.item}}\r\n          />\r\n        </TreeView>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ResultTree);","const getDownloadButtonStyle = extension => {\r\n\r\n  const styles = {\r\n    rdf: {\r\n      backgroundColor: \"#3f51b5\",\r\n      color: \"white\"\r\n    },\r\n    html: {backgroundColor: \"#00bcd4\"},\r\n    csv: {backgroundColor: \"#ffeb3b\"},\r\n    xml: {backgroundColor: \"#ff5722\"},\r\n    json: {backgroundColor: \"#ff9800\"},\r\n    xls: {backgroundColor: \"#4caf50\"}\r\n  };\r\n\r\n  return styles[extension] || {};\r\n};\r\n\r\nexport default getDownloadButtonStyle;","import React, {Fragment, useState} from \"react\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ExpandLessIcon from \"@material-ui/icons/ExpandLess\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport getDownloadButtonStyle from './getDownloadButtonStyle';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport SanitizedHTML from \"../sanitized-html\";\r\n\r\nconst styles = () => ({\r\n  collapsedDescription: {\r\n    marginTop: 8,\r\n    height: 49,\r\n    overflow: \"hidden\"\r\n  },\r\n  expandedDescription: {\r\n    marginTop: 8\r\n  },\r\n  resultSource: {\r\n    fontSize: 14,\r\n    color: \"rgba(0, 0, 0, 0.54)\",\r\n  },\r\n  cardContent: {\r\n    padding: \"16px !important\"\r\n  },\r\n  description: {\r\n    \"& > p\": {\r\n      margin: 0\r\n    }\r\n  },\r\n  downloadChipDeleteIcon: {\r\n    backgroundColor: \"white\"\r\n  }\r\n});\r\n\r\nconst DatasetCard = ({\r\n                       dataset,\r\n                       classes,\r\n                       isExpanded,\r\n                       onViewDataset,\r\n                       onExpand,\r\n                       onCollapse,\r\n                       xs\r\n                     }) => {\r\n\r\n  const [isDownloadModalOpen, setIsDownloadModalOpen] = useState(false);\r\n  const [downloadModal, setDownloadModal] = useState(null);\r\n  const {t} = useTranslation();\r\n\r\n  const groupedAttachments = [];\r\n  (dataset.attachedDataFiles || []).forEach(({format, url}) => {\r\n\r\n    const group = groupedAttachments.find(({extension}) => extension === format.toLowerCase());\r\n\r\n    if (!group) {\r\n      groupedAttachments.push({\r\n        extension: format.toLowerCase(),\r\n        urls: [url]\r\n      })\r\n    } else {\r\n      group.urls.push(url);\r\n    }\r\n  });\r\n\r\n  const headerContent =\r\n    <Fragment>\r\n      <Grid container justify=\"space-between\" spacing={2} alignItems=\"center\">\r\n        <Grid item>\r\n          <Typography variant=\"h6\">\r\n            {dataset.title}\r\n          </Typography>\r\n        </Grid>\r\n        {groupedAttachments.length > 0 && (\r\n          <Grid item>\r\n            <Grid container spacing={1}>\r\n              {groupedAttachments\r\n                .map((group, index) =>\r\n                  <Grid item key={index}>\r\n                    <Chip\r\n                      className={`download-btn--${group.extension.toLowerCase()}`}\r\n                      label={group.extension.toUpperCase()}\r\n                      deleteIcon={\r\n                        group.urls.length > 1\r\n                          ? (\r\n                            <Avatar style={{fontSize: 12, color: \"black\"}}>\r\n                              {group.urls.length}\r\n                            </Avatar>\r\n                          )\r\n                          : null\r\n                      }\r\n                      onDelete={\r\n                        group.urls.length > 1\r\n                          ? e => {\r\n                            e.stopPropagation();\r\n                            setIsDownloadModalOpen(true);\r\n                            setDownloadModal(group)\r\n                          }\r\n                          : null\r\n                      }\r\n                      size=\"small\"\r\n                      onClick={\r\n                        e => {\r\n                          e.stopPropagation();\r\n                          if (group.urls.length > 1) {\r\n                            setIsDownloadModalOpen(true);\r\n                            setDownloadModal(group)\r\n                          } else {\r\n                            window.open(group.urls[0], \"_blank\")\r\n                          }\r\n                        }\r\n                      }\r\n                      style={{\r\n                        cursor: \"pointer\",\r\n                        ...getDownloadButtonStyle(group.extension)\r\n                      }}\r\n                      classes={{\r\n                        deleteIconSmall: classes.downloadChipDeleteIcon\r\n                      }}\r\n                    />\r\n                  </Grid>\r\n                )}\r\n            </Grid>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n      {dataset.source && (\r\n        <Typography variant=\"body1\" className={classes.resultSource}>\r\n          {dataset.source}\r\n        </Typography>\r\n      )}\r\n    </Fragment>;\r\n\r\n  const header =\r\n    dataset.catalogType !== \"ONLY_FILE\"\r\n      ? (\r\n        <CardActionArea\r\n          onClick={onViewDataset}\r\n        >\r\n          {headerContent}\r\n        </CardActionArea>\r\n      )\r\n      : headerContent;\r\n\r\n  const description =\r\n    (\r\n      dataset.description ||\r\n      (dataset.keywords && dataset.keywords.length > 0)\r\n    ) && (\r\n      <Typography\r\n        component='div'\r\n        variant=\"body1\"\r\n        className={isExpanded ? classes.expandedDescription : classes.collapsedDescription}\r\n      >\r\n        <SanitizedHTML html={dataset.description} className={classes.description}/>\r\n        {dataset.keywords && dataset.keywords.length > 0 && (\r\n          <Grid container spacing={1}>\r\n            {dataset.keywords.map((keyword, index) =>\r\n              <Grid item key={index}>\r\n                <Chip\r\n                  label={keyword}\r\n                  size=\"small\"\r\n                />\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        )}\r\n      </Typography>\r\n    );\r\n\r\n  const expandIcon = <Grid container justify=\"flex-end\">\r\n    <Grid item>\r\n      <IconButton\r\n        onClick={isExpanded ? onCollapse : onExpand}\r\n      >\r\n        {isExpanded\r\n          ? <ExpandLessIcon/>\r\n          : <ExpandMoreIcon/>\r\n        }\r\n      </IconButton>\r\n    </Grid>\r\n  </Grid>;\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid item xs={xs}>\r\n        <Card>\r\n          <CardContent className={classes.cardContent}>\r\n            <Grid container>\r\n              <Grid item xs={12}>\r\n                {header}\r\n              </Grid>\r\n            </Grid>\r\n            {description}\r\n            {description && expandIcon}\r\n          </CardContent>\r\n        </Card>\r\n      </Grid>\r\n      <Dialog\r\n        open={!!isDownloadModalOpen}\r\n        disableEscapeKeyDown\r\n        disableBackdropClick\r\n        onClose={() => setIsDownloadModalOpen(false)}\r\n        onExited={() => setDownloadModal(null)}\r\n      >\r\n        <DialogContent>\r\n          <List>\r\n            {downloadModal?.urls.map((url, key) =>\r\n              <ListItem key={key}>\r\n                <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">{url}</a>\r\n              </ListItem>\r\n            )}\r\n          </List>\r\n          <DialogActions>\r\n            <Button onClick={() => setIsDownloadModalOpen(false)}>\r\n              {t(\"commons.confirm.close\")}\r\n            </Button>\r\n          </DialogActions>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(DatasetCard);","import React, {Component} from 'react';\r\nimport NodeHeader from \"../node-header\";\r\nimport {Link, withStyles} from \"@material-ui/core\";\r\nimport Page from \"../page\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {goToData, goToDatasets, goToNode} from \"../../links\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ListIcon from '@material-ui/icons/List';\r\nimport GridOnIcon from '@material-ui/icons/GridOn';\r\nimport Breadcrumbs from \"@material-ui/core/Breadcrumbs\";\r\nimport ResultTree from \"./ResultTree\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\nimport FolderIcon from \"@material-ui/icons/Folder\";\r\nimport DatasetCard from \"./DatasetCard\";\r\n\r\nconst styles = theme => ({\r\n  fullWidthContainer: {\r\n    width: \"100%\",\r\n    paddingTop: 64,\r\n    backgroundColor: \"#f5f5f5\",\r\n    minHeight: \"100%\"\r\n  },\r\n  container: {\r\n    width: 1024,\r\n  },\r\n  results: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  toolbar: {\r\n    marginTop: theme.spacing(2),\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  subCat: {\r\n    padding: theme.spacing(1)\r\n  },\r\n  row: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nclass Results extends Component {\r\n\r\n  state = {\r\n    expandedIndexes: [],\r\n    configIsListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .catalogNavigationMode === \"List\",\r\n    isListMode:\r\n      this.props.hub.nodes\r\n        .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n        .catalogNavigationMode === \"List\",\r\n    isA11yMode: false\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n\r\n    const configIsListMode = props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === props.nodeCode.toLowerCase())\r\n      .catalogNavigationMode === \"List\";\r\n\r\n    if (configIsListMode !== state.configIsListMode) {\r\n      return {\r\n        ...state,\r\n        configIsListMode,\r\n        isListMode: configIsListMode\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  expand = index =>\r\n    this.setState({\r\n      expandedIndexes: [...this.state.expandedIndexes, index]\r\n    });\r\n\r\n  collapse = index =>\r\n    this.setState({\r\n      expandedIndexes: [...this.state.expandedIndexes.filter(i => i !== index)]\r\n    });\r\n\r\n  onListModeToggle = () => {\r\n    this.setState({isListMode: !this.state.isListMode});\r\n  };\r\n\r\n  onA11yModeToggle = () => {\r\n    this.setState({isA11yMode: !this.state.isA11yMode});\r\n  };\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      query,\r\n      hub,\r\n      catalog,\r\n      node,\r\n      nodeCode,\r\n      categoryPath,\r\n      datasets,\r\n      subCategories,\r\n      filters,\r\n      categoryGroupsWithCount,\r\n      uncategorizedDatasetsCount,\r\n      t\r\n    } = this.props;\r\n\r\n    const {expandedIndexes, isListMode, isA11yMode} = this.state;\r\n\r\n    const nodeMinimalInfo = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n\r\n    let categoryPathLabels = [];\r\n    if (categoryPath) {\r\n      if (categoryPath[0] === \"uncategorized\") {\r\n        categoryPathLabels = [t(\"commons.catalog.uncategorized\")];\r\n      } else {\r\n\r\n        let category;\r\n\r\n        if (catalog.categoryGroups.length > 1) {\r\n          category = catalog.categoryGroups.find(({id}) => id === categoryPath[0]);\r\n        } else {\r\n          category = catalog.categoryGroups[0].categories.find(({id}) => id === categoryPath[0]);\r\n        }\r\n\r\n        categoryPathLabels.push(category.label);\r\n        for (let i = 1; i < categoryPath.length; i++) {\r\n          category = (category.childrenCategories || category.categories).find(({id}) => id === categoryPath[i]);\r\n          categoryPathLabels.push(category.label);\r\n        }\r\n      }\r\n    }\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          hub={hub.hub}\r\n          query={query}\r\n          nodes={hub.nodes}\r\n          catalog={catalog}\r\n          shortName={nodeMinimalInfo.code}\r\n          title={nodeMinimalInfo.name}\r\n          node={node}\r\n          nodeId={nodeMinimalInfo.nodeId}\r\n          selectedCategoryPath={categoryPath}\r\n        />\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            <Grid container justify=\"space-between\" alignItems=\"center\" className={classes.toolbar}>\r\n              <Grid item>\r\n                {query ?\r\n                  (\r\n                    <Typography variant={\"h5\"}>\r\n                      {t(\"scenes.results.searchTitle\", {query})}\r\n                    </Typography>\r\n                  )\r\n                  : (\r\n                    <Breadcrumbs>\r\n                      <Link underline=\"none\" onClick={() => goToNode(node.code)} style={{cursor: \"pointer\"}}>\r\n                        <Typography>\r\n                          {nodeCode.toUpperCase()}\r\n                        </Typography>\r\n                      </Link>\r\n                      {categoryPath.map((id, idx) => {\r\n                        if (idx >= (catalog && catalog.categoryGroups.length === 1 ? 0 : 1)) {\r\n                          return (\r\n                            <Link\r\n                              key={idx}\r\n                              underline=\"none\"\r\n                              onClick={\r\n                                idx >= (\r\n                                  catalog && catalog.categoryGroups.length === 1\r\n                                    ? 0\r\n                                    : 1\r\n                                )\r\n                                  ? () => goToDatasets(node.code, categoryPath.slice(0, idx + 1))\r\n                                  : null\r\n                              }\r\n                              style={idx < categoryPath.length - 1 ? {cursor: \"pointer\"} : undefined}\r\n                            >\r\n                              <Typography>\r\n                                {id === \"uncategorized\"\r\n                                  ? t(\"commons.catalog.uncategorized\")\r\n                                  : categoryPathLabels[idx]\r\n                                }\r\n                              </Typography>\r\n                            </Link>\r\n                          );\r\n                        } else {\r\n                          return (\r\n                            <Typography key=\"idx\" color=\"primary\">\r\n                              {id === \"uncategorized\"\r\n                                ? t(\"commons.catalog.uncategorized\")\r\n                                : categoryPathLabels[idx]\r\n                              }\r\n                            </Typography>\r\n                          );\r\n                        }\r\n                      })}\r\n                    </Breadcrumbs>\r\n                  )}\r\n              </Grid>\r\n              <Grid item>\r\n                <Grid container alignItems=\"center\" justify=\"flex-end\" spacing={1}>\r\n                  <Grid item>\r\n                    {datasets.length > 0 && (\r\n                      <IconButton onClick={this.onListModeToggle}>\r\n                        {isListMode\r\n                          ? <GridOnIcon/>\r\n                          : <ListIcon/>\r\n                        }\r\n                      </IconButton>\r\n                    )}\r\n                  </Grid>\r\n                 {/* <Grid item>\r\n                    <label htmlFor=\"results__a11y-mode-toggle\" style={{display: \"none\"}}>\r\n                      {t(\"scenes.results.a11yModeToggle.label\")}\r\n                    </label>\r\n                    <FormControlLabel\r\n                      label={t(\"scenes.results.a11yModeToggle.label\")}\r\n                      control={\r\n                        <Switch\r\n                          checked={isA11yMode}\r\n                          onChange={this.onA11yModeToggle}\r\n                          color=\"primary\"\r\n                          name=\"checkedB\"\r\n                          id=\"results__a11y-mode-toggle\"\r\n                        />\r\n                      }\r\n                    />\r\n                  </Grid>*/}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container spacing={2} className={classes.results}>\r\n              {query && (\r\n                <Grid item style={{width: 256, transform: \"translateX(-24px)\"}}>\r\n                  <ResultTree\r\n                    query={query} filters={filters} catalog={catalog} node={node}\r\n                    datasets={datasets}\r\n                    categoryGroupsWithCount={categoryGroupsWithCount}\r\n                    uncategorizedDatasetsCount={uncategorizedDatasetsCount}\r\n                  />\r\n                </Grid>\r\n              )}\r\n              <Grid item style={{width: query ? `calc(100% - 256px)` : \"100%\"}}>\r\n                {subCategories && subCategories.length\r\n                  ? (\r\n                    <Grid container spacing={2} className={classes.row}>\r\n                      {subCategories.map(({id, label, datasetIdentifiers}) =>\r\n                        <Grid item key={id}>\r\n                          <Card className={classes.subCat}>\r\n                            <CardActionArea\r\n                              onClick={() => goToDatasets(node.code.toLowerCase(), [...categoryPath, id])}>\r\n                              <Grid container spacing={1}>\r\n                                <Grid item>\r\n                                  <FolderIcon/>\r\n                                </Grid>\r\n                                <Grid item>\r\n                                  <Typography variant=\"body1\">\r\n                                    {label} {datasetIdentifiers && datasetIdentifiers.length ? `(${datasetIdentifiers.length})` : ''}\r\n                                  </Typography>\r\n                                </Grid>\r\n                              </Grid>\r\n                            </CardActionArea>\r\n                          </Card>\r\n                        </Grid>\r\n                      )}\r\n                    </Grid>\r\n                  )\r\n                  : null}\r\n                {query && datasets.length\r\n                  ? (\r\n                    <Typography variant=\"body1\" className={classes.row}>\r\n                      {datasets.length > 1\r\n                        ? t(\"scenes.results.datasetsCount.plural\", {datasetsCount: datasets.length})\r\n                        : t(\"scenes.results.datasetsCount.singular\", {datasetsCount: datasets.length})\r\n                      }:\r\n                    </Typography>\r\n                  ) : null\r\n                }\r\n                <Grid container spacing={2}>\r\n                  {datasets.length > 0\r\n                    ? datasets.map((dataset, i) =>\r\n                      <DatasetCard\r\n                        key={i}\r\n                        isExpanded={expandedIndexes.includes(i)}\r\n                        onViewDataset={() => goToData(\r\n                          node.code,\r\n                          dataset.categoryPath,\r\n                          dataset.identifier,\r\n                          undefined,\r\n                          isA11yMode\r\n                        )}\r\n                        dataset={dataset}\r\n                        onExpand={() => this.expand(i)}\r\n                        onCollapse={() => this.collapse(i)}\r\n                        xs={isListMode ? 12 : 4}\r\n                      />\r\n                    )\r\n                    : (\r\n                      (query || !subCategories || !subCategories.length)\r\n                        ? (\r\n                          <Grid container>\r\n                            <Grid item>\r\n                              {t(\"scenes.results.datasetsCount.none\")}\r\n                            </Grid>\r\n                          </Grid>\r\n                        )\r\n                        : null\r\n                    )}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(Results);","import React from 'react';\r\nimport NodeHeader from \"../node-header\";\r\nimport DataViewer from \"../data-viewer\";\r\nimport Page from \"../page\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = () => ({\r\n  fullWidthContainer: {\r\n    backgroundColor: \"#f5f5f5\",\r\n    width: \"100%\",\r\n    minHeight: \"100%\"\r\n  }\r\n});\r\n\r\nconst Data = ({\r\n                classes,\r\n                hub,\r\n                node,\r\n                catalog,\r\n                categoryPath,\r\n                isAccessible,\r\n                datasetId,\r\n                datasetTitle,\r\n                viewId,\r\n                notes,\r\n                attachedFiles,\r\n                referenceMetadataUrl\r\n              }) => {\r\n\r\n  const nodeExtras = {};\r\n  if (node?.extras) {\r\n    node.extras.map(({key, value}) => nodeExtras[key] = JSON.parse(value));\r\n  }\r\n\r\n  const hubExtras = JSON.parse(hub.hub.extras || \"{}\");\r\n\r\n  return (\r\n    <Page>\r\n      <NodeHeader\r\n        hub={hub.hub}\r\n        nodes={hub?.nodes}\r\n        catalog={catalog}\r\n        shortName={node?.code}\r\n        title={node?.name}\r\n        node={node}\r\n        nodeId={node?.nodeId}\r\n        selectedCategoryPath={categoryPath}\r\n      />\r\n      <div style={{paddingTop: 64}} className={classes.fullWidthContainer}>\r\n        <div style={{marginLeft: 16}}/>\r\n        <DataViewer\r\n          nodeId={node?.nodeId}\r\n          nodeCode={node?.code}\r\n          isAccessible={isAccessible}\r\n          datasetId={datasetId}\r\n          datasetTitle={datasetTitle}\r\n          viewId={viewId}\r\n          notes={notes}\r\n          attachedFiles={attachedFiles}\r\n          referenceMetadataUrl={referenceMetadataUrl}\r\n          hubExtras={hubExtras}\r\n          nodeExtras={nodeExtras}\r\n          maxObservation={hub?.hub?.maxObservationsAfterCriteria}\r\n        />\r\n      </div>\r\n    </Page>\r\n  )\r\n};\r\n\r\nexport default withStyles(styles)(Data);","import React, {useEffect} from 'react';\r\nimport Data from \"../components/data\";\r\nimport {connect} from \"react-redux\";\r\nimport {enableDatasetStructureFetch, fetchDatasetStructure, resetDatasetState} from \"../state/dataset/datasetActions\";\r\nimport Call from \"../hocs/call\";\r\n\r\nconst mapStateToProps = state => ({\r\n  dataset: state.dataset,\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onFetchStructureEnable: (nodeCode, categoryPath, datasetId, viewId) =>\r\n    dispatch(enableDatasetStructureFetch(nodeCode, categoryPath, datasetId, viewId)),\r\n  fetchStructure: ({nodeId, datasetId, viewId, isAccessible, defaultLanguage, languages}) =>\r\n    dispatch(fetchDatasetStructure(nodeId, datasetId, viewId, isAccessible, defaultLanguage, languages)),\r\n  onDatasetReset: () => dispatch(resetDatasetState())\r\n});\r\n\r\nconst DatasetDomain = ({\r\n                         dataset,\r\n                         defaultLanguage,\r\n                         languages,\r\n                         hub,\r\n                         node,\r\n                         nodeCode,\r\n                         catalog,\r\n                         categoryPath,\r\n                         isAccessible,\r\n                         datasetId,\r\n                         datasetTitle,\r\n                         notes,\r\n                         attachedFiles,\r\n                         referenceMetadataUrl,\r\n                         viewId,\r\n                         onFetchStructureEnable,\r\n                         fetchStructure,\r\n                         onDatasetReset\r\n                       }) => {\r\n\r\n  useEffect(() => {\r\n    if (hub && node && catalog && node.nodeId === catalog.nodeId && node.code.toLowerCase() === nodeCode.toLowerCase()) {\r\n      onFetchStructureEnable(nodeCode, categoryPath, datasetId, viewId);\r\n    }\r\n    return () => onDatasetReset();\r\n  }, [onDatasetReset, onFetchStructureEnable, hub, node, catalog, nodeCode, categoryPath, datasetId, datasetTitle, viewId]);\r\n\r\n  const isTheSameData = dataset !== null && (\r\n    nodeCode === dataset.nodeCode &&\r\n    (categoryPath || []).join() === (dataset.categoryPath || []).join() &&\r\n    datasetId === dataset.datasetId &&\r\n    (viewId || \"\") === (dataset?.viewId || \"\")\r\n  );\r\n\r\n  return (\r\n    <Call\r\n      cb={fetchStructure}\r\n      cbParam={{nodeId: node ? node.nodeId : null, datasetId, viewId, isAccessible, defaultLanguage, languages}}\r\n      disabled={!node || !node.nodeId || !datasetId || !dataset || dataset.isFetchStructureDisabled}\r\n    >\r\n      {isTheSameData && (\r\n        <Data\r\n          hub={hub}\r\n          node={node}\r\n          catalog={catalog}\r\n          categoryPath={categoryPath}\r\n          isAccessible={isAccessible}\r\n          datasetId={datasetId}\r\n          datasetTitle={datasetTitle}\r\n          viewId={viewId}\r\n          notes={notes}\r\n          attachedFiles={attachedFiles}\r\n          referenceMetadataUrl={referenceMetadataUrl}\r\n        />\r\n      )}\r\n    </Call>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DatasetDomain);","import React, {Fragment, useState} from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport {getNode, getNodes, getNodesAtDepth} from \"../../utils/tree\";\r\nimport {getDashboardDynamicFilterLabelTranslations} from \"../../constants/getDashboardDynamicFilterLabelTranslations\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  filter: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"bottom\",\r\n    marginRight: 16,\r\n    \"& label\": {\r\n      fontSize: 16\r\n    }\r\n  },\r\n  item: {\r\n    fontSize: 14\r\n  },\r\n  dialogContent: {\r\n    padding: \"8px !important\"\r\n  },\r\n});\r\n\r\nconst getLabelsMap = tree => {\r\n  const map = {};\r\n  getNodes(tree, \"children\", () => true).forEach(({id, name}) => map[id] = name);\r\n\r\n  return map;\r\n}\r\n\r\nfunction DashboardFilters(props) {\r\n  const {\r\n    classes,\r\n    filters,\r\n    selectValues,\r\n    setSelectValues,\r\n    lastValorizedIdx,\r\n    setLastValorizedIdx,\r\n    filterLevels,\r\n    onFilterApply\r\n  } = props;\r\n\r\n  const {\r\n    labels,\r\n    values\r\n  } = filters;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isApplyDisabled, setIsApplyDisable] = useState(false);\r\n\r\n  const [visibleId, setVisibleId] = useState(null);\r\n\r\n  const [labelsMap] = useState(getLabelsMap(values));\r\n\r\n  const handleFilterSelect = (dimension, value) => {\r\n    const newSelectedValues = {};\r\n    let found = false;\r\n    labels.forEach(label => {\r\n      if (!found) {\r\n        if (label !== dimension) {\r\n          newSelectedValues[label] = selectValues[label];\r\n        } else {\r\n          found = true;\r\n          newSelectedValues[label] = value;\r\n        }\r\n      } else {\r\n        newSelectedValues[label] = \"\";\r\n      }\r\n    })\r\n    setSelectValues(newSelectedValues);\r\n    setLastValorizedIdx(visibleId);\r\n    setVisibleId(null);\r\n    setIsApplyDisable(false);\r\n  };\r\n\r\n  let data = [];\r\n  if (visibleId !== null) {\r\n    data = visibleId === 0\r\n      ? values\r\n      : getNode(values, \"children\", ({id}) => id === selectValues[labels[visibleId - 1]]).children\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.root}>\r\n        {(() => {\r\n          const selects = [];\r\n\r\n          let lastLavorizableIdx = -1;\r\n          labels.forEach((label, idx) => {\r\n            if (filterLevels?.[labels[idx]] === true) {\r\n              lastLavorizableIdx = idx;\r\n            }\r\n          });\r\n\r\n          const getTextWidthEl = $('<span>').css({\r\n            visibility: 'hidden',\r\n            position: 'absolute',\r\n            fontSize: 16\r\n          }).appendTo('body').get(0);\r\n\r\n          for (let i = 0; i <= Math.min(lastValorizedIdx + 1, lastLavorizableIdx); i++) {\r\n            const label = labels[i];\r\n            const minWidth = getTextWidth(label, getTextWidthEl) + 32;\r\n\r\n            selects.push(\r\n              <div key={i} className={classes.filter}>\r\n                <FormControl style={{display: \"inline-block\", verticalAlign: \"bottom\"}}>\r\n                  <InputLabel>{getDashboardDynamicFilterLabelTranslations(t)[label]}</InputLabel>\r\n                  <Select\r\n                    open={false}\r\n                    style={{minWidth: minWidth}}\r\n                    value={selectValues[label] || \"\"}\r\n                    renderValue={value => labelsMap[value]}\r\n                    className={classes.item}\r\n                    onOpen={() => setVisibleId(i)}\r\n                  >\r\n                    {getNodesAtDepth(values, \"children\", (i + 1)).map(({id}, idx) =>\r\n                      <MenuItem key={idx} value={id}>{id}</MenuItem>\r\n                    )}\r\n                  </Select>\r\n                </FormControl>\r\n              </div>\r\n            );\r\n          }\r\n\r\n          $(getTextWidthEl).remove();\r\n\r\n          if (lastLavorizableIdx >= 0) {\r\n            selects.push(\r\n              <Button\r\n                key={labels.length}\r\n                onClick={() => {\r\n                  onFilterApply(selectValues[labels[lastValorizedIdx]]);\r\n                  setIsApplyDisable(true);\r\n                }}\r\n                disabled={isApplyDisabled || lastValorizedIdx < 0 || filterLevels?.[labels[lastValorizedIdx]] === false}\r\n              >\r\n                {t(\"commons.confirm.apply\")}\r\n              </Button>\r\n            );\r\n          }\r\n\r\n          return selects\r\n        })()}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={visibleId !== null}\r\n        onClose={() => setVisibleId(null)}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent className={classes.dialogContent}>\r\n          <InfiniteScrollTable\r\n            data={data}\r\n            getRowKey={({id}) => id}\r\n            showHeader={false}\r\n            columns={[\r\n              {\r\n                title: \"ID\",\r\n                dataIndex: \"id\",\r\n                minWidth: 100\r\n              },\r\n              {\r\n                title: \"Label\",\r\n                dataIndex: \"name\",\r\n                minWidth: 150\r\n              }\r\n            ]}\r\n            onRowClick={rowData => handleFilterSelect(labels[visibleId], rowData.id)}\r\n            getRowStyle={rowData => ({\r\n              background: rowData.id === selectValues[labels[visibleId]]\r\n                ? \"#fff9e5\"\r\n                : undefined\r\n            })}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setVisibleId(null)} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(DashboardFilters);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {\r\n  clearDashboardsDashboards,\r\n  downloadViewCsv,\r\n  fetchDashboardsDashboard,\r\n  fetchDashboardsDataset,\r\n  fetchDashboardsMapGeometries,\r\n  setDashboardsDatasetFetchEnableStatus\r\n} from \"../state/dashboard/dashboardActions\";\r\nimport Call from \"../hocs/call\";\r\nimport Dashboard from \"../components/dashboard\";\r\nimport filters from \"../dummy/filters.json\";\r\nimport DashboardFilters from \"../components/dashboard-filters\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../utils/dashboards\";\r\nimport _ from \"lodash\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport CustomEmpty from \"../components/custom-empty\";\r\nimport NodeHeader from \"../components/node-header\";\r\nimport {localizeI18nObj} from \"../utils/i18n\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {CRITERIA_FILTER_TYPE_CODES} from \"../utils/criteria\";\r\n\r\nconst styles = () => ({\r\n  root: {\r\n    backgroundColor: \"#f5f5f5\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n  },\r\n  fullWidthContainer: {\r\n    padding: 8,\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  commonsFilters: {\r\n    padding: \"16px 8px\"\r\n  },\r\n  dashboardHeader: {\r\n    padding: 8\r\n  },\r\n  dashboardTabs: {},\r\n  dashboardTitle: {\r\n    padding: \"8px 0\",\r\n    fontSize: 20,\r\n    fontWeight: 500\r\n  },\r\n  dashboard: {\r\n    overflow: \"auto\",\r\n    margin: \"0 8px\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub,\r\n  node: state.node,\r\n  nodeId: state.node?.nodeId,\r\n  catalog: state.catalog,\r\n  languages: state.app.languages,\r\n  defaultLanguage: state.app.language,\r\n  dashboards: state.dashboard.dashboards,\r\n  isFetchDatasetDisabled: state.dashboard.isFetchDatasetDisabled,\r\n  jsonStats: state.dashboard.jsonStats,\r\n  maps: state.dashboard.maps\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboard: dashboardId => dispatch(fetchDashboardsDashboard(dashboardId)),\r\n  clearDashboards: () => dispatch(clearDashboardsDashboards()),\r\n  setDatasetFetchEnableStatus: enabled => dispatch(setDashboardsDatasetFetchEnableStatus(enabled)),\r\n  fetchDataset: (dashboardId, nodeId, datasetId, criteria, requestIds) =>\r\n    dispatch(fetchDashboardsDataset(dashboardId, nodeId, datasetId, criteria, requestIds)),\r\n  fetchMapGeometries: (dashboardId, idList, requestId, t) => dispatch(fetchDashboardsMapGeometries(dashboardId, idList, requestId, t)),\r\n  downloadCsv: (nodeId, datasetId, viewTitle, criteria) => dispatch(downloadViewCsv(nodeId, datasetId, viewTitle, criteria)),\r\n});\r\n\r\nconst handleHeight = () => {\r\n  const nodeHeaderHeight = document.getElementById(\"node-header\")\r\n    ? document.getElementById(\"node-header\").offsetHeight\r\n    : 0;\r\n  const dashboardsHeaderHeight = document.getElementById(\"dashboards-domain_header\")\r\n    ? document.getElementById(\"dashboards-domain_header\").offsetHeight\r\n    : 0;\r\n  const dashboardsFiltersHeight = document.getElementById(\"dashboards-domain_filters\")\r\n    ? document.getElementById(\"dashboards-domain_filters\").offsetHeight\r\n    : 0;\r\n\r\n  if (document.getElementById(\"dashboards-domain\")) {\r\n    document.getElementById(\"dashboards-domain\").setAttribute(\"style\", `padding-top: ${nodeHeaderHeight}px`);\r\n  }\r\n\r\n  if (document.getElementById(\"dashboards-domain_dashboards\")) {\r\n    document.getElementById(\"dashboards-domain_dashboards\").setAttribute(\"style\", `height: calc(100% - ${dashboardsFiltersHeight + dashboardsHeaderHeight}px)`);\r\n  }\r\n};\r\n\r\nconst getIsFilterEnabled = dashboard => {\r\n  if (!dashboard) {\r\n    return false\r\n  }\r\n\r\n  let hasDynamicView = false;\r\n  dashboard.dashboardConfig.forEach(row => {\r\n    row.forEach(col => {\r\n      if ((col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || \"\").length > 0) {\r\n        hasDynamicView = true;\r\n      }\r\n    });\r\n  });\r\n\r\n  let lastLavorizableIdx = -1;\r\n  filters.labels.forEach((label, idx) => {\r\n    if (dashboard?.filterLevels?.[filters.labels[idx]] === true) {\r\n      lastLavorizableIdx = idx;\r\n    }\r\n  });\r\n\r\n  return (hasDynamicView && lastLavorizableIdx >= 0)\r\n};\r\n\r\nfunction DashboardsDomain(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    hub,\r\n    node,\r\n    nodeId,\r\n    nodeCode,\r\n    catalog,\r\n    dashboardId,\r\n    dashboards,\r\n    isFetchDatasetDisabled,\r\n    jsonStats,\r\n    maps,\r\n    fetchDashboard,\r\n    clearDashboards,\r\n    setDatasetFetchEnableStatus,\r\n    fetchDataset,\r\n    fetchMapGeometries,\r\n    downloadCsv\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [filterValue, setFilterValue] = useState(\"\");\r\n  const [selectValues, setSelectValues] = useState({});\r\n  const [lastValorizedIdx, setLastValorizedIdx] = useState(-1);\r\n\r\n  const [allowedDashboards, setAllowedDashboards] = useState(null);\r\n  const [currentDashboardId, setCurrentDashboardId] = useState(null);\r\n\r\n  const [fetchedDashboards, setFetchedDashboards] = useState(null);\r\n\r\n  const [tabIdx, setTabIdx] = useState(0);\r\n\r\n  // const {\r\n  //   labels\r\n  // } = filters;\r\n\r\n  useEffect(() => {\r\n    clearDashboards();\r\n    setFilterValue(\"\");\r\n  }, [clearDashboards, nodeId, dashboardId]);\r\n\r\n  useEffect(() => {\r\n    handleHeight();\r\n  }, [dashboards]);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", handleHeight);\r\n    return () => window.removeEventListener(\"resize\", handleHeight)\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (hub && (!nodeCode || (nodeId && node && catalog))) {\r\n\r\n      const nodeDashboards = nodeId ? (hub.nodes.find(node => node.nodeId === nodeId).dashboards || []) : [];\r\n      const hubDashboards = (hub.hub.dashboards || []);\r\n\r\n      setAllowedDashboards(dashboardId\r\n        ? [{id: dashboardId}]\r\n        : nodeId\r\n          ? hubDashboards.concat(nodeDashboards)\r\n          : hubDashboards\r\n      );\r\n    }\r\n  }, [hub, nodeId, nodeCode, node, catalog, dashboardId]);\r\n\r\n  useEffect(() => {\r\n    if (allowedDashboards && allowedDashboards.length > 0) {\r\n      const newCurrentDashboardId = dashboardId\r\n        ? dashboardId\r\n        : allowedDashboards[tabIdx].id\r\n          ? allowedDashboards[tabIdx].id\r\n          : null;\r\n      setCurrentDashboardId(newCurrentDashboardId);\r\n    }\r\n  }, [allowedDashboards, dashboardId, tabIdx]);\r\n\r\n  useEffect(() => {\r\n    if (allowedDashboards) {\r\n      const newFetchedDashboards = {};\r\n      allowedDashboards.forEach(({id}) => newFetchedDashboards[id] = {static: false, dynamic: false});\r\n      setFetchedDashboards(newFetchedDashboards);\r\n    }\r\n  }, [dashboards, allowedDashboards]);\r\n\r\n  const handleFilterApply = value => {\r\n    if (value !== filterValue) {\r\n      setFilterValue(value);\r\n      setDatasetFetchEnableStatus(true);\r\n\r\n      const newFetchedDashboard = _.cloneDeep(fetchedDashboards);\r\n      allowedDashboards.forEach(({id}) => newFetchedDashboard[id] = {...fetchedDashboards[id], dynamic: false});\r\n      setFetchedDashboards(newFetchedDashboard);\r\n    }\r\n  };\r\n\r\n  const handleFetchDatasets = ({dashboardId, fetchStatic, fetchDynamic, dynamicFilterValue}) => {\r\n\r\n    const newFetchedDashboards = _.cloneDeep(fetchedDashboards);\r\n    if (fetchStatic) {\r\n      newFetchedDashboards[dashboardId].static = true;\r\n    }\r\n    if (fetchDynamic && dynamicFilterValue) {\r\n      newFetchedDashboards[dashboardId].dynamic = true;\r\n    }\r\n    setFetchedDashboards(newFetchedDashboards);\r\n\r\n    const requests = [];\r\n    dashboards[dashboardId].dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n\r\n          const view = dashboards[dashboardId].views[col[DASHBOARD_ELEM_VALUE_KEY]];\r\n\r\n          let newCriteria = (view?.criteria || {});\r\n\r\n          let addRequest = false;\r\n\r\n          const filterDimension = col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY];\r\n\r\n          if (!filterDimension || filterDimension.length === 0) {\r\n            addRequest = fetchStatic;\r\n\r\n          } else {\r\n            if (fetchDynamic) {\r\n              addRequest = true;\r\n              if (dynamicFilterValue) {\r\n                newCriteria = {\r\n                  ...newCriteria,\r\n                  [filterDimension]: {\r\n                    ...newCriteria[filterDimension],\r\n                    id: filterDimension,\r\n                    type: CRITERIA_FILTER_TYPE_CODES,\r\n                    filterValues: [dynamicFilterValue]\r\n                  }\r\n                };\r\n              } else {\r\n                newCriteria = {\r\n                  ...newCriteria,\r\n                  [filterDimension]: {\r\n                    ...newCriteria[filterDimension],\r\n                    id: filterDimension,\r\n                    type: CRITERIA_FILTER_TYPE_CODES,\r\n                    filterValues: [filters.defaultFilterValue]\r\n                  }\r\n                };\r\n              }\r\n            }\r\n          }\r\n\r\n          if (addRequest) {\r\n            const request = requests.find(({nodeId, datasetId, criteria}) => {\r\n              return (\r\n                nodeId === view.nodeId &&\r\n                datasetId === view.datasetId &&\r\n                _.isEqual(criteria, newCriteria)\r\n              )\r\n            });\r\n\r\n            if (request === undefined) {\r\n              requests.push({\r\n                nodeId: view.nodeId,\r\n                datasetId: view.datasetId,\r\n                criteria: newCriteria,\r\n                requestIds: [getViewIdxFromRowAndCol(rowIdx, colIdx)]\r\n              });\r\n            } else {\r\n              request.requestIds.push(getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n    requests.forEach(({nodeId, datasetId, criteria, requestIds}) => fetchDataset(dashboardId, nodeId, datasetId, criteria, requestIds));\r\n  };\r\n\r\n  // const resetFilter = () => {\r\n  //   setFilterValue(\"\");\r\n  //   setSelectValues({});\r\n  //   setLastValorizedIdx(-1);\r\n  //   if (allowedDashboards) {\r\n  //     const newFetchedDashboards = {};\r\n  //     allowedDashboards.forEach(({id}) => newFetchedDashboards[id] = {static: fetchedDashboards[id].static, dynamic: false});\r\n  //     setFetchedDashboards(newFetchedDashboards);\r\n  //   }\r\n  // };\r\n\r\n  return (\r\n    <div key={dashboardId} className={classes.root}>\r\n      {nodeId\r\n        ? (\r\n          <NodeHeader\r\n            hub={hub.hub}\r\n            nodes={hub?.nodes}\r\n            node={node}\r\n            nodeId={nodeId}\r\n            shortName={node?.code}\r\n            title={node?.name}\r\n            catalog={catalog}\r\n            defaultNodeConfigOpen={props.defaultNodeConfigOpen}\r\n            defaultAppConfigOpen={props.defaultAppConfigOpen}\r\n            defaultUserConfigOpen={props.defaultUserConfigOpen}\r\n            defaultNodesConfigOpen={props.defaultNodesConfigOpen}\r\n          />\r\n        )\r\n        : (\r\n          <NodeHeader\r\n            noNode\r\n            hub={hub.hub}\r\n            nodes={hub.nodes}\r\n            defaultNodeConfigOpen={props.defaultNodeConfigOpen}\r\n            defaultAppConfigOpen={props.defaultAppConfigOpen}\r\n            defaultUserConfigOpen={props.defaultUserConfigOpen}\r\n            defaultNodesConfigOpen={props.defaultNodesConfigOpen}\r\n          />\r\n        )\r\n      }\r\n      <div className={classes.fullWidthContainer} id=\"dashboards-domain\">\r\n        {currentDashboardId\r\n          ? (\r\n            <Call\r\n              cb={fetchDashboard}\r\n              cbParam={currentDashboardId}\r\n              disabled={dashboards !== null && dashboards[currentDashboardId] !== null && dashboards[currentDashboardId] !== undefined}\r\n            >\r\n              {(() => {\r\n                return (\r\n                  <Call\r\n                    cb={handleFetchDatasets}\r\n                    cbParam={{\r\n                      dashboardId: currentDashboardId,\r\n                      fetchStatic: true,\r\n                      fetchDynamic: !filterValue,\r\n                      dynamicFilterValue: null\r\n                    }}\r\n                    disabled={!dashboards || !dashboards[currentDashboardId] || fetchedDashboards[currentDashboardId].static === true}\r\n                  >\r\n                    <Fragment>\r\n                      <div id=\"dashboards-domain_filters\">\r\n                        {(() => {\r\n                          const isEnable = getIsFilterEnabled(dashboards?.[currentDashboardId]);\r\n                          const FilterComponent = (\r\n                            <DashboardFilters\r\n                              filters={filters}\r\n                              selectValues={selectValues}\r\n                              setSelectValues={setSelectValues}\r\n                              lastValorizedIdx={lastValorizedIdx}\r\n                              setLastValorizedIdx={setLastValorizedIdx}\r\n                              filterLevels={dashboards?.[currentDashboardId] ? dashboards[currentDashboardId].filterLevels : null}\r\n                              onFilterApply={filterValue => handleFilterApply(filterValue)}\r\n                            />\r\n                          );\r\n\r\n                          if (dashboardId) {\r\n                            return isEnable && (\r\n                              <div className={classes.commonsFilters}>\r\n                                {FilterComponent}\r\n                              </div>\r\n                            )\r\n                          } else {\r\n                            return (\r\n                              <div className={classes.commonsFilters} style={{height: 77}}>\r\n                                {FilterComponent}\r\n                              </div>\r\n                            )\r\n                          }\r\n                        })()}\r\n                      </div>\r\n                      {(() => {\r\n                        if (dashboards?.[currentDashboardId]) {\r\n\r\n                          let newFilterValue = filterValue;\r\n\r\n                          // if (lastValorizedIdx >= 0 && dashboards[currentDashboardId].filterLevels && dashboards[currentDashboardId].filterLevels?.[labels[lastValorizedIdx]] === false) {\r\n                          //   newFilterValue = \"\";\r\n                          //   resetFilter();\r\n                          // }\r\n\r\n                          return (\r\n                            <Call\r\n                              cb={handleFetchDatasets}\r\n                              cbParam={{\r\n                                dashboardId: currentDashboardId,\r\n                                fetchStatic: false,\r\n                                fetchDynamic: !!newFilterValue,\r\n                                dynamicFilterValue: newFilterValue\r\n                              }}\r\n                              disabled={isFetchDatasetDisabled || fetchedDashboards[currentDashboardId].dynamic === true || fetchedDashboards[currentDashboardId].static !== true}\r\n                            >\r\n                              <Fragment>\r\n                                <div id=\"dashboards-domain_header\" className={classes.dashboardHeader}>\r\n                                  {(allowedDashboards.length > 1)\r\n                                    ? (\r\n                                      <AppBar\r\n                                        position=\"static\"\r\n                                        color=\"default\"\r\n                                        className={classes.dashboardTabs}\r\n                                      >\r\n                                        <Tabs\r\n                                          value={tabIdx}\r\n                                          variant=\"scrollable\"\r\n                                          scrollButtons=\"auto\"\r\n                                          indicatorColor=\"primary\"\r\n                                          textColor=\"primary\"\r\n                                          onChange={(_, newValue) => setTabIdx(newValue)}\r\n                                        >\r\n                                          {allowedDashboards.map(({id, title}, idx) =>\r\n                                            <Tab key={idx} label={title}/>\r\n                                          )}\r\n                                        </Tabs>\r\n                                      </AppBar>\r\n                                    )\r\n                                    : (\r\n                                      <div className={classes.dashboardTitle}>\r\n                                        {localizeI18nObj(dashboards[currentDashboardId].title, defaultLanguage, languages)}\r\n                                      </div>\r\n                                    )\r\n                                  }\r\n                                </div>\r\n                                <div\r\n                                  id=\"dashboards-domain_dashboards\"\r\n                                  className={classes.dashboard}\r\n                                >\r\n                                  {dashboards[currentDashboardId] && (\r\n                                    <Dashboard\r\n                                      key={currentDashboardId}\r\n                                      dashboard={dashboards[currentDashboardId]}\r\n                                      filterValue={filterValue}\r\n                                      jsonStats={(jsonStats && jsonStats[currentDashboardId]) ? jsonStats[currentDashboardId] : null}\r\n                                      maps={maps ? maps[currentDashboardId] : null}\r\n                                      fetchMapGeometries={(idList, requestId) => fetchMapGeometries(currentDashboardId, idList, requestId, t)}\r\n                                      downloadCsv={downloadCsv}\r\n                                    />\r\n                                  )}\r\n                                </div>\r\n                              </Fragment>\r\n                            </Call>\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </Fragment>\r\n                  </Call>\r\n                )\r\n              })()}\r\n            </Call>\r\n          )\r\n          : (\r\n            <CustomEmpty\r\n              text={nodeId\r\n                ? t(\"scenes.dashboard.noDashboard.node\")\r\n                : t(\"scenes.dashboard.noDashboard.hub\")\r\n              }\r\n            />\r\n          )\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withStyles(styles)\r\n)(DashboardsDomain);","import React, {Fragment, useEffect} from 'react';\r\nimport {Route, Switch} from \"react-router\";\r\nimport Node from \"../components/node\";\r\nimport {fetchNode} from \"../state/node/nodeActions\";\r\nimport {fetchCatalog} from \"../state/catalog/catalogActions\";\r\nimport Results from \"../components/results\";\r\nimport DatasetDomain from \"./DatasetDomain\";\r\nimport {connect} from \"react-redux\";\r\nimport DashboardsDomain from \"./DashboardsDomain\";\r\nimport {goToNode} from \"../links\";\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub,\r\n  node: state.node,\r\n  catalog: state.catalog\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchNode: nodeId => dispatch(fetchNode(nodeId)),\r\n  fetchCatalog: nodeId => dispatch(fetchCatalog(nodeId))\r\n});\r\n\r\nconst NodeDomain = ({hub, nodeCode, node, catalog, fetchNode, fetchCatalog}) => {\r\n\r\n  useEffect(() => {\r\n\r\n    // TODO: check if catalog is null\r\n    if (hub && (!node || nodeCode.toLowerCase() !== node.code.toLowerCase())) {\r\n      const nodeHavingCode = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n      if (nodeHavingCode) {\r\n        fetchNode(nodeHavingCode.nodeId);\r\n        fetchCatalog(nodeHavingCode.nodeId);\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [hub, nodeCode, node]);\r\n\r\n\r\n  const Recursive = ({path, match}) =>\r\n    <Switch>\r\n      <Route\r\n        exact\r\n        path={match.url}\r\n        render={({location}) => {\r\n\r\n          const viewParam = new URLSearchParams(location.search).get(\"view\");\r\n          const a11yParam = new URLSearchParams(location.search).get(\"accessible\");\r\n\r\n          // short url for categorized dataset\r\n          if (path.length === 1 && catalog.datasets[path[0]]) {\r\n            return (\r\n              <DatasetDomain\r\n                hub={hub}\r\n                node={node}\r\n                nodeCode={nodeCode}\r\n                catalog={catalog}\r\n                categoryPath={[]}\r\n                datasetId={path[0]}\r\n                datasetTitle={catalog.datasets[path[0]].title}\r\n                notes={catalog.datasets[path[0]]?.note}\r\n                attachedFiles={catalog.datasets[path[0]]?.attachedDataFiles}\r\n                referenceMetadataUrl={catalog.datasets[path[0]]?.referenceMetadata}\r\n                viewId={viewParam || undefined}\r\n                isAccessible={!!a11yParam}\r\n              />\r\n            );\r\n\r\n            // short url for uncategorized dataset\r\n          } else if (path.length === 1 && catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[0])) {\r\n\r\n            const dataset = catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[0]);\r\n\r\n            return (\r\n              <DatasetDomain\r\n                hub={hub}\r\n                node={node}\r\n                nodeCode={nodeCode}\r\n                catalog={catalog}\r\n                categoryPath={[]}\r\n                datasetId={path[0]}\r\n                datasetTitle={dataset.title}\r\n                notes={dataset?.note}\r\n                attachedFiles={dataset?.attachedDataFiles}\r\n                referenceMetadataUrl={dataset?.referenceMetadata}\r\n                viewId={viewParam || undefined}\r\n                isAccessible={!!a11yParam}\r\n              />\r\n            );\r\n          } else if (path.length > 0 && path[0] === \"uncategorized\" &&\r\n            catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0) {\r\n\r\n            if (path.length === 1) {\r\n              return (\r\n                <Results\r\n                  hub={hub}\r\n                  node={node}\r\n                  nodeCode={nodeCode}\r\n                  catalog={catalog}\r\n                  categoryPath={path}\r\n                  datasets={catalog.uncategorizedDatasets.map(ds => ({\r\n                    ...ds,\r\n                    categoryPath: path\r\n                  }))}\r\n                />\r\n              );\r\n\r\n            } else if (path.length === 2) {\r\n\r\n              const dataset = catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[1]);\r\n\r\n              if (dataset) {\r\n                return (\r\n                  <DatasetDomain\r\n                    hub={hub}\r\n                    node={node}\r\n                    nodeCode={nodeCode}\r\n                    catalog={catalog}\r\n                    categoryPath={path.slice(0, -1)}\r\n                    datasetId={dataset.identifier}\r\n                    datasetTitle={dataset.title}\r\n                    notes={dataset?.note}\r\n                    attachedFiles={dataset?.attachedDataFiles}\r\n                    referenceMetadataUrl={dataset?.referenceMetadata}\r\n                    isAccessible={!!a11yParam}\r\n                  />\r\n                );\r\n              }\r\n\r\n            }\r\n          } else if (catalog.categoryGroups.length > 0) {\r\n\r\n            const getDatasetsIdsAndSubcategoriesOrDatasetId = (categoryPath = [], categories = [], datasetsIds = []) => {\r\n\r\n              if (categoryPath.length > 0) {\r\n\r\n                if (categoryPath.length === 1) {\r\n\r\n                  const datasetId = datasetsIds.find(id => id === categoryPath[0]);\r\n\r\n                  if (datasetId) {\r\n                    return datasetId;\r\n                  } else {\r\n\r\n                    const lastCategory = categories.find(({id}) => id === categoryPath[0]);\r\n                    if (lastCategory) {\r\n                      return {\r\n                        datasetIds: lastCategory.datasetIdentifiers,\r\n                        subCategories: lastCategory.categories || lastCategory.childrenCategories\r\n                      }\r\n                    }\r\n\r\n                  }\r\n\r\n                } else {\r\n                  const nextCategory = categories.find(({id}) => id === categoryPath[0]);\r\n\r\n                  if (nextCategory) {\r\n                    return getDatasetsIdsAndSubcategoriesOrDatasetId(categoryPath.slice(1), nextCategory.categories || nextCategory.childrenCategories, nextCategory.datasetIdentifiers);\r\n                  }\r\n                }\r\n              }\r\n\r\n              return null;\r\n            };\r\n\r\n            const datasetsIdsOrDatasetId = getDatasetsIdsAndSubcategoriesOrDatasetId(\r\n              path,\r\n              catalog.categoryGroups.length === 1 ? catalog.categoryGroups[0].categories : catalog.categoryGroups,\r\n              []\r\n            );\r\n\r\n            if (datasetsIdsOrDatasetId?.datasetIds) {\r\n              return (\r\n                <Results\r\n                  hub={hub}\r\n                  node={node}\r\n                  nodeCode={nodeCode}\r\n                  catalog={catalog}\r\n                  categoryPath={path}\r\n                  datasets={datasetsIdsOrDatasetId.datasetIds.map(id => ({\r\n                    ...catalog.datasets[id],\r\n                    identifier: id,\r\n                    categoryPath: path\r\n                  }))} subCategories={datasetsIdsOrDatasetId.subCategories}\r\n                />\r\n              );\r\n\r\n            } else if (datasetsIdsOrDatasetId) {\r\n              return (\r\n                <DatasetDomain\r\n                  hub={hub}\r\n                  node={node}\r\n                  nodeCode={nodeCode}\r\n                  catalog={catalog}\r\n                  categoryPath={path.slice(0, -1)}\r\n                  datasetId={datasetsIdsOrDatasetId}\r\n                  datasetTitle={catalog.datasets[datasetsIdsOrDatasetId].title}\r\n                  notes={catalog.datasets[datasetsIdsOrDatasetId]?.note}\r\n                  attachedFiles={catalog.datasets[datasetsIdsOrDatasetId]?.attachedDataFiles}\r\n                  referenceMetadataUrl={catalog.datasets[datasetsIdsOrDatasetId]?.referenceMetadata}\r\n                  isAccessible={!!a11yParam}\r\n                />\r\n              );\r\n            } else {\r\n              goToNode(nodeCode);\r\n            }\r\n          }\r\n\r\n          goToNode(nodeCode);\r\n        }}\r\n      />\r\n      <Route\r\n        path={`${match.url}/:categoryId`}\r\n        render={({match}) => <Recursive match={match} path={[...path, match.params.categoryId]}/>}\r\n      />\r\n    </Switch>;\r\n\r\n  return (\r\n    <Fragment>\r\n      <Switch>\r\n        <Route\r\n          exact\r\n          path='/:lang/:nodeCode'\r\n          render={props => (\r\n            <Node\r\n              {...props}\r\n              nodeCode={nodeCode}\r\n              hub={hub}\r\n              node={node}\r\n              catalog={catalog}\r\n            />\r\n          )}\r\n        />\r\n        <Route\r\n          exact\r\n          path={['/:lang/:nodeCode/dashboards', '/:nodeCode/dashboards']}\r\n          render={() => (\r\n            <DashboardsDomain\r\n              nodeCode={nodeCode}\r\n            />\r\n          )}\r\n        />\r\n        {node && catalog && node.code.toLowerCase() === nodeCode.toLowerCase() && node.nodeId === catalog.nodeId && (\r\n          <Route\r\n            path='/:lang/:nodeCode/search'\r\n            render={({location}) => {\r\n              const query = new URLSearchParams(location.search).get(\"q\");\r\n              const filtersParams =\r\n                (new URLSearchParams(location.search).get(\"c\") || \"\")\r\n                  .split(\"//\").filter(str => str.length > 0).map(decodeURIComponent)\r\n                  .map(filter => filter.split(\"/\")).filter(path => path.length > 0);\r\n\r\n              let filters = [];\r\n              filtersParams.forEach(filter => filter.forEach(id => filters.push(id)));\r\n              filters = [...new Set(filters)]; // remove duplicates\r\n\r\n              if (query && query.length > 0) {\r\n\r\n                const testDSForQuery = ds =>\r\n                  (ds.title || \"\").toLowerCase().includes(query.toLowerCase()) ||\r\n                  !!ds.keywords?.find(keyword => keyword.toLowerCase().includes(query.toLowerCase()));\r\n\r\n                const testCatForFilters = cat => filters.length === 0 || filters.includes(cat.id);\r\n\r\n                const dssForCount = [];   // satisfy only query (necessary to display count numbers)\r\n                const dssForResults = []; // satisfy query and filters\r\n\r\n                if (catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0) {\r\n                  catalog.uncategorizedDatasets.forEach(ds => {\r\n\r\n                    ds.categoryPath = [\"uncategorized\"];\r\n\r\n                    if (testDSForQuery(ds)) {\r\n                      dssForCount.push(ds);\r\n                      if (filters.length === 0 || filters.includes(\"uncategorized\")) {\r\n                        dssForResults.push(ds);\r\n                      }\r\n                    }\r\n                  });\r\n                }\r\n\r\n                const searchRecursive = (categories, categoryPath, overrideCatSatisfyFilters = false) => {\r\n\r\n                  categories.forEach(c => {\r\n\r\n                    const catSatisfyFilters = overrideCatSatisfyFilters || testCatForFilters(c);\r\n\r\n                    c.datasetIdentifiers.forEach(id => {\r\n                      const ds = {\r\n                        ...catalog.datasets[id],\r\n                        identifier: id,\r\n                        categoryPath: [...categoryPath, c.id]\r\n                      };\r\n                      if (testDSForQuery(ds)) {\r\n                        dssForCount.push(ds);\r\n                        if (catSatisfyFilters) {\r\n                          dssForResults.push(ds);\r\n                        }\r\n                      }\r\n                    });\r\n\r\n                    searchRecursive(c.childrenCategories, [...categoryPath, c.id], catSatisfyFilters);\r\n                  });\r\n                };\r\n\r\n                if (catalog.categoryGroups.length > 1) {\r\n                  // with category schemes\r\n                  catalog.categoryGroups.forEach(group => searchRecursive(group.categories, [group.id]));\r\n                } else if (catalog.categoryGroups.length === 1) {\r\n                  // no category schemes\r\n                  searchRecursive(catalog.categoryGroups[0].categories, []);\r\n                }\r\n\r\n                const dssSatisfyQueryMap = {};\r\n                dssForCount.forEach(ds => dssSatisfyQueryMap[ds.identifier] = ds);\r\n\r\n                const recursiveCountAndFilterZero = tree => tree.map(node => {\r\n\r\n                  const children = recursiveCountAndFilterZero(node.childrenCategories || node.categories).filter(({count}) => count > 0);\r\n\r\n                  return ({\r\n                    ...node,\r\n                    childrenCategories: node.childrenCategories ? children : undefined,\r\n                    categories: node.categories ? children : undefined,\r\n                    count:\r\n                      children.reduce((acc, node) => acc + node.count, 0) +\r\n                      (node.datasetIdentifiers?.filter(dsId => dssSatisfyQueryMap[dsId] !== undefined).length || 0)\r\n                  });\r\n                }).filter(({count}) => count > 0);\r\n\r\n                const categoryGroupsWithCount = recursiveCountAndFilterZero(catalog.categoryGroups);\r\n\r\n                const uncategorizedDatasetsCount = catalog.uncategorizedDatasets.filter(({identifier}) => dssSatisfyQueryMap[identifier] !== undefined).length;\r\n\r\n                // remove duplicates from results ( O(2n) )\r\n                const resultsMap = {};\r\n                dssForResults.forEach(ds => resultsMap[ds.identifier] = ds);\r\n\r\n                return (\r\n                  <Results\r\n                    query={query}\r\n                    filters={filtersParams}\r\n                    filtered\r\n                    hub={hub}\r\n                    node={node}\r\n                    nodeCode={nodeCode}\r\n                    catalog={catalog}\r\n                    datasets={Object.keys(resultsMap).map(id => resultsMap[id])}\r\n                    categoryGroupsWithCount={categoryGroupsWithCount}\r\n                    uncategorizedDatasetsCount={uncategorizedDatasetsCount}\r\n                  />\r\n                );\r\n              } else {\r\n                goToNode(nodeCode);\r\n              }\r\n            }}\r\n          />\r\n        )}\r\n        {node && catalog && node.code.toLowerCase() === nodeCode.toLowerCase() && node.nodeId === catalog.nodeId && (\r\n          <Route\r\n            path='/:lang/:nodeCode/:path'\r\n            render={({match}) => (\r\n              <Recursive match={match} path={[match.params.path]}/>\r\n            )}\r\n          />\r\n        )}\r\n      </Switch>\r\n    </Fragment>\r\n  )\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(NodeDomain);","import {useEffect} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport {setAppLanguage} from \"../state/app/appActions\";\r\nimport {useLocation} from \"react-router\";\r\nimport {goToHome} from \"../links\";\r\n\r\nconst mapStateToProps = state => ({\r\n  appLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  node: state.node\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  setAppLanguage: (language, nodeId) => dispatch(setAppLanguage(language, nodeId)),\r\n});\r\n\r\nconst MultiLanguageDomain = ({language, languages, appLanguage, setAppLanguage, children, node}) => {\r\n\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    if (appLanguage !== language && languages.includes(language)) {\r\n      setAppLanguage(language, node ? node.nodeId : null);\r\n    } else if (!languages.includes(language)) {\r\n      goToHome(true);\r\n    }\r\n  }, [language, languages, setAppLanguage, appLanguage, node, location.pathname]);\r\n\r\n  return (appLanguage === language && languages.includes(language))\r\n    ? children\r\n    : null;\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MultiLanguageDomain);\r\n","export const APP_LANGUAGE_SET = \"app/languageSet\";\r\n\r\nexport const setAppLanguage = (language: string, nodeId: number) => ({\r\n  type: APP_LANGUAGE_SET,\r\n  payload: {\r\n    language,\r\n    nodeId\r\n  }\r\n});\r\n","import React, {Fragment, useEffect} from 'react';\r\nimport {Route, Switch} from \"react-router\";\r\nimport Home from \"../components/home\";\r\nimport {connect} from \"react-redux\";\r\nimport {fetchHub} from \"../state/hub/hubActions\";\r\nimport NodeDomain from \"./NodeDomain\";\r\nimport {HashRouter} from \"react-router-dom\";\r\nimport DashboardsDomain from \"./DashboardsDomain\";\r\nimport {goToHome} from \"../links\";\r\nimport Call from \"../hocs/call\";\r\nimport MultiLanguageDomain from \"./MultiLanguageDomain\";\r\nimport {showUserSetPasswordForm} from \"../state/user/userActions\";\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub,\r\n  defaultLanguage: state.app.language\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchHub: () => dispatch(fetchHub()),\r\n  onUserSetPasswordFormShow: token => dispatch(showUserSetPasswordForm(token))\r\n});\r\n\r\nconst HubDomain = ({hub, fetchHub, onUserSetPasswordFormShow}) => {\r\n\r\n  useEffect(() => {\r\n    if (!hub) {\r\n      fetchHub();\r\n    }\r\n  }, [hub, fetchHub]);\r\n\r\n  return (\r\n    <Fragment>\r\n      {hub && (\r\n        <HashRouter>\r\n          <Switch>\r\n            <Route\r\n              path='/'\r\n              exact\r\n              render={props => (\r\n                <Home {...props}/>\r\n              )}\r\n            />\r\n            <Route\r\n              path='/:lang'\r\n              exact\r\n              render={props => (\r\n                <MultiLanguageDomain language={props.match.params.lang}>\r\n                  <Home {...props}/>\r\n                </MultiLanguageDomain>\r\n              )}\r\n            />\r\n            <Route\r\n              path='/:lang/dashboards'\r\n              exact\r\n              render={props => (\r\n                <MultiLanguageDomain language={props.match.params.lang}>\r\n                  <DashboardsDomain {...props}/>\r\n                </MultiLanguageDomain>\r\n              )}\r\n            />\r\n            <Route\r\n              path='/:lang/dashboards/:dashboardId'\r\n              render={props => (\r\n                <MultiLanguageDomain language={props.match.params.lang}>\r\n                  <DashboardsDomain {...props} dashboardId={props.match.params.dashboardId}/>\r\n                </MultiLanguageDomain>\r\n              )}\r\n            />\r\n            <Route\r\n              path='/:lang/resetPassword'\r\n              render={props => {\r\n                const tokenParam = new URLSearchParams(props.location.search).get(\"token\");\r\n                if (tokenParam) {\r\n                  return (\r\n                    <MultiLanguageDomain language={props.match.params.lang}>\r\n                      <Call cb={onUserSetPasswordFormShow} cbParam={tokenParam}>\r\n                        <Home {...props}/>\r\n                      </Call>\r\n                    </MultiLanguageDomain>\r\n                  );\r\n                } else {\r\n                  goToHome();\r\n                }\r\n              }}\r\n            />\r\n            <Route\r\n              path='/:lang/:nodeCode'\r\n              render={props => {\r\n                if (hub.nodes.find(({code}) => code.toLowerCase() === props.match.params.nodeCode.toLowerCase())) {\r\n                  return (\r\n                    <MultiLanguageDomain language={props.match.params.lang}>\r\n                      <NodeDomain {...props} nodeCode={props.match.params.nodeCode}/>\r\n                    </MultiLanguageDomain>\r\n                  );\r\n                } else {\r\n                  goToHome();\r\n                }\r\n              }}\r\n            />\r\n          </Switch>\r\n        </HashRouter>\r\n      )}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(HubDomain);\r\n","import React from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport {DialogActions} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {closeDeleteConflictModal} from \"../../state/delete-conflict-modal/deleteConflictModalActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst getObjectTranslation = t => ({\r\n  dashboard: t(\"components.deleteConflictModal.objectType.dashboard\"),\r\n  view: t(\"components.deleteConflictModal.objectType.view\"),\r\n  node: t(\"components.deleteConflictModal.objectType.node\"),\r\n});\r\n\r\nconst DeleteConflictModal = ({\r\n                               response,\r\n                               onClose,\r\n                               onForce\r\n                             }) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={!!response}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n      onClose={onClose}\r\n    >\r\n      <DialogTitle>\r\n        {t(\"components.deleteConflictModal.title\")}\r\n      </DialogTitle>\r\n      {response?.usedBy?.length > 0 && (\r\n        <DialogContent>\r\n          {onForce\r\n            ? <p>{t(\"components.deleteConflictModal.contentTitleWithForce\")}</p>\r\n            : <p>{t(\"components.deleteConflictModal.contentTitle\")}</p>\r\n          }\r\n          <div>\r\n            {response.usedBy.map(({type, title, id}, index) =>\r\n              <ul key={index}>{getObjectTranslation(t)[type]} {id} - {title}</ul>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      )}\r\n      <DialogActions>\r\n        <Button onClick={onClose}>\r\n          {t(\"commons.confirm.close\")}\r\n        </Button>\r\n        {onForce && (\r\n          <Button onClick={onForce}>\r\n            {t(\"components.deleteConflictModal.force\")}\r\n          </Button>\r\n        )}\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default connect(\r\n  state => ({\r\n    response: state.deleteConflictModal.response\r\n  }),\r\n  dispatch => ({\r\n    onClose: () => dispatch(closeDeleteConflictModal())\r\n  })\r\n)(DeleteConflictModal);","export const DELETE_CONFLICT_MODAL_CLOSE = \"deleteConflictModal/close\";\r\n\r\nexport const closeDeleteConflictModal = () => ({\r\n    type: DELETE_CONFLICT_MODAL_CLOSE\r\n});","import React from 'react';\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {goToHome} from \"../../links\";\r\n\r\nconst styles = theme => ({\r\n  container: {\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    height: \"100%\",\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    overflow: \"hidden\",\r\n    fontSize: 24\r\n  },\r\n  icon: {\r\n    marginBottom: theme.spacing(1),\r\n    fontSize: 38\r\n  },\r\n  goHome: {\r\n    marginTop: theme.spacing(2),\r\n    textDecoration: \"underline\",\r\n    cursor: \"pointer\",\r\n    color: theme.palette.secondary.main\r\n  }\r\n});\r\n\r\nclass ErrorBoundary extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {hasError: false};\r\n  }\r\n\r\n  componentDidCatch(error, info) {\r\n    this.setState({hasError: true});\r\n  }\r\n\r\n  render() {\r\n\r\n    const {classes} = this.props;\r\n\r\n    if (this.state.hasError) {\r\n\r\n      return (\r\n        <div className={classes.container} style={{color: \"white\"}}>\r\n          <div>\r\n            <Grid container justify=\"center\" className={classes.icon}>\r\n              <Grid item>\r\n                <ErrorOutlineIcon fontSize=\"inherit\"/>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container justify=\"center\">\r\n              <Grid item>\r\n                Something went wrong\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container justify=\"center\" className={classes.goHome}>\r\n              <Grid item>\r\n                <div onClick={() => {\r\n                  goToHome();\r\n                  window.location.reload();\r\n                }}>\r\n                  Go to home\r\n                </div>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        </div>\r\n      );\r\n\r\n    } else {\r\n      return this.props.children;\r\n    }\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(ErrorBoundary);","import React, {forwardRef, Fragment, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\nimport {setUserPassword} from \"../../../state/user/userActions\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch} = useForm();\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showPasswordConfirm, setShowPasswordConfirm] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        onSubmit(val);\r\n        f(val);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"email\"\r\n            label={t(\"components.userSetPasswordDialog.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowPassword(!showPassword)}\r\n                  >\r\n                    {showPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"password\"\r\n            label={t(\"components.userSetPasswordDialog.fields.password\")}\r\n            error={!!errors.password}\r\n            helperText={errors.password?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showPassword ? undefined : \"password\"}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowPassword(!showPassword)}\r\n                  >\r\n                    {showPassword ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n            inputProps={{\r\n              autoComplete: \"new-password\"\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"passwordConfirm\"\r\n            label={t(\"components.userSetPasswordDialog.fields.passwordConfirm\")}\r\n            error={!!errors.passwordConfirm}\r\n            helperText={errors.passwordConfirm?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            type={showPasswordConfirm ? undefined : \"password\"}\r\n            inputRef={\r\n              register({\r\n                required: t(\"commons.validation.required\"),\r\n                validate: val =>\r\n                  val === watch('password') ||\r\n                  t(\"components.userSetPasswordDialog.validation.passwordMustBeEqual\")\r\n              })}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    onClick={() => setShowPasswordConfirm(!showPasswordConfirm)}\r\n                  >\r\n                    {showPasswordConfirm ? <Visibility/> : <VisibilityOff/>}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              )\r\n            }}\r\n            inputProps={{\r\n              autoComplete: \"new-password\"\r\n            }}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  sendConfig: (token, config) => dispatch(setUserPassword(config.email, token, config.password)),\r\n});\r\n\r\nconst UserSetPasswordForm = ({config, token, sendConfig, userErrors}, ref) => {\r\n\r\n  return (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>)\r\n      )}\r\n      <Form\r\n        ref={ref}\r\n        onSubmit={config => sendConfig(token, config)}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserSetPasswordForm);\r\n","import React, {useRef} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport UserSetPasswordForm from \"./user-set-password-form\";\r\nimport {hideUserSetPasswordForm} from \"../../state/user/userActions\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onClose: () => dispatch(hideUserSetPasswordForm())\r\n});\r\n\r\nconst UserSetPasswordDialog = ({user, onClose}) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const setPasswordFormRef = useRef();\r\n\r\n  return (\r\n    <SettingsDialog\r\n      title={t(\"components.userSetPasswordDialog.title\")}\r\n      maxWidth={\"xs\"}\r\n      open={user.isSetPasswordDialogOpen || false}\r\n      onClose={() => {\r\n        if (setPasswordFormRef.current) {\r\n          setPasswordFormRef.current.cancel(() => {\r\n            onClose();\r\n          });\r\n        } else {\r\n          onClose();\r\n        }\r\n      }}\r\n      onSubmit={() => {\r\n        if (setPasswordFormRef.current) {\r\n          setPasswordFormRef.current.submit(() => {\r\n          });\r\n        }\r\n      }}\r\n      hasSubmit\r\n      noMinHeight\r\n    >\r\n      <UserSetPasswordForm ref={setPasswordFormRef} token={user.setPasswordToken}/>\r\n    </SettingsDialog>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserSetPasswordDialog);\r\n","import React, {useEffect, useState} from 'react';\r\nimport {ThemeProvider} from \"@material-ui/core/styles\";\r\nimport {createMuiTheme} from \"@material-ui/core\";\r\nimport colorString from \"color-string\";\r\n\r\nconst defaultTheme = {\r\n  palette: {\r\n    text: {\r\n      primary: \"#00295a\"\r\n    },\r\n    primary: {\r\n      main: \"#00295a\",\r\n      light: \"#3b5187\",\r\n      dark: \"#000030\",\r\n      contrastText: \"#ffffff\"\r\n    },\r\n    secondary: {\r\n      main: \"#f8a81e\",\r\n      light: \"#ffd956\",\r\n      dark: \"#c07900\",\r\n      contrastText: \"#00295a\"\r\n    }\r\n  }\r\n};\r\n\r\nconst CUSTOM_CSS_SELECTOR_PREFIX = \".theme__\";\r\nconst CUSTOM_CSS_SELECTOR_PATH_SPLIT_CHAR = \"-\";\r\n\r\nconst AppTheme = ({children}) => {\r\n\r\n  const [theme, setTheme] = useState(undefined);\r\n\r\n  useEffect(() => {\r\n\r\n    // custom.css can be used to apply colors in the mui theme.\r\n    // any color in the following \"theme object\" can be changed:\r\n    // https://material-ui.com/customization/default-theme/#default-theme\r\n    //\r\n    // just put a css rule in custom.css like this:\r\n    // .theme__palette-error-main { color: #FF0000 }\r\n    //\r\n    // each selector must start with \".theme__\" and continue with the path in the \"theme object\"\r\n    // the properties in the path must be separated by \"-\".\r\n    // if the selector don't follow these rules, it will be discarded.\r\n    // other rules different from color (e.g. fontSize) cannot be changed and will be discarded.\r\n\r\n    fetch('./custom.css')\r\n      .then(response => response.text())\r\n      .then(css => {\r\n\r\n        const doc = document.implementation.createHTMLDocument(\"\");\r\n        const styleEl = document.createElement(\"style\");\r\n        styleEl.textContent = String(css);\r\n        doc.body.appendChild(styleEl);\r\n\r\n        const customTheme = {};\r\n\r\n        Object.values(styleEl.sheet.cssRules)\r\n          .filter(({selectorText, style}) =>\r\n            selectorText.startsWith(CUSTOM_CSS_SELECTOR_PREFIX) &&\r\n            style[0] === \"color\" &&\r\n            style.color.length > 0 &&\r\n            colorString.get.rgb(style.color) !== null\r\n          )\r\n          .forEach(({selectorText, style}) => {\r\n\r\n            const path =\r\n              selectorText\r\n                .substr(CUSTOM_CSS_SELECTOR_PREFIX.length)\r\n                .split(CUSTOM_CSS_SELECTOR_PATH_SPLIT_CHAR);\r\n\r\n            let pointer = customTheme;\r\n            path.forEach((prop, index) => {\r\n              if (index === path.length - 1) {\r\n                pointer[prop] = colorString.to.rgb(colorString.get.rgb(style.color));\r\n              } else {\r\n                if (!pointer[prop]) {\r\n                  pointer[prop] = {};\r\n                }\r\n                pointer = pointer[prop];\r\n              }\r\n            });\r\n          });\r\n\r\n        setTheme(createMuiTheme({\r\n          ...defaultTheme,\r\n          ...customTheme\r\n        }));\r\n      });\r\n\r\n  }, [])\r\n\r\n  return theme\r\n    ? (\r\n      <ThemeProvider theme={theme}>\r\n        {children}\r\n      </ThemeProvider>\r\n    )\r\n    : null;\r\n};\r\n\r\nexport default AppTheme;","import React from 'react';\r\nimport {CssBaseline} from \"@material-ui/core\";\r\nimport NotImplementedSnackbar from \"./components/not-implemented-snackbar/NotImplementedSnackbar\";\r\nimport Spinner from \"./components/spinner/Spinner\";\r\nimport ErrorSnackbar from \"./components/error-snackbar/ErrorSnackbar\";\r\nimport HubDomain from \"./domains/HubDomain\";\r\nimport Helmet from \"react-helmet\";\r\nimport {connect} from \"react-redux\";\r\nimport DeleteConflictModal from \"./components/delete-conflict-modal\";\r\nimport ErrorBoundary from \"./components/error-boundary\";\r\nimport UserSetPasswordDialog from \"./components/user-set-password-dialog\";\r\nimport AppTheme from \"./components/app-theme\";\r\n\r\nconst App = ({language}) =>\r\n  <AppTheme>\r\n    <Helmet>\r\n      <html lang={language}/>\r\n    </Helmet>\r\n    <CssBaseline/>\r\n    <ErrorBoundary>\r\n      <Spinner>\r\n        <NotImplementedSnackbar/>\r\n        <ErrorSnackbar/>\r\n        <DeleteConflictModal/>\r\n        <UserSetPasswordDialog/>\r\n        <HubDomain/>\r\n      </Spinner>\r\n    </ErrorBoundary>\r\n  </AppTheme>;\r\n\r\nexport default connect(state => ({\r\n  language: state.app.language\r\n}))(App);","import {Reducer} from \"@reduxjs/toolkit\";\r\nimport {IHub} from \"../../model/IHub\";\r\nimport {IHubMinimalNode} from \"../../model/IHubMinimalNode\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {HUB_CLEAR, HUB_FETCH} from \"./hubActions\";\r\n\r\nexport type HubState = {\r\n  hub: IHub,\r\n  nodes: IHubMinimalNode[]\r\n} | null;\r\n\r\nconst hubReducer: Reducer<HubState> = (\r\n  state: HubState = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case HUB_CLEAR: {\r\n      return null;\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case HUB_FETCH: {\r\n          return ({\r\n            hub: action.payload.response.hub,\r\n            nodes: action.payload.response.nodes\r\n          });\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default hubReducer;","import {IHubNode} from \"../../model/IHubNode\";\r\nimport {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {NODE_CLEAR, NODE_FETCH} from \"./nodeActions\";\r\n\r\nexport type NodeState = IHubNode | null;\r\n\r\nconst nodeReducer: Reducer<NodeState> = (\r\n  state = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODE_CLEAR: {\r\n      return null;\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODE_FETCH: {\r\n          return action.payload.response;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodeReducer;","import {ICategoryProvider} from \"./ICategoryProvider\";\r\nimport {IFilter} from \"./IFilter\";\r\nimport {ICategoryGroup} from \"./ICategoryGroup\";\r\nimport {ICategory} from \"./ICategory\";\r\nimport {IDataset} from \"./IDataset\";\r\n\r\nexport class LocalCategoryProvider implements ICategoryProvider {\r\n\r\n  categoryGroups: Array<ICategoryGroup>;\r\n\r\n  datasets: Map<String, IDataset>;\r\n\r\n  uncategorizedDatasets: IDataset[];\r\n\r\n  nodeId: number;\r\n\r\n  constructor(categories: Array<ICategoryGroup>, datasets: Map<String, IDataset>, uncategorizedDatasets: IDataset[] = [], nodeId: number = -1) {\r\n    this.datasets = datasets || {};\r\n    this.categoryGroups = categories || [];\r\n    this.uncategorizedDatasets = uncategorizedDatasets || [];\r\n    this.nodeId = nodeId || -1;\r\n  }\r\n\r\n  searchCategories(filter?: IFilter): Array<ICategory> {\r\n\r\n    let result: Array<ICategory> = [];\r\n\r\n    let searchText: string;\r\n    if (filter) {\r\n      searchText = filter.text.toLowerCase();\r\n    }\r\n\r\n    this.categoryGroups.forEach(categ => {\r\n\r\n      if (!searchText) {\r\n        result.push(...categ.categories);\r\n      } else {\r\n        categ.categories.forEach(category => {\r\n          let matchFound: boolean = category.label.toLowerCase().indexOf(searchText) >= 0;\r\n\r\n          if (matchFound) {\r\n            result.push(category);\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  searchDataset(filter?: IFilter): IDataset[] {\r\n    return [];\r\n  }\r\n}","import {ReducersMapObject} from \"redux\";\r\nimport hubReducer from \"./hub/hubReducer\";\r\nimport nodeReducer from \"./node/nodeReducer\";\r\nimport catalogReducer from \"./catalog/catalogReducer\";\r\nimport datasetReducer from \"./dataset/datasetReducer\";\r\nimport appReducer from \"./app/appReducer\";\r\nimport hubConfigReducer from \"./hubConfig/hubConfigReducer\";\r\nimport spinnerReducer from \"./spinner/spinnerReducer\";\r\nimport configReducer from \"./config/configReducer\";\r\nimport nodesConfigReducer from \"./nodesConfig/nodesConfigReducer\";\r\nimport cacheReducer from \"./cache/cacheReducer\";\r\nimport otherConfigReducer from \"./otherConfig/otherConfigReducer\";\r\nimport nodeTemplatesConfigReducer from \"./noteTemplatesConfig/nodeTemplatesConfigReducer\";\r\nimport userReducer from './user/userReducer';\r\nimport usersConfigReducer from \"./usersConfig/usersConfigReducer\";\r\nimport dashboardReducer from \"./dashboard/dashboardReducer\";\r\nimport nodePermissionsConfigReducer from './nodePermissionsConfig/nodePermissionsConfigReducer';\r\nimport deleteConflictModalReducer from './delete-conflict-modal/deleteConflictModalReducer';\r\nimport appConfigReducer from './appConfig/appConfigReducer';\r\n\r\nconst rootReducer: ReducersMapObject = ({\r\n  spinner: spinnerReducer,\r\n  appConfig: appConfigReducer,\r\n  config: configReducer,\r\n  app: appReducer,\r\n  hub: hubReducer,\r\n  node: nodeReducer,\r\n  nodeTemplatesConfig: nodeTemplatesConfigReducer,\r\n  catalog: catalogReducer,\r\n  dataset: datasetReducer,\r\n  hubConfig: hubConfigReducer,\r\n  nodesConfig: nodesConfigReducer,\r\n  cacheConfig: cacheReducer,\r\n  otherConfig: otherConfigReducer,\r\n  user: userReducer,\r\n  usersConfig: usersConfigReducer,\r\n  dashboard: dashboardReducer,\r\n  nodePermissionsConfig: nodePermissionsConfigReducer,\r\n  deleteConflictModal: deleteConflictModalReducer\r\n});\r\n\r\nexport default rootReducer;","import {Reducer} from \"redux\";\r\nimport {\r\n  SPINNER_FLUSH,\r\n  SPINNER_MESSAGE_ADD,\r\n  SPINNER_MESSAGE_REMOVE,\r\n  SPINNER_TIMEOUT_CLEAR,\r\n  SPINNER_TIMEOUT_SET\r\n} from \"./spinnerActions\";\r\n\r\nexport type SpinnerState = {\r\n  messages: any[],\r\n  timeout: any\r\n};\r\n\r\nconst spinnerReducer: Reducer<SpinnerState> = (\r\n  state = {\r\n    messages: [],\r\n    timeout: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case SPINNER_MESSAGE_ADD: {\r\n      return {\r\n        ...state,\r\n        messages: [...state.messages, ({uid: action.payload.uid, message: action.payload.message, removed: false})]\r\n      };\r\n    }\r\n    case SPINNER_MESSAGE_REMOVE: {\r\n      return {\r\n        ...state,\r\n        messages: [\r\n          ...state.messages.map(message => message.uid !== action.payload.uid ? message : ({...message, removed: true, isError: action.payload.isError}))\r\n        ]\r\n      };\r\n    }\r\n    case SPINNER_TIMEOUT_SET: {\r\n      return {\r\n        ...state,\r\n        timeout: action.payload.timeout\r\n      };\r\n    }\r\n    case SPINNER_TIMEOUT_CLEAR: {\r\n      return {\r\n        ...state,\r\n        timeout: null\r\n      };\r\n    }\r\n    case SPINNER_FLUSH: {\r\n      if (state.timeout) {\r\n        clearTimeout(state.timeout);\r\n      }\r\n      return {\r\n        ...state,\r\n        timeout: null,\r\n        messages: []\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default spinnerReducer;","import {Reducer} from \"redux\";\r\nimport {INIT} from '../rootActions';\r\n\r\nexport type ConfigState = object | null;\r\n\r\nconst appConfigReducer: Reducer<ConfigState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT: {\r\n            return action.payload.appConfig;\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default appConfigReducer;","import {Reducer} from \"redux\";\r\nimport {INIT} from '../rootActions';\r\n\r\nexport type ConfigState = {\r\n  baseURL: string\r\n} | null;\r\n\r\nconst configReducer: Reducer<ConfigState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n  switch (action.type) {\r\n    case INIT: {\r\n      return {\r\n        baseURL: action.payload.baseURL\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default configReducer;","import {Reducer} from \"redux\";\r\nimport {APP_LANGUAGE_SET} from \"./appActions\";\r\nimport {INIT} from '../rootActions';\r\nimport {PERSISTENCE_ACTION_KEY} from '../../middlewares/persistence/middleware';\r\nimport _ from \"lodash\";\r\n\r\nexport type AppState = {\r\n    language: string,\r\n    languages: string[]\r\n} | null\r\n    ;\r\nconst appReducer: Reducer<AppState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT:\r\n            const initialState = {\r\n                language: action.payload.defaultLanguage,\r\n                languages: action.payload.supportedLanguages\r\n            };\r\n            return _.merge(initialState, action.payload[PERSISTENCE_ACTION_KEY].app) || initialState;\r\n        case APP_LANGUAGE_SET: {\r\n            return {\r\n                ...state,\r\n                language: action.payload.language\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default appReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {NODE_TEMPLATES_CONFIG_CLEAR, NODE_TEMPLATES_CONFIG_FETCH} from \"./nodeTemplatesConfigActions\";\r\n\r\nexport type NodesConfigState = {\r\n  templates: any[] | null\r\n};\r\n\r\nconst nodeTemplatesConfigReducer: Reducer<NodesConfigState> = (\r\n  state = {\r\n    templates: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODE_TEMPLATES_CONFIG_CLEAR: {\r\n      return {\r\n        ...state,\r\n        templates: null\r\n      };\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODE_TEMPLATES_CONFIG_FETCH: {\r\n          return {\r\n            ...state,\r\n            templates: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodeTemplatesConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {CATALOG_CLEAR, CATALOG_FETCH} from \"./catalogActions\";\r\nimport {ICategoryProvider} from \"../../model/ICategoryProvider\";\r\nimport {LocalCategoryProvider} from \"../../model/LocalCategoryProvider\";\r\n\r\nexport type CatalogState = ICategoryProvider | null;\r\n\r\nconst catalogReducer: Reducer<CatalogState> = (\r\n  state = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case CATALOG_CLEAR: {\r\n      return null;\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case CATALOG_FETCH: {\r\n          return new LocalCategoryProvider(\r\n            action.payload.response.categoryGroups,\r\n            action.payload.response.datasetMap,\r\n            action.payload.response.datasetUncategorized,\r\n            action.payload.extra.nodeId\r\n          );\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default catalogReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  HUB_CONFIG_CLEAR,\r\n  HUB_CONFIG_DASHBOARDS_CLEAR,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n  HUB_CONFIG_DASHBOARDS_FETCH,\r\n  HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n  HUB_CONFIG_FETCH,\r\n  HUB_CONFIG_SEND,\r\n  HUB_CONFIG_DASHBOARDS_CLEAR_ALL,\r\n  HUB_CONFIG_DASHBOARDS_FETCH_ALL\r\n} from \"./hubConfigActions\";\r\n\r\nexport type HubConfigState = {\r\n  hub: any | null,\r\n  hubDashboards: any[] | null,\r\n  allDashboards: any[] | null\r\n};\r\n\r\nconst hubConfigReducer: Reducer<HubConfigState> = (\r\n    state = {\r\n      hub: null,\r\n      hubDashboards: null,\r\n      allDashboards: null\r\n    },\r\n    action\r\n) => {\r\n  switch (action.type) {\r\n    case HUB_CONFIG_CLEAR: {\r\n      return {\r\n        ...state,\r\n        hub: null\r\n      };\r\n    }\r\n    case HUB_CONFIG_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        hubDashboards: null\r\n      };\r\n    }\r\n    case HUB_CONFIG_DASHBOARDS_CLEAR_ALL: {\r\n      return {\r\n        ...state,\r\n        allDashboards: null\r\n      };\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case HUB_CONFIG_FETCH: {\r\n          return {\r\n            ...state,\r\n            hub: action.payload.response[0]\r\n          }\r\n        }\r\n        case HUB_CONFIG_SEND: {\r\n          return {\r\n            ...state,\r\n            hub: null,\r\n            hubDashboards: null\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            hubDashboards: action.payload.response\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_FETCH_ALL: {\r\n          return {\r\n            ...state,\r\n            allDashboards: action.payload.response\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD:\r\n          return {\r\n            ...state,\r\n            allDashboards: null,\r\n            hubDashboards: null\r\n          };\r\n        case HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE:\r\n        case HUB_CONFIG_DASHBOARDS_ORDERS_SEND:\r\n          return {\r\n            ...state,\r\n            hubDashboards: null\r\n          }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default hubConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_START, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  NODES_CONFIG_NODE_CLEAR,\r\n  NODES_CONFIG_NODE_CREATE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_CLEAR,\r\n  NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_FETCH,\r\n  NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL,\r\n  NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n  NODES_CONFIG_NODE_EDIT,\r\n  NODES_CONFIG_NODE_FETCH,\r\n  NODES_CONFIG_NODES_CLEAR,\r\n  NODES_CONFIG_NODES_FETCH\r\n} from \"./nodesConfigActions\";\r\nimport {IHubNode} from \"../../model/IHubNode\";\r\n\r\nexport type NodesConfigState = {\r\n  nodes: IHubNode[] | null,\r\n  node: IHubNode | null,\r\n  nodeDashboards: any[] | null,\r\n  allDashboards: any[] | null\r\n};\r\n\r\nconst nodesConfigReducer: Reducer<NodesConfigState> = (\r\n  state = {\r\n    nodes: null,\r\n    node: null,\r\n    nodeDashboards: null,\r\n    allDashboards: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODES_CONFIG_NODES_CLEAR: {\r\n      return {\r\n        ...state,\r\n        nodes: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_CLEAR: {\r\n      return {\r\n        ...state,\r\n        node: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        nodeDashboards: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL: {\r\n      return {\r\n        ...state,\r\n        allDashboards: null\r\n      };\r\n    }\r\n    case REQUEST_START: {\r\n      switch (action.payload.label) {\r\n        case NODES_CONFIG_NODE_EDIT: {\r\n          return {\r\n            ...state,\r\n            node: null\r\n          };\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODES_CONFIG_NODES_FETCH: {\r\n          return {\r\n            ...state,\r\n            nodes: action.payload.response\r\n          };\r\n        }\r\n        case NODES_CONFIG_NODE_FETCH: {\r\n          return {\r\n            ...state,\r\n            node: action.payload.response\r\n          }\r\n        }\r\n        case NODES_CONFIG_NODE_CREATE:\r\n        case NODES_CONFIG_NODE_EDIT:\r\n          return {\r\n            ...state,\r\n            node: null\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_FETCH:\r\n          return {\r\n            ...state,\r\n            nodeDashboards: action.payload.response\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL:\r\n          return {\r\n            ...state,\r\n            allDashboards: action.payload.response\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD:\r\n          return {\r\n            ...state,\r\n            allDashboards: null,\r\n            nodeDashboards: null\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE:\r\n        case NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND:\r\n          return {\r\n            ...state,\r\n            nodeDashboards: null\r\n          }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodesConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {IDataflowCache} from \"../../model/IDataflowCache\";\r\nimport {\r\n  DATAFLOW_CACHE_CLEAR,\r\n  DATAFLOW_CACHE_CREATE,\r\n  DATAFLOW_CACHE_DELETE,\r\n  DATAFLOW_CACHE_FETCH,\r\n  DATAFLOW_CACHE_UPDATE\r\n} from \"./cacheActions\";\r\n\r\nexport type DataflowCacheState =  IDataflowCache[] | null;\r\n\r\nconst cacheReducer: Reducer<DataflowCacheState> = (\r\n  state =  null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DATAFLOW_CACHE_FETCH: {\r\n          return action.payload.response;\r\n        }\r\n        case DATAFLOW_CACHE_UPDATE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.id === action.payload.extra.cacheId && e.nodeId === action.payload.extra.nodeId) {\r\n                  e.ttl = action.payload.extra.ttl;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        case DATAFLOW_CACHE_CREATE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.dataflowId === action.payload.extra.oldData.dataflowId && e.nodeId === action.payload.extra.oldData.nodeId) {\r\n                  e.ttl = action.payload.response.ttl;\r\n                  e.id = action.payload.response.id;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        case DATAFLOW_CACHE_DELETE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.id === action.payload.extra.cacheId && e.nodeId === action.payload.extra.nodeId) {\r\n                  e.cacheSize = 0;\r\n                  e.cachedDataflow = 0;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DATAFLOW_CACHE_FETCH: {\r\n          return null;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case DATAFLOW_CACHE_CLEAR: {\r\n      return null;\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default cacheReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  OTHER_CONFIG_DASHBOARD_CHANGE,\r\n  OTHER_CONFIG_DASHBOARD_CREATE,\r\n  OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT,\r\n  OTHER_CONFIG_DASHBOARD_DATASET_CLEAR,\r\n  OTHER_CONFIG_DASHBOARD_DATASET_FETCH,\r\n  OTHER_CONFIG_DASHBOARD_DELETE,\r\n  OTHER_CONFIG_DASHBOARD_HIDE,\r\n  OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR,\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_FETCH,\r\n  OTHER_CONFIG_DASHBOARDS_CLEAR,\r\n  OTHER_CONFIG_DASHBOARDS_FETCH,\r\n  OTHER_CONFIG_VIEW_DELETE,\r\n  OTHER_CONFIG_VIEWS_CLEAR,\r\n  OTHER_CONFIG_VIEWS_FETCH\r\n} from \"./otherConfigActions\";\r\nimport _ from \"lodash\"\r\nimport {DASHBOARD_VIEW_STATE_ERROR, DASHBOARD_VIEW_STATE_FETCHING} from \"../dashboard/dashboardReducer\";\r\n\r\nexport type OtherConfigState = {\r\n  views: any[] | null,\r\n  needDashboards: boolean,\r\n  dashboards: any[] | null,\r\n  dashboard: any[] | null,\r\n  dashboardViews: any[] | null,\r\n  dashboardJsonStats: any,\r\n  dashboardMaps: any,\r\n};\r\n\r\nconst otherConfigReducer: Reducer<OtherConfigState> = (\r\n  state = {\r\n    views: null,\r\n    needDashboards: false,\r\n    dashboards: null,\r\n    dashboard: null,\r\n    dashboardViews: null,\r\n    dashboardJsonStats: null,\r\n    dashboardMaps: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case OTHER_CONFIG_VIEWS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        views: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboardViews: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboards: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_CREATE: {\r\n      return {\r\n        ...state,\r\n        dashboard: action.payload.dashboard\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_CHANGE: {\r\n      return {\r\n        ...state,\r\n        dashboard: action.payload.dashboard\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_HIDE: {\r\n      return {\r\n        ...state,\r\n        dashboard: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_DATASET_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboardJsonStats: null,\r\n        dashboardMaps: null\r\n      };\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            needDashboards: false\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: DASHBOARD_VIEW_STATE_FETCHING\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_VIEWS_FETCH: {\r\n          return {\r\n            ...state,\r\n            views: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_VIEWS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboardViews: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        case OTHER_CONFIG_VIEW_DELETE: {\r\n          return {\r\n            ...state,\r\n            views: null\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboards: action.payload.response\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_UPDATE: {\r\n          return {\r\n            ...state,\r\n            dashboard: {\r\n              ...action.payload.response,\r\n              dashboardConfig: action.payload.response?.dashboardConfig\r\n                ? JSON.parse(action.payload.response.dashboardConfig)\r\n                : {},\r\n              filterLevels: action.payload.response?.filterLevels\r\n                ? JSON.parse(action.payload.response.filterLevels)\r\n                : {}\r\n            }\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DELETE:\r\n        case OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT:\r\n        case OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            needDashboards: true\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n          const jsonStat = (action.payload.response?.id || []).length > 0\r\n            ? action.payload.response\r\n            : \"\";\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: jsonStat\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats\r\n          }\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any, idx: number) => val.nutsLevel)\r\n            .reduce((acc: any, val: any) => {\r\n              if (!acc[val]) {\r\n                const label = \"Nuts level \" + val;\r\n                acc[val] = {level: val, counter: 0, label: label};\r\n              }\r\n              acc[val].counter++;\r\n              return acc;\r\n            }, []);\r\n\r\n          return {\r\n            ...state,\r\n            dashboardMaps: {\r\n              ...state.dashboardMaps,\r\n              [action.payload.extra.requestId]: {\r\n                geometries: action.payload.response,\r\n                geometryDetailLevels: detailLevels\r\n              }\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_ERROR:\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboards: action.payload.statusCode === 404 ? [] : null\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: DASHBOARD_VIEW_STATE_ERROR\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default otherConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_START, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    USERS_CONFIG_USER_CLEAR,\r\n    USERS_CONFIG_USER_CREATE,\r\n    USERS_CONFIG_USER_EDIT,\r\n    USERS_CONFIG_USER_FETCH,\r\n    USERS_CONFIG_USERS_CLEAR,\r\n    USERS_CONFIG_USERS_FETCH,\r\n    USER_CONFIG_FORM_SHOW, USER_CONFIG_FORM_HIDE\r\n} from \"./usersConfigActions\";\r\n\r\nexport type User = {\r\n\r\n};\r\n\r\nexport type UsersConfigState = {\r\n    users: User[] | null,\r\n    user: User | null,\r\n    userErrors: string[] | null,\r\n    userId: number | null,\r\n    isSetPasswordDialogOpen: boolean,\r\n    setPasswordToken: string | null\r\n};\r\n\r\nconst usersConfigReducer: Reducer<UsersConfigState> = (\r\n    state = {\r\n        users: null,\r\n        user: null,\r\n        userErrors: null,\r\n        userId: null,\r\n        isSetPasswordDialogOpen: false,\r\n        setPasswordToken: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case USER_CONFIG_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                userId: action.payload.userId\r\n            };\r\n        case USER_CONFIG_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                user: null,\r\n                userId: null,\r\n                userErrors: null\r\n            };\r\n        case USERS_CONFIG_USERS_CLEAR: {\r\n            return {\r\n                ...state,\r\n                users: null\r\n            };\r\n        }\r\n        case USERS_CONFIG_USER_CLEAR: {\r\n            return {\r\n                ...state,\r\n                user: null\r\n            };\r\n        }\r\n        case REQUEST_START: {\r\n            switch (action.payload.label) {\r\n                case USERS_CONFIG_USER_EDIT: {\r\n                    return {\r\n                        ...state,\r\n                        user: null\r\n                    };\r\n                }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case USERS_CONFIG_USERS_FETCH: {\r\n                    return {\r\n                        ...state,\r\n                        users: action.payload.response\r\n                    };\r\n                }\r\n                case USERS_CONFIG_USER_FETCH: {\r\n                    return {\r\n                        ...state,\r\n                        user: action.payload.response\r\n                    }\r\n                }\r\n                case USERS_CONFIG_USER_CREATE:\r\n                case USERS_CONFIG_USER_EDIT:\r\n                    if (action.payload.response.haveError) {\r\n                        return {\r\n                            ...state,\r\n                            userErrors: action.payload.response.errors\r\n                        };\r\n                    } else {\r\n                        return {\r\n                            ...state,\r\n                            user: null,\r\n                            userErrors: null,\r\n                            userId: null\r\n                        };\r\n                    }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default usersConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    NODE_PERMISSIONS_CONFIG_CLEAR,\r\n    NODE_PERMISSIONS_CONFIG_FETCH,\r\n    NODE_PERMISSIONS_CONFIG_SEND\r\n} from './nodePermissionsConfigActions';\r\n\r\nexport type NodePermissionsConfigState = {\r\n    permissions: any[] | null\r\n};\r\n\r\nconst nodePermissionsConfigReducer: Reducer<NodePermissionsConfigState> = (\r\n    state = {\r\n        permissions: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case NODE_PERMISSIONS_CONFIG_CLEAR: {\r\n            return {\r\n                ...state,\r\n                permissions: null\r\n            };\r\n        }\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case NODE_PERMISSIONS_CONFIG_FETCH: {\r\n                    return {\r\n                        state,\r\n                        permissions: action.payload.response\r\n                    };\r\n                }\r\n                case NODE_PERMISSIONS_CONFIG_SEND:\r\n                    return {permissions: null};\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default nodePermissionsConfigReducer;","import {Reducer} from 'redux';\r\nimport {REQUEST_ERROR, RequestMethod} from '../../middlewares/request/requestActions';\r\nimport {DELETE_CONFLICT_MODAL_CLOSE} from './deleteConflictModalActions';\r\n\r\ntype DeleteConflictModalState = {\r\n    response: any | null,\r\n    onForce: any | null\r\n};\r\n\r\nconst deleteConflictModalReducer: Reducer<DeleteConflictModalState> = (\r\n    state = {\r\n        response: null,\r\n        onForce: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case REQUEST_ERROR:\r\n            if (action.payload.statusCode === 409 && action.payload.method === RequestMethod.DELETE) {\r\n                return {\r\n                    ...state,\r\n                    response: action.payload.response,\r\n                    onForce: action.payload.extra?.onDeleteConflictForce || null\r\n                };\r\n            } else {\r\n                return state;\r\n            }\r\n        case DELETE_CONFLICT_MODAL_CLOSE:\r\n            return {\r\n                ...state,\r\n                response: null,\r\n                onForce: null\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default deleteConflictModalReducer;","import {\r\n  clearUser,\r\n  showUserLoginForm,\r\n  USER_PASSWORD_CHANGE, USER_PASSWORD_SET,\r\n  USER_REFRESH, USER_RESET_PASSWORD_EMAIL_SEND\r\n} from \"../../state/user/userActions\";\r\nimport {REQUEST_INIT, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {HUB_FETCH} from \"../../state/hub/hubActions\";\r\nimport {NODE_FETCH} from \"../../state/node/nodeActions\";\r\nimport {goToHome} from \"../../links\";\r\n\r\nconst userMiddlewareFactory = t => ({dispatch, getState}) => next => action => {\r\n\r\n  const state = getState();\r\n\r\n  let result;\r\n\r\n  // if a request is starting but auth token is expired\r\n  if (\r\n    action.type === REQUEST_INIT &&\r\n    action.payload.label !== HUB_FETCH &&\r\n    action.payload.label !== NODE_FETCH &&\r\n    action.payload.label !== USER_REFRESH &&\r\n    state.user.isAuthenticated &&\r\n    state.user.tokenReceivedTime !== null &&\r\n    state.user.tokenTTL !== null &&\r\n    new Date(new Date().getTime() - state.user.tokenReceivedTime).getMinutes()\r\n    >= state.user.tokenTTL - 1\r\n  ) {\r\n\r\n    /*\r\n      result = next(refreshUser()); // block current request dispatching, and replace it with token refresh request\r\n      dispatch(setUserDelayedRequestWhenTokenExpired(action)); // delay current (request) action\r\n    */\r\n\r\n    result = next(({type: \"NOP\"}));\r\n    if (window.error) {\r\n      window.error.show(t(\"middlewares.user.sessionExpired\"));\r\n    }\r\n    dispatch(clearUser());\r\n\r\n  } else {\r\n\r\n    result = next(action); // do nothing, continue action dispatching as normal\r\n\r\n  }\r\n\r\n  // if sent token is expired (in some cases it can happen, even if i checked expiration in the previous code)\r\n  if (action.payload?.extra?.responseHeaders && action.payload.extra.responseHeaders[\"token-expired\"]) {\r\n    /*\r\n      dispatch(clearUser()); // init user state\r\n      dispatch(showUserLoginForm(\"Authentication is expired. Please log in again.\")); // show login form with alert\r\n     */\r\n\r\n    if (window.error) {\r\n      window.error.show(t(\"middlewares.user.sessionExpired\"));\r\n    }\r\n    dispatch(clearUser());\r\n\r\n  }\r\n\r\n  // if token has been refreshed and delayed request is pending\r\n  if (action.type === REQUEST_SUCCESS && action.payload?.label === USER_REFRESH && state.user.delayedRequest) {\r\n    dispatch(state.user.delayedRequest); // dispatch pending (request) action\r\n  }\r\n\r\n  if (action.type === REQUEST_SUCCESS && (\r\n    action.payload.label === USER_PASSWORD_CHANGE ||\r\n    action.payload.label === USER_PASSWORD_SET\r\n  )) {\r\n    window.error.show(t(\"middlewares.user.passwordChangedLoginNecessary\"), false);\r\n    goToHome();\r\n    dispatch(showUserLoginForm());\r\n  } else if (action.type === REQUEST_INIT && action.payload.label === USER_RESET_PASSWORD_EMAIL_SEND) {\r\n    window.error.show(t(\"middlewares.user.resetPasswordEmailSent\"), false);\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport default userMiddlewareFactory;","import {errorRequest, REQUEST_INIT, RequestActionPayload, startRequest, successRequest} from './requestActions';\r\nimport axios, {AxiosResponse} from 'axios';\r\nimport {Middleware} from 'redux';\r\nimport {PayloadAction} from \"@reduxjs/toolkit\";\r\n\r\nconst requestMiddlewareFactory = (\r\n  options: {\r\n    onSuccess?: (requestAction: object, data?: any, extra?: any) => void,\r\n    onManagedServerError?: (requestAction: RequestActionPayload, statusCode: number, managedServerError: any) => void,\r\n    onGenericError?: (requestAction: RequestActionPayload, statusCode?: number) => void\r\n  }\r\n): Middleware =>\r\n  ({dispatch, getState}) => next => action => {\r\n\r\n    const handleSuccess = (requestAction: RequestActionPayload, response: AxiosResponse) => {\r\n\r\n      if (options.onSuccess) {\r\n        options.onSuccess(requestAction, response.data, {\r\n          responseHeaders: response.headers\r\n        });\r\n      }\r\n\r\n      dispatch(successRequest(requestAction, response.data, {\r\n        responseHeaders: response.headers,\r\n        status: response.status\r\n      }));\r\n    };\r\n\r\n    const handleManagedServerError = (requestAction: RequestActionPayload, response: AxiosResponse) => {\r\n\r\n      if (options.onManagedServerError && (!requestAction?.getHideErrorMessage || !requestAction.getHideErrorMessage(response?.status))) {\r\n        options.onManagedServerError(requestAction, response.status, response.data);\r\n      }\r\n\r\n      dispatch(errorRequest(requestAction, response.status, response.data, {responseHeaders: response.headers}));\r\n    };\r\n\r\n    const handleGenericError = (requestAction: RequestActionPayload, response?: AxiosResponse) => {\r\n\r\n      if (options.onGenericError && (!requestAction?.getHideErrorMessage || !requestAction.getHideErrorMessage(response?.status))) {\r\n        options.onGenericError(requestAction, response?.status);\r\n      }\r\n\r\n      dispatch(errorRequest(requestAction, response?.status, response?.data, {responseHeaders: response?.headers}));\r\n    };\r\n\r\n    const handleError = (requestAction: RequestActionPayload, response?: AxiosResponse) => {\r\n\r\n      if (response?.data) {\r\n\r\n        if (response.data.usedBy !== undefined) {\r\n          handleManagedServerError(requestAction, response);\r\n        } else {\r\n          handleGenericError(requestAction, response);\r\n        }\r\n      } else {\r\n        handleGenericError(requestAction, response);\r\n      }\r\n    };\r\n\r\n    const result = next(action);\r\n\r\n    if (action.type !== REQUEST_INIT) {\r\n      return result;\r\n    }\r\n\r\n    const requestAction: PayloadAction<RequestActionPayload> = action;\r\n\r\n    dispatch(startRequest(requestAction.payload));\r\n\r\n    let {\r\n      method,\r\n      url,\r\n      data,\r\n      baseURL,\r\n      contentType,\r\n      doNotTransformResponse\r\n    } = requestAction.payload;\r\n\r\n    const token = getState().user.token;\r\n\r\n    axios.request({\r\n      method,\r\n      url: ((baseURL && baseURL.length > 0) ? baseURL : getState().config.baseURL) + url,\r\n      data,\r\n      headers: {\r\n        \"UserLang\": getState().app.language,\r\n        \"Authorization\": token ? `bearer ${token}` : undefined,\r\n        \"Content-Type\": contentType || undefined\r\n      },\r\n      withCredentials: true,\r\n      transformResponse: doNotTransformResponse ? res => res : undefined\r\n    }).then((response: AxiosResponse) => {\r\n      if (response.status.toString()[0] === \"2\") {\r\n        handleSuccess(requestAction.payload, response);\r\n      } else {\r\n        handleError(requestAction.payload, response);\r\n      }\r\n    }).catch(error => {\r\n      console.log(error);\r\n      handleError(requestAction.payload, error.response);\r\n    });\r\n\r\n    return result;\r\n  };\r\n\r\nexport default requestMiddlewareFactory;\r\n","export const showGenericError = () => {\r\n  if (window && window.error) {\r\n    window.error.show(\"An error occurred while contacting the server.\");\r\n  } else {\r\n    console.error(\"An error occurred while contacting the server.\");\r\n  }\r\n};\r\n\r\nexport const showTranslatedGenericErrorFactory = t => () => {\r\n  if (window && window.error) {\r\n    window.error.show(t(\"errors.generic\"));\r\n  } else {\r\n    console.error(t(\"errors.generic\"));\r\n  }\r\n};","import {REQUEST_START, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {\r\n  fetchHubConfigDashboards,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n  HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n  HUB_CONFIG_SEND\r\n} from \"../../state/hubConfig/hubConfigActions\";\r\nimport {fetchHub} from \"../../state/hub/hubActions\";\r\nimport {\r\n  fetchNodesConfigNodeDashboards,\r\n  fetchNodesConfigNodes,\r\n  NODES_CONFIG_NODE_CREATE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n  NODES_CONFIG_NODE_DELETE,\r\n  NODES_CONFIG_NODE_EDIT,\r\n  NODES_CONFIG_NODES_ORDER_SEND\r\n} from \"../../state/nodesConfig/nodesConfigActions\";\r\nimport {\r\n  fetchUsersConfigUsers,\r\n  USERS_CONFIG_USER_CREATE,\r\n  USERS_CONFIG_USER_DELETE,\r\n  USERS_CONFIG_USER_EDIT,\r\n} from \"../../state/usersConfig/usersConfigActions\";\r\nimport {goToHome} from \"../../links\";\r\nimport {\r\n  fetchOtherConfigViews,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  OTHER_CONFIG_VIEW_DELETE\r\n} from \"../../state/otherConfig/otherConfigActions\";\r\nimport {\r\n  fetchNodeTemplatesConfig,\r\n  NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE\r\n} from \"../../state/noteTemplatesConfig/nodeTemplatesConfigActions\";\r\nimport {\r\n  DATAFLOW_CACHE_DELETE_ALL,\r\n  DATAFLOW_CACHE_DELETE_CATALOG,\r\n  fetchDataflowCache\r\n} from \"../../state/cache/cacheActions\";\r\nimport {fetchCatalog} from \"../../state/catalog/catalogActions\";\r\nimport {fetchNode} from \"../../state/node/nodeActions\";\r\nimport {clearDashboardsDashboards} from \"../../state/dashboard/dashboardActions\";\r\n\r\nconst configMiddleware = ({dispatch, getState}) => next => action => {\r\n\r\n  const state = getState();\r\n\r\n  const res = next(action);\r\n\r\n  if (action.type === REQUEST_START && action.payload.label === NODES_CONFIG_NODE_DELETE) {\r\n    if (state.node && state.node.nodeId === action.payload.extra?.nodeId) {\r\n      goToHome();\r\n    }\r\n  }\r\n\r\n  if (action.type === REQUEST_SUCCESS) {\r\n    switch (action.payload.label) {\r\n      case HUB_CONFIG_SEND: {\r\n        goToHome();\r\n        dispatch(fetchHub());\r\n        break;\r\n      }\r\n      case HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD:\r\n      case HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE:\r\n      case HUB_CONFIG_DASHBOARDS_ORDERS_SEND: {\r\n        dispatch(fetchHubConfigDashboards());\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD:\r\n      case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE:\r\n      case NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND: {\r\n        dispatch(fetchNodesConfigNodeDashboards(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODES_ORDER_SEND: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_EDIT: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        if (state.node && state.node.nodeId === action.payload.extra.nodeId) {\r\n          goToHome();\r\n          dispatch(fetchNode(action.payload.extra.nodeId));\r\n        }\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_CREATE:\r\n      case NODES_CONFIG_NODE_DELETE: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        break;\r\n      }\r\n      case USERS_CONFIG_USER_EDIT:\r\n      case USERS_CONFIG_USER_DELETE: {\r\n        if (!action.payload.response.haveError && !action.payload.extra?.isAnonymous) {\r\n          dispatch(fetchUsersConfigUsers());\r\n        }\r\n        break;\r\n      }\r\n      case USERS_CONFIG_USER_CREATE:\r\n        if (!action.payload.response.haveError && !action.payload.extra?.isAnonymous) {\r\n          dispatch(fetchUsersConfigUsers());\r\n        } else if (!action.payload.response.haveError && action.payload.extra?.isAnonymous) {\r\n          goToHome();\r\n          window.location.reload();\r\n        }\r\n        break;\r\n      case OTHER_CONFIG_VIEW_DELETE: {\r\n        dispatch(fetchOtherConfigViews());\r\n        break;\r\n      }\r\n      case NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE: {\r\n        dispatch(fetchNodeTemplatesConfig(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case DATAFLOW_CACHE_DELETE_ALL: {\r\n        dispatch(fetchDataflowCache(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case DATAFLOW_CACHE_DELETE_CATALOG: {\r\n        if (state.node && state.node.nodeId === action.payload.extra.nodeId) {\r\n          goToHome();\r\n          dispatch(fetchCatalog(action.payload.extra.nodeId));\r\n        }\r\n        break;\r\n      }\r\n      case OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT: {\r\n        if (state.dashboard.dashboards && state.dashboard.dashboards[action.payload.extra.dashboardId]) {\r\n          dispatch(clearDashboardsDashboards());\r\n        }\r\n        break;\r\n      }\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport default configMiddleware;","import {REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport FileSaver from \"file-saver\";\r\nimport {QUERY_LOG_DOWNLOAD} from \"../../components/settings-select/actions\";\r\nimport {DATASET_DOWNLOAD_SUBMIT} from \"../../state/dataset/datasetActions\";\r\n\r\nconst fileSaveMiddleware = () => next => action => {\r\n\r\n  const result = next(action);\r\n\r\n  if (action.type === REQUEST_SUCCESS && action.payload.extra.fileSave) {\r\n    if (\r\n      action.payload.label === QUERY_LOG_DOWNLOAD ||\r\n      action.payload.label === DATASET_DOWNLOAD_SUBMIT\r\n    ) {\r\n\r\n      let name = action.payload.extra.fileSave.name;\r\n\r\n      FileSaver.saveAs(\r\n        new Blob(\r\n          action.payload?.extra?.stringifyResponse\r\n            ? [JSON.stringify(action.payload.response, null, 2)]\r\n            : [action.payload.response],\r\n          {type: action.payload.extra.fileSave.type}\r\n        ),\r\n        name\r\n      )\r\n    }\r\n  }\r\n\r\n  return result;\r\n\r\n};\r\n\r\nexport default fileSaveMiddleware;\r\n","import {APP_LANGUAGE_SET} from \"../../state/app/appActions\";\r\nimport i18n from 'i18next';\r\nimport {INIT} from \"../../state/rootActions\";\r\nimport {PERSISTENCE_ACTION_KEY} from \"../persistence/middleware\";\r\nimport {clearHub} from \"../../state/hub/hubActions\";\r\nimport {clearNode} from \"../../state/node/nodeActions\";\r\nimport {clearCatalog} from \"../../state/catalog/catalogActions\";\r\n\r\nconst i18nMiddleware = ({getState, dispatch}) => next => action => {\r\n\r\n  const res = next(action);\r\n\r\n  window.language = getState().app.language;\r\n\r\n  if (action.type === APP_LANGUAGE_SET) {\r\n    i18n.changeLanguage(action.payload.language, () => {\r\n      dispatch(clearHub());\r\n      if (action.payload.nodeId) {\r\n        dispatch(clearCatalog());\r\n        dispatch(clearNode());\r\n      }\r\n    });\r\n  }\r\n\r\n  if (\r\n    action.type === INIT &&\r\n    action.payload[PERSISTENCE_ACTION_KEY]?.app?.language\r\n  ) {\r\n    if (getState().app.languages.includes(action.payload[PERSISTENCE_ACTION_KEY]?.app?.language)) {\r\n      window.language = action.payload[PERSISTENCE_ACTION_KEY].app.language;\r\n      i18n.changeLanguage(action.payload[PERSISTENCE_ACTION_KEY].app.language)\r\n    }\r\n  }\r\n\r\n  return res;\r\n\r\n};\r\n\r\nexport default i18nMiddleware;","import {REQUEST_ERROR, REQUEST_START, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {\r\n  addSpinnerMessage,\r\n  clearSpinnerTimeout,\r\n  flushSpinner,\r\n  markSpinnerMessage,\r\n  setSpinnerTimeout,\r\n  SPINNER_MESSAGE_ADD,\r\n  SPINNER_MESSAGE_REMOVE\r\n} from \"../../state/spinner/spinnerActions\";\r\n\r\nconst SPINNER_TIMEOUT = 1000;\r\n\r\nconst requestSpinnerMiddlewareFactory = t => ({dispatch, getState}) => next => action => {\r\n\r\n  if ((action.type === REQUEST_START || action.type === REQUEST_SUCCESS || action.type === REQUEST_ERROR) && action.payload.messages) {\r\n\r\n    const messages = action.payload.messages(t);\r\n\r\n    if (messages.onStart) {\r\n      if (action.type === REQUEST_START && !action.payload.hideSpinner) {\r\n        dispatch(addSpinnerMessage(action.payload.uuid, messages.onStart));\r\n      } else if (action.type === REQUEST_SUCCESS && !action.payload.response?.haveError) {\r\n        dispatch(markSpinnerMessage(action.payload.uuid));\r\n      } else if (action.type === REQUEST_ERROR || (action.type === REQUEST_SUCCESS && action.payload.response?.haveError)) {\r\n        dispatch(markSpinnerMessage(action.payload.uuid, true));\r\n      }\r\n    }\r\n  }\r\n\r\n  const result = next(action);\r\n\r\n  const spinnerState = getState().spinner;\r\n\r\n  if (action.type === SPINNER_MESSAGE_ADD) {\r\n    if (spinnerState.timeout) {\r\n      clearTimeout(spinnerState.timeout);\r\n      dispatch(clearSpinnerTimeout());\r\n    }\r\n  } else if (action.type === SPINNER_MESSAGE_REMOVE && !spinnerState.timeout && spinnerState.messages.length > 0 &&\r\n    spinnerState.messages.filter(({removed}) => !removed).length === 0\r\n  ) {\r\n    dispatch(setSpinnerTimeout(setTimeout(() => dispatch(flushSpinner()), SPINNER_TIMEOUT)));\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport default requestSpinnerMiddlewareFactory;","import {CATALOG_FETCH} from \"../../state/catalog/catalogActions\";\r\nimport {REQUEST_SUCCESS} from \"../request/requestActions\";\r\n\r\nconst feedbackMiddlewareFactory = t => ({getState}) => next => action => {\r\n\r\n  const res = next(action);\r\n\r\n  const state = getState();\r\n\r\n  if (\r\n    action.type === REQUEST_SUCCESS &&\r\n    action.payload.label === CATALOG_FETCH &&\r\n    (!state.catalog.uncategorizedDatasets || state.catalog.uncategorizedDatasets.length === 0) &&\r\n    (!state.catalog.datasets || Object.keys(state.catalog.datasets).length === 0)\r\n  ) {\r\n    window.error.show(t('middlewares.feedback.emptyCatalog'));\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport default feedbackMiddlewareFactory;","import {REQUEST_INIT, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {DATASET_FETCH} from \"../../state/dataset/datasetActions\";\r\nimport {errorFetchDatasetAsyncHandler, initFetchDatasetAsyncHandler, successFetchDatasetAsyncHandler} from \"./actions\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nexport const WORKERS_MIDDLEWARE = \"workers/middleware\";\r\n\r\nconst fetchDatasetAsyncHandlerMiddlewareFactory = t => ({dispatch}) => next => action => {\r\n\r\n  const result = next(action);\r\n\r\n  if (action?.payload?.label === DATASET_FETCH) {\r\n\r\n    if (action.type === REQUEST_INIT) {\r\n      dispatch(initFetchDatasetAsyncHandler());\r\n\r\n    } else if (action.type === REQUEST_SUCCESS) {\r\n\r\n      const spinnerUuid = uuidv4();\r\n      dispatch(addSpinnerMessage(spinnerUuid, t(\"middlewares.fetchDatasetAsyncHandlerMiddlewareFactory.spinners.layoutHandling\")));\r\n\r\n      const myWorker = new Worker(\"./workers/fetchDatasetAsyncHandlerWorker.js\");\r\n      myWorker.onmessage = event => {\r\n        const {\r\n          cellCount,\r\n          isResponseNotValid,\r\n          tableLayout,\r\n          mapLayout,\r\n          chartLayout\r\n        } = event.data;\r\n        dispatch(successFetchDatasetAsyncHandler(action.payload.response, action.payload.extra.status, action.payload.extra.responseHeaders, cellCount, isResponseNotValid, tableLayout, mapLayout, chartLayout, myWorker));\r\n        dispatch(markSpinnerMessage(spinnerUuid));\r\n      }\r\n      myWorker.onerror = () => {\r\n        dispatch(errorFetchDatasetAsyncHandler());\r\n        dispatch(markSpinnerMessage(spinnerUuid, true));\r\n        window.error.show(t(\"middlewares.fetchDatasetAsyncHandlerMiddlewareFactory.feedback.layoutHandlingError\"));\r\n      }\r\n      myWorker.postMessage({\r\n        response: action.payload.response,\r\n        extra: action.payload.extra\r\n      });\r\n\r\n    } else if (action.type === REQUEST_SUCCESS) {\r\n      dispatch(errorFetchDatasetAsyncHandler(action.payload.statusCode));\r\n    }\r\n  }\r\n\r\n  return result;\r\n\r\n};\r\n\r\nexport default fetchDatasetAsyncHandlerMiddlewareFactory;\r\n","import {configureStore} from \"@reduxjs/toolkit\";\r\nimport rootReducer from \"./state/rootReducer\";\r\nimport userMiddlewareFactory from \"./middlewares/user/userMiddlewareFactory\";\r\nimport requestMiddlewareFactory from \"./middlewares/request/requestMiddlewareFactory\";\r\nimport {showGenericError, showTranslatedGenericErrorFactory} from \"./utils/other\";\r\nimport configMiddleware from \"./middlewares/config/configMiddleware\";\r\nimport fileSaveMiddleware from \"./middlewares/file-save/middleware\";\r\nimport persistenceMiddleware from \"./middlewares/persistence/middleware\";\r\nimport i18nMiddleware from \"./middlewares/i18n-middleware/middleware\";\r\nimport i18n from \"i18next\";\r\nimport {initReactI18next} from \"react-i18next\";\r\nimport {init as initAction} from \"./state/rootActions\";\r\nimport requestSpinnerMiddlewareFactory\r\n  from \"./middlewares/request-spinner/requestSpinnerMiddlewareFactory\";\r\nimport {getAppConfigUrl, getHubMinimalInfoUrl, getInitConfigUrl} from \"./serverApi/urls\";\r\nimport feedbackMiddlewareFactory from \"./middlewares/feedback/feedbackMiddleware\";\r\nimport fetchDatasetAsyncHandlerMiddlewareFactory\r\n  from \"./middlewares/fetchDatasetAsyncHandler/middlewareFactory\";\r\n\r\nconst init = cb => {\r\n\r\n  fetch(`./${getInitConfigUrl()}`)\r\n    .then(response => response.json())\r\n    .then(({baseURL}) => {\r\n      fetch(`./${getAppConfigUrl()}`)\r\n        .then(response => response.json())\r\n        .then(config => {\r\n\r\n          fetch(`${baseURL}${getHubMinimalInfoUrl()}`)\r\n            .then(response => response.json())\r\n            .then(({hub}) => {\r\n\r\n              Promise.all(\r\n                [\"en\", ...hub.supportedLanguages].map(code =>\r\n                  fetch(`./i18n/${code}.json?random=` + Math.floor(Math.random()*16777215).toString(16))\r\n                    .then(response =>\r\n                      response.headers.get(\"content-type\").indexOf(\"application/json\") !== -1\r\n                        ? response.json()\r\n                        : null\r\n                    )\r\n                    .catch(showGenericError)\r\n                )\r\n              )\r\n                .then(translations => {\r\n\r\n                  let resources = {};\r\n\r\n                  [\"en\", ...hub.supportedLanguages].forEach((code, idx) => {\r\n                    if (translations[idx]) {\r\n                      resources[code] = {translation: translations[idx]}\r\n                    }\r\n                  });\r\n\r\n                  let supportedAndTranslatedLanguages = Object.keys(resources);\r\n\r\n                  if (supportedAndTranslatedLanguages.length < 2) {\r\n                    alert(\"Unable to find translation file for at least one configured language. Please check app configuration and translations file.\");\r\n                  } else if (!hub.supportedLanguages.includes(\"en\")) {\r\n                    supportedAndTranslatedLanguages = supportedAndTranslatedLanguages.filter(lang => lang !== \"en\");\r\n                    delete resources[\"en\"];\r\n                  }\r\n\r\n                  const defaultLanguage =\r\n                    resources[hub.defaultLanguage]\r\n                      ? hub.defaultLanguage\r\n                      : supportedAndTranslatedLanguages[0];\r\n\r\n                  i18n\r\n                    .use(initReactI18next)\r\n                    .init({\r\n                      lng: defaultLanguage,\r\n                      resources,\r\n                      returnEmptyString: false,\r\n                      interpolation: {\r\n                        escapeValue: false\r\n                      }\r\n                    });\r\n\r\n                  const store = configureStore({\r\n                    reducer: rootReducer,\r\n                    middleware: [\r\n                      userMiddlewareFactory(i18n.t.bind(i18n)),\r\n                      requestMiddlewareFactory({\r\n                        onGenericError: showTranslatedGenericErrorFactory(i18n.t.bind(i18n))\r\n                      }),\r\n                      requestSpinnerMiddlewareFactory(i18n.t.bind(i18n)),\r\n                      fileSaveMiddleware,\r\n                      persistenceMiddleware,\r\n                      i18nMiddleware,\r\n                      configMiddleware,\r\n                      feedbackMiddlewareFactory(i18n.t.bind(i18n)),\r\n                      fetchDatasetAsyncHandlerMiddlewareFactory(i18n.t.bind(i18n))\r\n                    ]\r\n                  });\r\n\r\n                  store.dispatch(initAction(baseURL, supportedAndTranslatedLanguages, defaultLanguage, config));\r\n\r\n                  cb(store);\r\n\r\n                })\r\n                .catch(showGenericError);\r\n            })\r\n            .catch(showGenericError);\r\n        })\r\n        .catch(showGenericError);\r\n    })\r\n    .catch(showGenericError);\r\n};\r\n\r\nexport default init;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport 'typeface-roboto';\r\nimport \"fontsource-do-hyeon\";\r\nimport \"./style.css\";\r\nimport 'flag-icon-css/css/flag-icon.css';\r\nimport {Provider} from 'react-redux'\r\nimport init from \"./init\";\r\n\r\ninit(store =>\r\n  ReactDOM.render(\r\n    <Provider store={store}>\r\n      <App/>\r\n    </Provider>,\r\n    document.getElementById('root')\r\n  ));\r\n"],"sourceRoot":""}