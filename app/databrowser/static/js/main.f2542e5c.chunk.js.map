{"version":3,"sources":["dummy/pyramid.jpg","middlewares/request/requestActions.ts","components/not-implemented-snackbar/NotImplementedSnackbar.jsx","state/spinner/spinnerActions.ts","components/spinner/Spinner.jsx","components/error-snackbar/ErrorSnackbar.jsx","components/hero/index.jsx","components/cards-grid/index.jsx","components/page-section/index.jsx","components/page/index.jsx","state/user/userReducer.ts","serverApi/urls.ts","components/user-login-dialog/index.jsx","components/user-logout-dialog/index.jsx","state/usersConfig/usersConfigActions.ts","components/settings-select/users-settings-form/user-settings-form/index.jsx","components/settings-dialog/index.jsx","components/user-select/index.jsx","state/user/userActions.ts","links.js","components/categories-tree/index.jsx","components/button-select/index.jsx","state/hubConfig/hubConfigActions.ts","components/file-input/index.jsx","components/custom-material-table/index.jsx","utils/i18n.js","components/dashboards-manager/index.jsx","state/rootActions.ts","middlewares/persistence/middleware.js","utils/user.ts","components/i18n-input-adornment-select/index.jsx","components/i18n-text-field/index.jsx","components/html-editor/index.jsx","components/i18n-html-editor/index.jsx","components/settings-select/app-settings-form/index.jsx","state/nodesConfig/nodesConfigActions.ts","state/dataset/datasetActions.ts","components/info-tooltip/index.jsx","components/form-label-with-tooltip/index.jsx","utils/download.js","components/settings-select/nodes-settings-form/node-settings-form/index.jsx","state/cache/cacheActions.ts","components/settings-select/nodes-settings-form/cache-setting-form/index.jsx","state/noteTemplatesConfig/nodeTemplatesConfigActions.ts","components/settings-select/nodes-settings-form/templates-settings-form/index.jsx","components/settings-select/nodes-settings-form/permissions-settings-form/index.jsx","state/nodePermissionsConfig/nodePermissionsConfigActions.ts","components/settings-select/nodes-settings-form/dashboards-settings-form/index.jsx","components/settings-select/nodes-settings-form/index.jsx","components/settings-select/users-settings-form/index.jsx","components/settings-select/index.jsx","components/settings-select/actions.js","components/search-input/index.jsx","components/search-dialog/index.jsx","utils/dashboards.js","utils/datasets.js","state/otherConfig/otherConfigActions.ts","components/other-settings-select/views-settings-form/index.jsx","utils/style.js","components/infinite-scroll-table/sort-buttons/index.jsx","components/infinite-scroll-table/contants.js","components/infinite-scroll-table/utils.js","components/auto-search-input/index.jsx","components/infinite-scroll-table/pre-header/index.jsx","components/infinite-scroll-table/footer/index.jsx","components/custom-empty/index.jsx","components/infinite-scroll-table/filter-button/index.jsx","components/infinite-scroll-table/index.jsx","components/selector/index.jsx","components/i18n-delayed-text-field/index.jsx","constants/getDashboardDynamicFilterLabelTranslations.js","components/dashboard-builder/index.jsx","hocs/call/index.jsx","components/label-format-selector/index.jsx","utils/jsonStat.js","utils/formatters.js","components/table/jsonStatTable.js","components/table/Scrollbars.jsx","components/table/index.jsx","utils/tree.js","state/dataset/datasetReducer.ts","components/attribute-list/index.jsx","components/data-viewer/Header.jsx","components/data-viewer/Sidebar.jsx","components/data-viewer/Footer.jsx","components/dataset-filters/index.jsx","components/enhanced-tree/index.jsx","components/criteria/TimePeriod.jsx","components/criteria/index.jsx","components/table-layout/index.jsx","components/font-size-selector/index.jsx","components/chart/index.jsx","components/data-viewer/ChartWrapper.jsx","components/chart-layout/index.jsx","components/map/index.jsx","components/data-viewer/index.jsx","state/dashboard/dashboardReducer.ts","state/dashboard/dashboardActions.ts","components/dashboard/index.jsx","components/other-settings-select/user-dashboards-settings-form/index.jsx","components/other-settings-select/index.jsx","components/node-header/index.jsx","state/app/appActions.ts","components/home/index.jsx","state/hub/hubActions.ts","components/categories-lists/index.jsx","components/node/index.jsx","state/node/nodeActions.ts","state/catalog/catalogActions.ts","components/results/ResultTree.jsx","components/results/index.jsx","components/data/index.jsx","domains/DatasetDomain.jsx","components/dashboard-filters/index.jsx","domains/DashboardsDomain.jsx","domains/NodeDomain.jsx","domains/HubDomain.jsx","components/delete-conflict-modal/index.jsx","state/delete-conflict-modal/deleteConflictModalActions.ts","App.jsx","state/hub/hubReducer.ts","state/node/nodeReducer.ts","model/LocalCategoryProvider.ts","state/rootReducer.ts","state/spinner/spinnerReducer.ts","state/appConfig/appConfigReducer.ts","state/app/appReducer.ts","state/noteTemplatesConfig/nodeTemplatesConfigReducer.ts","state/catalog/catalogReducer.ts","state/hubConfig/hubConfigReducer.ts","state/nodesConfig/nodesConfigReducer.ts","state/cache/cacheReducer.ts","state/otherConfig/otherConfigReducer.ts","state/usersConfig/usersConfigReducer.ts","state/nodePermissionsConfig/nodePermissionsConfigReducer.ts","state/delete-conflict-modal/deleteConflictModalReducer.ts","middlewares/user/userMiddlewareFactory.js","middlewares/request/requestMiddlewareFactory.ts","utils/other.js","middlewares/config/configMiddleware.js","middlewares/file-save/middleware.js","middlewares/i18n-middleware/middleware.js","middlewares/request-spinner/requestSpinnerMiddlewareFactory.js","init.js","index.jsx"],"names":["module","exports","RequestMethod","withTranslation","t","useState","isOpen","setIsOpen","isInitialized","setIsInitialized","useEffect","window","notImplemented","show","Snackbar","anchorOrigin","vertical","horizontal","open","autoHideDuration","onClose","ClickAwayListenerProps","onClickAway","Alert","severity","addSpinnerMessage","uid","message","type","payload","markSpinnerMessage","isError","compose","withStyles","theme","container","width","height","overlay","position","zIndex","progressContainer","display","alignItems","justifyContent","progress","maxWidth","messagesContainer","textAlign","messages","marginTop","childrenContainer","top","messageRow","withTheme","connect","state","spinner","dispatch","flushSpinner","classes","children","isHandlerOn","setIsHandlerOn","addEventListener","Box","className","id","length","style","background","palette","primary","main","LinearProgress","color","map","removed","Grid","key","justify","filter","spacing","item","Typography","error","success","fontSize","overflow","ErrorSnackbar","setMessage","dangerouslySetInnerHTML","__html","root","flexDirection","objectFit","textContainer","lightTextContainer","buttonsContainer","margin","logo","maxHeight","title","slogan","light","Helmet","variant","gutterBottom","card","list","onClick","squareImage","hasImage","find","c","image","i","xs","Card","CardActionArea","CardMedia","component","label","alt","CardContent","PageSection","props","sectiontitle","Divider","Page","transparent","isOldBrowserWarningVisible","handleScroll","scrollTop","pageYOffset","document","documentElement","setState","closeWarning","ref","current","scrollIntoView","behavior","alignToTop","scroll","left","isIE","documentMode","isEdge","StyleMedia","this","removeEventListener","oldBrowserWarning","href","target","rel","IconButton","padding","Zoom","in","Fab","fab","ArrowUpward","Component","right","bottom","appBar","paddingBottom","lineHeight","REQUEST_SUCCESS","UserRoles","UserPermissions","initRequest","url","method","GET","data","extra","baseURL","getHideErrorMessage","hideSpinner","uuid","uuidv4","errorRequest","requestActionPayload","statusCode","response","getDatasetUrl","nodeId","datasetId","getDatasetDownloadUrl","format","observation","getNodeDeleteUrl","force","getDashboardsUrl","dashboardId","field","onSubmit","onHide","onRegister","alert","useForm","register","errors","handleSubmit","useTranslation","Dialog","disableEscapeKeyDown","disableBackdropClick","fullWidth","DialogTitle","DialogContent","FormControl","undefined","TextField","name","email","helperText","required","inputRef","password","DialogActions","Button","UserLogoutDialog","fetchUsersConfigUsers","onStart","Form","paper","tabContent","overflowY","overflowX","forwardRef","config","onCancel","defaultValues","watch","showPassword","setShowPassword","showPasswordConfirm","setShowPasswordConfirm","useImperativeHandle","submit","f","val","cancel","disabled","validate","emailConfirm","surname","organization","InputProps","endAdornment","InputAdornment","aria-label","Visibility","VisibilityOff","passwordConfirm","usersConfig","user","userErrors","fetchConfig","userId","getUserConfigGetUrl","sendConfigCreate","isAnonymous","POST","sendUsersConfigUserCreate","sendConfig","PUT","sendUsersConfigUserEdit","clearConfig","needConfig","setNeedConfig","str","marginBottom","SettingsDialog","hasSubmit","minHeight","avatar","marginRight","onLogin","Email","Password","btoa","fetchUser","onLogout","onLoginFormShow","onLoginFormHide","isLogoutModalOpen","setIsLogoutModalOpen","isRegisterModalOpen","setIsRegisterModalOpen","registerFormRef","useRef","isAuthenticated","isLoginDialogOpen","goToDatasets","nodeCode","categoryPath","toLowerCase","join","goToData","viewId","a11y","goToDatasetsSearch","query","filters","encodeURIComponent","goToNode","goToHome","goToHubDashboards","goToNodeDashboards","CategoriesTree","expanded","selectedCategoryPath","onExpand","node","catalog","getTreeItems","tree","prevPath","cat","TreeItem","includes","nodeIcon","hasAnnotation","size","onDialogOpen","selectedItem","datasetIdentifiers","childrenCategories","Link","code","datasetsCount","categoryGroups","categories","TreeView","defaultCollapseIcon","defaultExpandIcon","onNodeToggle","_","nodeIds","uncategorizedDatasets","content","ButtonSelect","anchorEl","setAnchorEl","el","handleMenu","event","currentTarget","handleClose","icon","value","tooltip","selectedIdx","onChange","Boolean","Item","isSelected","MenuItem","startIcon","endIcon","keepMounted","transformOrigin","fetchHubConfigDashboards","startAdornment","fileInput","substring","lastIndexOf","fileName","setFileName","accept","e","file","files","fileFormData","FormData","append","fetch","body","headers","token","credentials","then","res","json","filePath","catch","htmlFor","CustomMaterialTable","customProps","localization","emptyDataSourceMessage","header","actions","toolbar","searchPlaceholder","searchTooltip","mergedProps","merge","validateI18nObj","obj","pickBy","keys","localizeI18nObj","prefLang","langs","Object","getI18nObjCustomFilterAndSearch","language","languages","row","tableIcons","Search","ResetSearch","SortArrow","tableToolbar","buttonAction","typography","button","app","defaultLanguage","dashboards","allDashboards","fetchDashboards","fetchAllDashboards","addDashboard","removeDashboard","sendDashboardsOrders","clearDashboards","clearAllDashboards","needFetch","setNeedFetch","destroy","orderedDashboardsIds","components","Container","columns","render","customFilterAndSearch","assigned","dashboard","AddIcon","options","paging","draggable","actionsColumnIndex","searchFieldAlignment","maxBodyHeight","showTitle","icons","tableData","ArrowDropUpIcon","rowIndex","slice","ArrowDropDownIcon","DeleteIcon","INIT","persistenceMiddleware","getState","next","action","JSON","parse","localStorage","getItem","result","setItem","stringify","supportedLanguages","initialState","roles","permissions","refreshTokenExpiration","tokenTTL","tokenReceivedTime","delayedRequest","userReducer","Date","getTime","request","getPermissionStr","permission","canDisplayAppSettingsForm","Administrator","canCreateNode","canSortNodes","canDisplayNodesSettingsForm","p","startsWith","ManageCache","ManageTemplate","ManageConfig","canDisplayUsersSettingsForm","canDisplayCacheSettingForm","canDisplayTemplatesSettingsForm","canSaveTemplate","canEditNode","canDisplayUserViews","canSaveAsView","canClearServerCache","canGetQueryLog","canDisplayPermissionsSettingsForm","canManagePersonalDashboards","canManageAppDashboards","canDeleteNodes","canViewTemplateOrAnnotationIcon","CUSTOM_LANG_TO_COUNTRY","en","langToCountry","setLangToCountry","forEach","langCode","CountryLanguage","getLanguageCountries","err","countries","code_2","lang","data-value","ConnectedComponent","textFieldProps","setLanguage","I18nTextField","HtmlEditor","getInitState","handleEditorChange","bind","editor","getData","items","readOnly","onBeforeLoad","CKEDITOR","disableAutoInline","React","preToolbar","htmlEditorProps","I18nHtmlEditor","tab","setTab","dashboardsManagerRef","createRef","configExtras","extras","pageSize","PageSize","setValue","min","Tabs","Tab","Autocomplete","multiple","freeSolo","renderTags","getTagProps","option","index","Chip","renderInput","params","placeholder","marginLeft","select","maxObservationsAfterCriteria","maxCells","Number","hubConfig","hub","hubDashboards","sendHubConfig","getAddHubDashboardUrl","addHubConfigDashboardsDashboard","getRemoveHubDashboardUrl","DELETE","removeHubConfigDashboardsDashboard","orderedDashboarIds","fetchNodesConfigNodes","fetchNodesConfigNodeDashboards","getNodeDashboardsUrl","getCriteriaObject","push","filterValues","InfoTooltip","placement","transform","FormLabelWithTooltip","tooltipOnRight","Tooltip","pointerEvents","downloadFormats","genericdata","extension","genericdata20","compactdata","structurespecificdata","jsondata","csv","getDownloadFormatLabelFromFormat","getDownloadFormatExtensionFromFormat","mustChangeTabOnErrors","setMustChangeTabOnErrors","annotationConfig","showCategoryLevels","decimalNumber","decimalSeparator","catalogNavigationMode","hiddenAttributes","restDataResponseXml","enableHttpAuth","enableProxy","optimizeCallWithSoap","namespaceV20","namespaceV21","isPublic","validator","isPort","firstFieldWithErrors","toUpperCase","inputProps","textTransform","agency","FormControlLabel","control","Checkbox","checked","Paper","sm","criteriaSelectionMode","endPoint","authHttpUsername","proxyAddress","proxyPort","ttlCatalog","ttlDataflow","helper","getOptionLabel","nodesConfig","getNodeConfigGetUrl","fetchNodesConfigNode","sendNodesConfigNodeEdit","fetchDataflowCache","getDataflowsCacheListUrl","Delete","Edit","Check","Clear","Add","wellFormattedTimeString","days","hours","mins","sec","cacheConfig","fetchCache","clearCache","updateCache","cacheId","ttl","getDataflowsCacheUpdateUrl","updateDataflowCache","createCache","getDataflowsCreateCacheUrl","oldData","createDataflowCache","deleteFromCache","getDataflowsClearCacheUrl","deleteDataflowCache","deleteAllFromCache","getDataflowsClearAllCacheUrl","deleteAllDataflowCache","deleteCatalogCache","getClearNodeCatalogMemoryCacheUrl","hideEmptyDataflowCache","setEmptyDataflowCacheHidden","emptyRowsCounter","setEmptyRowsCounter","rowsCounter","setRowsCounter","cacheSize","editable","rowData","totalSeconds","Math","floor","minutes","seconds","round","secondsToHms","onRowUpdate","newData","Promise","resolve","reject","onRowDelete","dataDelete","splice","editRow","deleteText","editTooltip","deleteTooltip","fetchNodeTemplatesConfig","getNodeTemplatesUrl","templates","nodeTemplatesConfig","fetchTemplates","deleteTemplate","getDeleteTemplateUrl","deleteNodeTemplatesConfigTemplate","clearTemplates","nodes","defaultNodeOpen","needTemplates","setNeedTemplates","deleteTemplateId","setDeleteTemplateId","viewTemplateId","autoFocus","styles","PERMISSIONS","userVal","nodePermissions","ev","nodePermissionsConfig","getNodePermissionsConfigGetUrl","fetchNodePermissionsConfig","getNodePermissionsConfigPutUrl","sendNodePermissionsConfig","nodeDashboards","getAddNodeDashboardUrl","addNodesConfigDashboardsNodeDashboard","getRemoveNodeDashboardUrl","removeNodesConfigDashboardsNodeDashboard","dashboardsIds","getOrderNodeDashboardsUrl","sendNodesConfigDashboardsNodeOrders","sendOrders","orderedIds","sendNodesConfigNodesOrder","deleteNode","onForce","deleteNodesConfigNode","isNodeFormVisible","setNodeFormVisibility","nodeFormNodeId","setNodeFormNodeId","nodeDeleteFormNodeId","setNodeDeleteFormNodeId","cacheFormNodeId","setCacheFormNodeId","isCacheFormVisible","setCacheFormVisibility","templatesNodeId","setTemplatesNodeId","permissionsNodeId","setPermissionsNodeId","dashboardsNodeId","setDashboardsNodeId","nodeFormRef","cacheFormRef","templatesRef","permissionsRef","dashboardsRef","orderedNodes","sort","a","b","order","orderedNodesIds","Toolbar","active","PersonIcon","canManageNodeDashboards","DashboardIcon","EditIcon","false","users","deleteUser","getUserDeleteUrl","deleteUsersConfigUser","onUserFormShow","showUserConfigForm","onUserFormHide","userDeleteFormUserId","setUserDeleteFormUserId","userFormRef","SettingsSelect","isAppOpen","isNodesOpen","isUsersOpen","appSettingsRef","nodesSettingsRef","usersSettingsRef","isLogDownloadOpen","logLimit","onAppOpen","onAppClose","showSnackbar","isAppSubmitSnackbarVisible","onNodesOpen","onNodesClose","onUsersOpen","onUsersClose","onLogDownloadOpen","onLogDownloadClose","onLogLimitSet","isNaN","onLogDownload","onCacheClear","Input","limit","getQueryLog","fileSave","stringifyResponse","downloadQueryLog","borderRadius","shape","backgroundColor","borderColor","borderWidth","inputRoot","inputInput","input","defaultValue","onKeyDown","preventDefault","$","jQuery","fade","common","white","dialogTop","modalWidth","onRendered","focus","PaperProps","emptyDashboardElem","getViewIdxFromRowAndCol","rowIdx","colIdx","getCriteriaRequestObject","criteria","fetchOtherConfigViews","getNewDashboard","newDashboard","cloneDeep","ids","dashboardConfig","col","filterDimension","newFilterLevels","labels","filterLevels","viewIds","views","otherConfig","fetchViews","clearViews","deleteView","getDeleteViewUrl","deleteOtherConfigView","needViews","setNeedViews","deleteViewId","setDeleteViewId","deleteViewNodeId","setDeleteViewNodeId","getScrollBarWidth","temp","css","visibility","appendTo","widthWithScroll","outerWidth","remove","getTextWidth","text","element","innerText","offsetWidth","SortButtons","CHECKBOX_WIDTH","DATA_INDEX_CHECKED","DEFAULT_PAGE_SIZE","getIndexesFromPaginationParams","pageNum","startIdx","stopIdx","AutoSearchInput","tempValue","timeout","onClear","clearTimeout","onSearch","setTimeout","nextProps","searchText","selectedRowCount","tableActions","renderTableAction","leftActions","rightActions","isLoading","isHidden","rowNumStart","rowNumEnd","rowCount","CircularProgress","fontStyle","textStyle","FilterButton","Popover","InfiniteScrollTable","onSearchTextChange","onFiltersChange","onSortChange","getSelectedRowKeys","onRowSelectionChange","getCols","getNormalizedTableActions","renderActions","renderGridRow","renderFixedActions","renderHeaderCells","renderCheckboxTitle","renderCheckbox","getPopulatedRows","getColWidths","getQueriedRows","getRenderedRows","onRenderedRowsChange","gridKeyForRefresh","scrollLeft","gridScrollbarWidth","sortCol","sortByDesc","selectedRowKeys","rowSelection","cols","populatedRows","colWidths","renderedRows","queriedRows","isResizing","resizeTimeout","pageRequestTimeout","isPaginating","isPaginated","pageRequestParams","viewStartIdx","viewEndIdx","viewIndexesUpdateTimeout","doNotCallOnChangeOnNextRenderedRowsChange","rows","multilangStrDataIndexes","fixedActions","altActions","getIsAltRow","getActionsObjs","populatedRow","dataIndex","getTextWidthEl","get","colTitleWidth","noFilter","noSort","CELL_PADDING","max","widthToContent","minWidthToContent","renderText","minWidth","isVariableSizeCol","variableSizeCols","colWidthsSum","availableWidth","getIsVerticalScrollbarVisible","widthToAdd","colWidth","colIndex","colsWidths","getRowKey","resRow","getFilteredGridRows","getSearchTextFilteredGridRows","getSortedGridRows","prevProps","isArrayPropertyChangedLazy","newCols","newPopulatedRows","newColWidths","newRenderedRows","newQueriedRows","newScrollTop","$grid","updateRenderedRows","_this","addClass","on","newScrollLeft","off","nextState","nextContext","newFilters","newPageRequestParams","applyQueryChange","newSearchText","colDataIndex","direction","newSortCol","newSortByDesc","rowKey","selected","getIsDisabledRow","onSelect","onSelectAll","newSelectedRowKeys","selRowKey","titleRender","noSearchText","getNormalizedFixedActions","disableOnRowClickForCell","getNormalizedActions","getNormalizedAltActions","hasOwnProperty","withValuesFilter","isValuePassingSearchText","column","_a","_b","sorter","defaultSorter","onRowClick","getRowStyle","cellData","isRowClickDisabled","colLeftAttr","rowStyle","ROW_HEIGHT","cursor","columnWidths","uniq","stopPropagation","checkboxProps","getCheckboxProps","overscanStartIdx","overscanEndIdx","currentPageIndexes","pageRowsThird","MAX_PAGE_SIZE","newPaginationParams","maxIdx","minPageSize","maxPageSize","pageNumForMinPageSize","isInteger","minPageNum","ceil","maxPageNum","indexes","getPaginationParamsFromIndexes","rowNum","showHeader","autoSearch","sum","itemSize","itemCount","initialScrollOffset","onItemsRendered","visibleStartIndex","visibleStopIndex","overscanStartIndex","overscanStopIndex","String","prevProp","prop","isDesc","normalize","withSize","iconStyle","Selector","callOnChange","detailTitle","selectTitle","resetTitle","onDetail","onReset","emptyValue","getInitialInternalValue","internalValue","setInternalValue","timeoutId","setTimeoutId","setValueForLanguage","newInternalValue","I18nDelayedTextField","getDashboardDynamicFilterLabelTranslations","Region","Province","Municipality","translations","getStrippedHtmlText","html","$span","innerHTML","textContent","DashboardBuilderCol","onColRemove","onTypeReset","onViewReset","onTextEdit","onShowTitleChange","onEnableFiltersChange","onFilterDimensionChange","colContainer","viewContainer","view","formLabel","labelPlacement","dynamicViewInput","htmlInput","multiline","viewAction","colActions","DashboardBuilderRow","onRowRemove","onColAdd","rowContainer","idx","rowActions","rowAction","border","verticalAlign","VIEW_ACTION_WIDTH","onViewsHide","selectedRowIdx","setSelectedRowIdx","selectedColIdx","setSelectedColIdx","isEditTextVisible","setEditTextVisibility","tempTextValue","setTempTextValue","handleRowRemove","handleColAdd","handleColRemove","handleTypeReset","handleViewReset","handleEditTextShow","handleEditTextHide","handleShowTitleChange","handleEnableFiltersChange","handleFilterDimensionChange","__originalRow","handleViewSet","handleTextChange","Call","cb","cbParam","formControl","menuItem","labelFormat","setLabelFormat","Select","toUpperCaseFirst","string","getDimensionLabelFromJsonStat","jsonStat","dimension","getDimensionValueLabelFromJsonStat","category","getDataIdxFromDimensionsArray","dimensions","dataIdx","multiplier","getJsonStatTableSize","layout","count","colCount","indexOf","sections","section","getCombinationArray","dimsArrays","test","ret","arr","j","l","getInitialFiltersValue","fixedFiltersValue","dims","concat","indexesMap","getDimensionValuesIndexesMap","dim","reverse","unorderedDimCombination","combination","orderedDims","unorderedDims","dimCombination","isValorized","filtersValue","getFilteredLayoutObject","initialLayout","dimArraysKey","getDimensionFiltersValue","values","addedValues","dimValue","dimensionsNotInFilters","dimensionsPostFilter","arrays","dataIndexArr","combinationValue","getChartDimensionValues","getAttributeObjects","attributeList","attributeObj","attributes","hasAsterisk","attr","valueId","valueLabel","getDimensionAttributeMap","getIdsHtmlString","series","seriesIndexes","dimensionAttributesMap","coordinates","dimIdx","findIndex","dimValueIdx","attributeObjects","htmlString","numberFormatter","Intl","NumberFormat","getFormattedInt","separator","subStrs","pop","subStr","extendArr","array","n","Array","apply","getObj","isPreview","repCount","getValorizedElCount","getCorrespondingIndexInFilteredArray","lastIdx","found","getCellAttributeIdsElem","isDataCell","idElems","getJsonStatTableSupportStructures","removeEmptyLines","rowsObj","colsObj","sectionArray","combinations","getCombinationArrays","getJsonStatLayoutObjects","valorizedRowsPerSection","valorizedCols","fill","setValorizedLines","dataObj","r","valorizedRows","totalRowCount","prototype","flat","observations","observationIndexes","observationAttributesMap","hasAttributeObservationError","sectionsLength","getTableRightPadding","getJsonStatTableHtml","decimalPlaces","emptyChar","paginationParams","onTimeSet","origColStart","colStart","origColEnd","colEnd","rowStart","rowEnd","t0","performance","now","table","colVisited","cc","fullColSpan","colSpan","tableRightPadding","sectionLabel","rr","sectionsStarts","subHeaderHandled","currentSectionIdx","getSectionRow","sectionRow","currentSectionIdxClone","subHeader","rowSpan","getDataCell","intSeparator","int","decimal","toFixed","getFormattedValue","t1","timeoutID","intervalID","isOnMouseDownOnSliderThumb","CustomSlider","orientation","maxValue","onIncrement","ticks","isVerticalScrollbarVisible","onMouseUp","clearInterval","handleChange","newValue","sliderId","step","containerRect","getBoundingClientRect","clientY","clientX","isEventInContainer","setInterval","sliderButton","onMouseDown","Slider","track","verticalSlider","SLIDER_WIDTH","horizontalSlider","opacity","spinnerOverlay","verticalValue","verticalMaxValue","verticalTicks","onVerticalScroll","horizontalValue","horizontalMaxValue","horizontalTicks","onHorizontalScroll","isHorizontalScrollbarVisible","setRow","setCol","setIsPaginating","handleSliderScroll","isVertical","getIncrementedValue","prevValue","delta","isIncrement","handleIncrement","prevRow","prevCol","handleWheelScroll","useCallback","wheelDeltaY","wheelDelta","wheelDeltaX","isBetween","newRow","newCol","getElementById","fontWeight","isElementInContainer","checkOnlyVertical","elementRect","getAttributesValueString","time","setDatasetHtmlGeneratingTime","isFullscreen","isStickyHeader","spinnerUuid","isFirstRender","setIsFirstRender","tableSupportStructures","setTableSupportStructures","htmlTable","setHtmlTable","visibleRowCount","setVisibleRowCount","visibleColCount","setVisibleColCount","setTableRightPadding","setHorizontalScrollbarVisibility","setVerticalScrollbarVisibility","setAttributes","isCopiedVisible","setCopiedVisibility","handleSnackbar","prevVal","handleStyle","$tooltip","hover","$elem","rect","split","x","innerWidth","empty","click","cell","cellFontSize","cellPaddingLeft","cellPaddingRight","each","stickyRowCount","stickyColCount","tops","$headerRows","lefts","$firstBodyRowThs","handleScrollbar","updateVisibleRowAndColCount","$tableContainer","$table","prevIsVerticalScrollbarVisible","prevIsHorizontalScrollbarVisible","func","copy","getNodesAtDepth","childrenKey","depth","recursive","subTree","currDepth","getTreeFromArray","parentKey","mappedArr","getCompleteTableLayout","getMinAndMax","moment","add","frequencies","getFreq","freq","dataset","isPartialData","isEmptyData","isTooBigData","isCriteriaVisible","isCriteriaAlertVisible","mode","viewerIdx","hasViewTemplate","hasTemplateLayout","hasAnnotationLayout","initialTableLayout","initialChartLayout","initialMapLayout","initialFilters","enableCriteria","enableLayout","maxAllowedCells","territorialDims","codes","isCodesFlat","codelists","areCodelistsFlat","codelistsLength","timePeriod","minDate","maxDate","fromDate","toDate","timings","isFetchStructureDisabled","isFetchDatasetDisabled","isDownloadWarningVisible","isUnavailableViewWarningVisible","isCriteriaLengthWarningVisible","geometries","geometryDetailLevels","datasetReducer","criteriaView","VIEW_KEY","TEMPLATE_KEY","viewTemplate","viewTemplateLayouts","layouts","tableLayout","mapLayout","chartLayout","filterData","dimensionsId","getViewerIdxFromType","defaultView","defaultlanguage","tableEmptyChar","emptyCellPlaceHolder","territorialDimensions","maxTableCells","cellCount","isResponseNotValid","status","responseHeaders","backendtimers","flatCodes","codelistIdx","newCodelistsLength","parentId","minAndMax","flatCodelists","codelist","timePeriodIdx","freqIdx","detailLevels","nutsLevel","reduce","acc","level","counter","v","console","log","isPayloadTooLarge","Attribute","attribute","cardTitle","datasetAttributesCard","datasetAttributes","seriesAttributes","attributeGroup","otherAttributes","CardHeader","disableTypography","headerTitle","headerActions","titleAction","subtitle","viewer","paddingTop","attributeIcon","fontFamily","nodeDownloadFormats","datasetTitle","notes","attachedFiles","initialDecimalSeparator","viewers","onViewTemplateSubmit","onDownloadSubmit","tableDefaultLayout","initialTemplate","isViewVisible","setViewVisibility","isTemplateVisible","setTemplateVisibility","tabId","setTabId","template","setTemplate","isAttributesVisible","setAttributesVisibility","isNotesVisible","setNotesVisibility","setDownloadFormats","isTimingsVisible","setTimingsVisibility","actionsWidth","setAttribute","newDownloadFormats","isDownloadFormatValid","handleViewClose","handleTemplateClose","dataSet","datasetIndexes","dimsId","dimsValueId","attrs","currentFilters","dimLabel","canViewTimesLog","handleViewOpen","handleTemplateOpen","canShare","attachedFile","toStamp","getRow","isBold","titleStyle","fullScreen","AppBar","scrollButtons","indicatorColor","textColor","titleTypographyProps","hideDimensions","enableVariation","lastPeriods","floatingMenuOption","floatingMenuOptionSelected","divider","categoryTitle","referenceMetadataIcon","iFrame","referenceMetadataUrl","onViewerSelect","onCriteriaOpen","onLayoutOpen","isRefMetaVisible","setRefMetaVisibility","handleViewerSelect","isCriteriaEnabled","isLayoutEnabled","MenuList","BottomNavigation","showLabels","BottomNavigationAction","src","whiteSpace","sheet","setData","isConfirmOpen","setConfirmVisibility","deleteIcon","onDelete","getFormattedName","dialogContent","itemDisabled","dimensionTitle","multiSelectDimensions","multiSelectDimensionsValues","visibleId","setVisibleId","checkedKeys","setCheckedKeys","handleFilterClose","isMultiSelectDim","InputLabel","renderValue","onOpen","getKeys","getNodeKey","handleHeight","withLevelSelector","actionHeight","levelSelectorHeight","treeActions","treeNode","treeNodeCheckbox","treeNodeLabel","levelTreeNodeLabel","treeNodeAction","showMoreNode","labelKey","getNodeLabel","checkable","defaultExpandedKeys","nodeActions","withoutSearch","withoutCheckControls","withoutExpandControls","withoutPagination","getIsCheckable","isLabelNotMultilingual","setSearchText","expandedKeys","setExpandedKeys","showMoreKeyClicks","setShowMoreKeyClicks","handleCheck","checkedNode","newCheckedKeys","onCheck","handleLevelCheck","nodesAtDepth","filteredTree","handleExpand","getShowMoreNode","parent","remaining","more","getTreeNode","isLevelTree","act","some","child","filterNode","search","subtree","filteredChildren","getFilteredTree","levelTree","maxTreeDepth","getMaxTreeDepth","TREE_NODE_KEY_OF_LEVEL_PREFIX","pointer","disableSelection","periods","year","S1","start","end","endOf","S2","Q1","Q2","Q3","Q4","getYearsArray","startYear","endYear","startYearNumeric","endYearNumeric","getPeriod","date","dateMoment","period","getNewFiltersFromYear","minYear","maxYear","minPeriod","maxPeriod","timePeriodKey","isFrom","newDate","isSameOrAfter","isSameOrBefore","handleSetFilters","onSetFilters","setCriteriaValidity","selectContainer","timePeriodInput","isCriteriaValid","fromYear","toYear","fromPeriod","toPeriod","fromPeriods","toPeriods","utils","DateFnsUtils","DatePicker","openTo","clearable","treeContainer","timePeriodContainer","codelistInfo","structure","fetchCodelist","dimensionId","flatCriteria","getDatasetStructureDynamicCodelistUrl","isFull","getDatasetStructureCodelistUrl","fetchDatasetStructureCodelist","fetchCodelists","getDatasetStructureCodelistsUrl","fetchDatasetStructureCodelists","setDatasetStructureCodelistFilters","isCallDisabled","setIsCallDisabled","tmpFilters","setTmpFilters","tmpTabId","setTmpTabId","filtersToRemove","handleTabChange","DataStructureRef","isSelectable","childrenKeys","unselectedChildrenKeys","onDragEnd","setDimensions","source","destination","newDimensions","droppableId","startIndex","endIndex","reorder","droppableSource","droppableDestination","move","Section","Icon","sectionHeaderIcon","sectionHeaderTitle","sectionHeaderContainer","provided","snapshot","sectionContentWrapper","isDraggingOver","draggingHover","innerRef","sectionContent","draggableId","draggableProps","dragHandleProps","isDragging","draggableStyle","userSelect","sectionItem","sectionContainer","previewContainer","setLayout","getFontSizeIcon","styleClasses","fontSizeIcon","fontSizeIconSm","fontSizeIconMd","fontSizeIconLg","fontSizeSelected","boxShadow","setFontSize","colors","hexToRGBA","hex","alpha","parseInt","getOptions","chartType","responsive","maintainAspectRatio","scales","xAxes","gridLines","beginAtZero","callback","yAxes","tooltips","enabled","callbacks","tooltipItem","datasets","datasetIndex","primaryDim","primaryDimValues","secondaryDim","secondaryDimValues","valorizedDataMap","secondaryDimValue","primaryDimValue","dimValueArray","valueIdx","isBarOrLineGraph","colorArr","ds","lineTension","Chart","chartRef","ChartJs","defaults","global","defaultFontFamily","myChart","update","ChartWrapper","pyramid","sourceArr","destinationArr","removedSrc","removedDst","swap","sectionClasses","isDragDisabled","sectionLeft","sectionRight","addSpinner","markSpinner","onGeometryFetch","currentDetailLevel","setCurrentDetailLevel","filteredGeometries","setFilteredGeometries","firstNotEmptyLevelIndex","LMap","destroyMap","mapTranslations","configure","from","to","classification","equalInterval","naturalBreaks","quantile","numberOfClasses","startColor","endColor","preview","layerOptions","srid","legendSettings","paletteStartColor","paletteEndColor","paletteCardinality","pointStartRadius","pointEndRadius","pointRadiusCardinality","classificationMethod","onDataRender","valueFormatter","centerMarker","centerMarkerText","selectedCenterMarker","mapOptions","baseMap","baseMapToGray","onLoadingStart","onLoadingFinish","legendFontFamily","WebFont","load","google","families","initMap","addLayer","geometryMap","g","missingGeometryList","territoryDim","geomId","missingEntry","filtersValues","territoryDimName","dimensionFilterValues","levelsCounter","geom","uniqueId","wkt","lev","FREQ_KEY","viewerType","titleHeight","offsetHeight","headerHeight","footerHeight","filtersAndActionsHeight","page","sidebar","viewerContainer","filtersAndActions","footer","warningAlert","criteriaContent","fetchDataset","checkCriteriaLength","fetchAccessibleDataset","onFetchDatasetEnable","onCriteriaShow","onCriteriaHide","onCriteriaAlertHide","onViewerChange","setDatasetViewer","onLabelFormatChange","setDatasetLabelFormat","submitDatasetDownload","onDownloadHide","isView","getCreateViewUrl","getCreateTemplateUrl","submitDatasetViewTemplate","onUnavailableViewHide","onCriteriaLengthWarningHide","idList","fetchDatasetGeometries","onDatasetReset","nodeExtras","isAccessible","maxObservation","setJsonStat","setTableLayout","tmpTableLayout","setTmpTableLayout","setChartLayout","tmpChartLayout","setTmpChartLayout","setMapLayout","isLayoutVisible","setLayoutVisibility","setFullscreen","newTableLayout","newColCount","newRowCount","getInitialTableLayout","newChartLayout","getInitialChartLayout","newMapLayout","geoId","role","geo","getInitialMapLayout","handleLayoutClose","handleLayoutSubmit","handleCriteriaClose","handleFilterSelect","getUpdatedLayout","newLayout","fixedFilters","DownloadFormats","HiddenAttributes","classList","jsonStats","maps","dashboardReducer","currentDashboardJsonStats","viewIdx","requestIds","requestId","controllersHeight","DashboardCol","filterValue","viewLayouts","fetchMapGeometries","handleFullscreen","widthPercentage","float","viewPlaceholder","staticFilters","viewControllers","viewTitle","viewStaticFilters","viewStaticFilter","viewActiveFilters","DashboardRow","setViewLayouts","prevViewLayouts","newViewLayouts","getStaticDashboard","staticDashboard","initialDashboard","needDashboards","dashboardViews","dashboardJsonStats","dashboardMaps","createDashboard","createOtherConfigDashboard","updateDashboard","updateOtherConfigDashboard","changeDashboard","changeOtherConfigDashboard","submitDashboardCreate","submitOtherConfigDashboardCreate","submitDashboardUpdate","getUpdateDashboardUrl","submitOtherConfigDashboardUpdate","deleteDashboard","getDeleteDashboardUrl","deleteOtherConfigDashboard","hideDashboard","fetchOtherConfigDashboardsDataset","fetchOtherConfigDashboardsMapGeometries","clearDatasets","deleteDashboardId","setDeleteDashboardId","updateDashboardId","setUpdateDashboardId","isPreviewVisible","setPreviewVisibility","VisibilityIcon","goToDashboard","requests","newCriteria","isEqual","OtherSettingsSelect","isViewsOpen","isDashboardsOpen","viewsSettigsRef","dashboardsSettingsRef","onViewsOpen","onViewsClose","onDashboardsOpen","onDashboardsClose","NodeHeader","isDrawerOpen","defaultTreeOpen","onDrawerOpen","onDrawerClose","shortName","defaultAppConfigOpen","defaultUsersConfigOpen","defaultNodesConfigOpen","defaultNodeConfigOpen","noNode","onLanguageChange","leftContainer","leftToolbar","menuButton","edge","centerContainer","logoURL","sistanLogo","rightContainer","defaultAppOpen","defaultNodesOpen","defaultUsersOpen","Drawer","anchor","drawer","drawerHeader","drawerHeaderTitle","underline","location","reload","drawerCategories","drawerCategoriesTitle","flexGrow","breakpoints","up","mixins","setAppLanguage","withRouter","Home","info","nodesRef","isListMode","defaultUserConfigOpen","backgroundMediaURL","match","autoPlay","muted","loop","description","fullWidthContainer","anchorContainer","nodesContainer","footerContent","footerImage","transition","toolbarButtons","fetchHub","paddingLeft","paddingRight","cardContainer","default","link","categoriesChunk","rootCategory","fontSizes","Subtree","parentPath","ListItem","ListItemText","Node","configIsListMode","categorySchemeTab","onListModeToggle","setCategorySchemeTab","nodeMinimalInfo","uncategorizedCategory","identifier","categoriesForExplore","categoriesContainer","categorySchemesTabs","fetchNode","getNodeUrl","fetchCatalog","getNodeCatalogUrl","resCount","checkbox","categoryGroupsWithCount","uncategorizedDatasetsCount","setExpanded","uncategorizedSelected","flexWrap","path","Results","isDialogOpen","expandedIndexes","isA11yMode","onDialogClose","expand","collapse","onA11yModeToggle","subCategories","categoryPathLabels","Breadcrumbs","results","subCat","isExpanded","resultSource","keywords","expandedDescription","collapsedDescription","keyword","expandIcon","cardContent","cubeIcon","expansion","pager","hubExtras","onFetchStructureEnable","enableDatasetStructureFetch","fetchStructure","getDatasetStructureUrl","fetchDatasetStructure","isReset","setIsReset","getLabelsMap","getNodes","isFilterEnabled","selectValues","setSelectValues","lastValorizedIdx","setLastValorizedIdx","onFilterApply","isApplyDisabled","setIsApplyDisable","labelsMap","getNode","foundNodes","foundNodesInChild","selects","newSelectedValues","getIsFilterEnabled","fetchDashboard","fetchDashboardsDashboard","setDatasetFetchEnableStatus","setDashboardsDatasetFetchEnableStatus","fetchDashboardsDataset","fetchDashboardsMapGeometries","commonsFilters","dashboardHeader","dashboardTabs","dashboardTitle","setFilterValue","allowedDashboards","setAllowedDashboards","currentDashboardId","setCurrentDashboardId","fetchedDashboards","setFetchedDashboards","tabIdx","setTabIdx","newCurrentDashboardId","newFetchedDashboards","static","dynamic","handleFilterApply","newFetchedDashboard","handleFetchDatasets","fetchStatic","fetchDynamic","dynamicFilterValue","addRequest","defaultFilterValue","newFilterValue","nodeHavingCode","Recursive","exact","viewParam","URLSearchParams","a11yParam","note","attachedDataFiles","referenceMetadata","datasetsIdsOrDatasetId","getDatasetsIdsAndSubcategoriesOrDatasetId","datasetsIds","lastCategory","datasetIds","nextCategory","categoryId","decodeURIComponent","filteredCatIds","Set","datasetSatisfyQueryOrKeywords","datasetsSatisfyQueryOrKeywords","datasetsSatisfyFilters","searchRecursive","parentCategorySatisfyFilters","catSatisfyFilters","group","datasetsSatisfyQueryOrKeywordsMap","recursiveCountAndFilterZero","dsId","datasetsSatisfyFiltersMap","uniqueDatasets","filtered","deleteConflictModal","usedBy","getObjectTranslation","createMuiTheme","dark","contrastText","secondary","ThemeProvider","CssBaseline","hubReducer","nodeReducer","LocalCategoryProvider","categ","rootReducer","datasetMap","datasetUncategorized","newState","dataflowId","cachedDataflow","haveError","onDeleteConflictForce","userMiddlewareFactory","getMinutes","requestMiddlewareFactory","handleSuccess","requestAction","onSuccess","successRequest","handleGenericError","onGenericError","handleError","onManagedServerError","handleManagedServerError","axios","withCredentials","toString","showGenericError","configMiddleware","fileSaveMiddleware","FileSaver","saveAs","Blob","i18nMiddleware","i18n","changeLanguage","requestSpinnerMiddlewareFactory","spinnerState","all","resources","translation","supportedAndTranslatedLanguages","use","initReactI18next","init","lng","returnEmptyString","interpolation","escapeValue","store","configureStore","reducer","middleware","initAction","ReactDOM"],"mappings":"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","file":"static/js/main.f2542e5c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/pyramid.42952a0f.jpg\";","import {v4 as uuidv4} from 'uuid';\r\n\r\nexport const REQUEST_INIT = \"request/init\";\r\nexport const REQUEST_START = \"request/start\";\r\nexport const REQUEST_ERROR = \"request/error\";\r\nexport const REQUEST_SUCCESS = \"request/success\";\r\n\r\nexport enum RequestMethod {\r\n  GET = \"GET\",\r\n  POST = \"POST\",\r\n  PUT = \"PUT\",\r\n  DELETE = \"DELETE\"\r\n}\r\n\r\ntype RequestMessages = (t: (str: string, options?: any) => string) => {\r\n  onStart?: string,\r\n  onSuccess?: string,\r\n  onError?: string\r\n};\r\n\r\nexport interface RequestActionPayload {\r\n  label: string,\r\n  url: string,\r\n  method: RequestMethod,\r\n  data?: any,\r\n  messages?: RequestMessages,\r\n  extra?: any,\r\n  baseURL?: string,\r\n  getHideErrorMessage?: any,\r\n  hideSpinner?: boolean,\r\n  uuid: string\r\n}\r\n\r\nexport const initRequest = (\r\n  label: string,\r\n  url: string,\r\n  method: RequestMethod = RequestMethod.GET,\r\n  data?: any,\r\n  messages?: RequestMessages,\r\n  extra?: any,\r\n  baseURL?: string,\r\n  getHideErrorMessage?: any,\r\n  hideSpinner?: boolean\r\n) => ({\r\n  type: REQUEST_INIT,\r\n  payload: {\r\n    uuid: uuidv4(),\r\n    label,\r\n    url,\r\n    method,\r\n    data,\r\n    messages,\r\n    extra,\r\n    baseURL,\r\n    getHideErrorMessage,\r\n    hideSpinner\r\n  }\r\n});\r\n\r\nexport const startRequest = (initRequestPayload: RequestActionPayload) => ({\r\n  type: REQUEST_START,\r\n  payload: initRequestPayload\r\n});\r\n\r\nexport const successRequest = (requestActionPayload: RequestActionPayload, response?: any, extra?: any) => ({\r\n  type: REQUEST_SUCCESS,\r\n  payload: {\r\n    ...requestActionPayload,\r\n    response,\r\n    extra: {\r\n      ...extra,\r\n      ...requestActionPayload.extra\r\n    }\r\n  }\r\n});\r\n\r\nexport type ManagedServerError = {\r\n  errorCode: number,\r\n  stackTrace?: string\r\n};\r\n\r\nexport const errorRequest = (\r\n  requestActionPayload: RequestActionPayload,\r\n  statusCode?: number,\r\n  response?: any,\r\n  extra?: any\r\n) => ({\r\n  type: REQUEST_ERROR,\r\n  payload: {\r\n    ...requestActionPayload,\r\n    statusCode,\r\n    response,\r\n    extra: {\r\n      ...extra,\r\n      ...requestActionPayload.extra\r\n    }\r\n  }\r\n});\r\n","import React, {useEffect, useState} from 'react';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\n\r\nconst NotImplementedSnackbar = ({t}) => {\r\n\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isInitialized) {\r\n      window.notImplemented = {\r\n        show: () => {\r\n          setIsOpen(true);\r\n        }\r\n      };\r\n      setIsInitialized(true);\r\n    }\r\n  }, [isInitialized]);\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{vertical: 'top', horizontal: 'center'}}\r\n      open={isOpen}\r\n      autoHideDuration={5000}\r\n      onClose={() => setIsOpen(false)}\r\n      ClickAwayListenerProps={{\r\n        onClickAway: () => {\r\n        }\r\n      }}\r\n    >\r\n      <Alert severity=\"warning\">{t(\"components.notImplementedSnackbar.label\")}</Alert>\r\n    </Snackbar>\r\n  );\r\n};\r\n\r\nexport default withTranslation()(NotImplementedSnackbar);","export const SPINNER_MESSAGE_ADD = \"spinner/addMessage\";\r\nexport const SPINNER_MESSAGE_REMOVE = \"spinner/removeMessage\";\r\nexport const SPINNER_TIMEOUT_SET = \"spinner/setTimeout\";\r\nexport const SPINNER_TIMEOUT_CLEAR = \"spinner/clearTimeout\";\r\nexport const SPINNER_FLUSH = \"spinner/flush\";\r\n\r\nexport const addSpinnerMessage = (uid: any, message: any) => ({\r\n  type: SPINNER_MESSAGE_ADD,\r\n  payload: {\r\n    uid,\r\n    message\r\n  }\r\n});\r\n\r\nexport const markSpinnerMessage = (uid: any, isError?: boolean) => ({\r\n  type: SPINNER_MESSAGE_REMOVE,\r\n  payload: {\r\n    uid,\r\n    isError\r\n  }\r\n});\r\n\r\nexport const setSpinnerTimeout = (timeout: any) => ({\r\n  type: SPINNER_TIMEOUT_SET,\r\n  payload: {\r\n    timeout\r\n  }\r\n});\r\n\r\nexport const clearSpinnerTimeout = () => ({\r\n  type: SPINNER_TIMEOUT_CLEAR\r\n});\r\n\r\nexport const flushSpinner = () => ({\r\n  type: SPINNER_FLUSH\r\n});\r\n\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {withStyles, withTheme} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport \"./style.css\";\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\nimport {flushSpinner} from \"../../state/spinner/spinnerActions\";\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\n\r\nconst OVERLAY_OPACITY_HEX = \"CC\";\r\n\r\nconst styles = theme => ({\r\n  container: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  overlay: {\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    zIndex: 2000\r\n  },\r\n  progressContainer: {\r\n    position: \"absolute\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\"\r\n  },\r\n  progress: {\r\n    width: 320,\r\n    maxWidth: \"50%\"\r\n  },\r\n  messagesContainer: {\r\n    position: \"relative\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    textAlign: \"center\"\r\n  },\r\n  messages: {\r\n    display: \"inline-block\",\r\n    marginTop: \"calc(50vh + 48px)\"\r\n  },\r\n  childrenContainer: {\r\n    position: \"absolute\",\r\n    top: 0,\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  messageRow: {\r\n    height: 32\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  messages: state.spinner.messages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  flushSpinner: () => dispatch(flushSpinner())\r\n});\r\n\r\nconst Spinner = ({classes, theme, children, messages, flushSpinner}) => {\r\n\r\n  const [isHandlerOn, setIsHandlerOn] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isHandlerOn) {\r\n      window.addEventListener('popstate', () => {\r\n        flushSpinner();\r\n      });\r\n      setIsHandlerOn(true);\r\n    }\r\n  }, [flushSpinner, isHandlerOn]);\r\n\r\n  return (\r\n    <Box className={classes.container}>\r\n      <Box\r\n        id=\"spinner\"\r\n        className={classes.overlay + \" \" + (messages.length === 0 ? \"invisible\" : \"\")}\r\n        style={{\r\n          background: theme.palette.primary.main + OVERLAY_OPACITY_HEX,\r\n        }}\r\n      >\r\n        <Box className={classes.progressContainer}>\r\n          <LinearProgress className={classes.progress} color=\"secondary\"/>\r\n        </Box>\r\n        <Box className={classes.messagesContainer}>\r\n          <Box className={classes.messages}>\r\n            {messages.map(({uid, message, removed, isError}) =>\r\n              <Grid container key={uid}\r\n                    justify={messages.filter(({removed}) => removed).length > 0 ? \"space-between\" : \"center\"}\r\n                    className={classes.messageRow}\r\n                    spacing={2}>\r\n                <Grid item>\r\n                  <Typography color=\"secondary\">\r\n                    {message} {!removed && \"...\"}\r\n                  </Typography>\r\n                </Grid>\r\n                {removed && (\r\n                  <Grid item style={{color: isError ? theme.palette.error.main : theme.palette.success.main}}>\r\n                    {isError ? <CancelIcon fontSize=\"small\"/> : <CheckCircleIcon fontSize=\"small\"/>}\r\n                  </Grid>\r\n                )}\r\n              </Grid>\r\n            )}\r\n          </Box>\r\n        </Box>\r\n      </Box>\r\n      <Box className={classes.childrenContainer} style={{overflow: messages.length > 0 ? \"hidden\" : \"initial\"}}>\r\n        {children}\r\n      </Box>\r\n    </Box>\r\n  )\r\n    ;\r\n};\r\n\r\nexport default compose(withStyles(styles), withTheme, connect(mapStateToProps, mapDispatchToProps))(Spinner);","import React, {useEffect, useState} from 'react';\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\n\r\nconst ErrorSnackbar = () => {\r\n\r\n  const [message, setMessage] = useState(null);\r\n\r\n  const [isInitialized, setIsInitialized] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isInitialized) {\r\n      window.error = {\r\n        show: message => {\r\n          setMessage(message);\r\n        }\r\n      };\r\n      setIsInitialized(true);\r\n    }\r\n  }, [isInitialized]);\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{vertical: 'top', horizontal: 'center'}}\r\n      open={message !== null}\r\n      autoHideDuration={5000}\r\n      onClose={() => setMessage(null)}\r\n      ClickAwayListenerProps={{\r\n        onClickAway: () => {\r\n        }\r\n      }}\r\n    >\r\n      <Alert severity=\"error\"><span dangerouslySetInnerHTML={{__html: message}}/></Alert>\r\n    </Snackbar>\r\n  );\r\n};\r\n\r\nexport default ErrorSnackbar;","import React, {Fragment} from 'react'\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {Helmet} from \"react-helmet\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  background: {\r\n    \"&, & > *\": {\r\n      position: \"fixed\",\r\n      width: \"100%\",\r\n      height: \"100%\",\r\n      objectFit: \"cover\",\r\n      zIndex: -9999\r\n    }\r\n  },\r\n  textContainer: {\r\n    color: \"white\",\r\n    textAlign: \"center\",\r\n    width: \"80%\"\r\n  },\r\n  lightTextContainer: {\r\n    color: theme.palette.primary.main,\r\n    textAlign: \"center\",\r\n    width: \"80%\"\r\n  },\r\n  buttonsContainer: {\r\n    marginTop: theme.spacing(3),\r\n    '& > *': {\r\n      margin: '8px !important'\r\n    }\r\n  },\r\n  logo: {\r\n    position: \"absolute\",\r\n    top: \"80%\",\r\n    width: \"80%\",\r\n    textAlign: \"center\",\r\n    \"& > *\": {\r\n      maxWidth: 340,\r\n      maxHeight: 64\r\n    }\r\n  }\r\n});\r\n\r\nconst Hero = ({classes, title, slogan, logo, background, light, children}) =>\r\n  <Fragment>\r\n    <Helmet>\r\n      <style type=\"text/css\">\r\n        {`\r\n          html, body, #root {\r\n            height: 100%\r\n          }\r\n        `}\r\n      </style>\r\n    </Helmet>\r\n    <div className={classes.root}>\r\n      <div className={classes.background}>\r\n        {background}\r\n      </div>\r\n      <Typography className={light ? classes.lightTextContainer : classes.textContainer} variant=\"h2\" gutterBottom>\r\n        {title}\r\n      </Typography>\r\n      <Typography className={light ? classes.lightTextContainer : classes.textContainer} variant=\"h3\" style={{fontSize: 24}}>\r\n        {slogan}\r\n      </Typography>\r\n      <Box className={classes.buttonsContainer}>\r\n        {children}\r\n      </Box>\r\n      <Box className={classes.logo}>\r\n        {logo}\r\n      </Box>\r\n    </div>\r\n  </Fragment>;\r\n\r\nexport default withStyles(styles)(Hero);","import React from 'react';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardMedia from \"@material-ui/core/CardMedia\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = () => ({\r\n  card: {\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\nconst CardsGrid = ({list, onClick, classes, squareImage}) =>\r\n  <Grid container spacing={2}>\r\n    {(() => {\r\n      const hasImage = squareImage && list.find(c => c.image);\r\n      return list.map((c, i) =>\r\n        <Grid key={i} item xs={hasImage ? 3 : 4}>\r\n          <Card className={classes.card} id={`cards-grid__card-${c.id}`}>\r\n            <CardActionArea onClick={() => onClick(c)}>\r\n              {c.image && (\r\n                <CardMedia\r\n                  component=\"img\"\r\n                  height={hasImage ? 232 : (squareImage ? 315 : 177)}\r\n                  title={c.label}\r\n                  image={c.image}\r\n                  alt={c.label}\r\n                />\r\n              )}\r\n              <CardContent>\r\n                <Typography gutterBottom variant=\"h5\" style={{fontSize: 20}}>\r\n                  {c.label}\r\n                </Typography>\r\n              </CardContent>\r\n            </CardActionArea>\r\n          </Card>\r\n        </Grid>\r\n      );\r\n    })()}\r\n  </Grid>;\r\n\r\nexport default withStyles(styles)(CardsGrid);","import React, {Fragment} from 'react';\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport Box from \"@material-ui/core/Box\";\r\n\r\nconst PageSection = props =>\r\n  <Box {...props}>\r\n    {props.sectiontitle && (\r\n      <Fragment>\r\n        <Typography variant=\"h4\" gutterBottom margin={4} style={{fontSize: 34}}>\r\n          {props.sectiontitle}\r\n        </Typography>\r\n        <Divider/>\r\n      </Fragment>\r\n    )}\r\n    {props.children}\r\n  </Box>;\r\n\r\nexport default PageSection;","import React, {Component} from 'react';\r\nimport Zoom from \"@material-ui/core/Zoom\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport {ArrowUpward} from \"@material-ui/icons\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n  },\r\n  fab: {\r\n    position: 'fixed',\r\n    right: 8,\r\n    bottom: 55,\r\n    height: '50px',\r\n    width: '50px',\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  childrenContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    '& > *:last-child': {\r\n      paddingBottom: theme.spacing(10)\r\n    }\r\n  },\r\n  oldBrowserWarning: {\r\n    position: \"fixed\",\r\n    bottom: 0,\r\n    left: 0,\r\n    zIndex: 1999,\r\n    height: 48,\r\n    width: \"100%\",\r\n    background: \"rgba(0, 0, 0, 0.7)\",\r\n    fontSize: 16,\r\n    lineHeight: \"34px\",\r\n    color: \"white\",\r\n    padding: 8\r\n  }\r\n});\r\n\r\nclass Page extends Component {\r\n\r\n  state = {\r\n    transparent: true,\r\n    isOldBrowserWarningVisible: false\r\n  };\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true,\r\n    });\r\n  }\r\n\r\n  scrollTop() {\r\n    window.scroll({top: 0, left: 0, behavior: 'smooth'});\r\n  }\r\n\r\n  handleScroll = () => {\r\n    const {transparent} = this.state;\r\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n\r\n    if (scrollTop > 50 && transparent) {\r\n      this.setState({transparent: false});\r\n    }\r\n\r\n    if (scrollTop <= 50 && !transparent) {\r\n      this.setState({transparent: true});\r\n    }\r\n  };\r\n\r\n  closeWarning = () => {\r\n    this.setState({isOldBrowserWarningVisible: false});\r\n  }\r\n\r\n  componentDidMount() {\r\n    // Internet Explorer 6-11\r\n    const isIE = !!document.documentMode;\r\n\r\n    // Edge 20+\r\n    const isEdge = !isIE && !!window.StyleMedia;\r\n\r\n    this.setState({isOldBrowserWarningVisible: (isIE || isEdge)});\r\n\r\n    window.scroll({top: 0, left: 0});\r\n\r\n    window.addEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  render() {\r\n\r\n    const {classes, children} = this.props;\r\n    const {transparent, isOldBrowserWarningVisible} = this.state;\r\n\r\n    return (\r\n      <div className={classes.root}>\r\n        {isOldBrowserWarningVisible && (\r\n          <div className={classes.oldBrowserWarning}>\r\n            <Grid container justify=\"space-between\">\r\n              <Grid item>\r\n                This browser in not completely supported, please consider to install the new version\r\n                of <a href=\"https://www.microsoft.com/edge\" target=\"_blank\" rel=\"noopener noreferrer\"\r\n                      style={{color: \"white\"}}>Microsoft Edge</a>\r\n              </Grid>\r\n              <Grid item>\r\n                <IconButton onClick={this.closeWarning} style={{color: \"white\", padding: 7}}>\r\n                  <ClearIcon fontSize=\"small\"/>\r\n                </IconButton>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n        )}\r\n        <Zoom in={!transparent}>\r\n          <Fab className={classes.fab} color=\"secondary\" onClick={this.scrollTop}>\r\n            <ArrowUpward/>\r\n          </Fab>\r\n        </Zoom>\r\n        <div className={classes.childrenContainer}>\r\n          {children}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(Page);","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    USER_CLEAR,\r\n    USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR,\r\n    USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET,\r\n    USER_FETCH,\r\n    USER_LOGIN_FORM_HIDE,\r\n    USER_LOGIN_FORM_SHOW,\r\n    USER_REFRESH\r\n} from './userActions';\r\nimport {INIT} from '../rootActions';\r\nimport {PERSISTENCE_ACTION_KEY} from '../../middlewares/persistence/middleware';\r\n\r\nexport enum UserRoles {\r\n    Administrator= \"Administrator\",\r\n    User = \"User\"\r\n}\r\n\r\nexport enum UserPermissions {\r\n    ManageCache = \"ManageCache\",\r\n    ManageTemplate = \"ManageTemplate\",\r\n    ManageConfig = \"ManageConfig\",\r\n    ManageView = \"ManageView\"\r\n}\r\n\r\nexport type UserState = {\r\n    isAuthenticated: boolean,\r\n    email: string | null,\r\n    roles: UserRoles[],\r\n    permissions: string[],\r\n    token: string | null, // auth token\r\n    refreshTokenExpiration: string | null, // refresh token expiration time (utc)\r\n    tokenTTL: number | null // auth token expiration ttl (minutes)\r\n    tokenReceivedTime: number | null // auth token received time (ms from unix epoch)\r\n    isLoginDialogOpen: boolean,\r\n    delayedRequest: object | null\r\n};\r\n\r\nconst initialState = {\r\n    isAuthenticated: false,\r\n    email: null,\r\n    roles: [],\r\n    permissions: [],\r\n    token: null,\r\n    refreshTokenExpiration: null,\r\n    tokenTTL: null,\r\n    tokenReceivedTime: null,\r\n    isLoginDialogOpen: false,\r\n    delayedRequest: null\r\n};\r\n\r\nconst userReducer: Reducer<UserState> = (\r\n    state = initialState,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT:\r\n            return action.payload[PERSISTENCE_ACTION_KEY].user || initialState;\r\n        case USER_LOGIN_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                isLoginDialogOpen: true,\r\n                message: action.payload?.alert\r\n            };\r\n        case USER_LOGIN_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                isLoginDialogOpen: false,\r\n                message: undefined\r\n            };\r\n        case USER_CLEAR:\r\n            return initialState;\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case USER_FETCH: {\r\n                    const response = action.payload.response;\r\n                    return {\r\n                        ...response,\r\n                        isLoginDialogOpen: !response.isAuthenticated,\r\n                        tokenReceivedTime: new Date().getTime()\r\n                    };\r\n                }\r\n                case USER_REFRESH:\r\n                    const response = action.payload.response;\r\n                    return {\r\n                        ...response,\r\n                        isLoginDialogOpen: state.isLoginDialogOpen,\r\n                        tokenReceivedTime: new Date().getTime()\r\n                    };\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        case USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET:\r\n            return {\r\n                ...state,\r\n                delayedRequest: action.payload.request\r\n            };\r\n        case USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR:\r\n            return {\r\n                ...state,\r\n                delayedRequest: null\r\n            };\r\n        case REQUEST_ERROR: {\r\n            switch (action.payload.label) {\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default userReducer;","/* config.json */\r\nexport const getAppConfigUrl = () => \"config.json\";\r\n\r\n/* hub */\r\nexport const getHubMinimalInfoUrl = () => \"hub/minimalInfo\";\r\n\r\n/* node */\r\nexport const getNodeUrl = (nodeId: number) => `nodes/${nodeId}`;\r\nexport const getNodeCatalogUrl = (nodeId: number) => `nodes/${nodeId}/catalog`;\r\n\r\n/* cache */\r\nexport const getClearMemoryCacheUrl = () => \"MemoryCache/Clear\";\r\nexport const getDataflowsCacheListUrl = (nodeId: number) => `DataflowCache/DataflowData/Nodes/${nodeId}`;\r\nexport const getDataflowsCacheUpdateUrl = (nodeId: number, cacheId: string) => `DataflowCache/DataflowData/${cacheId}/Nodes/${nodeId}`;\r\nexport const getDataflowsCreateCacheUrl = (nodeId: number) => `DataflowCache/DataflowData/Nodes/${nodeId}`;\r\nexport const getDataflowsClearCacheUrl = (nodeId: number, cacheId: string) => `DataflowCache/Clear/${cacheId}/Nodes/${nodeId}`;\r\nexport const getDataflowsClearAllCacheUrl = (nodeId: number) => `DataflowCache/ClearAll/Nodes/${nodeId}`;\r\nexport const getClearNodeCatalogMemoryCacheUrl = (nodeId: number) => `MemoryCache/Clear/CatalogTree/Nodes/${nodeId}`;\r\n\r\n/* templates */\r\nexport const getNodeTemplatesUrl = (nodeId: number) => `nodes/${nodeId}/templates`;\r\nexport const getCreateTemplateUrl = (nodeId: number) => `nodes/${nodeId}/templates`;\r\nexport const getDeleteTemplateUrl = (nodeId: number, id: number) => `nodes/${nodeId}/templates/${id}`;\r\n\r\n/* views */\r\nexport const getViewsUrl = () => `views`;\r\nexport const getCreateViewUrl = (nodeId: number) => `nodes/${nodeId}/views`;\r\nexport const getDeleteViewUrl = (nodeId: number, id: number) => `nodes/${nodeId}/views/${id}`;\r\n\r\n/* dataset */\r\nexport const getDatasetUrl = (nodeId: number, datasetId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/data`;\r\nexport const getDatasetStructureUrl = (nodeId: number, datasetId: string, viewId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/structure${viewId ? `/${viewId}` : \"\"}`;\r\nexport const getDatasetStructureCodelistUrl = (nodeId: number, datasetId: string, dimensionId: string, isFull: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/column/${dimensionId}/${isFull ? \"full\" : \"partial\"}/values`;\r\nexport const getDatasetStructureDynamicCodelistUrl = (nodeId: number, datasetId: string, dimensionId: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/PartialCodelists/${dimensionId}`;\r\nexport const getDatasetStructureCodelistsUrl = (nodeId: number, datasetId: string, isFull: boolean) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/columns/${isFull ? \"full\" : \"partial\"}/values`;\r\nexport const getDatasetDownloadUrl = (nodeId: number, datasetId: string, format: string, observation?: string) =>\r\n  `nodes/${nodeId}/datasets/${datasetId}/download/${format}${observation ? `/${observation}` : \"\"}`;\r\n\r\n/* config */\r\nexport const getHubConfigGetUrl = () => \"hub/config\";\r\nexport const getHubConfigPutUrl = () => \"hub\";\r\nexport const getNodesConfigUrl = () => \"nodes/config\";\r\nexport const getNodesOrderPutUrl = () => \"nodes/order\";\r\nexport const getNodeConfigGetUrl = (nodeId: number) => `nodes/${nodeId}/config`;\r\nexport const getNodesConfigPostUrl = () => 'nodes';\r\nexport const getNodesConfigPutUrl = (nodeId: number) => `nodes/${nodeId}`;\r\nexport const getNodeDeleteUrl = (nodeId: number, force?: boolean) => `nodes/${nodeId}${force ? \"/true\" : \"\"}`;\r\n\r\n/* log */\r\nexport const getQueryLog = (limit: number) => `tracing/limit/${limit}`;\r\n\r\n/* files */\r\nexport const getFileUploadUrl = () => 'File/Upload';\r\n\r\n/* authentication */\r\nexport const getTokenUrl = () => 'auth/token';\r\nexport const getRefreshTokenUrl = () => 'auth/refreshToken';\r\n\r\n/* users management */\r\nexport const getUsersConfigGetUrl = () => \"users\";\r\nexport const getUserConfigGetUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserConfigPostUrl = () => \"users/register\";\r\nexport const getUserConfigPutUrl = (userId: number) => `users/${userId}`;\r\nexport const getUserDeleteUrl = (userId: number) => `users/${userId}`;\r\n\r\n/* Geometry */\r\nexport const getGeometryUrl = () => `Geometry`;\r\n\r\n/* permissions */\r\nexport const getNodePermissionsConfigGetUrl = (nodeId: number) => `Users/Permissions/Nodes/${nodeId}`;\r\nexport const getNodePermissionsConfigPutUrl = (nodeId: number) => `Users/Permissions/Nodes/${nodeId}`;\r\n\r\n/* dashboards */\r\nexport const getUserDashboardsUrl = () => \"Dashboards\";\r\nexport const getDashboardsUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getDeleteDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getCreateDashboardUrl = () => `Dashboards/`;\r\nexport const getUpdateDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}`;\r\nexport const getHubDashboardsUrl = () => \"Dashboards/Hub\";\r\nexport const getNodeDashboardsUrl = (nodeId: number) => `Dashboards/Nodes/${nodeId}`;\r\nexport const getAddHubDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}/Hub`;\r\nexport const getRemoveHubDashboardUrl = (dashboardId: number) => `Dashboards/${dashboardId}/Hub`;\r\nexport const getOrderHubDashboardsUrl = () => 'Dashboards/Order/Hub';\r\nexport const getAddNodeDashboardUrl = (nodeId: number, dashboardId: number) => `Dashboards/${dashboardId}/Nodes/${nodeId}`;\r\nexport const getRemoveNodeDashboardUrl = (nodeId: number, dashboardId: number) => `Dashboards/${dashboardId}/Nodes/${nodeId}`;\r\nexport const getOrderNodeDashboardsUrl = (nodeId: number) => `Dashboards/Order/Nodes/${nodeId}`;","import React from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {DialogActions, withStyles} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport {useForm} from \"react-hook-form\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst REQUIRED_MESSAGE = \"This field is required.\";\r\n\r\nconst styles = theme => ({\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  }\r\n});\r\n\r\nconst UserLoginDialog = ({open, onSubmit, onHide, onRegister, classes, alert}) => {\r\n\r\n  const {register, errors, handleSubmit} = useForm();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n      onClose={onHide}\r\n    >\r\n      <DialogTitle>\r\n        {t(\"components.userLoginDialog.title\")}\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        {alert && (\r\n          <Alert severity=\"error\">{alert}</Alert>\r\n        )}\r\n        <FormControl fullWidth className={alert ? classes.field : undefined}>\r\n          <TextField\r\n            name=\"email\"\r\n            label={t(\"components.userLoginDialog.fields.email\")}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: REQUIRED_MESSAGE})}\r\n          />\r\n        </FormControl>\r\n        <FormControl fullWidth className={classes.field}>\r\n          <TextField\r\n            name=\"password\"\r\n            type=\"password\"\r\n            label={t(\"components.userLoginDialog.fields.password\")}\r\n            inputRef={register({required: REQUIRED_MESSAGE})}\r\n            error={!!errors.password}\r\n            helperText={errors.password?.message}\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onHide}>\r\n          {t(\"commons.confirm.cancel\")}\r\n        </Button>\r\n        <Button onClick={onRegister}>\r\n          {t(\"components.userLoginDialog.register\")}\r\n        </Button>\r\n        <Button onClick={handleSubmit(onSubmit)}>\r\n          {t(\"components.userLoginDialog.login\")}\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(UserLoginDialog);\r\n","import React from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {DialogActions} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst UserLogoutDialog = ({open, onSubmit, onHide, email}) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n      onClose={onHide}\r\n    >\r\n      <DialogTitle>\r\n        {t(\"components.userLogoutDialog.title\")}\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        {t(\"components.userLogoutDialog.loggedInAs\")} <b>{email}</b>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onHide}>\r\n          {t(\"commons.confirm.cancel\")}\r\n        </Button>\r\n        <Button onClick={onSubmit}>\r\n          {t(\"components.userLogoutDialog.logout\")}\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default UserLogoutDialog;","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getUserConfigGetUrl,\r\n    getUserConfigPostUrl,\r\n    getUserConfigPutUrl,\r\n    getUserDeleteUrl,\r\n    getUsersConfigGetUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const USERS_CONFIG_USERS_FETCH = \"usersConfig/fetchUsers\";\r\nexport const USERS_CONFIG_USERS_CLEAR = \"usersConfig/clearUsers\";\r\nexport const USERS_CONFIG_USER_FETCH = \"usersConfig/fetchUser\";\r\nexport const USERS_CONFIG_USER_CLEAR = \"usersConfig/clearUser\";\r\nexport const USERS_CONFIG_USER_DELETE = \"usersConfig/deleteUser\";\r\nexport const USERS_CONFIG_USER_CREATE = \"usersConfig/createUser\";\r\nexport const USERS_CONFIG_USER_EDIT = \"usersConfig/editUser\";\r\nexport const USER_CONFIG_FORM_SHOW = \"usersConfig/showForm\";\r\nexport const USER_CONFIG_FORM_HIDE = \"usersConfig/hideForm\";\r\n\r\nexport const fetchUsersConfigUsers = () => initRequest(\r\n    USERS_CONFIG_USERS_FETCH,\r\n    getUsersConfigGetUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.fetchUsers.start\")\r\n    })\r\n);\r\n\r\nexport const clearUsersConfigUsers = () => ({\r\n    type: USERS_CONFIG_USERS_CLEAR\r\n});\r\n\r\nexport const fetchUsersConfigUser = (userId: number) => initRequest(\r\n    USERS_CONFIG_USER_FETCH,\r\n    getUserConfigGetUrl(userId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.fetchUser.start\")\r\n    })\r\n);\r\n\r\nexport const clearUsersConfigUser = () => ({\r\n    type: USERS_CONFIG_USER_CLEAR\r\n});\r\n\r\nexport const deleteUsersConfigUser = (userId: number) => initRequest(\r\n    USERS_CONFIG_USER_DELETE,\r\n    getUserDeleteUrl(userId),\r\n    RequestMethod.DELETE,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.deleteUser.start\")\r\n    }),\r\n    {\r\n        userId\r\n    }\r\n);\r\n\r\nexport const sendUsersConfigUserCreate = (user: any, isAnonymous: boolean) => initRequest(\r\n    USERS_CONFIG_USER_CREATE,\r\n    getUserConfigPostUrl(),\r\n    RequestMethod.POST,\r\n    user,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.sendUserCreate.start\")\r\n    }),\r\n    {\r\n        isAnonymous\r\n    }\r\n);\r\n\r\nexport const sendUsersConfigUserEdit = (user: any) => initRequest(\r\n    USERS_CONFIG_USER_EDIT,\r\n    getUserConfigPutUrl(user.userId),\r\n    RequestMethod.PUT,\r\n    user,\r\n    t => ({\r\n        onStart: t(\"scenes.usersConfig.sendUserEdit.start\")\r\n    })\r\n);\r\n\r\nexport const showUserConfigForm = (userId: number) => ({\r\n    type: USER_CONFIG_FORM_SHOW,\r\n    payload: {\r\n        userId\r\n    }\r\n});\r\n\r\nexport const hideUserConfigForm = () => ({\r\n    type: USER_CONFIG_FORM_HIDE\r\n});","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUsersConfigUser,\r\n  fetchUsersConfigUser,\r\n  sendUsersConfigUserCreate,\r\n  sendUsersConfigUserEdit,\r\n} from \"../../../../state/usersConfig/usersConfigActions\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {Visibility, VisibilityOff} from \"@material-ui/icons\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit, onCancel}, ref) => {\r\n\r\n  const {register, errors, handleSubmit, watch} = useForm({\r\n    defaultValues: {\r\n      ...config\r\n    }\r\n  });\r\n\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [showPasswordConfirm, setShowPasswordConfirm] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val\r\n        };\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return (\r\n    <Grid container spacing={3}>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            disabled={!!config}\r\n            name=\"email\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.email\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      {!config && (\r\n        <Grid item xs={12}>\r\n          <FormControl fullWidth>\r\n            <TextField\r\n              disabled={!!config}\r\n              name=\"emailConfirm\"\r\n              label={t(\"scenes.usersSettings.userSettings.fields.emailConfirm\")}\r\n              inputRef={\r\n                register({\r\n                  required: t(\"commons.validation.required\"),\r\n                  validate: val =>\r\n                    val === watch('email') ||\r\n                    t(\"scenes.usersSettings.userSettings.validation.emailsMustBeEqual\")\r\n                })\r\n              }\r\n              error={!!errors.emailConfirm}\r\n              helperText={errors.emailConfirm?.message}\r\n              variant=\"outlined\"\r\n              required\r\n            />\r\n          </FormControl>\r\n        </Grid>\r\n      )}\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"firstName\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.firstName\")}\r\n            error={!!errors.name}\r\n            helperText={errors.name?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"lastName\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.lastName\")}\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n            error={!!errors.surname}\r\n            helperText={errors.surname?.message}\r\n            variant=\"outlined\"\r\n            required\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      <Grid item xs={12}>\r\n        <FormControl fullWidth>\r\n          <TextField\r\n            name=\"organization\"\r\n            label={t(\"scenes.usersSettings.userSettings.fields.organization\")}\r\n            error={!!errors.organization}\r\n            helperText={errors.organization?.message}\r\n            variant=\"outlined\"\r\n            required\r\n            inputRef={register({required: t(\"commons.validation.required\")})}\r\n          />\r\n        </FormControl>\r\n      </Grid>\r\n      {!config && (\r\n        <Fragment>\r\n          <Grid item xs={12}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"password\"\r\n                label={t(\"scenes.usersSettings.userSettings.fields.password\")}\r\n                error={!!errors.password}\r\n                helperText={errors.password?.message}\r\n                variant=\"outlined\"\r\n                required\r\n                type={showPassword ? undefined : \"password\"}\r\n                inputRef={register({required: t(\"commons.validation.required\")})}\r\n                InputProps={{\r\n                  endAdornment: (\r\n                    <InputAdornment position=\"end\">\r\n                      <IconButton\r\n                        aria-label=\"toggle password visibility\"\r\n                        onClick={() => setShowPassword(!showPassword)}\r\n                      >\r\n                        {showPassword ? <Visibility /> : <VisibilityOff />}\r\n                      </IconButton>\r\n                    </InputAdornment>\r\n                  )\r\n                }}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"passwordConfirm\"\r\n                label={t(\"scenes.usersSettings.userSettings.fields.passwordConfirm\")}\r\n                error={!!errors.passwordConfirm}\r\n                helperText={errors.passwordConfirm?.message}\r\n                variant=\"outlined\"\r\n                required\r\n                type={showPasswordConfirm ? undefined : \"password\"}\r\n                inputRef={\r\n                  register({\r\n                    required: t(\"commons.validation.required\"),\r\n                    validate: val =>\r\n                      val === watch('password') ||\r\n                      t(\"scenes.usersSettings.userSettings.validation.passwordsMustBeEqual\")\r\n                  })\r\n                }\r\n                InputProps={{\r\n                  endAdornment: (\r\n                    <InputAdornment position=\"end\">\r\n                      <IconButton\r\n                        aria-label=\"toggle password visibility\"\r\n                        onClick={() => setShowPasswordConfirm(!showPasswordConfirm)}\r\n                      >\r\n                        {showPasswordConfirm ? <Visibility /> : <VisibilityOff />}\r\n                      </IconButton>\r\n                    </InputAdornment>\r\n                  )\r\n                }}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n        </Fragment>\r\n      )}\r\n    </Grid>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.user,\r\n  userErrors: state.usersConfig.userErrors\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchUsersConfigUser(nodeId)),\r\n  sendConfigCreate: (config, isAnonymous) => dispatch(sendUsersConfigUserCreate(config, isAnonymous)),\r\n  sendConfig: config => dispatch(sendUsersConfigUserEdit(config)),\r\n  clearConfig: () => dispatch(clearUsersConfigUser())\r\n});\r\n\r\nconst UserSettingsForm = ({config, userId, fetchConfig, sendConfigCreate, sendConfig, clearConfig, userErrors, isAnonymous}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(userId >= 0);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(userId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, userId]);\r\n\r\n  return (userId === -1 || config) && (\r\n    <Fragment>\r\n      {userErrors !== null && (\r\n        userErrors.map(str => <Alert severity=\"error\" style={{marginBottom: 8}}>{str}</Alert>))}\r\n      <Form\r\n        config={userId === -1 ? undefined : config}\r\n        ref={ref}\r\n        onSubmit={\r\n          userId === -1\r\n            ? (config) => sendConfigCreate(config, isAnonymous)\r\n            : sendConfig\r\n        }\r\n        onCancel={clearConfig}\r\n      />\r\n    </Fragment>\r\n\r\n  );\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserSettingsForm);\r\n","import React, {Fragment} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {DialogActions} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst SettingsDialog = ({title, children, onSubmit, onClose, open, maxWidth, hasSubmit}) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth={maxWidth || \"md\"}\r\n      fullWidth\r\n      onClose={onClose}\r\n    >\r\n      <DialogTitle>\r\n        {title}\r\n      </DialogTitle>\r\n      <DialogContent style={{minHeight: 456}}>\r\n        {children}\r\n      </DialogContent>\r\n      <DialogActions>\r\n        {hasSubmit\r\n          ? (\r\n            <Fragment>\r\n              <Button onClick={onClose}>\r\n                {t(\"commons.confirm.cancel\")}\r\n              </Button>\r\n              <Button\r\n                onClick={onSubmit}\r\n              >\r\n                {t(\"commons.confirm.submit\")}\r\n              </Button>\r\n            </Fragment>\r\n          )\r\n          : (\r\n            <Button onClick={onClose}>\r\n              {t(\"commons.confirm.close\")}\r\n            </Button>\r\n          )}\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default SettingsDialog;\r\n","import React, {Fragment, useRef, useState} from 'react';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUser,\r\n  fetchUser,\r\n  hideUserLoginForm,\r\n  showUserLoginForm\r\n} from \"../../state/user/userActions\";\r\nimport UserLoginDialog from \"../user-login-dialog\";\r\nimport UserLogoutDialog from \"../user-logout-dialog\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport UserSettingsForm from \"../settings-select/users-settings-form/user-settings-form\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\n\r\nconst styles = theme => ({\r\n  avatar: {\r\n    marginRight: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onLogin: (email, password) => dispatch(fetchUser(email, password)),\r\n  onLogout: () => dispatch(clearUser()),\r\n  onLoginFormShow: () => dispatch(showUserLoginForm()),\r\n  onLoginFormHide: () => dispatch(hideUserLoginForm()),\r\n});\r\n\r\nconst UserSelect = ({classes, user, onLogin, onLogout, onLoginFormShow, onLoginFormHide}) => {\r\n\r\n  const [isLogoutModalOpen, setIsLogoutModalOpen] = useState(false);\r\n  const [isRegisterModalOpen, setIsRegisterModalOpen] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const registerFormRef = useRef();\r\n\r\n  return (\r\n    <Fragment>\r\n      <Button\r\n        color=\"inherit\"\r\n        onClick={\r\n          user.isAuthenticated\r\n            ? () => setIsLogoutModalOpen(true)\r\n            : onLoginFormShow\r\n        }\r\n      >\r\n        {user.isAuthenticated\r\n          ? (\r\n            <Fragment>\r\n              <Tooltip title={user.email}>\r\n                <AccountCircleIcon className={classes.avatar}/>\r\n              </Tooltip>\r\n            </Fragment>\r\n          ) : t(\"components.userSelect.login\")\r\n        }\r\n      </Button>\r\n      <UserLoginDialog open={user.isLoginDialogOpen}\r\n                       onSubmit={({email, password}) => onLogin(email, password)}\r\n                       onRegister={() => setIsRegisterModalOpen(true)}\r\n                       onHide={onLoginFormHide} alert={user.message}/>\r\n      <UserLogoutDialog open={isLogoutModalOpen}\r\n                        onSubmit={() => {\r\n                          onLogout();\r\n                          setIsLogoutModalOpen(false)\r\n                        }}\r\n                        onHide={() => setIsLogoutModalOpen(false)}\r\n                        email={user.email}/>\r\n      <SettingsDialog\r\n        title={t(\"components.userSelect.registerModal.title\")}\r\n        maxWidth={\"xs\"}\r\n        open={isRegisterModalOpen}\r\n        onClose={() => {\r\n          if (registerFormRef.current) {\r\n            registerFormRef.current.cancel(() => {\r\n              setIsRegisterModalOpen(false);\r\n            });\r\n          } else {\r\n            setIsRegisterModalOpen(false);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (registerFormRef.current) {\r\n            registerFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <UserSettingsForm ref={registerFormRef} userId={-1} isAnonymous/>\r\n      </SettingsDialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(UserSelect);","import {initRequest, RequestMethod} from '../../middlewares/request/requestActions';\r\nimport {getRefreshTokenUrl, getTokenUrl} from '../../serverApi/urls';\r\n\r\nexport const USER_FETCH = 'USER_FETCH';\r\nexport const USER_REFRESH = 'USER_REFRESH';\r\nexport const USER_CLEAR = 'USER_CLEAR';\r\nexport const USER_LOGIN_FORM_SHOW = 'USER_LOGIN_FORM_SHOW';\r\nexport const USER_LOGIN_FORM_HIDE = 'USER_LOGIN_FORM_HIDE';\r\nexport const USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET = 'USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET';\r\nexport const USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR = 'USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR';\r\n\r\nexport const fetchUser = (email: string, password: string) => initRequest(\r\n    USER_FETCH,\r\n    getTokenUrl(),\r\n    RequestMethod.POST,\r\n    {\r\n        Email: email,\r\n        Password: btoa(password)\r\n    },\r\n    t => ({\r\n        onStart: t(\"components.userSelect.messages.fetchUser.start\")\r\n    })\r\n);\r\n\r\nexport const refreshUser = () => initRequest(\r\n    USER_REFRESH,\r\n    getRefreshTokenUrl(),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"middlewares.user.messages.refreshUser.start\")\r\n    })\r\n);\r\n\r\nexport const clearUser = () => ({\r\n    type: USER_CLEAR\r\n});\r\n\r\nexport const showUserLoginForm = (alert: string) => ({\r\n    type: USER_LOGIN_FORM_SHOW,\r\n    payload: {\r\n        alert\r\n    }\r\n});\r\n\r\nexport const hideUserLoginForm = () => ({\r\n    type: USER_LOGIN_FORM_HIDE\r\n});\r\n\r\nexport const setUserDelayedRequestWhenTokenExpired = (request: object) => ({\r\n    type: USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_SET,\r\n    payload: {\r\n        request\r\n    }\r\n});\r\n\r\nexport const clearUserDelayedRequestWhenTokenExpired = () => ({\r\n    type: USER_DELAYED_REQUEST_WHEN_TOKEN_EXPIRED_CLEAR\r\n});","export const goToDatasets = (nodeCode, categoryPath) =>\r\n  window.open(`./#/${nodeCode.toLowerCase()}/${categoryPath.join(\"/\")}`, '_self');\r\n\r\nexport const goToData = (nodeCode, categoryPath, datasetId, viewId, a11y) =>\r\n  window.open(\r\n    `./#/${nodeCode.toLowerCase()}/${categoryPath.length > 0 ? categoryPath.join(\"/\") + \"/\" : \"\"}` +\r\n    `${datasetId}${(viewId || a11y) ? '?' : ''}${viewId ? `view=${viewId}` : \"\"}${a11y ? \"accessible=true\" : \"\"}`,\r\n    '_self'\r\n  );\r\n\r\n// filters = c1/c2,c3/c4\r\nexport const goToDatasetsSearch = (nodeCode, query, filters) => {\r\n  window.open(\r\n    `./#/${nodeCode.toLowerCase()}/search?q=${encodeURIComponent(query)}` +\r\n    (filters && filters.length > 0 ? `&c=${encodeURIComponent(filters.map(f => encodeURIComponent(f.join(\"/\"))).join(\"//\"))}` : ''),\r\n    '_self'\r\n  );\r\n};\r\n\r\nexport const goToNode = nodeCode => window.open(`./#/${nodeCode}`, '_self');\r\nexport const goToHome = () => window.open('./#/', '_self');\r\nexport const goToSdg = () => window.open('./#/sdg', '_self');\r\n\r\nexport const goToHubDashboards = () => window.open('./#/dashboards', '_self');\r\nexport const goToNodeDashboards = nodeCode => window.open(`./#/${nodeCode.toLowerCase()}/dashboards`, '_self');\r\nexport const goToDashboard = dashboardId => window.open(`./#/dashboards/${dashboardId}`, '_self');","import React, {Component, Fragment} from 'react';\r\nimport TreeView from '@material-ui/lab/TreeView';\r\nimport TreeItem from '@material-ui/lab/TreeItem';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport InfoOutlinedIcon from '@material-ui/icons/InfoOutlined';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {Link, withStyles} from \"@material-ui/core\";\r\nimport {goToDatasets} from \"../../links\";\r\nimport FolderOpenIcon from '@material-ui/icons/FolderOpen';\r\nimport ListIcon from '@material-ui/icons/List';\r\nimport FolderIcon from '@material-ui/icons/Folder';\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\n\r\nconst styles = () => ({\r\n  nodeIcon: {\r\n    marginTop: 5\r\n  },\r\n  selectedItem: {\r\n    background: \"rgba(0, 41, 90, 0.2) !important\"\r\n  }\r\n});\r\n\r\nclass CategoriesTree extends Component {\r\n\r\n  state = {\r\n    expanded: this.props.selectedCategoryPath || []\r\n  };\r\n\r\n  onExpand = expanded => this.setState({expanded});\r\n\r\n  render() {\r\n\r\n    const {classes, node, catalog, selectedCategoryPath = [], onClose, t} = this.props;\r\n    const {expanded} = this.state;\r\n\r\n    const getTreeItems = (tree, prevPath) =>\r\n      tree.map((cat, i) =>\r\n        <TreeItem\r\n          key={i}\r\n          nodeId={cat.id}\r\n          label={\r\n            <Grid spacing={1} container alignItems=\"center\">\r\n              <Grid item>\r\n                {(expanded.includes(cat.id))\r\n                  ? <FolderOpenIcon className={classes.nodeIcon}/>\r\n                  : <FolderIcon className={classes.nodeIcon}/>\r\n                }\r\n              </Grid>\r\n              <Grid item>\r\n                {cat.label}\r\n              </Grid>\r\n              {cat.hasAnnotation && (\r\n                <Grid item>\r\n                  <IconButton\r\n                    size=\"small\"\r\n                    onClick={this.onDialogOpen}\r\n                  >\r\n                    <InfoOutlinedIcon/>\r\n                  </IconButton>\r\n                </Grid>\r\n              )}\r\n            </Grid>\r\n          }\r\n          /* TODO: inefficente */\r\n          classes={{\r\n            label: selectedCategoryPath.includes(cat.id) ? classes.selectedItem : null\r\n          }}\r\n        >\r\n          {(\r\n            (cat.datasetIdentifiers && cat.datasetIdentifiers.length > 0) ||\r\n            (cat.childrenCategories && cat.childrenCategories.length > 0)\r\n          ) && (\r\n            <Fragment>\r\n              {(cat.datasetIdentifiers && cat.datasetIdentifiers.length > 0) && (\r\n                <TreeItem\r\n                  nodeId={cat.id + \"-results\"}\r\n                  label={\r\n                    <Link onClick={() => {\r\n                      onClose();\r\n                      goToDatasets(node.code.toLowerCase(), [...prevPath, cat.id]);\r\n                    }}>\r\n                      <Grid spacing={1} container alignItems=\"center\">\r\n                        <Grid item>\r\n                          <ListIcon className={classes.nodeIcon}/>\r\n                        </Grid>\r\n                        <Grid item>\r\n                          <i>{t(\"components.categoriesTree.goToData\", {datasetsCount: cat.datasetIdentifiers.length})}</i>\r\n                        </Grid>\r\n                      </Grid>\r\n                    </Link>\r\n                  }\r\n                />\r\n              )}\r\n              {cat.childrenCategories && cat.childrenCategories.length > 0 &&\r\n              getTreeItems(cat.childrenCategories, [...prevPath, cat.id])}\r\n            </Fragment>\r\n          )}\r\n        </TreeItem>\r\n      );\r\n\r\n    const getCategorySchemeTree = ({id, label, categories}) =>\r\n      <TreeView\r\n        defaultCollapseIcon={<ExpandMoreIcon/>}\r\n        defaultExpandIcon={<ChevronRightIcon/>}\r\n        expanded={expanded}\r\n        onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n        key={id}\r\n      >\r\n        {getTreeItems([{id, label, childrenCategories: categories}], [])}\r\n      </TreeView>;\r\n\r\n    return (\r\n      <Fragment>\r\n        {catalog.categoryGroups.length > 0 && (\r\n          catalog.categoryGroups.length > 1\r\n            ? (\r\n              <Fragment>\r\n                {catalog.categoryGroups.map(getCategorySchemeTree)}\r\n              </Fragment>\r\n            )\r\n            : (\r\n              <TreeView\r\n                defaultCollapseIcon={<ExpandMoreIcon/>}\r\n                defaultExpandIcon={<ChevronRightIcon/>}\r\n                expanded={expanded}\r\n                onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n              >\r\n                {getTreeItems(catalog.categoryGroups[0].categories, [])}\r\n              </TreeView>\r\n            )\r\n        )}\r\n        {catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0 && (\r\n          <TreeView\r\n            defaultCollapseIcon={<ExpandMoreIcon/>}\r\n            defaultExpandIcon={<ChevronRightIcon/>}\r\n            expanded={expanded}\r\n            onNodeToggle={(_, nodeIds) => this.onExpand(nodeIds)}\r\n          >\r\n            <TreeItem\r\n              key={\"uncategorized\"}\r\n              nodeId={\"uncategorized\"}\r\n              label={\r\n                <Grid spacing={1} container alignItems=\"center\">\r\n                  <Grid item>\r\n                    {(expanded.includes(\"uncategorized\")\r\n                        ? <FolderOpenIcon className={classes.nodeIcon}/>\r\n                        : <FolderIcon className={classes.nodeIcon}/>\r\n                    )}\r\n                  </Grid>\r\n                  <Grid item>\r\n                    {t(\"commons.catalog.uncategorized\")}\r\n                  </Grid>\r\n                </Grid>\r\n              }\r\n              /* TODO: inefficente */\r\n              classes={{\r\n                content: selectedCategoryPath.includes(\"uncategorized\") ? classes.selectedItem : null\r\n              }}\r\n            >\r\n              <TreeItem\r\n                nodeId={\"uncategorized-results\"}\r\n                label={\r\n                  <Link onClick={() => {\r\n                    onClose();\r\n                    goToDatasets(node.code.toLowerCase(), [\"uncategorized\"]);\r\n                  }}>\r\n                    <Grid spacing={1} container alignItems=\"center\">\r\n                      <Grid item>\r\n                        <ListIcon className={classes.nodeIcon}/>\r\n                      </Grid>\r\n                      <Grid item>\r\n                        <i>{t(\"components.categoriesTree.goToData\", {datasetsCount: catalog.uncategorizedDatasets.length})}</i>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </Link>\r\n                }\r\n              />\r\n            </TreeItem>\r\n          </TreeView>\r\n        )}\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(CategoriesTree);","import React, {Component, forwardRef, Fragment} from 'react';\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\n\r\nclass ButtonSelect extends Component {\r\n\r\n  state = {\r\n    anchorEl: null\r\n  };\r\n\r\n  setAnchorEl = (el) => {\r\n    this.setState({\r\n      anchorEl: el\r\n    });\r\n  };\r\n\r\n  handleMenu = (event) => {\r\n    this.setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  handleClose = () => {\r\n    this.setAnchorEl(null);\r\n  };\r\n\r\n  render() {\r\n\r\n    const {children, icon, value, color, tooltip, disabled, selectedIdx, onChange} = this.props;\r\n    const {anchorEl} = this.state;\r\n\r\n    const open = Boolean(anchorEl);\r\n\r\n    const Item = forwardRef(({c, isSelected}, ref) =>\r\n      <MenuItem\r\n        ref={ref}\r\n        onClick={() => {\r\n          if (c.props?.onClick) {\r\n            c.props.onClick();\r\n          }\r\n          if (onChange) {\r\n            onChange(c.props[\"data-value\"]);\r\n          }\r\n          this.handleClose();\r\n        }}\r\n        style={{background: isSelected ? \"#fff9e5\" : \"white\"}}\r\n      >\r\n        {c}\r\n      </MenuItem>);\r\n\r\n    return (\r\n      <Fragment>\r\n        <Tooltip title={tooltip || \"\"}>\r\n          <span>\r\n            {value\r\n              ? (\r\n                <Button\r\n                  color={color || \"inherit\"}\r\n                  onClick={this.handleMenu}\r\n                  startIcon={icon}\r\n                  endIcon={<ArrowDropDownIcon/>}\r\n                  disabled={disabled}\r\n                >\r\n                  {value}\r\n                </Button>\r\n              )\r\n              : <IconButton color={color || \"inherit\"} onClick={this.handleMenu} disabled={disabled}>{icon}</IconButton>\r\n            }\r\n          </span>\r\n        </Tooltip>\r\n        <Menu\r\n          anchorEl={anchorEl}\r\n          anchorOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          keepMounted\r\n          transformOrigin={{\r\n            vertical: 'top',\r\n            horizontal: 'right',\r\n          }}\r\n          open={open}\r\n          onClose={this.handleClose}\r\n        >\r\n          {children.length\r\n            ? children.filter(c => c).map((c, i) => c !== null ? <Item c={c} key={i} isSelected={i === selectedIdx}/> : null)\r\n            : <Item c={children}/>\r\n          }\r\n        </Menu>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ButtonSelect;","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getAddHubDashboardUrl,\r\n    getHubConfigGetUrl,\r\n    getHubConfigPutUrl,\r\n    getHubDashboardsUrl,\r\n    getOrderHubDashboardsUrl,\r\n    getRemoveHubDashboardUrl,\r\n    getUserDashboardsUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const HUB_CONFIG_FETCH = \"hubConfig/fetch\";\r\nexport const HUB_CONFIG_SEND = \"hubConfig/send\";\r\nexport const HUB_CONFIG_CLEAR = \"hubConfig/clear\";\r\nexport const HUB_CONFIG_DASHBOARDS_FETCH = \"hubConfig/dashboards/fetch\";\r\nexport const HUB_CONFIG_DASHBOARDS_FETCH_ALL = \"hubConfig/dashboards/fetchAll\";\r\nexport const HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD = \"hubConfig/dashboards/addDashboard\";\r\nexport const HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE = \"hubConfig/dashboards/removeDashboard\";\r\nexport const HUB_CONFIG_DASHBOARDS_ORDERS_SEND = \"hubConfig/dashboards/sendOrders\";\r\nexport const HUB_CONFIG_DASHBOARDS_CLEAR = \"hubConfig/dashboards/clear\";\r\nexport const HUB_CONFIG_DASHBOARDS_CLEAR_ALL = \"hubConfig/dashboards/clearAll\";\r\nexport const HUB_CONFIG_CLOSE = \"hubConfig/close\";\r\n\r\nexport const fetchHubConfig = () => initRequest(\r\n    HUB_CONFIG_FETCH,\r\n    getHubConfigGetUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchConfig.start\")\r\n    })\r\n);\r\n\r\nexport const sendHubConfig = (config: any) => initRequest(\r\n  HUB_CONFIG_SEND,\r\n  getHubConfigPutUrl(),\r\n    RequestMethod.PUT,\r\n    config,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.sendConfig.start\")\r\n    })\r\n);\r\n\r\nexport const clearHubConfig = () => ({\r\n    type: HUB_CONFIG_CLEAR\r\n});\r\n\r\nexport const fetchHubConfigDashboards = () => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_FETCH,\r\n    getHubDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const fetchAllHubConfigDashboards = () => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_FETCH_ALL,\r\n    getUserDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.fetchAllDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const addHubConfigDashboardsDashboard = (dashboardId: number) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n    getAddHubDashboardUrl(dashboardId),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.addDashboard.start\")\r\n    })\r\n);\r\n\r\nexport const removeHubConfigDashboardsDashboard = (dashboardId: number) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n    getRemoveHubDashboardUrl(dashboardId),\r\n    RequestMethod.DELETE,\r\n    null,\r\n    t => ({\r\n        onStart:t(\"scenes.appSettings.messages.removeDashboard.start\")\r\n    })\r\n);\r\n\r\nexport const sendHubConfigDashboardsOrders = (orderedDashboardsIds: number[]) => initRequest(\r\n    HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n    getOrderHubDashboardsUrl(),\r\n    RequestMethod.POST,\r\n    orderedDashboardsIds,\r\n    t => ({\r\n        onStart: t(\"scenes.appSettings.messages.sendDashboardsOrders.start\")\r\n    })\r\n)\r\n\r\nexport const clearHubConfigDashboards = () => ({\r\n    type: HUB_CONFIG_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const clearAllHubConfigDashboards = () => ({\r\n    type: HUB_CONFIG_DASHBOARDS_CLEAR_ALL\r\n});\r\n\r\nexport const closeHubConfig = () => ({\r\n    type: HUB_CONFIG_CLOSE\r\n});","import React, {Fragment, useState} from 'react';\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport CancelIcon from \"@material-ui/icons/Cancel\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport PublishIcon from '@material-ui/icons/Publish';\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport {connect} from \"react-redux\";\r\nimport {getFileUploadUrl} from \"../../serverApi/urls\";\r\nimport {compose} from \"redux\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  startAdornment: {\r\n    marginRight: theme.spacing(2)\r\n  },\r\n  fileInput: {\r\n    display: \"none\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL,\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  addSpinnerMessage: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  markSpinnerMessage: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\nconst FileInput = ({label, value, onChange, classes, baseURL, error, helperText, required, addSpinnerMessage, markSpinnerMessage, user}) => {\r\n\r\n  const [id] = useState(uuidv4());\r\n  const [fileName, setFileName] = useState(value?.substring(value.lastIndexOf('/') + 1) || '');\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Fragment>\r\n      <input\r\n        accept=\"image/*, video/*\"\r\n        className={classes.fileInput}\r\n        id={id}\r\n        type=\"file\"\r\n        onChange={e => {\r\n          const file = e.target.files[0];\r\n\r\n          let fileFormData = new FormData();\r\n          fileFormData.append('files', file);\r\n\r\n          const uuid = uuidv4();\r\n\r\n          addSpinnerMessage(uuid, t(\"components.fileInput.messages.upload.start\"));\r\n\r\n          fetch(baseURL + getFileUploadUrl(), {\r\n            method: 'POST',\r\n            body: fileFormData,\r\n            headers: {\r\n              \"Authorization\": user.token ? `bearer ${user.token}` : undefined\r\n            },\r\n            credentials: 'include'\r\n          })\r\n            .then(res => res.json())\r\n            .then(res => {\r\n              markSpinnerMessage(uuid);\r\n              const filePath = res[0];\r\n              onChange(filePath);\r\n              setFileName(filePath.substring(filePath.lastIndexOf('/') + 1));\r\n            })\r\n            .catch(() => {\r\n              markSpinnerMessage(uuid, true);\r\n              window.error.show(t(\"components.fileInput.messages.upload.error\"));\r\n            });\r\n        }}\r\n      />\r\n      <TextField\r\n        variant=\"outlined\"\r\n        label={label}\r\n        value={fileName}\r\n        InputProps={{\r\n          startAdornment: (\r\n            <InputAdornment className={classes.startAdornment} position=\"start\">\r\n              <label htmlFor={id}>\r\n                <Button startIcon={<PublishIcon/>} variant=\"outlined\" disabled={!!value}\r\n                        title=\"Upload new file\" component=\"span\">\r\n                  {t(\"components.fileInput.upload\")}\r\n                </Button>\r\n              </label>\r\n            </InputAdornment>\r\n          ),\r\n          endAdornment:\r\n            value && (\r\n              <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  title= {t(\"components.fileInput.reset\")}\r\n                  onClick={() => {\r\n                    setFileName('');\r\n                    onChange('');\r\n                  }}\r\n                >\r\n                  <CancelIcon/>\r\n                </IconButton>\r\n              </InputAdornment>\r\n            ),\r\n        }}\r\n        error={error}\r\n        required={required}\r\n        helperText={helperText}\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(FileInput);","import React from 'react';\r\nimport MaterialTable from \"material-table\";\r\nimport _ from 'lodash';\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst CustomMaterialTable = props => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  // these props are meant to be used for customizing material table all spread the app\r\n  const customProps = {\r\n    localization: {\r\n      body: {\r\n        emptyDataSourceMessage: t(\"components.customMaterialTable.empty\"),\r\n      },\r\n      header: {\r\n        actions: \"\"\r\n      },\r\n      toolbar: {\r\n        searchPlaceholder: t(\"components.customMaterialTable.search.placeholder\"),\r\n        searchTooltip: t(\"components.customMaterialTable.search.tooltip\")\r\n      }\r\n    }\r\n  };\r\n\r\n  // props passed to this component are merged with and can override the custom props\r\n  const mergedProps = _.merge(customProps, props);\r\n\r\n  return <MaterialTable {...mergedProps}/>;\r\n};\r\n\r\nexport default CustomMaterialTable;\r\n","import _ from \"lodash\";\r\n\r\nexport const validateI18nObj = obj =>\r\n  obj !== undefined && obj !== null &&\r\n  _(obj)\r\n    .pickBy(val => val !== undefined && val !== null && val.length > 0)\r\n    .keys()\r\n    .value().length > 0;\r\n\r\nexport const localizeI18nObj = (obj, prefLang, langs) => {\r\n\r\n  if (obj === null || obj === undefined || obj === {}) {\r\n    return null\r\n  }\r\n  if (typeof (obj) === \"string\") {\r\n    return obj\r\n  }\r\n\r\n  if (obj[prefLang]) {\r\n    return obj[prefLang];\r\n  }\r\n\r\n  for (let code of langs) {\r\n    if (obj[code]) {\r\n      return obj[code];\r\n    }\r\n  }\r\n\r\n  return obj[Object.keys(obj)[0]];\r\n};\r\n\r\nexport const getI18nObjCustomFilterAndSearch = (language, languages) => (str, row, {field}) =>\r\n  localizeI18nObj(row[field], language, languages).toLowerCase().includes(str.toLowerCase());","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {compose} from \"redux\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport ArrowDropUpIcon from \"@material-ui/icons/ArrowDropUp\";\r\nimport ArrowDropDownIcon from \"@material-ui/icons/ArrowDropDown\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  languages: state.app.languages,\r\n  defaultLanguage: state.app.language\r\n});\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst DashboardsManager = ({\r\n                             classes,\r\n                             defaultLanguage,\r\n                             languages,\r\n                             dashboards,\r\n                             allDashboards,\r\n                             fetchDashboards,\r\n                             fetchAllDashboards,\r\n                             addDashboard,\r\n                             removeDashboard,\r\n                             sendDashboardsOrders,\r\n                             clearDashboards,\r\n                             clearAllDashboards\r\n                           }, ref) => {\r\n\r\n  const [needFetch, setNeedFetch] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    if (needFetch) {\r\n      setNeedFetch(false);\r\n      fetchDashboards();\r\n    }\r\n  }, [dashboards, needFetch, setNeedFetch, fetchDashboards]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    destroy(f) {\r\n      clearDashboards();\r\n      if (f) {\r\n        f();\r\n      }\r\n    }\r\n  }));\r\n\r\n  const orderedDashboardsIds = (dashboards || []).map(({dashboardId}) => dashboardId);\r\n\r\n  const moveUp = rowIndex =>\r\n    sendDashboardsOrders([\r\n      ...orderedDashboardsIds.slice(0, rowIndex - 1),\r\n      orderedDashboardsIds[rowIndex],\r\n      orderedDashboardsIds[rowIndex - 1],\r\n      ...orderedDashboardsIds.slice(rowIndex + 1)\r\n    ]);\r\n\r\n  const moveDown = rowIndex =>\r\n    sendDashboardsOrders([\r\n      ...orderedDashboardsIds.slice(0, rowIndex),\r\n      orderedDashboardsIds[rowIndex + 1],\r\n      orderedDashboardsIds[rowIndex],\r\n      ...orderedDashboardsIds.slice(rowIndex + 2)\r\n    ]);\r\n\r\n  return dashboards !== null && (\r\n    <Fragment>\r\n      <Grid container justify=\"flex-end\" className={classes.tableToolbar}>\r\n        <Grid item>\r\n          <Button\r\n            size=\"small\"\r\n            startIcon={<AddIcon/>}\r\n            onClick={() => {\r\n              fetchAllDashboards();\r\n            }}>\r\n            {t(\"components.dashboardsManager.addDashboard\")}\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n      <Dialog\r\n        open={allDashboards !== null}\r\n        disableEscapeKeyDown\r\n        disableBackdropClick\r\n        maxWidth=\"md\"\r\n        fullWidth\r\n        onClose={() => {\r\n          clearAllDashboards();\r\n        }}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardsManager.modals.addDashboard.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{minHeight: 456}}>\r\n          {allDashboards !== null && (\r\n            <CustomMaterialTable\r\n              components={{\r\n                Container: Box\r\n              }}\r\n              columns={[\r\n                {\r\n                  field: \"title\",\r\n                  title: t(\"components.dashboardsManager.modals.addDashboard.table.columns.dashboardTitle\"),\r\n                  render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n                  customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n                }\r\n              ]}\r\n              data={allDashboards}\r\n              actions={[\r\n                ({dashboardId}) => {\r\n                  const assigned = !!dashboards.find(dashboard => dashboard.dashboardId === dashboardId)\r\n                  return ({\r\n                    icon: AddIcon,\r\n                    tooltip:\r\n                      assigned\r\n                        ? t(\"components.dashboardsManager.modals.addDashboard.table.actions.addDashboard.tooltip.assigned\")\r\n                        : t(\"components.dashboardsManager.modals.addDashboard.table.actions.addDashboard.tooltip.notAssigned\"),\r\n                    onClick: (_, {dashboardId}) => addDashboard(dashboardId),\r\n                    disabled: assigned\r\n                  });\r\n                }\r\n              ]}\r\n              options={{\r\n                paging: false,\r\n                draggable: true,\r\n                actionsColumnIndex: 2,\r\n                searchFieldAlignment: \"left\",\r\n                maxBodyHeight: 400,\r\n                showTitle: false\r\n              }}\r\n              icons={tableIcons}\r\n            />\r\n          )}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => clearAllDashboards()}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n      <CustomMaterialTable\r\n        title=\"\"\r\n        components={{\r\n          Container: Box\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"title\",\r\n            title: t(\"components.dashboardsManager.table.columns.dashboardTitle\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          }\r\n        ]}\r\n        data={dashboards}\r\n        actions={[\r\n          ({tableData}) => ({\r\n            icon: ArrowDropUpIcon,\r\n            tooltip: t(\"components.dashboardsManager.table.actions.dashboardOrderMoveUp\"),\r\n            onClick: (_, {tableData}) => moveUp(tableData.id), // tableData.id is the rowIndex\r\n            disabled: tableData.id === 0\r\n          }),\r\n          ({tableData}) => ({\r\n            icon: ArrowDropDownIcon,\r\n            tooltip: t(\"components.dashboardsManager.table.actions.dashboardOrderMoveDown\"),\r\n            onClick: (_, {tableData}) => moveDown(tableData.id), // tableData.id is the rowIndex\r\n            disabled: tableData.id === dashboards.length - 1\r\n          }),\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"components.dashboardsManager.table.actions.removeDashboard\"),\r\n            onClick: (_, {dashboardId}) => removeDashboard(dashboardId)\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 2,\r\n          searchFieldAlignment: \"left\",\r\n          maxBodyHeight: 400\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n    </Fragment>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, null, null, {forwardRef: true}),\r\n  forwardRef\r\n)(DashboardsManager);","export const INIT = \"INIT\";\r\n\r\nexport const init = (baseURL: string, supportedLanguages: string[], defaultLanguage: string) => ({\r\n    type: INIT,\r\n    payload: {\r\n        baseURL,\r\n        supportedLanguages,\r\n        defaultLanguage\r\n    }\r\n});\r\n","import {INIT} from \"../../state/rootActions\";\r\nimport {REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {HUB_CONFIG_SEND} from \"../../state/hubConfig/hubConfigActions\";\r\n\r\nexport const PERSISTENCE_LOCAL_STORAGE_KEY = \"state\";\r\nexport const PERSISTENCE_ACTION_KEY = \"persistentState\";\r\n\r\nconst persistenceMiddleware = ({getState}) => next => action => {\r\n\r\n  // when init action is dispatched\r\n  if (action.type === INIT) {\r\n    if (!action.payload) {\r\n      action.payload = {};\r\n    }\r\n    // attach persistent state to the action\r\n    action.payload[PERSISTENCE_ACTION_KEY] = JSON.parse(localStorage.getItem(PERSISTENCE_LOCAL_STORAGE_KEY) || \"{}\");\r\n  }\r\n\r\n  const result = next(action);\r\n\r\n  const state = getState();\r\n\r\n  // any time an action is dispatched, update persistent state (localStorage is fast)\r\n  localStorage.setItem(\r\n    PERSISTENCE_LOCAL_STORAGE_KEY,\r\n    JSON.stringify({\r\n      user: state.user,\r\n      app: {\r\n        language:\r\n          action.type === REQUEST_SUCCESS &&\r\n          action.payload.label === HUB_CONFIG_SEND &&\r\n          !action.payload.data.supportedLanguages.includes(state.app.language)\r\n            ? action.payload.data.defaultLanguage\r\n            : state.app.language\r\n      }\r\n    })\r\n  );\r\n\r\n  return result;\r\n};\r\n\r\nexport default persistenceMiddleware;","import {UserPermissions, UserRoles, UserState} from '../state/user/userReducer';\r\n\r\ntype UserChecker = (user: UserState, nodeId?: number) => boolean;\r\ntype UserNodeChecker = (user: UserState, nodeId: number) => boolean;\r\n\r\nconst getPermissionStr = (permission: UserPermissions, nodeId: number) => `${permission}_SingleNode_${nodeId}`;\r\n\r\nexport const canDisplayAppSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canCreateNode: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canSortNodes: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayNodesSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageCache}_SingleNode`)) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageTemplate}_SingleNode`)) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageConfig}_SingleNode`))\r\n    );\r\n\r\nexport const canDisplayUsersSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayCacheSettingForm: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageCache, nodeId))\r\n    );\r\n\r\nexport const canDisplayTemplatesSettingsForm: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n    );\r\n\r\nexport const canSaveTemplate: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n    );\r\n\r\nexport const canEditNode: UserNodeChecker = (user, nodeId) =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n    );\r\n\r\nexport const canDisplayUserViews: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canShare: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canSaveAsView: UserChecker = user =>\r\n    user && user.isAuthenticated;\r\n\r\nexport const canClearServerCache: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canGetQueryLog: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canDisplayPermissionsSettingsForm: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canManagePersonalDashboards: UserChecker = user =>\r\n    user && user.isAuthenticated && (\r\n        user.roles.includes(UserRoles.Administrator) ||\r\n        !!user.permissions.find(p => p.startsWith(`${UserPermissions.ManageConfig}_SingleNode`))\r\n    );\r\n\r\nexport const canManageAppDashboards: UserChecker = user =>\r\n    user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canManageNodeDashboards: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n  );\r\n\r\nexport const canDeleteNodes: UserChecker = user =>\r\n  user && user.isAuthenticated && user.roles.includes(UserRoles.Administrator);\r\n\r\nexport const canViewTimesLog: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageConfig, nodeId))\r\n  );\r\n\r\nexport const canViewTemplateOrAnnotationIcon: UserNodeChecker = (user, nodeId) =>\r\n  user && user.isAuthenticated && (\r\n    user.roles.includes(UserRoles.Administrator) ||\r\n    user.permissions.includes(getPermissionStr(UserPermissions.ManageTemplate, nodeId))\r\n  );","import React, {useEffect, useState} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport {connect} from \"react-redux\";\r\nimport CountryLanguage from 'country-language';\r\n\r\nconst CUSTOM_LANG_TO_COUNTRY = {\r\n  en: \"gb\"\r\n};\r\n\r\nconst I18nInputAdornmentSelect = ({value, onChange, languages}) => {\r\n\r\n  const [langToCountry, setLangToCountry] = useState(null);\r\n\r\n  useEffect(() => {\r\n\r\n    let res = {};\r\n\r\n    languages.forEach(langCode =>\r\n      CountryLanguage.getLanguageCountries(langCode, (err, countries) => {\r\n        if (!err) {\r\n          res[langCode] =\r\n            CUSTOM_LANG_TO_COUNTRY[langCode] ||\r\n            countries.find(({code_2}) => code_2.toLowerCase() === langCode)?.code_2.toLowerCase() ||\r\n            countries[0].code_2.toLowerCase();\r\n        }\r\n      }));\r\n\r\n    setLangToCountry(res);\r\n\r\n  }, [languages]);\r\n\r\n  return langToCountry && (\r\n    <ButtonSelect value={<span className={`flag-icon flag-icon-${langToCountry[value]}`}/>}\r\n                  onChange={onChange}>\r\n      {languages.map(lang =>\r\n        <span key={lang} className={`flag-icon flag-icon-${langToCountry[lang]}`} data-value={lang}/>\r\n      )}\r\n    </ButtonSelect>\r\n  );\r\n};\r\n\r\nexport default connect(state => ({\r\n  languages: state.app.languages\r\n}))(I18nInputAdornmentSelect);","import React, {useState} from 'react';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst Component = ({\r\n                     textFieldProps,\r\n                     defaultLanguage,\r\n                     languages,\r\n                     children\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n\r\n  return (\r\n    <TextField\r\n      {...textFieldProps}\r\n      value={\r\n        textFieldProps.value && textFieldProps.value[language]\r\n          ? textFieldProps.value[language]\r\n          : \"\"\r\n      }\r\n      onChange={({target}) => {\r\n        const res = {};\r\n        languages.forEach(lang => {\r\n          if (textFieldProps.value[lang]) {\r\n            res[lang] = textFieldProps.value[lang];\r\n          }\r\n        });\r\n        res[language] = target.value;\r\n        textFieldProps.onChange(res);\r\n      }}\r\n      InputProps={{\r\n        startAdornment: (\r\n          <InputAdornment position=\"start\">\r\n            <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n          </InputAdornment>\r\n        )\r\n      }}\r\n    >\r\n      {textFieldProps.children}\r\n    </TextField>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nTextField = props =>\r\n  <ConnectedComponent textFieldProps={props}/>;\r\n\r\nexport default I18nTextField;","import React, {Fragment} from 'react';\r\nimport CKEditor from 'ckeditor4-react';\r\nimport './style.css'\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  preToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nclass HtmlEditor extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = HtmlEditor.getInitState(props);\r\n    this.handleEditorChange = this.handleEditorChange.bind(this);\r\n  }\r\n\r\n  static getInitState(props) {\r\n    return {\r\n      value: props ? (props.value || '') : ''\r\n    };\r\n  }\r\n\r\n  static getDerivedStateFromProps(props) {\r\n    if (props.value !== null && props.value !== undefined) {\r\n      return {\r\n        value: props.value\r\n      };\r\n\r\n    } else {\r\n      return HtmlEditor.getInitState(props);\r\n    }\r\n  }\r\n\r\n  handleEditorChange(event) {\r\n    const data = event.editor.getData();\r\n    if (this.props.onChange) {\r\n      this.props.onChange(data);\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      value\r\n    } = this.state;\r\n\r\n    const {\r\n      disabled,\r\n    } = this.props;\r\n\r\n    return (\r\n      <Fragment>\r\n        {/* <Grid container className={classes.preToolbar}>\r\n          <Grid item>\r\n            <I18nInputAdornmentSelect/>\r\n          </Grid>\r\n        </Grid>*/}\r\n        <CKEditor\r\n          data={value}\r\n          config={{\r\n            defaultLanguage: 'en',\r\n            language: 'en',\r\n            toolbar: [\r\n              {name: 'basicstyles', items: ['Bold', 'Italic', 'Underline', 'Strike']},\r\n              {name: 'format', items: ['RemoveFormat']},\r\n              {name: 'colors', items: ['TextColor', 'BGColor']},\r\n              {name: 'insert', items: ['Table']},\r\n              {name: 'links', items: ['Link', 'Unlink']},\r\n              {name: 'paragraph', items: ['NumberedList', 'BulletedList']},\r\n              {name: 'indent', items: ['Outdent', 'Indent']},\r\n              {\r\n                name: 'justify',\r\n                items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']\r\n              },\r\n              {name: 'clipboard', items: ['Cut', 'Copy', 'Paste']},\r\n              {name: 'history', items: ['Undo', 'Redo']}\r\n            ]\r\n          }}\r\n          readOnly={disabled ? disabled : false}\r\n          onChange={this.handleEditorChange}\r\n          onBeforeLoad={(CKEDITOR) => (CKEDITOR.disableAutoInline = true)} // needed to fix \"Error code: editor-element-conflict.\"\r\n        />\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(HtmlEditor);\r\n","import React, {Fragment, useState} from 'react';\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport HtmlEditor from \"../html-editor\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nconst Component = ({\r\n                     htmlEditorProps,\r\n                     defaultLanguage,\r\n                     languages\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n\r\n  return (\r\n    <Fragment>\r\n      <Grid container justify=\"flex-end\" style={{marginBottom: 4}}>\r\n        <Grid item>\r\n          <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n        </Grid>\r\n      </Grid>\r\n      <HtmlEditor\r\n        {...htmlEditorProps}\r\n        value={\r\n          htmlEditorProps.value && htmlEditorProps.value[language]\r\n            ? htmlEditorProps.value[language]\r\n            : \"\"\r\n        }\r\n        onChange={val => {\r\n          const res = {};\r\n          languages.forEach(lang => {\r\n            if (htmlEditorProps.value && htmlEditorProps.value[lang]) {\r\n              res[lang] = htmlEditorProps.value[lang];\r\n            }\r\n          });\r\n          res[language] = val;\r\n          htmlEditorProps.onChange(res);\r\n        }}\r\n\r\n      />\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nHtmlEditor = props =>\r\n  <ConnectedComponent htmlEditorProps={props}/>;\r\n\r\nexport default I18nHtmlEditor;","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {useForm} from 'react-hook-form'\r\nimport {compose} from \"redux\";\r\nimport {\r\n  addHubConfigDashboardsDashboard,\r\n  clearAllHubConfigDashboards,\r\n  clearHubConfig,\r\n  clearHubConfigDashboards,\r\n  closeHubConfig,\r\n  fetchAllHubConfigDashboards,\r\n  fetchHubConfig,\r\n  fetchHubConfigDashboards,\r\n  removeHubConfigDashboardsDashboard,\r\n  sendHubConfig,\r\n  sendHubConfigDashboardsOrders\r\n} from \"../../../state/hubConfig/hubConfigActions\";\r\nimport {connect} from \"react-redux\";\r\nimport FileInput from \"../../file-input\";\r\nimport DashboardsManager from \"../../dashboards-manager\";\r\nimport {canManageAppDashboards} from \"../../../utils/user\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nTextField from \"../../i18n-text-field\";\r\nimport {validateI18nObj} from \"../../../utils/i18n\";\r\nimport I18nHtmlEditor from \"../../i18n-html-editor\";\r\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.hubConfig.hub,\r\n  user: state.user,\r\n  dashboards: state.hubConfig.hubDashboards,\r\n  allDashboards: state.hubConfig.allDashboards\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  clearConfig: () => dispatch(clearHubConfig()),\r\n  fetchConfig: () => dispatch(fetchHubConfig()),\r\n  sendConfig: config => dispatch(sendHubConfig(config)),\r\n  fetchDashboards: () => dispatch(fetchHubConfigDashboards()),\r\n  fetchAllDashboards: () => dispatch(fetchAllHubConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearHubConfigDashboards()),\r\n  clearAllDashboards: () => dispatch(clearAllHubConfigDashboards()),\r\n  addDashboard: dashboardId => dispatch(addHubConfigDashboardsDashboard(dashboardId)),\r\n  removeDashboard: dashboardId => dispatch(removeHubConfigDashboardsDashboard(dashboardId)),\r\n  sendDashboardsOrders: orderedDashboarIds => dispatch(sendHubConfigDashboardsOrders(orderedDashboarIds)),\r\n  onClose: () => dispatch(closeHubConfig())\r\n});\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({\r\n                                                        classes,\r\n                                                        config,\r\n                                                        onSubmit,\r\n                                                        onCancel,\r\n                                                        user,\r\n                                                        dashboards,\r\n                                                        allDashboards,\r\n                                                        fetchDashboards,\r\n                                                        fetchAllDashboards,\r\n                                                        clearDashboards,\r\n                                                        clearAllDashboards,\r\n                                                        addDashboard,\r\n                                                        removeDashboard,\r\n                                                        sendDashboardsOrders\r\n                                                      }, ref) => {\r\n\r\n  const [tab, setTab] = useState(\"general\");\r\n  const dashboardsManagerRef = React.createRef();\r\n  const {t} = useTranslation();\r\n\r\n  const configExtras = config.extras ? JSON.parse(config.extras) : {};\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      ...config,\r\n      pageSize: configExtras.PageSize\r\n    }\r\n  });\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          pageSize: undefined\r\n        };\r\n\r\n        data.extras = JSON.stringify({\r\n          ...JSON.parse(data.extras || \"{}\"),\r\n          PageSize: val.pageSize\r\n        });\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n        if (dashboardsManagerRef.current) {\r\n          dashboardsManagerRef.current.destroy();\r\n        }\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n      if (dashboardsManagerRef.current) {\r\n        dashboardsManagerRef.current.destroy();\r\n      }\r\n    }\r\n  }));\r\n\r\n  /* custom register */\r\n  useEffect(() => {\r\n    register({\r\n      name: 'title'\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({name: 'slogan'});\r\n    register({\r\n      name: 'supportedLanguages'\r\n    }, {\r\n      validate: val => val.length > 0 || t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: 'defaultLanguage'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: 'maxObservationsAfterCriteria'\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      min: {\r\n        value: 1,\r\n        message: t(\"commons.validation.positiveInteger\")\r\n      }\r\n    })\r\n    register({\r\n      name: \"maxCells\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      min: {\r\n        value: 1,\r\n        message: t(\"commons.validation.positiveInteger\")\r\n      }\r\n    })\r\n    register({name: 'backgroundMediaURL'});\r\n    register({name: 'logoURL'});\r\n    register({name: 'description'});\r\n    register({\r\n      name: 'pageSize'\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n  }, [register, t]);\r\n\r\n  const defaultLanguage = watch('defaultLanguage');\r\n  const supportedLanguages = watch('supportedLanguages');\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <Tabs\r\n        value={tab}\r\n        onChange={(_, tab) => {\r\n          setTab(tab)\r\n        }}\r\n      >\r\n        <Tab value=\"general\" label={t(\"scenes.appSettings.tabs.general\")}/>\r\n        <Tab value=\"infos\" label={t(\"scenes.appSettings.tabs.information\")}/>\r\n        {canManageAppDashboards(user) && (<Tab value=\"dashboards\" label={t(\"scenes.appSettings.tabs.dashboards\")}/>)}\r\n      </Tabs>\r\n      <div className={classes.tabContent}>\r\n        {tab === \"general\" && (\r\n          <Fragment>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"title\"\r\n                label={t(\"scenes.appSettings.fields.title.label\")}\r\n                required\r\n                error={!!errors.title}\r\n                helperText={errors.title?.message}\r\n                variant=\"outlined\"\r\n                value={watch('title') || {}}\r\n                onChange={value => setValue('title', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"slogan\"\r\n                label={t(\"scenes.appSettings.fields.slogan.label\")}\r\n                variant=\"outlined\"\r\n                value={watch('slogan') || {}}\r\n                onChange={value => setValue('slogan', value)}\r\n              />\r\n            </FormControl>\r\n            <Autocomplete\r\n              multiple\r\n              variant=\"outlined\"\r\n              freeSolo\r\n              options={[]}\r\n              value={supportedLanguages || []}\r\n              renderTags={(value, getTagProps) =>\r\n                value.map((option, index) => (\r\n                  <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n                ))\r\n              }\r\n              required\r\n              onChange={(e, val) => {\r\n                setValue('supportedLanguages', val);\r\n                if (defaultLanguage && !val.includes(defaultLanguage)) {\r\n                  setValue('defaultLanguage', \"\");\r\n                }\r\n              }}\r\n              renderInput={params => (\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    label={t(\"scenes.appSettings.fields.supportedLanguages.label\")}\r\n                    {...params}\r\n                    variant=\"outlined\"\r\n                    placeholder={t(\"scenes.appSettings.fields.supportedLanguages.placeholder\")}\r\n                    error={!!errors.supportedLanguages}\r\n                    helperText={\r\n                      errors.supportedLanguages?.message || (\r\n                        <Fragment>\r\n                          {t(\"scenes.appSettings.fields.supportedLanguages.helper.text\")}\r\n                          <a\r\n                            href=\"https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes\"\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                            style={{marginLeft: 4}}\r\n                          >\r\n                            {t(\"scenes.appSettings.fields.supportedLanguages.helper.linkText\")}\r\n                          </a>\r\n                        </Fragment>\r\n                      )}\r\n                  />\r\n                </FormControl>\r\n              )}\r\n            />\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"defaultLanguage\"\r\n                select\r\n                required\r\n                label={t(\"scenes.nodeSettings.fields.defaultLanguage.label\")}\r\n                onChange={e => setValue('defaultLanguage', e.target.value)}\r\n                value={watch(\"defaultLanguage\") || ''}\r\n                error={!!errors.defaultLanguage}\r\n                helperText={errors.defaultLanguage?.message || t(\"scenes.nodeSettings.fields.defaultLanguage.helper\")}\r\n                variant=\"outlined\"\r\n              >\r\n                {supportedLanguages.map((val, index) =>\r\n                  <MenuItem key={index} value={val}>{val}</MenuItem>\r\n                )}\r\n              </TextField>\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"maxObservationsAfterCriteria\"\r\n                label={t(\"scenes.appSettings.fields.maxObservationsAfterCriteria.label\")}\r\n                required\r\n                type=\"number\"\r\n                error={!!errors.maxObservationsAfterCriteria}\r\n                helperText={errors.maxObservationsAfterCriteria?.message}\r\n                variant=\"outlined\"\r\n                value={watch('maxObservationsAfterCriteria') || ''}\r\n                onChange={({target}) => setValue('maxObservationsAfterCriteria', target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"maxCells\"\r\n                label={t(\"scenes.appSettings.fields.maxCells.label\")}\r\n                required\r\n                error={!!errors.maxCells}\r\n                helperText={errors.maxCells?.message}\r\n                variant=\"outlined\"\r\n                type=\"number\"\r\n                value={watch('maxCells') || ''}\r\n                onChange={({target}) => setValue('maxCells', target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                name=\"pageSize\"\r\n                label={t(\"scenes.appSettings.fields.pageSize.label\")}\r\n                variant=\"outlined\"\r\n                type=\"number\"\r\n                error={!!errors.pageSize}\r\n                helperText={errors.pageSize?.message}\r\n                value={watch('pageSize') || ''}\r\n                onChange={({target}) => setValue('pageSize', Number(target.value))}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.appSettings.fields.backgroundMediaURL.label\")}\r\n                value={watch('backgroundMediaURL')}\r\n                onChange={value => setValue('backgroundMediaURL', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.appSettings.fields.logoURL.label\")}\r\n                value={watch('logoURL')}\r\n                onChange={value => setValue('logoURL', value)}\r\n              />\r\n            </FormControl>\r\n          </Fragment>\r\n        )}\r\n        {tab === \"infos\" && (\r\n          <I18nHtmlEditor\r\n            value={watch('description')}\r\n            onChange={val => setValue('description', val)}\r\n          />\r\n        )}\r\n        {canManageAppDashboards(user) && tab === \"dashboards\" && (\r\n          <DashboardsManager\r\n            dashboards={dashboards}\r\n            allDashboards={allDashboards}\r\n            fetchDashboards={fetchDashboards}\r\n            fetchAllDashboards={fetchAllDashboards}\r\n            clearDashboards={clearDashboards}\r\n            clearAllDashboards={clearAllDashboards}\r\n            addDashboard={addDashboard}\r\n            removeDashboard={removeDashboard}\r\n            sendDashboardsOrders={sendDashboardsOrders}\r\n            ref={dashboardsManagerRef}\r\n          />\r\n        )}\r\n      </div>\r\n    </Box>\r\n  );\r\n});\r\n\r\nconst AppSettingsForm = ({\r\n                           config,\r\n                           fetchConfig,\r\n                           sendConfig,\r\n                           clearConfig,\r\n                           user,\r\n                           dashboards,\r\n                           allDashboards,\r\n                           fetchDashboards,\r\n                           fetchAllDashboards,\r\n                           clearDashboards,\r\n                           clearAllDashboards,\r\n                           addDashboard,\r\n                           removeDashboard,\r\n                           sendDashboardsOrders,\r\n                           onClose\r\n                         }, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  return (config &&\r\n    <Form\r\n      config={config}\r\n      ref={ref}\r\n      onSubmit={sendConfig}\r\n      onCancel={() => {\r\n        clearConfig();\r\n        onClose();\r\n      }}\r\n      user={user}\r\n      dashboards={dashboards}\r\n      allDashboards={allDashboards}\r\n      fetchDashboards={fetchDashboards}\r\n      fetchAllDashboards={fetchAllDashboards}\r\n      clearDashboards={clearDashboards}\r\n      clearAllDashboards={clearAllDashboards}\r\n      addDashboard={addDashboard}\r\n      removeDashboard={removeDashboard}\r\n      sendDashboardsOrders={sendDashboardsOrders}\r\n    />);\r\n\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(AppSettingsForm);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getAddNodeDashboardUrl,\r\n    getNodeConfigGetUrl,\r\n    getNodeDashboardsUrl,\r\n    getNodeDeleteUrl,\r\n    getNodesConfigPostUrl,\r\n    getNodesConfigPutUrl,\r\n    getNodesConfigUrl,\r\n    getNodesOrderPutUrl,\r\n    getOrderNodeDashboardsUrl,\r\n    getRemoveNodeDashboardUrl,\r\n    getUserDashboardsUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const NODES_CONFIG_NODES_FETCH = \"nodesConfig/fetchNodes\";\r\nexport const NODES_CONFIG_NODES_CLEAR = \"nodesConfig/clearNodes\";\r\nexport const NODES_CONFIG_NODE_FETCH = \"nodesConfig/fetchNode\";\r\nexport const NODES_CONFIG_NODE_CLEAR = \"nodesConfig/clearNode\";\r\nexport const NODES_CONFIG_NODES_ORDER_SEND = \"nodesConfig/sendNodesOrder\";\r\nexport const NODES_CONFIG_NODE_DELETE = \"nodesConfig/deleteNode\";\r\nexport const NODES_CONFIG_NODE_CREATE = \"nodesConfig/createNode\";\r\nexport const NODES_CONFIG_NODE_EDIT = \"nodesConfig/editNode\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_FETCH = \"nodesConfig/nodeDashboards/fetch\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL = \"nodesConfig/nodeDashboards/fetchAll\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD = \"nodesConfig/nodeDashboards/addDashboard\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE = \"nodesConfig/nodeDashboards/removeDashboard\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND = \"nodesConfig/nodeDashboards/sendOrders\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_CLEAR = \"nodesConfig/nodeDashboards/clear\";\r\nexport const NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL = \"nodesConfig/nodeDashboards/clearAll\";\r\nexport const NODES_CONFIG_CLOSE = \"nodesConfig/close\";\r\n\r\nexport const fetchNodesConfigNodes = () => initRequest(\r\n    NODES_CONFIG_NODES_FETCH,\r\n    getNodesConfigUrl(),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchNodes.start\")\r\n    })\r\n);\r\n\r\nexport const clearNodesConfigNodes = () => ({\r\n  type: NODES_CONFIG_NODES_CLEAR\r\n});\r\n\r\nexport const sendNodesConfigNodesOrder = (orderedIds: number[]) => initRequest(\r\n  NODES_CONFIG_NODES_ORDER_SEND,\r\n  getNodesOrderPutUrl(),\r\n  RequestMethod.PUT,\r\n  orderedIds,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.sendNodesOrder.start\")\r\n  })\r\n);\r\n\r\nexport const deleteNodesConfigNode = (nodeId: number) => initRequest(\r\n  NODES_CONFIG_NODE_DELETE,\r\n  getNodeDeleteUrl(nodeId),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.deleteNode.start\")\r\n  }),\r\n  {\r\n      nodeId,\r\n      onForce: () => initRequest(\r\n          NODES_CONFIG_NODE_DELETE,\r\n          getNodeDeleteUrl(nodeId, true),\r\n          RequestMethod.DELETE,\r\n          undefined,\r\n          t => ({\r\n              onStart: t(\"scenes.nodesSettings.messages.deleteNode.start\")\r\n          }),\r\n          {\r\n              nodeId\r\n          }\r\n      )\r\n  }\r\n);\r\n\r\nexport const fetchNodesConfigNode = (nodeId: number) => initRequest(\r\n  NODES_CONFIG_NODE_FETCH,\r\n  getNodeConfigGetUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.fetchNode.start\")\r\n  })\r\n);\r\n\r\nexport const clearNodesConfigNode = () => ({\r\n  type: NODES_CONFIG_NODE_CLEAR\r\n});\r\n\r\nexport const sendNodesConfigNodeCreate = (node: any) => initRequest(\r\n  NODES_CONFIG_NODE_CREATE,\r\n  getNodesConfigPostUrl(),\r\n  RequestMethod.POST,\r\n  node,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.messages.sendNodeCreate.start\")\r\n  })\r\n);\r\n\r\nexport const sendNodesConfigNodeEdit = (node: any) => initRequest(\r\n    NODES_CONFIG_NODE_EDIT,\r\n    getNodesConfigPutUrl(node.nodeId),\r\n    RequestMethod.PUT,\r\n    node,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.sendNodeEdit.start\")\r\n    }),\r\n    {\r\n        nodeId: node.nodeId\r\n    }\r\n);\r\n\r\nexport const fetchNodesConfigNodeDashboards = (nodeId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_FETCH,\r\n    getNodeDashboardsUrl(nodeId),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchNodeDashboards.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const fetchAllNodeConfigDashboards = () => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL,\r\n    getUserDashboardsUrl(),\r\n    RequestMethod.GET,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.fetchAllDashboards.start\")\r\n    })\r\n);\r\n\r\nexport const addNodesConfigDashboardsNodeDashboard = (nodeId: number, dashboardId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n    getAddNodeDashboardUrl(nodeId, dashboardId),\r\n    RequestMethod.POST,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.addNodeDashboard.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const removeNodesConfigDashboardsNodeDashboard = (nodeId: number, dashboardId: number) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n    getRemoveNodeDashboardUrl(nodeId, dashboardId),\r\n    RequestMethod.DELETE,\r\n    null,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.removeNodeDashboard.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n);\r\n\r\nexport const sendNodesConfigDashboardsNodeOrders = (nodeId: number, orderedDashboardsIds: number[]) => initRequest(\r\n    NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n    getOrderNodeDashboardsUrl(nodeId),\r\n    RequestMethod.POST,\r\n    orderedDashboardsIds,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.messages.sendNodeDashboardsOrders.start\")\r\n    }),\r\n    {\r\n        nodeId\r\n    }\r\n)\r\n\r\nexport const clearNodesConfigNodeDashboards = () => ({\r\n    type: NODES_CONFIG_NODE_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const clearAllNodesConfigNodeDashboards = () => ({\r\n    type: NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL\r\n});\r\n\r\nexport const closeNodesConfig = () => ({\r\n    type: NODES_CONFIG_CLOSE\r\n});","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  getCreateTemplateUrl,\r\n  getCreateViewUrl,\r\n  getDatasetDownloadUrl,\r\n  getDatasetStructureCodelistsUrl,\r\n  getDatasetStructureCodelistUrl,\r\n  getDatasetStructureDynamicCodelistUrl,\r\n  getDatasetStructureUrl,\r\n  getDatasetUrl,\r\n  getGeometryUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const DATASET_STRUCTURE_FETCH_ENABLE = \"dataset/structure/fetch/enable\";\r\nexport const DATASET_STRUCTURE_FETCH = \"dataset/structure/fetch\";\r\nexport const DATASET_FETCH_ENABLE = \"dataset/fetch/enable\";\r\nexport const DATASET_FETCH = \"dataset/fetch\";\r\nexport const DATASET_ACCESSIBLE_FETCH = \"dataset/accessible/fetch\";\r\nexport const DATASET_CRITERIA_LENGTH_WARNING_SHOW = \"dataset/criteria/length/warning/show\";\r\nexport const DATASET_CRITERIA_LENGTH_WARNING_HIDE = \"dataset/criteria/length/warning/hide\";\r\nexport const DATASET_CRITERIA_SHOW = \"dataset/criteria/show\";\r\nexport const DATASET_CRITERIA_HIDE = \"dataset/criteria/hide\";\r\nexport const DATASET_CRITERIA_ALERT_HIDE = \"dataset/criteria/alert/hide\";\r\nexport const DATASET_STRUCTURE_CODELIST_FETCH = \"dataset/structure/codelist/fetch\";\r\nexport const DATASET_STRUCTURE_CODELISTS_FETCH = \"dataset/structure/codelists/fetch\";\r\nexport const DATASET_STRUCTURE_CODELIST_FILTER_SET = \"dataset/structure/codelist/filters/set\";\r\nexport const DATASET_RESET = \"dataset/reset\";\r\n\r\nexport const DATASET_VIEWER_SET = \"dataset/viewer/set\";\r\n\r\nexport const DATASET_LABEL_FORMAT_SET = \"dataset/label/format/set\";\r\n\r\nexport const DATASET_DOWNLOAD_SUBMIT = \"dataset/download/submit\";\r\nexport const DATASET_DOWNLOAD_WARNING_HIDE = \"dataset/download/warning/hide\";\r\n\r\nexport const DATASET_VIEW_TEMPLATE_SUBMIT = \"dataset/view/template/submit\";\r\n\r\nexport const DATASET_UNAVAILABLE_VIEW_WARNING_HIDE = \"dataset/unavailable/view/warning/hide\";\r\n\r\nexport const DATASET_HTML_GENERATING_TIME_SET = \"dataset/html/generating/time/set\";\r\n\r\nexport const DATASET_TERRITORY_FETCH = \"dataset/territory/fetch\";\r\n\r\nexport const ALL_FULL = \"FullAll\"\r\nexport const ALL_PARTIAL = \"PartialAll\"\r\nexport const STEP_BY_STEP_FULL = \"FullStep\"\r\nexport const STEP_BY_STEP_PARTIAL = \"PartialStep\"\r\nexport const STEP_BY_STEP_DYNAMIC = \"Dynamic\"\r\n\r\nexport const CRITERIA_SELECTION_MODE_STEP_BY_STEP = \"stepByStep\"\r\nexport const CRITERIA_SELECTION_MODE_ALL = \"all\"\r\n\r\nexport const CRITERIA_SELECTION_TYPE_FULL = \"full\"\r\nexport const CRITERIA_SELECTION_TYPE_PARTIAL = \"partial\"\r\nexport const CRITERIA_SELECTION_TYPE_DYNAMIC = \"dynamic\"\r\n\r\nconst ENDPOINT_STRING_LENGTH = 100;\r\nconst MAX_CRITERIA_STRING_LENGTH = 2000;\r\n\r\nconst getCriteriaObject = (filters: any) => {\r\n  const res: { id: string; filterValues: any; }[] = [];\r\n\r\n  Object.keys(filters).forEach(key => {\r\n    if (filters[key] && filters[key].length > 0) {\r\n      res.push({\r\n        id: key,\r\n        filterValues: filters[key]\r\n      })\r\n    }\r\n  });\r\n\r\n  return res;\r\n};\r\n\r\nexport const enableDatasetStructureFetch = (datasetId: string) => ({\r\n  type: DATASET_STRUCTURE_FETCH_ENABLE,\r\n  datasetId\r\n});\r\n\r\nexport const fetchDatasetStructure = (nodeId: number, datasetId: string, viewId: string, defaultLanguage: string, languages: string[]) => initRequest(\r\n  DATASET_STRUCTURE_FETCH,\r\n  getDatasetStructureUrl(nodeId, datasetId, viewId),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDatasetStructure\")\r\n  }),\r\n  {\r\n    viewId: viewId,\r\n    defaultLanguage: defaultLanguage,\r\n    languages: languages\r\n  }\r\n);\r\n\r\nexport const enableDatasetFetch = () => ({\r\n  type: DATASET_FETCH_ENABLE\r\n});\r\n\r\nexport const fetchDataset = (nodeId: number, datasetId: string, filters: any, datasetTitle: string, checkCriteriaLength: boolean, tableLayout: any) => {\r\n  const flatCriteria = getCriteriaObject(filters);\r\n\r\n  return (checkCriteriaLength && ((JSON.stringify(flatCriteria).length + ENDPOINT_STRING_LENGTH) > MAX_CRITERIA_STRING_LENGTH))\r\n    ? {\r\n      type: DATASET_CRITERIA_LENGTH_WARNING_SHOW\r\n    }\r\n    : initRequest(\r\n      DATASET_FETCH,\r\n      getDatasetUrl(nodeId, datasetId),\r\n      RequestMethod.POST,\r\n      flatCriteria,\r\n      t => ({\r\n        onStart: t(\"scenes.dataset.actions.fetchingDataset\", {title: datasetTitle})\r\n      }),\r\n      {\r\n        tableLayout: tableLayout\r\n      },\r\n      \"\",\r\n      (statusCode: number) => statusCode === 413\r\n    );\r\n};\r\n\r\nexport const fetchAccessibleDataset = (nodeId: number, datasetId: string, filters: any, datasetTitle: string) => initRequest(\r\n  DATASET_ACCESSIBLE_FETCH,\r\n  getDatasetDownloadUrl(nodeId, datasetId, \"csv\"),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.fetchingDataset\", {title: datasetTitle})\r\n  })\r\n);\r\n\r\nexport const hideDatasetCriteriaLengthWarning = () => ({\r\n  type: DATASET_CRITERIA_LENGTH_WARNING_HIDE\r\n});\r\n\r\nexport const showDatasetCriteria = () => ({\r\n  type: DATASET_CRITERIA_SHOW\r\n});\r\n\r\nexport const hideDatasetCriteria = () => ({\r\n  type: DATASET_CRITERIA_HIDE\r\n});\r\n\r\nexport const hideDatasetCriteriaAlert = () => ({\r\n  type: DATASET_CRITERIA_ALERT_HIDE\r\n});\r\n\r\nexport const fetchDatasetStructureCodelist = (nodeId: number, datasetId: string, dimensionId: string, type: string, filters: any) => {\r\n\r\n  let flatCriteria = getCriteriaObject(filters);\r\n  // @ts-ignore\r\n  flatCriteria = flatCriteria.filter(({id}) => id !== dimensionId)\r\n\r\n  return type === CRITERIA_SELECTION_TYPE_DYNAMIC\r\n    ? (\r\n      initRequest(\r\n        DATASET_STRUCTURE_CODELIST_FETCH,\r\n        getDatasetStructureDynamicCodelistUrl(nodeId, datasetId, dimensionId),\r\n        RequestMethod.POST,\r\n        flatCriteria,\r\n        t => ({\r\n          onStart: t(\"scenes.dataset.actions.fetchingCodelist\")\r\n        })\r\n      )\r\n    )\r\n    : (\r\n      initRequest(\r\n        DATASET_STRUCTURE_CODELIST_FETCH,\r\n        getDatasetStructureCodelistUrl(nodeId, datasetId, dimensionId, type === CRITERIA_SELECTION_TYPE_FULL),\r\n        undefined,\r\n        undefined,\r\n        t => ({\r\n          onStart: t(\"scenes.dataset.actions.fetchingCodelist\")\r\n        })\r\n      )\r\n    );\r\n};\r\n\r\nexport const fetchDatasetStructureCodelists = (nodeId: number, datasetId: string, type: string) => initRequest(\r\n  DATASET_STRUCTURE_CODELISTS_FETCH,\r\n  getDatasetStructureCodelistsUrl(nodeId, datasetId, type === CRITERIA_SELECTION_TYPE_FULL),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.fetchingCodelists\")\r\n  })\r\n);\r\n\r\nexport const setDatasetStructureCodelistFilters = (filters: any) => ({\r\n  type: DATASET_STRUCTURE_CODELIST_FILTER_SET,\r\n  filters\r\n});\r\n\r\nexport const resetDataset = () => ({\r\n  type: DATASET_RESET\r\n});\r\n\r\nexport const setDatasetViewer = (viewerIdx: number) => ({\r\n  type: DATASET_VIEWER_SET,\r\n  viewerIdx\r\n});\r\n\r\nexport const setDatasetLabelFormat = (labelFormat: string) => ({\r\n  type: DATASET_LABEL_FORMAT_SET,\r\n  labelFormat\r\n});\r\n\r\nexport const submitDatasetDownload = (nodeId: number, datasetId: string, datasetTitle: string, format: string, extension: string, observation?: string) => initRequest(\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  getDatasetDownloadUrl(nodeId, datasetId, format),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dataset.actions.downloadingDataset\")\r\n  }),\r\n  {\r\n    fileSave: {\r\n      name: `${datasetTitle}.${extension}`,\r\n      type: \"text/plain;charset=utf-8\"\r\n    }\r\n  },\r\n  \"\",\r\n  (statusCode: number) => statusCode === 406\r\n);\r\n\r\nexport const hideDatasetDownloadWarning = () => ({\r\n  type: DATASET_DOWNLOAD_WARNING_HIDE\r\n});\r\n\r\nexport const submitDatasetViewTemplate = (nodeId: number, viewTemplate: any, isView: boolean) => initRequest(\r\n  DATASET_VIEW_TEMPLATE_SUBMIT,\r\n  isView\r\n    ? getCreateViewUrl(nodeId)\r\n    : getCreateTemplateUrl(nodeId),\r\n  RequestMethod.POST,\r\n  viewTemplate,\r\n  t => ({\r\n    onStart: isView\r\n      ? t(\"scenes.dataset.actions.savingView\")\r\n      : t(\"scenes.dataset.actions.savingTemplate\")\r\n  })\r\n);\r\n\r\nexport const hideDatasetUnavailableViewWarning = () => ({\r\n  type: DATASET_UNAVAILABLE_VIEW_WARNING_HIDE\r\n});\r\n\r\nexport const setDatasetHtmlGeneratingTime = (time: number) => ({\r\n  type: DATASET_HTML_GENERATING_TIME_SET,\r\n  time\r\n});\r\n\r\n\r\nexport const fetchDatasetGeometries = (idList: string[]) => initRequest(\r\n  DATASET_TERRITORY_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dataset.actions.fetchingGeometries`)\r\n  })\r\n);","import React from \"react\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\n\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME = \"LABEL_FORMAT_SELECTOR_FORMAT_NAME\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID = \"LABEL_FORMAT_SELECTOR_FORMAT_ID\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH = \"LABEL_FORMAT_SELECTOR_FORMAT_BOTH\";\r\n\r\nconst InfoTooltip = ({children}) => {\r\n\r\n  return children\r\n    ? (\r\n      <Tooltip title={children} placement=\"top\">\r\n        <IconButton\r\n          aria-label=\"info\"\r\n          style={{\r\n            color: \"#00295A\",\r\n            padding: 0,\r\n            transform: \"translateY(-1px)\"\r\n          }}\r\n        >\r\n          <InfoIcon fontSize=\"small\"/>\r\n        </IconButton>\r\n      </Tooltip>\r\n    )\r\n    : (\r\n      <IconButton\r\n        aria-label=\"info\"\r\n        style={{\r\n          color: \"#00295A\",\r\n          padding: 0,\r\n          transform: \"translateY(-1px)\"\r\n        }}\r\n      >\r\n        <InfoIcon fontSize=\"small\"/>\r\n      </IconButton>\r\n    );\r\n};\r\n\r\nexport default InfoTooltip;","import React, {Fragment} from 'react';\r\nimport InfoTooltip from \"../info-tooltip\";\r\n\r\nconst FormLabelWithTooltip = ({children, tooltip, tooltipOnRight}) => {\r\n\r\n  const Tooltip = () =>\r\n    <span\r\n      style={{\r\n        pointerEvents: \"auto\",\r\n        marginLeft: tooltipOnRight ? 10 : null,\r\n        marginRight: !tooltipOnRight ? 10 : null,\r\n      }}\r\n    >\r\n        <InfoTooltip>\r\n          {tooltip}\r\n        </InfoTooltip>\r\n     </span>;\r\n\r\n  return (\r\n    <Fragment>\r\n      {!tooltipOnRight && <Tooltip/>}\r\n      <span style={{pointerEvents: \"none\"}}>\r\n        {children}\r\n      </span>\r\n      {tooltipOnRight && <Tooltip/>}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default FormLabelWithTooltip;","export const downloadFormats = t => ({\r\n  genericdata: {\r\n    label: t ? t(\"commons.downloadFormat.genericdata\") : \"genericdata\",\r\n    extension: \"xml\"\r\n  },\r\n  genericdata20: {\r\n    label: t ? t(\"commons.downloadFormat.genericdata20\") : \"genericdata20\",\r\n    extension: \"xml\"\r\n  },\r\n  compactdata: {\r\n    label: t ? t(\"commons.downloadFormat.compactdata\") : \"compactdata\",\r\n    extension: \"xml\"\r\n  },\r\n  structurespecificdata: {\r\n    label: t ? t(\"commons.downloadFormat.structurespecificdata\") : \"structurespecificdata\",\r\n    extension: \"xml\"\r\n  },\r\n  jsondata: {\r\n    label: t ? t(\"commons.downloadFormat.jsondata\") : \"jsondata\",\r\n    extension: \"json\"\r\n  },\r\n  csv: {\r\n    label: t ? t(\"commons.downloadFormat.csv\") : \"csv\",\r\n    extension: \"csv\"\r\n  }\r\n});\r\n\r\nexport const isDownloadFormatValid = format => downloadFormats()?.[format] !== undefined\r\n\r\nexport const getDownloadFormatLabels = t => {\r\n  const labels = [];\r\n\r\n  for (let format in downloadFormats) {\r\n    if (downloadFormats.hasOwnProperty(format)) {\r\n      labels.push(downloadFormats(t)[format].label);\r\n    }\r\n  }\r\n\r\n  return labels;\r\n};\r\n\r\nexport const getDownloadFormatLabelFromFormat = (format, t) => downloadFormats(t)[format]?.label;\r\n\r\nexport const getDownloadFormatExtensionFromFormat = (format, t) => downloadFormats(t)[format]?.extension;","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {Checkbox, withStyles} from \"@material-ui/core\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport {useForm} from 'react-hook-form'\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport {compose} from \"redux\";\r\nimport validator from \"validator\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearNodesConfigNode,\r\n  fetchNodesConfigNode,\r\n  sendNodesConfigNodeCreate,\r\n  sendNodesConfigNodeEdit\r\n} from \"../../../../state/nodesConfig/nodesConfigActions\";\r\nimport {\r\n  ALL_FULL,\r\n  ALL_PARTIAL,\r\n  STEP_BY_STEP_DYNAMIC,\r\n  STEP_BY_STEP_FULL,\r\n  STEP_BY_STEP_PARTIAL\r\n} from \"../../../../state/dataset/datasetActions\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Autocomplete from \"@material-ui/lab/Autocomplete\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport FileInput from \"../../../file-input\";\r\nimport FormLabelWithTooltip from \"../../../form-label-with-tooltip\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nTextField from \"../../../i18n-text-field\";\r\nimport {validateI18nObj} from \"../../../../utils/i18n\";\r\nimport I18nHtmlEditor from \"../../../i18n-html-editor\";\r\nimport {downloadFormats} from \"../../../../utils/download\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, onSubmit, onCancel}, ref) => {\r\n\r\n  const [tab, setTab] = useState(\"general\");\r\n  const [mustChangeTabOnErrors, setMustChangeTabOnErrors] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      ...config,\r\n      annotationConfig:\r\n        config?.extras?.find(({key}) => key === \"AnnotationConfig\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"AnnotationConfig\").value)\r\n          : {\r\n            \"ORDER\": \"ORDER\",\r\n            \"ORDER_CATEGORY\": \"ORDER\",\r\n            \"ORDER_CODELIST\": \"ORDER\",\r\n            \"NOT_DISPLAYED\": \"NOT_DISPLAYED\",\r\n            \"DEFAULT\": \"DEFAULT\",\r\n            \"LAYOUT_ROW\": \"LAYOUT_ROW\",\r\n            \"LAYOUT_COLUMN\": \"LAYOUT_COLUMN\",\r\n            \"LAYOUT_FILTER\": \"LAYOUT_FILTER\",\r\n            \"LAYOUT_ROW_SECTION\": \"LAYOUT_ROW_SECTION\",\r\n            \"CRITERIA_SELECTION\": \"CRITERIA_SELECTION\",\r\n            \"ATTACHED_DATA_FILES\": \"ATTACHED_DATA_FILES\",\r\n            \"LAYOUT_DECIMAL_SEPARATOR\": \"LAYOUT_DECIMAL_SEPARATOR\",\r\n            \"LAYOUT_NUMBER_OF_DECIMALS\": \"LAYOUT_NUMBER_OF_DECIMALS\",\r\n            \"LAYOUT_EMPTY_CELL_PLACEHOLDER\": \"LAYOUT_EMPTY_CELL_PLACEHOLDER\",\r\n            \"DATAFLOW_NOTES\": \"DATAFLOW_NOTES\",\r\n            \"DATAFLOW_SOURCE\": \"DATAFLOW_SOURCE\",\r\n            \"METADATA_URL\": \"METADATA_URL\",\r\n            \"KEYWORDS\": \"KEYWORDS\",\r\n            \"DEFAULT_VIEW\": \"DEFAULT_VIEW\",\r\n            \"GEO_ID\": \"GEO_ID\",\r\n            \"LAST_UPDATE\": \"LAST_UPDATE\",\r\n            \"VIRTUAL_DATAFLOW_NODE\": \"VIRTUAL_DATAFLOW_NODE\",\r\n          },\r\n      showCategoryLevels: config?.showCategoryLevels || 1,\r\n      decimalNumber: config?.decimalNumber || 1,\r\n      decimalSeparator: config?.decimalSeparator || {en: \",\"},\r\n      catalogNavigationMode: config?.catalogNavigationMode || \"List\",\r\n      hiddenAttributes:\r\n        config?.extras?.find(({key}) => key === \"HiddenAttributes\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"HiddenAttributes\").value)\r\n          : [],\r\n      pageSize:\r\n        config?.extras?.find(({key}) => key === \"PageSize\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"PageSize\").value)\r\n          : \"\",\r\n      restDataResponseXml:\r\n        config?.extras?.find(({key}) => key === \"RestDataResponseXml\") && (\r\n          config.extras.find(({key}) => key === \"RestDataResponseXml\").value === \"false\" ||\r\n          config.extras.find(({key}) => key === \"RestDataResponseXml\").value === \"true\"\r\n        )\r\n          ? config.extras.find(({key}) => key === \"RestDataResponseXml\").value\r\n          : \"\",\r\n      downloadFormats:\r\n        config?.extras?.find(({key}) => key === \"DownloadFormats\")\r\n          ? JSON.parse(config.extras.find(({key}) => key === \"DownloadFormats\").value)\r\n          : [],\r\n    }\r\n  });\r\n\r\n  const enableHttpAuth = watch(\"enableHttpAuth\");\r\n  const enableProxy = watch(\"enableProxy\");\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      setMustChangeTabOnErrors(true);\r\n      handleSubmit(val => {\r\n        const data = {\r\n          ...config,\r\n          ...val,\r\n          type: \"SDMX-REST\",\r\n          annotationConfig: undefined,\r\n          restDataResponseXml: undefined,\r\n          optimizeCallWithSoap: undefined,\r\n          namespaceV20: undefined,\r\n          namespaceV21: undefined,\r\n          hiddenAttributes: undefined,\r\n          pageSize: undefined,\r\n          downloadFormats: undefined\r\n        };\r\n\r\n        if (data.extras?.find(({key}) => key === \"AnnotationConfig\")) {\r\n          data.extras.find(({key}) => key === \"AnnotationConfig\").value = JSON.stringify(val.annotationConfig)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"AnnotationConfig\",\r\n            value: JSON.stringify(val.annotationConfig),\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"RestDataResponseXml\")) {\r\n          data.extras.find(({key}) => key === \"RestDataResponseXml\").value = val.restDataResponseXml\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"RestDataResponseXml\",\r\n            value: val.restDataResponseXml,\r\n            isPublic: false\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"HiddenAttributes\")) {\r\n          data.extras.find(({key}) => key === \"HiddenAttributes\").value = JSON.stringify(val.hiddenAttributes)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"HiddenAttributes\",\r\n            value: JSON.stringify(val.hiddenAttributes),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"PageSize\")) {\r\n          data.extras.find(({key}) => key === \"PageSize\").value = JSON.stringify(val.pageSize)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"PageSize\",\r\n            value: JSON.stringify(val.pageSize),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        if (data.extras?.find(({key}) => key === \"DownloadFormats\")) {\r\n          data.extras.find(({key}) => key === \"DownloadFormats\").value = JSON.stringify(val.downloadFormats)\r\n        } else {\r\n          data.extras = data.extras || [];\r\n          data.extras.push({\r\n            key: \"DownloadFormats\",\r\n            value: JSON.stringify(val.downloadFormats),\r\n            isPublic: true\r\n          });\r\n        }\r\n\r\n        onSubmit(data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  /* custom register */\r\n  useEffect(() => {\r\n\r\n    register({\r\n      name: \"code\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n    });\r\n    register({\r\n      name: \"title\"\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({\r\n      name: \"agency\"\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    })\r\n    register({name: 'active'});\r\n    register({name: \"slogan\"});\r\n    register({name: 'backgroundMediaURL'});\r\n    register({name: 'logo'});\r\n    register({name: 'description'});\r\n    register({\r\n      name: 'criteriaSelectionMode'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"endPoint\"\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({name: 'enableHttpAuth'});\r\n    register({name: 'enableProxy'});\r\n    register({name: 'annotationConfig.ORDER'});\r\n    register({name: 'annotationConfig.ORDER_CATEGORY'});\r\n    register({name: 'annotationConfig.ORDER_CODELIST'});\r\n    register({name: 'annotationConfig.NOT_DISPLAYED'});\r\n    register({name: 'annotationConfig.DEFAULT'});\r\n    register({name: 'annotationConfig.LAYOUT_ROW'});\r\n    register({name: 'annotationConfig.LAYOUT_COLUMN'});\r\n    register({name: 'annotationConfig.LAYOUT_FILTER'});\r\n    register({name: 'annotationConfig.LAYOUT_ROW_SECTION'});\r\n    register({name: 'annotationConfig.CRITERIA_SELECTION'});\r\n    register({name: 'annotationConfig.ATTACHED_DATA_FILES'});\r\n    register({name: 'annotationConfig.LAYOUT_DECIMAL_SEPARATOR'});\r\n    register({name: 'annotationConfig.LAYOUT_NUMBER_OF_DECIMALS'});\r\n    register({name: 'annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER'});\r\n    register({name: 'annotationConfig.DATAFLOW_NOTES'});\r\n    register({name: 'annotationConfig.DATAFLOW_SOURCE'});\r\n    register({name: 'annotationConfig.METADATA_URL'});\r\n    register({name: 'annotationConfig.KEYWORDS'});\r\n    register({name: 'annotationConfig.DEFAULT_VIEW'});\r\n    register({name: 'annotationConfig.GEO_ID'});\r\n    register({name: 'annotationConfig.LAST_UPDATE'});\r\n    register({name: 'annotationConfig.VIRTUAL_DATAFLOW_NODE'});\r\n    register({\r\n      name: \"ttlCatalog\"\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: \"ttlDataflow\"\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({name: 'showDataflowUncategorized'});\r\n    register({\r\n      name: 'showCategoryLevels'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({\r\n      name: \"decimalNumber\"\r\n    }, {\r\n      required: t(\"commons.validation.required\"),\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: 'decimalSeparator'\r\n    }, {\r\n      validate: val => validateI18nObj(val) || t(\"commons.validation.requiredAnyLanguage\")\r\n    });\r\n    register({name: 'labelDimensionTerritorials'});\r\n    register({name: 'labelDimensionTemporals'});\r\n    register({name: 'categorySchemaExcludes'});\r\n    register({\r\n      name: 'catalogNavigationMode'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({name: 'hiddenAttributes'});\r\n    register({\r\n      name: 'pageSize'\r\n    }, {\r\n      validate: val => !val || val > 0 || t(\"commons.validation.positiveInteger\")\r\n    });\r\n    register({\r\n      name: 'restDataResponseXml'\r\n    }, {\r\n      required: t(\"commons.validation.required\")\r\n    });\r\n    register({name: 'downloadFormats'});\r\n  }, [register, t]);\r\n\r\n  /* register enableHttpAuth fieldset */\r\n  useEffect(() => {\r\n\r\n    if (enableHttpAuth) {\r\n      register({\r\n        name: \"authHttpUsername\"\r\n      }, {\r\n        required: t(\"commons.validation.required\")\r\n      });\r\n      register({\r\n        name: \"authHttpPassword\"\r\n      });\r\n      register({\r\n        name: \"authHttpDomain\"\r\n      });\r\n    }\r\n\r\n  }, [register, enableHttpAuth, t]);\r\n\r\n  /* register enableProxy fieldset */\r\n  useEffect(() => {\r\n\r\n    if (enableProxy) {\r\n      register({\r\n        name: \"proxyAddress\"\r\n      }, {\r\n        required: t(\"commons.validation.required\")\r\n      });\r\n      register({\r\n        name: \"proxyPort\"\r\n      }, {\r\n        required: t(\"commons.validation.required\"),\r\n        validate: val => validator.isPort(val) || t(\"scenes.nodeSettings.fields.proxyPort.validation\")\r\n      });\r\n      register({name: \"proxyUsername\"});\r\n      register({name: \"proxyPassword\"});\r\n    }\r\n  }, [register, enableProxy, t]);\r\n\r\n  /* switch to first tab with errors */\r\n  if (Object.keys(errors).length > 0 && mustChangeTabOnErrors) {\r\n\r\n    setMustChangeTabOnErrors(false);\r\n\r\n    const firstFieldWithErrors = Object.keys(errors)[0];\r\n    if (firstFieldWithErrors === \"code\" || firstFieldWithErrors === \"agency\" || firstFieldWithErrors === \"title\" || firstFieldWithErrors === \"slogan\") {\r\n      if (tab !== \"general\") {\r\n        setTab(\"general\")\r\n      }\r\n    } else if (\r\n      firstFieldWithErrors === \"showCategoryLevels\" ||\r\n      firstFieldWithErrors === \"decimalNumber\" ||\r\n      firstFieldWithErrors === \"decimalSeparator\" ||\r\n      firstFieldWithErrors === \"labelDimensionTerritorials\" ||\r\n      firstFieldWithErrors === \"labelDimensionTemporals\" ||\r\n      firstFieldWithErrors === \"categorySchemaExcludes\" ||\r\n      firstFieldWithErrors === \"catalogNavigationMode\" ||\r\n      firstFieldWithErrors === \"hiddenAttributes\" ||\r\n      firstFieldWithErrors === \"pageSize\" ||\r\n      firstFieldWithErrors === \"downloadFormats\"\r\n    ) {\r\n\r\n      if (tab !== \"view\") {\r\n        setTab(\"view\")\r\n      }\r\n\r\n    } else if (firstFieldWithErrors) {\r\n\r\n      if (tab !== \"endpoint\") {\r\n        setTab(\"endpoint\");\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Box className={classes.root}>\r\n      <Tabs\r\n        value={tab}\r\n        onChange={(_, tab) => setTab(tab)}\r\n      >\r\n        <Tab value=\"general\" label={t(\"scenes.nodeSettings.tabs.general.label\")}/>\r\n        <Tab value=\"infos\" label={t(\"scenes.nodeSettings.tabs.information.label\")}/>\r\n        <Tab value=\"endpoint\" label={t(\"scenes.nodeSettings.tabs.endpoint.label\")}/>\r\n        <Tab value=\"annotations\" label={t(\"scenes.nodeSettings.tabs.annotations.label\")}/>\r\n        <Tab value=\"view\" label={t(\"scenes.nodeSettings.tabs.view.label\")}/>\r\n        <Tab value=\"cache\" label={t(\"scenes.nodeSettings.tabs.cache.label\")}/>\r\n      </Tabs>\r\n      <div className={classes.tabContent}>\r\n        <Box style={tab !== \"general\" ? {display: \"none\"} : undefined}>\r\n          <Fragment>\r\n            <Grid container spacing={3}>\r\n              <Grid item xs={3}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    disabled={!!config}\r\n                    name=\"code\"\r\n                    variant=\"outlined\"\r\n                    label={\r\n                      <FormLabelWithTooltip tooltip={t(\"scenes.nodeSettings.fields.code.tooltip\")}>\r\n                        {t(\"scenes.nodeSettings.fields.code.label\")}\r\n                      </FormLabelWithTooltip>\r\n                    }\r\n                    required\r\n                    error={!!errors.code}\r\n                    helperText={errors.code?.message}\r\n                    value={watch('code') || \"\"}\r\n                    onChange={({target}) => setValue('code', (target.value || \"\").toUpperCase())}\r\n                    inputProps={{\r\n                      style: {textTransform: \"uppercase\"}\r\n                    }}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={6}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <I18nTextField\r\n                    name=\"title\"\r\n                    label={t(\"scenes.nodeSettings.fields.title.label\")}\r\n                    required\r\n                    error={!!errors.title}\r\n                    helperText={errors.title?.message}\r\n                    variant=\"outlined\"\r\n                    value={watch('title') || {}}\r\n                    onChange={value => setValue('title', value)}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item xs={3}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <TextField\r\n                    name=\"agency\"\r\n                    label={t(\"scenes.nodeSettings.fields.agency.label\")}\r\n                    required\r\n                    error={!!errors.agency}\r\n                    helperText={errors.agency?.message}\r\n                    variant=\"outlined\"\r\n                    value={watch('agency') || \"\"}\r\n                    onChange={({target}) => setValue('agency', target.value)}\r\n                  />\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FormControlLabel\r\n                label={\r\n                  <FormLabelWithTooltip\r\n                    tooltip= {t(\"scenes.nodeSettings.fields.active.tooltip\")}\r\n                    tooltipOnRight\r\n                  >\r\n                    {t(\"scenes.nodeSettings.fields.active.label\")}\r\n                  </FormLabelWithTooltip>\r\n                }\r\n                control={\r\n                  <Checkbox\r\n                    name=\"active\"\r\n                    required\r\n                    checked={watch('active')}\r\n                    onChange={(e, value) => setValue('active', value)}\r\n                  />\r\n                }\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nTextField\r\n                name=\"slogan\"\r\n                label={t(\"scenes.nodeSettings.fields.slogan.label\")}\r\n                variant=\"outlined\"\r\n                value={watch('slogan') || {}}\r\n                onChange={value => setValue('slogan', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.nodeSettings.fields.backgroundMediaURL.label\")}\r\n                value={watch('backgroundMediaURL')}\r\n                onChange={value => setValue('backgroundMediaURL', value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <FileInput\r\n                label={t(\"scenes.nodeSettings.fields.logo.label\")}\r\n                value={watch('logo')}\r\n                onChange={value => setValue('logo', value)}\r\n              />\r\n            </FormControl>\r\n          </Fragment>\r\n        </Box>\r\n        <Box style={tab !== \"infos\" ? {display: \"none\"} : undefined}>\r\n          <I18nHtmlEditor\r\n            value={watch('description')}\r\n            onChange={val => setValue('description', val)}\r\n          />\r\n        </Box>\r\n        <Box style={tab !== \"endpoint\" ? {display: \"none\"} : undefined}>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={12}>\r\n                <FormControl fullWidth>\r\n                  <TextField\r\n                    name=\"type\"\r\n                    select\r\n                    label={t(\"scenes.nodeSettings.fields.type.label\")}\r\n                    value=\"SDMX-REST\"\r\n                    variant=\"outlined\"\r\n                  >\r\n                    <MenuItem value=\"SDMX-REST\">SDMX-REST</MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n              <Grid item sm={12}>\r\n                <FormControl fullWidth>\r\n                  <TextField\r\n                    name=\"criteriaSelectionMode\"\r\n                    select\r\n                    label={\r\n                      <FormLabelWithTooltip\r\n                        tooltip={t(\"scenes.nodeSettings.fields.criteriaSelectionMode.tooltip\")}\r\n                      >\r\n                        {t(\"scenes.nodeSettings.fields.criteriaSelectionMode.label\")}\r\n                      </FormLabelWithTooltip>\r\n                    }\r\n                    variant=\"outlined\"\r\n                    onChange={e => setValue('criteriaSelectionMode', e.target.value)}\r\n                    value={watch(\"criteriaSelectionMode\") || ''}\r\n                    helperText={errors.criteriaSelectionMode?.message}\r\n                    error={!!errors.criteriaSelectionMode}\r\n                  >\r\n                    <MenuItem value={ALL_FULL}>ALL_FULL</MenuItem>\r\n                    <MenuItem value={ALL_PARTIAL}>ALL_PARTIAL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_FULL}>STEP_BY_STEP_FULL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_PARTIAL}>STEP_BY_STEP_PARTIAL</MenuItem>\r\n                    <MenuItem value={STEP_BY_STEP_DYNAMIC}>STEP_BY_STEP_DYNAMIC</MenuItem>\r\n                  </TextField>\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n          </Paper>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <FormControl fullWidth>\r\n              <TextField\r\n                name=\"endPoint\"\r\n                label={t(\"scenes.nodeSettings.fields.endPoint.label\")}\r\n                required\r\n                error={!!errors.endPoint}\r\n                helperText={errors.endPoint?.message}\r\n                variant=\"outlined\"\r\n                value={watch('endPoint') || \"\"}\r\n                onChange={({target}) => setValue('endPoint', target.value)}\r\n              />\r\n            </FormControl>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <TextField\r\n                select\r\n                label={t(\"scenes.nodeSettings.fields.responseFormat.label\")}\r\n                value={watch(\"restDataResponseXml\") || \"\"}\r\n                required\r\n                variant=\"outlined\"\r\n                error={!!errors.restDataResponseXml}\r\n                helperText={errors.restDataResponseXml?.message}\r\n                onChange={({target}) => setValue('restDataResponseXml', target.value)}\r\n              >\r\n                <MenuItem value=\"true\">XML</MenuItem>\r\n                <MenuItem value=\"false\">JSON</MenuItem>\r\n              </TextField>\r\n            </FormControl>\r\n          </Paper>\r\n          {/*<Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label=\"SOAP endpoint\"\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"optimizeCallWithSoap\"\r\n                      checked={watch('optimizeCallWithSoap')}\r\n                      onChange={(e, value) => setValue('optimizeCallWithSoap', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {optimizeCallWithSoap && (\r\n                <Fragment>\r\n                  <Grid item sm={8}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"namespaceV20\"\r\n                        label=\"Endpoint V20\"\r\n                        required\r\n                        inputRef={register({\r\n                          required: REQUIRED_MESSAGE\r\n                        })}\r\n                        error={!!errors.namespaceV20}\r\n                        helperText={errors.namespaceV20?.message}\r\n                        variant=\"outlined\"\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}></Grid>\r\n                  <Grid item sm={8}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"namespaceV21\"\r\n                        label=\"Endpoint V21\"\r\n                        required\r\n                        inputRef={register({\r\n                          required: REQUIRED_MESSAGE\r\n                        })}\r\n                        error={!!errors.namespaceV21}\r\n                        helperText={errors.namespaceV21?.message}\r\n                        variant=\"outlined\"\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>*/}\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label={t(\"scenes.nodeSettings.fields.enableHttpAuth.label\")}\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"enableHttpAuth\"\r\n                      checked={enableHttpAuth || false}\r\n                      onChange={(e, value) => setValue('enableHttpAuth', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {enableHttpAuth && (\r\n                <Fragment>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpUsername\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpUsername.label\")}\r\n                        required\r\n                        error={!!errors.authHttpUsername}\r\n                        helperText={errors.authHttpUsername?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpUsername') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpUsername', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpPassword\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpPassword.label\")}\r\n                        type=\"password\"\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpPassword') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpPassword', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}/>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"authHttpDomain\"\r\n                        label={t(\"scenes.nodeSettings.fields.authHttpDomain.label\")}\r\n                        variant=\"outlined\"\r\n                        value={watch('authHttpDomain') || \"\"}\r\n                        onChange={({target}) => setValue('authHttpDomain', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={3}>\r\n              <Grid item sm={4}>\r\n                <FormControlLabel\r\n                  label={t(\"scenes.nodeSettings.fields.enableProxy.label\")}\r\n                  control={\r\n                    <Checkbox\r\n                      name=\"enableProxy\"\r\n                      checked={enableProxy || false}\r\n                      onChange={(e, value) => setValue('enableProxy', value)}\r\n                    />\r\n                  }\r\n                />\r\n              </Grid>\r\n              {enableProxy && (\r\n                <Fragment>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyAddress\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyAddress.label\")}\r\n                        required\r\n                        error={!!errors.proxyAddress}\r\n                        helperText={errors.proxyAddress?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyAddress') || \"\"}\r\n                        onChange={({target}) => setValue('proxyAddress', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyPort\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyPort.label\")}\r\n                        required\r\n                        error={!!errors.proxyPort}\r\n                        helperText={errors.proxyPort?.message}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyPort') || \"\"}\r\n                        onChange={({target}) => setValue('proxyPort', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}/>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyUsername\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyUsername.label\")}\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyUsername') || \"\"}\r\n                        onChange={({target}) => setValue('proxyUsername', target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                  <Grid item sm={4}>\r\n                    <FormControl fullWidth>\r\n                      <TextField\r\n                        name=\"proxyPassword\"\r\n                        label={t(\"scenes.nodeSettings.fields.proxyPassword.label\")}\r\n                        type=\"password\"\r\n                        variant=\"outlined\"\r\n                        value={watch('proxyPassword') || \"\"}\r\n                        onChange={e => setValue('proxyPassword', e.target.value)}\r\n                      />\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Fragment>\r\n              )}\r\n            </Grid>\r\n          </Paper>\r\n        </Box>\r\n        <Box style={tab !== \"annotations\" ? {display: \"none\"} : undefined}>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER_CATEGORY\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER_CATEGORY.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER_CATEGORY') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER_CATEGORY', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ORDER_CODELIST\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ORDER_CODELIST.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ORDER_CODELIST') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ORDER_CODELIST', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.NOT_DISPLAYED\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.NOT_DISPLAYED.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.NOT_DISPLAYED') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.NOT_DISPLAYED', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DEFAULT\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DEFAULT.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DEFAULT') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DEFAULT', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_ROW\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_ROW.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_ROW') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_ROW', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_COLUMN\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_COLUMN.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_COLUMN') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_COLUMN', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_FILTER\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_FILTER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_FILTER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_FILTER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_ROW_SECTION\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_ROW_SECTION.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_ROW_SECTION') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_ROW_SECTION', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.CRITERIA_SELECTION\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.CRITERIA_SELECTION.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.CRITERIA_SELECTION') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.CRITERIA_SELECTION', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.ATTACHED_DATA_FILES\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.ATTACHED_DATA_FILES.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.ATTACHED_DATA_FILES') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.ATTACHED_DATA_FILES', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_DECIMAL_SEPARATOR\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_DECIMAL_SEPARATOR.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_DECIMAL_SEPARATOR') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_DECIMAL_SEPARATOR', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_NUMBER_OF_DECIMALS\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_NUMBER_OF_DECIMALS.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_NUMBER_OF_DECIMALS') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_NUMBER_OF_DECIMALS', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAYOUT_EMPTY_CELL_PLACEHOLDER.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAYOUT_EMPTY_CELL_PLACEHOLDER', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_NOTES\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_NOTES.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_NOTES') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_NOTES', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DATAFLOW_SOURCE\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DATAFLOW_SOURCE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DATAFLOW_SOURCE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DATAFLOW_SOURCE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.METADATA_URL\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.METADATA_URL.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.METADATA_URL') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.METADATA_URL', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.KEYWORDS\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.KEYWORDS.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.KEYWORDS') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.KEYWORDS', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.DEFAULT_VIEW\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.DEFAULT_VIEW.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.DEFAULT_VIEW') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.DEFAULT_VIEW', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.GEO_ID\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.GEO_ID.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.GEO_ID') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.GEO_ID', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.LAST_UPDATE\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.LAST_UPDATE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.LAST_UPDATE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.LAST_UPDATE', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"annotationConfig.VIRTUAL_DATAFLOW_NODE\"\r\n              label={<FormLabelWithTooltip>{t(\"scenes.nodeSettings.fields.annotations.VIRTUAL_DATAFLOW_NODE.label\")}</FormLabelWithTooltip>}\r\n              variant=\"outlined\"\r\n              value={watch('annotationConfig.VIRTUAL_DATAFLOW_NODE') || \"\"}\r\n              onChange={({target}) => setValue('annotationConfig.VIRTUAL_DATAFLOW_NODE', target.value)}\r\n            />\r\n          </FormControl>\r\n        </Box>\r\n        <Box style={tab !== \"cache\" ? {display: \"none\"} : undefined}>\r\n\r\n\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"ttlCatalog\"\r\n              variant=\"outlined\"\r\n              helperText={errors.ttlCatalog?.message}\r\n              label={\r\n                <FormLabelWithTooltip tooltip={t(\"scenes.nodeSettings.fields.catalogCacheValidity.tooltip\")}>\r\n                  {t(\"scenes.nodeSettings.fields.catalogCacheValidity.label\")}\r\n                </FormLabelWithTooltip>\r\n              }\r\n              error={!!errors.ttlCatalog}\r\n              value={watch('ttlCatalog') || \"\"}\r\n              onChange={({target}) => setValue('ttlCatalog', target.value)}\r\n            />\r\n          </FormControl>\r\n\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"ttlDataflow\"\r\n              variant=\"outlined\"\r\n              helperText={errors.ttlDataflow?.message}\r\n              label={\r\n                <FormLabelWithTooltip tooltip= {t(\"scenes.nodeSettings.fields.dataflowCacheValidity.tooltip\")}>\r\n                  {t(\"scenes.nodeSettings.fields.dataflowCacheValidity.label\")}\r\n                </FormLabelWithTooltip>\r\n              }\r\n              error={!!errors.ttlDataflow}\r\n              value={watch('ttlDataflow') || \"\"}\r\n              onChange={({target}) => setValue('ttlDataflow', target.value)}\r\n            />\r\n          </FormControl>\r\n\r\n\r\n        </Box>\r\n        <Box style={tab !== \"view\" ? {display: \"none\"} : undefined}>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <FormControlLabel\r\n              label={t(\"scenes.nodeSettings.fields.showDataflowUncategorized.label\")}\r\n              control={\r\n                <Checkbox\r\n                  name=\"showDataflowUncategorized\"\r\n                  required\r\n                  checked={watch('showDataflowUncategorized') || false}\r\n                  onChange={(e, value) => setValue('showDataflowUncategorized', value)}\r\n                />\r\n              }\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"showCategoryLevels\"\r\n              select\r\n              required\r\n              label={t(\"scenes.nodeSettings.fields.showCategoryLevels.label\")}\r\n              onChange={e => setValue('showCategoryLevels', e.target.value)}\r\n              value={watch(\"showCategoryLevels\") || ''}\r\n              error={!!errors.showCategoryLevels}\r\n              helperText={errors.showCategoryLevels?.message}\r\n              variant=\"outlined\"\r\n            >\r\n              <MenuItem value={1}>1</MenuItem>\r\n              <MenuItem value={5}>5</MenuItem>\r\n            </TextField>\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"decimalNumber\"\r\n              label={t(\"scenes.nodeSettings.fields.decimalNumber.label\")}\r\n              variant=\"outlined\"\r\n              required\r\n              type=\"number\"\r\n              error={!!errors.decimalNumber}\r\n              helperText={errors.decimalNumber?.message}\r\n              value={watch('decimalNumber') || ''}\r\n              onChange={({target}) => setValue('decimalNumber', target.value)}\r\n            />\r\n          </FormControl>\r\n          <FormControl fullWidth className={classes.field}>\r\n            <I18nTextField\r\n              name=\"decimalSeparator\"\r\n              select\r\n              required\r\n              label={t(\"scenes.nodeSettings.fields.decimalSeparator.label\")}\r\n              onChange={value => setValue('decimalSeparator', value)}\r\n              value={watch(\"decimalSeparator\") || ''}\r\n              helper={t(\"scenes.nodeSettings.fields.decimalSeparator.helper\")}\r\n              error={!!errors.decimalSeparator}\r\n              helperText={errors.decimalSeparator?.message}\r\n              variant=\"outlined\"\r\n            >\r\n              <MenuItem value=\".\">Dot</MenuItem>\r\n              <MenuItem value=\",\">Comma</MenuItem>\r\n            </I18nTextField>\r\n          </FormControl>\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('labelDimensionTerritorials') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('labelDimensionTerritorials', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.labelDimensionTerritorials.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.labelDimensionTerritorials.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('labelDimensionTemporals') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('labelDimensionTemporals', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.labelDimensionTemporals.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.labelDimensionTemporals.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('categorySchemaExcludes') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('categorySchemaExcludes', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.categorySchemaExcludes.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.categorySchemaExcludes.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              select\r\n              label={t(\"scenes.nodeSettings.fields.catalogNavigationMode.label\")}\r\n              onChange={e => setValue('catalogNavigationMode', e.target.value)}\r\n              value={watch(\"catalogNavigationMode\") || ''}\r\n              required\r\n              variant=\"outlined\"\r\n              error={!!errors.catalogNavigationMode}\r\n              helperText={errors.catalogNavigationMode?.message}\r\n            >\r\n              <MenuItem value=\"Card\">{t(\"scenes.nodeSettings.fields.catalogNavigationMode.values.card\")}</MenuItem>\r\n              <MenuItem value=\"List\">{t(\"scenes.nodeSettings.fields.catalogNavigationMode.values.list\")}</MenuItem>\r\n            </TextField>\r\n          </FormControl>\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            freeSolo\r\n            options={[]}\r\n            value={watch('hiddenAttributes') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip variant=\"outlined\" label={option} {...getTagProps({index})} />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('hiddenAttributes', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.hiddenAttributes.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.hiddenAttributes.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n          <FormControl fullWidth className={classes.field}>\r\n            <TextField\r\n              name=\"pageSize\"\r\n              label={t(\"scenes.nodeSettings.fields.pageSize.label\")}\r\n              variant=\"outlined\"\r\n              type=\"number\"\r\n              value={watch('pageSize') || \"\"}\r\n              onChange={({target}) => setValue('pageSize', Number(target.value))}\r\n            />\r\n          </FormControl>\r\n          <Autocomplete\r\n            multiple\r\n            variant=\"outlined\"\r\n            options={Object.keys(downloadFormats(t))}\r\n            getOptionLabel={option => downloadFormats(t)[option].label}\r\n            value={watch('downloadFormats') || []}\r\n            renderTags={(value, getTagProps) =>\r\n              value.map((option, index) => (\r\n                <Chip\r\n                  variant=\"outlined\"\r\n                  label={downloadFormats(t)[option].label}\r\n                  {...getTagProps({index})}\r\n                />\r\n              ))\r\n            }\r\n            onChange={(e, val) => setValue('downloadFormats', val)}\r\n            renderInput={params => (\r\n              <FormControl fullWidth className={classes.field}>\r\n                <TextField\r\n                  label={t(\"scenes.nodeSettings.fields.downloadFormats.label\")}\r\n                  {...params}\r\n                  variant=\"outlined\"\r\n                  placeholder={t(\"scenes.nodeSettings.fields.downloadFormats.placeholder\")}\r\n                />\r\n              </FormControl>\r\n            )}\r\n          />\r\n        </Box>\r\n      </div>\r\n    </Box>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodesConfig.node\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchNodesConfigNode(nodeId)),\r\n  sendConfigCreate: config => dispatch(sendNodesConfigNodeCreate(config)),\r\n  sendConfig: config => dispatch(sendNodesConfigNodeEdit(config)),\r\n  clearConfig: () => dispatch(clearNodesConfigNode())\r\n});\r\n\r\nconst NodeSettingsForm = ({config, nodeId, fetchConfig, sendConfigCreate, sendConfig, clearConfig}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(nodeId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, nodeId]);\r\n\r\n  return ((nodeId === null || config) && (\r\n    <Form\r\n      config={nodeId === null ? undefined : config}\r\n      ref={ref}\r\n      onSubmit={nodeId === null ? sendConfigCreate : sendConfig}\r\n      onCancel={clearConfig}\r\n    />\r\n  ));\r\n};\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(NodeSettingsForm);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    getClearNodeCatalogMemoryCacheUrl,\r\n    getDataflowsCacheListUrl,\r\n    getDataflowsCacheUpdateUrl,\r\n    getDataflowsClearAllCacheUrl,\r\n    getDataflowsClearCacheUrl,\r\n    getDataflowsCreateCacheUrl\r\n} from \"../../serverApi/urls\";\r\n\r\nexport const DATAFLOW_CACHE_FETCH = \"cache/fetch\";\r\nexport const DATAFLOW_CACHE_CLEAR = \"cache/clear\";\r\nexport const DATAFLOW_CACHE_UPDATE = \"cache/update\";\r\nexport const DATAFLOW_CACHE_CREATE = \"cache/create\";\r\nexport const DATAFLOW_CACHE_DELETE = \"cache/delete\";\r\nexport const DATAFLOW_CACHE_DELETE_ALL = \"cache/deleteAll\";\r\nexport const DATAFLOW_CACHE_DELETE_CATALOG = \"cache/deleteCatalog\";\r\n\r\n\r\nexport const fetchDataflowCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_FETCH,\r\n  getDataflowsCacheListUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.cacheSettings.messages.fetchDataflowCache.start\")\r\n  })\r\n);\r\n\r\nexport const updateDataflowCache = (nodeId: number, cacheId: string, ttl: number) => initRequest(\r\n  DATAFLOW_CACHE_UPDATE,\r\n  getDataflowsCacheUpdateUrl(nodeId, cacheId),\r\n  RequestMethod.PUT,\r\n  {ttl: ttl},\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.updateDataflowCache.start\")\r\n  }),\r\n  {\r\n    ttl: ttl,\r\n    nodeId: nodeId,\r\n    cacheId: cacheId\r\n  }\r\n);\r\n\r\nexport const createDataflowCache = (nodeId: number, data:any) => initRequest(\r\n    DATAFLOW_CACHE_CREATE,\r\n    getDataflowsCreateCacheUrl(nodeId),\r\n    RequestMethod.POST,\r\n    data,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.cacheSettings.messages.createDataflowCache.start\")\r\n    }),\r\n    {\r\n      oldData: data,\r\n    }\r\n);\r\n\r\nexport const deleteDataflowCache = (nodeId: number, cacheId: string) => initRequest(\r\n  DATAFLOW_CACHE_DELETE,\r\n  getDataflowsClearCacheUrl(nodeId, cacheId),\r\n  RequestMethod.POST,\r\n  {},\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteDataflowCache.start\")\r\n  }),\r\n  {\r\n    nodeId: nodeId,\r\n    cacheId: cacheId\r\n  }\r\n);\r\n\r\nexport const clearDataflowCache = () => ({\r\n  type: DATAFLOW_CACHE_CLEAR\r\n});\r\n\r\nexport const deleteAllDataflowCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_DELETE_ALL,\r\n  getDataflowsClearAllCacheUrl(nodeId),\r\n  RequestMethod.POST,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteAllDataflowCache.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n\r\nexport const deleteCatalogCache = (nodeId: number) => initRequest(\r\n  DATAFLOW_CACHE_DELETE_CATALOG,\r\n  getClearNodeCatalogMemoryCacheUrl(nodeId),\r\n  RequestMethod.POST,\r\n  undefined,\r\n  t => ({\r\n      onStart: t(\"scenes.nodesSettings.cacheSettings.messages.deleteCatalogCache.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);\r\n","import React, {forwardRef, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport CheckIcon from \"@material-ui/icons/Check\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport ArrowUpwardIcon from \"@material-ui/icons/ArrowUpward\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {\r\n  clearDataflowCache,\r\n  createDataflowCache,\r\n  deleteAllDataflowCache,\r\n  deleteCatalogCache,\r\n  deleteDataflowCache,\r\n  fetchDataflowCache,\r\n  updateDataflowCache\r\n} from \"../../../../state/cache/cacheActions\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport {Checkbox, withStyles, withTheme} from \"@material-ui/core\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\n\r\n\r\nconst tableIcons = {\r\n  Delete: forwardRef((props, ref) => <DeleteIcon {...props} ref={ref}/>),\r\n  Edit: forwardRef((props, ref) => <EditIcon {...props} ref={ref}/>),\r\n  Check: forwardRef((props, ref) => <CheckIcon {...props} ref={ref}/>),\r\n  Clear: forwardRef((props, ref) => <ClearIcon {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <ClearIcon {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpwardIcon {...props} ref={ref}/>),\r\n  Search: forwardRef((props, ref) => <SearchIcon {...props} ref={ref}/>),\r\n  Add: forwardRef((props, ref) => <AddIcon {...props} ref={ref}/>)\r\n};\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: 440\r\n  },\r\n  field: {\r\n    marginTop: theme.spacing(3)\r\n  },\r\n  paper: {\r\n    marginTop: theme.spacing(2),\r\n    padding: theme.spacing(3)\r\n  },\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 56px)\",\r\n    marginTop: 8,\r\n    padding: \"0 4px\"\r\n  },\r\n  title: {\r\n    fontSize: 16\r\n  }\r\n});\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.cacheConfig\r\n});\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchCache: nodeId => dispatch(fetchDataflowCache(nodeId)),\r\n  clearCache: () => dispatch(clearDataflowCache()),\r\n  updateCache: (nodeId, cacheId, ttl) => dispatch(updateDataflowCache(nodeId, cacheId, ttl)),\r\n  createCache: (nodeId, data) => dispatch(createDataflowCache(nodeId, data)),\r\n  deleteFromCache: (nodeId, cacheId) => dispatch(deleteDataflowCache(nodeId, cacheId)),\r\n  deleteAllFromCache: (nodeId) => dispatch(deleteAllDataflowCache(nodeId)),\r\n  deleteCatalogCache: (nodeId) => dispatch(deleteCatalogCache(nodeId))\r\n});\r\n\r\n\r\nconst SECONDS_PER_DAY = 86400;\r\nconst SECONDS_PER_HOUR = 3600;\r\n\r\n\r\n/**\r\n * Convert seconds to HH:MM:SS\r\n * If seconds exceeds 24 hours, hours will be greater than 24 (30:05:10)\r\n *\r\n * @param {number} seconds\r\n * @returns {string}\r\n */\r\nconst secondsToHms = (totalSeconds) => {\r\n\r\n  if (!totalSeconds) {\r\n    return \"0 s\";\r\n  }\r\n\r\n  var days = Math.floor(totalSeconds / SECONDS_PER_DAY);\r\n  var hours = Math.floor((totalSeconds - (days * SECONDS_PER_DAY)) / SECONDS_PER_HOUR);\r\n  var minutes = Math.floor((totalSeconds - (days * SECONDS_PER_DAY) - (hours * SECONDS_PER_HOUR)) / 60);\r\n  var seconds = totalSeconds - (days * SECONDS_PER_DAY) - (hours * SECONDS_PER_HOUR) - (minutes * 60);\r\n\r\n  // round seconds\r\n  seconds = Math.round(seconds * 100) / 100\r\n\r\n  return wellFormattedTimeString(days, hours, minutes, seconds);\r\n};\r\n\r\nconst wellFormattedTimeString = (days, hours, mins, sec) => {\r\n  var result = \"\";\r\n  result += (days > 0 ? days + \"d \" : \"\"); // hide days if 0\r\n  result += (hours < 10 ? \" \" + hours : hours) + \"h \";\r\n  result += (mins < 10 ? \" \" + mins : mins) + \"m \";\r\n\r\n  if (days === 0) { // truncate if days is greater than zero\r\n    result += (sec < 10 ? \" \" + sec : sec) + \"s\";\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nconst CacheSettingsForm = ({classes, config, nodeId, fetchCache, createCache, updateCache, clearCache, deleteFromCache, deleteAllFromCache, deleteCatalogCache}, ref) => {\r\n//const CacheSettingsForm = compose(withStyles(styles), forwardRef)(({classes, config, nodeId, fetchCache, updateCache, clearCache, deleteFromCache}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null && (!config || config.length === 0));\r\n  const [hideEmptyDataflowCache, setEmptyDataflowCacheHidden] = useState(true);\r\n  const [emptyRowsCounter, setEmptyRowsCounter] = useState(0);\r\n  const [rowsCounter, setRowsCounter] = useState(0);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (!config || config.length === 0) {\r\n      setRowsCounter(0);\r\n      setEmptyRowsCounter(0);\r\n      return;\r\n    }\r\n    setRowsCounter(config.length);\r\n    setEmptyRowsCounter(config.filter(val => val?.cacheSize === 0).length);\r\n  }, [config]);\r\n\r\n  useEffect(() => {\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchCache(nodeId);\r\n    }\r\n\r\n\r\n  }, [config, fetchCache, nodeId, needConfig, setNeedConfig]);\r\n  /*\r\n      const {register, errors, handleSubmit, watch, setValue} = useForm({\r\n          defaultValues: {\r\n              ...config\r\n          }\r\n      });\r\n  */\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      f();\r\n    },\r\n    cancel(f) {\r\n      clearCache();\r\n      f();\r\n    }\r\n  }));\r\n\r\n\r\n  return (\r\n\r\n    <Grid container>\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n\r\n            <Grid container spacing={2}>\r\n\r\n\r\n              <Grid item xs={4}>\r\n                <FormControl fullWidth>\r\n                  <Button container style={{marginRight: 24}} size=\"large\" variant=\"contained\"\r\n                          color=\"primary\" onClick={() => deleteCatalogCache(nodeId)}>\r\n                    {t(\"scenes.nodeSettings.cacheSettings.deleteCatalogCache\")}\r\n                  </Button>\r\n                </FormControl>\r\n              </Grid>\r\n              {/* <Grid item xs={4}>\r\n                                <FormControl fullWidth>\r\n                                    <Button size=\"large\" variant=\"contained\" color=\"primary\"\r\n                                            onClick={window.notImplemented.show}>\r\n                                        Refresh catalog cache\r\n                                    </Button>\r\n                                </FormControl>\r\n                            </Grid>\r\n                            <Grid item xs={4}/>*/}\r\n            </Grid>\r\n          </Paper>\r\n\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <Grid container spacing={2}>\r\n        <Grid item xs={12}>\r\n          <Paper variant=\"outlined\" className={classes.paper}>\r\n            <Grid container spacing={1}>\r\n              <Grid item xs={4}>\r\n                <FormControl fullWidth>\r\n                  <Button container style={{marginRight: 24}} size=\"large\" variant=\"contained\"\r\n                          color=\"primary\" onClick={() => deleteAllFromCache(nodeId)}>\r\n                    {t(\"scenes.nodeSettings.cacheSettings.deleteAllDataflowCache\")}\r\n                  </Button>\r\n                </FormControl>\r\n              </Grid>\r\n              {/*<Grid item xs={4} >*/}\r\n              {/*    <FormControl fullWidth>*/}\r\n              {/*        <Button disabled size=\"large\" variant=\"contained\" color=\"primary\"*/}\r\n              {/*                onClick={window.notImplemented.show}>*/}\r\n              {/*            Refresh dataflow cache*/}\r\n              {/*        </Button>*/}\r\n              {/*    </FormControl>*/}\r\n              {/*</Grid>*/}\r\n              <Grid item xs={4}/>\r\n              <Grid item xs={4}/>\r\n              <Grid item xs={12}>\r\n                <FormControl fullWidth className={classes.field}>\r\n                  <FormControlLabel\r\n                    label={t(\"scenes.nodeSettings.cacheSettings.hideEmptyEntries\")}\r\n                    control={\r\n                      <Checkbox\r\n                        name=\"active\"\r\n                        required\r\n                        disabled={emptyRowsCounter === 0 || rowsCounter === 0}\r\n                        checked={hideEmptyDataflowCache}\r\n                        onChange={(e, value) => setEmptyDataflowCacheHidden(value)}\r\n                      />\r\n                    }\r\n                  />\r\n                  {/*<FormHelperText>*/}\r\n                  {/*    { (!hideEmptyDataflowCache? \"Hide\" : \"Show\") + \" cache entries which size is 0 Kb.\" }*/}\r\n                  {/*</FormHelperText>*/}\r\n                </FormControl>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid item xs={12}>\r\n              <CustomMaterialTable\r\n                components={{\r\n                  Container: Box\r\n                }}\r\n                icons={tableIcons}\r\n                columns={[\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowTitle\"),\r\n                    field: \"title\",\r\n                    editable: 'never'\r\n                  },\r\n                  /*{title: \"Title\", field: \"dataflowId\", editable: 'never'},*/\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowValidity\"),\r\n                    field: \"ttl\",\r\n                    type: \"numeric\",\r\n                    editable: 'onUpdate',\r\n                    render: rowData => secondsToHms(rowData.ttl)\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowFiles\"),\r\n                    field: \"cachedDataflow\",\r\n                    type: \"numeric\",\r\n                    editable: 'never'\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowSize\"),\r\n                    field: \"cacheSize\",\r\n                    type: \"numeric\",\r\n                    editable: 'never',\r\n                    render: rowData => rowData.cacheSize + \" Kb\"\r\n                  },\r\n                  {\r\n                    title: t(\"scenes.nodeSettings.cacheSettings.table.dataflowAccess\"),\r\n                    field: \"cachedDataAccess\",\r\n                    type: \"numeric\",\r\n                    editable: 'never'\r\n                  }\r\n\r\n                ]}\r\n                data={config?.filter(val => !hideEmptyDataflowCache || val.cacheSize > 0) || []}\r\n                editable={{\r\n                  onRowUpdate: (newData, oldData) =>\r\n                    new Promise((resolve, reject) => {\r\n                      if (newData.ttl < 0) { // invalid ttl\r\n                        reject();\r\n                        return;\r\n                      }\r\n\r\n                      if (newData.ttl === oldData.ttl) { //no update is needed here\r\n                        resolve();\r\n                        return;\r\n                      }\r\n\r\n                      const dataUpdate = [...config];\r\n                      const index = oldData.tableData.id;\r\n                      dataUpdate[index] = newData;\r\n\r\n                      if (!newData.id || newData.id === '00000000-0000-0000-0000-000000000000') {\r\n                        createCache(nodeId, newData);\r\n                      } else {\r\n                        updateCache(nodeId, newData.id, newData.ttl)\r\n                      }\r\n\r\n\r\n                      // config([...dataUpdate]);\r\n\r\n                      resolve();\r\n                    }),\r\n                  onRowDelete: oldData =>\r\n                    new Promise((resolve, reject) => {\r\n                      const dataDelete = [...config];\r\n                      const index = oldData.tableData.id;\r\n                      dataDelete.splice(index, 1);\r\n\r\n                      //data does not exists. no need to make a server call\r\n                      if (!oldData.id || oldData.id === '00000000-0000-0000-0000-000000000000') {\r\n                        resolve();\r\n                        return;\r\n                      }\r\n\r\n                      deleteFromCache(nodeId, oldData.id)\r\n                      //setCacheConfig([...dataDelete]);\r\n\r\n                      resolve();\r\n                    }),\r\n                }}\r\n                /*actions={[\r\n                  {\r\n                    icon: EditIcon,\r\n                    tooltip: 'Edit node',\r\n                    onClick: (_, {id}) => {window.notImplemented.show();}\r\n                  },\r\n                  {\r\n                    icon: DeleteIcon,\r\n                    tooltip: 'Delete node',\r\n                    onClick: (_, {id}) => {window.notImplemented.show();}\r\n                  }]}\r\n                 */\r\n                options={{\r\n                  paging: false,\r\n                  draggable: true,\r\n                  actionsColumnIndex: -1,\r\n                  searchFieldAlignment: \"left\",\r\n                  //maxBodyHeight: 400,\r\n                  showTitle: false\r\n                }}\r\n                localization={{\r\n                  body: {\r\n                    editRow: {\r\n                      deleteText: t(\"scenes.nodesSettings.cacheSettings.modals.deleteDataflowCache.title\")\r\n                    },\r\n                    editTooltip: t(\"scenes.nodeSettings.cacheSettings.table.actions.editRow\"),\r\n                    deleteTooltip: t(\"scenes.nodeSettings.cacheSettings.table.actions.deleteRow\")\r\n                  }\r\n                }}\r\n              />\r\n            </Grid>\r\n\r\n          </Paper>\r\n\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n\r\n\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), withTheme, compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}),\r\n  forwardRef))(CacheSettingsForm);\r\n","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getDeleteTemplateUrl, getNodeTemplatesUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_TEMPLATES_CONFIG_FETCH = \"nodeTemplatesConfig/fetch\";\r\nexport const NODE_TEMPLATES_CONFIG_CLEAR = \"nodeTemplatesConfig/clear\";\r\nexport const NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE = \"nodeTemplatesConfig/deleteTemplate\";\r\n\r\nexport const fetchNodeTemplatesConfig = (nodeId: number) => initRequest(\r\n  NODE_TEMPLATES_CONFIG_FETCH,\r\n  getNodeTemplatesUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.templatesSettings.fetchConfig.start\")\r\n  })\r\n);\r\n\r\nexport const clearNodeTemplatesConfig = () => ({\r\n  type: NODE_TEMPLATES_CONFIG_CLEAR\r\n});\r\n\r\nexport const deleteNodeTemplatesConfigTemplate = (nodeId: number, id: number) => initRequest(\r\n  NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE,\r\n  getDeleteTemplateUrl(nodeId, id),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.nodesSettings.templatesSettings.deleteTemplate.start\")\r\n  }),\r\n  {\r\n    nodeId\r\n  }\r\n);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {Visibility} from \"@material-ui/icons\";\r\nimport {\r\n  clearNodeTemplatesConfig,\r\n  deleteNodeTemplatesConfigTemplate,\r\n  fetchNodeTemplatesConfig\r\n} from \"../../../../state/noteTemplatesConfig/nodeTemplatesConfigActions\";\r\nimport {goToData} from \"../../../../links\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  templates: state.nodeTemplatesConfig.templates\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchTemplates: nodeId => dispatch(fetchNodeTemplatesConfig(nodeId)),\r\n  deleteTemplate: (nodeId, id) => dispatch(deleteNodeTemplatesConfigTemplate(nodeId, id)),\r\n  clearTemplates: () => dispatch(clearNodeTemplatesConfig())\r\n});\r\n\r\nconst TemplatesSettingsForm = ({classes, defaultLanguage, languages, nodes, nodeId, defaultNodeOpen, templates, fetchTemplates, deleteTemplate, clearTemplates}, ref) => {\r\n\r\n  const [needTemplates, setNeedTemplates] = useState(true);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needTemplates) {\r\n      setNeedTemplates(false);\r\n      fetchTemplates(nodeId);\r\n    }\r\n  }, [templates, needTemplates, setNeedTemplates, fetchTemplates, nodeId]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearTemplates();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [deleteTemplateId, setDeleteTemplateId] = useState(null);\r\n\r\n  return templates && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"datasetId\",\r\n            title: t(\"scenes.nodeSettings.templatesSettings.table.columns.datasetId\")\r\n          },\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.nodeSettings.templatesSettings.table.columns.templateName\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          }\r\n        ]}\r\n        data={templates}\r\n        actions={[\r\n          ({\r\n            icon: Visibility,\r\n            tooltip: t(\"scenes.nodeSettings.templatesSettings.table.actions.viewData\"),\r\n            onClick: (_, {nodeId, datasetId}) => goToData(nodes.find(node => node.nodeId === nodeId).code, [], datasetId)\r\n          }),\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.nodeSettings.templatesSettings.table.actions.deleteTemplate\"),\r\n            onClick: (_, {viewTemplateId}) => setDeleteTemplateId(viewTemplateId)\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 3,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteTemplateId !== null}\r\n      >\r\n        <DialogTitle> {t(\"scenes.nodeSettings.templatesSettings.modals.deleteTemplate.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.nodeSettings.templatesSettings.modals.deleteTemplate.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setDeleteTemplateId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteTemplate(nodeId, deleteTemplateId);\r\n            setDeleteTemplateId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(TemplatesSettingsForm);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearNodePermissionsConfig,\r\n  fetchNodePermissionsConfig,\r\n  sendNodePermissionsConfig\r\n} from \"../../../../state/nodePermissionsConfig/nodePermissionsConfigActions\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport {useForm} from \"react-hook-form\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../../custom-material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst PERMISSIONS = [\r\n  \"ManageCache\",\r\n  \"ManageTemplate\",\r\n  \"ManageConfig\"\r\n];\r\n\r\nconst Form = compose(withStyles(styles), forwardRef)(({classes, config, nodeId, onSubmit, onCancel}, ref) => {\r\n\r\n  const {register, handleSubmit, watch, setValue} = useForm({\r\n    defaultValues: {\r\n      config: config?.map((user, index) => {\r\n        let res = {...user};\r\n        PERMISSIONS.forEach(p => {\r\n          res[p] = config[index].permission.includes(`${p}_SingleNode_${nodeId}`) === true;\r\n        });\r\n        return res;\r\n      })\r\n    }\r\n  });\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    if (config) {\r\n      config.forEach((user, index) =>\r\n        PERMISSIONS.forEach(p =>\r\n          register({name: `config[${index}].${p}`})))\r\n    }\r\n  }, [register, config]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit(f) {\r\n      handleSubmit(val => {\r\n\r\n        const data = val.config.map((userVal, index) => {\r\n          let res = {\r\n            userId: config[index].userId,\r\n            nodePermissions: []\r\n          };\r\n          PERMISSIONS.forEach(p => {\r\n            if (userVal[p] === true) {\r\n              res.nodePermissions.push(p);\r\n            }\r\n          });\r\n          res.tableData = undefined;\r\n          return res;\r\n        });\r\n\r\n        onSubmit(nodeId, data);\r\n        f(data);\r\n      })();\r\n    },\r\n    cancel(f) {\r\n      onCancel();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  return config && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"firstName\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userFirstName\")\r\n          },\r\n          {\r\n            field: \"lastName\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userLastName\")\r\n          },\r\n          {\r\n            field: \"organization\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userOrganization\")\r\n          },\r\n          {\r\n            field: \"email\",\r\n            title: t(\"scenes.nodeSettings.permissions.table.columns.userEmail\")\r\n          },\r\n          ...PERMISSIONS.map(p => ({\r\n            title: p,\r\n            render: ({tableData}) =>\r\n              <Grid container justify=\"center\">\r\n                <Grid item>\r\n                  <Checkbox\r\n                    checked={watch(`config[${tableData.id}].${p}`)}\r\n                    onChange={(ev, value) => setValue(`config[${tableData.id}].${p}`, value)}\r\n                  />\r\n                </Grid>\r\n              </Grid>\r\n          }))\r\n        ]}\r\n        data={config}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          searchFieldAlignment: \"left\",\r\n          maxBodyHeight: 400,\r\n          showTitle: false\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n    </Fragment>\r\n  );\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodePermissionsConfig.permissions\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: nodeId => dispatch(fetchNodePermissionsConfig(nodeId)),\r\n  sendConfig: (nodeId, config) => dispatch(sendNodePermissionsConfig(nodeId, config)),\r\n  clearConfig: () => dispatch(clearNodePermissionsConfig())\r\n});\r\n\r\nconst PermissionsSettingsForm = ({config, nodeId, fetchConfig, sendConfig, clearConfig}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(nodeId !== null);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig(nodeId);\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig, nodeId]);\r\n\r\n  return ((nodeId === null || config) && (\r\n    <Form\r\n      nodeId={nodeId}\r\n      config={nodeId === null ? undefined : config}\r\n      ref={ref}\r\n      onSubmit={sendConfig}\r\n      onCancel={clearConfig}\r\n    />\r\n  ));\r\n};\r\n\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(PermissionsSettingsForm);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getNodePermissionsConfigGetUrl, getNodePermissionsConfigPutUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_PERMISSIONS_CONFIG_FETCH = \"nodePermissionsConfig/fetch\";\r\nexport const NODE_PERMISSIONS_CONFIG_CLEAR = \"nodePermissionsConfig/clear\";\r\nexport const NODE_PERMISSIONS_CONFIG_SEND = \"nodePermissionsConfig/send\";\r\n\r\nexport const fetchNodePermissionsConfig = (nodeId: number) => initRequest(\r\n    NODE_PERMISSIONS_CONFIG_FETCH,\r\n    getNodePermissionsConfigGetUrl(nodeId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.permissionsSettings.fetchConfig.start\")\r\n    })\r\n);\r\n\r\nexport const sendNodePermissionsConfig = (nodeId: number, config: any) => initRequest(\r\n    NODE_PERMISSIONS_CONFIG_SEND,\r\n    getNodePermissionsConfigPutUrl(nodeId),\r\n    RequestMethod.PUT,\r\n    config,\r\n    t => ({\r\n        onStart: t(\"scenes.nodesSettings.permissionsSettings.sendConfig.start\")\r\n    })\r\n);\r\n\r\nexport const clearNodePermissionsConfig = () => ({\r\n    type: NODE_PERMISSIONS_CONFIG_CLEAR\r\n});\r\n","import React, {forwardRef} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport DashboardsManager from \"../../../dashboards-manager\";\r\nimport {\r\n  addNodesConfigDashboardsNodeDashboard,\r\n  clearAllNodesConfigNodeDashboards,\r\n  clearNodesConfigNodeDashboards,\r\n  fetchAllNodeConfigDashboards,\r\n  fetchNodesConfigNodeDashboards,\r\n  removeNodesConfigDashboardsNodeDashboard,\r\n  sendNodesConfigDashboardsNodeOrders\r\n} from \"../../../../state/nodesConfig/nodesConfigActions\";\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.hubConfig.hub,\r\n  user: state.user,\r\n  dashboards: state.nodesConfig.nodeDashboards,\r\n  allDashboards: state.nodesConfig.allDashboards\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboards: nodeId => dispatch(fetchNodesConfigNodeDashboards(nodeId)),\r\n  fetchAllDashboards: () => dispatch(fetchAllNodeConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearNodesConfigNodeDashboards()),\r\n  clearAllDashboards: () => dispatch(clearAllNodesConfigNodeDashboards()),\r\n  addDashboard: (nodeId, dashboardId) => dispatch(addNodesConfigDashboardsNodeDashboard(nodeId, dashboardId)),\r\n  removeDashboard: (nodeId, dashboardId) => dispatch(removeNodesConfigDashboardsNodeDashboard(nodeId, dashboardId)),\r\n  sendDashboardsOrders: (nodeId, dashboardsIds) => dispatch(sendNodesConfigDashboardsNodeOrders(nodeId, dashboardsIds))\r\n});\r\n\r\nconst DashboardsSettingsForm = ({\r\n                                  dashboards,\r\n                                  allDashboards,\r\n                                  fetchDashboards,\r\n                                  fetchAllDashboards,\r\n                                  clearDashboards,\r\n                                  clearAllDashboards,\r\n                                  addDashboard,\r\n                                  removeDashboard,\r\n                                  sendDashboardsOrders,\r\n                                  nodeId\r\n                                }, ref) =>\r\n  <DashboardsManager\r\n    dashboards={dashboards}\r\n    allDashboards={allDashboards}\r\n    fetchDashboards={() => fetchDashboards(nodeId)}\r\n    fetchAllDashboards={fetchAllDashboards}\r\n    clearDashboards={clearDashboards}\r\n    clearAllDashboards={clearAllDashboards}\r\n    addDashboard={dashboardId => addDashboard(nodeId, dashboardId)}\r\n    removeDashboard={dashboardId => removeDashboard(nodeId, dashboardId)}\r\n    sendDashboardsOrders={dashboardsIds => sendDashboardsOrders(nodeId, dashboardsIds)}\r\n    ref={ref}\r\n  />;\r\n\r\nexport default compose(connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(DashboardsSettingsForm);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useRef, useState} from 'react';\r\nimport NodeSettingsForm from \"./node-settings-form\";\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport SettingsDialog from \"../../settings-dialog\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {\r\n  clearNodesConfigNodes,\r\n  closeNodesConfig,\r\n  deleteNodesConfigNode,\r\n  fetchNodesConfigNodes,\r\n  sendNodesConfigNodesOrder\r\n} from \"../../../state/nodesConfig/nodesConfigActions\";\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {compose} from \"redux\";\r\nimport CacheSettingsForm from \"./cache-setting-form/index\";\r\nimport TemplatesSettingsForm from \"./templates-settings-form\";\r\nimport {\r\n  canCreateNode,\r\n  canDeleteNodes,\r\n  canDisplayCacheSettingForm,\r\n  canDisplayPermissionsSettingsForm,\r\n  canDisplayTemplatesSettingsForm,\r\n  canEditNode,\r\n  canManageNodeDashboards,\r\n  canSortNodes\r\n} from \"../../../utils/user\";\r\nimport PermissionsSettingsForm from \"./permissions-settings-form\";\r\nimport PersonIcon from '@material-ui/icons/Person';\r\nimport DashboardIcon from \"@material-ui/icons/Dashboard\";\r\nimport DashboardsSettingsForm from \"./dashboards-settings-form\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../utils/i18n\";\r\nimport \"./style.css\";\r\nimport {MTableToolbar} from \"material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.nodesConfig.nodes,\r\n  user: state.user,\r\n  language: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: () => dispatch(fetchNodesConfigNodes()),\r\n  sendOrders: orderedIds => dispatch(sendNodesConfigNodesOrder(orderedIds)),\r\n  deleteNode: nodeId => dispatch(deleteNodesConfigNode(nodeId)),\r\n  clearConfig: () => dispatch(clearNodesConfigNodes()),\r\n  onClose: () => dispatch(closeNodesConfig())\r\n});\r\n\r\nconst NodesSettingsForm = ({classes, defaultNodeOpen, config, fetchConfig, sendOrders, deleteNode, clearConfig, nodes, user, onClose, language, languages}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearConfig();\r\n      onClose();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [isNodeFormVisible, setNodeFormVisibility] = useState(defaultNodeOpen || false);\r\n  const [nodeFormNodeId, setNodeFormNodeId] = useState(null);\r\n  const [nodeDeleteFormNodeId, setNodeDeleteFormNodeId] = useState(null);\r\n  const [cacheFormNodeId, setCacheFormNodeId] = useState(null);\r\n  const [isCacheFormVisible, setCacheFormVisibility] = useState(false);\r\n  const [templatesNodeId, setTemplatesNodeId] = useState(null);\r\n  const [permissionsNodeId, setPermissionsNodeId] = useState(null);\r\n  const [dashboardsNodeId, setDashboardsNodeId] = useState(null);\r\n\r\n  const nodeFormRef = useRef();\r\n  const cacheFormRef = useRef();\r\n  const templatesRef = useRef();\r\n  const permissionsRef = useRef();\r\n  const dashboardsRef = useRef();\r\n\r\n  const allowedNodes = (config || []).filter(({nodeId}) =>\r\n    canCreateNode(user) ||\r\n    canSortNodes(user) ||\r\n    canDisplayCacheSettingForm(user, nodeId) ||\r\n    canDisplayTemplatesSettingsForm(user, nodeId) ||\r\n    canDisplayPermissionsSettingsForm(user) ||\r\n    canEditNode(user, nodeId) ||\r\n    canDeleteNodes(user)\r\n  );\r\n  const orderedNodes = (allowedNodes || []).sort((a, b) => a.order - b.order)\r\n  const orderedNodesIds = orderedNodes.map(({nodeId}) => nodeId);\r\n\r\n  const moveUp = rowIndex =>\r\n    sendOrders([\r\n      ...orderedNodesIds.slice(0, rowIndex - 1),\r\n      orderedNodesIds[rowIndex],\r\n      orderedNodesIds[rowIndex - 1],\r\n      ...orderedNodesIds.slice(rowIndex + 1)\r\n    ]);\r\n\r\n  const moveDown = rowIndex =>\r\n    sendOrders([\r\n      ...orderedNodesIds.slice(0, rowIndex),\r\n      orderedNodesIds[rowIndex + 1],\r\n      orderedNodesIds[rowIndex],\r\n      ...orderedNodesIds.slice(rowIndex + 2)\r\n    ]);\r\n\r\n  return config && (\r\n    <Fragment>\r\n      <Box className=\"nodes-settings-form__table\">\r\n        <CustomMaterialTable\r\n          components={{\r\n            Container: Box,\r\n            Toolbar: props =>\r\n              <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n                <Grid item>\r\n                  <MTableToolbar {...props} />\r\n                </Grid>\r\n                {canCreateNode(user) && (\r\n                  <Grid item>\r\n                    <Button\r\n                      size=\"small\"\r\n                      startIcon={<AddIcon/>}\r\n                      onClick={() => {\r\n                        setNodeFormNodeId(null);\r\n                        setNodeFormVisibility(true);\r\n                        setCacheFormVisibility(false);\r\n                      }}>\r\n                      {t(\"scenes.nodesSettings.createNode\")}\r\n                    </Button>\r\n                  </Grid>\r\n                )}\r\n              </Grid>\r\n          }}\r\n          columns={[\r\n            {\r\n              field: \"code\",\r\n              title: t(\"scenes.nodesSettings.table.columns.nodeCode\")\r\n            },\r\n            {\r\n              field: \"title\",\r\n              title: t(\"scenes.nodesSettings.table.columns.nodeName\"),\r\n              render: ({title}) => localizeI18nObj(title, language, languages),\r\n              customFilterAndSearch: getI18nObjCustomFilterAndSearch(language, languages)\r\n            },\r\n            {\r\n              field: \"active\",\r\n              title: t(\"scenes.nodesSettings.table.columns.isNodeActive.title\"),\r\n              render: ({active}) =>\r\n                active\r\n                  ? t(\"scenes.nodesSettings.table.columns.isNodeActive.values.true\")\r\n                  : t(\"scenes.nodesSettings.table.columns.isNodeActive.values.false\")\r\n            }\r\n          ]}\r\n          data={orderedNodes}\r\n          actions={[\r\n            ({tableData}) =>\r\n              canSortNodes(user)\r\n                ? {\r\n                  icon: ArrowDropUpIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeOrderMoveUp\"),\r\n                  onClick: (_, {tableData}) => moveUp(tableData.id), // tableData.id is the rowIndex\r\n                  disabled: tableData.id === 0\r\n                }\r\n                : null,\r\n            ({tableData}) =>\r\n              canSortNodes(user)\r\n                ? {\r\n                  icon: ArrowDropDownIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeOrderMoveDown\"),\r\n                  onClick: (_, {tableData}) => moveDown(tableData.id), // tableData.id is the rowIndex\r\n                  disabled: tableData.id === config.length - 1\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canDisplayCacheSettingForm(user, nodeId)\r\n                ? {\r\n                  icon: () =>\r\n                    <div className={classes.buttonAction}>\r\n                      {t(\"scenes.nodesSettings.table.actions.nodeDataflowsCache.label\")}\r\n                    </div>,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeDataflowsCache.tooltip\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setCacheFormNodeId(nodeId);\r\n                    setNodeFormVisibility(false);\r\n                    setCacheFormVisibility(true);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canDisplayTemplatesSettingsForm(user, nodeId)\r\n                ? {\r\n                  icon: () =>\r\n                    <div className={classes.buttonAction}>\r\n                      {t(\"scenes.nodesSettings.table.actions.nodeTemplates.label\")}\r\n                    </div>,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeTemplates.tooltip\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setTemplatesNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            () =>\r\n              canDisplayPermissionsSettingsForm(user)\r\n                ? {\r\n                  icon: PersonIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodePermissions\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setPermissionsNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canManageNodeDashboards(user, nodeId)\r\n                ? {\r\n                  icon: DashboardIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.nodeDashboards\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setDashboardsNodeId(nodeId);\r\n                  }\r\n                }\r\n                : null,\r\n            ({nodeId}) =>\r\n              canEditNode(user, nodeId)\r\n                ? {\r\n                  icon: EditIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.editNode\"),\r\n                  onClick: (_, {nodeId}) => {\r\n                    setNodeFormNodeId(nodeId);\r\n                    setNodeFormVisibility(true);\r\n                    setCacheFormVisibility(false);\r\n                  }\r\n                }\r\n                : null,\r\n            () =>\r\n              canDeleteNodes(user)\r\n                ? {\r\n                  icon: DeleteIcon,\r\n                  tooltip: t(\"scenes.nodesSettings.table.actions.deleteNode\"),\r\n                  onClick: (_, {nodeId}) => setNodeDeleteFormNodeId(nodeId)\r\n                }\r\n                : null\r\n          ]}\r\n          options={{\r\n            paging: false,\r\n            draggable: true,\r\n            actionsColumnIndex: 3,\r\n            searchFieldAlignment: \"left\",\r\n            maxBodyHeight: 400,\r\n            showTitle: false\r\n          }}\r\n          icons={tableIcons}\r\n        />\r\n      </Box>\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.editNode\")}\r\n        open={isNodeFormVisible}\r\n        onClose={() => {\r\n          if (nodeFormRef.current) {\r\n            nodeFormRef.current.cancel(() => {\r\n              setNodeFormVisibility(false);\r\n              setNodeFormNodeId(null);\r\n            });\r\n          } else {\r\n            setNodeFormVisibility(false);\r\n            setNodeFormNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (nodeFormRef.current) {\r\n            nodeFormRef.current.submit(() => {\r\n              setNodeFormVisibility(false);\r\n              setNodeFormNodeId(null);\r\n            });\r\n          } else {\r\n            setNodeFormVisibility(false);\r\n            setNodeFormNodeId(null);\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <NodeSettingsForm ref={nodeFormRef} nodeId={nodeFormNodeId}/>\r\n\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeCache\", {nodeCode: config.find(node => node.nodeId === cacheFormNodeId)?.code})}\r\n        open={isCacheFormVisible}\r\n        onClose={() => {\r\n          if (cacheFormRef.current) {\r\n            cacheFormRef.current.cancel(() => {\r\n              setCacheFormVisibility(false);\r\n              setCacheFormNodeId(null);\r\n            });\r\n          } else {\r\n            setCacheFormVisibility(false);\r\n            setCacheFormNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (cacheFormRef.current) {\r\n            cacheFormRef.current.submit(() => {\r\n              setCacheFormVisibility(false);\r\n              setCacheFormNodeId(null);\r\n            });\r\n          } else {\r\n            setCacheFormVisibility(false);\r\n            setCacheFormNodeId(null);\r\n          }\r\n        }}\r\n        false\r\n      >\r\n        <CacheSettingsForm ref={cacheFormRef} nodeId={cacheFormNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeTemplates\", {nodeCode: config.find(node => node.nodeId === templatesNodeId)?.code})}\r\n        open={templatesNodeId !== null}\r\n        onClose={() => {\r\n          if (templatesRef.current) {\r\n            templatesRef.current.cancel(() => setTemplatesNodeId(null));\r\n          } else {\r\n            setTemplatesNodeId(null);\r\n          }\r\n        }}\r\n        maxWidth=\"md\"\r\n      >\r\n        <TemplatesSettingsForm ref={templatesRef} nodeId={templatesNodeId} nodes={config}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodePermissions\", {nodeCode: config.find(node => node.nodeId === permissionsNodeId)?.code})}\r\n        open={permissionsNodeId !== null}\r\n        onClose={() => {\r\n          if (permissionsRef.current) {\r\n            permissionsRef.current.cancel(() => {\r\n              setPermissionsNodeId(null);\r\n            });\r\n          } else {\r\n            setPermissionsNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (permissionsRef.current) {\r\n            permissionsRef.current.submit(() => {\r\n              setPermissionsNodeId(null);\r\n            });\r\n          } else {\r\n            setPermissionsNodeId(null);\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <PermissionsSettingsForm ref={permissionsRef} nodeId={permissionsNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <SettingsDialog\r\n        title={t(\"scenes.nodesSettings.modals.nodeDashboards\", {nodeCode: config.find(node => node.nodeId === dashboardsNodeId)?.code})}\r\n        open={dashboardsNodeId !== null}\r\n        onClose={() => {\r\n          if (dashboardsRef.current) {\r\n            dashboardsRef.current.destroy(() => {\r\n              setDashboardsNodeId(null);\r\n            });\r\n          } else {\r\n            setDashboardsNodeId(null);\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (dashboardsRef.current) {\r\n            dashboardsRef.current.destroy(() => {\r\n              setDashboardsNodeId(null);\r\n            });\r\n          } else {\r\n            setDashboardsNodeId(null);\r\n          }\r\n        }}\r\n      >\r\n        <DashboardsSettingsForm ref={dashboardsRef} nodeId={dashboardsNodeId}/>\r\n      </SettingsDialog>\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={nodeDeleteFormNodeId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.nodesSettings.modals.nodeDelete.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.nodesSettings.modals.nodeDelete.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setNodeDeleteFormNodeId(null);\r\n            setCacheFormNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteNode(nodeDeleteFormNodeId);\r\n            setNodeDeleteFormNodeId(null);\r\n            setCacheFormNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(NodesSettingsForm);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useRef, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport SettingsDialog from \"../../settings-dialog\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {compose} from \"redux\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport UserSettingsForm from \"./user-settings-form\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  clearUsersConfigUsers,\r\n  deleteUsersConfigUser,\r\n  fetchUsersConfigUsers,\r\n  hideUserConfigForm,\r\n  showUserConfigForm\r\n} from \"../../../state/usersConfig/usersConfigActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {MTableToolbar} from \"material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  buttonAction: {\r\n    ...theme.typography.button\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  config: state.usersConfig.users,\r\n  userErrors: state.usersConfig.userErrors,\r\n  userId: state.usersConfig.userId\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchConfig: () => dispatch(fetchUsersConfigUsers()),\r\n  deleteUser: userId => dispatch(deleteUsersConfigUser(userId)),\r\n  clearConfig: () => dispatch(clearUsersConfigUsers()),\r\n  onUserFormShow: userId => dispatch(showUserConfigForm(userId)),\r\n  onUserFormHide: () => dispatch(hideUserConfigForm())\r\n});\r\n\r\nconst UsersSettingsForm = ({classes, config, fetchConfig, deleteUser, clearConfig, users, userErrors, userId, onUserFormShow, onUserFormHide}, ref) => {\r\n\r\n  const [needConfig, setNeedConfig] = useState(true);\r\n\r\n  useEffect(() => {\r\n\r\n    if (needConfig) {\r\n      setNeedConfig(false);\r\n      fetchConfig();\r\n    }\r\n  }, [config, needConfig, setNeedConfig, fetchConfig]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearConfig();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [userDeleteFormUserId, setUserDeleteFormUserId] = useState(null);\r\n\r\n  const userFormRef = useRef();\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return config && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n          Toolbar: props =>\r\n            <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n              <Grid item>\r\n                <MTableToolbar {...props} />\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  size=\"small\"\r\n                  startIcon={<AddIcon/>}\r\n                  onClick={() => onUserFormShow(-1)}>\r\n                  {t(\"scenes.usersSettings.createUser\")}\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n        }}\r\n        columns={[\r\n          {field: \"firstName\", title: t(\"scenes.usersSettings.table.columns.userFirstName\")},\r\n          {field: \"lastName\", title: t(\"scenes.usersSettings.table.columns.userLastName\")},\r\n          {field: \"organization\", title: t(\"scenes.usersSettings.table.columns.userOrganization\")},\r\n          {field: \"email\", title: t(\"scenes.usersSettings.table.columns.userEmail\")}\r\n        ]}\r\n        data={config}\r\n        actions={[\r\n          {\r\n            icon: EditIcon,\r\n            tooltip: t(\"scenes.usersSettings.table.actions.editUser\"),\r\n            onClick: (_, {userId}) => {\r\n              onUserFormShow(userId);\r\n            }\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.usersSettings.table.actions.deleteUser\"),\r\n            onClick: (_, {userId}) => {\r\n              setUserDeleteFormUserId(userId);\r\n            }\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 4,\r\n          searchFieldAlignment: \"left\",\r\n          maxBodyHeight: 400,\r\n          showTitle: false\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n      <SettingsDialog\r\n        title={\r\n          userId === -1\r\n            ? t(\"scenes.usersSettings.modals.createUser\")\r\n            : t(\"scenes.usersSettings.modals.editUser\")\r\n        }\r\n        maxWidth={\"xs\"}\r\n        open={userId !== null || userErrors !== null}\r\n        onClose={() => {\r\n          if (userFormRef.current) {\r\n            userFormRef.current.cancel(() => {\r\n              onUserFormHide();\r\n            });\r\n          } else {\r\n            onUserFormHide();\r\n          }\r\n        }}\r\n        onSubmit={() => {\r\n          if (userFormRef.current) {\r\n            userFormRef.current.submit(() => {\r\n            });\r\n          }\r\n        }}\r\n        hasSubmit\r\n      >\r\n        <UserSettingsForm ref={userFormRef} userId={userId}/>\r\n      </SettingsDialog>\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={userDeleteFormUserId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.usersSettings.modals.deleteUser.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.usersSettings.modals.deleteUser.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setUserDeleteFormUserId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteUser(userDeleteFormUserId);\r\n            setUserDeleteFormUserId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}),\r\n  forwardRef\r\n)(UsersSettingsForm);","import React, {Fragment} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport AppSettingsForm from \"./app-settings-form\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport NodesSettingsForm from \"./nodes-settings-form\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {clearMemoryCache, downloadQueryLog} from \"./actions\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport Input from \"@material-ui/core/Input\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport UsersSettingsForm from \"./users-settings-form\";\r\nimport {\r\n  canClearServerCache,\r\n  canDisplayAppSettingsForm,\r\n  canDisplayNodesSettingsForm,\r\n  canDisplayUsersSettingsForm, canGetQueryLog\r\n} from \"../../utils/user\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  option: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onLogDownload: limit => dispatch(downloadQueryLog(limit)),\r\n  onCacheClear: () => dispatch(clearMemoryCache())\r\n});\r\n\r\nclass SettingsSelect extends React.Component {\r\n\r\n  state = {\r\n    isAppOpen: false,\r\n    isNodesOpen: false,\r\n    isUsersOpen: false,\r\n    appSettingsRef: React.createRef(),\r\n    nodesSettingsRef: React.createRef(),\r\n    usersSettingsRef: React.createRef(),\r\n    isLogDownloadOpen: false,\r\n    logLimit: 5,\r\n  };\r\n\r\n  onAppOpen = () => this.setState({\r\n    ...this.state,\r\n    isAppOpen: true\r\n  });\r\n\r\n  onAppClose = showSnackbar => this.setState({\r\n    ...this.state,\r\n    isAppOpen: false,\r\n    isAppSubmitSnackbarVisible: showSnackbar || false\r\n  });\r\n\r\n  onNodesOpen = () => this.setState({\r\n    ...this.state,\r\n    isNodesOpen: true\r\n  });\r\n\r\n  onNodesClose = () => this.setState({\r\n    ...this.state,\r\n    isNodesOpen: false\r\n  });\r\n\r\n  onUsersOpen = () => this.setState({\r\n    ...this.state,\r\n    isUsersOpen: true\r\n  });\r\n\r\n  onUsersClose = () => this.setState({\r\n    ...this.state,\r\n    isUsersOpen: false\r\n  });\r\n\r\n  onLogDownloadOpen = () => this.setState({\r\n    ...this.state,\r\n    isLogDownloadOpen: true\r\n  });\r\n\r\n  onLogDownloadClose = () => this.setState({\r\n    ...this.state,\r\n    isLogDownloadOpen: false,\r\n    logLimit: 5\r\n  });\r\n\r\n  onLogLimitSet = logLimit => {\r\n    if (!isNaN(logLimit)) {\r\n      this.setState({\r\n        ...this.state,\r\n        logLimit: logLimit\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      onLogDownload,\r\n      onCacheClear,\r\n      nodes,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {\r\n      isAppOpen,\r\n      isNodesOpen,\r\n      isUsersOpen,\r\n      appSettingsRef,\r\n      nodesSettingsRef,\r\n      usersSettingsRef,\r\n      isLogDownloadOpen,\r\n      logLimit\r\n    } = this.state;\r\n\r\n    return (\r\n      <Fragment>\r\n        <ButtonSelect value=\"\" icon={<SettingsIcon/>}>\r\n          {canDisplayAppSettingsForm(user) && (\r\n            <div onClick={this.onAppOpen} className={classes.option}>{t(\"components.header.settings.app\")}</div>\r\n          )}\r\n          {canDisplayUsersSettingsForm(user) && (\r\n            <div onClick={this.onUsersOpen} className={classes.option}>{t(\"components.header.settings.users\")}</div>\r\n          )}\r\n          {canDisplayNodesSettingsForm(user) && (\r\n            <div onClick={this.onNodesOpen} className={classes.option}>{t(\"components.header.settings.nodes\")}</div>\r\n          )}\r\n          {canGetQueryLog(user) && (\r\n            <div onClick={this.onLogDownloadOpen} className={classes.option}>{t(\"components.header.settings.queriesLog\")}</div>\r\n          )}\r\n          {canClearServerCache(user) && (\r\n            <div onClick={onCacheClear} className={classes.option}>{t(\"components.header.settings.clearServerCache\")}</div>\r\n          )}\r\n        </ButtonSelect>\r\n        <SettingsDialog\r\n          title={t(\"scenes.appSettings.title\")}\r\n          open={isAppOpen}\r\n          onClose={() => {\r\n            if (appSettingsRef.current) {\r\n              appSettingsRef.current.cancel(() => this.onAppClose());\r\n            } else {\r\n              this.onAppClose();\r\n            }\r\n          }}\r\n          onSubmit={() => {\r\n            if (appSettingsRef.current) {\r\n              appSettingsRef.current.submit(() => {\r\n                this.onAppClose();\r\n              });\r\n            } else {\r\n              this.onAppClose();\r\n            }\r\n          }}\r\n          hasSubmit\r\n        >\r\n          <AppSettingsForm ref={appSettingsRef}/>\r\n        </SettingsDialog>\r\n        <SettingsDialog\r\n          title={t(\"scenes.nodesSettings.title\")}\r\n          open={isNodesOpen}\r\n          onClose={() => {\r\n            if (nodesSettingsRef.current) {\r\n              nodesSettingsRef.current.cancel(() => this.onNodesClose());\r\n            } else {\r\n              this.onNodesClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <NodesSettingsForm ref={nodesSettingsRef} nodes={nodes}/>\r\n        </SettingsDialog>\r\n\r\n        <SettingsDialog\r\n          title={t(\"scenes.usersSettings.title\")}\r\n          open={isUsersOpen}\r\n          onClose={() => {\r\n            if (usersSettingsRef.current) {\r\n              usersSettingsRef.current.cancel(() => this.onUsersClose());\r\n            } else {\r\n              this.onUsersClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <UsersSettingsForm ref={usersSettingsRef} />\r\n        </SettingsDialog>\r\n\r\n        <Dialog\r\n          open={isLogDownloadOpen}\r\n          onClose={this.onLogDownloadClose}\r\n        >\r\n          <DialogContent>\r\n            <Grid container spacing={2} style={{width: 400}}>\r\n              <Grid item xs={12}>\r\n                <div>{t(\"components.header.settings.queriesLogModal.content\")}:</div>\r\n              </Grid>\r\n              <Grid item xs={12}>\r\n                <Input\r\n                  value={logLimit}\r\n                  onChange={ev => this.onLogLimitSet(ev.target.value)}\r\n                  style={{width: \"100%\"}}\r\n                />\r\n              </Grid>\r\n            </Grid>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={this.onLogDownloadClose}>\r\n              {t(\"commons.confirm.cancel\")}\r\n            </Button>\r\n            <Button\r\n              autoFocus\r\n              onClick={() => {\r\n                this.onLogDownloadClose()\r\n                onLogDownload(logLimit);\r\n              }}\r\n              color=\"primary\">\r\n              {t(\"commons.confirm.download\")}\r\n            </Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(SettingsSelect);","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getClearMemoryCacheUrl, getQueryLog} from \"../../serverApi/urls\";\r\n\r\nexport const QUERY_LOG_DOWNLOAD = \"query/log/download\";\r\nexport const MEMORY_CACHE_CLEAR = \"memory/cache/clear\";\r\n\r\nexport const downloadQueryLog = limit => initRequest(\r\n  QUERY_LOG_DOWNLOAD,\r\n  getQueryLog(limit),\r\n  RequestMethod.GET,\r\n  null,\r\n  null,\r\n  {\r\n    fileSave: {\r\n      name: \"sdmx-query-log.txt\",\r\n      type: \"text/plain;charset=utf-8\"\r\n    },\r\n    stringifyResponse: true\r\n  }\r\n);\r\n\r\nexport const clearMemoryCache = () => initRequest(\r\n  MEMORY_CACHE_CLEAR,\r\n  getClearMemoryCacheUrl(),\r\n  RequestMethod.POST,\r\n  null,\r\n  t => ({\r\n    onStart: t(\"components.header.settings.clearServerCacheAction.messages.clear.start\")\r\n  })\r\n);\r\n","import React, {useRef} from 'react';\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\n\r\nconst styles = theme => ({\r\n  button: {\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: \"white\",\r\n    borderColor: theme.palette.primary.main,\r\n    borderWidth: 1,\r\n    position: \"relative\",\r\n    height: 35,\r\n  },\r\n  icon: {\r\n    width: theme.spacing(6),\r\n    height: 35,\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    position: 'absolute',\r\n    width: `calc(100% - ${theme.spacing(6)})`,\r\n    left: theme.spacing(6)\r\n  },\r\n  inputInput: {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n  }\r\n});\r\n\r\nconst SearchInput = ({classes, query = \"\", onSubmit}) => {\r\n\r\n  const input = useRef(null);\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <div className={classes.button} style={{width: 320}}>\r\n      <label htmlFor=\"search-input\" style={{display: \"none\"}}>\r\n        {t(\"components.searchInput.label\")}\r\n      </label>\r\n      <TextField\r\n        id=\"search-input\"\r\n        fullWidth\r\n        size=\"small\"\r\n        variant=\"outlined\"\r\n        placeholder={t(\"components.searchInput.placeholder\")}\r\n        defaultValue={query}\r\n        InputProps={{\r\n          startAdornment:\r\n            <InputAdornment position=\"start\">\r\n              <SearchIcon/>\r\n            </InputAdornment>,\r\n          inputRef: input,\r\n        }}\r\n        onKeyDown={\r\n          e => {\r\n            if (e.key === \"Enter\" && input.current.value && input.current.value.length > 0) {\r\n              e.preventDefault();\r\n              onSubmit(input.current.value);\r\n            }\r\n          }\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(SearchInput);","import React, {useState} from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport {fade, withStyles} from \"@material-ui/core\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport SearchInput from \"../search-input\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  button: {\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.15),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.25),\r\n    },\r\n    position: \"relative\",\r\n    height: 35,\r\n  },\r\n  icon: {\r\n    width: theme.spacing(6),\r\n    height: 35,\r\n    position: 'absolute',\r\n    pointerEvents: 'none',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  inputRoot: {\r\n    color: 'inherit',\r\n    position: 'absolute',\r\n    width: `calc(100% - ${theme.spacing(6)})`,\r\n    left: theme.spacing(6)\r\n  },\r\n  inputInput: {\r\n    padding: theme.spacing(1, 1, 1, 0),\r\n  }\r\n});\r\n\r\nconst SearchDialog = ({classes, dialogTop, modalWidth, query, onSubmit}) => {\r\n\r\n  const [uuid] = useState(uuidv4());\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  return (\r\n    <div>\r\n      <IconButton color=\"inherit\" onClick={() => setIsOpen(true)}>\r\n        <SearchIcon/>\r\n      </IconButton>\r\n      <Dialog\r\n        open={isOpen}\r\n        onClose={() => setIsOpen(false)}\r\n        onRendered={() => $(`#search-dialog__dialog__${uuid} input`).focus()}\r\n        PaperProps={{\r\n          style: {\r\n            position: \"absolute\",\r\n            top: dialogTop,\r\n            height: 40\r\n          }\r\n        }}\r\n      >\r\n        <div id={`search-dialog__dialog__${uuid}`}>\r\n          <SearchInput\r\n            query={query}\r\n            onSubmit={value => {\r\n              setIsOpen(false);\r\n              onSubmit(value);\r\n            }}\r\n          />\r\n        </div>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default withStyles(styles)(SearchDialog);","export const DASHBOARD_ELEM_TYPE_KEY = \"type\";\r\nexport const DASHBOARD_ELEM_VALUE_KEY = \"value\";\r\nexport const DASHBOARD_ELEM_WIDTH_KEY = \"widthPercentage\";\r\nexport const DASHBOARD_ELEM_SHOW_TITLE_KEY = \"showTitle\";\r\nexport const DASHBOARD_ELEM_ENABLE_FILTERS_KEY = \"enableFilters\";\r\nexport const DASHBOARD_ELEM_FILTER_DIMENSION_KEY = \"filterDimension\";\r\n\r\nexport const DASHBOARD_ELEM_TYPE_VALUE_VIEW = \"view\";\r\nexport const DASHBOARD_ELEM_TYPE_VALUE_TEXT = \"text\";\r\n\r\nexport const emptyDashboardElem = {\r\n  [DASHBOARD_ELEM_TYPE_KEY]: null,\r\n  [DASHBOARD_ELEM_VALUE_KEY]: null,\r\n  [DASHBOARD_ELEM_WIDTH_KEY]: 100,\r\n  [DASHBOARD_ELEM_SHOW_TITLE_KEY]: true,\r\n  [DASHBOARD_ELEM_ENABLE_FILTERS_KEY]: true,\r\n  [DASHBOARD_ELEM_FILTER_DIMENSION_KEY]: null\r\n};\r\n\r\nexport const getViewIdxFromRowAndCol = (rowIdx, colIdx) => `${rowIdx}+${colIdx}`;\r\n\r\nexport const getFilterDimensionId = (layout, filterDimensionIds) => {\r\n  const dimArraysKey = [\"rows\", \"cols\", \"filters\", \"sections\", \"primaryDim\", \"secondaryDim\", \"territoryDim\"];\r\n  let viewDims = [];\r\n\r\n  dimArraysKey.forEach(key => viewDims = viewDims.concat(layout[key] || []));\r\n\r\n  return (filterDimensionIds.find(dimId => viewDims.includes(dimId)) || null);\r\n};","export const getCriteriaRequestObject = (criteria) => {\r\n  const res = [];\r\n\r\n  Object.keys(criteria).forEach(key => {\r\n    if (criteria[key] && criteria[key].length > 0) {\r\n      res.push({\r\n        id: key,\r\n        filterValues: criteria[key]\r\n      })\r\n    }\r\n  });\r\n\r\n  return res;\r\n};","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  getCreateDashboardUrl,\r\n  getDashboardsUrl,\r\n  getDatasetUrl,\r\n  getDeleteDashboardUrl,\r\n  getDeleteViewUrl,\r\n  getGeometryUrl,\r\n  getUpdateDashboardUrl,\r\n  getUserDashboardsUrl,\r\n  getViewsUrl\r\n} from \"../../serverApi/urls\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY\r\n} from \"../../utils/dashboards\";\r\nimport {getCriteriaRequestObject} from \"../../utils/datasets\";\r\nimport _ from \"lodash\"\r\nimport filters from \"../../dummy/filters.json\";\r\n\r\nexport const OTHER_CONFIG_VIEWS_FETCH = \"otherConfig/fetchViews\";\r\nexport const OTHER_CONFIG_VIEWS_CLEAR = \"otherConfig/clearViews\";\r\nexport const OTHER_CONFIG_VIEW_DELETE = \"otherConfig/deleteView\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARDS_FETCH = \"otherConfig/fetchDashboards\";\r\nexport const OTHER_CONFIG_DASHBOARDS_CLEAR = \"otherConfig/clearDashboards\";\r\nexport const OTHER_CONFIG_DASHBOARDS_CLOSE = \"otherConfig/closeDashboards\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_CREATE = \"otherConfig/dashboard/create\";\r\nexport const OTHER_CONFIG_DASHBOARD_UPDATE = \"otherConfig/dashboard/update\";\r\nexport const OTHER_CONFIG_DASHBOARD_CHANGE = \"otherConfig/dashboard/change\";\r\nexport const OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT = \"otherConfig/dashboard/create/submit\";\r\nexport const OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT = \"otherConfig/dashboard/update/submit\";\r\nexport const OTHER_CONFIG_DASHBOARD_HIDE = \"otherConfig/dashboard/hide\";\r\nexport const OTHER_CONFIG_DASHBOARD_DELETE = \"otherConfig/dashboard/create\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_VIEWS_FETCH = \"otherConfig/dashboard/views/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR = \"otherConfig/dashboard/views/clear\";\r\n\r\nexport const OTHER_CONFIG_DASHBOARD_DATASET_FETCH = \"otherConfig/dashboard/dataset/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH = \"otherConfig/dashboard/map/geometry/fetch\";\r\nexport const OTHER_CONFIG_DASHBOARD_DATASET_CLEAR = \"otherConfig/dashboard/dataset/clear\";\r\n\r\nexport const fetchOtherConfigViews = () => initRequest(\r\n  OTHER_CONFIG_VIEWS_FETCH,\r\n  getViewsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.viewsConfig.messages.fetchViews.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigViews = () => ({\r\n  type: OTHER_CONFIG_VIEWS_CLEAR\r\n});\r\n\r\nexport const deleteOtherConfigView = (nodeId: number, id: number) => initRequest(\r\n  OTHER_CONFIG_VIEW_DELETE,\r\n  getDeleteViewUrl(nodeId, id),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.viewsConfig.messages.deleteView.start\")\r\n  })\r\n);\r\n\r\nexport const fetchOtherConfigDashboards = () => initRequest(\r\n  OTHER_CONFIG_DASHBOARDS_FETCH,\r\n  getUserDashboardsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboards.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigDashboards = () => ({\r\n  type: OTHER_CONFIG_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const closeOtherConfigDashboard = () => ({\r\n  type: OTHER_CONFIG_DASHBOARDS_CLOSE\r\n});\r\n\r\nexport const createOtherConfigDashboard = (dashboard: any) => ({\r\n  type: OTHER_CONFIG_DASHBOARD_CREATE,\r\n  payload: {\r\n    dashboard: dashboard\r\n  }\r\n});\r\n\r\nexport const updateOtherConfigDashboard = (dashboardId: number) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_UPDATE,\r\n  getDashboardsUrl(dashboardId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboard.start\")\r\n  })\r\n);\r\n\r\nexport const changeOtherConfigDashboard = (dashboard: any) => ({\r\n  type: OTHER_CONFIG_DASHBOARD_CHANGE,\r\n  payload: {\r\n    dashboard: dashboard\r\n  }\r\n});\r\n\r\nconst getNewDashboard = (dashboard: any, dashboardId?: number) => {\r\n  const newDashboard = _.cloneDeep(dashboard);\r\n  const ids: string[] = [];\r\n\r\n  newDashboard.dashboardConfig.forEach((row: any, rowIdx: number) => {\r\n    row.forEach((col: any, colIdx: number) => {\r\n      const type = col[DASHBOARD_ELEM_TYPE_KEY];\r\n      const value = col[DASHBOARD_ELEM_VALUE_KEY];\r\n      const filterDimension = col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY]\r\n\r\n      if (type === DASHBOARD_ELEM_TYPE_VALUE_VIEW && value !== null && value !== undefined && !ids.includes(value)) {\r\n        ids.push(value)\r\n      }\r\n      if (filterDimension === \"\") {\r\n        newDashboard.dashboardConfig[rowIdx][colIdx].filterDimension = null;\r\n      }\r\n    });\r\n  });\r\n\r\n  let newFilterLevels = {};\r\n  filters.labels.forEach((label: string) => {\r\n    newFilterLevels = {\r\n      ...newFilterLevels,\r\n      [label]: (newDashboard.filterLevels[label] || false)\r\n    }\r\n  });\r\n\r\n  return {\r\n    dashboardId: dashboardId,\r\n    title: newDashboard.title,\r\n    dashboardConfig: JSON.stringify(newDashboard.dashboardConfig),\r\n    viewIds: ids,\r\n    filterLevels: JSON.stringify(newFilterLevels)\r\n  }\r\n};\r\n\r\nexport const submitOtherConfigDashboardCreate = (dashboard: any) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT,\r\n  getCreateDashboardUrl(),\r\n  RequestMethod.POST,\r\n  getNewDashboard(dashboard),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.submitDashboardCreate.start\")\r\n  })\r\n);\r\n\r\nexport const submitOtherConfigDashboardUpdate = (dashboardId: number, dashboard: any) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  getUpdateDashboardUrl(dashboardId),\r\n  RequestMethod.PUT,\r\n  getNewDashboard(dashboard, dashboardId),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.submitDashboardUpdate.start\")\r\n  })\r\n);\r\n\r\nexport const deleteOtherConfigDashboard = (dashboardId: number) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_DELETE,\r\n  getDeleteDashboardUrl(dashboardId),\r\n  RequestMethod.DELETE,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.deleteDashboard.start\")\r\n  })\r\n);\r\n\r\nexport const hideOtherConfigDashboard = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_HIDE\r\n});\r\n\r\nexport const fetchOtherConfigDashboardViews = () => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_FETCH,\r\n  getViewsUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboardsSettings.messages.fetchDashboardViews.start\")\r\n  })\r\n);\r\n\r\nexport const clearOtherConfigDashboardViews = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR\r\n});\r\n\r\nexport const fetchOtherConfigDashboardsDataset = (nodeId: number, datasetId: string, criteria: any, requestIds: string[]) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_DATASET_FETCH,\r\n  getDatasetUrl(nodeId, datasetId),\r\n  RequestMethod.POST,\r\n  getCriteriaRequestObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDataset\")\r\n  }),\r\n  {\r\n    requestIds: requestIds,\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const fetchOtherConfigDashboardsMapGeometries = (idList: string[], requestId: string) => initRequest(\r\n  OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dashboard.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    requestId: requestId\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const clearOtherConfigDashboardsDataset = () => ({\r\n  type: OTHER_CONFIG_DASHBOARD_DATASET_CLEAR\r\n});","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport ArrowUpward from \"@material-ui/icons/ArrowUpward\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {Visibility} from \"@material-ui/icons\";\r\nimport {\r\n  clearOtherConfigViews,\r\n  deleteOtherConfigView,\r\n  fetchOtherConfigViews\r\n} from \"../../../state/otherConfig/otherConfigActions\";\r\nimport {goToData} from \"../../../links\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {getI18nObjCustomFilterAndSearch, localizeI18nObj} from \"../../../utils/i18n\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n  SortArrow: forwardRef((props, ref) => <ArrowUpward {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  views: state.otherConfig.views\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchViews: () => dispatch(fetchOtherConfigViews()),\r\n  clearViews: () => dispatch(clearOtherConfigViews()),\r\n  deleteView: (nodeId, id) => dispatch(deleteOtherConfigView(nodeId, id))\r\n});\r\n\r\nconst ViewsSettingsForm = ({classes, defaultLanguage, languages, views, fetchViews, clearViews, deleteView, nodes}, ref) => {\r\n\r\n  const [needViews, setNeedViews] = useState(true);\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n\r\n    if (needViews) {\r\n      setNeedViews(false);\r\n      fetchViews();\r\n    }\r\n  }, [views, needViews, setNeedViews, fetchViews]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearViews();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const [deleteViewId, setDeleteViewId] = useState(null);\r\n  const [deleteViewNodeId, setDeleteViewNodeId] = useState(null);\r\n\r\n  return nodes && views && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"nodeId\",\r\n            title: t(\"scenes.viewsSettings.table.columns.viewNodeId\"),\r\n            render: ({nodeId}) => nodes.find(node => node.nodeId === nodeId).code,\r\n            customFilterAndSearch: (str, {nodeId}) =>\r\n              nodes.find(node => node.nodeId === nodeId).code.toLowerCase()\r\n                .includes(str.toLowerCase())\r\n          },\r\n          {field: \"datasetId\", title: t(\"scenes.viewsSettings.table.columns.viewDatasetId\")},\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.viewsSettings.table.columns.viewTitle\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          },\r\n        ]}\r\n        data={views}\r\n        actions={[\r\n          ({\r\n            icon: Visibility,\r\n            tooltip: t(\"scenes.viewsSettings.table.actions.viewView\"),\r\n            onClick: (_, {nodeId, datasetId, viewTemplateId}) => goToData(nodes.find(node => node.nodeId === nodeId).code, [], datasetId, viewTemplateId)\r\n          }),\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.viewsSettings.table.actions.deleteView\"),\r\n            onClick: (_, {nodeId, viewTemplateId}) => {\r\n              setDeleteViewId(viewTemplateId);\r\n              setDeleteViewNodeId(nodeId);\r\n            }\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 3,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteViewId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.viewsSettings.modals.deleteView.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.viewsSettings.modals.deleteView.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => {\r\n            setDeleteViewId(null);\r\n            setDeleteViewNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => {\r\n            deleteView(deleteViewNodeId, deleteViewId);\r\n            setDeleteViewId(null);\r\n            setDeleteViewNodeId(null);\r\n          }}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(ViewsSettingsForm);","const $ = window.jQuery;\r\n\r\n/* https://stackoverflow.com/questions/986937/how-can-i-get-the-browsers-scrollbar-sizes */\r\nexport function getScrollBarWidth() {\r\n  const temp = $('<div>').css({visibility: 'hidden', width: 100, overflow: 'scroll'}).appendTo('body');\r\n  const widthWithScroll = $('<div>').css({width: '100%'}).appendTo(temp).outerWidth();\r\n  temp.remove();\r\n  return 100 - widthWithScroll;\r\n}\r\n\r\nexport function getTextWidth(text, element) {\r\n  if (typeof (text) === \"string\" && text.length > 0) {\r\n    element.innerText = text;\r\n    return element.offsetWidth;\r\n  } else {\r\n    return 0;\r\n  }\r\n}\r\n","import React, {Fragment} from 'react';\r\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\r\nimport ArrowUpwardIcon from '@material-ui/icons/ArrowUpward';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport \"./style.css\";\r\n\r\nexport const SORT_DIRECTION_ASC = 'SORT_DIRECTION_ASC';\r\nexport const SORT_DIRECTION_DESC = 'SORT_DIRECTION_DESC';\r\n\r\nconst SortButtons = ({\r\n                       value,\r\n                       onChange\r\n                     }) =>\r\n  <Fragment>\r\n    <div className=\"infinite-scroll-table__header__sort-buttons__icon-container\">\r\n      <IconButton\r\n        onClick={() => onChange(value !== SORT_DIRECTION_ASC ? SORT_DIRECTION_ASC : SORT_DIRECTION_DESC)}\r\n        style={{padding: 4, top: -4}}\r\n      >\r\n        {\r\n          value === SORT_DIRECTION_ASC\r\n            ? <ArrowUpwardIcon className=\"infinite-scroll-table__header__icon\"/>\r\n            : <ArrowDownwardIcon className=\"infinite-scroll-table__header__icon\"/>\r\n        }\r\n      </IconButton>\r\n    </div>\r\n  </Fragment>;\r\n\r\nexport default SortButtons;\r\n","export const DEFAULT_TABLE_HEIGHT = 340;\r\nexport const ROW_HEIGHT = 40;\r\nexport const TABLE_TOTAL_BORDER = 2;\r\n\r\nexport const ACTIONS_GUTTER = 4;\r\nexport const ACTION_WIDTH = 24;\r\nexport const CELL_PADDING = 8;\r\nexport const CHECKBOX_WIDTH = 40;\r\nexport const COL_WIDTH_SAFE = 4;\r\nexport const HEADER_CELL_PADDING = 8;\r\nexport const HEADER_CELL_GUTTER = 4;\r\nexport const HEADER_CELL_CONTROLS_GUTTER = 4;\r\nexport const FILTER_BUTTON_WIDTH = 16;\r\nexport const SORT_BUTTON_WIDTH = 16;\r\n\r\nexport const DATA_INDEX_ACTIONS_OBJS = \"_actions\";\r\nexport const DATA_INDEX_FIXED_ACTIONS_OBJS = \"_fixedActions\";\r\nexport const DATA_INDEX_CHECKED = \"_checked\";\r\nexport const DATA_INDEX_RENDERED = \"__rendered\";\r\nexport const DATA_INDEX_ORIGINAL_ROW = \"__originalRow\";\r\nexport const DATA_INDEX_ORIGINAL_TRANSLATED_ROW = \"__originalTranslatedRow\";\r\n\r\nexport const RESIZE_TIMEOUT = 1000;\r\nexport const PAGINATION_TIMEOUT = 500;\r\nexport const VIEW_INDEXES_UPDATE_TIMEOUT = 200;\r\n\r\nexport const MAX_PAGE_SIZE = 200;\r\n\r\nexport const DEFAULT_PAGE_SIZE = Math.floor(MAX_PAGE_SIZE / 3) * 3;\r\nexport const DEFAULT_PAGE_NUM = 1;\r\n\r\nexport const TABLE_PLACEHOLDER_BGCOLOR = \"#fafafa\";\r\n","export const getIndexesFromPaginationParams = (pageSize, pageNum) => ({\r\n  startIdx: pageSize * (pageNum - 1),\r\n  stopIdx: (pageSize * pageNum) - 1\r\n});\r\n\r\nexport const getPaginationParamsFromIndexes = (startIdx, stopIdx, maxIdx) => {\r\n\r\n  const minPageSize = stopIdx - startIdx + 1;\r\n  const maxPageSize = maxIdx + 1;\r\n\r\n  const pageNumForMinPageSize = (stopIdx + 1) / minPageSize;\r\n\r\n  if (Number.isInteger(pageNumForMinPageSize)) {\r\n    return ({\r\n      pageSize: minPageSize,\r\n      pageNum: pageNumForMinPageSize\r\n    });\r\n  } else {\r\n\r\n    for (let pageSize = minPageSize + 1; pageSize <= maxPageSize; pageSize++) {\r\n\r\n      const minPageNum = Math.ceil((stopIdx + 1) / pageSize);\r\n      const maxPageNum = Math.floor((startIdx / pageSize) + 1);\r\n\r\n      for (let pageNum = minPageNum; pageNum <= maxPageNum; pageNum++) {\r\n\r\n        const indexes = getIndexesFromPaginationParams(pageSize, pageNum);\r\n\r\n        if (indexes.startIdx <= startIdx && stopIdx <= indexes.stopIdx) {\r\n          return ({\r\n            pageSize,\r\n            pageNum\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n","import React from 'react';\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ClearIcon from \"@material-ui/icons/Clear\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst AUTO_SEARCH_INPUT_TIMEOUT = 500;\r\n\r\nclass AutoSearchInput extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      tempValue: props.value || \"\",\r\n      value: props.value || \"\",\r\n      timeout: null\r\n    };\r\n    this.onChange = this.onChange.bind(this);\r\n    this.onClear = this.onClear.bind(this);\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, state) {\r\n\r\n    if (nextProps.value !== undefined && (nextProps.value !== state.value)) {\r\n      if (state.timeout) {\r\n        clearTimeout(state.timeout)\r\n      }\r\n      return ({\r\n        tempValue: null,\r\n        value: nextProps.value\r\n      });\r\n    } else {\r\n      return null;\r\n    }\r\n\r\n  }\r\n\r\n  onClear() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n    this.setState({\r\n      tempValue: null,\r\n      value: \"\",\r\n      timeout: null\r\n    });\r\n    this.props.onSearch(\"\");\r\n  }\r\n\r\n  onChange(value) {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n    this.setState({\r\n      tempValue: value,\r\n      timeout: setTimeout(\r\n        () => {\r\n          this.setState({\r\n            tempValue: null,\r\n            value\r\n          });\r\n          this.props.onSearch(value);\r\n        },\r\n        AUTO_SEARCH_INPUT_TIMEOUT\r\n      ),\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout)\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      t,\r\n      placeholder\r\n    } = this.props;\r\n\r\n    const {\r\n      tempValue,\r\n      value\r\n    } = this.state;\r\n\r\n    return (\r\n      <TextField\r\n        value={tempValue !== null ? tempValue : value}\r\n        placeholder={placeholder || (t(\"components.autoSearchInput.placeholder\") + \"...\")}\r\n        onChange={({target}) => this.onChange(target.value)}\r\n        InputProps={{\r\n          startAdornment: (\r\n            <InputAdornment position=\"start\">\r\n              <SearchIcon/>\r\n            </InputAdornment>\r\n          ),\r\n          endAdornment: (\r\n            <InputAdornment position=\"end\">\r\n              <IconButton\r\n                disabled={!value || value.length === 0}\r\n                onClick={this.onClear}\r\n                style={{padding: 6}}\r\n              >\r\n                <ClearIcon fontSize=\"small\"/>\r\n              </IconButton>\r\n            </InputAdornment>\r\n          )\r\n        }}\r\n        style={{width: \"100%\"}}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\n\r\nexport default withTranslation()(AutoSearchInput);\r\n","import React, {Fragment} from \"react\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport AutoSearchInput from \"../../auto-search-input\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\n\r\nconst PreHeader = ({\r\n                     t,\r\n                     searchText,\r\n                     onSearch,\r\n                     selectedRowCount,\r\n                     tableActions,\r\n                     renderTableAction,\r\n                     leftActions,\r\n                     rightActions\r\n                   }) =>\r\n  <Grid container style={{marginBottom: 4}}>\r\n    <Grid item xs={6}>\r\n      <Grid container justify=\"space-between\">\r\n        <Grid item>\r\n          {leftActions}\r\n        </Grid>\r\n        <Grid item>\r\n          <Grid container justify=\"flex-end\">\r\n            {tableActions && selectedRowCount > 0 && (\r\n              <Fragment>\r\n                <Grid item style={{padding: \"14px 16px 14px 8px\"}}>\r\n                  {selectedRowCount > 1\r\n                    ? t(\"components.infiniteScrollTable.preHeader.selectedCount_plural\", {selectedRowCount})\r\n                    : t(\"components.infiniteScrollTable.preHeader.selectedCount\", {selectedRowCount})\r\n                  }\r\n                </Grid>\r\n                {tableActions.map((action, index) =>\r\n                  <Grid item key={index}>\r\n                    {renderTableAction(action)}\r\n                  </Grid>\r\n                )}\r\n              </Fragment>\r\n            )}\r\n            {rightActions && (\r\n              <Grid item>\r\n                {rightActions}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </Grid>\r\n      </Grid>\r\n    </Grid>\r\n    <Grid item xs={6} style={{padding: \"8px 0\"}}>\r\n      <AutoSearchInput\r\n        value={searchText}\r\n        onSearch={onSearch}\r\n      />\r\n    </Grid>\r\n\r\n  </Grid>;\r\n\r\nexport default withTranslation()(PreHeader);\r\n","import React from \"react\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\n\r\nconst Footer = ({\r\n                  t,\r\n                  isLoading,\r\n                  isHidden,\r\n                  rowNumStart,\r\n                  rowNumEnd,\r\n                  rowCount\r\n                }) =>\r\n  <Grid container justify=\"flex-end\" style={{marginTop: 8}}>\r\n    <Grid item>\r\n      {!isHidden\r\n        ? (\r\n          isLoading\r\n            ? (\r\n              <CircularProgress\r\n                size=\"small\"\r\n                className=\"infinite-scroll-table__footer__spinner\"\r\n                style={{\r\n                  fontSize: 10,\r\n                  width: 13,\r\n                  height: 13,\r\n                  marginRight: 2\r\n                }}\r\n              />\r\n            )\r\n            : t(\"components.infiniteScrollTable.footer.rowCount\", {rowNumStart, rowNumEnd, rowCount})\r\n        )\r\n        : <span/>\r\n      }\r\n    </Grid>\r\n  </Grid>;\r\n\r\nexport default withTranslation()(Footer);\r\n","import React from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"relative\",\r\n    height: \"100%\"\r\n  },\r\n  text: {\r\n    fontStyle: \"italic\",\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%)\"\r\n  },\r\n  image: {\r\n    position: \"absolute\",\r\n    top: \"50%\",\r\n    left: \"50%\",\r\n    transform: \"translate(-50%, -100%)\",\r\n    paddingBottom: 16\r\n  }\r\n});\r\n\r\nconst CustomEmpty = ({\r\n  t,\r\n                       classes,\r\n                       text,\r\n                       textStyle,\r\n                       width,\r\n                       backgroundColor,\r\n                       color,\r\n                       image\r\n                     }) =>\r\n  <div className={classes.root} style={{width: width || \"100%\", backgroundColor, color}}>\r\n    <div style={{width: width || \"100%\"}}>\r\n      {image && (\r\n        <div className={classes.image}>\r\n          {image}\r\n        </div>\r\n      )}\r\n      <div className={classes.text} style={{...textStyle}}>\r\n        {text || t(\"components.customEmpty.placeholder\")}\r\n      </div>\r\n    </div>\r\n  </div>;\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(CustomEmpty);\r\n","import React, {Fragment, useState} from 'react';\r\nimport \"./style.css\";\r\nimport AutoSearchInput from \"../../auto-search-input\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Popover from \"@material-ui/core/Popover\";\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\n\r\nconst FilterButton = ({\r\n                        value,\r\n                        onChange,\r\n                        options\r\n                      }) => {\r\n\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n\r\n  const handleOpen = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <div className=\"infinite-scroll-table__header__filter-button__icon-container\">\r\n        <IconButton\r\n          onClick={handleOpen}\r\n          style={{padding: 4, top: -4}}\r\n        >\r\n          <FilterListIcon className=\"infinite-scroll-table__header__icon\"/>\r\n        </IconButton>\r\n      </div>\r\n\r\n      <Popover\r\n        open={Boolean(anchorEl)}\r\n        anchorEl={anchorEl}\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'center',\r\n        }}\r\n        transformOrigin={{\r\n          vertical: 'top',\r\n          horizontal: 'center',\r\n        }}\r\n        onClose={handleClose}\r\n      >\r\n        {options && options.length\r\n          ? (\r\n            options.map((option, index) =>\r\n              <Grid\r\n                container\r\n                className=\"infinite-scroll-table__header__filter-button__option\"\r\n                key={index}\r\n              >\r\n                <Grid item>\r\n                  <Checkbox\r\n                    checked={(value || []).find(val => val === option.value) !== undefined}\r\n                    onChange={({target}) => target.checked\r\n                      ? onChange([...(value || []), option.value])\r\n                      : onChange((value || []).filter(val => val !== option.value))\r\n                    }\r\n                  />\r\n                </Grid>\r\n                <Grid item>\r\n                  <div style={{height: 42, lineHeight: \"42px\", marginRight: 16}}>\r\n                    {option.text}\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n          )\r\n          : (\r\n            <div style={{padding: 8}}>\r\n              <AutoSearchInput onSearch={onChange} value={value}/>\r\n            </div>\r\n          )\r\n        }\r\n      </Popover>\r\n\r\n    </Fragment>\r\n  )\r\n};\r\n\r\nexport default FilterButton;\r\n","import React, {Component, Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport \"./style.css\";\r\nimport {getScrollBarWidth, getTextWidth} from \"../../utils/style\";\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport SortButtons, {SORT_DIRECTION_ASC, SORT_DIRECTION_DESC} from './sort-buttons';\r\nimport _ from \"lodash\";\r\nimport {FixedSizeList} from \"react-window\";\r\nimport {\r\n  ACTION_WIDTH,\r\n  ACTIONS_GUTTER,\r\n  CELL_PADDING,\r\n  CHECKBOX_WIDTH,\r\n  COL_WIDTH_SAFE,\r\n  DATA_INDEX_ACTIONS_OBJS,\r\n  DATA_INDEX_CHECKED,\r\n  DATA_INDEX_FIXED_ACTIONS_OBJS,\r\n  DATA_INDEX_ORIGINAL_ROW,\r\n  DATA_INDEX_ORIGINAL_TRANSLATED_ROW,\r\n  DATA_INDEX_RENDERED,\r\n  DEFAULT_PAGE_NUM,\r\n  DEFAULT_PAGE_SIZE,\r\n  DEFAULT_TABLE_HEIGHT,\r\n  FILTER_BUTTON_WIDTH,\r\n  HEADER_CELL_CONTROLS_GUTTER,\r\n  HEADER_CELL_GUTTER,\r\n  HEADER_CELL_PADDING,\r\n  MAX_PAGE_SIZE,\r\n  PAGINATION_TIMEOUT,\r\n  RESIZE_TIMEOUT,\r\n  ROW_HEIGHT,\r\n  SORT_BUTTON_WIDTH,\r\n  TABLE_TOTAL_BORDER,\r\n  VIEW_INDEXES_UPDATE_TIMEOUT\r\n} from \"./contants\";\r\nimport {getIndexesFromPaginationParams, getPaginationParamsFromIndexes} from \"./utils\";\r\nimport PreHeader from \"./pre-header\";\r\nimport Footer from \"./footer\";\r\nimport {withSize} from \"react-sizeme\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport FilterButton from \"./filter-button\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nexport const numberStringSorter = (a, b) => Number(a) - Number(b);\r\n\r\nclass InfiniteScrollTable extends Component {\r\n\r\n  constructor(props) {\r\n\r\n    super(props);\r\n\r\n    this.onSearchTextChange = this.onSearchTextChange.bind(this);\r\n    this.onFiltersChange = this.onFiltersChange.bind(this);\r\n    this.onSortChange = this.onSortChange.bind(this);\r\n    this.getSelectedRowKeys = this.getSelectedRowKeys.bind(this);\r\n    this.onRowSelectionChange = this.onRowSelectionChange.bind(this);\r\n    this.getCols = this.getCols.bind(this);\r\n    this.getNormalizedTableActions = this.getNormalizedTableActions.bind(this);\r\n    this.renderActions = this.renderActions.bind(this);\r\n    this.renderGridRow = this.renderGridRow.bind(this);\r\n    this.renderFixedActions = this.renderFixedActions.bind(this);\r\n    this.renderHeaderCells = this.renderHeaderCells.bind(this);\r\n    this.renderCheckboxTitle = this.renderCheckboxTitle.bind(this);\r\n    this.renderCheckbox = this.renderCheckbox.bind(this);\r\n    this.getPopulatedRows = this.getPopulatedRows.bind(this);\r\n    this.getColWidths = this.getColWidths.bind(this);\r\n    this.getQueriedRows = this.getQueriedRows.bind(this);\r\n    this.getRenderedRows = this.getRenderedRows.bind(this);\r\n    this.onRenderedRowsChange = this.onRenderedRowsChange.bind(this);\r\n\r\n    this.state = {\r\n      uuid: uuidv4(),\r\n\r\n      gridKeyForRefresh: uuidv4(),\r\n      scrollTop: 0,\r\n      scrollLeft: 0,\r\n\r\n      gridScrollbarWidth: getScrollBarWidth(),\r\n\r\n      searchText: \"\",\r\n      sortCol: null,\r\n      sortByDesc: false,\r\n      filters: {},\r\n\r\n      selectedRowKeys:\r\n        props.rowSelection && props.rowSelection.selectedRowKeys\r\n          ? props.rowSelection.selectedRowKeys\r\n          : [],\r\n\r\n      cols: null,\r\n\r\n      populatedRows: null,\r\n\r\n      colWidths: null,\r\n\r\n      renderedRows: null,\r\n\r\n      queriedRows: null,\r\n\r\n      isResizing: false,\r\n      resizeTimeout: null,\r\n\r\n      pageSize: null,\r\n      pageNum: null,\r\n      pageRequestTimeout: null,\r\n\r\n      isPaginating: props.isPaginated,\r\n      pageRequestParams: null,\r\n\r\n      viewStartIdx: null,\r\n      viewEndIdx: null,\r\n      viewIndexesUpdateTimeout: null,\r\n\r\n      doNotCallOnChangeOnNextRenderedRowsChange: false\r\n    };\r\n\r\n    if (props.isPaginated) {\r\n      this.state.pageRequestParams = {\r\n        pageSize: DEFAULT_PAGE_SIZE,\r\n        pageNum: DEFAULT_PAGE_NUM,\r\n        filters: this.state.filters,\r\n        searchText: this.state.searchText,\r\n        sortCol: this.state.sortCol,\r\n        sortByDesc: this.state.sortByDesc\r\n      };\r\n    }\r\n\r\n    if (props.onChange && props.isPaginated) {\r\n      props.onChange(this.state.pageRequestParams);\r\n    }\r\n  }\r\n\r\n  static isValuePassingSearchText(value, searchText) {\r\n    return String(value).toLowerCase().includes(searchText.toLowerCase())\r\n  }\r\n\r\n  static defaultSorter = (a, b, isDesc) => {\r\n\r\n    const normalize = val => typeof (val) === \"string\" ? val.toLowerCase() : Number(val);\r\n    const _a = normalize(a);\r\n    const _b = normalize(b);\r\n\r\n    return (isDesc ? (_b < _a) : (_a < _b)) ? -1 : 1\r\n  };\r\n\r\n  static isArrayPropertyChangedLazy(prevProp, prop) {\r\n    return (\r\n      (prevProp !== prop) ||\r\n      ((prevProp === null || prevProp === undefined) && prop !== null && prop !== undefined) ||\r\n      (prevProp && prop && prevProp.length !== prop.length)\r\n    );\r\n  }\r\n\r\n  /* === Hooks === */\r\n\r\n  getPopulatedRows(rows) {\r\n\r\n    const {\r\n      defaultLanguage,\r\n      languages,\r\n      multilangStrDataIndexes,\r\n      actions,\r\n      fixedActions,\r\n      altActions,\r\n      getIsAltRow\r\n    } = this.props;\r\n\r\n    const getActionsObjs = (actions, row) =>\r\n      (actions || [])\r\n        .filter(action => action !== null)\r\n        .map(action => typeof (action) === \"function\" ? action(row) : action)\r\n        .filter(action => action !== null)\r\n        .map(action => ({...action, row}));\r\n\r\n    return (rows !== null && rows !== undefined)\r\n      ? rows.map(row => {\r\n\r\n        const populatedRow = {...row};\r\n\r\n        populatedRow[DATA_INDEX_ORIGINAL_ROW] = {...populatedRow};\r\n\r\n        if (multilangStrDataIndexes) {\r\n          for (let dataIndex of multilangStrDataIndexes) {\r\n            populatedRow[dataIndex] = localizeI18nObj(populatedRow[dataIndex], defaultLanguage, languages);\r\n          }\r\n        }\r\n\r\n        populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW] = {...populatedRow};\r\n\r\n        populatedRow[DATA_INDEX_FIXED_ACTIONS_OBJS] =\r\n          fixedActions\r\n            ? getActionsObjs(fixedActions, populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW])\r\n            : null;\r\n\r\n        populatedRow[DATA_INDEX_ACTIONS_OBJS] =\r\n          (actions || altActions)\r\n            ? getActionsObjs(\r\n            (getIsAltRow && getIsAltRow(populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW])) ? altActions : actions,\r\n            populatedRow[DATA_INDEX_ORIGINAL_TRANSLATED_ROW]\r\n            )\r\n            : null;\r\n\r\n        return populatedRow;\r\n\r\n      })\r\n      : null;\r\n  }\r\n\r\n  getColWidths(rows, cols) {\r\n\r\n    const {\r\n      size\r\n    } = this.props;\r\n\r\n    const {\r\n      gridScrollbarWidth\r\n    } = this.state;\r\n\r\n    if (cols === null) {\r\n      return null;\r\n    }\r\n\r\n    const getTextWidthEl = $('<span>').css({visibility: 'hidden', position: 'absolute'}).appendTo('body').get(0);\r\n\r\n    let colWidths = cols.map(col => {\r\n\r\n      let colWidth = 0;\r\n\r\n      const colTitleWidth =\r\n        getTextWidth(col.title, getTextWidthEl) +\r\n        ((!col.noFilter || !col.noSort) ? HEADER_CELL_GUTTER : 0) +\r\n        (col.noFilter ? 0 : FILTER_BUTTON_WIDTH) +\r\n        (col.noSort ? 0 : SORT_BUTTON_WIDTH) +\r\n        ((!col.noFilter && !col.noSort) ? HEADER_CELL_CONTROLS_GUTTER : 0) +\r\n        CELL_PADDING * 2 + COL_WIDTH_SAFE;\r\n\r\n      if (col.width) {\r\n\r\n        colWidth = Math.max(colTitleWidth, col.width);\r\n\r\n      } else if ((col.widthToContent || col.minWidthToContent) && rows.length > 0) {\r\n\r\n        colWidth = Math.max(\r\n          colTitleWidth,\r\n          ...rows.map(row =>\r\n            getTextWidth(\r\n              col.renderText\r\n                ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][col.dataIndex])\r\n                : row[col.dataIndex],\r\n              getTextWidthEl\r\n            ) +\r\n            (CELL_PADDING * 2) +\r\n            COL_WIDTH_SAFE\r\n          )\r\n        );\r\n\r\n      } else if (col.minWidth) {\r\n\r\n        colWidth = Math.max(colTitleWidth, col.minWidth);\r\n\r\n      } else {\r\n\r\n        colWidth = colTitleWidth;\r\n\r\n      }\r\n\r\n      return colWidth;\r\n    });\r\n\r\n    $(getTextWidthEl).remove();\r\n\r\n    const isVariableSizeCol = col => !col.width && (rows.length > 0 ? !col.widthToContent : true);\r\n    const variableSizeCols = cols.filter(isVariableSizeCol);\r\n\r\n    let colWidthsSum = 0;\r\n    colWidths.forEach(width => colWidthsSum += width);\r\n\r\n    const availableWidth = size.width - colWidthsSum -\r\n      ((rows !== null && this.getIsVerticalScrollbarVisible(rows.length)) ? gridScrollbarWidth : 0) -\r\n      TABLE_TOTAL_BORDER;\r\n\r\n    if (variableSizeCols.length > 0 && availableWidth > 0) {\r\n\r\n      const widthToAdd = availableWidth / variableSizeCols.length;\r\n\r\n      colWidths = colWidths.map((colWidth, colIndex) =>\r\n        isVariableSizeCol(cols[colIndex])\r\n          ? colWidth + widthToAdd\r\n          : colWidth\r\n      );\r\n    }\r\n\r\n    return colWidths;\r\n  }\r\n\r\n  getRenderedRows(rows, cols, colsWidths, selectedRowKeys) {\r\n\r\n    const {\r\n      rowSelection,\r\n      tableActions,\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    return rows !== null\r\n      ? rows.map(row => {\r\n\r\n        const resRow = {...row};\r\n\r\n        if (rowSelection || tableActions) {\r\n          resRow[DATA_INDEX_CHECKED] = selectedRowKeys.includes(getRowKey(row))\r\n        }\r\n\r\n        return ({\r\n          ...resRow,\r\n          [DATA_INDEX_RENDERED]: this.renderGridRow(resRow, cols, colsWidths)\r\n        });\r\n      })\r\n      : null;\r\n  }\r\n\r\n  getQueriedRows(rows, cols, filters, searchText, sortCol, sortByDesc) {\r\n\r\n    const {\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    if (isPaginated) {\r\n      return rows;\r\n    } else {\r\n      let queriedRows = this.getFilteredGridRows(rows, cols, filters);\r\n      queriedRows = this.getSearchTextFilteredGridRows(queriedRows, cols, searchText);\r\n      return this.getSortedGridRows(queriedRows, cols, sortCol, sortByDesc);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    const {\r\n      data,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    if (data !== null) {\r\n      const cols = this.getCols();\r\n      const populatedRows = this.getPopulatedRows(data);\r\n      const colWidths = this.getColWidths(populatedRows, cols);\r\n      const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, this.getSelectedRowKeys());\r\n      const queriedRows = this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc, isPaginated);\r\n\r\n      this.setState({\r\n        cols,\r\n        populatedRows,\r\n        colWidths,\r\n        renderedRows,\r\n        queriedRows\r\n      });\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n\r\n    const {\r\n      isPaginated,\r\n      rowSelection,\r\n      data\r\n    } = this.props;\r\n\r\n    const {\r\n      uuid,\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc,\r\n      scrollLeft,\r\n      scrollTop,\r\n      resizeTimeout,\r\n      colWidths,\r\n      cols,\r\n      pageSize,\r\n      pageNum,\r\n      pageRequestParams\r\n    } = this.state;\r\n\r\n    if (InfiniteScrollTable.isArrayPropertyChangedLazy(prevProps.data, data)) { // todo: check for lang change\r\n\r\n      let newCols = null;\r\n      let newPopulatedRows = null;\r\n      let newColWidths = null;\r\n      let newRenderedRows = null;\r\n      let newQueriedRows = null;\r\n      let newScrollTop = null;\r\n\r\n      if (data !== null) {\r\n\r\n        newCols = this.getCols();\r\n        newPopulatedRows = this.getPopulatedRows(this.props.data);\r\n\r\n        newColWidths =\r\n          colWidths !== null && cols !== null && (\r\n            (prevProps.data === null && data === null) ||\r\n            ((prevProps.data !== null && prevProps.data.length === 0) && (data !== null && data.length === 0))\r\n          )\r\n            ? colWidths\r\n            : this.getColWidths(newPopulatedRows, newCols);\r\n        newRenderedRows = this.getRenderedRows(newPopulatedRows, newCols, newColWidths, this.getSelectedRowKeys());\r\n        newQueriedRows = this.getQueriedRows(\r\n          newRenderedRows,\r\n          newCols,\r\n          filters,\r\n          searchText,\r\n          sortCol,\r\n          sortByDesc\r\n        );\r\n      } else {\r\n\r\n        const $grid = $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid`);\r\n        if ($grid) {\r\n          newScrollTop = $grid.scrollTop();\r\n        }\r\n      }\r\n\r\n      this.setState({\r\n        cols: newCols,\r\n        populatedRows: newPopulatedRows,\r\n        colWidths: newColWidths,\r\n        renderedRows: newRenderedRows,\r\n        queriedRows: newQueriedRows,\r\n        pageNum: isPaginated && pageRequestParams ? pageRequestParams.pageNum : pageNum,\r\n        pageSize: isPaginated && pageRequestParams ? pageRequestParams.pageSize : pageSize,\r\n        isPaginating: false,\r\n        pageRequestParams: null,\r\n        scrollTop: newScrollTop,\r\n        selectedRowKeys: this.getSelectedRowKeys()\r\n      });\r\n\r\n    } else if (\r\n      rowSelection &&\r\n      InfiniteScrollTable.isArrayPropertyChangedLazy(\r\n        prevProps.rowSelection.selectedRowKeys,\r\n        rowSelection.selectedRowKeys\r\n      )\r\n    ) {\r\n\r\n      this.setState({\r\n        selectedRowKeys: rowSelection.selectedRowKeys,\r\n      });\r\n      this.updateRenderedRows(rowSelection.selectedRowKeys);\r\n\r\n    } else if (prevProps.size && this.props.size && prevProps.size.width !== this.props.size.width) {\r\n\r\n      if (resizeTimeout) {\r\n        clearTimeout(resizeTimeout);\r\n      }\r\n\r\n      let newScrollTop = null;\r\n      const $grid = $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid`);\r\n      if ($grid) {\r\n        newScrollTop = $grid.scrollTop();\r\n      }\r\n\r\n      this.setState({\r\n        isResizing: true,\r\n        scrollTop: newScrollTop || scrollTop,\r\n        resizeTimeout: setTimeout(\r\n          () => {\r\n            this.setState(state => {\r\n\r\n              const {\r\n                populatedRows,\r\n                cols\r\n              } = state;\r\n\r\n              const colWidths = this.getColWidths(populatedRows, cols);\r\n              const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, this.getSelectedRowKeys());\r\n              const queriedRows = this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc);\r\n\r\n              return {\r\n                gridKeyForRefresh: uuidv4(),\r\n                isResizing: false,\r\n                resizeTimeout: null,\r\n                colWidths,\r\n                renderedRows,\r\n                queriedRows\r\n              };\r\n            });\r\n          },\r\n          RESIZE_TIMEOUT\r\n        )\r\n      });\r\n    }\r\n\r\n    const $grid =\r\n      $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid:not(.infinite-scroll-table__grid--with-event-handlers)`);\r\n\r\n    if ($grid.length) {\r\n\r\n      const _this = this;\r\n\r\n      $grid\r\n        .scrollLeft(scrollLeft)\r\n        .addClass('infinite-scroll-table__grid--with-event-handlers')\r\n        .on('scroll', function () {\r\n          const newScrollLeft = $(this).scrollLeft();\r\n          if (newScrollLeft !== _this.state.scrollLeft) {\r\n            $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__header`).scrollLeft(newScrollLeft);\r\n            _this.setState({\r\n              scrollLeft: newScrollLeft\r\n            });\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n\r\n    const {\r\n      uuid,\r\n      resizeTimeout,\r\n      pageRequestTimeout,\r\n      viewIndexesUpdateTimeout\r\n    } = this.state;\r\n\r\n    const $grid =\r\n      $(`.infinite-scroll-table__${uuid} .infinite-scroll-table__grid--with-event-handlers`);\r\n\r\n    if ($grid.length) {\r\n      $grid.off('scroll');\r\n    }\r\n\r\n    if (resizeTimeout) {\r\n      clearTimeout(resizeTimeout);\r\n    }\r\n\r\n    if (pageRequestTimeout) {\r\n      clearTimeout(pageRequestTimeout);\r\n    }\r\n\r\n    if (viewIndexesUpdateTimeout) {\r\n      clearTimeout(viewIndexesUpdateTimeout);\r\n    }\r\n\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n    if (this.state.gridKeyForRefresh === nextState.gridKeyForRefresh && this.state.scrollLeft !== nextState.scrollLeft) {\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n\r\n  /* === Event handlers === */\r\n\r\n  updateRenderedRows(selectedRowKeys) {\r\n\r\n    const {\r\n      populatedRows,\r\n      cols,\r\n      colWidths,\r\n      filters,\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const renderedRows = this.getRenderedRows(populatedRows, cols, colWidths, selectedRowKeys);\r\n\r\n    this.setState({\r\n      renderedRows,\r\n      queriedRows: this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc)\r\n    });\r\n  }\r\n\r\n  applyQueryChange(filters, searchText, sortCol, sortByDesc) {\r\n\r\n    const {\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      renderedRows,\r\n      cols,\r\n      queriedRows\r\n    } = this.state;\r\n\r\n    this.setState({\r\n      scrollTop: 0,\r\n      gridKeyForRefresh: uuidv4(),\r\n      queriedRows: isPaginated\r\n        ? queriedRows\r\n        : this.getQueriedRows(renderedRows, cols, filters, searchText, sortCol, sortByDesc)\r\n    });\r\n  }\r\n\r\n  onFiltersChange(dataIndex, value) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated,\r\n    } = this.props;\r\n\r\n    const {\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const newFilters = this.state.filters;\r\n\r\n    if (value !== null && value.length > 0) {\r\n      newFilters[dataIndex] = value;\r\n    } else {\r\n      delete newFilters[dataIndex];\r\n    }\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText,\r\n      filters: newFilters,\r\n      sortCol,\r\n      sortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      filters: newFilters,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n\r\n    this.applyQueryChange(newFilters, searchText, sortCol, sortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onSearchTextChange(value) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    const newSearchText = value;\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText: newSearchText,\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      searchText: newSearchText,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n    this.applyQueryChange(filters, newSearchText, sortCol, sortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onSortChange(colDataIndex, direction) {\r\n\r\n    const {\r\n      onChange,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      searchText,\r\n      filters\r\n    } = this.state;\r\n\r\n    const newSortCol = direction ? colDataIndex : null;\r\n    const newSortByDesc = direction === SORT_DIRECTION_DESC;\r\n\r\n    const newPageRequestParams = {\r\n      pageNum: DEFAULT_PAGE_NUM,\r\n      pageSize: DEFAULT_PAGE_SIZE,\r\n      searchText,\r\n      filters,\r\n      sortCol: newSortCol,\r\n      sortByDesc: newSortByDesc\r\n    };\r\n\r\n    this.setState({\r\n      sortCol: newSortCol,\r\n      sortByDesc: newSortByDesc,\r\n      isPaginating: isPaginated,\r\n      pageRequestParams: isPaginated ? newPageRequestParams : null,\r\n      doNotCallOnChangeOnNextRenderedRowsChange: isPaginated && onChange\r\n    });\r\n\r\n    this.applyQueryChange(filters, searchText, newSortCol, newSortByDesc);\r\n\r\n    if (onChange) {\r\n      onChange(newPageRequestParams);\r\n    }\r\n  }\r\n\r\n  onRowSelectionChange(rowKey, selected) {\r\n\r\n    const {\r\n      searchText,\r\n      sortCol,\r\n      sortByDesc,\r\n      filters,\r\n    } = this.state;\r\n\r\n    const {\r\n      rowSelection,\r\n      getRowKey,\r\n      getIsDisabledRow\r\n    } = this.props;\r\n\r\n    if (rowSelection && (rowSelection.onSelect || rowSelection.onSelectAll)) {\r\n\r\n      if (rowKey !== null && rowSelection.onSelect) {\r\n        rowSelection.onSelect(rowKey, selected);\r\n      }\r\n\r\n      if (rowKey === null && rowSelection.onSelectAll) {\r\n        rowSelection.onSelectAll(\r\n          selected,\r\n          {\r\n            searchText,\r\n            sortCol,\r\n            sortByDesc,\r\n            filters\r\n          }\r\n        );\r\n      }\r\n\r\n    } else {\r\n\r\n      const {\r\n        selectedRowKeys,\r\n        queriedRows\r\n      } = this.state;\r\n\r\n      let newSelectedRowKeys = null;\r\n\r\n      if (rowKey !== null) {\r\n        newSelectedRowKeys =\r\n          selected\r\n            ? [...selectedRowKeys, rowKey]\r\n            : selectedRowKeys.filter(selRowKey => selRowKey !== rowKey);\r\n      } else {\r\n        newSelectedRowKeys =\r\n          selected\r\n            ? queriedRows.map(row => row[DATA_INDEX_ORIGINAL_ROW]).filter(row => !getIsDisabledRow || !getIsDisabledRow(row)).map(row => getRowKey(row))\r\n            : [];\r\n      }\r\n\r\n      if (rowSelection && rowSelection.onChange) {\r\n        rowSelection.onChange(newSelectedRowKeys);\r\n      }\r\n\r\n      this.setState({\r\n        selectedRowKeys: newSelectedRowKeys,\r\n      });\r\n      this.updateRenderedRows(newSelectedRowKeys);\r\n    }\r\n  }\r\n\r\n  /* === Getters === */\r\n\r\n  getCols() {\r\n\r\n    const {\r\n      columns,\r\n      rowSelection\r\n    } = this.props;\r\n\r\n    if (columns === null) {\r\n      return null;\r\n    } else {\r\n\r\n      let res = columns.filter(col => col !== null);\r\n\r\n      if (rowSelection || this.getNormalizedTableActions().length > 0) {\r\n\r\n        res = [\r\n          {\r\n            dataIndex: DATA_INDEX_CHECKED,\r\n            render: this.renderCheckbox,\r\n            titleRender: this.renderCheckboxTitle,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            width: CHECKBOX_WIDTH,\r\n            renderText: () => \"\"\r\n          },\r\n          ...res\r\n        ];\r\n      }\r\n\r\n      if (this.getNormalizedFixedActions().length > 0) {\r\n        res = [\r\n          ...res,\r\n          {\r\n            dataIndex: DATA_INDEX_FIXED_ACTIONS_OBJS,\r\n            render: this.renderFixedActions,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            disableOnRowClickForCell: true,\r\n            renderText: () => \"\",\r\n            width: this.getNormalizedFixedActions().length * (ACTION_WIDTH + ACTIONS_GUTTER) - ACTIONS_GUTTER + COL_WIDTH_SAFE + 2 * CELL_PADDING\r\n          }\r\n        ];\r\n      }\r\n\r\n      if (this.getNormalizedActions().length > 0 || this.getNormalizedAltActions().length > 0) {\r\n        res = [\r\n          ...res,\r\n          {\r\n            dataIndex: DATA_INDEX_ACTIONS_OBJS,\r\n            render: this.renderActions,\r\n            noSearchText: true,\r\n            noFilter: true,\r\n            noSort: true,\r\n            disableOnRowClickForCell: true,\r\n            renderText: () => \"\",\r\n            width: Math.max(this.getNormalizedActions().length, this.getNormalizedAltActions().length) * (ACTION_WIDTH + ACTIONS_GUTTER) - ACTIONS_GUTTER + COL_WIDTH_SAFE + 2 * CELL_PADDING\r\n          }\r\n        ];\r\n      }\r\n\r\n      return res;\r\n    }\r\n  }\r\n\r\n  getNormalizedTableActions() {\r\n\r\n    const {\r\n      tableActions\r\n    } = this.props;\r\n\r\n    return (tableActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedActions() {\r\n\r\n    const {\r\n      actions\r\n    } = this.props;\r\n\r\n    return (actions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedAltActions() {\r\n\r\n    const {\r\n      altActions\r\n    } = this.props;\r\n\r\n    return (altActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getNormalizedFixedActions() {\r\n\r\n    const {\r\n      fixedActions\r\n    } = this.props;\r\n\r\n    return (fixedActions || []).filter(action => action !== null);\r\n  }\r\n\r\n  getSelectedRowKeys() {\r\n\r\n    const {\r\n      rowSelection\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return rowSelection && rowSelection.selectedRowKeys\r\n      ? rowSelection.selectedRowKeys\r\n      : selectedRowKeys;\r\n  }\r\n\r\n  /* === Data manipulation === */\r\n\r\n  getFilteredGridRows(rows, cols, filters) {\r\n\r\n    return Object.keys(filters).length > 0\r\n      ? rows.filter(row => {\r\n\r\n        for (let dataIndex in filters) {\r\n          if (filters.hasOwnProperty(dataIndex)) {\r\n\r\n            const col = cols.find(col => col.dataIndex === dataIndex);\r\n\r\n            const testPassed =\r\n              col.withValuesFilter\r\n                ? filters[dataIndex].includes(row[dataIndex])\r\n                : (\r\n                  InfiniteScrollTable.isValuePassingSearchText(\r\n                    col.renderText\r\n                      ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][dataIndex])\r\n                      : row[dataIndex],\r\n                    filters[dataIndex]\r\n                  )\r\n                );\r\n\r\n            if (!testPassed) {\r\n              return false;\r\n            }\r\n\r\n          }\r\n        }\r\n\r\n        return true;\r\n\r\n      })\r\n      : rows;\r\n  }\r\n\r\n  getSearchTextFilteredGridRows(rows, cols, searchText) {\r\n\r\n    return searchText !== null\r\n      ? (\r\n        rows !== null\r\n          ? rows.filter(row => {\r\n            for (let col of cols) {\r\n              if (!col.noSearchText && typeof (row[col.dataIndex]) !== 'boolean' &&\r\n                InfiniteScrollTable.isValuePassingSearchText(\r\n                  col.renderText\r\n                    ? col.renderText(row[DATA_INDEX_ORIGINAL_ROW][col.dataIndex])\r\n                    : row[col.dataIndex],\r\n                  searchText\r\n                )) {\r\n                return true;\r\n              }\r\n            }\r\n            return false;\r\n          })\r\n          : null\r\n      )\r\n      : rows;\r\n  }\r\n\r\n  getSortedGridRows(rows, cols, sortCol, sortByDesc) {\r\n\r\n    const column = sortCol !== null ? cols.find(col => col.dataIndex === sortCol) : null;\r\n\r\n    return column\r\n      ? rows.sort((a, b) => {\r\n        const _a =\r\n          column.renderText\r\n            ? column.renderText(a[DATA_INDEX_ORIGINAL_ROW][column.dataIndex])\r\n            : a[column.dataIndex];\r\n        const _b =\r\n          column.renderText\r\n            ? column.renderText(b[DATA_INDEX_ORIGINAL_ROW][column.dataIndex])\r\n            : b[column.dataIndex];\r\n        return (\r\n          column.sorter\r\n            ? column.sorter(_a, _b) * (sortByDesc ? -1 : 1)\r\n            : InfiniteScrollTable.defaultSorter(_a, _b, sortByDesc)\r\n        );\r\n      })\r\n      : rows;\r\n  }\r\n\r\n  /* === Rendering ==== */\r\n\r\n  renderGridRow(row, cols, colWidths) {\r\n\r\n    const {\r\n      onRowClick,\r\n      getIsDisabledRow,\r\n      getRowStyle\r\n    } = this.props;\r\n\r\n    return (\r\n      <div className=\"infinite-scroll-table__grid__row\" style={{width: \"100%\", height: ROW_HEIGHT}}>\r\n        {cols.map((col, colIndex) => {\r\n          const cellData = row[col.dataIndex];\r\n          const isRowClickDisabled =\r\n            !onRowClick || col.disableOnRowClickForCell ||\r\n            (getIsDisabledRow && getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW]));\r\n          let colLeftAttr = 0;\r\n          cols\r\n            .slice(0, colIndex)\r\n            .map((_, index) => index)\r\n            .forEach(index => colLeftAttr += colWidths[index]);\r\n          const rowStyle = getRowStyle ? getRowStyle(row[DATA_INDEX_ORIGINAL_ROW]) : null;\r\n          return (\r\n            <Tooltip key={colIndex} title={col.renderText ? col.renderText(cellData) : cellData}>\r\n              <div\r\n                className={\r\n                  'infinite-scroll-table__grid__cell' +\r\n                  (getIsDisabledRow && getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW])\r\n                    ? ' infinite-scroll-table__grid__cell--disabled'\r\n                    : '')\r\n                }\r\n                style={{\r\n                  position: \"absolute\",\r\n                  width: colWidths[colIndex],\r\n                  height: ROW_HEIGHT,\r\n                  lineHeight: `${ROW_HEIGHT - CELL_PADDING - CELL_PADDING}px`,\r\n                  top: 0,\r\n                  left: colLeftAttr,\r\n                  cursor: !isRowClickDisabled ? \"pointer\" : null,\r\n                  ...rowStyle\r\n                }}\r\n                onClick={!isRowClickDisabled ? () => onRowClick(row[DATA_INDEX_ORIGINAL_TRANSLATED_ROW]) : null}\r\n              >\r\n                {col.render\r\n                  ? col.render(cellData, row[DATA_INDEX_ORIGINAL_ROW])\r\n                  : cellData\r\n                }\r\n              </div>\r\n            </Tooltip>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderHeaderCells(cols, columnWidths, rows) {\r\n\r\n    const {\r\n      data\r\n    } = this.props;\r\n\r\n    const {\r\n      filters,\r\n      sortCol,\r\n      sortByDesc\r\n    } = this.state;\r\n\r\n    return (cols || []).map((col, index) =>\r\n      <div\r\n        key={index}\r\n        className=\"infinite-scroll-table__header__cell\"\r\n        style={{\r\n          width: columnWidths[index],\r\n          height: ROW_HEIGHT,\r\n          padding: HEADER_CELL_PADDING\r\n        }}\r\n      >\r\n        <Grid container justify=\"space-between\">\r\n          {(col.title || col.titleRender) && (\r\n            <Grid item style={{marginRight: (!col.noFilter || !col.noSort) ? HEADER_CELL_GUTTER : 0}}>\r\n              <div\r\n                style={{\r\n                  height: (ROW_HEIGHT - (2 * HEADER_CELL_PADDING)),\r\n                  lineHeight: `${(ROW_HEIGHT - (2 * HEADER_CELL_PADDING))}px`,\r\n                  textAlign: \"center\"\r\n                }}\r\n              >\r\n                {col.titleRender ? col.titleRender(rows) : col.title}\r\n              </div>\r\n            </Grid>\r\n          )}\r\n          {(!col.noFilter || !col.noSort)\r\n            ? (\r\n              <Grid item>\r\n                <Grid container>\r\n                  {!col.noSort && (\r\n                    <Grid item style={{marginRight: !col.noFilter ? HEADER_CELL_CONTROLS_GUTTER : 0}}>\r\n                      <SortButtons\r\n                        value={\r\n                          col.dataIndex === sortCol\r\n                            ? (sortByDesc ? SORT_DIRECTION_DESC : SORT_DIRECTION_ASC)\r\n                            : null\r\n                        }\r\n                        onChange={value => this.onSortChange(col.dataIndex, value)}\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                  {!col.noFilter && (\r\n                    <Grid item>\r\n                      <FilterButton\r\n                        value={filters[col.dataIndex]}\r\n                        onChange={value => this.onFiltersChange(col.dataIndex, value)}\r\n                        options={\r\n                          col.withValuesFilter\r\n                            ? (\r\n                              _.uniq(\r\n                                (data || []).map(row => row[col.dataIndex])\r\n                              ).map(option => ({\r\n                                value: option,\r\n                                text: col.renderText\r\n                                  ? col.renderText(option)\r\n                                  : option\r\n                              })).sort((a, b) =>\r\n                                col.sorter\r\n                                  ? col.sorter(a.text, b.text)\r\n                                  : InfiniteScrollTable.defaultSorter(a.text, b.text)\r\n                              )\r\n                            )\r\n                            : null\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n            )\r\n            : <span/>\r\n          }\r\n        </Grid>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderFixedActions(actions) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return (\r\n      <Grid container>\r\n        {(actions || []).map((action, index) =>\r\n          <Grid item key={index} style={{marginLeft: index === 0 ? 0 : ACTIONS_GUTTER}}>\r\n            <Tooltip title={action.title}>\r\n              <IconButton\r\n                {...action}\r\n                key={index}\r\n                size=\"small\"\r\n                onClick={\r\n                  e => {\r\n                    e.stopPropagation();\r\n                    action.onClick(\r\n                      action.row,\r\n                      () => this.setState({\r\n                        selectedRowKeys: selectedRowKeys.filter(key => key !== getRowKey(action.row))\r\n                      })\r\n                    );\r\n                  }}\r\n              >\r\n                {action.icon}\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  renderActions(actions) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    const {\r\n      selectedRowKeys\r\n    } = this.state;\r\n\r\n    return (\r\n      <Grid\r\n        container\r\n        className=\"infinite-scroll-table__grid__cell__actions-container\"\r\n        justify=\"flex-end\"\r\n      >\r\n        {(actions || []).map((action, index) =>\r\n          <Grid item key={index} style={{marginLeft: index === 0 ? 0 : ACTIONS_GUTTER}}>\r\n            <Tooltip title={action.title}>\r\n              <IconButton\r\n                className={`infinite-scroll-table__grid__cell__action ${action.className || \"\"}`}\r\n                style={{\r\n                  width: ACTION_WIDTH,\r\n                  height: ACTION_WIDTH,\r\n                  padding: 0\r\n                }}\r\n                disabled={action.disabled}\r\n                onClick={\r\n                  e => {\r\n                    e.stopPropagation();\r\n                    action.onClick(\r\n                      action.row,\r\n                      () => this.setState({\r\n                        selectedRowKeys: selectedRowKeys.filter(key => key !== getRowKey(action.row))\r\n                      })\r\n                    );\r\n                  }}\r\n              >\r\n                {action.icon}\r\n              </IconButton>\r\n            </Tooltip>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  renderTableAction(action, rows) {\r\n\r\n    const {\r\n      getRowKey\r\n    } = this.props;\r\n\r\n    return (\r\n      <Button\r\n        type=\"primary\"\r\n        className={action.className}\r\n        startIcon={action.icon}\r\n        title={action.title}\r\n        disabled={action.disabled}\r\n        onClick={\r\n          e => {\r\n            e.stopPropagation();\r\n            action.onClick(\r\n              rows.filter(row => this.getSelectedRowKeys().includes(getRowKey(row[DATA_INDEX_ORIGINAL_ROW]))),\r\n              () => this.onRowSelectionChange(null, false)\r\n            )\r\n          }}\r\n      >\r\n        {action.title}\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  renderCheckbox(checked, row) {\r\n    const {\r\n      getRowKey,\r\n      rowSelection,\r\n      getIsDisabledRow\r\n    } = this.props;\r\n\r\n    const checkboxProps =\r\n      rowSelection && rowSelection.getCheckboxProps\r\n        ? rowSelection.getCheckboxProps(row)\r\n        : ({\r\n          disabled: getIsDisabledRow && getIsDisabledRow(row)\r\n        });\r\n\r\n    return (\r\n      <Checkbox\r\n        checked={checked}\r\n        onChange={e => {\r\n          e.stopPropagation();\r\n          this.onRowSelectionChange(getRowKey(row), !checked)\r\n        }}\r\n        style={{padding: 0}}\r\n        {...checkboxProps}\r\n      />\r\n    );\r\n  }\r\n\r\n  renderCheckboxTitle(rows) {\r\n    const {\r\n      getRowKey,\r\n      getIsDisabledRow\r\n    } = this.props;\r\n\r\n    const selectedRowKeys = this.getSelectedRowKeys();\r\n\r\n    const checked =\r\n      rows !== null &&\r\n      rows.length > 0 &&\r\n      rows\r\n        .filter(row => !getIsDisabledRow || !getIsDisabledRow(row[DATA_INDEX_ORIGINAL_ROW]))\r\n        .map(row => getRowKey(row[DATA_INDEX_ORIGINAL_ROW]))\r\n        .filter(rowKey => !selectedRowKeys.includes(rowKey))\r\n        .length === 0;\r\n\r\n    return (\r\n      <Checkbox\r\n        checked={checked}\r\n        onChange={() => this.onRowSelectionChange(null, !checked)}\r\n        style={{padding: 0}}\r\n      />\r\n    );\r\n  }\r\n\r\n  onRenderedRowsChange(viewStartIdx, viewEndIdx, overscanStartIdx, overscanEndIdx) {\r\n\r\n    const {\r\n      onChange,\r\n      rowCount,\r\n      isPaginated\r\n    } = this.props;\r\n\r\n    const {\r\n      pageRequestTimeout,\r\n      pageSize,\r\n      pageNum,\r\n      isPaginating,\r\n      viewIndexesUpdateTimeout,\r\n      doNotCallOnChangeOnNextRenderedRowsChange\r\n    } = this.state;\r\n\r\n    if (viewIndexesUpdateTimeout) {\r\n      clearTimeout(viewIndexesUpdateTimeout);\r\n    }\r\n\r\n    this.setState({\r\n      viewIndexesUpdateTimeout: setTimeout(\r\n        () => this.setState({\r\n          viewStartIdx,\r\n          viewEndIdx,\r\n          viewIndexesUpdateTimeout: null\r\n        }),\r\n        VIEW_INDEXES_UPDATE_TIMEOUT\r\n      )\r\n    });\r\n\r\n    if (isPaginated && !doNotCallOnChangeOnNextRenderedRowsChange) {\r\n\r\n      const currentPageIndexes = getIndexesFromPaginationParams(\r\n        pageSize || DEFAULT_PAGE_SIZE,\r\n        pageNum || DEFAULT_PAGE_NUM\r\n      );\r\n\r\n      if (\r\n        isPaginating ||\r\n        (overscanStartIdx < currentPageIndexes.startIdx || overscanEndIdx > currentPageIndexes.stopIdx)\r\n      ) {\r\n\r\n        if (pageRequestTimeout !== null) {\r\n          clearTimeout(pageRequestTimeout);\r\n        }\r\n\r\n        const safePageSize = MAX_PAGE_SIZE / 2; // getPaginationParamsFromIndexes can double the size of a page\r\n        const pageRowsThird = Math.floor(safePageSize / 3);\r\n        const newPaginationParams =\r\n          getPaginationParamsFromIndexes(\r\n            Math.max(overscanStartIdx - pageRowsThird, 0),\r\n            Math.min(overscanStartIdx + 2 * pageRowsThird - 1, rowCount - 1),\r\n            rowCount\r\n          );\r\n\r\n        const newPageRequestParams = {\r\n          pageSize: newPaginationParams.pageSize,\r\n          pageNum: newPaginationParams.pageNum,\r\n          filters: this.state.filters,\r\n          searchText: this.state.searchText,\r\n          sortCol: this.state.sortCol,\r\n          sortByDesc: this.state.sortByDesc\r\n        };\r\n\r\n        this.setState({\r\n          isPaginating: true,\r\n          pageRequestTimeout: setTimeout(\r\n            () => {\r\n              onChange(newPageRequestParams);\r\n              this.setState({\r\n                pageRequestParams: newPageRequestParams\r\n              })\r\n            },\r\n            PAGINATION_TIMEOUT\r\n          )\r\n        });\r\n      }\r\n    } else if (isPaginated) {\r\n      this.setState({\r\n        doNotCallOnChangeOnNextRenderedRowsChange: false\r\n      });\r\n    }\r\n  }\r\n\r\n  getIsVerticalScrollbarVisible(rowNum) {\r\n\r\n    const {\r\n      height = DEFAULT_TABLE_HEIGHT\r\n    } = this.props;\r\n\r\n    return rowNum * ROW_HEIGHT > height;\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      t,\r\n      size,\r\n      leftActions,\r\n      rightActions,\r\n      showHeader = true,\r\n      rowCount,\r\n      isPaginated = false,\r\n      height = DEFAULT_TABLE_HEIGHT,\r\n      selectedRowCount,\r\n      autoSearch = true\r\n    } = this.props;\r\n\r\n    const {\r\n      uuid,\r\n      cols,\r\n      gridKeyForRefresh,\r\n      scrollTop,\r\n      gridScrollbarWidth,\r\n      populatedRows,\r\n      queriedRows,\r\n      isResizing,\r\n      colWidths,\r\n      pageSize,\r\n      pageNum,\r\n      isPaginating,\r\n      viewStartIdx,\r\n      viewEndIdx,\r\n      viewIndexesUpdateTimeout,\r\n      searchText\r\n    } = this.state;\r\n\r\n    const currentPageIndexes = getIndexesFromPaginationParams(\r\n      pageSize || DEFAULT_PAGE_SIZE,\r\n      pageNum || DEFAULT_PAGE_NUM\r\n    );\r\n\r\n    return (\r\n      <div className={`infinite-scroll-table infinite-scroll-table__${uuid}`}>\r\n        <PreHeader\r\n          searchText={searchText}\r\n          autoSearch={autoSearch}\r\n          onSearch={this.onSearchTextChange}\r\n          selectedRowCount={selectedRowCount ? selectedRowCount : this.getSelectedRowKeys().length}\r\n          tableActions={this.getNormalizedTableActions()}\r\n          renderTableAction={action => this.renderTableAction(action, populatedRows)}\r\n          leftActions={leftActions}\r\n          rightActions={rightActions}\r\n        />\r\n        <Fragment>\r\n          {showHeader && (\r\n            isResizing\r\n              ? <div className=\"infinite-scroll-table__header-placeholder\" style={{height: ROW_HEIGHT}}/>\r\n              : (\r\n                <div className=\"infinite-scroll-table__header\" style={{height: ROW_HEIGHT}}>\r\n                  {queriedRows !== null\r\n                    ? (\r\n                      <Fragment>\r\n                        <div className=\"infinite-scroll-table__header__cells-container\">\r\n                          {this.renderHeaderCells(cols, colWidths, queriedRows)}\r\n                        </div>\r\n                        <div\r\n                          className=\"infinite-scroll-table__header__scrollbar-padding\"\r\n                          style={{width: gridScrollbarWidth, height: ROW_HEIGHT}}\r\n                        >\r\n                        </div>\r\n                      </Fragment>\r\n                    )\r\n                    : (\r\n                      <div\r\n                        className=\"infinite-scroll-table__header-placeholder\"\r\n                        style={{height: ROW_HEIGHT, width: size.width}}\r\n                      />\r\n                    )\r\n                  }\r\n                </div>\r\n              )\r\n          )}\r\n          {isResizing || queriedRows === null || queriedRows.length === 0\r\n            ? (\r\n              <div style={{height}} className=\"infinite-scroll-table__grid-container-placeholder\">\r\n                <CustomEmpty\r\n                  width={(!isResizing && queriedRows !== null) ? _.sum(colWidths) : undefined}\r\n                  text={\r\n                    isResizing\r\n                      ? t(\"components.infiniteScrollTable.resizing\") + \"...\"\r\n                      : (\r\n                        queriedRows === null\r\n                          ? t(\"components.infiniteScrollTable.updating\") + \"...\"\r\n                          : undefined\r\n                      )}\r\n                  image={isResizing\r\n                    ? <CircularProgress/>\r\n                    : <span/>\r\n                  }\r\n                />\r\n              </div>\r\n            )\r\n            : (\r\n              <div className=\"infinite-scroll-table__grid-container\" style={{position: \"relative\", height}}>\r\n                {isPaginating && (\r\n                  <div\r\n                    style={{\r\n                      position: \"absolute\",\r\n                      width: Math.min(_.sum(colWidths), size.width),\r\n                      height,\r\n                    }}\r\n                  >\r\n                    <CustomEmpty\r\n                      text={t(\"components.infiniteScrollTable.updating\") + \"...\"}\r\n                    />\r\n                  </div>\r\n                )}\r\n                <FixedSizeList\r\n                  className=\"infinite-scroll-table__grid\"\r\n                  key={gridKeyForRefresh}\r\n                  width={size.width}\r\n                  height={height}\r\n                  itemSize={ROW_HEIGHT}\r\n                  itemCount={rowCount || queriedRows.length}\r\n                  initialScrollOffset={scrollTop}\r\n                  onItemsRendered={\r\n                    ({visibleStartIndex, visibleStopIndex, overscanStartIndex, overscanStopIndex}) =>\r\n                      this.onRenderedRowsChange(\r\n                        visibleStartIndex,\r\n                        visibleStopIndex,\r\n                        overscanStartIndex,\r\n                        overscanStopIndex\r\n                      )\r\n                  }\r\n                >\r\n                  {({index, style}) =>\r\n                    <div\r\n                      style={{...style, width: _.sum(colWidths)}}\r\n                      className={`infinite-scroll-table__grid__row infinite-scroll-table__grid__row--${index % 2 ? 'odd' : 'even'}`}\r\n                    >\r\n                      {\r\n                        !isPaginated ||\r\n                        (\r\n                          !isPaginating &&\r\n                          currentPageIndexes.startIdx <= index &&\r\n                          index <= currentPageIndexes.stopIdx &&\r\n                          (index - currentPageIndexes.startIdx < queriedRows.length)\r\n                        )\r\n                          ? (\r\n                            queriedRows[\r\n                              isPaginated\r\n                                ? (index - currentPageIndexes.startIdx)\r\n                                : index\r\n                              ][DATA_INDEX_RENDERED]\r\n                          )\r\n                          : <span/>\r\n                      }\r\n                    </div>\r\n                  }\r\n                </FixedSizeList>\r\n              </div>\r\n            )}\r\n          <Footer\r\n            isHidden={queriedRows === null || queriedRows.length === 0}\r\n            isLoading={isPaginating || viewIndexesUpdateTimeout}\r\n            rowNumStart={viewStartIdx + 1}\r\n            rowNumEnd={viewEndIdx + 1}\r\n            rowCount={rowCount || (queriedRows ? queriedRows.length : null)}\r\n          />\r\n        </Fragment>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withSize(),\r\n  withTranslation(),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(InfiniteScrollTable);\r\n","import React from 'react';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\n\r\nconst iconStyle = {\r\n  cursor: 'pointer'\r\n};\r\n\r\n/* Based on https://ant.design/components/form/#components-form-demo-customized-form-controls */\r\nclass Selector extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      value: null\r\n    };\r\n    this.callOnChange = this.callOnChange.bind(this);\r\n  }\r\n\r\n  static getDerivedStateFromProps(nextProps, state) {\r\n    if (nextProps.value !== state.value) {\r\n      return {\r\n        value: nextProps.value\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  callOnChange(value) {\r\n    if (this.props.onChange) {\r\n      this.props.onChange(value);\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      disabled,\r\n      detailTitle,\r\n      selectTitle,\r\n      resetTitle,\r\n      onDetail,\r\n      onSelect,\r\n      onReset,\r\n      render,\r\n      variant,\r\n      className\r\n    } = this.props;\r\n\r\n    const {\r\n      value\r\n    } = this.state;\r\n\r\n    return (\r\n      <TextField\r\n        value={render ? render(value) : value}\r\n        onChange={f => f}\r\n        variant={variant || \"outlined\"}\r\n        InputProps={{\r\n          readOnly: true,\r\n          endAdornment: disabled\r\n            ? undefined\r\n            : value !== null\r\n              ? resetTitle\r\n                ? (\r\n                  <Tooltip title={resetTitle}>\r\n                    <CloseIcon onClick={onReset} style={iconStyle}/>\r\n                  </Tooltip>\r\n                )\r\n                : <CloseIcon onClick={onReset} style={iconStyle}/>\r\n              : selectTitle\r\n                ? (\r\n                  <Tooltip title={selectTitle}>\r\n                    <AddIcon onClick={onSelect} style={iconStyle}/>\r\n                  </Tooltip>\r\n                )\r\n                : <AddIcon onClick={onSelect} style={iconStyle}/>,\r\n          startAdornment: (onDetail && value !== null)\r\n            ? detailTitle\r\n              ? (\r\n                <Tooltip title={detailTitle}>\r\n                  <VisibilityIcon onClick={onDetail} style={iconStyle}/>\r\n                </Tooltip>\r\n              )\r\n              : <VisibilityIcon onClick={onDetail} style={iconStyle}/>\r\n            : undefined\r\n        }}\r\n        className={className}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Selector;\r\n","import React, {useState} from 'react';\r\nimport {TextField} from \"@material-ui/core\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport {connect} from \"react-redux\";\r\nimport _ from \"lodash\";\r\n\r\nconst ON_CHANGE_TIMEOUT = 500;\r\n\r\nconst getInitialInternalValue = (value, languages) => {\r\n  const emptyValue = {};\r\n  languages.forEach(lang => emptyValue[lang] = \"\");\r\n\r\n  return _.merge(emptyValue, value)\r\n};\r\n\r\nconst Component = ({\r\n                     textFieldProps,\r\n                     defaultLanguage,\r\n                     languages\r\n                   }) => {\r\n\r\n  const [language, setLanguage] = useState(defaultLanguage);\r\n  const [internalValue, setInternalValue] = useState(getInitialInternalValue(textFieldProps.value, languages));\r\n  const [timeoutId, setTimeoutId] = useState(null);\r\n\r\n  const callOnChange = value => {\r\n    if (textFieldProps.onChange) {\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId)\r\n      }\r\n      setTimeoutId(setTimeout(\r\n        () => {\r\n          textFieldProps.onChange(value);\r\n        },\r\n        ON_CHANGE_TIMEOUT\r\n      ));\r\n    }\r\n  };\r\n\r\n  const setValueForLanguage = value => {\r\n    let newInternalValue = _.cloneDeep(internalValue);\r\n    newInternalValue[language] = value;\r\n\r\n    setInternalValue(newInternalValue);\r\n    callOnChange(newInternalValue);\r\n  };\r\n\r\n  return (\r\n    <TextField\r\n      {...textFieldProps}\r\n      value={(internalValue && internalValue[language])\r\n        ? internalValue[language]\r\n        : \"\"\r\n      }\r\n      onChange={({target}) => setValueForLanguage(target.value)}\r\n      InputProps={{\r\n        startAdornment: (\r\n          <InputAdornment position=\"start\">\r\n            <I18nInputAdornmentSelect value={language} onChange={lang => setLanguage(lang)}/>\r\n          </InputAdornment>\r\n        )\r\n      }}\r\n    >\r\n      {textFieldProps.children}\r\n    </TextField>\r\n  );\r\n};\r\n\r\nconst ConnectedComponent =\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))(Component);\r\n\r\nconst I18nDelayedTextField = props =>\r\n  <ConnectedComponent textFieldProps={props}/>;\r\n\r\nexport default I18nDelayedTextField;","export const getDashboardDynamicFilterLabelTranslations = t => {\r\n\r\n  const translations = t => ({\r\n    Region: t('dashboards.dynamicFilterLabels.region'),\r\n    Province: t('dashboards.dynamicFilterLabels.province'),\r\n    Municipality: t('dashboards.dynamicFilterLabels.municipality'),\r\n  });\r\n\r\n  return translations(t !== undefined ? t : str => str);\r\n};\r\n","import React, {Fragment, useState} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport _ from \"lodash\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport EditIcon from '@material-ui/icons/Edit';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport Selector from \"../selector\";\r\nimport {\r\n  DASHBOARD_ELEM_ENABLE_FILTERS_KEY,\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_SHOW_TITLE_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_TEXT,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  DASHBOARD_ELEM_WIDTH_KEY,\r\n  emptyDashboardElem\r\n} from \"../../utils/dashboards\";\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport I18nDelayedTextField from \"../i18n-delayed-text-field\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport I18nHtmlEditor from \"../i18n-html-editor\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport filters from \"../../dummy/filters.json\";\r\nimport {getDashboardDynamicFilterLabelTranslations} from \"../../constants/getDashboardDynamicFilterLabelTranslations\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst MAX_VIEW_PER_ROW = 4;\r\n\r\nconst ROW_ACTION_WIDTH = 48;\r\nconst COL_ACTION_WIDTH = 48;\r\nconst VIEW_ACTION_WIDTH = 48;\r\n\r\nconst styles = theme => ({\r\n  filterLevels: {\r\n    fontSize: 16\r\n  },\r\n  rowContainer: {\r\n    width: \"100%\",\r\n    marginTop: 8\r\n  },\r\n  row: {\r\n    width: `calc(100% - ${2 * ROW_ACTION_WIDTH}px)`,\r\n    height: 164,\r\n    display: \"inline-block\"\r\n  },\r\n  rowActions: {\r\n    width: (2 * ROW_ACTION_WIDTH),\r\n    display: \"inline-block\",\r\n    margin: \"5px 0\"\r\n  },\r\n  rowAction: {\r\n    width: ROW_ACTION_WIDTH\r\n  },\r\n  colContainer: {\r\n    border: \"1px solid rgba(0, 0, 0, 0.2)\",\r\n    marginRight: 8,\r\n    padding: 16,\r\n    height: \"100%\",\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  col: {\r\n    width: `calc(100% - ${COL_ACTION_WIDTH}px)`,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  colActions: {\r\n    width: COL_ACTION_WIDTH,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  viewContainer: {\r\n    width: \"100%\"\r\n  },\r\n  view: {\r\n    width: `calc(100% - ${VIEW_ACTION_WIDTH + 4}px)`,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  viewAction: {\r\n    width: VIEW_ACTION_WIDTH,\r\n    marginLeft: 4,\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  input: {\r\n    width: \"100%\",\r\n    \"& > div\": {\r\n      width: \"100%\"\r\n    },\r\n    \"& input\": {\r\n      padding: 10,\r\n      height: 20\r\n    },\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\"\r\n  },\r\n  dynamicViewInput: {\r\n    marginLeft: 16,\r\n    \"& input\": {\r\n      padding: 10,\r\n      height: 20\r\n    }\r\n  },\r\n  htmlInput: {\r\n    \"& > div\": {\r\n      height: 130\r\n    }\r\n  },\r\n  formLabel: {\r\n    marginLeft: 0,\r\n    marginRight: 0\r\n  }\r\n});\r\n\r\nconst getStrippedHtmlText = html => {\r\n  const $span = $('<span>').get(0);\r\n\r\n  $span.innerHTML = html;\r\n  const text = $span.textContent || $span.innerText || \"\";\r\n\r\n  $($span).remove();\r\n\r\n  return text;\r\n}\r\n\r\nconst DashboardBuilderCol = ({\r\n                               t,\r\n                               classes,\r\n                               defaultLanguage,\r\n                               languages,\r\n                               dashboard,\r\n                               rowIdx,\r\n                               colIdx,\r\n                               col,\r\n                               onColRemove,\r\n                               onTypeReset,\r\n                               fetchViews,\r\n                               onViewReset,\r\n                               onTextEdit,\r\n                               onShowTitleChange,\r\n                               onEnableFiltersChange,\r\n                               onFilterDimensionChange\r\n                             }) =>\r\n  <div\r\n    className={classes.colContainer}\r\n    style={{width: `calc(${col[DASHBOARD_ELEM_WIDTH_KEY]}% - ${2 * 4}px)`}}\r\n  >\r\n    <div className={classes.col}>\r\n      {col[DASHBOARD_ELEM_TYPE_KEY] === null\r\n        ? (\r\n          <Grid container justify=\"center\" style={{margin: \"47px 0\"}}>\r\n            <Grid item>\r\n              <Button onClick={() => fetchViews(rowIdx, colIdx)}>\r\n                {t(\"components.dashboardBuilder.actions.addView\")}\r\n              </Button>\r\n            </Grid>\r\n            <Grid item>\r\n              <Button onClick={() => onTextEdit(rowIdx, colIdx, \"\")}>\r\n                {t(\"components.dashboardBuilder.actions.addText\")}\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        )\r\n        : (\r\n          <div className={classes.viewContainer}>\r\n            <div className={classes.view}>\r\n              {col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW\r\n                ? (\r\n                  <Grid container>\r\n                    <Grid item xs={12} style={{marginBottom: 8}}>\r\n                      <Selector\r\n                        value={col[DASHBOARD_ELEM_VALUE_KEY] ? dashboard.views[col[DASHBOARD_ELEM_VALUE_KEY]] : null}\r\n                        render={view => view?.title ? localizeI18nObj(view.title, defaultLanguage, languages) : \"\"}\r\n                        variant=\"standard\"\r\n                        className={classes.input}\r\n                        selectTitle={t(\"components.dashboardBuilder.actions.selectView\")}\r\n                        onSelect={() => fetchViews(rowIdx, colIdx)}\r\n                        resetTitle={t(\"components.dashboardBuilder.actions.deselectView\")}\r\n                        onReset={() => onViewReset(rowIdx, colIdx, col[DASHBOARD_ELEM_VALUE_KEY])}\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={12}>\r\n                      <Grid container>\r\n                        <Grid item style={{marginRight: 8}}>\r\n                          <FormControlLabel\r\n                            className={classes.formLabel}\r\n                            label={t(\"components.dashboardBuilder.actions.showTitle\")}\r\n                            control={\r\n                              <Checkbox\r\n                                style={{padding: 5}}\r\n                                checked={col[DASHBOARD_ELEM_SHOW_TITLE_KEY]}\r\n                                onChange={(ev, checked) => onShowTitleChange(rowIdx, colIdx, checked)}\r\n                              />\r\n                            }\r\n                          />\r\n                        </Grid>\r\n                        <Grid item>\r\n                          <FormControlLabel\r\n                            className={classes.formLabel}\r\n                            label={t(\"components.dashboardBuilder.actions.enableFilters\")}\r\n                            control={\r\n                              <Checkbox\r\n                                style={{padding: 5}}\r\n                                checked={col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY]}\r\n                                onChange={(ev, checked) => onEnableFiltersChange(rowIdx, colIdx, checked)}\r\n                              />\r\n                            }\r\n                          />\r\n                        </Grid>\r\n                      </Grid>\r\n                    </Grid>\r\n                    <Grid item xs={12} style={{marginTop: 8}}>\r\n                      <FormControlLabel\r\n                        className={classes.formLabel}\r\n                        style={{marginLeft: 8}}\r\n                        label={t(\"components.dashboardBuilder.filterDimension.label\") + \":\"}\r\n                        labelPlacement=\"start\"\r\n                        control={\r\n                          <TextField\r\n                            value={col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || \"\"}\r\n                            placeholder={t(\"components.dashboardBuilder.filterDimension.noOne\")}\r\n                            className={classes.dynamicViewInput}\r\n                            variant=\"outlined\"\r\n                            onChange={({target}) => onFilterDimensionChange(rowIdx, colIdx, target.value)}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  </Grid>\r\n                )\r\n                : (\r\n                  <TextField\r\n                    value={getStrippedHtmlText(localizeI18nObj(col[DASHBOARD_ELEM_VALUE_KEY], defaultLanguage, languages) || \"\")}\r\n                    className={`${classes.input} ${classes.htmlInput}`}\r\n                    multiline\r\n                    rows={5}\r\n                    InputProps={{\r\n                      readOnly: true,\r\n                      endAdornment: (\r\n                        <Tooltip title={t(\"components.dashboardBuilder.actions.editText\")}>\r\n                          <EditIcon\r\n                            style={{cursor: \"pointer\", marginLeft: 4}}\r\n                            onClick={() => onTextEdit(rowIdx, colIdx, col[DASHBOARD_ELEM_VALUE_KEY])}\r\n                          />\r\n                        </Tooltip>\r\n                      )\r\n                    }}\r\n                  />\r\n                )\r\n              }\r\n            </div>\r\n            <Tooltip title={t(\"components.dashboardBuilder.actions.resetColumn\")}>\r\n              <IconButton\r\n                className={classes.viewAction}\r\n                onClick={() => onTypeReset(rowIdx, colIdx)}\r\n              >\r\n                <CloseIcon/>\r\n              </IconButton>\r\n            </Tooltip>\r\n          </div>\r\n        )\r\n      }\r\n    </div>\r\n    <Tooltip title={t(\"components.dashboardBuilder.actions.removeColumn\")}>\r\n      <span>\r\n        <IconButton\r\n          className={classes.colActions}\r\n          onClick={() => onColRemove(rowIdx, colIdx)}\r\n          disabled={dashboard.dashboardConfig[rowIdx].length === 1}\r\n        >\r\n          <DeleteIcon/>\r\n        </IconButton>\r\n      </span>\r\n    </Tooltip>\r\n  </div>;\r\n\r\nconst DashboardBuilderRow = ({\r\n                               t,\r\n                               classes,\r\n                               defaultLanguage,\r\n                               languages,\r\n                               dashboard,\r\n                               row,\r\n                               rowIdx,\r\n                               onRowRemove,\r\n                               onColAdd,\r\n                               onColRemove,\r\n                               onTypeReset,\r\n                               fetchViews,\r\n                               onViewReset,\r\n                               onTextEdit,\r\n                               onShowTitleChange,\r\n                               onEnableFiltersChange,\r\n                               onFilterDimensionChange\r\n                             }) =>\r\n  <div className={classes.rowContainer}>\r\n    <div className={classes.row}>\r\n      {row.map((col, idx) =>\r\n        <DashboardBuilderCol\r\n          key={idx}\r\n          t={t}\r\n          classes={classes}\r\n          defaultLanguage={defaultLanguage}\r\n          languages={languages}\r\n          dashboard={dashboard}\r\n          rowIdx={rowIdx}\r\n          colIdx={idx}\r\n          col={col}\r\n          onColRemove={onColRemove}\r\n          onTypeReset={onTypeReset}\r\n          fetchViews={fetchViews}\r\n          onViewReset={onViewReset}\r\n          onTextEdit={onTextEdit}\r\n          onShowTitleChange={onShowTitleChange}\r\n          onEnableFiltersChange={onEnableFiltersChange}\r\n          onFilterDimensionChange={onFilterDimensionChange}\r\n        />\r\n      )}\r\n    </div>\r\n    <div className={classes.rowActions}>\r\n      <Tooltip title={t(\"components.dashboardBuilder.actions.addColumn\")}>\r\n        <span>\r\n          <IconButton\r\n            className={classes.rowAction}\r\n            onClick={() => onColAdd(rowIdx)}\r\n            disabled={row.length === MAX_VIEW_PER_ROW}\r\n          >\r\n            <AddIcon/>\r\n          </IconButton>\r\n        </span>\r\n      </Tooltip>\r\n      <Tooltip title={t(\"components.dashboardBuilder.actions.removeRow\")}>\r\n        <IconButton\r\n          className={classes.rowAction}\r\n          onClick={() => onRowRemove(rowIdx)}\r\n        >\r\n          <DeleteIcon/>\r\n        </IconButton>\r\n      </Tooltip>\r\n    </div>\r\n  </div>;\r\n\r\nfunction DashboardBuilder(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    nodes,\r\n    dashboard,\r\n    onChange,\r\n    views,\r\n    fetchViews,\r\n    onViewsHide\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [selectedRowIdx, setSelectedRowIdx] = useState(null);\r\n  const [selectedColIdx, setSelectedColIdx] = useState(null);\r\n\r\n  const [isEditTextVisible, setEditTextVisibility] = useState(false);\r\n  const [tempTextValue, setTempTextValue] = useState(null);\r\n\r\n  const handleRowAdd = () => {\r\n    const newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig.push([emptyDashboardElem]);\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleRowRemove = rowIdx => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig = newDashboard.dashboardConfig.filter((_, idx) => idx !== rowIdx);\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleColAdd = rowIdx => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx].push(emptyDashboardElem)\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].map(col => ({\r\n      ...col,\r\n      [DASHBOARD_ELEM_WIDTH_KEY]: (100 / newDashboard.dashboardConfig[rowIdx].length)\r\n    }));\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleColRemove = (rowIdx, colIdx) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].filter((_, idx) => idx !== colIdx);\r\n    newDashboard.dashboardConfig[rowIdx] = newDashboard.dashboardConfig[rowIdx].map(col => ({\r\n      ...col,\r\n      [DASHBOARD_ELEM_WIDTH_KEY]: (100 / newDashboard.dashboardConfig[rowIdx].length)\r\n    }));\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleTypeReset = (rowIdx, colIdx) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = null;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = null;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleViewSet = (rowIdx, colIdx, view) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = DASHBOARD_ELEM_TYPE_VALUE_VIEW;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = view.viewTemplateId;\r\n    newDashboard.views[view.viewTemplateId] = view;\r\n    onChange(newDashboard);\r\n    onViewsHide();\r\n  };\r\n\r\n  const handleViewReset = (rowIdx, colIdx, viewId) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = null;\r\n    onChange(newDashboard);\r\n    onViewsHide();\r\n  };\r\n\r\n  const handleEditTextShow = (rowIdx, colIdx, text) => {\r\n    setSelectedRowIdx(rowIdx);\r\n    setSelectedColIdx(colIdx);\r\n    setTempTextValue(text);\r\n    setEditTextVisibility(true);\r\n  };\r\n\r\n  const handleEditTextHide = () => {\r\n    setSelectedRowIdx(null);\r\n    setSelectedColIdx(null);\r\n    setTempTextValue(null);\r\n    setEditTextVisibility(false);\r\n  };\r\n\r\n  const handleTextChange = (rowIdx, colIdx, text) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_TYPE_KEY] = DASHBOARD_ELEM_TYPE_VALUE_TEXT;\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_VALUE_KEY] = text;\r\n    onChange(newDashboard);\r\n    setEditTextVisibility(false);\r\n  };\r\n\r\n  const handleShowTitleChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_SHOW_TITLE_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleEnableFiltersChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_ENABLE_FILTERS_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  const handleFilterDimensionChange = (rowIdx, colIdx, value) => {\r\n    let newDashboard = _.cloneDeep(dashboard);\r\n    newDashboard.dashboardConfig[rowIdx][colIdx][DASHBOARD_ELEM_FILTER_DIMENSION_KEY] = value;\r\n    onChange(newDashboard);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      {dashboard && (\r\n        <Grid container spacing={1}>\r\n          <Grid item xs={12}>\r\n            <FormControl fullWidth className={classes.field}>\r\n              <I18nDelayedTextField\r\n                label={t(\"components.dashboardBuilder.title\")}\r\n                value={dashboard.title}\r\n                variant=\"outlined\"\r\n                required\r\n                onChange={value => onChange({...dashboard, title: value})}\r\n              />\r\n            </FormControl>\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Grid container>\r\n              <Grid item className={classes.filterLevels} style={{marginRight: 16, lineHeight: \"34px\"}}>\r\n                {t(\"components.dashboardBuilder.filterLevels\")}:\r\n              </Grid>\r\n              <Grid item>\r\n                <Grid container>\r\n                  {filters.labels.map((label, idx) =>\r\n                    <Grid item key={idx} style={{marginRight: 8}}>\r\n                      <FormControlLabel\r\n                        className={classes.formLabel}\r\n                        label={getDashboardDynamicFilterLabelTranslations(t)[label]}\r\n                        control={\r\n                          <Checkbox\r\n                            style={{padding: 5}}\r\n                            checked={!!dashboard.filterLevels[label]}\r\n                            onChange={(ev, checked) => onChange({\r\n                              ...dashboard,\r\n                              filterLevels: {\r\n                                ...dashboard.filterLevels,\r\n                                [label]: checked\r\n                              }\r\n                            })}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            {(dashboard.dashboardConfig || []).map((row, idx) =>\r\n              <DashboardBuilderRow\r\n                key={idx}\r\n                t={t}\r\n                classes={classes}\r\n                defaultLanguage={defaultLanguage}\r\n                languages={languages}\r\n                dashboard={dashboard}\r\n                row={row}\r\n                rowIdx={idx}\r\n                onRowRemove={handleRowRemove}\r\n                onColAdd={handleColAdd}\r\n                onColRemove={handleColRemove}\r\n                onTypeReset={handleTypeReset}\r\n                fetchViews={(rowIdx, colIdx) => {\r\n                  fetchViews();\r\n                  setSelectedRowIdx(rowIdx);\r\n                  setSelectedColIdx(colIdx);\r\n                }}\r\n                onViewReset={handleViewReset}\r\n                onTextEdit={handleEditTextShow}\r\n                onShowTitleChange={handleShowTitleChange}\r\n                onEnableFiltersChange={handleEnableFiltersChange}\r\n                onFilterDimensionChange={handleFilterDimensionChange}\r\n              />\r\n            )}\r\n          </Grid>\r\n          <Grid item xs={12}>\r\n            <Grid container justify=\"center\">\r\n              <Button endIcon={<AddIcon/>} onClick={handleRowAdd}>\r\n                {t(\"components.dashboardBuilder.actions.addRow\")}\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n      )}\r\n\r\n      <Dialog\r\n        open={views !== null && views !== undefined}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={onViewsHide}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.views.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <InfiniteScrollTable\r\n            data={(views || [])}\r\n            getRowKey={({viewTemplateId}) => viewTemplateId}\r\n            columns={[\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.node\"),\r\n                dataIndex: 'nodeId',\r\n                render: (_, {nodeId}) => nodes.find(node => node.nodeId === nodeId).code,\r\n                renderText: nodeId => nodes.find(node => node.nodeId === nodeId).code,\r\n                minWidth: 100\r\n              },\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.datasetId\"),\r\n                dataIndex: 'datasetId',\r\n                minWidth: 100\r\n              },\r\n              {\r\n                title: t(\"components.dashboardBuilder.modals.views.columns.name\"),\r\n                dataIndex: 'title',\r\n                minWidth: 150\r\n              }\r\n            ]}\r\n            multilangStrDataIndexes={[\"title\"]}\r\n            onRowClick={({__originalRow: view}) => {\r\n              handleViewSet(selectedRowIdx, selectedColIdx, view);\r\n              setSelectedRowIdx(null);\r\n              setSelectedColIdx(null);\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              onViewsHide();\r\n              setSelectedRowIdx(null);\r\n              setSelectedColIdx(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isEditTextVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={handleEditTextHide}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.text.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <I18nHtmlEditor\r\n            value={tempTextValue}\r\n            onChange={setTempTextValue}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleEditTextHide}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => handleTextChange(selectedRowIdx, selectedColIdx, tempTextValue)}>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(DashboardBuilder);","import React from 'react';\r\n\r\n/* Calls a function right after the WrappedComponent has been mounted and updated (if props changed) */\r\nclass Call extends React.Component {\r\n\r\n  componentDidMount() {\r\n    /* children has been mounted */\r\n    if (this.props.disabled === undefined || !this.props.disabled) {\r\n      this.props.cb(this.props.cbParam);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate({cb, cbParam, disabled}) {\r\n    /* children has been updated */\r\n    if (\r\n      (this.props.disabled === undefined || !this.props.disabled)\r\n      &&\r\n      (\r\n        JSON.stringify(cbParam) !== JSON.stringify(this.props.cbParam)\r\n        ||\r\n        (this.props.disabled !== undefined && disabled === true && this.props.disabled === false)\r\n      )\r\n    ) {\r\n      this.props.cb(this.props.cbParam);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default Call;\r\n","import React from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\n\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME = \"LABEL_FORMAT_SELECTOR_FORMAT_NAME\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID = \"LABEL_FORMAT_SELECTOR_FORMAT_ID\";\r\nexport const LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH = \"LABEL_FORMAT_SELECTOR_FORMAT_BOTH\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    margin: \"0 4px\"\r\n  },\r\n  label: {\r\n    color: \"rgba(0, 0, 0, 0.54)\",\r\n    fontSize: 13,\r\n    width: 80,\r\n    height: 40,\r\n    lineHeight: \"40px\",\r\n    marginRight: 8\r\n  },\r\n  formControl: {\r\n    margin: \"8px 0\"\r\n  },\r\n  select: {\r\n    width: 80,\r\n    \"& .MuiSelect-root.MuiSelect-select\": {\r\n      padding: \"2px 24px 3px 0\",\r\n      fontSize: 14\r\n    }\r\n  },\r\n  menuItem: {\r\n    fontSize: 14\r\n  }\r\n});\r\n\r\nconst LabelFormatSelector = ({\r\n                               t,\r\n                               classes,\r\n                               labelFormat,\r\n                               setLabelFormat\r\n                             }) =>\r\n  <Grid container className={classes.root}>\r\n    <Grid item className={classes.label}>\r\n      {t(\"components.labelFormatSelector.labelFormat.title\")}:\r\n    </Grid>\r\n    <Grid item>\r\n      <FormControl className={classes.formControl}>\r\n        <Select\r\n          className={classes.select}\r\n          value={(labelFormat || \"\")}\r\n          onChange={(ev) => setLabelFormat(ev.target.value)}\r\n        >\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.name\")}\r\n          </MenuItem>\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.id\")}\r\n          </MenuItem>\r\n          <MenuItem className={classes.menuItem} value={LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH}>\r\n            {t(\"components.labelFormatSelector.labelFormat.values.both\")}\r\n          </MenuItem>\r\n        </Select>\r\n      </FormControl>\r\n    </Grid>\r\n  </Grid>\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(LabelFormatSelector)","import _ from \"lodash\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"../components/label-format-selector\";\r\n\r\nconst TIME_PERIOD_KEY = \"TIME_PERIOD\";\r\n\r\nconst toUpperCaseFirst = string => (string !== null && string.length > 0)\r\n  ? string[0].toUpperCase() + string.slice(1)\r\n  : string;\r\n\r\nexport const getDimensionLabelFromJsonStat = (jsonStat, dimension, format) => {\r\n  const name = toUpperCaseFirst(jsonStat.dimension[dimension].label);\r\n  const id = dimension;\r\n\r\n  return (name || id);\r\n};\r\n\r\nexport const getDimensionValueLabelFromJsonStat = (jsonStat, dimension, value, format) => {\r\n  const name = toUpperCaseFirst(jsonStat.dimension[dimension].category.label[value]);\r\n  const id = value;\r\n\r\n  if (dimension === TIME_PERIOD_KEY) {\r\n    return name;\r\n  }\r\n\r\n  switch (format) {\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME:\r\n      return name;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID:\r\n      return id;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH:\r\n      return `[${id}] ${name}`;\r\n    default:\r\n      return name;\r\n  }\r\n};\r\n\r\nexport const getDataIdxFromDimensionsArray = (dimensions, size) => {\r\n  let dataIdx = 0;\r\n  let multiplier = 1;\r\n\r\n  for (let i = 0; i < dimensions.length; i++) {\r\n    multiplier *= (i > 0) ? size[dimensions.length - i] : 1;\r\n    dataIdx += multiplier * dimensions[dimensions.length - i - 1];\r\n  }\r\n\r\n  return dataIdx;\r\n};\r\n\r\nexport const getJsonStatTableSize = (jsonStat, layout) => {\r\n  if (jsonStat) {\r\n    let count = 1;\r\n\r\n    if (!layout) {\r\n      jsonStat.size.forEach(el => count *= el);\r\n\r\n    } else {\r\n      let colCount = 1;\r\n      layout.cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n      let rowCount = 1;\r\n      layout.rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n      layout.sections.forEach(section => rowCount *= jsonStat.size[jsonStat.id.indexOf(section)]);\r\n      count = colCount * rowCount;\r\n    }\r\n\r\n    return count;\r\n\r\n  } else {\r\n    return 0\r\n  }\r\n};\r\n\r\nexport const getCombinationArrays = arrays => {\r\n  if (!arrays || arrays.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  const ret = [];\r\n  const max = arrays.length - 1;\r\n\r\n  function helper(arr, i) {\r\n    for (let j = 0, l = arrays[i].length; j < l; j++) {\r\n      const a = arr.slice(0); // clone arr\r\n      a.push(arrays[i][j]);\r\n      if (i === max) {\r\n        ret.push(a);\r\n      } else {\r\n        helper(a, i + 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  helper([], 0);\r\n  return ret;\r\n};\r\n\r\nconst getCombinationArray = (jsonStat, dimsArrays, test) => {\r\n  if (!dimsArrays || dimsArrays.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  const max = dimsArrays.length - 1;\r\n  let ret = null\r\n\r\n  function helper(arr, i) {\r\n    if (!ret) {\r\n      for (let j = 0, l = dimsArrays[i].length; j < l; j++) {\r\n        if (!ret) {\r\n          const a = arr.slice(0); // clone arr\r\n          a.push(dimsArrays[i][j]);\r\n          if (i === max) {\r\n            if (!test || test(a)) {\r\n              ret = ret || a;\r\n            }\r\n          } else {\r\n            helper(a, i + 1);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  helper([], 0);\r\n  return ret;\r\n};\r\n\r\nexport const getInitialFiltersValue = (jsonStat, filters, fixedFiltersValue) => {\r\n  if (!jsonStat.id || jsonStat.id.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  let dims = [];\r\n  if (filters.includes(TIME_PERIOD_KEY)) {\r\n    dims.push(TIME_PERIOD_KEY);\r\n  }\r\n  dims = _.uniq(dims.concat(filters));\r\n  dims = _.uniq(dims.concat(jsonStat.id));\r\n\r\n  const indexesMap = fixedFiltersValue\r\n    ? getDimensionValuesIndexesMap(jsonStat)\r\n    : null;\r\n\r\n  const dimsArrays = dims.map(dim => (!fixedFiltersValue || !Object.keys(fixedFiltersValue).includes(dim))\r\n    ? jsonStat.dimension[dim].category.index.map((_, idx) => idx)\r\n    : [indexesMap[dim][fixedFiltersValue[dim]]]\r\n  );\r\n  dimsArrays[dims.indexOf(TIME_PERIOD_KEY)].reverse();\r\n\r\n  const isValorized = (orderedDims, unorderedDims, combination) => {\r\n    const dimCombination = orderedDims.map(dim => combination[unorderedDims.indexOf(dim)]);\r\n    const dataIdx = getDataIdxFromDimensionsArray(dimCombination, jsonStat.size);\r\n    const value = jsonStat.value[dataIdx];\r\n    return (value !== null && value !== undefined);\r\n  }\r\n  const unorderedDimCombination = getCombinationArray(jsonStat, dimsArrays, combination => isValorized(jsonStat.id, dims, combination));\r\n  const dimCombination = jsonStat.id.map(dim => unorderedDimCombination[dims.indexOf(dim)]);\r\n\r\n  const filtersValue = {};\r\n  jsonStat.id.forEach((dim, idx) => {\r\n    if (filters.includes(dim)) {\r\n      filtersValue[dim] = jsonStat.dimension[dim].category.index[dimCombination[idx]];\r\n    }\r\n  })\r\n\r\n  return filtersValue;\r\n};\r\n\r\nexport const getFilteredLayoutObject = (jsonStat, initialLayout) => {\r\n  const layout = _.cloneDeep(initialLayout);\r\n  const dimArraysKey = [\"rows\", \"cols\", \"filters\", \"sections\", \"primaryDim\", \"secondaryDim\"];\r\n\r\n  for (let key in layout) {\r\n    if (layout.hasOwnProperty(key)) {\r\n      if (dimArraysKey.includes(key)) {\r\n        layout[key] = (layout[key] || []).filter(dim => jsonStat.id.includes(dim));\r\n      }\r\n    }\r\n  }\r\n\r\n  return layout\r\n};\r\n\r\nexport const getDimensionFiltersValue = (jsonStat, dimension, filters, filtersValue) => {\r\n  const values = [];\r\n  const addedValues = {};\r\n\r\n  if (filters.filter(filter => jsonStat.size[jsonStat.id.indexOf(filter)] > 1)[0] === dimension) {\r\n    jsonStat.dimension[dimension].category.index.forEach(dimValue => values.push({\r\n      id: dimValue,\r\n      label: jsonStat.dimension[dimension].category.label[dimValue]\r\n    }));\r\n\r\n    return values\r\n  }\r\n\r\n  const dimensionsNotInFilters = jsonStat.id.filter(dim => !filters.includes(dim));\r\n  const dimensionsPostFilter = filters.slice(filters.indexOf(dimension) + 1);\r\n  const dimensions = dimensionsNotInFilters.concat(dimensionsPostFilter)\r\n\r\n  jsonStat.dimension[dimension].category.index.forEach(dimValue => {\r\n    const arrays = jsonStat.id.map(dim => {\r\n      if (dimension === dim) {\r\n        return [dimValue]\r\n      } else if (dimensions.includes(dim)) {\r\n        return jsonStat.dimension[dim].category.index\r\n      } else {\r\n        return [filtersValue[dim]]\r\n      }\r\n    });\r\n\r\n    const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n    const isValorized = combination => {\r\n      const dataIndexArr = combination.map((combinationValue, idx) => indexesMap[jsonStat.id[idx]][combinationValue]);\r\n      const observation = jsonStat.value[getDataIdxFromDimensionsArray(dataIndexArr, jsonStat.size)];\r\n      return (observation !== null && observation !== undefined && !addedValues[dimValue])\r\n    };\r\n\r\n    const combinationArray = getCombinationArray(jsonStat, arrays, isValorized);\r\n    if (combinationArray) {\r\n      values.push({\r\n        id: dimValue,\r\n        label: jsonStat.dimension[dimension].category.label[dimValue]\r\n      });\r\n      addedValues[dimValue] = true;\r\n    }\r\n  });\r\n\r\n  return values;\r\n};\r\n\r\nexport const getChartDimensionValues = (jsonStat, dimension, filters, filtersValue, count) => {\r\n  if (!dimension) {\r\n    return [];\r\n  }\r\n\r\n  const values = getDimensionFiltersValue(jsonStat, dimension, filters, filtersValue);\r\n\r\n  return values.map(({id}) => id).slice(0, count ? count : undefined);\r\n};\r\n\r\nexport const getDimensionValuesIndexesMap = jsonStat => {\r\n  const indexesMap = {};\r\n\r\n  jsonStat.id.forEach(dim => {\r\n    indexesMap[dim] = {};\r\n    jsonStat.dimension[dim].category.index.forEach((dimValue, idx) => indexesMap[dim][dimValue] = idx);\r\n  });\r\n\r\n  return indexesMap;\r\n};\r\n\r\nexport const getAttributeObjects = (attributeList, attributeObj, hiddenAttributes) => {\r\n  const attributes = [];\r\n  const ids = [];\r\n  let hasAsterisk = false;\r\n\r\n  try {\r\n    (attributeList || []).forEach((attr, idx) => {\r\n      if (attr !== null && !(hiddenAttributes || []).includes(attributeObj[idx].id)) {\r\n        const valueId = attributeObj[idx].values[attr].id;\r\n        const valueLabel = attributeObj[idx].values[attr].name;\r\n\r\n        attributes.push({\r\n          id: attributeObj[idx].id,\r\n          label: attributeObj[idx].name,\r\n          valueId: valueId,\r\n          valueLabel: valueLabel\r\n        });\r\n\r\n        if (valueId !== valueLabel && valueId.length <= 5) {\r\n          ids.push(valueId);\r\n        } else {\r\n          hasAsterisk = true;\r\n        }\r\n      }\r\n    });\r\n\r\n    if (hasAsterisk) {\r\n      ids.push(\"(*)\");\r\n    }\r\n\r\n    return (attributes.length > 0 && ids.length > 0)\r\n      ? {\r\n        attributes,\r\n        ids\r\n      }\r\n      : null\r\n\r\n  } catch (error) {\r\n    return -1\r\n  }\r\n\r\n\r\n};\r\n\r\nexport const getDimensionAttributeMap = (jsonStat, hiddenAttributes, getIdsHtmlString) => {\r\n  if (!jsonStat) {\r\n    return null;\r\n  }\r\n\r\n  const series = (jsonStat?.extension?.attributes?.series || []);\r\n  const seriesIndexes = (jsonStat?.extension?.attributes?.index?.series || []);\r\n  const dimensionAttributesMap = {};\r\n\r\n  jsonStat.id.forEach(dim => dimensionAttributesMap[dim] = {});\r\n  if (series && series.length > 0 && seriesIndexes && seriesIndexes.length > 0) {\r\n    seriesIndexes\r\n      .filter(({coordinates}) => (coordinates || []).filter(c => c !== null).length === 1)\r\n      .forEach(index => {\r\n        const dimIdx = index.coordinates.findIndex(el => el !== null);\r\n        const dim = jsonStat.id[dimIdx];\r\n        const dimValueIdx = index.coordinates.find(el => el !== null);\r\n        const dimValue = jsonStat.dimension[dim].category.index[dimValueIdx];\r\n\r\n        const attributeObjects = getAttributeObjects(index.attributes, series, hiddenAttributes);\r\n        if (attributeObjects !== null && attributeObjects !== -1) {\r\n          dimensionAttributesMap[dim][dimValue] = {\r\n            attributes: attributeObjects.attributes,\r\n            ids: attributeObjects.ids,\r\n            htmlString: getIdsHtmlString\r\n              ? getIdsHtmlString(attributeObjects.ids, dim, dimValue)\r\n              : null\r\n          };\r\n        }\r\n      });\r\n  }\r\n\r\n  return dimensionAttributesMap;\r\n};","export const numberFormatter = (new Intl.NumberFormat()).format;\r\n\r\nexport const DECIMAL_SEPARATOR_DEFAULT = \",\";\r\nexport const DECIMAL_PLACES_DEFAULT = 2;\r\nexport const EMPTY_CHAR_DEFAULT = \"\";\r\n\r\nconst getFormattedInt = (value, separator) => {\r\n  let str = value + \"\";\r\n  let subStrs = [];\r\n\r\n  while (str.length > 3) {\r\n    subStrs.push(str.slice(-3));\r\n    str = str.slice(0, -3)\r\n    subStrs.push((separator || \".\"));\r\n  }\r\n  if (str.length > 0) {\r\n    subStrs.push(str);\r\n  } else {\r\n    subStrs.pop()\r\n  }\r\n  subStrs.reverse();\r\n\r\n  let ret = \"\";\r\n  subStrs.forEach(subStr => ret += subStr);\r\n\r\n  return ret;\r\n};\r\n\r\nexport const getFormattedValue = (value, decimalSeparator, decimalPlaces, emptyChar) => {\r\n\r\n  if (value === null || value === undefined) {\r\n    return (emptyChar || EMPTY_CHAR_DEFAULT);\r\n  }\r\n\r\n  if (isNaN(value)) {\r\n    return value;\r\n  }\r\n\r\n  const intSeparator = decimalSeparator === \".\" ? \",\" : \".\";\r\n\r\n  if (Number.isInteger(value)) {\r\n    return getFormattedInt(value, intSeparator);\r\n  }\r\n\r\n  const int = Math.floor(value);\r\n\r\n  if (decimalPlaces === 0 || DECIMAL_PLACES_DEFAULT === 0) {\r\n    return getFormattedInt(int, intSeparator);\r\n  }\r\n\r\n  const decimal = (value - int).toFixed(decimalPlaces || DECIMAL_PLACES_DEFAULT).slice(2);\r\n\r\n  return getFormattedInt(int, intSeparator) + (decimalSeparator || DECIMAL_SEPARATOR_DEFAULT) + decimal;\r\n}","import {\r\n  getAttributeObjects,\r\n  getCombinationArrays,\r\n  getDataIdxFromDimensionsArray,\r\n  getDimensionAttributeMap,\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat\r\n} from \"../../utils/jsonStat\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport {getFormattedValue} from \"../../utils/formatters\";\r\nimport _ from \"lodash\";\r\n\r\nconst JSONSTAT_TABLE_PREVIEW_PLACEHOLDER = \"xxx\";\r\nconst JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR = '<svg height=\"6px\" width=\"6px\" fill=\"#00295a\"><path d=\"M 0 0 H 6 V 6 H 0 Z\"/></svg>';\r\n\r\nconst extendArr = (array, n) => {\r\n  let arrays = Array.apply(null, new Array(n / array.length));\r\n  arrays = arrays.map(() => array);\r\n  return [].concat.apply([], arrays);\r\n};\r\n\r\nconst getObj = (jsonStat, arr, length, isPreview) => {\r\n  const obj = {};\r\n  arr.forEach((el, idx) => {\r\n    const repCount = idx === 0\r\n      ? length / jsonStat.size[jsonStat.id.indexOf(el)]\r\n      : obj[arr[idx - 1]].repCount / jsonStat.size[jsonStat.id.indexOf(el)];\r\n\r\n    obj[el] = {\r\n      repCount: repCount,\r\n      ids: [],\r\n      labels: [],\r\n      indexesMap: {}\r\n    };\r\n    if (!isPreview) {\r\n      jsonStat.dimension[el].category.index.forEach((value, idx) => {\r\n        for (let j = 0; j < repCount; j++) {\r\n          obj[el].ids.push(value);\r\n          obj[el].labels.push(jsonStat.dimension[el].category.label[value]);\r\n          obj[el].indexesMap[value] = idx;\r\n        }\r\n      })\r\n    }\r\n  });\r\n  if (!isPreview) {\r\n    arr.forEach(el => {\r\n      if (obj[el].ids.length < length) {\r\n        obj[el].ids = extendArr(obj[el].ids, length);\r\n        obj[el].labels = extendArr(obj[el].labels, length);\r\n      }\r\n    });\r\n  }\r\n\r\n  return obj\r\n};\r\n\r\nconst getValorizedElCount = array => {\r\n  let count = 0;\r\n\r\n  array.forEach(el => {\r\n    if (el === true) {\r\n      count++;\r\n    }\r\n  });\r\n\r\n  return count;\r\n};\r\n\r\nconst getCorrespondingIndexInFilteredArray = (array, n) => {\r\n  let count = 0;\r\n  let res = 0;\r\n  let lastIdx = 0;\r\n  let found = false;\r\n\r\n  array.forEach((el, idx) => {\r\n    if (el === true) {\r\n      count++;\r\n      lastIdx = idx;\r\n      if (count === n + 1) {\r\n        res = idx;\r\n        found = true;\r\n      }\r\n    }\r\n  });\r\n\r\n  return found ? res : (lastIdx + 1);\r\n};\r\n\r\nexport const getJsonStatLayoutObjects = (jsonStat, rows, cols, sections, filters, filtersValue, isPreview) => {\r\n\r\n  /** rows handling **/\r\n\r\n  let rowCount = 1;\r\n  (rows || []).forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n  const rowsObj = (rows || []).length > 0\r\n    ? getObj(jsonStat, rows, rowCount, isPreview)\r\n    : {};\r\n\r\n  /** cols handling **/\r\n\r\n  let colCount = 1;\r\n  (cols || []).forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  const colsObj = (cols || []).length > 0\r\n    ? getObj(jsonStat, cols, colCount, isPreview)\r\n    : {};\r\n\r\n  /** sections handling **/\r\n\r\n  const sectionArray = [];\r\n  (sections || []).forEach(section => sectionArray.push(jsonStat.dimension[section].category.index));\r\n  const combinations = sectionArray.length > 0\r\n    ? getCombinationArrays(sectionArray)\r\n    : [];\r\n\r\n  /** indexes map handling **/\r\n\r\n  const indexesMap = {};\r\n  rows.forEach(row => indexesMap[row] = rowsObj[row].indexesMap);\r\n  cols.forEach(col => indexesMap[col] = colsObj[col].indexesMap);\r\n  sections.forEach(section => {\r\n    indexesMap[section] = {};\r\n    jsonStat.dimension[section].category.index.forEach((val, idx) => indexesMap[section][val] = idx);\r\n  });\r\n  filters.forEach(filter => {\r\n    indexesMap[filter] = {};\r\n    jsonStat.dimension[filter].category.index.forEach((val, idx) => indexesMap[filter][val] = idx);\r\n  });\r\n\r\n  return {\r\n    rowCount,\r\n    rowsObj,\r\n    colCount,\r\n    colsObj,\r\n    combinations,\r\n    indexesMap\r\n  }\r\n};\r\n\r\nconst getCellAttributeIdsElem = (ids, id, isDataCell) => {\r\n  let idElems = \"\";\r\n  const astElem = ' <span class=\"ct-a\">(*)</span> ';\r\n\r\n  if (!ids || ids.length === 0) {\r\n    return \"\";\r\n\r\n  } else {\r\n    if (ids.join(\"\").length > 7) {\r\n      idElems += astElem;\r\n    } else {\r\n      ids.forEach(id => {\r\n        idElems += ` <span class=\"${id === \"(*)\" ? 'ct-a' : 'ct-c'}\">${id}</span> `;\r\n      })\r\n    }\r\n  }\r\n\r\n  return ` <span id=\"${id}\" class=\"ct ${isDataCell ? 'ctd' : 'ctsh'}\">${idElems}</span> `\r\n};\r\n\r\nexport const getJsonStatTableSupportStructures = (jsonStat, rows, cols, sections, filters, filtersValue, isPreview, removeEmptyLines, hiddenAttributes) => {\r\n\r\n  const {\r\n    rowCount,\r\n    rowsObj,\r\n    colCount,\r\n    colsObj,\r\n    combinations,\r\n    indexesMap\r\n  } = getJsonStatLayoutObjects(jsonStat, rows, cols, sections, filters, filtersValue, isPreview);\r\n\r\n  /** empty rows & cols handling **/\r\n\r\n  let valorizedRowsPerSection = (combinations && combinations.length > 0)\r\n    ? combinations.map(() => [])\r\n    : [[]];\r\n  let valorizedCols = [];\r\n\r\n  if (removeEmptyLines) {\r\n    valorizedRowsPerSection = valorizedRowsPerSection.map(() => new Array(rowCount).fill(false));\r\n    valorizedCols = new Array(colCount).fill(false);\r\n\r\n    const setValorizedLines = (combination, idx) => {\r\n\r\n      const dataObj = {\r\n        ...filtersValue\r\n      };\r\n      sections.forEach((section, idx) => dataObj[section] = combination[idx]);\r\n\r\n      for (let r = 0; r < rowCount; r++) {\r\n\r\n        rows.forEach(row => dataObj[row] = rowsObj[row].ids[r]);\r\n\r\n        for (let c = 0; c < colCount; c++) {\r\n\r\n          if (!(valorizedRowsPerSection[idx][r] === true && valorizedCols[c] === true)) {\r\n\r\n            cols.forEach(col => dataObj[col] = colsObj[col].ids[c]);\r\n\r\n            const dataIndexArr = jsonStat.id.map(dim => indexesMap[dim][dataObj[dim]]);\r\n\r\n            const value = jsonStat.value[getDataIdxFromDimensionsArray(dataIndexArr, jsonStat.size)];\r\n\r\n            if (value !== null && value !== undefined) {\r\n              valorizedRowsPerSection[idx][r] = true;\r\n              valorizedCols[c] = true;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    if (sections && sections.length > 0) {\r\n      combinations.forEach((combination, idx) => setValorizedLines(combination, idx));\r\n    } else {\r\n      setValorizedLines(null, 0)\r\n    }\r\n\r\n  } else {\r\n    valorizedRowsPerSection = valorizedRowsPerSection.map(() => new Array(rowCount).fill(true));\r\n    valorizedCols = new Array(colCount).fill(true);\r\n  }\r\n\r\n  let totalRowCount = 0;\r\n  valorizedRowsPerSection.forEach(section => totalRowCount += getValorizedElCount(section))\r\n\r\n  let valorizedRows;\r\n  if (Array.prototype.flat) {\r\n    valorizedRows = valorizedRowsPerSection.flat();\r\n  } else {\r\n    valorizedRows = [];\r\n    valorizedRowsPerSection.forEach(section => valorizedRows = valorizedRows.concat(section));\r\n  }\r\n\r\n  /** dimension attributes handling **/\r\n  const dimensionAttributesMap = getDimensionAttributeMap(\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    (ids, dim, dimValue) => getCellAttributeIdsElem(ids, `${dim},${dimValue}`, false)\r\n  );\r\n\r\n  /** observation attributes handling **/\r\n  const observations = (jsonStat?.extension?.attributes?.observation || []);\r\n  const observationIndexes = (jsonStat?.extension?.attributes?.index?.observation || {});\r\n  const observationAttributesMap = _.cloneDeep(observationIndexes);\r\n\r\n  let hasAttributeObservationError = false;\r\n  for (let key in observationAttributesMap) {\r\n    if (observationAttributesMap.hasOwnProperty(key)) {\r\n      const attributeObjects = getAttributeObjects(observationAttributesMap[key], observations, hiddenAttributes);\r\n      if (attributeObjects !== null && attributeObjects !== -1) {\r\n        observationAttributesMap[key] = {\r\n          attributes: attributeObjects.attributes,\r\n          ids: attributeObjects.ids,\r\n          htmlString: getCellAttributeIdsElem(attributeObjects.ids, key, true)\r\n        };\r\n      } else if (attributeObjects === -1) {\r\n        hasAttributeObservationError = true;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (hasAttributeObservationError) {\r\n    window.error.show(\"Error retrieving attributes at observation level\");\r\n  }\r\n\r\n  return {\r\n    rows,\r\n    cols,\r\n    sections,\r\n    filters,\r\n    filtersValue,\r\n    colCount: getValorizedElCount(valorizedCols),\r\n    rowCount: (combinations && combinations.length > 0)\r\n      ? totalRowCount\r\n      : getValorizedElCount(valorizedRowsPerSection[0]),\r\n    colsObj,\r\n    rowsObj,\r\n    combinations,\r\n    indexesMap,\r\n    valorizedCols,\r\n    valorizedRows,\r\n    valorizedRowsPerSection,\r\n    sectionsLength: valorizedRowsPerSection[0].length,\r\n    dimensionAttributesMap,\r\n    observationAttributesMap\r\n  }\r\n};\r\n\r\nconst getTableRightPadding = padding => padding\r\n  ? `<td class=\"c c-rb\" style=\"min-width: ${padding}px;\">`\r\n  : \"\";\r\n\r\nexport const getJsonStatTableHtml = (\r\n  jsonStat,\r\n  rows,\r\n  cols,\r\n  sections,\r\n  filters,\r\n  filtersValue,\r\n  colCount,\r\n  rowCount,\r\n  colsObj,\r\n  rowsObj,\r\n  combinations,\r\n  indexesMap,\r\n  valorizedCols,\r\n  valorizedRows,\r\n  valorizedRowsPerSection,\r\n  sectionsLength,\r\n  labelFormat,\r\n  fontSize,\r\n  decimalSeparator,\r\n  decimalPlaces,\r\n  emptyChar,\r\n  isPreview,\r\n  paginationParams,\r\n  dimensionAttributesMap,\r\n  observationAttributesMap,\r\n  onTimeSet\r\n) => {\r\n\r\n  /** pagination **/\r\n\r\n  const origColStart = paginationParams ? paginationParams.colStart : 0;\r\n  const origColEnd = paginationParams ? paginationParams.colEnd : colCount;\r\n\r\n  const rowStart = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedRows, paginationParams.rowStart)\r\n    : getCorrespondingIndexInFilteredArray(valorizedRows, 0);\r\n\r\n  const rowEnd = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedRows, paginationParams.rowEnd)\r\n    : getValorizedElCount(valorizedRows);\r\n\r\n  const colStart = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedCols, paginationParams.colStart)\r\n    : getCorrespondingIndexInFilteredArray(valorizedCols, 0);\r\n\r\n  const colEnd = paginationParams\r\n    ? getCorrespondingIndexInFilteredArray(valorizedCols, paginationParams.colEnd)\r\n    : getValorizedElCount(valorizedCols);\r\n\r\n  const t0 = performance.now();\r\n\r\n  /** HTML generating **/\r\n\r\n  let table = `<table id=\"${uuidv4()}\">`;\r\n\r\n  /** table head **/\r\n\r\n  table += '<thead>';\r\n\r\n  cols.forEach((col, idx) => {\r\n    table += `<tr data-row-key=\"h-${idx}\">`;\r\n    table += `<th class=\"c cf${fontSize} ch cl0\" colspan=\"${rows.length}\">${getDimensionLabelFromJsonStat(jsonStat, col, labelFormat)}</th>`;\r\n\r\n    if (!isPreview) {\r\n\r\n      let c = colStart;\r\n      let colVisited = origColStart;\r\n      while (colVisited < origColEnd) {\r\n\r\n        const cc = c;\r\n        let fullColSpan = colsObj[col].ids.slice(c, c + colsObj[col].repCount).filter(el => el === colsObj[col].ids[cc]).length;\r\n\r\n        let colSpan = valorizedCols.slice(c, c + fullColSpan).filter(el => el === true).length;\r\n\r\n        if (colVisited + colSpan > origColEnd) {\r\n          colSpan = origColEnd - colVisited;\r\n        }\r\n\r\n        if (colSpan > 0) {\r\n\r\n          const htmlString = (dimensionAttributesMap?.[col]?.[colsObj[col].ids[c]]?.htmlString || \"\");\r\n\r\n          table += (\r\n            `<th class=\"c cf${fontSize} csh ${htmlString.length > 0 ? 'ca' : ''}\" colspan=\"${colSpan}\">` +\r\n            getDimensionValueLabelFromJsonStat(jsonStat, col, colsObj[col].ids[c], labelFormat) +\r\n            htmlString +\r\n            `</th>`\r\n          );\r\n        }\r\n\r\n        c += fullColSpan;\r\n        colVisited += colSpan;\r\n      }\r\n\r\n    } else {\r\n      for (let c = 0; c < 3; c++) {\r\n        table += `<th class=\"c cf${fontSize} csh\" colspan=\"1\">${JSONSTAT_TABLE_PREVIEW_PLACEHOLDER}</th>`;\r\n      }\r\n    }\r\n\r\n    table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n    table += '</tr>';\r\n  });\r\n\r\n  if (rows.length > 0) {\r\n    table += `<tr data-row-key=\"hh\">`;\r\n    rows.forEach((row, idx) => table += `<th class=\"c cf${fontSize} ch cl${idx}\">${getDimensionLabelFromJsonStat(jsonStat, row, labelFormat)}</th>`);\r\n    if (!isPreview) {\r\n      table += `<th class=\"c cf${fontSize} csh\" colspan=\"${origColEnd - origColStart}\"/>`;\r\n    } else {\r\n      table += `<th class=\"c cf${fontSize} csh\" colspan=\"${cols.length > 0 ? 3 : 1}\"/>`;\r\n    }\r\n    table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n    table += '</tr>';\r\n  }\r\n\r\n  table += '</thead>';\r\n\r\n  /** table body **/\r\n\r\n  table += '<tbody id=\"body\">';\r\n\r\n  if (!isPreview) {\r\n\r\n    const sectionsStarts = [0];\r\n    valorizedRowsPerSection.forEach((valorizedRows, idx) => sectionsStarts.push(sectionsStarts[idx] + valorizedRows.length));\r\n\r\n    const subHeaderHandled = {};\r\n    rows.forEach(row => subHeaderHandled[row] = -1);\r\n\r\n    let currentSectionIdx = 0;\r\n    for (let i = 0; i < sectionsStarts.length; i++) {\r\n      if (rowStart >= sectionsStarts[i] && (i === sectionsStarts.length - 1 || rowStart < sectionsStarts[i + 1])) {\r\n        currentSectionIdx = i;\r\n      }\r\n    }\r\n\r\n    const getSectionRow = currentSectionIdx => {\r\n      let sectionRow = `<tr data-row-key=\"s-${currentSectionIdx}\" class=\"rs\">`;\r\n      let sectionLabel = \"\";\r\n      const currentSectionIdxClone = currentSectionIdx;\r\n      sections.forEach((section, idx) => {\r\n\r\n        const htmlString = (dimensionAttributesMap?.[section]?.[combinations[currentSectionIdxClone][idx]]?.htmlString || \"\");\r\n\r\n        sectionLabel += (\r\n          `<span class=\"${htmlString.length > 0 ? 'ca' : ''}\" style=\"display: inline-block;\">` +\r\n          `<span class=\"cs-d\">${getDimensionLabelFromJsonStat(jsonStat, section, labelFormat)}:</span> ${getDimensionValueLabelFromJsonStat(jsonStat, section, combinations[currentSectionIdxClone][idx], labelFormat)}` +\r\n          htmlString +\r\n          '</span>'\r\n        );\r\n        sectionLabel += idx < (sections.length - 1) ? `<span style=\"display: inline-block; margin: 0 8px\">${JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR}</span>` : '';\r\n      });\r\n\r\n      sectionRow += `<th class=\"c cf${fontSize} cs\" colspan=\"${origColEnd - origColStart + (rows.length || 1)}\">${sectionLabel}</th>`;\r\n\r\n      sectionRow += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n      sectionRow += '</tr>';\r\n\r\n      return sectionRow;\r\n    }\r\n\r\n    if (sections && sections.length > 0) {\r\n      table += getSectionRow(currentSectionIdx);\r\n    }\r\n\r\n    for (let r = rowStart; r < rowEnd; r++) {\r\n\r\n      if (sections && sections.length > 0) {\r\n        if (r > rowStart && sectionsStarts.indexOf(r) !== -1) {\r\n          currentSectionIdx = sectionsStarts.indexOf(r);\r\n          table += getSectionRow(currentSectionIdx);\r\n        }\r\n      }\r\n\r\n      if (valorizedRows[r] === true) {\r\n\r\n        table += `<tr data-row-key=\"r-${r}\">`;\r\n\r\n        let subHeader = \"\";\r\n\r\n        if (rows.length > 0) {\r\n          for (let rr = 0; rr < rows.length; rr++) {\r\n\r\n            const htmlString = (dimensionAttributesMap?.[rows[rr]]?.[rowsObj[rows[rr]].ids[r % sectionsLength]]?.htmlString || \"\");\r\n\r\n            if (r > subHeaderHandled[rows[rr]]) {\r\n\r\n              let rowSpan = valorizedRows.slice(r, r + (rowsObj[rows[rr]].repCount - (r % rowsObj[rows[rr]].repCount))).filter(el => el === true).length;\r\n              if (r + rowSpan > rowEnd) {\r\n                rowSpan = rowEnd - r;\r\n              }\r\n\r\n              subHeaderHandled[rows[rr]] = r + (rowsObj[rows[rr]].repCount - (r % rowsObj[rows[rr]].repCount)) - 1;\r\n\r\n              if (rowSpan > 0) {\r\n                subHeader += (\r\n                  `<th class=\"c cf${fontSize} csh cl${rr} ${htmlString.length > 0 ? 'ca' : ''}\" rowspan=\"${rowSpan}\">` +\r\n                  getDimensionValueLabelFromJsonStat(jsonStat, rows[rr], rowsObj[rows[rr]].ids[r % sectionsLength], labelFormat) +\r\n                  htmlString +\r\n                  `</th>`\r\n                );\r\n              }\r\n            }\r\n          }\r\n\r\n        } else {\r\n          subHeader += `<th class=\"c cf${fontSize} csh cl0\"/>`\r\n        }\r\n\r\n        table += subHeader;\r\n\r\n        const getDataCell = (c, currentSectionIdx) => {\r\n\r\n          const dataObj = {\r\n            ...filtersValue\r\n          };\r\n          rows.forEach(row => dataObj[row] = rowsObj[row].ids[r % sectionsLength]);\r\n          cols.forEach(col => dataObj[col] = colsObj[col].ids[c]);\r\n          sections.forEach((section, idx) => dataObj[section] = combinations[currentSectionIdx][idx]);\r\n\r\n          const dataIndexArr = jsonStat.id.map(dim => indexesMap[dim][dataObj[dim]]);\r\n\r\n          const dataIdx = getDataIdxFromDimensionsArray(dataIndexArr, jsonStat.size);\r\n          const value = jsonStat.value[dataIdx];\r\n\r\n          const htmlString = (observationAttributesMap[dataIdx]?.htmlString || \"\");\r\n\r\n          return (\r\n            `<td id=\"${dataIdx}\" class=\"c cf${fontSize} ${htmlString.length > 0 ? 'ca' : ''}\">` +\r\n            htmlString +\r\n            getFormattedValue(value, decimalSeparator, decimalPlaces, emptyChar) +\r\n            `</td>`\r\n          );\r\n        }\r\n\r\n        if (valorizedRows[r] === true) {\r\n          for (let c = colStart; c < colEnd; c++) {\r\n            if (valorizedCols[c] === true) {\r\n              table += getDataCell(c, currentSectionIdx);\r\n            }\r\n          }\r\n\r\n        } else {\r\n          for (let c = colStart; c < colEnd; c++) {\r\n            table += getDataCell(c, currentSectionIdx);\r\n          }\r\n        }\r\n\r\n        table += getTableRightPadding((paginationParams?.tableRightPadding || 1));\r\n\r\n        table += '</tr>';\r\n      }\r\n\r\n    }\r\n\r\n    table += `<tr><td class=\"c c-bb\" colspan=\"${rows.length + (origColEnd - origColStart + (rows.length > 0 ? 0 : 1))}\"></td></tr>`;\r\n\r\n  } else {\r\n\r\n    if (sections && sections.length > 0) {\r\n      table += `<tr data-row-key=\"s-0\" class=\"rs\">`;\r\n      let sectionLabel = \"\";\r\n      sections.forEach((section, idx) => {\r\n        sectionLabel += `<span style=\"display: inline-block;\"><span class=\"cs-d\">${getDimensionLabelFromJsonStat(jsonStat, section, labelFormat)}:</span> ${JSONSTAT_TABLE_PREVIEW_PLACEHOLDER}</span>`;\r\n        sectionLabel += idx < (sections.length - 1) ? `<span style=\"display: inline-block; margin: 0 8px\">${JSONSTAT_TABLE_SECTION_DIMENSIONS_SEPARATOR}</span>` : '';\r\n      });\r\n      table += `<th class=\"c cf${fontSize} cs\" colspan=\"${(rows.length || 1) + (cols.length > 0 ? 3 : 1)}\">${sectionLabel}</th>`;\r\n      table += getTableRightPadding(1);\r\n      table += '</tr>';\r\n    }\r\n    for (let r = 0; r < (rows.length > 0 ? 3 : 1); r++) {\r\n      table += `<tr data-row-key=\"r-${r}\">`;\r\n      if (rows.length > 0) {\r\n        for (let rr = 0; rr < rows.length; rr++) {\r\n          table += `<th class=\"c cf${fontSize} csh cl${rr}\">xxx</th>`;\r\n        }\r\n      } else {\r\n        table += `<th class=\"c cf${fontSize} csh cl0\">&nbsp;</th>`\r\n      }\r\n      for (let c = 0; c < (cols.length > 0 ? 3 : 1); c++) {\r\n        table += `<td class=\"c cf${fontSize}\"/>`;\r\n      }\r\n      table += getTableRightPadding(1);\r\n      table += '</tr>';\r\n    }\r\n    table += `<tr><td class=\"c c-bb\" colspan=\"${(rows.length || 1) + (cols.length > 0 ? 3 : 1)}\"></td></tr>`;\r\n  }\r\n\r\n  table += '</tbody>';\r\n\r\n  table += '</table>';\r\n\r\n  table += '<div id=\"jsonstat-table__tooltip\" class=\"ctt\"/>'\r\n\r\n  const t1 = performance.now();\r\n  if (!isPreview) {\r\n    onTimeSet(Math.round((t1 - t0) * 100) / 100);\r\n  }\r\n\r\n  return table;\r\n};","import React, {useCallback, useEffect, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Slider from \"@material-ui/core/Slider\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport ArrowDropUpIcon from '@material-ui/icons/ArrowDropUp';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport ArrowLeftIcon from '@material-ui/icons/ArrowLeft';\r\nimport ArrowRightIcon from '@material-ui/icons/ArrowRight';\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nlet timeoutID = null;\r\nconst SCROLLBARS_TIMEOUT = 100;\r\nlet intervalID = null;\r\nconst SCROLLBARS_INTERVAL = 200;\r\n\r\nlet isOnMouseDownOnSliderThumb = null;\r\n\r\nconst WHEEL_DELTA = 1;\r\n\r\nexport const SLIDER_WIDTH = 32;\r\nconst SLIDER_MARGIN = 4;\r\n\r\nconst SLIDER_RAIL_COLOR = \"#cfcfcf\";\r\nconst SLIDER_POINTER_COLOR = \"#808080\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sliderButton: {\r\n    width: SLIDER_WIDTH,\r\n    height: SLIDER_WIDTH,\r\n    padding: 0,\r\n    \"& svg\": {\r\n      width: SLIDER_WIDTH,\r\n      height: SLIDER_WIDTH,\r\n    }\r\n  },\r\n  horizontalSlider: {\r\n    color: SLIDER_POINTER_COLOR,\r\n    \"& span.MuiSlider-rail\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    },\r\n    \"& span.MuiSlider-track\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    }\r\n  },\r\n  verticalSlider: {\r\n    color: SLIDER_POINTER_COLOR,\r\n    \"& span.MuiSlider-rail\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    },\r\n    \"& span.MuiSlider-track\": {\r\n      backgroundColor: SLIDER_RAIL_COLOR,\r\n      opacity: 1\r\n    }\r\n  },\r\n  spinnerOverlay: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    position: \"absolute\",\r\n    top: 0,\r\n    left: 0\r\n  }\r\n});\r\n\r\nconst isEventInContainer = (ev, container) => {\r\n  const containerRect = container.getBoundingClientRect();\r\n  const BUFFER = 32;\r\n\r\n  return (\r\n    ev.clientY >= (containerRect.top - BUFFER) &&\r\n    ev.clientY <= (containerRect.bottom + BUFFER) &&\r\n    ev.clientX >= (containerRect.left - BUFFER) &&\r\n    ev.clientX <= (containerRect.right + BUFFER)\r\n  );\r\n};\r\n\r\nfunction CustomSlider(props) {\r\n  const {\r\n    uuid,\r\n    classes,\r\n    orientation,\r\n    value,\r\n    maxValue,\r\n    onChange,\r\n    onIncrement,\r\n    ticks,\r\n    isVerticalScrollbarVisible\r\n  } = props;\r\n\r\n  useEffect(() => {\r\n    const onMouseUp = () => {\r\n      clearInterval(intervalID);\r\n      isOnMouseDownOnSliderThumb = null;\r\n    }\r\n    window.addEventListener(\"mouseup\", onMouseUp);\r\n    return () => window.removeEventListener(\"mouseup\", onMouseUp);\r\n  }, []);\r\n\r\n  const handleChange = (value, ev, newValue, sliderId) => {\r\n    const step = Math.ceil(ticks / 10);\r\n\r\n    if (ev.type === \"mousedown\") {\r\n\r\n      isOnMouseDownOnSliderThumb = isEventInContainer(ev, $(`#${sliderId} span.MuiSlider-thumb`)[0]);\r\n\r\n      if (newValue < value) {\r\n        if ((value - step) > newValue) {\r\n          onIncrement(false, step, newValue);\r\n          clearInterval(intervalID);\r\n          intervalID = setInterval(\r\n            () => onIncrement(false, step, newValue),\r\n            SCROLLBARS_INTERVAL\r\n          );\r\n        } else {\r\n          onChange(newValue);\r\n        }\r\n      } else {\r\n        if ((value + step) < newValue) {\r\n          onIncrement(true, step, newValue);\r\n          clearInterval(intervalID);\r\n          intervalID = setInterval(\r\n            () => onIncrement(true, step, newValue),\r\n            SCROLLBARS_INTERVAL\r\n          );\r\n        } else {\r\n          onChange(newValue);\r\n        }\r\n      }\r\n\r\n    } else if (ev.type === \"mousemove\" && isOnMouseDownOnSliderThumb) {\r\n      onChange(newValue);\r\n    }\r\n  };\r\n\r\n  return orientation === \"vertical\"\r\n    ? (\r\n      <div style={{width: SLIDER_WIDTH, height: \"100%\", display: \"inline-block\", verticalAlign: \"top\"}}>\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          onMouseDown={() => {\r\n            if (value > 0) {\r\n              onIncrement(false, 1);\r\n              intervalID = setInterval(\r\n                () => onIncrement(false, 1),\r\n                SCROLLBARS_INTERVAL\r\n              );\r\n            }\r\n          }}\r\n          disabled={value === 0}\r\n        >\r\n          <ArrowDropUpIcon/>\r\n        </IconButton>\r\n        <Slider\r\n          id={`sliders__custom-sliders__vertical__${uuid}`}\r\n          orientation=\"vertical\"\r\n          value={ticks - value}\r\n          min={0}\r\n          max={ticks}\r\n          onChange={(ev, newValue) => {\r\n            const invertedValue = (ticks - newValue);\r\n            handleChange(value, ev, invertedValue, `sliders__custom-sliders__vertical__${uuid}`)\r\n          }}\r\n          track=\"inverted\"\r\n          className={classes.verticalSlider}\r\n          style={{\r\n            height: `calc(100% - ${SLIDER_WIDTH + SLIDER_WIDTH + SLIDER_MARGIN + SLIDER_MARGIN}px)`,\r\n            padding: \"0 15px\",\r\n            margin: `${SLIDER_MARGIN}px 0`\r\n          }}\r\n        />\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          onMouseDown={() => {\r\n            if (value < (maxValue - 1)) {\r\n              onIncrement(true, 1);\r\n              intervalID = setInterval(\r\n                () => onIncrement(true, 1),\r\n                SCROLLBARS_INTERVAL\r\n              );\r\n            }\r\n          }}\r\n          disabled={value >= (maxValue - 1)}\r\n        >\r\n          <ArrowDropDownIcon/>\r\n        </IconButton>\r\n      </div>\r\n    )\r\n    : (\r\n      <div style={{width: \"100%\", height: SLIDER_WIDTH, display: \"inline-block\", verticalAlign: \"middle\"}}>\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          style={{display: \"inline-block\", verticalAlign: \"middle\"}}\r\n          onMouseDown={() => {\r\n            onIncrement(false, 1);\r\n            intervalID = setInterval(\r\n              () => onIncrement(false, 1),\r\n              SCROLLBARS_INTERVAL\r\n            );\r\n          }}\r\n          disabled={value === 0}\r\n        >\r\n          <ArrowLeftIcon fontSize=\"small\"/>\r\n        </IconButton>\r\n        <Slider\r\n          id={`sliders__custom-sliders__horizontal__${uuid}`}\r\n          orientation=\"horizontal\"\r\n          value={value}\r\n          min={0}\r\n          max={ticks}\r\n          onChange={(ev, newValue) => handleChange(value, ev, newValue, `sliders__custom-sliders__horizontal__${uuid}`)}\r\n          className={classes.horizontalSlider}\r\n          style={{\r\n            width: `calc(100% - ${SLIDER_WIDTH + SLIDER_WIDTH + SLIDER_MARGIN + SLIDER_MARGIN + (isVerticalScrollbarVisible ? SLIDER_WIDTH : 0)}px)`,\r\n            padding: \"15px 0\",\r\n            display: \"inline-block\",\r\n            verticalAlign: \"middle\",\r\n            margin: `0 ${SLIDER_MARGIN}px`\r\n          }}\r\n        />\r\n        <IconButton\r\n          className={classes.sliderButton}\r\n          style={{display: \"inline-block\", verticalAlign: \"middle\"}}\r\n          onMouseDown={() => {\r\n            onIncrement(true, 1);\r\n            intervalID = setInterval(\r\n              () => onIncrement(true, 1),\r\n              SCROLLBARS_INTERVAL\r\n            );\r\n          }}\r\n          disabled={value >= (maxValue - 1)}\r\n        >\r\n          <ArrowRightIcon/>\r\n        </IconButton>\r\n        {isVerticalScrollbarVisible && (\r\n          <div style={{width: SLIDER_WIDTH, height: SLIDER_WIDTH, display: \"inline-block\", verticalAlign: \"middle\"}}/>\r\n        )}\r\n      </div>\r\n    )\r\n}\r\n\r\nfunction Scrollbars(props) {\r\n  const {\r\n    classes,\r\n    children,\r\n    verticalValue,\r\n    verticalMaxValue,\r\n    verticalTicks,\r\n    onVerticalScroll,\r\n    isVerticalScrollbarVisible,\r\n    horizontalValue,\r\n    horizontalMaxValue,\r\n    horizontalTicks,\r\n    onHorizontalScroll,\r\n    isHorizontalScrollbarVisible\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [row, setRow] = useState(verticalValue);\r\n  const [col, setCol] = useState(horizontalValue);\r\n\r\n  const [isPaginating, setIsPaginating] = useState(false);\r\n\r\n  const handleSliderScroll = (value, isVertical) => {\r\n    if (isVertical) {\r\n      setRow(value);\r\n      if (value !== row) {\r\n        setIsPaginating(true);\r\n      }\r\n    } else {\r\n      setCol(value);\r\n      if (value !== col) {\r\n        setIsPaginating(true);\r\n      }\r\n    }\r\n  };\r\n\r\n  const getIncrementedValue = (prevValue, delta, isIncrement, limit) => isIncrement\r\n    ? (prevValue + delta) > limit\r\n      ? limit\r\n      : (prevValue + delta)\r\n    : (prevValue - delta) < limit\r\n      ? limit\r\n      : (prevValue - delta);\r\n\r\n  const handleIncrement = (isIncrement, isVertical, delta, limit) => isVertical\r\n    ? setRow(prevRow => isIncrement\r\n      ? getIncrementedValue(prevRow, delta, isIncrement, (limit || (verticalMaxValue - 1)))\r\n      : getIncrementedValue(prevRow, delta, isIncrement, (limit || 0))\r\n    )\r\n    : setCol(prevCol => isIncrement\r\n      ? getIncrementedValue(prevCol, delta, isIncrement, (limit || (horizontalMaxValue - 1)))\r\n      : getIncrementedValue(prevCol, delta, isIncrement, (limit || 0))\r\n    );\r\n\r\n  const handleWheelScroll = useCallback(\r\n    ev => {\r\n      const isVertical = ev.wheelDeltaY !== 0;\r\n      const wheelDelta = isVertical\r\n        ? ev.wheelDeltaY > 0 ? -WHEEL_DELTA : WHEEL_DELTA\r\n        : ev.wheelDeltaX > 0 ? -WHEEL_DELTA : WHEEL_DELTA\r\n\r\n      const isBetween = (val, min, max) => (val >= min && val < max);\r\n\r\n      if (isVertical) {\r\n        setRow(prevRow => {\r\n          const newRow = isBetween(prevRow + wheelDelta, 0, verticalMaxValue) ? (prevRow + wheelDelta) : prevRow\r\n          return isVerticalScrollbarVisible\r\n            ? newRow\r\n            : prevRow\r\n        });\r\n      } else {\r\n        setCol(prevCol => {\r\n          const newCol = isBetween(prevCol + wheelDelta, 0, horizontalMaxValue) ? (prevCol + wheelDelta) : prevCol;\r\n          return isHorizontalScrollbarVisible\r\n            ? newCol\r\n            : prevCol\r\n        });\r\n      }\r\n    },\r\n    [isVerticalScrollbarVisible, isHorizontalScrollbarVisible, verticalMaxValue, horizontalMaxValue, setRow, setCol],\r\n  );\r\n\r\n  useEffect(() => {\r\n    document.getElementById(`scrollbars-container__${uuid}`).addEventListener(\"wheel\", handleWheelScroll);\r\n    return () => document.getElementById(`scrollbars-container__${uuid}`).removeEventListener(\"wheel\", handleWheelScroll);\r\n  }, [uuid, handleWheelScroll]);\r\n\r\n  useEffect(() => {\r\n    if (timeoutID) {\r\n      clearTimeout(timeoutID);\r\n    }\r\n\r\n    timeoutID = setTimeout(\r\n      () => {\r\n        onVerticalScroll(row);\r\n        onHorizontalScroll(col);\r\n        setIsPaginating(false);\r\n      },\r\n      SCROLLBARS_TIMEOUT\r\n    );\r\n  }, [row, col, onVerticalScroll, onHorizontalScroll, setIsPaginating]);\r\n\r\n  useEffect(() => {\r\n    setRow(verticalValue);\r\n    setCol(horizontalValue);\r\n  }, [verticalValue, horizontalValue, setRow, setCol]);\r\n\r\n  return (\r\n    <div id={`scrollbars-container__${uuid}`} style={{width: \"100%\", height: \"100%\"}}>\r\n      <div style={{width: \"100%\", height: `calc(100% - ${isHorizontalScrollbarVisible ? SLIDER_WIDTH : 0}px)`}}>\r\n        <div\r\n          style={{\r\n            width: `calc(100% - ${isVerticalScrollbarVisible ? SLIDER_WIDTH : 0}px)`,\r\n            height: \"100%\",\r\n            display: \"inline-block\",\r\n            verticalAlign: \"top\",\r\n            position: \"relative\"\r\n          }}\r\n        >\r\n          <div className={classes.spinnerOverlay} style={{filter: isPaginating ? \"blur(1px)\" : \"\"}}>{children}</div>\r\n          {isPaginating && (\r\n            <div className={classes.spinnerOverlay}>\r\n              <CustomEmpty\r\n                text={t(\"components.table.scrollbars.loading\") + \"...\"}\r\n                textStyle={{fontWeight: \"bold\"}}\r\n                color=\"#ffffff\"\r\n                backgroundColor=\"rgba(0, 0, 0, 0.1)\"\r\n                image={<CircularProgress style={{color: \"#ffffff\"}}/>}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n        {isVerticalScrollbarVisible && (\r\n          <CustomSlider\r\n            uuid={uuid}\r\n            classes={classes}\r\n            orientation=\"vertical\"\r\n            value={row}\r\n            maxValue={verticalMaxValue}\r\n            onChange={value => handleSliderScroll(value, true)}\r\n            onIncrement={(isIncrement, delta, limit) => handleIncrement(isIncrement, true, delta, limit)}\r\n            ticks={verticalTicks}\r\n            isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n          />\r\n        )}\r\n      </div>\r\n      {\r\n        isHorizontalScrollbarVisible && (\r\n          <CustomSlider\r\n            uuid={uuid}\r\n            classes={classes}\r\n            orientation=\"horizontal\"\r\n            value={col}\r\n            maxValue={horizontalMaxValue}\r\n            onChange={value => handleSliderScroll(value, false)}\r\n            onIncrement={(isIncrement, delta, limit) => handleIncrement(isIncrement, false, delta, limit)}\r\n            ticks={horizontalTicks}\r\n            isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n          />\r\n        )\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(Scrollbars)","import React, {Fragment, useCallback, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {getJsonStatTableHtml, getJsonStatTableSupportStructures} from \"./jsonStatTable\";\r\nimport \"./style.css\"\r\nimport {setDatasetHtmlGeneratingTime} from \"../../state/dataset/datasetActions\";\r\nimport Scrollbars, {SLIDER_WIDTH} from \"./Scrollbars\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport copy from \"copy-to-clipboard\";\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../label-format-selector\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\n\r\nexport const JSONSTAT_TABLE_FONT_SIZE_SM = \"s\";\r\nexport const JSONSTAT_TABLE_FONT_SIZE_MD = \"m\";\r\nexport const JSONSTAT_TABLE_FONT_SIZE_LG = \"l\";\r\n\r\nconst COLS_PER_PAGE = 30;\r\nconst ROWS_PER_PAGE = 50;\r\n\r\nconst SLIDER_SAFETY_MARGIN_PERCENTAGE = 20;\r\n\r\nconst TABLE_RIGHT_PADDING_CELL_WIDTH = 100;\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  table: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onTimeSet: time => dispatch(setDatasetHtmlGeneratingTime(time)),\r\n  addSpinnerMessage: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  markSpinnerMessage: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError)),\r\n});\r\n\r\nconst isElementInContainer = (el, container, isVerticalScrollbarVisible, isHorizontalScrollbarVisible, checkOnlyVertical) => {\r\n  const containerRect = container.getBoundingClientRect();\r\n  const elementRect = el.getBoundingClientRect();\r\n\r\n  return (\r\n    elementRect.top >= containerRect.top &&\r\n    elementRect.bottom <= (containerRect.bottom - (isHorizontalScrollbarVisible ? SLIDER_WIDTH : 0)) &&\r\n    (checkOnlyVertical === true || (\r\n      elementRect.left >= containerRect.left &&\r\n      elementRect.right <= (containerRect.right - (isVerticalScrollbarVisible ? SLIDER_WIDTH : 0))\r\n    ))\r\n  );\r\n}\r\n\r\nconst getAttributesValueString = (valueId, valueLabel) => `${(valueLabel || valueId)}${(valueLabel !== valueId) ? ` [${valueId}]` : ''}`\r\n\r\nfunction JsonStatTable(props) {\r\n  const {\r\n    classes,\r\n    jsonStat,\r\n    layout,\r\n    labelFormat = LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME,\r\n    fontSize,\r\n    isFullscreen,\r\n    isPreview = false,\r\n    removeEmptyLines = !isPreview,\r\n    isPaginated = !isPreview,\r\n    isStickyHeader = true,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    hiddenAttributes,\r\n    addSpinnerMessage,\r\n    markSpinnerMessage,\r\n    hideSpinner = false,\r\n    onTimeSet\r\n  } = props;\r\n\r\n  const {\r\n    rows,\r\n    cols,\r\n    filters,\r\n    filtersValue,\r\n    sections\r\n  } = layout;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n  const [spinnerUuid] = useState(uuidv4());\r\n\r\n  const [isFirstRender, setIsFirstRender] = useState(false);\r\n\r\n  const [tableSupportStructures, setTableSupportStructures] = useState(null);\r\n  const [htmlTable, setHtmlTable] = useState(\"\");\r\n\r\n  const [row, setRow] = useState(0);\r\n  const [col, setCol] = useState(0);\r\n\r\n  const [visibleRowCount, setVisibleRowCount] = useState(1);\r\n  const [visibleColCount, setVisibleColCount] = useState(1);\r\n\r\n  const [tableRightPadding, setTableRightPadding] = useState(0);\r\n\r\n  const [isHorizontalScrollbarVisible, setHorizontalScrollbarVisibility] = useState(null);\r\n  const [isVerticalScrollbarVisible, setVerticalScrollbarVisibility] = useState(null);\r\n\r\n  const [attributes, setAttributes] = useState(null);\r\n  const [isCopiedVisible, setCopiedVisibility] = useState(false);\r\n\r\n  const handleSnackbar = useCallback(\r\n    () => {\r\n      setCopiedVisibility(prevVal => !prevVal);\r\n    },\r\n    [setCopiedVisibility]\r\n  );\r\n\r\n  const handleStyle = useCallback(\r\n    (isFirstRender, isResizing) => {\r\n      if (!isPreview) {\r\n\r\n        if (!isResizing) {\r\n\r\n          /** attribute's tooltip handling **/\r\n          if (!isFirstRender) {\r\n            const $tooltip = $(`.jsonstat-table__${uuid} #jsonstat-table__tooltip`);\r\n            $(`.jsonstat-table__${uuid} .ca .ct`)\r\n              .hover(\r\n                function () {\r\n                  const $elem = $(this).get(0);\r\n                  const rect = $elem.getBoundingClientRect();\r\n\r\n                  const attributes = $elem.className.includes(\"ctd\")\r\n                    ? tableSupportStructures.observationAttributesMap[$elem.id].attributes\r\n                    : tableSupportStructures.dimensionAttributesMap[$elem.id.split(\",\")[0]][$elem.id.split(\",\")[1]].attributes;\r\n\r\n                  const ATTRIBUTE_HEIGHT = 18;\r\n\r\n                  attributes.forEach(({id, label, valueId, valueLabel}) => {\r\n                    $tooltip.append($(`<li class=\"cttt\"><b>${(label || id)}</b>: ${getAttributesValueString(valueId, valueLabel)}</li>`))\r\n                  })\r\n\r\n                  const left = rect.x < (window.innerWidth / 2)\r\n                    ? rect.left\r\n                    : rect.left - $tooltip.innerWidth();\r\n\r\n                  $tooltip.css({\r\n                    visibility: \"visible\",\r\n                    top: rect.top - (ATTRIBUTE_HEIGHT * attributes.length) - 30,\r\n                    left: left\r\n                  });\r\n                },\r\n                function () {\r\n                  $tooltip.empty().css({visibility: \"hidden\"});\r\n                }\r\n              )\r\n              .click(\r\n                function () {\r\n                  const $elem = $(this).get(0);\r\n\r\n                  const attributes = $elem.className.includes(\"ctd\")\r\n                    ? tableSupportStructures.observationAttributesMap[$elem.id].attributes\r\n                    : tableSupportStructures.dimensionAttributesMap[$elem.id.split(\",\")[0]][$elem.id.split(\",\")[1]].attributes;\r\n\r\n                  setAttributes(attributes);\r\n                }\r\n              );\r\n          }\r\n\r\n          /** header's height handling **/\r\n          const cell = $(`.jsonstat-table__${uuid} th.c:first`);\r\n          if ((cell.css(\"minWidth\") || \"\") === \"\" || (cell.css(\"minWidth\") || \"\") === \"0px\") {\r\n\r\n            const cellFontSize = cell.css(\"fontSize\")\r\n            const cellPaddingLeft = Number(cell.css(\"paddingLeft\").split(\"px\")[0])\r\n            const cellPaddingRight = Number(cell.css(\"paddingRight\").split(\"px\")[0])\r\n\r\n            const getTextWidthEl = $('<span>').css({\r\n              visibility: 'hidden',\r\n              position: 'absolute',\r\n              fontSize: cellFontSize\r\n            }).appendTo('body').get(0);\r\n\r\n            $(`.jsonstat-table__${uuid} table thead th`).each(function () {\r\n              const minWidth = getTextWidth($(this).text(), getTextWidthEl);\r\n              $(this).css({minWidth: ((minWidth / 2) + cellPaddingLeft + cellPaddingRight + 24)})\r\n            })\r\n\r\n            $(getTextWidthEl).remove();\r\n          }\r\n        }\r\n\r\n        if (!isPaginated) {\r\n\r\n          const stickyRowCount = (layout.cols.length + 1);\r\n          const stickyColCount = layout.rows.length;\r\n\r\n          if (isStickyHeader) {\r\n\r\n            /** header **/\r\n            const tops = [0];\r\n            const $headerRows = $(`.jsonstat-table__${uuid} thead tr`);\r\n            for (let i = 0; i < $headerRows.length; i++) {\r\n              tops.push(tops[i] + $headerRows[i].getBoundingClientRect().height);\r\n            }\r\n            for (let i = 0; i < (tops.length - 1); i++) {\r\n              $(`.jsonstat-table__${uuid} thead tr:nth-child(${i + 1}) th`).css(\"top\", tops[i]);\r\n            }\r\n\r\n            /** columns **/\r\n            const lefts = [0];\r\n            const $firstBodyRowThs = $(`.jsonstat-table__${uuid} tbody tr:not(.rs):first th`);\r\n            for (let i = 0; i < $firstBodyRowThs.length; i++) {\r\n              lefts.push(lefts[i] + $firstBodyRowThs[i].getBoundingClientRect().width);\r\n            }\r\n            for (let i = 0; i < (lefts.length - 1); i++) {\r\n              // the class \"clX\" is assigned during the html generation to the x-th column for each row, if this column have to be sticky\r\n              $(`.jsonstat-table__${uuid} th.cl${i}`).css(\"left\", lefts[i]);\r\n            }\r\n\r\n            /** sections **/\r\n            $(`.jsonstat-table__${uuid} .cs`).css({top: tops[tops.length - 1], left: 0});\r\n\r\n          } else {\r\n\r\n            if (!isFirstRender) {\r\n\r\n              /** header **/\r\n              for (let i = 0; i < stickyRowCount; i++) {\r\n                $(`.jsonstat-table__${uuid} thead tr:nth-child(${i + 1}) th`).css(\"top\", \"auto\");\r\n              }\r\n\r\n              /** columns **/\r\n              for (let i = 0; i < stickyColCount; i++) {\r\n                // the class \"clX\" is assigned during the html generation to the x-th column for each row, if this column have to be sticky\r\n                $(`.jsonstat-table__${uuid} th.cl${i}`).css(\"left\", \"auto\");\r\n              }\r\n\r\n              /** sections **/\r\n              $(`.jsonstat-table__${uuid} .cs`).css({top: \"auto\", left: \"auto\"});\r\n            }\r\n          }\r\n        }\r\n\r\n        markSpinnerMessage(spinnerUuid);\r\n      }\r\n    },\r\n    [uuid, tableSupportStructures, isPreview, isStickyHeader, isPaginated, layout, markSpinnerMessage, spinnerUuid, setAttributes]\r\n  );\r\n\r\n  const handleScrollbar = useCallback(\r\n    updateVisibleRowAndColCount => {\r\n      let $tableContainer = $(`.jsonstat-table__${uuid}`);\r\n\r\n      if ($tableContainer && tableSupportStructures) {\r\n\r\n        let isVerticalScrollbarVisible = null;\r\n        let isHorizontalScrollbarVisible = null;\r\n\r\n        const {rowCount, colCount} = tableSupportStructures;\r\n        const $table = $(`.jsonstat-table__${uuid} table`);\r\n\r\n        setVerticalScrollbarVisibility(prevIsVerticalScrollbarVisible => {\r\n          isVerticalScrollbarVisible = (row !== null && row !== undefined && row !== 0)\r\n            ? prevIsVerticalScrollbarVisible\r\n            : ((rowCount > ROWS_PER_PAGE) || (rowCount <= ROWS_PER_PAGE && $table.height() > $tableContainer.height()));\r\n          return isVerticalScrollbarVisible;\r\n        });\r\n\r\n        setHorizontalScrollbarVisibility(prevIsHorizontalScrollbarVisible => {\r\n          isHorizontalScrollbarVisible = (col !== null && col !== undefined && col !== 0)\r\n            ? prevIsHorizontalScrollbarVisible\r\n            : ((colCount > COLS_PER_PAGE) || (colCount <= COLS_PER_PAGE && ($table.width() - tableRightPadding) > $tableContainer.width()));\r\n          return isHorizontalScrollbarVisible;\r\n        });\r\n\r\n        let visibleColCount = 0;\r\n        $(`.jsonstat-table__${uuid} tbody tr:not(.rs):first td`).each((idx, el) => {\r\n          if (isElementInContainer(el, $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible)) {\r\n            visibleColCount++;\r\n          }\r\n        });\r\n        if (updateVisibleRowAndColCount) {\r\n          setVisibleColCount(visibleColCount);\r\n        }\r\n\r\n        let visibleRowCount = 0;\r\n        $(`.jsonstat-table__${uuid} tbody tr:not(.rs)`).each((idx, el) => {\r\n          if (isElementInContainer($(el).children(\"td\")[0], $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible)) {\r\n            visibleRowCount++;\r\n          }\r\n        });\r\n        $(`.jsonstat-table__${uuid} tbody tr.rs`).each((idx, el) => {\r\n          if (isElementInContainer(el, $tableContainer[0], isVerticalScrollbarVisible, isHorizontalScrollbarVisible, true)) {\r\n            visibleRowCount++;\r\n          }\r\n        });\r\n        if (updateVisibleRowAndColCount) {\r\n          setVisibleRowCount(visibleRowCount);\r\n        }\r\n      }\r\n    },\r\n    [uuid, tableSupportStructures, tableRightPadding, setVerticalScrollbarVisibility, setHorizontalScrollbarVisibility, setVisibleColCount, setVisibleRowCount, row, col]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (tableSupportStructures) {\r\n      const func = () => {\r\n        handleStyle(false, true);\r\n        handleScrollbar(true);\r\n      }\r\n      window.addEventListener(\"resize\", func);\r\n      return () => window.removeEventListener(\"resize\", func);\r\n    }\r\n  }, [tableSupportStructures, handleStyle, handleScrollbar]);\r\n\r\n  useEffect(() => {\r\n    setTableSupportStructures(getJsonStatTableSupportStructures(jsonStat, rows, cols, sections, filters, filtersValue, isPreview, removeEmptyLines, hiddenAttributes));\r\n    setRow(0);\r\n    setCol(0);\r\n    setIsFirstRender(true);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [jsonStat, rows, cols, sections, filters, filtersValue, isPreview, removeEmptyLines, setIsFirstRender]); // TODO: include \"hiddenAttributes\" in deps array\r\n\r\n  useEffect(() => {\r\n    if (tableSupportStructures) {\r\n\r\n      const {\r\n        rows,\r\n        cols,\r\n        sections,\r\n        filters,\r\n        filtersValue,\r\n        colCount,\r\n        rowCount,\r\n        colsObj,\r\n        rowsObj,\r\n        combinations,\r\n        indexesMap,\r\n        valorizedCols,\r\n        valorizedRows,\r\n        valorizedRowsPerSection,\r\n        sectionsLength,\r\n        dimensionAttributesMap,\r\n        observationAttributesMap\r\n      } = tableSupportStructures;\r\n\r\n      const rowEnd = (row + ROWS_PER_PAGE) >= rowCount ? rowCount : (row + ROWS_PER_PAGE);\r\n      const colEnd = (col + COLS_PER_PAGE) >= colCount ? colCount : (col + COLS_PER_PAGE);\r\n\r\n      const tableRightPadding = (COLS_PER_PAGE - (colEnd - col)) * TABLE_RIGHT_PADDING_CELL_WIDTH;\r\n      setTableRightPadding(tableRightPadding);\r\n\r\n      setHtmlTable(getJsonStatTableHtml(\r\n        jsonStat,\r\n        rows,\r\n        cols,\r\n        sections,\r\n        filters,\r\n        filtersValue,\r\n        colCount,\r\n        rowCount,\r\n        colsObj,\r\n        rowsObj,\r\n        combinations,\r\n        indexesMap,\r\n        valorizedCols,\r\n        valorizedRows,\r\n        valorizedRowsPerSection,\r\n        sectionsLength,\r\n        labelFormat,\r\n        (fontSize || JSONSTAT_TABLE_FONT_SIZE_MD),\r\n        decimalSeparator,\r\n        decimalPlaces,\r\n        emptyChar,\r\n        isPreview,\r\n        isPaginated\r\n          ? {\r\n            rowStart: row,\r\n            rowEnd: rowEnd,\r\n            colStart: col,\r\n            colEnd: colEnd,\r\n            tableRightPadding: !isPreview ? tableRightPadding : 1\r\n          }\r\n          : null,\r\n        dimensionAttributesMap,\r\n        observationAttributesMap,\r\n        onTimeSet\r\n      ));\r\n\r\n      $(`.jsonstat-table__${uuid}`).scrollTop(0).scrollLeft(0);\r\n    }\r\n  }, [tableSupportStructures, t, uuid, jsonStat, labelFormat, fontSize, isFullscreen, decimalSeparator, decimalPlaces, emptyChar, isPreview, isPaginated, onTimeSet, row, col]);\r\n\r\n  useEffect(() => {\r\n    if (htmlTable && htmlTable.length > 0 && isFirstRender && !isPreview && !hideSpinner) {\r\n      addSpinnerMessage(spinnerUuid, t(\"components.table.spinners.rendering\"));\r\n    }\r\n  }, [spinnerUuid, htmlTable, isFirstRender, isPreview, hideSpinner, addSpinnerMessage, t]);\r\n\r\n  useEffect(() => {\r\n    if (htmlTable && htmlTable.length > 0) {\r\n      handleStyle(isFirstRender, false);\r\n      handleScrollbar(isFirstRender);\r\n      if (isFirstRender) {\r\n        setIsFirstRender(false);\r\n      }\r\n    }\r\n  }, [htmlTable, isFirstRender, handleStyle, handleScrollbar]);\r\n\r\n  return (\r\n    <Fragment>\r\n      <Snackbar open={isCopiedVisible} autoHideDuration={2000} onClose={handleSnackbar}>\r\n        <Alert severity=\"success\" onClose={handleSnackbar}>\r\n          {t(\"components.table.alerts.attributeCopied\")}\r\n        </Alert>\r\n      </Snackbar>\r\n      {tableSupportStructures && (\r\n        <div className={classes.root}>\r\n          {isPaginated\r\n            ? (\r\n              <Scrollbars\r\n                verticalValue={row}\r\n                verticalMaxValue={tableSupportStructures.rowCount}\r\n                verticalTicks={tableSupportStructures.rowCount - (visibleRowCount - Math.floor(visibleRowCount / 100 * SLIDER_SAFETY_MARGIN_PERCENTAGE))}\r\n                onVerticalScroll={setRow}\r\n                isVerticalScrollbarVisible={isVerticalScrollbarVisible}\r\n                horizontalValue={col}\r\n                horizontalMaxValue={tableSupportStructures.colCount}\r\n                horizontalTicks={tableSupportStructures.colCount - (visibleColCount - Math.floor(visibleColCount / 100 * SLIDER_SAFETY_MARGIN_PERCENTAGE))}\r\n                onHorizontalScroll={setCol}\r\n                isHorizontalScrollbarVisible={isHorizontalScrollbarVisible}\r\n              >\r\n                <div\r\n                  className={`${classes.table} jsonstat-table jsonstat-table__${uuid}`}\r\n                  style={{overflow: \"hidden\"}}\r\n                  dangerouslySetInnerHTML={{__html: htmlTable}}\r\n                />\r\n              </Scrollbars>\r\n            )\r\n            : (\r\n              <div\r\n                className={`${classes.table} jsonstat-table jsonstat-table__${uuid}`}\r\n                style={{overflow: \"auto\"}}\r\n                dangerouslySetInnerHTML={{__html: htmlTable}}\r\n              />\r\n            )}\r\n        </div>\r\n      )}\r\n      <Dialog\r\n        open={attributes !== null}\r\n        onClose={() => setAttributes(null)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.table.dialogs.observationAttributes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{width: 480}}>\r\n          <Grid container spacing={2}>\r\n            {(attributes || []).map(({id, label, valueId, valueLabel}, idx) =>\r\n              <Grid item key={idx} xs={12}>\r\n                <b>{label || id}</b>{`: ${getAttributesValueString(valueId, valueLabel)}`}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setAttributes(null)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n          <Button\r\n            color=\"primary\"\r\n            autoFocus\r\n            onClick={() => {\r\n              copy(attributes\r\n                .map(({id, label, valueId, valueLabel}) => `${(label || id)}: ${getAttributesValueString(valueId, valueLabel)}`)\r\n                .join(\", \")\r\n              );\r\n              handleSnackbar();\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.copy\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(null, mapDispatchToProps),\r\n  withStyles(styles)\r\n)(JsonStatTable);","import _ from \"lodash\"\r\n\r\nexport function getMaxTreeDepth(tree, childrenKey) {\r\n\r\n  const recursive = node =>\r\n    node\r\n      ? 1 + Math.max(...(node[childrenKey] || []).map(recursive), 0)\r\n      : 0;\r\n\r\n  return tree\r\n    ? Math.max(...tree.map(recursive), 0)\r\n    : 0;\r\n}\r\n\r\nexport function getNodesAtDepth(tree, childrenKey, depth) {\r\n\r\n  const res = [];\r\n\r\n  const recursive = (subTree, currDepth) =>\r\n    subTree\r\n      ? (\r\n        subTree.map(node => {\r\n          if (depth === currDepth) {\r\n            res.push(_.cloneDeep(node));\r\n          }\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            recursive(node[childrenKey], currDepth + 1);\r\n          }\r\n          return null;\r\n        })\r\n      )\r\n      : [];\r\n\r\n  recursive(tree, 1);\r\n\r\n  return res;\r\n}\r\n\r\nexport function getTreeFromArray(arr, parentKey, childrenKey) {\r\n  const mappedArr = {};\r\n  const tree = [];\r\n\r\n  // first map the nodes of the array to an object -> create a hash table.\r\n  arr.forEach(el => {\r\n    el[childrenKey] = [];\r\n    mappedArr[el.id] = el;\r\n  });\r\n\r\n  arr.forEach(el => {\r\n    if (el[parentKey]) {\r\n      // if the element is not at the root level, add it to its parent array of children.\r\n      mappedArr[el[parentKey]][childrenKey].push(el);\r\n    } else {\r\n      // if the element is at the root level, add it to first level elements array.\r\n      tree.push(el);\r\n    }\r\n  });\r\n\r\n  return tree;\r\n}\r\n\r\nexport function getNode(tree, childrenKey, test) {\r\n\r\n  if (!(tree !== null && tree.length)) return null;\r\n\r\n  const foundNodes = tree.filter(test);\r\n\r\n  if (foundNodes.length) {\r\n    return foundNodes[0];\r\n  } else {\r\n    const foundNodesInChild =\r\n      tree\r\n        .filter(node => node[childrenKey])\r\n        .map(node => getNode(node[childrenKey], childrenKey, test))\r\n        .filter(result => result !== null);\r\n\r\n    if (foundNodesInChild.length) {\r\n      return foundNodesInChild[0];\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getNodes(tree, childrenKey, test) {\r\n\r\n  const res = [];\r\n\r\n  const recursive = subTree =>\r\n    subTree\r\n      ? (\r\n        subTree.map(node => {\r\n          if (test && test(node)) {\r\n            res.push(_.cloneDeep(node));\r\n          }\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            recursive(node[childrenKey]);\r\n          }\r\n          return null;\r\n        })\r\n      )\r\n      : [];\r\n\r\n  recursive(tree);\r\n\r\n  return res;\r\n}","import {Reducer} from \"@reduxjs/toolkit\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  ALL_FULL,\r\n  ALL_PARTIAL,\r\n  CRITERIA_SELECTION_MODE_ALL,\r\n  CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n  CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n  CRITERIA_SELECTION_TYPE_FULL,\r\n  CRITERIA_SELECTION_TYPE_PARTIAL,\r\n  DATASET_ACCESSIBLE_FETCH,\r\n  DATASET_CRITERIA_ALERT_HIDE,\r\n  DATASET_CRITERIA_HIDE,\r\n  DATASET_CRITERIA_LENGTH_WARNING_HIDE,\r\n  DATASET_CRITERIA_LENGTH_WARNING_SHOW,\r\n  DATASET_CRITERIA_SHOW,\r\n  DATASET_DOWNLOAD_SUBMIT,\r\n  DATASET_DOWNLOAD_WARNING_HIDE,\r\n  DATASET_FETCH,\r\n  DATASET_FETCH_ENABLE,\r\n  DATASET_HTML_GENERATING_TIME_SET,\r\n  DATASET_LABEL_FORMAT_SET,\r\n  DATASET_RESET,\r\n  DATASET_STRUCTURE_CODELIST_FETCH,\r\n  DATASET_STRUCTURE_CODELIST_FILTER_SET,\r\n  DATASET_STRUCTURE_CODELISTS_FETCH,\r\n  DATASET_STRUCTURE_FETCH,\r\n  DATASET_STRUCTURE_FETCH_ENABLE,\r\n  DATASET_TERRITORY_FETCH,\r\n  DATASET_UNAVAILABLE_VIEW_WARNING_HIDE,\r\n  DATASET_VIEWER_SET,\r\n  STEP_BY_STEP_FULL,\r\n  STEP_BY_STEP_PARTIAL\r\n} from \"./datasetActions\";\r\nimport {getTreeFromArray} from \"../../utils/tree\";\r\n// @ts-ignore\r\nimport _ from \"lodash\"\r\nimport moment from \"moment\";\r\nimport {getFilteredLayoutObject, getInitialFiltersValue, getJsonStatTableSize} from \"../../utils/jsonStat\";\r\nimport {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../../components/label-format-selector\";\r\nimport {getViewerIdxFromType} from \"../../components/data-viewer\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst TIME_PERIOD_KEY = \"TIME_PERIOD\";\r\nconst FREQ_KEY = \"FREQ\";\r\n\r\nexport const GENERATING_HTML_TIME_KEY = \"generatingHtml\";\r\nexport const OBSERVATION_COUNT_KEY = \"observationCount\";\r\nexport const SERVER_TIMINGS_KEY = \"serverTimings\";\r\n\r\nconst MAX_ALLOWED_CELLS = 1000000;\r\n\r\nconst getCompleteTableLayout = (initialLayout: any, jsonStat: any) => {\r\n  const layout = _.cloneDeep(initialLayout);\r\n\r\n  layout.rows = (initialLayout.rows || []).filter((dim: string) => jsonStat.id.includes(dim));\r\n  layout.cols = (initialLayout.cols || []).filter((dim: string) => jsonStat.id.includes(dim));\r\n  layout.sections = (initialLayout.sections || []).filter((dim: string) => jsonStat.id.includes(dim));\r\n\r\n  layout.filters = [];\r\n  jsonStat.id.forEach((dim: any) => {\r\n    if (!layout.rows.includes(dim) && !layout.cols.includes(dim) && !layout.sections.includes(dim)) {\r\n      layout.filters.push(dim);\r\n    }\r\n  })\r\n\r\n  layout.filtersValue = getInitialFiltersValue(jsonStat, layout.filters);\r\n\r\n  return layout\r\n};\r\n\r\nconst getMinAndMax = (criteria: any) => {\r\n  let min = moment().add(-20, 'y').format(\"YYYY\") + \"-01-01\";\r\n  let max = moment().add(10, 'y').format(\"YYYY\") + \"-12-31\";\r\n\r\n  return {\r\n    min: criteria.values && criteria.values[0] && criteria.values[0].id\r\n      ? moment(criteria.values[0].id).format(\"YYYY-MM-DD\")\r\n      : min,\r\n    max: criteria.values && criteria.values[1] && criteria.values[1].id\r\n      ? moment(criteria.values[1].id).format(\"YYYY-MM-DD\")\r\n      : max\r\n  }\r\n};\r\n\r\nexport const FREQ_ANNUAL = \"A\";\r\nexport const FREQ_SEMESTER = \"S\";\r\nexport const FREQ_QUARTERLY = \"Q\";\r\nexport const FREQ_MONTHLY = \"M\";\r\nconst frequencies = [FREQ_MONTHLY, FREQ_QUARTERLY, FREQ_SEMESTER, FREQ_ANNUAL];\r\n\r\nconst getFreq = (values: any) => {\r\n  return (frequencies.find(freq => (values || []).includes(freq)) || null)\r\n};\r\n\r\ntype DatasetState = {\r\n  dataset: any | null,\r\n  datasetId: string | null,\r\n  isPartialData: boolean,\r\n  isEmptyData: boolean,\r\n  isTooBigData: boolean,\r\n  isCriteriaVisible: boolean,\r\n  isCriteriaAlertVisible: boolean,\r\n  dimensions: any[] | null,\r\n  mode: string | null,\r\n  type: string | null,\r\n  viewerIdx: number,\r\n  hasViewTemplate: boolean,\r\n  hasTemplateLayout: boolean,\r\n  hasAnnotationLayout: boolean,\r\n  initialTableLayout: any | null,\r\n  initialChartLayout: any | null,\r\n  initialMapLayout: any | null,\r\n  labelFormat: string | null,\r\n  filters: any | null,\r\n  initialFilters: any | null,\r\n  decimalSeparator: string | null,\r\n  decimalPlaces: number | null\r\n  emptyChar: string | null,\r\n  enableCriteria: boolean,\r\n  enableLayout: boolean,\r\n  maxAllowedCells: number,\r\n  territorialDims: string[] | null,\r\n  codes: any[] | null,\r\n  isCodesFlat: boolean,\r\n  codelists: any[] | null,\r\n  areCodelistsFlat: boolean,\r\n  codelistsLength: number[] | null,\r\n  timePeriod: {\r\n    minDate: string | null,\r\n    maxDate: string | null,\r\n    fromDate: string | null,\r\n    toDate: string | null,\r\n    freq: string | null\r\n  },\r\n  timings: any | null,\r\n  isFetchStructureDisabled: boolean,\r\n  isFetchDatasetDisabled: boolean,\r\n  isDownloadWarningVisible: boolean,\r\n  isUnavailableViewWarningVisible: boolean,\r\n  isCriteriaLengthWarningVisible: boolean,\r\n  geometries: any | null,\r\n  geometryDetailLevels: any | null\r\n};\r\n\r\nconst initialState = {\r\n  dataset: null,\r\n  datasetId: null,\r\n  isPartialData: false,\r\n  isEmptyData: false,\r\n  isTooBigData: false,\r\n  isCriteriaVisible: false,\r\n  isCriteriaAlertVisible: false,\r\n  dimensions: null,\r\n  mode: null,\r\n  type: null,\r\n  viewerIdx: 0,\r\n  hasViewTemplate: false,\r\n  hasTemplateLayout: false,\r\n  hasAnnotationLayout: false,\r\n  initialTableLayout: null,\r\n  initialChartLayout: null,\r\n  initialMapLayout: null,\r\n  labelFormat: null,\r\n  filters: null,\r\n  initialFilters: null,\r\n  decimalSeparator: null,\r\n  decimalPlaces: null,\r\n  emptyChar: null,\r\n  enableCriteria: true,\r\n  enableLayout: true,\r\n  maxAllowedCells: MAX_ALLOWED_CELLS,\r\n  territorialDims: null,\r\n  codes: null,\r\n  isCodesFlat: false,\r\n  codelists: null,\r\n  areCodelistsFlat: false,\r\n  codelistsLength: null,\r\n  timePeriod: {\r\n    minDate: null,\r\n    maxDate: null,\r\n    fromDate: null,\r\n    toDate: null,\r\n    freq: null\r\n  },\r\n  timings: null,\r\n  isFetchStructureDisabled: true,\r\n  isFetchDatasetDisabled: true,\r\n  isDownloadWarningVisible: false,\r\n  isUnavailableViewWarningVisible: false,\r\n  isCriteriaLengthWarningVisible: false,\r\n  geometries: null,\r\n  geometryDetailLevels: null\r\n};\r\n\r\nconst datasetReducer: Reducer<DatasetState> = (\r\n  state = initialState,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case DATASET_STRUCTURE_FETCH_ENABLE: {\r\n      return {\r\n        ...state,\r\n        datasetId: action.datasetId,\r\n        isFetchStructureDisabled: false\r\n      }\r\n    }\r\n    case DATASET_FETCH_ENABLE: {\r\n      return {\r\n        ...state,\r\n        isFetchDatasetDisabled: false\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_SHOW: {\r\n      return {\r\n        ...state,\r\n        isCriteriaVisible: true\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaVisible: false,\r\n        filters: state.initialFilters,\r\n        codes: null,\r\n        isCodesFlat: false,\r\n        codelists: null,\r\n        areCodelistsFlat: false,\r\n        timePeriod: {\r\n          ...state.timePeriod,\r\n          minDate: null,\r\n          maxDate: null,\r\n          fromDate: null,\r\n          toDate: null\r\n        }\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_ALERT_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaAlertVisible: false\r\n      }\r\n    }\r\n    case DATASET_STRUCTURE_CODELIST_FILTER_SET: {\r\n\r\n      let fromDate = state.timePeriod.fromDate;\r\n      let toDate = state.timePeriod.toDate;\r\n      let freq = state.timePeriod.freq;\r\n\r\n      if (action.filters[TIME_PERIOD_KEY]) {\r\n        fromDate = action.filters[TIME_PERIOD_KEY][0];\r\n        toDate = action.filters[TIME_PERIOD_KEY][1];\r\n      }\r\n\r\n      if (action.filters[FREQ_KEY]) {\r\n        freq = getFreq(action.filters[FREQ_KEY])\r\n      }\r\n\r\n      return {\r\n        ...state,\r\n        filters: action.filters,\r\n        timePeriod: {\r\n          ...state.timePeriod,\r\n          fromDate: fromDate,\r\n          toDate: toDate,\r\n          freq: freq\r\n        }\r\n      }\r\n    }\r\n    case DATASET_RESET: {\r\n      return initialState\r\n    }\r\n    case DATASET_VIEWER_SET: {\r\n      return {\r\n        ...state,\r\n        viewerIdx: action.viewerIdx\r\n      }\r\n    }\r\n    case DATASET_LABEL_FORMAT_SET: {\r\n      return {\r\n        ...state,\r\n        labelFormat: action.labelFormat\r\n      }\r\n    }\r\n    case DATASET_DOWNLOAD_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isDownloadWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_UNAVAILABLE_VIEW_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isUnavailableViewWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_LENGTH_WARNING_SHOW: {\r\n      return {\r\n        ...state,\r\n        isCriteriaLengthWarningVisible: true,\r\n        isFetchDatasetDisabled: true\r\n      }\r\n    }\r\n    case DATASET_CRITERIA_LENGTH_WARNING_HIDE: {\r\n      return {\r\n        ...state,\r\n        isCriteriaLengthWarningVisible: false\r\n      }\r\n    }\r\n    case DATASET_HTML_GENERATING_TIME_SET: {\r\n      return {\r\n        ...state,\r\n        timings: {\r\n          ...state.timings,\r\n          [GENERATING_HTML_TIME_KEY]: action.time\r\n        }\r\n      }\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          return {\r\n            ...state,\r\n            isFetchStructureDisabled: true\r\n          }\r\n        }\r\n        case DATASET_FETCH: {\r\n          return {\r\n            ...state,\r\n            dataset: null,\r\n            isFetchDatasetDisabled: true\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DATASET_STRUCTURE_FETCH: {\r\n          const criteriaView = action.payload.response.criteriaView;\r\n\r\n          const VIEW_KEY = \"view\";\r\n          const TEMPLATE_KEY = \"template\";\r\n\r\n          const viewTemplate = action.payload.response[VIEW_KEY]\r\n            ? action.payload.response[VIEW_KEY]\r\n            : action.payload.response[TEMPLATE_KEY]\r\n              ? action.payload.response[TEMPLATE_KEY]\r\n              : null\r\n\r\n          const viewTemplateLayouts = viewTemplate\r\n            ? JSON.parse(viewTemplate.layouts)\r\n            : null;\r\n\r\n          const tableLayout = viewTemplateLayouts?.tableLayout\r\n            ? viewTemplateLayouts.tableLayout\r\n            : action.payload.response.layout\r\n              ? action.payload.response.layout\r\n              : null;\r\n\r\n          const mapLayout = viewTemplateLayouts?.mapLayout\r\n            ? viewTemplateLayouts.mapLayout\r\n            : null;\r\n\r\n          const chartLayout = viewTemplateLayouts?.chartLayout\r\n            ? viewTemplateLayouts.chartLayout\r\n            : null;\r\n\r\n          let filters = viewTemplate\r\n            ? viewTemplate.criteria\r\n            : (action.payload.response.filters && action.payload.response.filters.filterData)\r\n              ? action.payload.response.filters.filterData\r\n              : null;\r\n\r\n          if (filters) {\r\n            const dimensionsId = action.payload.response.criteria.map(({id}: any) => id);\r\n            Object.keys(filters).forEach(key => {\r\n              if (!dimensionsId.includes(key)) {\r\n                filters[key] = undefined;\r\n              }\r\n            });\r\n          }\r\n\r\n          const hasViewTemplate = (viewTemplate !== null && viewTemplate !== undefined);\r\n\r\n          return {\r\n            ...state,\r\n            hasViewTemplate: hasViewTemplate,\r\n            hasTemplateLayout: !!action.payload.response[TEMPLATE_KEY],\r\n            hasAnnotationLayout: !!action.payload.response.layout,\r\n            dimensions: action.payload.response.criteria,\r\n            mode: (criteriaView === ALL_FULL || criteriaView === ALL_PARTIAL)\r\n              ? CRITERIA_SELECTION_MODE_ALL\r\n              : CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n            type: (criteriaView === ALL_FULL || criteriaView === STEP_BY_STEP_FULL)\r\n              ? CRITERIA_SELECTION_TYPE_FULL\r\n              : (criteriaView === ALL_PARTIAL || criteriaView === STEP_BY_STEP_PARTIAL)\r\n                ? CRITERIA_SELECTION_TYPE_PARTIAL\r\n                : CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n            codelistsLength: state.codelistsLength ? state.codelistsLength : action.payload.response.criteria.map(() => null),\r\n            isCriteriaVisible: (tableLayout === null && filters === null),\r\n            viewerIdx: viewTemplate ? getViewerIdxFromType(viewTemplate.defaultView) : 0,\r\n            isUnavailableViewWarningVisible: (!!action.payload.extra?.viewId && !hasViewTemplate),\r\n            initialTableLayout: tableLayout,\r\n            initialMapLayout: mapLayout,\r\n            initialChartLayout: chartLayout,\r\n            labelFormat: (viewTemplate?.layouts?.labelFormat || LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME),\r\n            filters: (filters || {}),\r\n            initialFilters: (filters || {}),\r\n            decimalSeparator: (viewTemplate && viewTemplate.decimalSeparator)\r\n              ? localizeI18nObj(viewTemplate.decimalSeparator, action.payload.extra.defaultlanguage, action.payload.extra.languages)\r\n              : action.payload.response.decimalSeparator,\r\n            decimalPlaces: (viewTemplate?.decimalNumber || action.payload.response.decimalPlaces),\r\n            emptyChar: (viewTemplateLayouts?.tableEmptyChar || action.payload.response.emptyCellPlaceHolder),\r\n            territorialDims: (action.payload.response.territorialDimensions || []),\r\n            enableCriteria: viewTemplate?.enableCriteria !== false,\r\n            enableLayout: viewTemplate?.enableLayout !== false,\r\n            isFetchDatasetDisabled: (tableLayout === null && filters === null),\r\n            timePeriod: {\r\n              ...state.timePeriod,\r\n              freq: getFreq((filters || {})[FREQ_KEY])\r\n            },\r\n            maxAllowedCells: (action.payload.response.maxTableCells || MAX_ALLOWED_CELLS)\r\n          }\r\n        }\r\n        case DATASET_FETCH: {\r\n\r\n          const cellCount = getJsonStatTableSize(action.payload.response)\r\n\r\n          const isResponseNotValid = (\r\n            action.payload.extra.status === 204 ||\r\n            cellCount === 0 || cellCount > state.maxAllowedCells ||\r\n            action.payload.response.id.length === 0\r\n          );\r\n\r\n          return {\r\n            ...state,\r\n            dataset: (action.payload.response?.id || \"\").length !== 0 ? action.payload.response : null,\r\n\r\n            isTooBigData: cellCount > state.maxAllowedCells,\r\n            isEmptyData: (action.payload.extra.status === 204 || (action.payload.response?.id || \"\").length === 0),\r\n            isPartialData: action.payload.extra.status === 206,\r\n\r\n            isCriteriaVisible: isResponseNotValid,\r\n            isCriteriaAlertVisible: isResponseNotValid,\r\n\r\n            initialTableLayout: (action.payload.extra.tableLayout && (action.payload.response?.id || \"\").length !== 0)\r\n              ? {\r\n                ...action.payload.extra.tableLayout,\r\n                filtersValue: getInitialFiltersValue(action.payload.response, action.payload.extra.tableLayout.filters)\r\n              }\r\n              : (state.initialTableLayout && state.hasViewTemplate)\r\n                ? getFilteredLayoutObject(action.payload.response, state.initialTableLayout)\r\n                : (state.initialTableLayout && !isResponseNotValid)\r\n                  ? getCompleteTableLayout(state.initialTableLayout, action.payload.response)\r\n                  : null,\r\n            initialMapLayout: (state.initialMapLayout && !isResponseNotValid)\r\n              ? getFilteredLayoutObject(action.payload.response, state.initialMapLayout)\r\n              : null,\r\n            initialChartLayout: (state.initialChartLayout && !isResponseNotValid)\r\n              ? getFilteredLayoutObject(action.payload.response, state.initialChartLayout)\r\n              : null,\r\n\r\n            initialFilters: isResponseNotValid ? state.initialFilters : state.filters,\r\n\r\n            codes: isResponseNotValid ? state.codes : null,\r\n            isCodesFlat: isResponseNotValid ? state.isCodesFlat : false,\r\n            codelists: isResponseNotValid ? state.codelists : null,\r\n            areCodelistsFlat: isResponseNotValid ? state.areCodelistsFlat : false,\r\n            timePeriod: isResponseNotValid\r\n              ? state.timePeriod\r\n              : {\r\n                ...state.timePeriod,\r\n                minDate: null,\r\n                maxDate: null,\r\n                fromDate: null,\r\n                toDate: null\r\n              },\r\n            isCriteriaLengthWarningVisible: false,\r\n            timings: {\r\n              [OBSERVATION_COUNT_KEY]: action.payload.response?.value ? Object.keys(action.payload.response.value).length : null,\r\n              [SERVER_TIMINGS_KEY]: action.payload.extra.responseHeaders.backendtimers\r\n                ? JSON.parse(action.payload.extra.responseHeaders.backendtimers)\r\n                : null\r\n            }\r\n          }\r\n        }\r\n        case DATASET_ACCESSIBLE_FETCH: {\r\n          return {\r\n            ...state\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELIST_FETCH: {\r\n\r\n          const criteria = action.payload.response.criteria[0] || {};\r\n\r\n          let flatCodes = criteria.values ? criteria.values : [];\r\n          const codelistIdx = criteria.id ? (state.dimensions || []).map(({id}: any) => id).indexOf(criteria.id) : -1;\r\n\r\n          const newCodelistsLength = state.codelistsLength ? [...state.codelistsLength] : [];\r\n          if (codelistIdx >= 0 && criteria.id !== TIME_PERIOD_KEY) {\r\n            newCodelistsLength[codelistIdx] = flatCodes.length;\r\n          }\r\n\r\n          let isCodesFlat = true;\r\n          flatCodes.forEach((item: any) => {\r\n            if (isCodesFlat && item.parentId !== null && item.parentId !== undefined) {\r\n              isCodesFlat = false;\r\n            }\r\n          })\r\n\r\n          let minAndMax = {\r\n            min: null,\r\n            max: null\r\n          };\r\n          if (criteria.id === TIME_PERIOD_KEY) {\r\n            // @ts-ignore\r\n            minAndMax = getMinAndMax(criteria);\r\n          }\r\n\r\n          let freq = state.timePeriod.freq;\r\n          if (!freq && criteria.id === FREQ_KEY) {\r\n            freq = getFreq((criteria.values || []).map(({id}: any) => id));\r\n          }\r\n\r\n          return {\r\n            ...state,\r\n            codes: getTreeFromArray((flatCodes || []), \"parentId\", \"children\"),\r\n            isCodesFlat: isCodesFlat,\r\n            timePeriod: {\r\n              minDate: state.timePeriod.minDate || minAndMax.min,\r\n              maxDate: state.timePeriod.maxDate || minAndMax.max,\r\n              fromDate: (state.filters[TIME_PERIOD_KEY] && state.filters[TIME_PERIOD_KEY].length === 2)\r\n                ? state.filters[TIME_PERIOD_KEY][0]\r\n                : minAndMax.min,\r\n              toDate: (state.filters[TIME_PERIOD_KEY] && state.filters[TIME_PERIOD_KEY].length === 2)\r\n                ? state.filters[TIME_PERIOD_KEY][1]\r\n                : minAndMax.max,\r\n              freq: freq\r\n            },\r\n            codelistsLength: newCodelistsLength\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_CODELISTS_FETCH: {\r\n\r\n          const criteria = action.payload.response.criteria;\r\n\r\n          const flatCodelists = criteria ? criteria.map(({values}: any) => (values || [])) : [];\r\n\r\n          let areCodelistsFlat = flatCodelists.map(() => true);\r\n          flatCodelists.forEach((codelist: any, idx: number) => {\r\n            codelist.forEach((item: any) => {\r\n              if (areCodelistsFlat[idx] && item.parentId !== null && item.parentId !== undefined) {\r\n                areCodelistsFlat[idx] = false;\r\n              }\r\n            })\r\n          })\r\n\r\n          const timePeriodIdx = (state.dimensions || []).map(({id}: any) => id).indexOf(TIME_PERIOD_KEY);\r\n          const minAndMax = getMinAndMax(criteria[timePeriodIdx]);\r\n\r\n          const freqIdx = (state.dimensions || []).map(({id}: any) => id).indexOf(FREQ_KEY);\r\n\r\n          return {\r\n            ...state,\r\n            codelists: flatCodelists.map((flatCodes: any) => getTreeFromArray((flatCodes || []), \"parentId\", \"children\")),\r\n            areCodelistsFlat: areCodelistsFlat,\r\n            timePeriod: {\r\n              minDate: state.timePeriod.minDate || minAndMax.min,\r\n              maxDate: state.timePeriod.maxDate || minAndMax.max,\r\n              fromDate: state.timePeriod.fromDate || minAndMax.min,\r\n              toDate: state.timePeriod.toDate || minAndMax.max,\r\n              freq: state.timePeriod.freq\r\n                ? state.timePeriod.freq\r\n                : getFreq((criteria[freqIdx].values || []).map(({id}: any) => id))\r\n            },\r\n            codelistsLength: flatCodelists.map((codelist: any, idx: number) => idx !== timePeriodIdx ? codelist.length : null)\r\n          }\r\n        }\r\n        case DATASET_TERRITORY_FETCH: {\r\n          const detailLevels = action.payload.response.map((val: any, idx: number) => val.nutsLevel)\r\n            .reduce((acc: any, val: any) => {\r\n              if (!acc[val]) {\r\n                const label = \"Nuts level \" + val;\r\n                acc[val] = {level: val, counter: 0, label: label};\r\n              }\r\n              acc[val].counter++;\r\n              return acc;\r\n            }, [])\r\n            .filter((v: any) => {\r\n              if (v.counter <= 1) {\r\n                console.log(\"hiding NUTS level \" + v.level + \" (size = \" + v.counter + \")\");\r\n              }\r\n              return v.counter > 1\r\n            }).sort((a: any, b: any) => a.level - b.level);\r\n\r\n          return {\r\n            ...state,\r\n            geometries: action.payload.response,\r\n            geometryDetailLevels: detailLevels\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DATASET_FETCH: {\r\n          const isPayloadTooLarge = action.payload.statusCode === 413\r\n\r\n          return {\r\n            dataset: null,\r\n            datasetId: null,\r\n            isTooBigData: isPayloadTooLarge,\r\n            isEmptyData: isPayloadTooLarge ? state.isEmptyData : false,\r\n            isPartialData: isPayloadTooLarge ? state.isPartialData : false,\r\n            isCriteriaVisible: isPayloadTooLarge,\r\n            isCriteriaAlertVisible: isPayloadTooLarge,\r\n            dimensions: isPayloadTooLarge ? state.dimensions : null,\r\n            mode: isPayloadTooLarge ? state.mode : null,\r\n            type: isPayloadTooLarge ? state.type : null,\r\n            viewerIdx: isPayloadTooLarge ? state.viewerIdx : 0,\r\n            hasViewTemplate: state.hasViewTemplate,\r\n            hasTemplateLayout: state.hasTemplateLayout,\r\n            hasAnnotationLayout: state.hasAnnotationLayout,\r\n            initialTableLayout: null,\r\n            initialChartLayout: null,\r\n            initialMapLayout: null,\r\n            labelFormat: null,\r\n            filters: isPayloadTooLarge ? state.filters : null,\r\n            initialFilters: isPayloadTooLarge ? state.initialFilters : null,\r\n            decimalSeparator: isPayloadTooLarge ? state.decimalSeparator : null,\r\n            decimalPlaces: isPayloadTooLarge ? state.decimalPlaces : null,\r\n            emptyChar: isPayloadTooLarge ? state.emptyChar : null,\r\n            enableCriteria: isPayloadTooLarge ? state.enableCriteria : true,\r\n            enableLayout: isPayloadTooLarge ? state.enableLayout : true,\r\n            maxAllowedCells: state.maxAllowedCells,\r\n            territorialDims: isPayloadTooLarge ? state.territorialDims : null,\r\n            codes: isPayloadTooLarge ? state.codes : null,\r\n            isCodesFlat: isPayloadTooLarge ? state.isCodesFlat : false,\r\n            codelists: isPayloadTooLarge ? state.codelists : null,\r\n            areCodelistsFlat: isPayloadTooLarge ? state.areCodelistsFlat : false,\r\n            codelistsLength: isPayloadTooLarge ? state.codelistsLength : null,\r\n            timePeriod: isPayloadTooLarge\r\n              ? state.timePeriod\r\n              : {\r\n                ...state.timePeriod,\r\n                minDate: null,\r\n                maxDate: null,\r\n                fromDate: null,\r\n                toDate: null\r\n              },\r\n            timings: null,\r\n            isFetchStructureDisabled: true,\r\n            isFetchDatasetDisabled: true,\r\n            isDownloadWarningVisible: state.isDownloadWarningVisible,\r\n            isUnavailableViewWarningVisible: state.isUnavailableViewWarningVisible,\r\n            isCriteriaLengthWarningVisible: state.isCriteriaLengthWarningVisible,\r\n            geometries: state.geometries,\r\n            geometryDetailLevels: state.geometryDetailLevels\r\n          }\r\n        }\r\n        case DATASET_DOWNLOAD_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            isDownloadWarningVisible: action.payload.statusCode === 406\r\n          }\r\n        }\r\n        case DATASET_STRUCTURE_FETCH:\r\n        case DATASET_STRUCTURE_CODELIST_FETCH:\r\n        case DATASET_STRUCTURE_CODELISTS_FETCH: {\r\n          return initialState\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\nexport default datasetReducer;","import React from \"react\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  cardTitle: {\r\n    fontSize: 17,\r\n    fontWeight: \"bold\"\r\n  },\r\n  datasetAttributesCard: {\r\n    background: \"#F5F5F5\"\r\n  },\r\n  datasetAttributes: {\r\n    margin: 0,\r\n    padding: \"0 16px 16px\"\r\n  },\r\n  seriesAttributes: {\r\n    margin: 0,\r\n    padding: \"0 0 16px\"\r\n  },\r\n  attributeGroup: {\r\n    margin: 0,\r\n    padding: \"0 16px\"\r\n  }\r\n});\r\n\r\nconst Attribute = ({attribute, list}) =>\r\n  <Grid item xs={12}>\r\n    {`${list ? \"- \" : \"\"}${attribute.id}: ${attribute.value}`}\r\n  </Grid>;\r\n\r\nfunction AttributeList(props) {\r\n\r\n  const {\r\n    classes,\r\n    datasetAttributes,\r\n    otherAttributes\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {datasetAttributes.length > 0 && (\r\n        <Card variant=\"outlined\" className={classes.datasetAttributesCard}>\r\n          <CardHeader\r\n            title={\r\n              <div className={classes.cardTitle}>\r\n                {t(\"components.attributeList.datasetInformation.title\")}:\r\n              </div>\r\n            }\r\n            disableTypography\r\n          />\r\n          <Grid container spacing={2} className={classes.datasetAttributes}>\r\n            {datasetAttributes.map((attribute, idx) =>\r\n              <Attribute\r\n                key={idx}\r\n                attribute={attribute}\r\n              />\r\n            )}\r\n          </Grid>\r\n        </Card>\r\n      )}\r\n      {otherAttributes.length > 0 && (\r\n        <Card variant=\"outlined\" style={{marginTop: 16}}>\r\n          <CardHeader\r\n            title={\r\n              <div className={classes.cardTitle}>\r\n                {t(\"components.attributeList.seriesInformation.title\")}:\r\n              </div>\r\n            }\r\n            disableTypography\r\n          />\r\n          <Grid container spacing={2} className={classes.seriesAttributes}>\r\n            {otherAttributes.map(({dims, attributes}, idx) =>\r\n              <Grid\r\n                container\r\n                key={idx}\r\n                spacing={2}\r\n                className={classes.attributeGroup}\r\n                style={{background: idx % 2 ? \"#FFFFFF\" : \"#F5F5F5\"}}\r\n              >\r\n                <Grid item xs={12}>\r\n                  {dims.map(({id, value}, idx) =>\r\n                    <div key={idx} style={{display: \"inline-block\", marginRight: 8}}>\r\n                      <b>{id}</b>: <i>{value}</i>{idx < dims.length - 1 ? \",\" : \"\"}\r\n                    </div>\r\n                  )}\r\n                </Grid>\r\n                {attributes.map((attribute, idx) =>\r\n                  <Attribute\r\n                    key={idx}\r\n                    attribute={attribute}\r\n                    list\r\n                  />\r\n                )}\r\n              </Grid>\r\n            )}\r\n          </Grid>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(AttributeList)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport ShareIcon from '@material-ui/icons/Share';\r\nimport GetAppIcon from '@material-ui/icons/GetApp';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {goToNode} from \"../../links\";\r\nimport HomeIcon from \"@material-ui/icons/Home\";\r\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\r\nimport AccessTimeIcon from '@material-ui/icons/AccessTime';\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {GENERATING_HTML_TIME_KEY, OBSERVATION_COUNT_KEY, SERVER_TIMINGS_KEY} from \"../../state/dataset/datasetReducer\";\r\nimport ButtonSelect from \"../button-select\";\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport JsonStatTable from \"../table\";\r\nimport AttributeList from \"../attribute-list\";\r\nimport {\r\n  getDimensionAttributeMap,\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat\r\n} from \"../../utils/jsonStat\";\r\nimport {DECIMAL_PLACES_DEFAULT, DECIMAL_SEPARATOR_DEFAULT, EMPTY_CHAR_DEFAULT} from \"../../utils/formatters\";\r\nimport {\r\n  canSaveAsView,\r\n  canSaveTemplate,\r\n  canShare,\r\n  canViewTemplateOrAnnotationIcon,\r\n  canViewTimesLog\r\n} from \"../../utils/user\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport I18nTextField from \"../i18n-text-field\";\r\nimport {localizeI18nObj, validateI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  getDownloadFormatExtensionFromFormat,\r\n  getDownloadFormatLabelFromFormat,\r\n  isDownloadFormatValid\r\n} from \"../../utils/download\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px 0\"\r\n  },\r\n  headerTitle: {\r\n    marginRight: 8\r\n  },\r\n  headerActions: {},\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 500\r\n  },\r\n  titleAction: {},\r\n  subtitle: {\r\n    padding: \"0 12px 8px 48px\"\r\n  },\r\n  card: {\r\n    padding: theme.spacing(2)\r\n  },\r\n  viewer: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 16px - 64px)\",\r\n    marginTop: 16\r\n  },\r\n  field: {},\r\n  tabContent: {\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\",\r\n    height: \"calc(100% - 48px)\",\r\n    paddingTop: 16\r\n  },\r\n  attributeIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontSize: 23,\r\n    fontWeight: \"bold\",\r\n    fontFamily: \"Do Hyeon\"\r\n  },\r\n  icon: {\r\n    width: 48,\r\n    height: 48,\r\n    padding: 12,\r\n    color: \"rgba(0, 0, 0, 0.54)\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user,\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nfunction DataViewerHeader(props) {\r\n\r\n  const {\r\n    classes,\r\n    user,\r\n    defaultLanguage,\r\n    languages,\r\n    nodeId,\r\n    nodeCode,\r\n    nodeDownloadFormats,\r\n    datasetId,\r\n    datasetTitle,\r\n    hasTemplateLayout,\r\n    hasAnnotationLayout,\r\n    notes,\r\n    attachedFiles,\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    labelFormat,\r\n    tableLayout,\r\n    chartLayout,\r\n    mapLayout,\r\n    criteria,\r\n    decimalSeparator: initialDecimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    viewers,\r\n    viewerIdx,\r\n    onViewTemplateSubmit,\r\n    onDownloadSubmit,\r\n    timings\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [initialTemplate] = useState({\r\n    datasetId: \"\",\r\n    type: \"\",\r\n    title: {},\r\n    defaultView: \"\",\r\n    criteria: {},\r\n    layouts: {\r\n      tableDefaultLayout: \"\",\r\n      tableLayout: {},\r\n      tableEmptyChar: \"\",\r\n      mapLayout: {},\r\n      chartLayout: {}\r\n    },\r\n    decimalNumber: \"\",\r\n    decimalSeparator: {},\r\n    enableCriteria: true,\r\n    enableLayout: true\r\n  });\r\n\r\n  const [isViewVisible, setViewVisibility] = useState(false);\r\n\r\n  const [isTemplateVisible, setTemplateVisibility] = useState(false);\r\n  const [tabId, setTabId] = useState(0);\r\n\r\n  const [template, setTemplate] = useState(initialTemplate);\r\n\r\n  const [isAttributesVisible, setAttributesVisibility] = useState(false);\r\n\r\n  const [isNotesVisible, setNotesVisibility] = useState(false);\r\n\r\n  const [downloadFormats, setDownloadFormats] = useState([]);\r\n\r\n  const [isTimingsVisible, setTimingsVisibility] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const actionsWidth = document.getElementById(\"dataset-viewer-header__actions\")\r\n      ? document.getElementById(\"dataset-viewer-header__actions\").offsetWidth\r\n      : 0;\r\n    document.getElementById(\"dataset-viewer-header__title\").setAttribute(\"style\", `width: calc(100% - ${actionsWidth}px - 8px)`);\r\n  });\r\n\r\n  useEffect(() => {\r\n    const newDownloadFormats = [];\r\n    (nodeDownloadFormats || []).forEach(format => {\r\n      if (isDownloadFormatValid(format)) {\r\n        newDownloadFormats.push({\r\n          label: getDownloadFormatLabelFromFormat(format, t),\r\n          format: format,\r\n          extension: getDownloadFormatExtensionFromFormat(format, t)\r\n        })\r\n      }\r\n    });\r\n    setDownloadFormats(newDownloadFormats);\r\n  }, [nodeDownloadFormats, t]);\r\n\r\n  const handleViewOpen = defaultLanguage => {\r\n    setViewVisibility(true);\r\n    setTemplate({\r\n      datasetId: datasetId,\r\n      title: {\r\n        [defaultLanguage]: `${viewers[viewerIdx].title} - ${datasetTitle}`\r\n      },\r\n      defaultView: viewers[viewerIdx].type,\r\n      criteria: criteria,\r\n      layouts: {\r\n        labelFormat: labelFormat,\r\n        tableLayout: viewerIdx === 0 ? tableLayout : null,\r\n        mapLayout: viewerIdx === 1 ? mapLayout : null,\r\n        chartLayout: viewerIdx >= 2 ? chartLayout : null\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleViewClose = () => {\r\n    setViewVisibility(false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const handleViewSubmit = () => {\r\n    onViewTemplateSubmit(\r\n      {\r\n        type: \"view\",\r\n        datasetId: template.datasetId,\r\n        title: template.title,\r\n        defaultView: template.defaultView,\r\n        criteria: template.criteria,\r\n        layouts: JSON.stringify(template.layouts)\r\n      },\r\n      true\r\n    );\r\n    setViewVisibility(false);\r\n  };\r\n\r\n  const handleTemplateOpen = defaultLanguage => {\r\n    setTemplateVisibility(true);\r\n    setTemplate({\r\n      ...initialTemplate,\r\n      datasetId: datasetId,\r\n      title: {\r\n        [defaultLanguage]: datasetTitle\r\n      },\r\n      defaultView: \"table\",\r\n      criteria: criteria,\r\n      layouts: {\r\n        labelFormat: labelFormat,\r\n        tableDefaultLayout: \"custom\",\r\n        tableLayout: tableLayout,\r\n        tableEmptyChar: (emptyChar !== null && emptyChar !== undefined) ? emptyChar : EMPTY_CHAR_DEFAULT,\r\n        mapLayout: mapLayout,\r\n        chartLayout: chartLayout\r\n      },\r\n      decimalNumber: (decimalPlaces !== null && decimalPlaces !== undefined) ? decimalPlaces : DECIMAL_PLACES_DEFAULT,\r\n      decimalSeparator: {\r\n        [defaultLanguage]: (initialDecimalSeparator || DECIMAL_SEPARATOR_DEFAULT)\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleTemplateClose = () => {\r\n    setTabId(0);\r\n    setTemplateVisibility(false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const handleTemplateSubmit = () => {\r\n    onViewTemplateSubmit(\r\n      {\r\n        ...template,\r\n        type: \"template\",\r\n        criteria: template.criteria,\r\n        layouts: JSON.stringify(template.layouts)\r\n      },\r\n      false\r\n    );\r\n    setTabId(0);\r\n    setTemplateVisibility(false);\r\n    setTemplate(initialTemplate);\r\n  };\r\n\r\n  const datasetAttributes = [];\r\n  const dataset = (jsonStat?.extension?.attributes?.dataSet || []);\r\n  const datasetIndexes = (jsonStat?.extension?.attributes?.index?.dataSet || []);\r\n\r\n  if (dataset && dataset.length > 0 && datasetIndexes && datasetIndexes.length > 0) {\r\n    (datasetIndexes || []).forEach((el, idx) => {\r\n      if (el !== null && !(hiddenAttributes || []).includes(dataset[idx].id)) {\r\n        datasetAttributes.push({\r\n          id: (dataset[idx].name || dataset[idx].id),\r\n          value: (dataset[idx].values[el].name || dataset[idx].values[el].id)\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  const otherAttributes = [];\r\n  const series = (jsonStat?.extension?.attributes?.series || []);\r\n  const seriesIndexes = (jsonStat?.extension?.attributes?.index?.series || []);\r\n\r\n  if (series && series.length > 0 && seriesIndexes && seriesIndexes.length > 0) {\r\n    seriesIndexes\r\n      .filter(({coordinates}) => (coordinates || []).filter(c => c !== null).length > 1)\r\n      .forEach(({coordinates, attributes}) => {\r\n        const dimsId = [];\r\n        const dimsValueId = [];\r\n        coordinates.forEach((el, idx) => {\r\n          if (el !== null) {\r\n            const dim = jsonStat.id[idx];\r\n            dimsId.push(dim);\r\n            dimsValueId.push(jsonStat.dimension[dim].category.index[el]);\r\n          }\r\n        });\r\n        const dims = dimsId.map((dim, idx) => ({\r\n          id: getDimensionLabelFromJsonStat(jsonStat, dim, labelFormat),\r\n          value: getDimensionValueLabelFromJsonStat(jsonStat, dim, dimsValueId[idx], labelFormat)\r\n        }));\r\n        const attrs = [];\r\n        attributes.forEach((attr, idx) => {\r\n          if (attr !== null && attr !== undefined && !(hiddenAttributes || []).includes(series[idx].id)) {\r\n            attrs.push({\r\n              id: (series[idx].name || series[idx].id),\r\n              value: (series[idx].values[attr].name || series[idx].values[attr].id)\r\n            })\r\n          }\r\n        });\r\n        if (dims.length > 0 && attrs.length > 0) {\r\n          otherAttributes.push({\r\n            dims: dims,\r\n            attributes: attrs\r\n          });\r\n        }\r\n      });\r\n  }\r\n\r\n  const currentFilters = (viewers[viewerIdx].key === 0 && tableLayout?.filters)\r\n    ? tableLayout.filters\r\n    : (viewers[viewerIdx].key === 1 && mapLayout?.filters)\r\n      ? mapLayout.filters\r\n      : (viewers[viewerIdx].key >= 2 && chartLayout?.filters)\r\n        ? chartLayout.filters\r\n        : [];\r\n\r\n  const subtitle = [];\r\n  if (jsonStat && currentFilters) {\r\n    currentFilters.forEach(filter => {\r\n      if (jsonStat.size[jsonStat.id.indexOf(filter)] === 1) {\r\n        subtitle.push({\r\n          dim: filter,\r\n          dimLabel: getDimensionLabelFromJsonStat(jsonStat, filter, labelFormat),\r\n          value: jsonStat.dimension[filter].category.index[0],\r\n          valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, filter, jsonStat.dimension[filter].category.index[0], labelFormat)\r\n        });\r\n      }\r\n    })\r\n  }\r\n\r\n  const dimensionAttributesMap = getDimensionAttributeMap(jsonStat, hiddenAttributes);\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <Grid container className={classes.root}>\r\n        <Grid container justify=\"space-between\" alignItems=\"flex-start\">\r\n          <Grid item id=\"dataset-viewer-header__title\" className={classes.headerTitle}>\r\n            <Grid container alignItems=\"flex-start\">\r\n              <Grid item>\r\n                <Tooltip title={t(\"scenes.dataViewer.header.action.goHome.tooltip\")}>\r\n                  <IconButton color=\"primary\" onClick={() => goToNode(nodeCode)}>\r\n                    <HomeIcon/>\r\n                  </IconButton>\r\n                </Tooltip>\r\n              </Grid>\r\n              <Grid container style={{width: \"calc(100% - 48px)\"}}>\r\n                <Grid item className={classes.title}>\r\n                  <div style={{display: \"table\", minHeight: 48}}>\r\n                    <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n                      <span style={{marginRight: 4}}>{datasetTitle}</span>\r\n                      {notes && notes.length > 0 && (\r\n                        <Tooltip title={t(\"scenes.dataViewer.header.action.information.tooltip\")}>\r\n                          <IconButton\r\n                            id=\"dataset-attributes-btn\"\r\n                            className={classes.titleAction}\r\n                            onClick={() => setNotesVisibility(true)}\r\n                          >\r\n                            <InfoIcon/>\r\n                          </IconButton>\r\n                        </Tooltip>\r\n                      )}\r\n                      {datasetAttributes.concat(otherAttributes).length > 0 && (\r\n                        <Tooltip title={t(\"scenes.dataViewer.header.action.attributes.tooltip\")}>\r\n                          <IconButton\r\n                            id=\"dataset-attributes-btn\"\r\n                            className={classes.titleAction}\r\n                            onClick={() => setAttributesVisibility(true)}\r\n                          >\r\n                            <div className={classes.attributeIcon}>(*)</div>\r\n                          </IconButton>\r\n                        </Tooltip>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n          <Grid item id=\"dataset-viewer-header__actions\" className={classes.headerActions}>\r\n            <Grid container alignItems=\"center\">\r\n              {canViewTemplateOrAnnotationIcon(user, nodeId) && hasTemplateLayout && (\r\n                <div className={classes.icon}>\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.hasTemplate.tooltip\")}>\r\n                    <InfoIcon/>\r\n                  </Tooltip>\r\n                </div>\r\n              )}\r\n              {canViewTemplateOrAnnotationIcon(user, nodeId) && viewerIdx === 0 && !hasTemplateLayout && hasAnnotationLayout && (\r\n                <div className={classes.icon}>\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.hasAnnotationLayout.tooltip\")}>\r\n                    <InfoIcon/>\r\n                  </Tooltip>\r\n                </div>\r\n              )}\r\n              {canViewTimesLog(user, nodeId) && (\r\n                <Grid item id=\"dataset-times-log-btn\">\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.timesLog.tooltip\")}>\r\n                    <div>\r\n                      <IconButton onClick={() => setTimingsVisibility(true)} disabled={timings === null}>\r\n                        <AccessTimeIcon/>\r\n                      </IconButton>\r\n                    </div>\r\n                  </Tooltip>\r\n                </Grid>\r\n              )}\r\n              {(canSaveAsView(user) || canSaveTemplate(user, nodeId)) && (\r\n                <Grid item id=\"dataset-save-btn\">\r\n                  <ButtonSelect\r\n                    icon={<SaveIcon/>}\r\n                    tooltip={t(\"scenes.dataViewer.header.action.save.tooltip\")}\r\n                    color=\"default\"\r\n                    disabled={!tableLayout && !chartLayout && !mapLayout}\r\n                  >\r\n                    {canSaveAsView(user) && (\r\n                      <div onClick={() => handleViewOpen(defaultLanguage)}>\r\n                        {t(\"scenes.dataViewer.header.action.save.values.view\")}\r\n                      </div>\r\n                    )}\r\n                    {canSaveTemplate(user, nodeId) && (\r\n                      <div onClick={() => handleTemplateOpen(defaultLanguage)}>\r\n                        {t(\"scenes.dataViewer.header.action.save.values.template\")}\r\n                      </div>\r\n                    )}\r\n                  </ButtonSelect>\r\n                </Grid>\r\n              )}\r\n              {canShare(user) && (\r\n                <Grid item id=\"dataset-share-btn\">\r\n                  <Tooltip title={t(\"scenes.dataViewer.header.action.share.tooltip\")}>\r\n                    <IconButton onClick={window.notImplemented.show}>\r\n                      <ShareIcon/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                </Grid>\r\n              )}\r\n              <Grid item id=\"dataset-attachments-btn\">\r\n                <ButtonSelect\r\n                  icon={<AttachFileIcon/>}\r\n                  tooltip={t(\"scenes.dataViewer.header.action.attachments.tooltip\")}\r\n                  color=\"default\"\r\n                  disabled={!attachedFiles || attachedFiles.length === 0}\r\n                >\r\n                  {(attachedFiles || []).map((attachedFile, idx) => (\r\n                    <div key={idx} onClick={() => window.open(attachedFile.url)}>\r\n                      {`${attachedFile.url} (${attachedFile.format})`}\r\n                    </div>\r\n                  ))}\r\n                </ButtonSelect>\r\n              </Grid>\r\n              {(downloadFormats && downloadFormats.length > 0 && (\r\n                <Grid item id=\"dataset-export-btn\">\r\n                  <ButtonSelect\r\n                    icon={<GetAppIcon/>}\r\n                    tooltip={t(\"scenes.dataViewer.header.action.export.tooltip\")}\r\n                    color=\"default\"\r\n                  >\r\n                    {downloadFormats.map(({format, label, extension}, idx) =>\r\n                      <div key={idx} onClick={() => onDownloadSubmit(format, extension)}>{label}</div>\r\n                    )}\r\n                  </ButtonSelect>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          </Grid>\r\n        </Grid>\r\n        <Grid item className={classes.subtitle} xs={12}>\r\n          {subtitle && dimensionAttributesMap && subtitle.map(({dim, dimLabel, value, valueLabel}, idx) =>\r\n            <div key={idx} style={{display: \"inline-block\", marginRight: 8}}>\r\n              <div style={{display: \"inline-block\"}}>\r\n                <b>{dimLabel}</b>: <i>{valueLabel}</i>\r\n              </div>\r\n              {dimensionAttributesMap[dim][value] && (\r\n                <div style={{display: \"inline-block\", marginLeft: 4}}>\r\n                  <Tooltip\r\n                    title={\r\n                      <div>\r\n                        {dimensionAttributesMap[dim][value].attributes.map(({id, label, valueId, valueLabel}, idx) => (\r\n                          <div\r\n                            key={idx}>{`${label || id}: ${valueLabel || valueId}${valueLabel !== valueId ? ` [${valueId}]` : ''}`}</div>\r\n                        ))}\r\n                      </div>\r\n                    }\r\n                    placement=\"top\"\r\n                  >\r\n                    <div>\r\n                      {`[${dimensionAttributesMap[dim][value].ids.join(\", \")}]`}\r\n                    </div>\r\n                  </Tooltip>\r\n                </div>\r\n              )}\r\n              <div style={{display: \"inline-block\"}}>\r\n                {idx < subtitle.length - 1 ? \",\" : \"\"}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </Grid>\r\n      </Grid>\r\n\r\n      <Dialog\r\n        open={isAttributesVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setAttributesVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.attributes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <AttributeList\r\n            datasetAttributes={datasetAttributes}\r\n            otherAttributes={otherAttributes}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setAttributesVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isTimingsVisible}\r\n        onClose={() => setTimingsVisibility(false)}\r\n      >\r\n        <DialogContent style={{width: 400}}>\r\n          <div>\r\n            {(() => {\r\n              const toStamp = [];\r\n\r\n              const TOTAL_TIME_KEY = \"BackeEnd completed\";\r\n              const DOWNLOAD_SIZE_KEY = \"NSI Response Download Size\";\r\n\r\n              const getRow = (key, value, isBold) => (\r\n                <Grid container justify=\"space-between\" spacing={2} key={key}>\r\n                  <Grid item>\r\n                    {isBold ? <b>{key}:</b> : `${key}:`}\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <b>{value}</b>\r\n                  </Grid>\r\n                </Grid>\r\n              );\r\n\r\n              const titleStyle = {\r\n                width: \"100%\",\r\n                height: 32,\r\n                fontSize: 15\r\n              };\r\n\r\n              if (timings) {\r\n\r\n                toStamp.push(getRow(\"Observation count\", timings[OBSERVATION_COUNT_KEY], true));\r\n                toStamp.push(<Divider style={{margin: \"8px 0\"}} key=\"divider3\"/>);\r\n\r\n                /** server side **/\r\n                if (timings[SERVER_TIMINGS_KEY]) {\r\n                  toStamp.push(\r\n                    <div style={{...titleStyle, marginTop: 24}} key=\"server\"><b><u>Server timings</u></b></div>\r\n                  );\r\n                  for (const key in timings[SERVER_TIMINGS_KEY]) {\r\n                    if (timings[SERVER_TIMINGS_KEY].hasOwnProperty(key)) {\r\n                      if (key !== TOTAL_TIME_KEY && key !== DOWNLOAD_SIZE_KEY) {\r\n                        toStamp.push(\r\n                          getRow(key, timings[SERVER_TIMINGS_KEY][key])\r\n                        )\r\n                      }\r\n                    }\r\n                  }\r\n                  toStamp.push(<Divider style={{margin: \"8px 0\"}} key=\"divider1\"/>);\r\n                  toStamp.push(getRow(\"Total\", timings[SERVER_TIMINGS_KEY][TOTAL_TIME_KEY], true));\r\n                  toStamp.push(<Divider style={{margin: \"8px 0\"}} key=\"divider2\"/>);\r\n                  if (timings[SERVER_TIMINGS_KEY][DOWNLOAD_SIZE_KEY]) {\r\n                    toStamp.push(getRow(DOWNLOAD_SIZE_KEY, timings[SERVER_TIMINGS_KEY][DOWNLOAD_SIZE_KEY]));\r\n                  }\r\n                }\r\n\r\n                /** client side **/\r\n                if (timings[GENERATING_HTML_TIME_KEY] !== null && timings[GENERATING_HTML_TIME_KEY] !== undefined) {\r\n                  toStamp.push(\r\n                    <div style={{...titleStyle, marginTop: 24}} key=\"client\"><b><u>Client timings</u></b></div>\r\n                  );\r\n                  toStamp.push(getRow(\"Generating HTML\", `${timings[GENERATING_HTML_TIME_KEY]}ms`));\r\n                }\r\n              }\r\n\r\n              return toStamp\r\n            })()}\r\n          </div>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button autoFocus onClick={() => setTimingsVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isViewVisible}\r\n        onClose={handleViewClose}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.saveView.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{width: 480}}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={12}>\r\n              <FormControl fullWidth className={classes.field}>\r\n                <I18nTextField\r\n                  label=\"Title\"\r\n                  required\r\n                  variant=\"outlined\"\r\n                  value={template.title}\r\n                  onChange={value => setTemplate({...template, title: value})}\r\n                />\r\n              </FormControl>\r\n            </Grid>\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleViewClose}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button\r\n            color=\"primary\"\r\n            autoFocus\r\n            onClick={handleViewSubmit}\r\n            disabled={!validateI18nObj(template.title)}\r\n          >\r\n            {t(\"commons.confirm.save\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isTemplateVisible}\r\n        fullScreen\r\n        onClose={handleTemplateClose}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.saveTemplate.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <AppBar position=\"static\" color=\"default\">\r\n            <Tabs\r\n              value={tabId}\r\n              variant=\"scrollable\"\r\n              scrollButtons=\"auto\"\r\n              indicatorColor=\"primary\"\r\n              textColor=\"primary\"\r\n              onChange={(event, newValue) => setTabId(newValue)}\r\n            >\r\n              <Tab key={0} label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.label\")}/>\r\n              <Tab key={1} label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.label\")}/>\r\n              <Tab key={2} label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.chart.label\")}/>\r\n              <Tab key={3} label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.map.label\")}/>\r\n            </Tabs>\r\n          </AppBar>\r\n          <div className={classes.tabContent}>\r\n            {tabId === 0 && (\r\n              <Fragment>\r\n                <Card variant=\"outlined\">\r\n                  <CardHeader\r\n                    title={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.title\")}\r\n                    titleTypographyProps={{variant: \"subtitle1\"}}\r\n                  />\r\n                  <Grid container spacing={2} className={classes.card}>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <I18nTextField\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.title\")}\r\n                          required\r\n                          variant=\"outlined\"\r\n                          value={template.title}\r\n                          onChange={value => setTemplate({...template, title: value})}\r\n                        />\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <TextField\r\n                          select\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.defaultView\")}\r\n                          defaultValue=\"table\"\r\n                          value={template.defaultView}\r\n                          variant=\"outlined\"\r\n                          onChange={ev => setTemplate({...template, defaultView: ev.target.value})}\r\n                        >\r\n                          {viewers.map(({type, title}, idx) =>\r\n                            <MenuItem key={idx} value={type}>{title}</MenuItem>\r\n                          )}\r\n                        </TextField>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControlLabel\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.enableCriteria\")}\r\n                        className={classes.field}\r\n                        control={\r\n                          <Checkbox\r\n                            checked={template.enableCriteria}\r\n                            onChange={(ev, value) => setTemplate({...template, enableCriteria: value})}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControlLabel\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.enableLayout\")}\r\n                        className={classes.field}\r\n                        control={\r\n                          <Checkbox\r\n                            checked={template.enableLayout}\r\n                            onChange={(ev, value) => setTemplate({...template, enableLayout: value})}\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControlLabel\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.hideDimensions\") + \" (*)\"}\r\n                        className={classes.field}\r\n                        control={\r\n                          <Checkbox\r\n                            checked={template.hideDimensions}\r\n                            onChange={(ev, value) => setTemplate({...template, hideDimensions: value})}\r\n                            disabled\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControlLabel\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.enableVariation\") + \" (*)\"}\r\n                        className={classes.field}\r\n                        control={\r\n                          <Checkbox\r\n                            checked={true} // template.enableVariation\r\n                            onChange={(ev, value) => setTemplate({...template, enableVariation: value})}\r\n                            disabled\r\n                          />\r\n                        }\r\n                      />\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <TextField\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.decimalPlaces\")}\r\n                          value={template.decimalNumber}\r\n                          variant=\"outlined\"\r\n                          required\r\n                          onChange={ev => setTemplate({...template, decimalNumber: ev.target.value})}\r\n                        />\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <I18nTextField\r\n                          select\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.decimalSeparator.label\")}\r\n                          value={template.decimalSeparator}\r\n                          defaultValue=\".\"\r\n                          variant=\"outlined\"\r\n                          required\r\n                          onChange={value => setTemplate({...template, decimalSeparator: value})}\r\n                        >\r\n                          <MenuItem value=\".\">\r\n                            {t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.decimalSeparator.values.dot\")}\r\n                          </MenuItem>\r\n                          <MenuItem value=\",\">\r\n                            {t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.decimalSeparator.values.comma\")}\r\n                          </MenuItem>\r\n                        </I18nTextField>\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <TextField\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.general.form.filterOnLastPeriods\") + \" (*)\"}\r\n                          value={template.lastPeriods}\r\n                          type=\"number\"\r\n                          variant=\"outlined\"\r\n                          onChange={ev => setTemplate({...template, lastPeriods: ev.target.value})}\r\n                          disabled\r\n                        />\r\n                      </FormControl>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Card>\r\n                <Card variant=\"outlined\" style={{marginTop: 16}}>\r\n                  <CardHeader\r\n                    title={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.table.title\")}\r\n                    titleTypographyProps={{variant: \"subtitle1\"}}\r\n                  />\r\n                  <Grid container spacing={2} className={classes.card}>\r\n                    <Grid item xs={6}>\r\n                      <FormControl fullWidth className={classes.field}>\r\n                        <TextField\r\n                          label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.cards.table.form.emptyCellPlaceholder\")}\r\n                          value={template.layouts.tableEmptyChar}\r\n                          variant=\"outlined\"\r\n                          required\r\n                          onChange={ev => setTemplate({\r\n                            ...template,\r\n                            layouts: {\r\n                              ...template.layouts,\r\n                              tableEmptyChar: ev.target.value\r\n                            }\r\n                          })}\r\n                        />\r\n                      </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={6}/>\r\n                  </Grid>\r\n                </Card>\r\n                <div\r\n                  style={{marginTop: 16}}>{\"( *): \" + t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.options.notImplemented\")}</div>\r\n              </Fragment>\r\n            )}\r\n            {tabId === 1 && (\r\n              <Fragment>\r\n                <Grid container spacing={2}>\r\n                  <Grid item xs={12}>\r\n                    <FormControl fullWidth className={classes.field}>\r\n                      <TextField\r\n                        select\r\n                        label={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.form.defaultLayout.label\")}\r\n                        value={template.layouts.tableDefaultLayout}\r\n                        variant=\"outlined\"\r\n                        onChange={ev => setTemplate({\r\n                          ...template,\r\n                          layouts: {\r\n                            ...template.layouts,\r\n                            tableDefaultLayout: ev.target.value,\r\n                            tableLayout: ev.target.value === \"custom\"\r\n                              ? tableLayout\r\n                              : null\r\n                          }\r\n                        })}\r\n                      >\r\n                        <MenuItem value=\"custom\">\r\n                          {t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.form.defaultLayout.values.custom\")}\r\n                        </MenuItem>\r\n                        <MenuItem value=\"default\">\r\n                          {t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.form.defaultLayout.values.default\")}\r\n                        </MenuItem>\r\n                      </TextField>\r\n                    </FormControl>\r\n                  </Grid>\r\n                </Grid>\r\n                <div className={classes.viewer}>\r\n                  {template.layouts.tableDefaultLayout === \"custom\"\r\n                    ? (\r\n                      <JsonStatTable\r\n                        jsonStat={jsonStat}\r\n                        layout={tableLayout}\r\n                        labelFormat={labelFormat}\r\n                        decimalSeparator={localizeI18nObj(template.decimalSeparator, defaultLanguage, languages)}\r\n                        decimalPlaces={template.decimalNumber}\r\n                        emptyChar={template.layouts.tableEmptyChar}\r\n                        hiddenAttributes={hiddenAttributes}\r\n                      />\r\n                    )\r\n                    : (\r\n                      <CustomEmpty\r\n                        text={t(\"scenes.dataViewer.header.dialogs.saveTemplate.content.tabs.table.form.defaultLayout.defaultPlaceholder\")}/>\r\n                    )\r\n                  }\r\n                </div>\r\n              </Fragment>\r\n            )}\r\n            {tabId === 2 && (\r\n              <CustomEmpty text={t(\"commons.notImplemented\")}/>\r\n            )}\r\n            {tabId === 3 && (\r\n              <CustomEmpty text={t(\"commons.notImplemented\")}/>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleTemplateClose}>\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button\r\n            color=\"primary\"\r\n            autoFocus\r\n            onClick={handleTemplateSubmit}\r\n            disabled={(\r\n              !validateI18nObj(template.title) ||\r\n              !validateI18nObj(template.decimalSeparator) ||\r\n              !Number.isInteger(Number(template.decimalNumber)) || Number(template.decimalNumber) < 0 || Number(template.decimalNumber) > 20\r\n            )}\r\n          >\r\n            {t(\"commons.confirm.save\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isNotesVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setNotesVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.header.dialogs.notes.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          {notes}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setNotesVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps)\r\n)(DataViewerHeader)","import React, {useState} from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport MenuList from \"@material-ui/core/MenuList\";\r\nimport BarChartIcon from '@material-ui/icons/BarChart';\r\nimport BottomNavigationAction from \"@material-ui/core/BottomNavigationAction\";\r\nimport BottomNavigation from \"@material-ui/core/BottomNavigation\";\r\nimport SettingsIcon from \"@material-ui/icons/Settings\";\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Button from \"@material-ui/core/Button\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    textAlign: \"center\",\r\n    '& ul': {\r\n      padding: \"4px 0\"\r\n    }\r\n  },\r\n  floatingMenuOption: {\r\n    width: 200,\r\n    color: \"gray\"\r\n  },\r\n  floatingMenuOptionSelected: {\r\n    color: theme.palette.primary.main\r\n  },\r\n  divider: {\r\n    margin: \"4px 0\"\r\n  },\r\n  categoryTitle: {\r\n    color: \"gray\",\r\n    fontSize: 11,\r\n    fontWeight: 500\r\n  },\r\n  referenceMetadataIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontSize: 22,\r\n    fontWeight: \"bold\",\r\n    display: \"table\"\r\n  },\r\n  iFrame: {\r\n    width: 960,\r\n    border: 0\r\n  }\r\n});\r\n\r\nfunction DataViewerSideBar(props) {\r\n\r\n  const {\r\n    classes,\r\n    viewers,\r\n    selected,\r\n    referenceMetadataUrl,\r\n    onViewerSelect,\r\n    onCriteriaOpen,\r\n    onLayoutOpen\r\n  } = props;\r\n\r\n  const [anchorEl, setAnchorEl] = useState(null);\r\n\r\n  const [isRefMetaVisible, setRefMetaVisibility] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const handleViewerSelect = index => {\r\n    onViewerSelect(index);\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const isCriteriaEnabled = !!onCriteriaOpen;\r\n  const isLayoutEnabled = !!onLayoutOpen;\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <MenuList>\r\n\r\n        <BottomNavigation onChange={onCriteriaOpen} showLabels>\r\n          <BottomNavigationAction\r\n            label={t(\"scenes.dataViewer.sidebar.criteria\")}\r\n            icon={<SettingsIcon style={{color: isCriteriaEnabled ? undefined : \"rgba(0, 0, 0, 0.26)\"}}/>}\r\n            disabled={!isCriteriaEnabled}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation onChange={onLayoutOpen} showLabels>\r\n          <BottomNavigationAction\r\n            label={t(\"scenes.dataViewer.sidebar.layout\")}\r\n            icon={<EditIcon style={{color: isLayoutEnabled ? undefined : \"rgba(0, 0, 0, 0.26)\"}}/>}\r\n            disabled={!isLayoutEnabled}\r\n          />\r\n        </BottomNavigation>\r\n\r\n        <Divider className={classes.divider}/>\r\n\r\n        {referenceMetadataUrl && (\r\n          <BottomNavigation\r\n            onChange={() => setRefMetaVisibility(true)}\r\n            showLabels style={{marginBottom: 8}}\r\n          >\r\n            <BottomNavigationAction\r\n              label={t(\"scenes.dataViewer.sidebar.referenceMetadata\")}\r\n              icon={\r\n                <div className={classes.referenceMetadataIcon}>\r\n                  <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n                    M\r\n                  </div>\r\n                </div>\r\n              }\r\n            />\r\n          </BottomNavigation>\r\n        )}\r\n\r\n        <BottomNavigation\r\n          value={selected === 0 ? 0 : null}\r\n          onChange={() => handleViewerSelect(0)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction label={viewers[0].title} icon={viewers[0].icon}/>\r\n        </BottomNavigation>\r\n        <BottomNavigation\r\n          value={selected >= 2 ? 0 : null}\r\n          onChange={({currentTarget}) => setAnchorEl(currentTarget)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction\r\n            label={selected >= 2 ? viewers[selected].title : t(\"scenes.dataViewer.sidebar.chart\")}\r\n            icon={selected >= 2 ? viewers[selected].icon : <BarChartIcon/>}\r\n          />\r\n        </BottomNavigation>\r\n        <BottomNavigation\r\n          value={selected === 1 ? 0 : null}\r\n          onChange={() => handleViewerSelect(1)}\r\n          showLabels\r\n        >\r\n          <BottomNavigationAction label={viewers[1].title} icon={viewers[1].icon}/>\r\n        </BottomNavigation>\r\n\r\n      </MenuList>\r\n\r\n      <Menu\r\n        anchorEl={anchorEl}\r\n        keepMounted\r\n        open={Boolean(anchorEl)}\r\n        onClose={() => setAnchorEl(null)}\r\n      >\r\n        {viewers\r\n          .slice(2)\r\n          .map(option => (\r\n            <MenuItem\r\n              className={`${classes.floatingMenuOption} ${selected === option.key ? classes.floatingMenuOptionSelected : ''}`}\r\n              key={option.key}\r\n              selected={selected === option.key}\r\n              onClick={() => handleViewerSelect(option.key)}\r\n            >\r\n              {option.icon}\r\n              <Typography style={{marginLeft: 8}}>{option.title}</Typography>\r\n            </MenuItem>\r\n          ))}\r\n      </Menu>\r\n\r\n      <Dialog\r\n        open={isRefMetaVisible}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n        onClose={() => setRefMetaVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.sidebar.dialogs.referenceMetadata.title\")}\r\n        </DialogTitle>\r\n        <DialogContent style={{height: 480}}>\r\n          <iframe\r\n            title={\"title\"}\r\n            src={referenceMetadataUrl}\r\n            style={{\r\n              border: 0,\r\n              width: \"100%\",\r\n              height: \"calc(100% - 6px)\"\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setRefMetaVisibility(false)}>\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withStyles(styles)(DataViewerSideBar)","import React, {Fragment, useState} from 'react';\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport CancelIcon from '@material-ui/icons/Cancel';\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    whiteSpace: \"nowrap\"\r\n  },\r\n  sheet: {\r\n    display: \"inline-block\",\r\n    marginRight: 8\r\n  }\r\n});\r\n\r\nfunction DataViewerFooter(props) {\r\n\r\n  const {\r\n    classes,\r\n    labels,\r\n    dataIdx,\r\n    setData\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isConfirmOpen, setConfirmVisibility] = useState(false);\r\n\r\n  return (\r\n    <Fragment>\r\n\r\n      <div className={classes.root}>\r\n        {labels\r\n          .map((label, idx) => ({key: idx, label: label}))\r\n          .map(sheet => (\r\n            <div key={sheet.key} className={classes.sheet}>\r\n              <Chip\r\n                label={sheet.label}\r\n                color={sheet.key === dataIdx ? \"primary\" : undefined}\r\n                onClick={() => setData(sheet.key)}\r\n                deleteIcon={\r\n                  <Tooltip title={t(\"scenes.dataViewer.footer.worksheetDelete\")}>\r\n                    <CancelIcon/>\r\n                  </Tooltip>\r\n                }\r\n                onDelete={dataIdx === sheet.key\r\n                  ? undefined\r\n                  : () => setConfirmVisibility(true)\r\n                }\r\n              />\r\n            </div>\r\n          ))}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={isConfirmOpen}\r\n        onClose={() => setConfirmVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"scenes.dataViewer.footer.dialogs.worksheetDelete.title\")}\r\n        </DialogTitle>\r\n        <DialogActions>\r\n          <Button onClick={() => setConfirmVisibility(false)} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button onClick={() => setConfirmVisibility(false)} color=\"primary\" autoFocus>\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(DataViewerFooter)","import React, {Fragment, useState} from 'react';\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport {\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID,\r\n  LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n} from \"../label-format-selector\";\r\nimport {getDimensionAttributeMap, getDimensionFiltersValue} from \"../../utils/jsonStat\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  filter: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"bottom\",\r\n    minWidth: 120,\r\n    marginRight: 24,\r\n    marginBottom: 8\r\n  },\r\n  dialogContent: {\r\n    padding: \"8px !important\"\r\n  },\r\n  item: {\r\n    fontSize: 14\r\n  },\r\n  itemDisabled: {\r\n    pointerEvents: \"none\",\r\n    '& > svg': {\r\n      visibility: \"hidden\"\r\n    }\r\n  },\r\n  dimensionTitle: {\r\n    marginBottom: 4,\r\n    fontSize: 13,\r\n    color: theme.palette.primary.main\r\n  }\r\n});\r\n\r\nconst getFormattedName = (id, name, labelFormat) => {\r\n  switch (labelFormat) {\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME:\r\n      return name;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_ID:\r\n      return id;\r\n    case LABEL_FORMAT_SELECTOR_LABEL_FORMAT_BOTH:\r\n      return `[${id}] ${name}`;\r\n    default:\r\n      return name;\r\n  }\r\n};\r\n\r\nfunction DatasetFilters(props) {\r\n  const {\r\n    classes,\r\n    jsonStat,\r\n    hiddenAttributes,\r\n    layout,\r\n    labelFormat,\r\n    multiSelectDimensions,\r\n    multiSelectDimensionsValues,\r\n    onSelect\r\n  } = props;\r\n\r\n  const {\r\n    filtersValue\r\n  } = layout;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [filters] = useState((multiSelectDimensions || []).filter(el => el !== null && el !== undefined).concat(layout.filters || []));\r\n\r\n  const [visibleId, setVisibleId] = useState(null);\r\n\r\n  const [checkedKeys, setCheckedKeys] = useState(null);\r\n\r\n  const handleFilterClose = () => {\r\n    setVisibleId(null);\r\n    setCheckedKeys(null);\r\n  };\r\n\r\n  const isMultiSelectDim = dim => (multiSelectDimensions && multiSelectDimensions.length > 0)\r\n    ? multiSelectDimensions.includes(dim)\r\n    : false;\r\n\r\n  const dimensionAttributesMap = getDimensionAttributeMap(jsonStat, hiddenAttributes);\r\n\r\n  let data = [];\r\n  if (visibleId !== null) {\r\n    data = getDimensionFiltersValue(jsonStat, filters[visibleId], layout.filters, filtersValue);\r\n    if (checkedKeys === null && multiSelectDimensions !== undefined && multiSelectDimensionsValues !== undefined) {\r\n      setCheckedKeys(multiSelectDimensionsValues[filters[visibleId]]);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.root}>\r\n        {(() => {\r\n          const getTextWidthEl = $('<span>').css({\r\n            visibility: 'hidden',\r\n            position: 'absolute',\r\n            fontSize: 16\r\n          }).appendTo('body').get(0);\r\n\r\n          const select = [];\r\n          filters.forEach((filter, idx) => {\r\n\r\n            if ((multiSelectDimensions && multiSelectDimensions.includes(filter)) || jsonStat.size[jsonStat.id.indexOf(filter)] !== 1) {\r\n\r\n              const dimLabel = (jsonStat.dimension[filter].label || filter);\r\n              const minWidth = getTextWidth(dimLabel, getTextWidthEl) + 16;\r\n\r\n              select.push(\r\n                <div key={idx} className={classes.filter}>\r\n                  {isMultiSelectDim(filter) && (\r\n                    <InputLabel className={classes.dimensionTitle}>\r\n                      {multiSelectDimensions[0] === filter\r\n                        ? t(\"components.datasetFilters.primaryDim\")\r\n                        : t(\"components.datasetFilters.secondaryDim\")\r\n                      }\r\n                    </InputLabel>\r\n                  )}\r\n                  <FormControl style={{display: \"inline-block\", verticalAlign: \"bottom\"}}>\r\n                    <InputLabel>{dimLabel}</InputLabel>\r\n                    <Select\r\n                      open={false}\r\n                      style={{minWidth: minWidth}}\r\n                      value={isMultiSelectDim(filter)\r\n                        ? multiSelectDimensionsValues[filter]\r\n                        : filtersValue[filter]\r\n                      }\r\n                      multiple={isMultiSelectDim(filter)}\r\n                      renderValue={value => isMultiSelectDim(filter)\r\n                        ? jsonStat.size[jsonStat.id.indexOf(filter)] !== 1\r\n                          ? value.length === 1\r\n                            ? t(\"components.datasetFilters.selectedCount\", {selected: value.length})\r\n                            : t(\"components.datasetFilters.selectedCount_plural\", {selected: value.length})\r\n                          : getFormattedName(value[0], jsonStat.dimension[filter].category.label[value[0]], labelFormat)\r\n                        : getFormattedName(value, jsonStat.dimension[filter].category.label[value], labelFormat)\r\n                      }\r\n                      className={`${classes.item} ${jsonStat.size[jsonStat.id.indexOf(filter)] === 1 ? classes.itemDisabled : \"\"}`}\r\n                      onOpen={() => jsonStat.size[jsonStat.id.indexOf(filter)] === 1\r\n                        ? null\r\n                        : setVisibleId(idx)\r\n                      }\r\n                    >\r\n                      {jsonStat.dimension[filter].category.index.map((el, idx) => (\r\n                        <MenuItem key={idx + el} value={el}>{el}</MenuItem>\r\n                      ))}\r\n                    </Select>\r\n                  </FormControl>\r\n                  {dimensionAttributesMap && dimensionAttributesMap[filter][filtersValue[filter]] && ( // TODO: attributi per dimensioni multiselezionabili\r\n                    <div style={{display: \"inline-block\", verticalAlign: \"bottom\", marginLeft: 8, marginBottom: 4}}>\r\n                      <Tooltip\r\n                        title={\r\n                          <div>\r\n                            {dimensionAttributesMap[filter][filtersValue[filter]].attributes.map(({id, label, valueId, valueLabel}, idx) => (\r\n                              <div\r\n                                key={idx}>{`${label || id}: ${valueLabel || valueId}${valueLabel !== valueId ? ` [${valueId}]` : ''}`}</div>\r\n                            ))}\r\n                          </div>\r\n                        }\r\n                        placement=\"top\"\r\n                      >\r\n                        <div>\r\n                          {`[${dimensionAttributesMap[filter][filtersValue[filter]].ids.join(\", \")}]`}\r\n                        </div>\r\n                      </Tooltip>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )\r\n            }\r\n          });\r\n\r\n          $(getTextWidthEl).remove();\r\n\r\n          return select\r\n        })()}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={visibleId !== null}\r\n        onClose={handleFilterClose}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent className={classes.dialogContent}>\r\n          {!isMultiSelectDim(filters[visibleId])\r\n            ? (\r\n              <InfiniteScrollTable\r\n                data={data}\r\n                getRowKey={({id}) => id}\r\n                showHeader={false}\r\n                columns={[\r\n                  {\r\n                    title: \"\",\r\n                    dataIndex: 'label',\r\n                    render: (_, {id, label}) => getFormattedName(id, label, labelFormat),\r\n                    minWidth: 100\r\n                  }\r\n                ]}\r\n                onRowClick={rowData => {\r\n                  onSelect(filters[visibleId], rowData.id);\r\n                  handleFilterClose();\r\n                }}\r\n                getRowStyle={rowData => ({\r\n                  background: rowData.id === filtersValue[filters[visibleId]]\r\n                    ? \"#fff9e5\"\r\n                    : undefined\r\n                })}\r\n              />\r\n            )\r\n            : (\r\n              <InfiniteScrollTable\r\n                data={data}\r\n                getRowKey={({id}) => id}\r\n                columns={[\r\n                  {\r\n                    title: t(\"components.datasetFilters.table.columns.label.title\"),\r\n                    dataIndex: 'label',\r\n                    render: (_, {id, label}) => getFormattedName(id, label, labelFormat),\r\n                    minWidth: 100,\r\n                    noFilter: true\r\n                  }\r\n                ]}\r\n                rowSelection={{\r\n                  selectedRowKeys: checkedKeys,\r\n                  onChange: setCheckedKeys\r\n                }}\r\n              />\r\n            )\r\n          }\r\n\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleFilterClose} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          {isMultiSelectDim(filters[visibleId]) && (\r\n            <Button\r\n              onClick={() => {\r\n                onSelect(filters[visibleId], checkedKeys);\r\n                handleFilterClose();\r\n              }}\r\n              color=\"primary\"\r\n            >\r\n              {t(\"commons.confirm.confirm\")}\r\n            </Button>\r\n          )}\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(DatasetFilters);","import React, {Fragment, useEffect, useState} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport TreeItem from \"@material-ui/lab/TreeItem\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\r\nimport TreeView from \"@material-ui/lab/TreeView\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport LibraryAddCheckIcon from \"@material-ui/icons/LibraryAddCheck\";\r\nimport FilterNoneIcon from \"@material-ui/icons/FilterNone\";\r\nimport HeightIcon from \"@material-ui/icons/Height\";\r\nimport VerticalAlignCenterIcon from \"@material-ui/icons/VerticalAlignCenter\";\r\nimport AutoSearchInput from \"../auto-search-input\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport {getMaxTreeDepth, getNodesAtDepth} from \"../../utils/tree\";\r\nimport _ from \"lodash\"\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst TREE_PAGE_SIZE = 10;\r\n\r\nconst TREE_NODE_KEY_OF_LEVEL_PREFIX = \"TREE_NODE_KEY_OF_LEVEL_PREFIX_\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    height: \"100%\"\r\n  },\r\n  tree: {\r\n    overflow: \"auto\",\r\n  },\r\n  treeActions: {\r\n    marginBottom: 6\r\n  },\r\n  treeNode: {\r\n    height: 34,\r\n    padding: \"2px 0\"\r\n  },\r\n  treeNodeCheckbox: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    padding: \"4px 8px\"\r\n  },\r\n  treeNodeLabel: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    fontSize: 14,\r\n    color: \"rgba(0, 0, 0, 0.65)\"\r\n  },\r\n  levelTreeNodeLabel: {\r\n    color: \"rgba(0, 0, 0, 0.85)\",\r\n    fontWeight: 500\r\n  },\r\n  treeNodeAction: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginLeft: 4,\r\n    \"& > button\": {\r\n      padding: 4\r\n    }\r\n  },\r\n  divider: {\r\n    margin: \"4px 0\"\r\n  },\r\n  showMoreNode: {\r\n    marginLeft: 10,\r\n    \"& i\": {\r\n      fontSize: 14\r\n    }\r\n  }\r\n});\r\n\r\nconst getKeys = (tree, childrenKey, getNodeKey, test) => {\r\n\r\n  const res = [];\r\n\r\n  const recursive = subTree =>\r\n    subTree\r\n      ? subTree.map(node => {\r\n        if (node[childrenKey] && node[childrenKey].length) {\r\n          recursive(node[childrenKey]);\r\n        }\r\n        if (!test || test(node)) {\r\n          res.push(getNodeKey(node));\r\n        }\r\n        return null;\r\n      })\r\n      : [];\r\n\r\n  recursive(tree);\r\n\r\n  return res;\r\n}\r\n\r\nconst getFilteredTree = (tree, childrenKey, labelKey, searchText, defaultLanguage, languages, isLabelNotMultilingual) => {\r\n\r\n  const filterNode = node => {\r\n    const search = searchText.toLowerCase();\r\n    return (\r\n      (node.id && node.id.toLowerCase().indexOf(search) >= 0) ||\r\n      (isLabelNotMultilingual && node[labelKey].toLowerCase().indexOf(search) >= 0) ||\r\n      (!isLabelNotMultilingual && localizeI18nObj(node[labelKey], defaultLanguage, languages).toLowerCase().indexOf(search) >= 0)\r\n    );\r\n  };\r\n\r\n  const recursive = subtree => subtree\r\n    ? ([\r\n      ...subtree\r\n        .map(node => ({...node}))\r\n        .filter(node => {\r\n          if (node[childrenKey] && node[childrenKey].length) {\r\n            if (filterNode(node)) {\r\n              return true;\r\n            } else {\r\n              const filteredChildren = [...recursive(node[childrenKey], filterNode)];\r\n              if (filteredChildren.length) {\r\n                node[childrenKey] = filteredChildren;\r\n                return true;\r\n              } else {\r\n                return false;\r\n              }\r\n            }\r\n          } else {\r\n            return filterNode(node);\r\n          }\r\n        })\r\n    ])\r\n    : null;\r\n\r\n  return recursive(tree, filterNode);\r\n}\r\n\r\nconst handleHeight = (uuid, keys, withLevelSelector) => {\r\n\r\n  const actionHeight = $(`.enhanced-tree__${uuid} .enhanced-tree__actions`).css(\"height\");\r\n\r\n  let levelSelectorHeight = 0;\r\n  if (withLevelSelector) {\r\n    levelSelectorHeight = 32 + 16;\r\n    let found = false;\r\n    for (let i = 0; i < keys.length; i++) {\r\n      if (keys.find(key => key === TREE_NODE_KEY_OF_LEVEL_PREFIX + i) && !found) {\r\n        levelSelectorHeight += 32;\r\n      } else {\r\n        found = true\r\n      }\r\n    }\r\n  }\r\n\r\n  $(`.enhanced-tree__${uuid} .enhanced-tree__tree`).css(\"height\", `calc(100% - ${actionHeight} - ${levelSelectorHeight}px)`);\r\n}\r\n\r\nfunction EnhancedTree(props) {\r\n\r\n  const {\r\n    languages,\r\n    defaultLanguage,\r\n    classes,\r\n    tree,\r\n    getNodeKey,\r\n    childrenKey,\r\n    labelKey,\r\n    getNodeLabel,\r\n    checkable,\r\n    defaultExpandedKeys,\r\n    nodeActions,\r\n    withoutSearch,\r\n    withoutCheckControls,\r\n    withoutExpandControls,\r\n    withLevelSelector,\r\n    withoutPagination,\r\n    getIsCheckable,\r\n    isLabelNotMultilingual\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [searchText, setSearchText] = useState(\"\");\r\n\r\n  const [checkedKeys, setCheckedKeys] = useState(props.checkedKeys || []);\r\n  const [expandedKeys, setExpandedKeys] = useState(defaultExpandedKeys || []);\r\n  const [showMoreKeyClicks, setShowMoreKeyClicks] = useState({});\r\n\r\n  useEffect(() => {\r\n    handleHeight(uuid, [], withLevelSelector)\r\n  }, [uuid, withLevelSelector])\r\n\r\n  const handleCheck = (checkedNode, checked) => {\r\n\r\n    const newCheckedKeys = [...(props.checkedKeys || checkedKeys)];\r\n    checked\r\n      ? newCheckedKeys.push(getNodeKey(checkedNode))\r\n      : newCheckedKeys.splice((props.checkedKeys || checkedKeys).indexOf(getNodeKey(checkedNode)), 1);\r\n\r\n    setCheckedKeys(newCheckedKeys);\r\n    if (props.onCheck) {\r\n      props.onCheck(newCheckedKeys)\r\n    }\r\n  }\r\n\r\n  const handleLevelCheck = (checkedNode, checked) => {\r\n\r\n    const nodesAtDepth = getNodesAtDepth(filteredTree, childrenKey, checkedNode.level + 1)\r\n      .filter(node => getIsCheckable ? getIsCheckable(node) : true)\r\n      .map(node => getNodeKey(node));\r\n\r\n    let newCheckedKeys = [...(props.checkedKeys || checkedKeys)];\r\n    newCheckedKeys = checked\r\n      ? _.uniq(newCheckedKeys.concat(nodesAtDepth))\r\n      : newCheckedKeys.filter(key => !nodesAtDepth.includes(key));\r\n\r\n    setCheckedKeys(newCheckedKeys)\r\n    if (props.onCheck) {\r\n      props.onCheck(newCheckedKeys)\r\n    }\r\n  }\r\n\r\n  const handleExpand = expandedKeys => {\r\n    setExpandedKeys(expandedKeys);\r\n    if (props.onExpand) {\r\n      props.onExpand(expandedKeys)\r\n    }\r\n  }\r\n\r\n  const handleSearch = searchText => {\r\n    setSearchText(searchText)\r\n    setExpandedKeys((searchText && searchText.length > 0)\r\n      ? getKeys(filteredTree, childrenKey, getNodeKey)\r\n      : [] // TODO: quale dovrebbe essere il comportamento corretto?\r\n    )\r\n  }\r\n\r\n  const getShowMoreNode = parent => {\r\n\r\n    const key = `${parent ? getNodeKey(parent) : 'root'}`;\r\n\r\n    const remaining = (parent ? parent[childrenKey] : filteredTree.filter(node => node != null)).length - ((showMoreKeyClicks[key] || 0) + 1) * TREE_PAGE_SIZE;\r\n\r\n    return (\r\n      <TreeItem\r\n        key={`${key}_showMore`}\r\n        nodeId={`${key}_showMore`}\r\n        className={classes.showMoreNode}\r\n        label={\r\n          <i\r\n            onClick={e => {\r\n              e.stopPropagation();\r\n              setShowMoreKeyClicks({\r\n                ...showMoreKeyClicks,\r\n                [key]:\r\n                  showMoreKeyClicks[key]\r\n                    ? showMoreKeyClicks[key] + 1\r\n                    : 1\r\n              })\r\n            }}\r\n          >\r\n            {t(\"components.enhancedTree.showMore\", {more: Math.min(remaining, TREE_PAGE_SIZE), remaining: remaining})}\r\n          </i>\r\n        }\r\n      />\r\n    );\r\n  }\r\n\r\n  const getTreeNode = (node, getNodeKey, isLevelTree, checkable, checkedKeys, onCheck, getIsCheckable) => {\r\n\r\n    const actions = (nodeActions || [])\r\n      .filter(act => act)\r\n      .map(act => typeof (act) === \"function\" ? act(node) : act)\r\n      .filter(act => act);\r\n\r\n    return (\r\n      <TreeItem\r\n        key={getNodeKey(node)}\r\n        nodeId={getNodeKey(node)}\r\n        label={\r\n          <div className={classes.treeNode}>\r\n            {checkable && (\r\n              <Checkbox\r\n                className={classes.treeNodeCheckbox}\r\n                checked={!isLevelTree\r\n                  ? checkedKeys.includes(getNodeKey(node))\r\n                  : !getNodesAtDepth(filteredTree, childrenKey, node.level + 1).filter(node => getIsCheckable ? getIsCheckable(node) : true).map(node => getNodeKey(node)).some(val => checkedKeys.indexOf(val) === -1)}\r\n                onClick={event => {\r\n                  onCheck(node, event.target.checked);\r\n                  event.stopPropagation();\r\n                }}\r\n                disabled={getIsCheckable ? !getIsCheckable(node) : false}\r\n              />\r\n            )}\r\n            <div\r\n              className={`${classes.treeNodeLabel} ${isLevelTree ? classes.levelTreeNodeLabel : \"\"}`}\r\n            >\r\n              {(getNodeLabel && !isLevelTree)\r\n                ? getNodeLabel(node)\r\n                : isLabelNotMultilingual\r\n                  ? node[labelKey]\r\n                  : localizeI18nObj(node[labelKey], defaultLanguage, languages)\r\n              }\r\n            </div>\r\n            {!isLevelTree && (\r\n              <div className={classes.treeNodeAction}>\r\n                {actions\r\n                  .filter(action => (action !== null && action !== undefined))\r\n                  .map((action, idx) =>\r\n                    <Tooltip key={idx} title={action.title}>\r\n                      <IconButton\r\n                        onClick={event => {\r\n                          action.onClick(node);\r\n                          event.stopPropagation();\r\n                        }}\r\n                      >\r\n                        {action.icon}\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        }\r\n      >\r\n        {node[childrenKey]\r\n          ? node[childrenKey]\r\n            .filter((child, index) => withoutPagination || index < TREE_PAGE_SIZE * ((showMoreKeyClicks[getNodeKey(node)] || 0) + 1))\r\n            .map(child => getTreeNode(child, getNodeKey, isLevelTree, checkable, checkedKeys, onCheck, getIsCheckable))\r\n            .concat(!withoutPagination && node[childrenKey].length > TREE_PAGE_SIZE * ((showMoreKeyClicks[getNodeKey(node)] || 0) + 1)\r\n              ? [getShowMoreNode(node)]\r\n              : []\r\n            )\r\n          : null\r\n        }\r\n      </TreeItem>\r\n    )\r\n  };\r\n\r\n  const filteredTree = getFilteredTree(tree, childrenKey, labelKey, searchText, defaultLanguage, languages, isLabelNotMultilingual);\r\n\r\n  let levelTree = []\r\n  if (withLevelSelector) {\r\n    const maxTreeDepth = getMaxTreeDepth(filteredTree, childrenKey);\r\n    levelTree = [{\r\n      id: TREE_NODE_KEY_OF_LEVEL_PREFIX + 0,\r\n      [labelKey]: isLabelNotMultilingual\r\n        ? t(\"components.enhancedTree.levelSelector\", {level: 0})\r\n        : {\r\n          [defaultLanguage]: t(\"components.enhancedTree.levelSelector\", {level: 0})\r\n        },\r\n      level: 0,\r\n    }];\r\n    if (maxTreeDepth !== null && maxTreeDepth !== 0) {\r\n      [...Array(maxTreeDepth - 1)].forEach(() => {\r\n        let pointer = levelTree[0];\r\n        let counter = 0;\r\n        while (pointer[childrenKey]) {\r\n          pointer = pointer[childrenKey][0];\r\n          counter++;\r\n        }\r\n        pointer[childrenKey] = [\r\n          {\r\n            id: TREE_NODE_KEY_OF_LEVEL_PREFIX + Number(counter + 1),\r\n            [labelKey]: isLabelNotMultilingual\r\n              ? t(\"components.enhancedTree.levelSelector\", {level: counter + 1})\r\n              : {\r\n                [defaultLanguage]: t(\"components.enhancedTree.levelSelector\", {level: counter + 1})\r\n              },\r\n            level: counter + 1\r\n          }\r\n        ]\r\n      });\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={`enhanced-tree enhanced-tree__${uuid} ${classes.root}`}>\r\n      <div className={`enhanced-tree__actions ${classes.treeActions}`}>\r\n        <Grid container justify=\"space-between\">\r\n          <Grid item xs={6}>\r\n            {!withoutCheckControls\r\n              ? (\r\n                <Fragment>\r\n                  <Tooltip title={t(\"components.enhancedTree.selectAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => {\r\n                        const newCheckedKeys = getKeys(filteredTree, childrenKey, getNodeKey, getIsCheckable);\r\n                        setCheckedKeys(newCheckedKeys)\r\n                        if (props.onCheck) {\r\n                          props.onCheck(newCheckedKeys)\r\n                        }\r\n                      }}\r\n                    >\r\n                      <LibraryAddCheckIcon/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                  <Tooltip title={t(\"components.enhancedTree.deselectAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => {\r\n                        setCheckedKeys([])\r\n                        if (props.onCheck) {\r\n                          props.onCheck([])\r\n                        }\r\n                      }}\r\n                    >\r\n                      <FilterNoneIcon style={{padding: 1}}/>\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                </Fragment>\r\n              )\r\n              : null\r\n            }\r\n            {!withoutExpandControls\r\n              ? (\r\n                <Fragment>\r\n                  <Tooltip title={t(\"components.enhancedTree.expandAll.tooltip\")}>\r\n                    <IconButton\r\n                      onClick={() => handleExpand(getKeys(filteredTree, childrenKey, getNodeKey))}><HeightIcon/></IconButton>\r\n                  </Tooltip>\r\n                  <Tooltip title={t(\"components.enhancedTree.collapseAll.tooltip\")}>\r\n                    <IconButton onClick={() => handleExpand([])}><VerticalAlignCenterIcon/></IconButton>\r\n                  </Tooltip>\r\n                </Fragment>\r\n              )\r\n              : null\r\n            }\r\n          </Grid>\r\n          <Grid item xs={6} style={{padding: \"8px 0\"}}>\r\n            {!withoutSearch\r\n              ? (\r\n                <AutoSearchInput\r\n                  onSearch={handleSearch}\r\n                />\r\n              )\r\n              : null\r\n            }\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n      {withLevelSelector && getKeys(filteredTree, childrenKey, getNodeKey).length > 1 && (\r\n        <Fragment>\r\n          <TreeView\r\n            defaultCollapseIcon={<ExpandMoreIcon/>}\r\n            defaultExpandIcon={<ChevronRightIcon/>}\r\n            disableSelection\r\n            onNodeToggle={(ev, nodeIds) => handleHeight(uuid, nodeIds, withLevelSelector)}\r\n          >\r\n            {levelTree.map(node => getTreeNode(node, ({id}) => id, true, checkable, (props.checkedKeys || checkedKeys), handleLevelCheck, getIsCheckable))}\r\n          </TreeView>\r\n          <Divider className={classes.divider}/>\r\n        </Fragment>\r\n      )}\r\n      <div className={`enhanced-tree__tree ${classes.tree}`}>\r\n        {(filteredTree && filteredTree.length > 0)\r\n          ? (\r\n            <TreeView\r\n              defaultCollapseIcon={<ExpandMoreIcon/>}\r\n              defaultExpandIcon={<ChevronRightIcon/>}\r\n              disableSelection\r\n              expanded={expandedKeys}\r\n              onNodeToggle={(ev, nodeIds) => handleExpand(nodeIds)}\r\n            >\r\n              {filteredTree.map(node => getTreeNode(node, getNodeKey, false, checkable, (props.checkedKeys || checkedKeys), handleCheck, getIsCheckable))}\r\n            </TreeView>\r\n          )\r\n          : <CustomEmpty/>\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(EnhancedTree)","import React, {Fragment} from 'react';\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {DatePicker, MuiPickersUtilsProvider} from '@material-ui/pickers';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport moment from \"moment\";\r\nimport _ from \"lodash\"\r\nimport {FREQ_MONTHLY, FREQ_QUARTERLY, FREQ_SEMESTER} from \"../../state/dataset/datasetReducer\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  selectContainer: {\r\n    marginTop: 16\r\n  },\r\n  formControl: {\r\n    width: \"100%\"\r\n  },\r\n  timePeriodInput: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst periods = year => ({\r\n  [FREQ_SEMESTER]: {\r\n    values: [\"S1\", \"S2\"],\r\n    S1: {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    S2: {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  [FREQ_QUARTERLY]: {\r\n    values: [\"Q1\", \"Q2\", \"Q3\", \"Q4\"],\r\n    Q1: {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-03`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q2: {\r\n      start: `${year}-04-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q3: {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-09`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    Q4: {\r\n      start: `${year}-10-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  [FREQ_MONTHLY]: {\r\n    values: [\"01\", \"02\", \"03\", \"04\", \"05\", \"06\", \"07\", \"08\", \"09\", \"10\", \"11\", \"12\"],\r\n    \"01\": {\r\n      start: `${year}-01-01`,\r\n      end: moment(`${year}-01`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"02\": {\r\n      start: `${year}-02-01`,\r\n      end: moment(`${year}-02`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"03\": {\r\n      start: `${year}-03-01`,\r\n      end: moment(`${year}-03`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"04\": {\r\n      start: `${year}-04-01`,\r\n      end: moment(`${year}-04`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"05\": {\r\n      start: `${year}-05-01`,\r\n      end: moment(`${year}-05`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"06\": {\r\n      start: `${year}-06-01`,\r\n      end: moment(`${year}-06`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"07\": {\r\n      start: `${year}-07-01`,\r\n      end: moment(`${year}-07`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"08\": {\r\n      start: `${year}-08-01`,\r\n      end: moment(`${year}-08`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"09\": {\r\n      start: `${year}-09-01`,\r\n      end: moment(`${year}-09`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"10\": {\r\n      start: `${year}-10-01`,\r\n      end: moment(`${year}-10`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"11\": {\r\n      start: `${year}-11-01`,\r\n      end: moment(`${year}-11`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    },\r\n    \"12\": {\r\n      start: `${year}-12-01`,\r\n      end: moment(`${year}-12`, \"YYYY-MM\").endOf('month').format('YYYY-MM-DD')\r\n    }\r\n  }\r\n})\r\n\r\nconst getYearsArray = (startYear, endYear) => {\r\n  const res = [];\r\n\r\n  if (startYear && endYear) {\r\n    const startYearNumeric = Number(startYear);\r\n    const endYearNumeric = Number(endYear);\r\n\r\n    for (let i = startYearNumeric; i <= endYearNumeric; i++) {\r\n      res.push(i + \"\");\r\n    }\r\n  }\r\n\r\n  return res;\r\n}\r\n\r\nconst getPeriod = (freq, date) => {\r\n  if (freq && date) {\r\n    const year = date.slice(0, 4);\r\n\r\n    if (periods(year)[freq]) {\r\n      const dateMoment = moment(date, \"YYYY-MM-DD\");\r\n\r\n      return periods(year)[freq].values.find(period => {\r\n        const start = moment(periods(year)[freq][period].start, \"YYYY-MM-DD\");\r\n        const end = moment(periods(year)[freq][period].end, \"YYYY-MM-DD\");\r\n\r\n        return dateMoment.isBetween(start, end, null, \"[]\");\r\n      });\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\nconst getNewFiltersFromYear = (date, year, minYear, maxYear, period, minPeriod, maxPeriod, timePeriod, filters, timePeriodKey, isFrom) => {\r\n  const newFilters = _.cloneDeep(filters);\r\n\r\n  let newDate;\r\n  if (isFrom) {\r\n    if (year === minYear && period && minPeriod) {\r\n      if (moment((year + period), \"YYYY-MM-DD\").isSameOrAfter(moment(timePeriod.minDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].start;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][minPeriod].start;\r\n      }\r\n\r\n    } else if (year === maxYear && period && maxPeriod) {\r\n      if (moment((year + period), \"YYYY-MM-DD\").isSameOrBefore(moment(timePeriod.maxDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].start;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][maxPeriod].start;\r\n      }\r\n\r\n    } else {\r\n      newDate = period\r\n        ? periods(year)[timePeriod.freq][period].start\r\n        : year + \"-01-01\";\r\n    }\r\n\r\n  } else {\r\n    if (year === minYear && period && minPeriod) {\r\n      if (period && moment((year + period), \"YYYY-MM-DD\").isSameOrAfter(moment(timePeriod.minDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].end;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][minPeriod].end;\r\n      }\r\n\r\n    } else if (year === maxYear && period && maxPeriod) {\r\n      if (period && moment((year + period), \"YYYY-MM-DD\").isSameOrBefore(moment(timePeriod.maxDate, \"YYYY-MM-DD\"))) {\r\n        newDate = periods(year)[timePeriod.freq][period].end;\r\n      } else {\r\n        newDate = periods(year)[timePeriod.freq][maxPeriod].end;\r\n      }\r\n\r\n    } else {\r\n      newDate = period\r\n        ? periods(year)[timePeriod.freq][period].end\r\n        : year + \"-12-31\";\r\n    }\r\n  }\r\n\r\n  if (isFrom) {\r\n    newFilters[timePeriodKey] = [newDate, timePeriod.toDate];\r\n  } else {\r\n    newFilters[timePeriodKey] = [timePeriod.fromDate, newDate];\r\n  }\r\n\r\n  return newFilters;\r\n}\r\n\r\nconst handleSetFilters = (newFilters, timePeriodKey, onSetFilters, setCriteriaValidity) => {\r\n  onSetFilters(newFilters);\r\n  setCriteriaValidity(moment(newFilters[timePeriodKey][0], \"YYYY-MM-DD\").isSameOrBefore(moment(newFilters[timePeriodKey][1], \"YYYY-MM-DD\")));\r\n}\r\n\r\nconst TimePeriod = ({\r\n                      t,\r\n                      classes,\r\n                      timePeriod,\r\n                      timePeriodKey,\r\n                      filters,\r\n                      onSetFilters,\r\n                      isCriteriaValid,\r\n                      setCriteriaValidity\r\n                    }) => {\r\n\r\n  const minYear = timePeriod.minDate ? moment(timePeriod.minDate).format(\"YYYY\") : null;\r\n  const maxYear = timePeriod.maxDate ? moment(timePeriod.maxDate).format(\"YYYY\") : null;\r\n  const fromYear = timePeriod.fromDate ? moment(timePeriod.fromDate).format(\"YYYY\") : null;\r\n  const toYear = timePeriod.toDate ? moment(timePeriod.toDate).format(\"YYYY\") : null;\r\n\r\n  const minPeriod = getPeriod(timePeriod.freq, timePeriod.minDate);\r\n  const maxPeriod = getPeriod(timePeriod.freq, timePeriod.maxDate);\r\n  const fromPeriod = getPeriod(timePeriod.freq, timePeriod.fromDate);\r\n  const toPeriod = getPeriod(timePeriod.freq, timePeriod.toDate);\r\n\r\n  const fromPeriods = periods(fromYear)[timePeriod.freq]\r\n    ? periods(fromYear)[timePeriod.freq].values.slice(\r\n      fromYear === minYear ? periods(fromYear)[timePeriod.freq].values.indexOf(minPeriod) : 0,\r\n      fromYear === maxYear ? periods(fromYear)[timePeriod.freq].values.indexOf(maxPeriod) + 1 : undefined\r\n    )\r\n    : []\r\n  const toPeriods = periods(toYear)[timePeriod.freq]\r\n    ? periods(toYear)[timePeriod.freq].values.slice(\r\n      toYear === minYear ? periods(toYear)[timePeriod.freq].values.indexOf(minPeriod) : 0,\r\n      toYear === maxYear ? periods(toYear)[timePeriod.freq].values.indexOf(maxPeriod) + 1 : undefined\r\n    )\r\n    : []\r\n\r\n  return timePeriod.freq !== null\r\n    ? (\r\n      <Fragment>\r\n        <Grid container spacing={2} className={classes.selectContainer}>\r\n          {!isCriteriaValid && (\r\n            <Grid item xs={12}>\r\n              <Alert severity=\"warning\">{t(\"components.criteria.timePeriod.alert.notValidRange\")}</Alert>\r\n            </Grid>\r\n          )}\r\n          <Grid item xs={12}>\r\n            {t(\"components.criteria.timePeriod.start\")}\r\n          </Grid>\r\n          <Grid item xs={periods(fromYear)[timePeriod.freq] !== undefined ? 6 : 12}>\r\n            {fromYear && minYear && toYear && (\r\n              <FormControl className={classes.formControl}>\r\n                <InputLabel>{t(\"components.criteria.timePeriod.year\")}</InputLabel>\r\n                <Select\r\n                  value={fromYear}\r\n                  onChange={ev => {\r\n                    const year = ev.target.value;\r\n                    const newFilters = getNewFiltersFromYear(timePeriod.fromDate, year, minYear, maxYear, fromPeriod, minPeriod, maxPeriod, timePeriod, filters, timePeriodKey, true);\r\n                    handleSetFilters(newFilters, timePeriodKey, onSetFilters, setCriteriaValidity);\r\n                  }}\r\n                >\r\n                  {getYearsArray(minYear, maxYear).map((year, idx) => (\r\n                    <MenuItem key={idx} value={year}>{year}</MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            )}\r\n          </Grid>\r\n          <Grid item xs={6}>\r\n            {fromYear && periods(fromYear)[timePeriod.freq] !== undefined && fromPeriods && fromPeriod && (\r\n              <FormControl className={classes.formControl}>\r\n                <InputLabel>{t(\"components.criteria.timePeriod.period\")}</InputLabel>\r\n                <Select\r\n                  value={fromPeriod}\r\n                  onChange={ev => {\r\n                    const period = ev.target.value;\r\n                    const newFilters = _.cloneDeep(filters);\r\n                    newFilters[timePeriodKey] = [periods(fromYear)[timePeriod.freq][period].start, timePeriod.toDate];\r\n                    handleSetFilters(newFilters, timePeriodKey, onSetFilters, setCriteriaValidity);\r\n                  }}\r\n                >\r\n                  {fromPeriods.map((period, idx) => (\r\n                    <MenuItem key={idx} value={period}>{period}</MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            )}\r\n          </Grid>\r\n        </Grid>\r\n        <Grid container spacing={2} className={classes.selectContainer}>\r\n          <Grid item xs={12}>\r\n            {t(\"components.criteria.timePeriod.end\")}\r\n          </Grid>\r\n          <Grid item xs={periods(toYear)[timePeriod.freq] !== undefined ? 6 : 12}>\r\n            {toYear && fromYear && maxYear && (\r\n              <FormControl className={classes.formControl}>\r\n                <InputLabel>{t(\"components.criteria.timePeriod.year\")}</InputLabel>\r\n                <Select\r\n                  value={toYear}\r\n                  onChange={ev => {\r\n                    const year = ev.target.value;\r\n                    const newFilters = getNewFiltersFromYear(timePeriod.toDate, year, minYear, maxYear, toPeriod, minPeriod, maxPeriod, timePeriod, filters, timePeriodKey, false);\r\n                    handleSetFilters(newFilters, timePeriodKey, onSetFilters, setCriteriaValidity);\r\n                  }}\r\n                >\r\n                  {getYearsArray(minYear, maxYear).map((year, idx) => (\r\n                    <MenuItem key={idx} value={year}>{year}</MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            )}\r\n          </Grid>\r\n          <Grid item xs={6}>\r\n            {toYear && periods(toYear)[timePeriod.freq] !== undefined && toPeriods && toPeriod && (\r\n              <FormControl className={classes.formControl}>\r\n                <InputLabel>{t(\"components.criteria.timePeriod.period\")}</InputLabel>\r\n                <Select\r\n                  value={toPeriods.includes(toPeriod) ? toPeriod : toPeriods[toPeriods.length - 1]}\r\n                  onChange={ev => {\r\n                    const period = ev.target.value;\r\n                    const newFilters = _.cloneDeep(filters);\r\n                    newFilters[timePeriodKey] = [timePeriod.fromDate, periods(toYear)[timePeriod.freq][period].end];\r\n                    handleSetFilters(newFilters, timePeriodKey, onSetFilters, setCriteriaValidity);\r\n                  }}\r\n                >\r\n                  {toPeriods.map((period, idx) => (\r\n                    <MenuItem key={idx} value={period}>{period}</MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            )}\r\n          </Grid>\r\n        </Grid>\r\n      </Fragment>\r\n    )\r\n    : (\r\n      <Grid container spacing={3} style={{margin: \"8px 0\"}}>\r\n        <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n          <Grid item xs={6}>\r\n            <DatePicker\r\n              openTo=\"year\"\r\n              format=\"yyyy-MM-dd\"\r\n              label={t(\"components.criteria.timePeriod.from\")}\r\n              views={[\"year\", \"month\", \"date\"]}\r\n              clearable\r\n              minDate={moment(timePeriod.minDate)}\r\n              maxDate={moment(timePeriod.toDate)}\r\n              value={moment(timePeriod.fromDate)}\r\n              onChange={date => {\r\n                const newFilters = _.cloneDeep(filters);\r\n                newFilters[timePeriodKey] = [date ? moment(date).format(\"YYYY-MM-DD\") : timePeriod.minDate, timePeriod.toDate];\r\n                onSetFilters(newFilters)\r\n              }}\r\n              className={classes.timePeriodInput}\r\n            />\r\n          </Grid>\r\n          <Grid item xs={6}>\r\n            <DatePicker\r\n              openTo=\"year\"\r\n              format=\"yyyy-MM-dd\"\r\n              label={t(\"components.criteria.timePeriod.to\")}\r\n              views={[\"year\", \"month\", \"date\"]}\r\n              clearable\r\n              minDate={moment(timePeriod.fromDate)}\r\n              maxDate={moment(timePeriod.maxDate)}\r\n              value={moment(timePeriod.toDate)}\r\n              onChange={date => {\r\n                const newFilters = _.cloneDeep(filters);\r\n                newFilters[timePeriodKey] = [timePeriod.fromDate, date ? moment(date).format(\"YYYY-MM-DD\") : timePeriod.maxDate];\r\n                onSetFilters(newFilters)\r\n              }}\r\n              className={classes.timePeriodInput}\r\n            />\r\n          </Grid>\r\n        </MuiPickersUtilsProvider>\r\n      </Grid>\r\n    )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(TimePeriod)","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Call from \"../../hocs/call\";\r\nimport {\r\n  CRITERIA_SELECTION_MODE_ALL,\r\n  CRITERIA_SELECTION_MODE_STEP_BY_STEP,\r\n  CRITERIA_SELECTION_TYPE_DYNAMIC,\r\n  fetchDatasetStructureCodelist,\r\n  fetchDatasetStructureCodelists,\r\n  setDatasetStructureCodelistFilters\r\n} from \"../../state/dataset/datasetActions\";\r\nimport EnhancedTree from \"../enhanced-tree\";\r\nimport _ from \"lodash\"\r\nimport PlaylistAddCheckIcon from \"@material-ui/icons/PlaylistAddCheck\"\r\nimport {Tooltip} from \"@material-ui/core\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport TimePeriod from \"./TimePeriod\";\r\nimport Typography from '@material-ui/core/Typography';\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst TIME_PERIOD_KEY = \"TIME_PERIOD\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  treeContainer: {\r\n    width: \"100%\",\r\n    height: 340,\r\n    padding: 8\r\n  },\r\n  timePeriodContainer: {\r\n    width: \"100%\",\r\n    height: 380,\r\n    padding: 8\r\n  },\r\n  treeActions: {\r\n    marginBottom: 8\r\n  },\r\n  codelistInfo: {\r\n    margin: \"16px 8px 0 8px\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  structure: state.dataset.structure\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchCodelist: ({nodeId, datasetId, dimensionId, type, filters}) => dispatch(fetchDatasetStructureCodelist(nodeId, datasetId, dimensionId, type, filters)),\r\n  fetchCodelists: ({nodeId, datasetId, type}) => dispatch(fetchDatasetStructureCodelists(nodeId, datasetId, type)),\r\n  onSetFilters: filters => dispatch(setDatasetStructureCodelistFilters(filters))\r\n});\r\n\r\nfunction Criteria(props) {\r\n  const {\r\n    t,\r\n    classes,\r\n    nodeId,\r\n    datasetId,\r\n    dimensions,\r\n    mode,\r\n    type,\r\n    codes,\r\n    isCodesFlat,\r\n    codelists,\r\n    areCodelistsFlat,\r\n    codelistsLength,\r\n    filters,\r\n    timePeriod,\r\n    fetchCodelist,\r\n    fetchCodelists,\r\n    onSetFilters,\r\n    isCriteriaValid,\r\n    setCriteriaValidity\r\n  } = props;\r\n\r\n  const [tabId, setTabId] = useState(0);\r\n  const [isCallDisabled, setIsCallDisabled] = useState(false);\r\n\r\n  const [tmpFilters, setTmpFilters] = useState(null);\r\n  const [tmpTabId, setTmpTabId] = useState(null);\r\n\r\n  const handleTabChange = tabId => {\r\n\r\n    if (type === CRITERIA_SELECTION_TYPE_DYNAMIC && tabId < (dimensions.length - 1)) {\r\n      const filtersToRemove = [];\r\n      const newFilters = _.cloneDeep(filters);\r\n\r\n      for (let i = tabId + 1; i < dimensions.length; i++) {\r\n        if (filters[dimensions[i].id] !== null && filters[dimensions[i].id] !== undefined && filters[dimensions[i].id] !== []) {\r\n          filtersToRemove.push(dimensions[i].id)\r\n        }\r\n      }\r\n\r\n      if (filtersToRemove.length > 0) {\r\n        filtersToRemove.forEach(dim => newFilters[dim] = undefined);\r\n        setTmpFilters(newFilters);\r\n        setTmpTabId(tabId);\r\n\r\n      } else {\r\n        setTabId(tabId);\r\n        setIsCallDisabled(false);\r\n      }\r\n\r\n    } else {\r\n      setTabId(tabId);\r\n      setIsCallDisabled(false);\r\n    }\r\n  };\r\n\r\n  const handleCheck = checkedKeys => {\r\n    const newFilters = _.cloneDeep(filters);\r\n\r\n    newFilters[dimensions[tabId].id] = checkedKeys;\r\n    onSetFilters(newFilters);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (dimensions && isCallDisabled === false) {\r\n      setIsCallDisabled(true)\r\n    }\r\n  }, [dimensions, isCallDisabled]);\r\n\r\n  const checkedKeys = (filters[dimensions[tabId].id] || []);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      {dimensions && (\r\n        <Fragment>\r\n          <AppBar position=\"static\" color=\"default\">\r\n            <Tabs\r\n              value={tabId}\r\n              variant=\"scrollable\"\r\n              scrollButtons=\"auto\"\r\n              indicatorColor=\"primary\"\r\n              textColor=\"primary\"\r\n              onChange={(event, newValue) => handleTabChange(newValue)}\r\n            >\r\n              {(dimensions || []).map((dim, idx) => (\r\n                <Tab\r\n                  key={idx}\r\n                  label={\r\n                    <Tooltip title={dim.label || \"\"}>\r\n                      <span>\r\n                        {dim.id + (\r\n                          codelistsLength[idx]\r\n                            ? ` (${(filters && filters[dim.id]) ? filters[dim.id].length : 0}/${codelistsLength[idx]})`\r\n                            : '')\r\n                        }\r\n                      </span>\r\n                    </Tooltip>\r\n                  }\r\n                  disabled={!isCriteriaValid}\r\n                />\r\n              ))}\r\n            </Tabs>\r\n          </AppBar>\r\n          <div key={tabId}>\r\n            <Call\r\n              cb={mode === CRITERIA_SELECTION_MODE_STEP_BY_STEP\r\n                ? fetchCodelist\r\n                : fetchCodelists\r\n              }\r\n              cbParam={{\r\n                nodeId,\r\n                datasetId,\r\n                dimensionId: dimensions[tabId].id,\r\n                mode,\r\n                type,\r\n                filters\r\n              }}\r\n              disabled={!nodeId || !datasetId || !dimensions || (mode === CRITERIA_SELECTION_MODE_ALL && !!codelists) || isCallDisabled}\r\n            >\r\n              {dimensions[tabId].id !== TIME_PERIOD_KEY\r\n                ? (\r\n                  <Fragment>\r\n                    <Typography className={classes.codelistInfo}>\r\n                      {`${dimensions[tabId].label || dimensions[tabId].id}${dimensions[tabId]?.extra?.DataStructureRef ? ` (${dimensions[tabId].extra.DataStructureRef})` : \"\"}`}\r\n                    </Typography>\r\n                    <div className={classes.treeContainer}>\r\n                      {(isCodesFlat === true || (areCodelistsFlat && areCodelistsFlat[tabId] === true))\r\n                        ? (\r\n                          <InfiniteScrollTable\r\n                            data={mode === CRITERIA_SELECTION_MODE_STEP_BY_STEP\r\n                              ? (codes || [])\r\n                              : ((codelists || {})[tabId] || [])\r\n                            }\r\n                            getRowKey={({id}) => id}\r\n                            columns={[\r\n                              {\r\n                                title: t(\"components.criteria.table.columns.name.title\"),\r\n                                dataIndex: 'name',\r\n                                render: (_, {id, name}) => `[${id}] ${name}`,\r\n                                minWidthToContent: true,\r\n                                noFilter: true\r\n                              }\r\n                            ]}\r\n                            rowSelection={{\r\n                              selectedRowKeys: checkedKeys,\r\n                              onChange: handleCheck,\r\n                            }}\r\n                            height={200}\r\n                          />\r\n                        )\r\n                        : (\r\n                          <EnhancedTree\r\n                            key={tabId}\r\n                            tree={mode === CRITERIA_SELECTION_MODE_STEP_BY_STEP\r\n                              ? (codes || [])\r\n                              : ((codelists || {})[tabId] || [])\r\n                            }\r\n                            getNodeKey={({id}) => id}\r\n                            childrenKey=\"children\"\r\n                            labelKey=\"name\"\r\n                            getNodeLabel={node => `[${node.id}] ${node.name}`}\r\n                            isLabelNotMultilingual\r\n                            checkable\r\n                            withLevelSelector\r\n                            checkedKeys={checkedKeys}\r\n                            getIsCheckable={node => node.isSelectable !== false}\r\n                            // defaultExpandedKeys={filters[dimensions[tabId].id] || []}\r\n                            onCheck={handleCheck}\r\n                            nodeActions={[\r\n                              node => (node.children && node.children.length > 0)\r\n                                ? {\r\n                                  icon: <PlaylistAddCheckIcon/>,\r\n                                  title: t(\"components.criteria.tree.nodeActions.selectAll.title\"),\r\n                                  onClick: node => {\r\n                                    let newCheckedKeys = [...checkedKeys];\r\n                                    const childrenKeys = (node.children || []).filter(({isSelectable}) => isSelectable !== false).map(({id}) => id)\r\n                                    const unselectedChildrenKeys = childrenKeys.filter(key => !newCheckedKeys.includes(key))\r\n\r\n                                    newCheckedKeys = (unselectedChildrenKeys.length > 0)\r\n                                      ? newCheckedKeys.concat(childrenKeys)\r\n                                      : newCheckedKeys.filter(key => !childrenKeys.includes(key));\r\n                                    handleCheck(_.uniq(newCheckedKeys));\r\n                                  }\r\n                                }\r\n                                : null\r\n                            ]}\r\n                          />\r\n                        )}\r\n                    </div>\r\n                  </Fragment>\r\n                )\r\n                : (\r\n                  <div className={classes.timePeriodContainer}>\r\n                    <TimePeriod\r\n                      timePeriod={timePeriod}\r\n                      timePeriodKey={TIME_PERIOD_KEY}\r\n                      filters={filters}\r\n                      onSetFilters={onSetFilters}\r\n                      isCriteriaValid={isCriteriaValid}\r\n                      setCriteriaValidity={setCriteriaValidity}\r\n                    />\r\n                  </div>\r\n                )\r\n              }\r\n            </Call>\r\n          </div>\r\n\r\n          <Dialog\r\n            open={tmpFilters !== null}\r\n            fullWidth\r\n            maxWidth=\"sm\"\r\n            onClose={() => setTmpFilters(null)}\r\n          >\r\n            <DialogContent>\r\n              {t(\"components.criteria.dialogs.warning.losingFilters.title\")}\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button\r\n                onClick={() => {\r\n                  setTmpFilters(null);\r\n                  setTmpTabId(null);\r\n                }}\r\n              >\r\n                cancel\r\n              </Button>\r\n              <Button\r\n                autoFocus\r\n                onClick={() => {\r\n                  setTmpFilters(null);\r\n                  onSetFilters(tmpFilters);\r\n                  setTmpTabId(null);\r\n                  setTabId(tmpTabId);\r\n                  setIsCallDisabled(false);\r\n                }}\r\n                color=\"primary\"\r\n              >\r\n                ok\r\n              </Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n\r\n        </Fragment>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps, mapDispatchToProps)\r\n)(Criteria)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport ViewCompactIcon from '@material-ui/icons/ViewCompact';\r\nimport ViewStreamIcon from '@material-ui/icons/ViewStream';\r\nimport ViewColumnIcon from '@material-ui/icons/ViewColumn';\r\nimport JsonStatTable from \"../table\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {Tooltip} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sectionContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(60% - 8px)\",\r\n    marginRight: 16\r\n  },\r\n  section: {\r\n    height: 216,\r\n    background: \"#eeeeee\"\r\n  },\r\n  sectionHeaderContainer: {\r\n    height: 48,\r\n    padding: \"16px 16px 0\"\r\n  },\r\n  sectionHeaderIcon: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginRight: 8\r\n  },\r\n  sectionHeaderTitle: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    height: 30,\r\n  },\r\n  sectionContentWrapper: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 48px)\",\r\n    padding: 16\r\n  },\r\n  draggingHover: {\r\n    border: \"1px dashed #999999\"\r\n  },\r\n  sectionContent: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\"\r\n  },\r\n  sectionItem: {\r\n    textAlign: \"center\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px\"\r\n  },\r\n  previewContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(40% - 8px)\"\r\n  },\r\n  divider: {\r\n    marginBottom: 16\r\n  }\r\n});\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n  userSelect: 'none',\r\n  height: 32,\r\n  marginBottom: 8,\r\n  ...draggableStyle\r\n});\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const [removed] = list.splice(startIndex, 1);\r\n  list.splice(endIndex, 0, removed);\r\n};\r\n\r\nconst move = (source, destination, droppableSource, droppableDestination) => {\r\n  const [removed] = source.splice(droppableSource.index, 1);\r\n  destination.splice(droppableDestination.index, 0, removed);\r\n};\r\n\r\nconst onDragEnd = (result, dimensions, setDimensions) => {\r\n\r\n  const {\r\n    source,\r\n    destination\r\n  } = result;\r\n\r\n  // dropped outside the list\r\n  if (!destination) {\r\n    return;\r\n  }\r\n\r\n  const newDimensions = JSON.parse(JSON.stringify(dimensions));\r\n\r\n  if (source.droppableId === destination.droppableId) {\r\n    reorder(\r\n      newDimensions[source.droppableId],\r\n      source.index,\r\n      destination.index\r\n    );\r\n\r\n  } else {\r\n    move(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source,\r\n      destination\r\n    );\r\n  }\r\n\r\n  setDimensions(newDimensions);\r\n};\r\n\r\nconst Section = ({\r\n                   classes,\r\n                   id,\r\n                   title,\r\n                   Icon,\r\n                   dimensions,\r\n                   jsonStat\r\n                 }) =>\r\n\r\n  <Card variant=\"outlined\" className={classes.section}>\r\n    <CardHeader\r\n      title={\r\n        <Fragment>\r\n          <div className={classes.sectionHeaderIcon}>{Icon}</div>\r\n          <Typography className={classes.sectionHeaderTitle} variant=\"button\">{title}</Typography>\r\n        </Fragment>\r\n      }\r\n      className={classes.sectionHeaderContainer}\r\n    />\r\n    <Droppable droppableId={id}>\r\n      {(provided, snapshot) => (\r\n        <div className={`${classes.sectionContentWrapper} ${snapshot.isDraggingOver ? classes.draggingHover : \"\"}`}>\r\n          <div ref={provided.innerRef} className={classes.sectionContent}>\r\n            {dimensions.map((item, idx) =>\r\n              <Draggable\r\n                key={idx}\r\n                index={idx}\r\n                draggableId={`${id}-${idx}`}\r\n              >\r\n                {(provided, snapshot) => (\r\n                  <div\r\n                    ref={provided.innerRef}\r\n                    {...provided.draggableProps}\r\n                    {...provided.dragHandleProps}\r\n                    style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\r\n                  >\r\n                    <Tooltip title={jsonStat.dimension[item].label}>\r\n                      <Paper className={classes.sectionItem}>\r\n                        {`${item} (${jsonStat.size[jsonStat.id.indexOf(item)]})`}\r\n                      </Paper>\r\n                    </Tooltip>\r\n                  </div>\r\n                )}\r\n              </Draggable>\r\n            )}\r\n            {provided.placeholder}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  </Card>;\r\n\r\nconst TableLayout = ({\r\n                       t,\r\n                       classes,\r\n                       jsonStat,\r\n                       layout,\r\n                       labelFormat,\r\n                       setLayout\r\n                     }) => {\r\n  const {\r\n    filters,\r\n    sections,\r\n    rows,\r\n    cols,\r\n  } = layout;\r\n\r\n  let colCount = 1;\r\n  cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  let rowCount = 1;\r\n  rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n  sections.forEach(section => rowCount *= jsonStat.size[jsonStat.id.indexOf(section)]);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider className={classes.divider}/>\r\n      <div className={classes.sectionContainer}>\r\n        <DragDropContext onDragEnd={result => onDragEnd(result, layout, setLayout)}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"filters\"\r\n                title={t(\"components.tableLayout.sections.filters\")}\r\n                Icon={<FilterListIcon/>}\r\n                dimensions={filters}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"sections\"\r\n                title={t(\"components.tableLayout.sections.sections\")}\r\n                Icon={<ViewCompactIcon/>}\r\n                dimensions={sections}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"rows\"\r\n                title={t(\"components.tableLayout.sections.rows\")}\r\n                Icon={<ViewStreamIcon/>}\r\n                dimensions={rows}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                id=\"cols\"\r\n                title={t(\"components.tableLayout.sections.columns\")}\r\n                Icon={<ViewColumnIcon/>}\r\n                dimensions={cols}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n        </DragDropContext>\r\n      </div>\r\n      <div className={`${classes.previewContainer}`}>\r\n        <JsonStatTable\r\n          jsonStat={jsonStat}\r\n          layout={layout}\r\n          labelFormat={labelFormat}\r\n          isPreview={true}\r\n        />\r\n        <Grid container spacing={1} style={{marginTop: 16}}>\r\n          <Grid item xs={12} style={{textAlign: \"end\"}}>\r\n            {t(\"components.tableLayout.rowCount\", {rowCount})}\r\n          </Grid>\r\n          <Grid item xs={12} style={{textAlign: \"end\"}}>\r\n            {t(\"components.tableLayout.colCount\", {colCount})}\r\n          </Grid>\r\n        </Grid>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(TableLayout)","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\n\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_SM = \"sm\";\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_MD = \"md\";\r\nexport const FONT_SIZE_SELECTOR_FONT_SIZE_LG = \"lg\";\r\n\r\nconst styles = theme => ({\r\n  fontSizeIcon: {\r\n    width: 24,\r\n    height: 24,\r\n    fontWeight: \"bold\",\r\n    display: \"table\"\r\n  },\r\n  fontSizeIconSm: {\r\n    fontSize: 14\r\n  },\r\n  fontSizeIconMd: {\r\n    fontSize: 16\r\n  },\r\n  fontSizeIconLg: {\r\n    fontSize: 20\r\n  },\r\n  fontSizeSelected: {\r\n    \"& div\": {\r\n      boxShadow: \"inset 0 -2px 0 0 rgba(0, 0, 0, .54)\"\r\n    }\r\n  }\r\n});\r\n\r\nconst getFontSizeIcon = styleClasses =>\r\n  <div className={styleClasses}>\r\n    <div style={{display: \"table-cell\", verticalAlign: \"middle\"}}>\r\n      A\r\n    </div>\r\n  </div>;\r\n\r\nconst FontSizeSelector = ({\r\n  t,\r\n                            classes,\r\n                            fontSize,\r\n                            setFontSize\r\n                          }) =>\r\n\r\n  <Fragment>\r\n    <Tooltip title={t(\"components.fontSizeSelector.small.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_SM ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_SM)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconSm}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n    <Tooltip title={t(\"components.fontSizeSelector.normal.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_MD ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_MD)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconMd}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n    <Tooltip title={t(\"components.fontSizeSelector.big.tooltip\")}>\r\n      <IconButton\r\n        className={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_LG ? classes.fontSizeSelected : \"\"}\r\n        onClick={() => setFontSize(FONT_SIZE_SELECTOR_FONT_SIZE_LG)}\r\n      >\r\n        {getFontSizeIcon(`${classes.fontSizeIcon} ${classes.fontSizeIconLg}`)}\r\n      </IconButton>\r\n    </Tooltip>\r\n  </Fragment>;\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(FontSizeSelector)","import React, {Component, createRef} from 'react';\r\nimport ChartJs from 'chart.js';\r\nimport {numberFormatter} from \"../../utils/formatters\";\r\nimport {\r\n  getDataIdxFromDimensionsArray,\r\n  getDimensionValueLabelFromJsonStat,\r\n  getDimensionValuesIndexesMap\r\n} from \"../../utils/jsonStat\";\r\n\r\nconst colors = [\r\n  '#1E88E5',\r\n  '#C2185B',\r\n  '#FDD835',\r\n  '#0E9D59',\r\n  '#F06292',\r\n  '#FF7043',\r\n  '#8BC34A',\r\n  '#00BCD4',\r\n  '#EA3F4D',\r\n  '#AA47BC',\r\n  '#26A69A',\r\n  '#FF9800',\r\n];\r\n\r\nconst hexToRGBA = (hex, alpha) => {\r\n  const r = parseInt(hex.slice(1, 3), 16);\r\n  const g = parseInt(hex.slice(3, 5), 16);\r\n  const b = parseInt(hex.slice(5, 7), 16);\r\n\r\n  return \"rgba(\" + r + \", \" + g + \", \" + b + \", \" + alpha + \")\";\r\n};\r\n\r\nconst getOptions = chartType => {\r\n\r\n  const isBarOrLineGraph =\r\n    chartType === \"bar\" ||\r\n    chartType === \"horizontalBar\" ||\r\n    chartType === \"line\" ||\r\n    chartType === \"area\";\r\n\r\n  return {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    scales: isBarOrLineGraph\r\n      ? {\r\n        xAxes: [{\r\n          gridLines: {\r\n            display: chartType !== \"bar\"\r\n          },\r\n          ticks: {\r\n            beginAtZero: chartType === \"horizontalBar\",\r\n            callback: value => chartType === \"horizontalBar\"\r\n              ? numberFormatter(value)\r\n              : value\r\n          }\r\n        }],\r\n        yAxes: [{\r\n          gridLines: {\r\n            display: chartType !== \"horizontalBar\"\r\n          },\r\n          ticks: {\r\n            beginAtZero: chartType !== \"horizontalBar\",\r\n            callback: value => chartType !== \"horizontalBar\"\r\n              ? numberFormatter(value)\r\n              : value\r\n          }\r\n        }]\r\n      }\r\n      : {},\r\n    tooltips: {\r\n      enabled: true,\r\n      mode: \"index\",\r\n      callbacks: {\r\n        title: (tooltipItem, data) => data.labels[tooltipItem[0].index] || '',\r\n        label: (tooltipItem, data) => {\r\n          const dataset = data.datasets[tooltipItem.datasetIndex];\r\n          return `${dataset.label}: ${numberFormatter(dataset.data[tooltipItem.index] || '')}`\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nconst getData = (chartType, jsonStat, layout, labelFormat) => {\r\n\r\n  const {\r\n    primaryDim,\r\n    primaryDimValues,\r\n    secondaryDim,\r\n    secondaryDimValues,\r\n    filtersValue\r\n  } = layout;\r\n\r\n  const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n  const valorizedDataMap = {};\r\n  secondaryDimValues.forEach(secondaryDimValue => {\r\n    valorizedDataMap[secondaryDimValue] = new Array(primaryDimValues.length).fill(false);\r\n  });\r\n\r\n  const datasets = [];\r\n  if (secondaryDimValues && secondaryDimValues.length > 0) {\r\n    secondaryDimValues.forEach((secondaryDimValue, idx) => {\r\n      const data = [];\r\n      primaryDimValues.forEach(primaryDimValue => {\r\n        const dimValueArray = jsonStat.id.map(dim => {\r\n          if (dim === primaryDim[0]) {\r\n            return primaryDimValue;\r\n          } else if (dim === secondaryDim[0]) {\r\n            return secondaryDimValue;\r\n          } else {\r\n            return filtersValue[dim];\r\n          }\r\n        });\r\n        const valueIdx = getDataIdxFromDimensionsArray(\r\n          dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n          jsonStat.size\r\n        );\r\n        const value = jsonStat.value[valueIdx];\r\n        if (value) {\r\n          data.push(value);\r\n          valorizedDataMap[secondaryDimValue][idx] = true;\r\n        } else {\r\n          data.push(null);\r\n        }\r\n      });\r\n      if (valorizedDataMap[secondaryDimValue].find(el => el === true)) {\r\n        datasets.push({\r\n          label: getDimensionValueLabelFromJsonStat(jsonStat, secondaryDim[0], secondaryDimValue, labelFormat),\r\n          data: data\r\n        });\r\n      }\r\n    });\r\n\r\n  } else {\r\n    const data = [];\r\n    primaryDimValues.forEach(primaryDimValue => {\r\n      const dimValueArray = jsonStat.id.map(dim => {\r\n        if (dim === primaryDim[0]) {\r\n          return primaryDimValue;\r\n        } else {\r\n          return filtersValue[dim];\r\n        }\r\n      });\r\n      const valueIdx = getDataIdxFromDimensionsArray(\r\n        dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n        jsonStat.size\r\n      );\r\n      const value = jsonStat.value[valueIdx];\r\n      if (value) {\r\n        data.push(value);\r\n      } else {\r\n        data.push(null);\r\n      }\r\n    });\r\n    datasets.push({\r\n      label: \"\",\r\n      data: data\r\n    });\r\n  }\r\n\r\n  // TODO: controllare se almeno un dataset è valorizzato per uno specifico primaryDimValue (posizione x di ogni valorizedDataMap[secondaryDimValue])\r\n\r\n  const isBarOrLineGraph =\r\n    chartType === \"bar\" ||\r\n    chartType === \"horizontalBar\" ||\r\n    chartType === \"line\" ||\r\n    chartType === \"area\" ||\r\n    chartType === \"radar\";\r\n\r\n  let colorArr = colors;\r\n  if (datasets.length > 0) {\r\n    while (colorArr.length < datasets[0].data.length) {\r\n      colorArr = colorArr.concat(colorArr);\r\n    }\r\n    if (colorArr.length > datasets[0].data.length) {\r\n      colorArr = colorArr.slice(0, datasets[0].data.length)\r\n    }\r\n  }\r\n\r\n  return {\r\n    labels: primaryDimValues.map(value => getDimensionValueLabelFromJsonStat(jsonStat, primaryDim[0], value, labelFormat)),\r\n    datasets: datasets.map((ds, idx) => ({\r\n      ...ds,\r\n      borderWidth: 1,\r\n      lineTension: chartType === \"area\" ? 0 : undefined,\r\n      fill: (chartType === \"area\" || chartType === \"radar\"),\r\n      backgroundColor: (isBarOrLineGraph && colorArr.length > 0)\r\n        ? hexToRGBA(colors[idx % colors.length], 0.3)\r\n        : colorArr.map(col => hexToRGBA(col, 0.3)),\r\n      borderColor: (isBarOrLineGraph && colorArr.length > 0)\r\n        ? colors[idx % colors.length]\r\n        : colorArr\r\n    }))\r\n  };\r\n};\r\n\r\nexport default class Chart extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.chartRef = createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    const {\r\n      jsonStat,\r\n      type,\r\n      layout,\r\n      labelFormat\r\n    } = this.props;\r\n\r\n    ChartJs.defaults.global.defaultFontFamily = \"'Roboto', 'Helvetica', 'Arial', sans-serif\";\r\n    this.myChart = new ChartJs(this.chartRef.current, {\r\n      type: type === \"area\" ? \"line\" : type,\r\n      options: getOptions(type),\r\n      data: getData(type, jsonStat, layout, labelFormat)\r\n    });\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n\r\n    const {\r\n      jsonStat,\r\n      type,\r\n      layout,\r\n      labelFormat\r\n    } = this.props;\r\n\r\n    if (prevProps.jsonStat !== jsonStat || prevProps.type !== type || prevProps.layout !== layout) {\r\n\r\n      this.myChart.config.type = type === \"area\" ? \"line\" : type;\r\n      this.myChart.options = getOptions(type);\r\n      this.myChart.data = getData(type, jsonStat, layout, labelFormat);\r\n      this.myChart.update();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return <canvas ref={this.chartRef}/>;\r\n  }\r\n}","import React from \"react\";\r\nimport Chart from \"../chart\";\r\nimport pyramid from '../../dummy/pyramid.jpg';\r\n\r\nconst ChartWrapper = props => props.type !== \"pyramid\"\r\n  ? <Chart{...props}/>\r\n  : <img src={pyramid} alt=\"Pyramid Chart\"/>;\r\n\r\nexport default ChartWrapper","import React, {Fragment} from \"react\";\r\nimport {compose} from \"redux\";\r\nimport {DragDropContext, Draggable, Droppable} from \"react-beautiful-dnd\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport FilterListIcon from '@material-ui/icons/FilterList';\r\nimport ViewCompactIcon from '@material-ui/icons/ViewCompact';\r\nimport ViewStreamIcon from '@material-ui/icons/ViewStream';\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  sectionContainer: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    width: \"calc(60% - 8px)\",\r\n    marginRight: 16\r\n  },\r\n  section: {\r\n    background: \"#eeeeee\"\r\n  },\r\n  sectionLeft: {\r\n    height: 416\r\n  },\r\n  sectionRight: {\r\n    height: 200\r\n  },\r\n  sectionHeaderContainer: {\r\n    height: 48,\r\n    padding: \"16px 16px 0\"\r\n  },\r\n  sectionHeaderIcon: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    marginRight: 8\r\n  },\r\n  sectionHeaderTitle: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"middle\",\r\n    height: 30,\r\n  },\r\n  sectionContentWrapper: {\r\n    width: \"100%\",\r\n    height: \"calc(100% - 48px)\",\r\n    padding: 16\r\n  },\r\n  draggingHover: {\r\n    border: \"1px dashed #999999\"\r\n  },\r\n  sectionContent: {\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    overflowY: \"auto\",\r\n    overflowX: \"hidden\"\r\n  },\r\n  sectionItem: {\r\n    textAlign: \"center\",\r\n    height: \"100%\",\r\n    padding: \"4px 16px\"\r\n  },\r\n  divider: {\r\n    marginBottom: 16\r\n  }\r\n});\r\n\r\nconst getItemStyle = (isDragging, draggableStyle) => ({\r\n  userSelect: 'none',\r\n  height: 32,\r\n  marginBottom: 8,\r\n  ...draggableStyle\r\n});\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const [removed] = list.splice(startIndex, 1);\r\n  list.splice(endIndex, 0, removed);\r\n};\r\n\r\nconst move = (source, destination, droppableSource, droppableDestination) => {\r\n  const [removed] = source.splice(droppableSource.index, 1);\r\n  destination.splice(droppableDestination.index, 0, removed);\r\n};\r\n\r\nconst swap = (sourceArr, destinationArr, droppableSource) => {\r\n  const [removedSrc] = sourceArr.splice(droppableSource.index, 1);\r\n  const [removedDst] = destinationArr.splice(0, 1, removedSrc);\r\n  sourceArr.splice(sourceArr.length, 0, removedDst);\r\n};\r\n\r\nconst onDragEnd = (result, dimensions, setDimensions) => {\r\n\r\n  const {\r\n    source,\r\n    destination\r\n  } = result;\r\n\r\n  // dropped outside the list\r\n  if (!destination) {\r\n    return;\r\n  }\r\n\r\n  const newDimensions = JSON.parse(JSON.stringify(dimensions));\r\n\r\n  if (source.droppableId === destination.droppableId) {\r\n    reorder(\r\n      newDimensions[source.droppableId],\r\n      source.index,\r\n      destination.index\r\n    );\r\n\r\n  } else if (\r\n    (source.droppableId === \"secondaryDim\" && destination.droppableId === \"filters\") ||\r\n    (source.droppableId === \"filters\" && destination.droppableId === \"secondaryDim\" && newDimensions[destination.droppableId].length === 0)\r\n  ) {\r\n    move(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source,\r\n      destination\r\n    );\r\n\r\n  } else {\r\n    swap(\r\n      newDimensions[source.droppableId],\r\n      newDimensions[destination.droppableId],\r\n      source\r\n    );\r\n  }\r\n\r\n  setDimensions(newDimensions);\r\n};\r\n\r\nconst Section = ({\r\n                   classes,\r\n                   sectionClasses,\r\n                   id,\r\n                   title,\r\n                   Icon,\r\n                   dimensions,\r\n                   jsonStat\r\n                 }) =>\r\n\r\n  <Card variant=\"outlined\" className={`${classes.section} ${sectionClasses}`}>\r\n    <CardHeader\r\n      title={\r\n        <Fragment>\r\n          <div className={classes.sectionHeaderIcon}>{Icon}</div>\r\n          <Typography className={classes.sectionHeaderTitle} variant=\"button\">{title}</Typography>\r\n        </Fragment>\r\n      }\r\n      className={classes.sectionHeaderContainer}\r\n    />\r\n    <Droppable droppableId={id}>\r\n      {(provided, snapshot) => (\r\n        <div className={`${classes.sectionContentWrapper} ${snapshot.isDraggingOver ? classes.draggingHover : \"\"}`}>\r\n          <div ref={provided.innerRef} className={classes.sectionContent}>\r\n            {dimensions.map((item, idx) =>\r\n              <Draggable\r\n                key={idx}\r\n                index={idx}\r\n                draggableId={`${id}-${idx}`}\r\n                isDragDisabled={id === \"primaryDim\"}\r\n              >\r\n                {(provided, snapshot) => (\r\n                  <div\r\n                    ref={provided.innerRef}\r\n                    {...provided.draggableProps}\r\n                    {...provided.dragHandleProps}\r\n                    style={getItemStyle(snapshot.isDragging, provided.draggableProps.style)}\r\n                  >\r\n                    <Paper\r\n                      className={classes.sectionItem}\r\n                    >\r\n                      {`${item} (${jsonStat.size[jsonStat.id.indexOf(item)]})`}\r\n                    </Paper>\r\n                  </div>\r\n                )}\r\n              </Draggable>\r\n            )}\r\n            {provided.placeholder}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Droppable>\r\n  </Card>;\r\n\r\nconst ChartLayout = ({\r\n                       t,\r\n                       classes,\r\n                       jsonStat,\r\n                       layout,\r\n                       setLayout\r\n                     }) => {\r\n\r\n  const {\r\n    primaryDim,\r\n    secondaryDim,\r\n    filters\r\n  } = layout;\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider className={classes.divider}/>\r\n      <div className={classes.sectionContainer}>\r\n        <DragDropContext onDragEnd={result => onDragEnd(result, layout, setLayout)}>\r\n          <Grid container spacing={2}>\r\n            <Grid item xs={6}>\r\n              <Section\r\n                classes={classes}\r\n                sectionClasses={classes.sectionLeft}\r\n                id=\"filters\"\r\n                title={t(\"components.chartLayout.filters.title\")}\r\n                Icon={<FilterListIcon/>}\r\n                dimensions={filters}\r\n                jsonStat={jsonStat}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n              <Grid item xs={12} style={{paddingBottom: 8}}>\r\n                <Section\r\n                  classes={classes}\r\n                  sectionClasses={classes.sectionRight}\r\n                  id=\"primaryDim\"\r\n                  title={t(\"components.chartLayout.primaryDim.title\")}\r\n                  Icon={<ViewCompactIcon/>}\r\n                  dimensions={primaryDim}\r\n                  jsonStat={jsonStat}\r\n                />\r\n              </Grid>\r\n              <Grid item xs={12} style={{paddingTop: 8}}>\r\n                <Section\r\n                  classes={classes}\r\n                  sectionClasses={classes.sectionRight}\r\n                  id=\"secondaryDim\"\r\n                  title={t(\"components.chartLayout.secondaryDim.title\")}\r\n                  Icon={<ViewStreamIcon/>}\r\n                  dimensions={secondaryDim}\r\n                  jsonStat={jsonStat}\r\n                />\r\n              </Grid>\r\n            </Grid>\r\n          </Grid>\r\n        </DragDropContext>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ChartLayout)","import React, {useEffect, useState} from 'react';\r\nimport {useTranslation} from \"react-i18next\";\r\nimport \"./style.css\";\r\nimport WebFont from 'webfontloader';\r\nimport {numberFormatter} from \"../../utils/formatters\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport Call from \"../../hocs/call/index\";\r\nimport {\r\n  getDataIdxFromDimensionsArray,\r\n  getDimensionFiltersValue,\r\n  getDimensionValuesIndexesMap\r\n} from \"../../utils/jsonStat\";\r\nimport {addSpinnerMessage, markSpinnerMessage} from \"../../state/spinner/spinnerActions\";\r\nimport {v4 as uuidv4} from \"uuid\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\n\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  addSpinner: (uuid, message) => dispatch(addSpinnerMessage(uuid, message)),\r\n  markSpinner: (uuid, isError) => dispatch(markSpinnerMessage(uuid, isError))\r\n});\r\n\r\n\r\nfunction Map(props) {\r\n  const {mapLayout, jsonStat, onGeometryFetch, geometries, geometryDetailLevels, classes, hideSpinner, addSpinner, markSpinner} = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [currentDetailLevel, setCurrentDetailLevel] = useState(-1);\r\n\r\n  const [filteredGeometries, setFilteredGeometries] = useState(null);\r\n\r\n  const [spinnerUuid] = useState(uuidv4());\r\n\r\n  // select default detail level\r\n  useEffect(() => {\r\n\r\n    if (!geometryDetailLevels) {\r\n      return;\r\n    }\r\n\r\n    if (geometryDetailLevels && geometryDetailLevels?.length > 0) {\r\n      const firstNotEmptyLevelIndex = geometryDetailLevels.findIndex(el => el);\r\n      setCurrentDetailLevel(geometryDetailLevels[firstNotEmptyLevelIndex].level);\r\n    }\r\n\r\n    return () => {\r\n      window.LMap.destroyMap(\"map-root\")\r\n    }\r\n  }, [geometryDetailLevels]);\r\n\r\n\r\n  // init the map with filtered geometries\r\n  useEffect(() => {\r\n\r\n    if (!filteredGeometries || filteredGeometries.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const mapTranslations = {\r\n      configure: t(\"components.map.translation.configure\"),\r\n      opacity: t(\"components.map.translation.opacity\"),\r\n      from: t(\"components.map.translation.from\"),\r\n      to: t(\"components.map.translation.to\"),\r\n      cancel: t(\"components.map.translation.cancel\"),\r\n      apply: t(\"components.map.translation.apply\"),\r\n      classification: t(\"components.map.translation.classification\"),\r\n      equalInterval: t(\"components.map.translation.equalInterval\"),\r\n      naturalBreaks: t(\"components.map.translation.naturalBreaks\"),\r\n      quantile: t(\"components.map.translation.quantile\"),\r\n      numberOfClasses: t(\"components.map.translation.numberOfClasses\"),\r\n      startColor: t(\"components.map.translation.startColor\"),\r\n      endColor: t(\"components.map.translation.endColor\"),\r\n      preview: t(\"components.map.translation.preview\")\r\n    };\r\n\r\n    const isGeometryData = false;\r\n\r\n    if (!hideSpinner) {\r\n      addSpinner(spinnerUuid, t(\"components.map.spinners.rendering\"));\r\n    }\r\n\r\n    const layerOptions = {\r\n      srid: \"EPSG:4326\",\r\n      legendSettings: {\r\n        paletteStartColor: \"#eff3ff\",\r\n        paletteEndColor: \"#2171b5\",\r\n        paletteCardinality: 9,\r\n        pointStartRadius: 1,\r\n        pointEndRadius: 9,\r\n        pointRadiusCardinality: 9,\r\n        opacity: 0.9,\r\n        classificationMethod: \"quantile\"\r\n      },\r\n      onDataRender: function () {\r\n        markSpinner(spinnerUuid);\r\n      },\r\n      borderColor: [128, 128, 128, 0.5],\r\n      valueFormatter: numberFormatter,\r\n      centerMarker:\r\n        isGeometryData\r\n          ? \"data:image/png;base64,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\"\r\n          : undefined,\r\n      centerMarkerText: isGeometryData ? \"test\" : undefined,\r\n      selectedCenterMarker:\r\n        isGeometryData\r\n          ? \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADIklEQVR4AbXXA3hrWRQF4Ixt27Zt27atcGzbto3YeUZt2zbiNau+PVVO0uzv+9+r97o4UsVT6z7iUa1D66s9q26pc6+6td6lGpK0OuMF05BVaEs6jR6h949/1vzzdjrHz1tonJ+Qgc6hbbbUulbZUuuct8ZDdqCnKJsGCISTnjODAcCmY/yUTy/SzpurnSoGSbj5KZRGUYKSGECQTWdvrXcLIeSbVxIIkgFAdXQWDYWQDrAdrSCITnveiNPp1Bcs2NHgxKZqBzZ9ZMYg6bQjSV+9Tmx8Op1J93+1GD8vKcXiwkZYc5rwtqscZ7yzHFuy4ebTh3hi5H1wxRxgI1oqNj/nZQs+dxegsy8AsVp7/HjGWIRt9a7pQqTwEWxKMQc4mNonBXjehHctOQiEwpipBoNhqH/Pw2Zqhxigk46gmANcSMGJ5kZc+54LVS09mKsKG3tw4PMLGWJSgDBdIRPgZsKYU58z4pnfUxGKRDFXBcMR3PBVBjaZ+lLellCA9625iLV0f+YnHOBiCikDvPZvJqJRzFlR/tA9P+WIASJ0lUyAo6hbOe7v/GwhOvr8mKuau/048Y2l4ovYS8fLBNiGCgljznrJjH9TKjFXfbGoClvrXOLtL6MdZAKsSt8SlCPh6ndcWFbcNO2jiPCL1txm7P/sAnEEgH7iJLS6zDww9h74xSn4srcc+NJTgKL6TrT3+tHMCSi9uhPPmYqx11O+6eaAwNjz30rnkpqON6FFBGFCIiMuecOOGz704YTXFmO3J7zDjTcXr5xoOW1Oca2GNyknJNEJz5qwjVZoPFmY7qS4l+RNyJvAcrxEuPq47sJF1BtHgH66nMRVUDrEWvR1HAF+5G1fh+ZlT7gflUoEqKSDxKtPNMRd5I8hQJDu21ztEF+8hEOsSz/EEOB3Nt5A4sWTugt7Ud4sAYpof+Wkk4wQl1LXNAF66Gr5s4B8iNXoeQorAkTpVTZeXbz1yQqxMXfHfykCmGiz5DYXHsXZL5r2POFZc9b2ekfeZhrnvmye3AOqGGIXg1115NOWY3c12E/kIVV87smvTTRu1ca0yah4638QYUyY6yhczwAAAABJRU5ErkJggg==\"\r\n          : undefined\r\n    };\r\n\r\n    const mapOptions = {\r\n      baseMap: \"osm\",\r\n      baseMapToGray: true,\r\n      onLoadingStart: function () {\r\n        console.log(\"Map creation - start\");\r\n      },\r\n      onLoadingFinish: function () {\r\n        console.log(\"Map creation - done\");\r\n      },\r\n      legendFontFamily: \"Roboto\"\r\n    };\r\n\r\n    WebFont.load({\r\n      google: {\r\n        families: ['Roboto:300,400,500,700']\r\n      },\r\n      active: () => {\r\n        window.LMap.initMap(\"map-root\", mapOptions, mapTranslations);\r\n        window.LMap.addLayer(\"map-root\", filteredGeometries, \"Dataset\", layerOptions);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      window.LMap.destroyMap(\"map-root\")\r\n    }\r\n  }, [filteredGeometries, spinnerUuid, hideSpinner, addSpinner, markSpinner, t]);\r\n\r\n\r\n  // check for missing geometry ids\r\n  useEffect(() => {\r\n    if (!geometries) {\r\n      return;\r\n    }\r\n    const geometryMap = {};\r\n    geometries.forEach(g => geometryMap[g.id] = g);\r\n\r\n    const missingGeometryList = [];\r\n    jsonStat.dimension[mapLayout.territoryDim].category.index.forEach(geomId => {\r\n      if (!geometryMap[geomId]) {\r\n        const missingEntry = {id: geomId, label: jsonStat.dimension[mapLayout.territoryDim].category.label[geomId]};\r\n        missingGeometryList.push(missingEntry);\r\n      }\r\n    });\r\n    console.log(\"missing ids\", missingGeometryList);\r\n  }, [jsonStat, geometries, mapLayout.territoryDim])\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    if (!geometries || !currentDetailLevel < 0) {\r\n      return;\r\n    }\r\n\r\n    const geometryMap = {};\r\n    geometries.forEach(g => geometryMap[g.id] = g);\r\n\r\n    const filters = [...mapLayout.filters];\r\n    const filtersValues = {...mapLayout.filtersValue};\r\n    const territoryDimName = mapLayout.territoryDim;\r\n    const dimensionFilterValues = getDimensionFiltersValue(jsonStat, mapLayout.territoryDim, filters, filtersValues);\r\n    const indexesMap = getDimensionValuesIndexesMap(jsonStat);\r\n\r\n    const data = [];\r\n    var levelsCounter = {};\r\n    dimensionFilterValues.forEach(territoryDim => {\r\n      const dimValueArray = jsonStat.id.map(dim => {\r\n        if (dim === territoryDimName) {\r\n          return territoryDim.id;\r\n        } else {\r\n          return filtersValues[dim];\r\n        }\r\n      });\r\n      const valueIdx = getDataIdxFromDimensionsArray(\r\n        dimValueArray.map((value, idx) => indexesMap[jsonStat.id[idx]][value]),\r\n        jsonStat.size\r\n      );\r\n      const valueId = jsonStat.value[valueIdx];\r\n      const geom = geometryMap[territoryDim.id];\r\n\r\n      if (valueId && geom && geom.nutsLevel === +currentDetailLevel) {\r\n        data.push({\r\n          \"value\": valueId,\r\n          \"identifier\": geom.uniqueId,\r\n          \"geometry\": geom.wkt,\r\n          \"label\": territoryDim.label\r\n        });\r\n      }\r\n      if (valueId && geom?.nutsLevel >= 0) {\r\n        if (!levelsCounter[geom.nutsLevel]) {\r\n          levelsCounter[geom.nutsLevel] = 0;\r\n        }\r\n        levelsCounter[geom.nutsLevel]++;\r\n      }\r\n    });\r\n\r\n    /*\r\n    // set the first not empty level\r\n    if(data.length === 0){\r\n      const firstNotEmpty = Object.entries(levelsCounter).filter((entry) => {return entry[1] > 1;});\r\n      if(firstNotEmpty?.length > 0){\r\n        setCurrentDetailLevel(firstNotEmpty[0][0]);\r\n        return;\r\n      }\r\n    }\r\n    */\r\n\r\n    setFilteredGeometries(data);\r\n\r\n  }, [geometries, mapLayout, currentDetailLevel, jsonStat])\r\n\r\n\r\n  return (\r\n    jsonStat.dimension[mapLayout.territoryDim]\r\n      ? (\r\n        <Call\r\n          cb={onGeometryFetch}\r\n          cbParam={[...jsonStat.dimension[mapLayout.territoryDim].category.index]}\r\n          disabled={geometries !== null && geometries !== undefined && geometryDetailLevels !== null && geometryDetailLevels !== undefined}\r\n        >\r\n          {geometryDetailLevels && geometryDetailLevels.length > 1 && (\r\n            <FormControl className={classes.filters}>\r\n              <InputLabel id=\"Map detail level label\">{t(\"components.map.detailLevel\")}</InputLabel>\r\n              <Select\r\n                value={currentDetailLevel}\r\n                onChange={(ev) => {\r\n                  setCurrentDetailLevel(ev.target.value)\r\n                }}\r\n              >\r\n                {geometryDetailLevels.map(val =>\r\n                  <MenuItem value={val.level} key={val.level}>{val.label}</MenuItem>\r\n                )}\r\n              </Select>\r\n            </FormControl>\r\n          )}\r\n          {currentDetailLevel > 0 && filteredGeometries && filteredGeometries.length === 0 && (\r\n            <span style={{textAlign: 'center', width: '100%'}}>\r\n              <h2>\r\n                {t(\"components.map.noDataToDisplayFor\")}\r\n                {\" \"}\r\n                {(geometryDetailLevels || []).filter(lev => lev.level === +currentDetailLevel).map(val =>\r\n                  <i key={\"span-i-\" + val.level}>{val.label}</i>\r\n                )}\r\n                .\r\n              </h2>\r\n            </span>\r\n          )}\r\n          <div id=\"map-root\"/>\r\n        </Call>\r\n      )\r\n      : <span style={{textAlign: 'center', width: '100%'}}><h2>{t(\"components.map.noTerritorialDim\")}</h2></span>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  connect(null, mapDispatchToProps)\r\n)(Map);\r\n","import React, {Fragment, useEffect, useState} from 'react';\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport DataViewerHeader from \"./Header\";\r\nimport DataViewerSideBar from \"./Sidebar\";\r\nimport DataViewerFooter from \"./Footer\";\r\nimport DatasetFilters from \"../dataset-filters\";\r\nimport JsonStatTable, {\r\n  JSONSTAT_TABLE_FONT_SIZE_LG,\r\n  JSONSTAT_TABLE_FONT_SIZE_MD,\r\n  JSONSTAT_TABLE_FONT_SIZE_SM\r\n} from \"../table\";\r\nimport Criteria from \"../criteria\";\r\nimport TableLayout from \"../table-layout\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport FontSizeSelector, {\r\n  FONT_SIZE_SELECTOR_FONT_SIZE_MD,\r\n  FONT_SIZE_SELECTOR_FONT_SIZE_SM\r\n} from \"../font-size-selector\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport \"./style.css\"\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport TableChartIcon from \"@material-ui/icons/TableChart\";\r\nimport MapIcon from \"@material-ui/icons/Map\";\r\nimport BarChartIcon from \"@material-ui/icons/BarChart\";\r\nimport TimelineIcon from \"@material-ui/icons/Timeline\";\r\nimport HelpIcon from \"@material-ui/icons/Help\";\r\nimport DonutLargeIcon from \"@material-ui/icons/DonutLarge\";\r\nimport PieChartIcon from \"@material-ui/icons/PieChart\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n  enableDatasetFetch,\r\n  fetchAccessibleDataset,\r\n  fetchDataset,\r\n  fetchDatasetGeometries,\r\n  hideDatasetCriteria,\r\n  hideDatasetCriteriaAlert,\r\n  hideDatasetCriteriaLengthWarning,\r\n  hideDatasetDownloadWarning,\r\n  hideDatasetUnavailableViewWarning,\r\n  resetDataset,\r\n  setDatasetLabelFormat,\r\n  setDatasetViewer,\r\n  showDatasetCriteria,\r\n  submitDatasetDownload,\r\n  submitDatasetViewTemplate\r\n} from \"../../state/dataset/datasetActions\";\r\nimport Alert from \"@material-ui/lab/Alert\";\r\nimport {getChartDimensionValues, getInitialFiltersValue, getJsonStatTableSize} from \"../../utils/jsonStat\";\r\nimport {numberFormatter} from \"../../utils/formatters\";\r\nimport Call from \"../../hocs/call\";\r\nimport _ from \"lodash\"\r\nimport ChartWrapper from \"./ChartWrapper\";\r\nimport ChartLayout from \"../chart-layout\";\r\nimport {v4 as uuidv4} from 'uuid';\r\nimport Map from \"../map/index\";\r\nimport LabelFormatSelector, {LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME} from \"../label-format-selector\";\r\n\r\nconst SIDEBAR_WIDTH = 80;\r\nconst TABLE_ACTIONS_WIDTH = 336;\r\n\r\nconst TIME_PERIOD_KEY = \"TIME_PERIOD\";\r\nconst FREQ_KEY = \"FREQ\";\r\n\r\nexport const MAX_COL_COUNT = 10000;\r\nexport const MAX_ROW_COUNT = 10000;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"absolute\",\r\n    width: \"100%\"\r\n  },\r\n  header: {\r\n    width: \"100%\"\r\n  },\r\n  page: {\r\n    width: \"100%\"\r\n  },\r\n  sidebar: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\",\r\n    width: SIDEBAR_WIDTH,\r\n    height: \"100%\",\r\n    overflow: \"auto\",\r\n    marginLeft: theme.spacing(2),\r\n    padding: \"0 8px\"\r\n  },\r\n  data: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\",\r\n    width: `calc(100% - ${SIDEBAR_WIDTH + theme.spacing(2) + theme.spacing(2) + theme.spacing(2)}px)`,\r\n    height: \"100%\",\r\n    marginLeft: theme.spacing(2),\r\n    marginRight: theme.spacing(2),\r\n    padding: theme.spacing(2)\r\n  },\r\n  viewerContainer: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  action: {\r\n    height: 40,\r\n    \"& button\": {\r\n      padding: 8\r\n    }\r\n  },\r\n  filtersAndActions: {\r\n    width: \"100%\",\r\n    paddingBottom: theme.spacing(1)\r\n  },\r\n  filters: {\r\n    width: `calc(100% - ${TABLE_ACTIONS_WIDTH}px)`,\r\n    display: \"inline-block\"\r\n  },\r\n  actions: {\r\n    width: TABLE_ACTIONS_WIDTH,\r\n    display: \"inline-block\"\r\n  },\r\n  viewer: {\r\n    width: \"100%\",\r\n    position: \"relative\"\r\n  },\r\n  attributes: {\r\n    width: \"100%\",\r\n    paddingTop: 12\r\n  },\r\n  footer: {\r\n    bottom: 0,\r\n    left: 0,\r\n    width: \"100%\",\r\n    overflowX: \"auto\",\r\n    overflowY: \"hidden\",\r\n    padding: theme.spacing(1)\r\n  },\r\n  warningAlert: {\r\n    width: \"100%\",\r\n    marginBottom: 16\r\n  },\r\n  criteriaContent: {\r\n    overflow: \"hidden !important\"\r\n  }\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDataset: ({nodeId, datasetId, filters, datasetTitle, checkCriteriaLength, tableLayout}) => dispatch(fetchDataset(nodeId, datasetId, filters, datasetTitle, checkCriteriaLength, tableLayout)),\r\n  fetchAccessibleDataset: ({nodeId, datasetId, filters, datasetTitle}) => dispatch(fetchAccessibleDataset(nodeId, datasetId, filters, datasetTitle)),\r\n  onFetchDatasetEnable: () => dispatch(enableDatasetFetch()),\r\n  onCriteriaShow: () => dispatch(showDatasetCriteria()),\r\n  onCriteriaHide: () => dispatch(hideDatasetCriteria()),\r\n  onCriteriaAlertHide: () => dispatch(hideDatasetCriteriaAlert()),\r\n  onViewerChange: viewerIdx => dispatch(setDatasetViewer(viewerIdx)),\r\n  onLabelFormatChange: labelFormat => dispatch(setDatasetLabelFormat(labelFormat)),\r\n  onDownloadSubmit: (nodeId, datasetId, datasetTitle, format, extension) =>\r\n    dispatch(submitDatasetDownload(nodeId, datasetId, datasetTitle, format, extension)),\r\n  onDownloadHide: () => dispatch(hideDatasetDownloadWarning()),\r\n  onViewTemplateSubmit: (nodeId, viewTemplate, isView) => dispatch(submitDatasetViewTemplate(nodeId, viewTemplate, isView)),\r\n  onUnavailableViewHide: () => dispatch(hideDatasetUnavailableViewWarning()),\r\n  onCriteriaLengthWarningHide: () => dispatch(hideDatasetCriteriaLengthWarning()),\r\n  onGeometryFetch: (idList) => dispatch(fetchDatasetGeometries(idList)),\r\n  onDatasetReset: () => dispatch(resetDataset())\r\n});\r\n\r\nconst viewers = t => [\r\n  {\r\n    key: 0,\r\n    type: \"table\",\r\n    title: t ? t(\"scenes.dataViewers.viewers.table\") : \"\",\r\n    icon: <TableChartIcon/>\r\n  },\r\n  {\r\n    key: 1,\r\n    title: t ? t(\"scenes.dataViewers.viewers.map\") : \"\",\r\n    type: \"map\",\r\n    icon: <MapIcon/>\r\n  },\r\n  {\r\n    key: 2,\r\n    title: t ? t(\"scenes.dataViewers.viewers.verticalBar\") : \"\",\r\n    type: \"bar\",\r\n    icon: <BarChartIcon/>,\r\n    chartType: \"bar\"\r\n  },\r\n  {\r\n    key: 3,\r\n    title: t ? t(\"scenes.dataViewers.viewers.horizontalBar\") : \"\",\r\n    type: \"horizontalBar\",\r\n    icon: <BarChartIcon style={{transform: \"rotate(90deg)\"}}/>,\r\n    chartType: \"horizontalBar\"\r\n  },\r\n  {\r\n    key: 4,\r\n    title: t ? t(\"scenes.dataViewers.viewers.line\") : \"\",\r\n    type: \"line\",\r\n    icon: <TimelineIcon/>,\r\n    chartType: \"line\"\r\n  },\r\n  {\r\n    key: 5,\r\n    title: t ? t(\"scenes.dataViewers.viewers.area\") : \"\",\r\n    type: \"area\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"area\"\r\n  },\r\n  {\r\n    key: 6,\r\n    title: t ? t(\"scenes.dataViewers.viewers.doughnut\") : \"\",\r\n    type: \"doughnut\",\r\n    icon: <DonutLargeIcon/>,\r\n    chartType: \"doughnut\"\r\n  },\r\n  {\r\n    key: 7,\r\n    title: t ? t(\"scenes.dataViewers.viewers.pie\") : \"\",\r\n    type: \"pie\",\r\n    icon: <PieChartIcon/>,\r\n    chartType: \"pie\"\r\n  },\r\n  {\r\n    key: 8,\r\n    title: t ? t(\"scenes.dataViewers.viewers.radar\") : \"\",\r\n    type: \"radar\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"radar\"\r\n  },\r\n  {\r\n    key: 9,\r\n    title: t ? t(\"scenes.dataViewers.viewers.polarArea\") : \"\",\r\n    type: \"polarArea\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"polarArea\"\r\n  },\r\n  {\r\n    key: 10,\r\n    title: t ? t(\"scenes.dataViewers.viewers.pyramid\") : \"\",\r\n    type: \"pyramid\",\r\n    icon: <HelpIcon/>,\r\n    chartType: \"pyramid\"\r\n  }\r\n];\r\n\r\nexport const getViewerIdxFromType = viewerType => {\r\n  if (!viewerType) {\r\n    return 0\r\n  }\r\n\r\n  const viewer = viewers().find(({type}) => type === viewerType);\r\n  return viewer\r\n    ? viewer.key\r\n    : 0\r\n}\r\n\r\nconst handleHeight = () => {\r\n  const titleHeight = document.getElementById(\"node-header\")\r\n    ? document.getElementById(\"node-header\").offsetHeight\r\n    : 0;\r\n  const headerHeight = document.getElementById(\"data-viewer__header\")\r\n    ? document.getElementById(\"data-viewer__header\").offsetHeight\r\n    : 0;\r\n  const footerHeight = document.getElementById(\"data-viewer__footer\")\r\n    ? document.getElementById(\"data-viewer__footer\").offsetHeight\r\n    : 0;\r\n  const filtersAndActionsHeight = document.getElementById(\"data-viewer__page__viewer__filters-and-actions\")\r\n    ? document.getElementById(\"data-viewer__page__viewer__filters-and-actions\").offsetHeight\r\n    : 0;\r\n\r\n  if (document.getElementById(\"data-viewer\")) {\r\n    document.getElementById(\"data-viewer\").setAttribute(\"style\", `height: calc(100% - ${titleHeight}px); top: ${titleHeight}px`);\r\n  }\r\n  if (document.getElementById(\"data-viewer__page\")) {\r\n    document.getElementById(\"data-viewer__page\").setAttribute(\"style\", `height: calc(100% - ${headerHeight + footerHeight}px)`);\r\n  }\r\n  if (document.getElementById(\"data-viewer__page__viewer__viewer\")) {\r\n    document.getElementById(\"data-viewer__page__viewer__viewer\").setAttribute(\"style\", `height: calc(100% - ${filtersAndActionsHeight}px)`);\r\n  }\r\n};\r\n\r\nconst getInitialTableLayout = (jsonStat, territorialDims) => {\r\n  if (!jsonStat) {\r\n    return null;\r\n  }\r\n\r\n  let dimensions = [...jsonStat.id];\r\n\r\n  let rows = dimensions.filter(dim => dim === TIME_PERIOD_KEY);\r\n  dimensions = dimensions.filter(dim => !rows.includes(dim));\r\n\r\n  let cols = dimensions.filter(dim => territorialDims.includes(dim));\r\n  dimensions = dimensions.filter(dim => !cols.includes(dim));\r\n\r\n  let filters = dimensions.filter(dim => jsonStat.size[jsonStat.id.indexOf(dim)] === 1);\r\n  dimensions = dimensions.filter(dim => !filters.includes(dim));\r\n\r\n  if (dimensions.includes(FREQ_KEY)) {\r\n    rows = [FREQ_KEY, ...rows];\r\n    dimensions = dimensions.filter(dim => !rows.includes(dim));\r\n  }\r\n\r\n  if (rows.length === 1 && jsonStat.size[jsonStat.id.indexOf(rows[0])] === 1 && cols.length === 1) {\r\n    filters = filters.concat(rows);\r\n    rows = [...cols];\r\n    cols = [];\r\n  }\r\n\r\n  let colCount = 1;\r\n  cols.forEach(col => colCount *= jsonStat.size[jsonStat.id.indexOf(col)]);\r\n  let rowCount = 1;\r\n  rows.forEach(row => rowCount *= jsonStat.size[jsonStat.id.indexOf(row)]);\r\n\r\n  dimensions.forEach(dim => {\r\n    const newColCount = colCount * jsonStat.size[jsonStat.id.indexOf(dim)];\r\n\r\n    if (newColCount > MAX_COL_COUNT) {\r\n      const newRowCount = rowCount * jsonStat.size[jsonStat.id.indexOf(dim)];\r\n\r\n      if (newRowCount > MAX_ROW_COUNT) {\r\n        filters.push(dim);\r\n\r\n      } else {\r\n        rows = [dim].concat(rows);\r\n        rowCount = newRowCount;\r\n      }\r\n\r\n    } else {\r\n      cols.push(dim);\r\n      colCount = newColCount;\r\n    }\r\n  })\r\n\r\n  const filtersValue = getInitialFiltersValue(jsonStat, filters);\r\n\r\n  return {\r\n    rows: rows,\r\n    cols: cols,\r\n    sections: [],\r\n    filters: filters,\r\n    filtersValue: filtersValue,\r\n  }\r\n};\r\n\r\nconst getInitialChartLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null\r\n  }\r\n\r\n  let dimensions = [...jsonStat.id];\r\n\r\n  let primaryDim = dimensions.find(dim => dim === TIME_PERIOD_KEY);\r\n  dimensions = dimensions.filter(dim => dim !== primaryDim);\r\n\r\n  const filters = dimensions;\r\n  const filtersValue = getInitialFiltersValue(jsonStat, dimensions);\r\n\r\n  return {\r\n    primaryDim: [primaryDim],\r\n    primaryDimValues: getChartDimensionValues(jsonStat, primaryDim, filters, filtersValue),\r\n    secondaryDim: [],\r\n    secondaryDimValues: [],\r\n    filters: filters,\r\n    filtersValue: filtersValue,\r\n  }\r\n};\r\n\r\nconst getInitialMapLayout = jsonStat => {\r\n  if (!jsonStat) {\r\n    return null\r\n  }\r\n\r\n  let dimensions = [...jsonStat.id];\r\n  let geoId = jsonStat.role?.geo?.length > 0 ? jsonStat.role.geo[0] : null;\r\n  let territoryDim = dimensions.find(dim => (geoId !== null && dim === geoId) || dim === 'REF_AREA' || dim === 'ITTER107');\r\n\r\n  const filters = dimensions.filter(dim => dim !== territoryDim);\r\n  const filtersValue = getInitialFiltersValue(jsonStat, dimensions);\r\n\r\n  return {\r\n    territoryDim: territoryDim,\r\n    filters: filters,\r\n    filtersValue: filtersValue,\r\n    labelFormat: LABEL_FORMAT_SELECTOR_LABEL_FORMAT_NAME\r\n  }\r\n};\r\n\r\nfunction DataViewer(props) {\r\n  const {\r\n    classes,\r\n\r\n    nodeId,\r\n    nodeCode,\r\n    nodeExtras,\r\n\r\n    isAccessible,\r\n\r\n    datasetId,\r\n    datasetTitle,\r\n    notes,\r\n    attachedFiles,\r\n    referenceMetadataUrl,\r\n    dataset,\r\n    isFetchDatasetDisabled,\r\n\r\n    isCriteriaVisible,\r\n    isCriteriaAlertVisible,\r\n\r\n    hasTemplateLayout,\r\n    hasAnnotationLayout,\r\n\r\n    dimensions,\r\n    mode,\r\n    type,\r\n    codelistsLength,\r\n    viewerIdx,\r\n    initialTableLayout,\r\n    initialMapLayout,\r\n    initialChartLayout,\r\n    labelFormat,\r\n    filters,\r\n    decimalSeparator,\r\n    decimalPlaces,\r\n    emptyChar,\r\n    enableCriteria,\r\n    enableLayout,\r\n    maxAllowedCells,\r\n    territorialDims,\r\n    codes,\r\n    isCodesFlat,\r\n    codelists,\r\n    areCodelistsFlat,\r\n    timePeriod,\r\n\r\n    isPartialData,\r\n    isEmptyData,\r\n    isTooBigData,\r\n\r\n    maxObservation,\r\n\r\n    isDownloadWarningVisible,\r\n    isUnavailableViewWarningVisible,\r\n    isCriteriaLengthWarningVisible,\r\n\r\n    timings,\r\n    geometries,\r\n    geometryDetailLevels,\r\n\r\n    fetchDataset,\r\n    fetchAccessibleDataset,\r\n    onFetchDatasetEnable,\r\n    onCriteriaShow,\r\n    onCriteriaHide,\r\n    onCriteriaAlertHide,\r\n    onViewerChange,\r\n    onLabelFormatChange,\r\n    onDownloadSubmit,\r\n    onDownloadHide,\r\n    onViewTemplateSubmit,\r\n    onUnavailableViewHide,\r\n    onGeometryFetch,\r\n    onCriteriaLengthWarningHide,\r\n    onDatasetReset\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [jsonStat, setJsonStat] = useState(null);\r\n\r\n  const [tableLayout, setTableLayout] = useState(null);\r\n  const [tmpTableLayout, setTmpTableLayout] = useState(null);\r\n\r\n  const [chartLayout, setChartLayout] = useState(null);\r\n  const [tmpChartLayout, setTmpChartLayout] = useState(null);\r\n\r\n  const [mapLayout, setMapLayout] = useState(null);\r\n\r\n  const [isLayoutVisible, setLayoutVisibility] = useState(false);\r\n\r\n  const [isCriteriaValid, setCriteriaValidity] = useState(true);\r\n\r\n  const [isFullscreen, setFullscreen] = useState(false);\r\n  const [fontSize, setFontSize] = useState(FONT_SIZE_SELECTOR_FONT_SIZE_MD);\r\n\r\n  useEffect(() => {\r\n    return () => onDatasetReset()\r\n  }, [onDatasetReset]);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", handleHeight);\r\n    return () => window.removeEventListener(\"resize\", handleHeight)\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    handleHeight();\r\n  }, [jsonStat, viewerIdx, tableLayout]);\r\n\r\n  useEffect(() => {\r\n    setTableLayout(null);\r\n    setTmpTableLayout(null);\r\n    setChartLayout(null);\r\n    setTmpChartLayout(null);\r\n  }, [dataset]);\r\n\r\n  useEffect(() => {\r\n    setJsonStat(dataset);\r\n    const cellCount = getJsonStatTableSize(dataset);\r\n\r\n    if (cellCount < maxAllowedCells) {\r\n      if (dataset) {\r\n\r\n        const newTableLayout = initialTableLayout !== null\r\n          ? initialTableLayout\r\n          : getInitialTableLayout(dataset, territorialDims);\r\n        setTableLayout(newTableLayout);\r\n        setTmpTableLayout(newTableLayout);\r\n\r\n        const newChartLayout = initialChartLayout !== null\r\n          ? initialChartLayout\r\n          : getInitialChartLayout(dataset);\r\n        setChartLayout(newChartLayout);\r\n        setTmpChartLayout(newChartLayout);\r\n\r\n        const newMapLayout = initialMapLayout !== null\r\n          ? initialMapLayout\r\n          : getInitialMapLayout(dataset);\r\n        setMapLayout(newMapLayout);\r\n      }\r\n\r\n    } else {\r\n      setTableLayout(null);\r\n      setTmpTableLayout(null);\r\n      setChartLayout(null);\r\n      setTmpChartLayout(null);\r\n      setMapLayout(null);\r\n    }\r\n\r\n  }, [dataset, initialTableLayout, initialMapLayout, initialChartLayout, maxAllowedCells, territorialDims, isAccessible]);\r\n\r\n  const handleSetViewer = viewerIdx => {\r\n    onViewerChange(viewerIdx);\r\n  };\r\n\r\n  const handleSetData = dataIdx => {\r\n    // fetch new data\r\n  };\r\n\r\n  const handleLayoutOpen = () => {\r\n    if (jsonStat) {\r\n      setLayoutVisibility(true);\r\n    }\r\n  };\r\n\r\n  const handleLayoutClose = () => {\r\n    setLayoutVisibility(false);\r\n    setTmpTableLayout(tableLayout);\r\n    setTmpChartLayout(chartLayout);\r\n  };\r\n\r\n  const handleLayoutSubmit = () => {\r\n    setLayoutVisibility(false);\r\n\r\n    if (viewerIdx === 0) {\r\n      const newTableLayout = _.cloneDeep(tmpTableLayout);\r\n\r\n      newTableLayout.filtersValue = getInitialFiltersValue(jsonStat, newTableLayout.filters);\r\n\r\n      setTableLayout(newTableLayout);\r\n\r\n    } else if (viewerIdx >= 2) {\r\n      const newChartLayout = _.cloneDeep(tmpChartLayout);\r\n      const filtersValue = getInitialFiltersValue(jsonStat, newChartLayout.filters);\r\n\r\n      newChartLayout.filtersValue = filtersValue;\r\n\r\n      newChartLayout.primaryDimValues = chartLayout.primaryDim[0] !== newChartLayout.primaryDim[0]\r\n        ? getChartDimensionValues(jsonStat, newChartLayout.primaryDim[0], chartLayout.filters, filtersValue, 10)\r\n        : chartLayout.primaryDimValues;\r\n\r\n      newChartLayout.secondaryDimValues = chartLayout.secondaryDim[0] !== newChartLayout.secondaryDim[0]\r\n        ? getChartDimensionValues(jsonStat, newChartLayout.secondaryDim[0], chartLayout.filters, filtersValue, 10)\r\n        : chartLayout.secondaryDimValues;\r\n\r\n      setChartLayout(newChartLayout);\r\n    }\r\n  };\r\n\r\n  const handleCriteriaOpen = () => {\r\n    onCriteriaShow();\r\n  }\r\n\r\n  const handleCriteriaClose = () => {\r\n    onCriteriaHide();\r\n    setCriteriaValidity(true);\r\n  }\r\n\r\n  const handleCriteriaSubmit = () => {\r\n    onFetchDatasetEnable();\r\n  }\r\n\r\n  const handleFilterSelect = (dimension, value) => {\r\n\r\n    const getUpdatedLayout = layout => {\r\n      const newLayout = _.cloneDeep(layout);\r\n      newLayout.filtersValue[dimension] = value;\r\n\r\n      const filters = newLayout.filters.filter(filter => jsonStat.size[jsonStat.id.indexOf(filter)] > 1);\r\n      const fixedFilters = filters.slice(0, filters.indexOf(dimension) + 1);\r\n      const fixedFiltersValue = {};\r\n      fixedFilters.forEach(filter => fixedFiltersValue[filter] = newLayout.filtersValue[filter]);\r\n\r\n      newLayout.filtersValue = {\r\n        ...newLayout.filtersValue,\r\n        ...getInitialFiltersValue(jsonStat, filters.slice(filters.indexOf(dimension) + 1), fixedFiltersValue)\r\n      };\r\n\r\n      return newLayout\r\n    };\r\n\r\n    if (viewerIdx === 0) {\r\n      setTableLayout(getUpdatedLayout(tableLayout))\r\n\r\n    } else if (viewerIdx === 1) {\r\n      setMapLayout(getUpdatedLayout(mapLayout))\r\n\r\n    } else if (viewerIdx >= 2) {\r\n      let newChartLayout = _.cloneDeep(chartLayout);\r\n\r\n      if (chartLayout.filters.includes(dimension)) {\r\n        newChartLayout = getUpdatedLayout(chartLayout);\r\n      } else if (chartLayout.primaryDim.includes(dimension)) {\r\n        newChartLayout.primaryDimValues = value;\r\n      } else if (chartLayout.secondaryDim.includes(dimension)) {\r\n        newChartLayout.secondaryDimValues = value;\r\n      }\r\n\r\n      setChartLayout(newChartLayout);\r\n    }\r\n  };\r\n\r\n  const handleFontSizeSelect = size => {\r\n    setFontSize(size);\r\n  };\r\n\r\n  const handleFullscreen = () => {\r\n    !isFullscreen\r\n      ? document.getElementById(\"data-viewer__page__viewer\").classList.add(\"data-viewer__page__viewer--fullscreen\")\r\n      : document.getElementById(\"data-viewer__page__viewer\").classList.remove(\"data-viewer__page__viewer--fullscreen\");\r\n\r\n    setFullscreen(!isFullscreen);\r\n  };\r\n\r\n  return (\r\n    <div id=\"data-viewer\" className={classes.root}>\r\n      {false //isAccessible\r\n        ? (\r\n          <Call\r\n            cb={fetchAccessibleDataset}\r\n            cbParam={{nodeId, datasetId, filters, datasetTitle}}\r\n            disabled={!nodeId || !datasetId || !filters || !datasetTitle || isFetchDatasetDisabled}\r\n          >\r\n            <span>accessible data</span>\r\n          </Call>\r\n        )\r\n        : (\r\n          <Fragment>\r\n            <Call\r\n              cb={fetchDataset}\r\n              cbParam={{nodeId, datasetId, filters, datasetTitle, checkCriteriaLength: true, tableLayout}}\r\n              disabled={!nodeId || !datasetId || !filters || !datasetTitle || isFetchDatasetDisabled}\r\n            >\r\n              <div id=\"data-viewer__header\" className={classes.header}>\r\n                <DataViewerHeader\r\n                  nodeId={nodeId}\r\n                  nodeCode={nodeCode}\r\n                  nodeDownloadFormats={nodeExtras?.DownloadFormats}\r\n                  datasetId={datasetId}\r\n                  datasetTitle={datasetTitle}\r\n                  hasTemplateLayout={hasTemplateLayout}\r\n                  hasAnnotationLayout={hasAnnotationLayout}\r\n                  notes={notes}\r\n                  attachedFiles={attachedFiles}\r\n                  jsonStat={jsonStat}\r\n                  hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                  tableLayout={tableLayout}\r\n                  mapLayout={mapLayout}\r\n                  chartLayout={chartLayout}\r\n                  labelFormat={labelFormat}\r\n                  criteria={filters}\r\n                  decimalSeparator={decimalSeparator}\r\n                  decimalPlaces={decimalPlaces}\r\n                  emptyChar={emptyChar}\r\n                  viewers={viewers(t)}\r\n                  viewerIdx={viewerIdx}\r\n                  onViewTemplateSubmit={(viewTemplate, isView) => onViewTemplateSubmit(nodeId, viewTemplate, isView)}\r\n                  onDownloadSubmit={(format, extension) => onDownloadSubmit(nodeId, datasetId, datasetTitle, format, extension)}\r\n                  timings={timings}\r\n                />\r\n              </div>\r\n              <div id=\"data-viewer__page\" className={classes.page}>\r\n                <Card className={classes.sidebar}>\r\n                  <DataViewerSideBar\r\n                    viewers={viewers(t)}\r\n                    selected={viewerIdx}\r\n                    referenceMetadataUrl={referenceMetadataUrl}\r\n                    onViewerSelect={handleSetViewer}\r\n                    onCriteriaOpen={enableCriteria ? handleCriteriaOpen : null}\r\n                    onLayoutOpen={enableLayout ? handleLayoutOpen : null}\r\n                  />\r\n                </Card>\r\n                <Card className={classes.data}>\r\n                  <div id=\"data-viewer__page__viewer\" className={classes.viewerContainer}>\r\n                    <div id=\"data-viewer__page__viewer__filters-and-actions\" className={classes.filtersAndActions}>\r\n                      {jsonStat && (\r\n                        <Fragment>\r\n                          {isPartialData && (\r\n                            <Alert severity=\"warning\" className={classes.warningAlert}>\r\n                              {t(\"scenes.dataViewer.warnings.maxObservation.label\", {maxObservation: maxObservation ? numberFormatter(maxObservation) : \"\"})}\r\n                            </Alert>\r\n                          )}\r\n                          <div className={classes.filters}>\r\n                            {viewerIdx === 0 && tableLayout && (\r\n                              <DatasetFilters\r\n                                key={uuidv4()}\r\n                                jsonStat={jsonStat}\r\n                                hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                                layout={tableLayout}\r\n                                labelFormat={labelFormat}\r\n                                onSelect={handleFilterSelect}\r\n                              />\r\n                            )}\r\n                            {viewerIdx === 1 && mapLayout && (\r\n                              <DatasetFilters\r\n                                key={uuidv4()}\r\n                                jsonStat={jsonStat}\r\n                                hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                                layout={mapLayout}\r\n                                labelFormat={labelFormat}\r\n                                onSelect={handleFilterSelect}\r\n                              />\r\n                            )}\r\n                            {viewerIdx >= 2 && chartLayout && (\r\n                              <DatasetFilters\r\n                                key={uuidv4()}\r\n                                jsonStat={jsonStat}\r\n                                hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                                layout={chartLayout}\r\n                                labelFormat={labelFormat}\r\n                                onSelect={handleFilterSelect}\r\n                                multiSelectDimensions={[chartLayout.primaryDim[0], chartLayout.secondaryDim[0]]}\r\n                                multiSelectDimensionsValues={{\r\n                                  [chartLayout.primaryDim[0]]: chartLayout.primaryDimValues,\r\n                                  [chartLayout.secondaryDim[0]]: chartLayout.secondaryDimValues\r\n                                }}\r\n                              />\r\n                            )}\r\n                          </div>\r\n                          <div className={classes.actions}>\r\n                            <Grid container>\r\n                              <Grid item className={classes.action}>\r\n                                <LabelFormatSelector\r\n                                  labelFormat={labelFormat}\r\n                                  setLabelFormat={labelFormat => onLabelFormatChange(labelFormat)}\r\n                                />\r\n                              </Grid>\r\n                              <Grid item className={classes.action}>\r\n                                <FontSizeSelector\r\n                                  fontSize={fontSize}\r\n                                  setFontSize={handleFontSizeSelect}\r\n                                />\r\n                              </Grid>\r\n                              <Grid item className={classes.action}>\r\n                                <Tooltip\r\n                                  title={isFullscreen\r\n                                    ? t(\"scenes.dataViewer.fullscreen.exit\")\r\n                                    : t(\"scenes.dataViewer.fullscreen.enter\")\r\n                                  }\r\n                                >\r\n                                  <IconButton onClick={handleFullscreen}>\r\n                                    {isFullscreen ? <FullscreenExitIcon/> : <FullscreenIcon/>}\r\n                                  </IconButton>\r\n                                </Tooltip>\r\n                              </Grid>\r\n                            </Grid>\r\n                          </div>\r\n                        </Fragment>\r\n                      )}\r\n                    </div>\r\n                    <div id=\"data-viewer__page__viewer__viewer\" className={classes.viewer}>\r\n                      {(() => {\r\n                        if (!jsonStat) {\r\n                          return isEmptyData\r\n                            ? <CustomEmpty text={t(\"scenes.dataViewer.errors.emptyData\")}/>\r\n                            : <CustomEmpty text={t(\"scenes.dataViewer.errors.applyCriteria\")}/>\r\n                        }\r\n                        if (viewerIdx === 0) {\r\n                          return (tableLayout && getJsonStatTableSize(jsonStat) < maxAllowedCells)\r\n                            ? (\r\n                              <JsonStatTable\r\n                                jsonStat={jsonStat}\r\n                                layout={tableLayout}\r\n                                labelFormat={labelFormat}\r\n                                fontSize={fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_SM\r\n                                  ? JSONSTAT_TABLE_FONT_SIZE_SM\r\n                                  : fontSize === FONT_SIZE_SELECTOR_FONT_SIZE_MD\r\n                                    ? JSONSTAT_TABLE_FONT_SIZE_MD\r\n                                    : JSONSTAT_TABLE_FONT_SIZE_LG\r\n                                }\r\n                                isFullscreen={isFullscreen}\r\n                                decimalSeparator={decimalSeparator}\r\n                                decimalPlaces={decimalPlaces}\r\n                                emptyChar={emptyChar}\r\n                                hiddenAttributes={nodeExtras?.HiddenAttributes}\r\n                              />\r\n                            )\r\n                            : (\r\n                              <CustomEmpty\r\n                                text={t(\"scenes.dataViewer.errors.tooBigData\")}\r\n                              />\r\n                            )\r\n                        } else if (viewerIdx === 1) {\r\n                          return (\r\n                            <Map\r\n                              jsonStat={jsonStat}\r\n                              mapLayout={mapLayout}\r\n                              onGeometryFetch={onGeometryFetch}\r\n                              classes={classes}\r\n                              geometries={geometries}\r\n                              geometryDetailLevels={geometryDetailLevels}\r\n                            />\r\n                          )\r\n                        } else if (viewerIdx >= 2) {\r\n                          return (\r\n                            <ChartWrapper\r\n                              jsonStat={jsonStat}\r\n                              type={viewers(t)[viewerIdx].chartType}\r\n                              layout={chartLayout}\r\n                            />\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              </div>\r\n              <div id=\"data-viewer__footer\" className={classes.footer}>\r\n                <DataViewerFooter\r\n                  labels={dataset ? [datasetTitle] : []}\r\n                  dataIdx={0}\r\n                  setData={handleSetData}\r\n                />\r\n              </div>\r\n            </Call>\r\n\r\n            <Dialog\r\n              open={isCriteriaVisible}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleCriteriaClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.criteria.title\")}\r\n              </DialogTitle>\r\n              <DialogContent className={classes.criteriaContent}>\r\n                {dimensions && isCriteriaVisible && (\r\n                  <Fragment>\r\n\r\n                    <Criteria\r\n                      nodeId={nodeId}\r\n                      datasetId={datasetId}\r\n                      dimensions={dimensions}\r\n                      mode={mode}\r\n                      type={type}\r\n                      codes={codes}\r\n                      isCodesFlat={isCodesFlat}\r\n                      codelists={codelists}\r\n                      areCodelistsFlat={areCodelistsFlat}\r\n                      codelistsLength={codelistsLength}\r\n                      filters={filters}\r\n                      timePeriod={timePeriod}\r\n                      isCriteriaValid={isCriteriaValid}\r\n                      setCriteriaValidity={setCriteriaValidity}\r\n                    />\r\n\r\n                    <Dialog\r\n                      open={isCriteriaAlertVisible}\r\n                      fullWidth\r\n                      maxWidth=\"sm\"\r\n                      onClose={onCriteriaAlertHide}\r\n                    >\r\n                      {(() => {\r\n                        if (isEmptyData) {\r\n                          return (\r\n                            <DialogTitle>\r\n                              {t(\"scenes.dataViewer.errors.emptyData\")}\r\n                            </DialogTitle>\r\n                          )\r\n\r\n                        } else if (isTooBigData) {\r\n                          const count = getJsonStatTableSize(jsonStat);\r\n\r\n                          return (\r\n                            <Fragment>\r\n                              <DialogTitle>\r\n                                {t(\"scenes.dataViewer.dialogs.tooBigData.title\")}\r\n                              </DialogTitle>\r\n                              <DialogContent>\r\n                                {count !== 0 && (\r\n                                  <div style={{width: \"100%\", textAlign: \"end\"}}>\r\n                                    {t(\"scenes.dataViewer.dialogs.tooBigData.content.requestCells\")}: <b>{numberFormatter(count)}</b>\r\n                                  </div>\r\n                                )}\r\n                                <div style={{width: \"100%\", textAlign: \"end\"}}>\r\n                                  {t(\"scenes.dataViewer.dialogs.tooBigData.content.maxCells\")}: <b>{numberFormatter(maxAllowedCells)}</b>\r\n                                </div>\r\n                                <div style={{width: \"100%\", textAlign: \"end\", marginTop: 16}}>\r\n                                  {t(\"scenes.dataViewer.dialogs.tooBigData.content.applyCriteria\")}\r\n                                </div>\r\n                              </DialogContent>\r\n                            </Fragment>\r\n                          )\r\n\r\n                        } else {\r\n                          return (\r\n                            <DialogTitle>\r\n                              {t(\"scenes.dataViewer.errors.genericError\")}\r\n                            </DialogTitle>\r\n                          )\r\n                        }\r\n                      })()}\r\n                      <DialogActions>\r\n                        <Button autoFocus onClick={onCriteriaAlertHide} color=\"primary\">\r\n                          {t(\"commons.confirm.confirm\")}\r\n                        </Button>\r\n                      </DialogActions>\r\n                    </Dialog>\r\n\r\n                  </Fragment>\r\n                )}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleCriteriaClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button\r\n                  autoFocus\r\n                  color=\"primary\"\r\n                  onClick={handleCriteriaSubmit}\r\n                  disabled={!isCriteriaValid}\r\n                >\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isLayoutVisible && viewerIdx === 0}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleLayoutClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.tableLayout.title\")}\r\n              </DialogTitle>\r\n              <DialogContent>\r\n                <TableLayout\r\n                  jsonStat={jsonStat}\r\n                  layout={tmpTableLayout}\r\n                  labelFormat={labelFormat}\r\n                  setLayout={setTmpTableLayout}\r\n                />\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleLayoutClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button autoFocus onClick={handleLayoutSubmit} color=\"primary\">\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isLayoutVisible && viewerIdx >= 2}\r\n              fullWidth\r\n              maxWidth=\"md\"\r\n              onClose={handleLayoutClose}\r\n            >\r\n              <DialogTitle>\r\n                {t(\"scenes.dataViewer.dialogs.chartLayout.title\")}\r\n              </DialogTitle>\r\n              <DialogContent>\r\n                <ChartLayout\r\n                  jsonStat={jsonStat}\r\n                  layout={tmpChartLayout}\r\n                  setLayout={setTmpChartLayout}\r\n                />\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={handleLayoutClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button autoFocus onClick={handleLayoutSubmit} color=\"primary\">\r\n                  {t(\"commons.confirm.apply\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isDownloadWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onDownloadHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.downloadFormat.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onDownloadHide}>\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isUnavailableViewWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onUnavailableViewHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.unavailableView.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onUnavailableViewHide}>\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n              open={isCriteriaLengthWarningVisible}\r\n              maxWidth=\"md\"\r\n              onClose={onCriteriaLengthWarningHide}\r\n            >\r\n              <DialogContent>\r\n                {t(\"scenes.dataViewer.dialogs.tooLongQuery.content\")}\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={onCriteriaLengthWarningHide}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n                <Button\r\n                  onClick={() => fetchDataset({\r\n                    nodeId,\r\n                    datasetId,\r\n                    filters,\r\n                    datasetTitle,\r\n                    checkCriteriaLength: false,\r\n                    tableLayout\r\n                  })}\r\n                >\r\n                  {t(\"commons.confirm.confirm\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n          </Fragment>\r\n        )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(null, mapDispatchToProps)\r\n)(DataViewer)","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  DASHBOARDS_DASHBOARD_FETCH,\r\n  DASHBOARDS_DASHBOARDS_CLEAR,\r\n  DASHBOARDS_DATASET_FETCH,\r\n  DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET,\r\n  DASHBOARDS_MAP_GEOMETRIES_FETCH\r\n} from \"./dashboardActions\";\r\nimport _ from \"lodash\"\r\nimport {DASHBOARD_ELEM_FILTER_DIMENSION_KEY, getViewIdxFromRowAndCol} from \"../../utils/dashboards\";\r\n\r\nexport const DASHBOARD_VIEW_STATE_APPLY_FILTERS = \"DASHBOARD_VIEW_STATE_APPLY_FILTERS\"\r\nexport const DASHBOARD_VIEW_STATE_ERROR = \"DASHBOARD_VIEW_STATE_ERROR\"\r\nexport const DASHBOARD_VIEW_STATE_FETCHING = \"DASHBOARD_VIEW_STATE_FETCHING\"\r\n\r\ntype DashboardState = {\r\n  dashboards: any | null,\r\n  isFetchDatasetDisabled: boolean,\r\n  jsonStats: any | null,\r\n  maps: any | null\r\n}\r\n\r\nconst initialState = {\r\n  dashboards: null,\r\n  isFetchDatasetDisabled: true,\r\n  jsonStats: null,\r\n  maps: null\r\n};\r\n\r\nconst dashboardReducer: Reducer<DashboardState> = (\r\n  state = initialState,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case DASHBOARDS_DASHBOARDS_CLEAR: {\r\n      return initialState\r\n    }\r\n    case DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET: {\r\n      return {\r\n        ...state,\r\n        isFetchDatasetDisabled: action.payload.disabled\r\n      }\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DATASET_FETCH: {\r\n\r\n          let currentDashboardJsonStats = {};\r\n          state.dashboards[action.payload.extra.dashboardId].dashboardConfig.forEach((row: any, rowIdx: number) => {\r\n            row.forEach((col: any, colIdx: number) => {\r\n              const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n\r\n              if (!col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY].length === 0) {\r\n                currentDashboardJsonStats = {\r\n                  ...currentDashboardJsonStats,\r\n                  [viewIdx]: (state.jsonStats?.[action.payload.extra.dashboardId]?.[viewIdx] || DASHBOARD_VIEW_STATE_FETCHING)\r\n                }\r\n              } else {\r\n                currentDashboardJsonStats = {\r\n                  ...currentDashboardJsonStats,\r\n                  [viewIdx]: DASHBOARD_VIEW_STATE_FETCHING\r\n                }\r\n              }\r\n            });\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            jsonStats: {\r\n              ...state.jsonStats,\r\n              [action.payload.extra.dashboardId]: currentDashboardJsonStats\r\n            }\r\n          }\r\n        }\r\n        case DASHBOARDS_MAP_GEOMETRIES_FETCH: {\r\n          return {\r\n            ...state,\r\n            maps: {\r\n              ...state.maps,\r\n              [action.payload.extra.dashboardId]: null\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DASHBOARD_FETCH: {\r\n          const views = action.payload.response.views;\r\n          for (let key in views) {\r\n            if (views.hasOwnProperty(key)) {\r\n              views[key] = {\r\n                ...views[key],\r\n                datasetId: views[key].datasetId ? views[key].datasetId.split(\"+\").join(\",\") : undefined\r\n              }\r\n            }\r\n          }\r\n\r\n          return {\r\n            ...state,\r\n            dashboards: {\r\n              ...state.dashboards,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...action.payload.response,\r\n                dashboardConfig: action.payload.response?.dashboardConfig\r\n                  ? JSON.parse(action.payload.response.dashboardConfig)\r\n                  : {},\r\n                filterLevels: action.payload.response?.filterLevels\r\n                  ? JSON.parse(action.payload.response.filterLevels)\r\n                  : {},\r\n                views: views\r\n              }\r\n            }\r\n          }\r\n        }\r\n        case DASHBOARDS_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.jsonStats);\r\n          const jsonStat = (action.payload.response?.id || []).length > 0\r\n            ? action.payload.response\r\n            : \"\";\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...jsonStats[action.payload.extra.dashboardId],\r\n                [id]: jsonStat\r\n              }\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            jsonStats: jsonStats\r\n          }\r\n        }\r\n        case DASHBOARDS_MAP_GEOMETRIES_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any, idx: number) => val.nutsLevel)\r\n            .reduce((acc: any, val: any) => {\r\n              if (!acc[val]) {\r\n                const label = \"Nuts level \" + val;\r\n                acc[val] = {level: val, counter: 0, label: label};\r\n              }\r\n              acc[val].counter++;\r\n              return acc;\r\n            }, []);\r\n\r\n          return {\r\n            ...state,\r\n            maps: {\r\n              ...state.maps,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...state.maps[action.payload.extra.dashboardId],\r\n                [action.payload.extra.requestId]: {\r\n                  geometries: action.payload.response,\r\n                  geometryDetailLevels: detailLevels\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DASHBOARDS_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.jsonStats);\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [action.payload.extra.dashboardId]: {\r\n                ...jsonStats[action.payload.extra.dashboardId],\r\n                [id]: DASHBOARD_VIEW_STATE_ERROR\r\n              }\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            jsonStats: jsonStats\r\n          }\r\n        }\r\n        default:\r\n          return state\r\n      }\r\n    }\r\n    default:\r\n      return state\r\n  }\r\n};\r\n\r\nexport default dashboardReducer;","import {initRequest, RequestMethod} from \"../../middlewares/request/requestActions\";\r\nimport {getDashboardsUrl, getDatasetUrl, getGeometryUrl} from \"../../serverApi/urls\";\r\nimport {getCriteriaRequestObject} from \"../../utils/datasets\";\r\n\r\nexport const DASHBOARDS_DASHBOARD_FETCH = \"dashboards/dashboard/fetch\";\r\nexport const DASHBOARDS_DASHBOARDS_CLEAR = \"dashboards/dashboards/clear\";\r\nexport const DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET = \"dashboards/dataset/fetch/enableStatus/set\";\r\nexport const DASHBOARDS_DATASET_FETCH = \"dashboards/dataset/fetch\";\r\nexport const DASHBOARDS_MAP_GEOMETRIES_FETCH = \"dashboards/map/geometries/fetch\";\r\n\r\nexport const fetchDashboardsDashboard = (dashboardId: number) => initRequest(\r\n  DASHBOARDS_DASHBOARD_FETCH,\r\n  getDashboardsUrl(dashboardId),\r\n  RequestMethod.GET,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDashboard\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId\r\n  }\r\n);\r\n\r\nexport const clearDashboardsDashboards = () => ({\r\n  type: DASHBOARDS_DASHBOARDS_CLEAR\r\n});\r\n\r\nexport const setDashboardsDatasetFetchEnableStatus = (enabled: boolean) => ({\r\n  type: DASHBOARDS_DATASET_FETCH_ENABLE_STATUS_SET,\r\n  payload: {\r\n    disabled: !enabled\r\n  }\r\n});\r\n\r\nexport const fetchDashboardsDataset = (dashboardId: number, nodeId: number, datasetId: string, criteria: any, requestIds: string[]) => initRequest(\r\n  DASHBOARDS_DATASET_FETCH,\r\n  getDatasetUrl(nodeId, datasetId),\r\n  RequestMethod.POST,\r\n  getCriteriaRequestObject(criteria),\r\n  t => ({\r\n    onStart: t(\"scenes.dashboard.actions.fetchingDataset\")\r\n  }),\r\n  {\r\n    dashboardId: dashboardId,\r\n    requestIds: requestIds\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);\r\n\r\nexport const fetchDashboardsMapGeometries = (dashboardId: number, idList: string[], requestId: string) => initRequest(\r\n  DASHBOARDS_MAP_GEOMETRIES_FETCH,\r\n  getGeometryUrl(),\r\n  RequestMethod.POST,\r\n  idList,\r\n  t => ({\r\n    onStart: t(`scenes.dashboard.actions.fetchingGeometries`)\r\n  }),\r\n  {\r\n    dashboardId: dashboardId,\r\n    requestId: requestId\r\n  },\r\n  \"\",\r\n  () => true,\r\n  true\r\n);","import React, {Fragment, useEffect, useState} from \"react\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {\r\n  DASHBOARD_ELEM_ENABLE_FILTERS_KEY,\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_SHOW_TITLE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_TEXT,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../utils/dashboards\";\r\nimport JsonStatTable from \"../table\";\r\nimport CustomEmpty from \"../custom-empty\";\r\nimport _ from \"lodash\";\r\nimport {getViewerIdxFromType} from \"../data-viewer\";\r\nimport ChartWrapper from \"../data-viewer/ChartWrapper\";\r\nimport DatasetFilters from \"../dataset-filters\";\r\nimport Map from \"../map\";\r\nimport {\r\n  getDimensionLabelFromJsonStat,\r\n  getDimensionValueLabelFromJsonStat,\r\n  getFilteredLayoutObject\r\n} from \"../../utils/jsonStat\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport {localizeI18nObj} from \"../../utils/i18n\";\r\nimport {\r\n  DASHBOARD_VIEW_STATE_APPLY_FILTERS,\r\n  DASHBOARD_VIEW_STATE_ERROR,\r\n  DASHBOARD_VIEW_STATE_FETCHING\r\n} from \"../../state/dashboard/dashboardReducer\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport \"./style.css\"\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nconst styles = theme => ({\r\n  row: {\r\n    width: \"100%\",\r\n    marginTop: 8\r\n  },\r\n  col: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"top\"\r\n  },\r\n  viewContainer: {\r\n    padding: 16,\r\n    height: 640,\r\n    width: \"100%\",\r\n    overflow: \"auto\"\r\n  },\r\n  viewPlaceholder: {\r\n    height: \"100%\"\r\n  },\r\n  viewControllers: {\r\n    paddingBottom: 16\r\n  },\r\n  viewTitle: {\r\n    fontSize: 18,\r\n    marginBottom: 8\r\n  },\r\n  viewStaticFilters: {\r\n    marginBottom: 8\r\n  },\r\n  viewStaticFilter: {\r\n    display: \"inline-block\",\r\n    marginRight: 8\r\n  },\r\n  viewActiveFilters: {},\r\n  view: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst handleHeight = (uuid, viewIdx) => {\r\n  const controllersHeight = document.getElementById(`dashboard__view-container__${uuid}__controllers__${viewIdx}`)?.offsetHeight || 0;\r\n  const view = document.getElementById(`dashboard__view-container__${uuid}__view__${viewIdx}`);\r\n  if (view) {\r\n    view.setAttribute(\"style\", `height: calc(100% - ${controllersHeight}px)`);\r\n  }\r\n};\r\n\r\nfunction DashboardCol(props) {\r\n\r\n  const {\r\n    t,\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    dashboard,\r\n    filterValue,\r\n    rowIdx,\r\n    colIdx,\r\n    col,\r\n    jsonStats,\r\n    viewLayouts,\r\n    onSelect,\r\n    maps,\r\n    fetchMapGeometries\r\n  } = props;\r\n\r\n  const [uuid] = useState(uuidv4());\r\n\r\n  const [isFullscreen, setFullscreen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const func = () => handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n\r\n    window.addEventListener(\"resize\", func);\r\n    return () => window.removeEventListener(\"resize\", func)\r\n  }, [uuid, rowIdx, colIdx]);\r\n\r\n  useEffect(() => {\r\n    handleHeight(uuid, getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n  }, [uuid, rowIdx, colIdx, col, jsonStats, viewLayouts]);\r\n\r\n  const handleFullscreen = () => {\r\n    !isFullscreen\r\n      ? document.getElementById(`dashboard__view-container__${uuid}__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`).classList.add(\"dashboard__view-container--fullscreen\")\r\n      : document.getElementById(`dashboard__view-container__${uuid}__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`).classList.remove(\"dashboard__view-container--fullscreen\");\r\n\r\n    setFullscreen(!isFullscreen);\r\n  };\r\n\r\n  return (\r\n    <div className={classes.col} style={{width: `${col.widthPercentage}%`}}>\r\n      <div\r\n        id={`dashboard__view-container__${uuid}__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`}\r\n        className={classes.viewContainer}\r\n      >\r\n        {(() => {\r\n          if (col.type === DASHBOARD_ELEM_TYPE_VALUE_TEXT) {\r\n            return (\r\n              <Fragment>\r\n                <div style={{float: \"right\"}}>\r\n                  <Tooltip\r\n                    title={isFullscreen\r\n                      ? t(\"components.dashboard.fullscreen.exit\")\r\n                      : t(\"components.dashboard.fullscreen.enter\")\r\n                    }\r\n                  >\r\n                    <IconButton\r\n                      color=\"primary\"\r\n                      onClick={handleFullscreen}\r\n                    >\r\n                      {isFullscreen ? <FullscreenExitIcon/> : <FullscreenIcon/>}\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                </div>\r\n                <div dangerouslySetInnerHTML={{__html: localizeI18nObj(col.value, defaultLanguage, languages)}}/>\r\n              </Fragment>\r\n            )\r\n          } else if (jsonStats && viewLayouts) {\r\n            return (\r\n              <Fragment>\r\n                {(() => {\r\n                  const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n                  const jsonStat = jsonStats[viewIdx];\r\n                  let layout = _.cloneDeep(viewLayouts[viewIdx]);\r\n\r\n                  if (jsonStat === DASHBOARD_VIEW_STATE_ERROR) {\r\n                    return (\r\n                      <div className={classes.viewPlaceholder}>\r\n                        <CustomEmpty\r\n                          text={t(\"components.dashboard.fetchingDatasetError\")}\r\n                          backgroundColor={\"#f5f5f5\"}\r\n                        />\r\n                      </div>\r\n                    )\r\n                  } else if (jsonStat === DASHBOARD_VIEW_STATE_APPLY_FILTERS) {\r\n                    return (\r\n                      <div className={classes.viewPlaceholder}>\r\n                        <CustomEmpty\r\n                          text={t(\"components.dashboard.applyFilters\")}\r\n                          backgroundColor={\"#f5f5f5\"}\r\n                        />\r\n                      </div>\r\n                    )\r\n                  } else if (jsonStat === DASHBOARD_VIEW_STATE_FETCHING) {\r\n                    return (\r\n                      <div className={classes.viewPlaceholder}>\r\n                        <CustomEmpty\r\n                          text={t(\"components.dashboard.fetching\") + \"...\"}\r\n                          backgroundColor={\"#f5f5f5\"}\r\n                          image={<CircularProgress/>}\r\n                        />\r\n                      </div>\r\n                    )\r\n                  } else if (jsonStat === \"\") {\r\n                    return (\r\n                      <div className={classes.viewPlaceholder}>\r\n                        <CustomEmpty\r\n                          text={t(\"components.dashboard.emptyView\")}\r\n                          backgroundColor={\"#f5f5f5\"}\r\n                        />\r\n                      </div>\r\n                    )\r\n                  } else if (jsonStat && layout) {\r\n\r\n                    const view = _.cloneDeep(dashboard.views[col.value]);\r\n                    const viewerIdx = getViewerIdxFromType(view.defaultView);\r\n\r\n                    const filter = col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY];\r\n                    if (filter && filterValue) {\r\n                      if ((layout.filters || []).includes(filter)) {\r\n                        layout.filtersValue = {\r\n                          ...layout.filtersValue,\r\n                          [filter]: filterValue\r\n                        };\r\n                      } else if ((layout.primaryDim || []).includes(filter)) {\r\n                        layout.primaryDimValues = {\r\n                          ...layout.primaryDimValues,\r\n                          [filter]: filterValue\r\n                        };\r\n                      } else if ((layout.secondaryDim || []).includes(filter)) {\r\n                        layout.secondaryDimValues = {\r\n                          ...layout.secondaryDimValues,\r\n                          [filter]: filterValue\r\n                        };\r\n                      }\r\n                    }\r\n\r\n                    const staticFilters = [];\r\n                    layout.filters.forEach(dim => {\r\n                      if (jsonStat.size[jsonStat.id.indexOf(dim)] === 1) {\r\n                        staticFilters.push({\r\n                          dim: dim,\r\n                          dimLabel: getDimensionLabelFromJsonStat(jsonStat, dim),\r\n                          value: jsonStat.dimension[dim].category.index[0],\r\n                          valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, dim, jsonStat.dimension[dim].category.index[0])\r\n                        })\r\n                      }\r\n                    });\r\n                    if (!col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY]) {\r\n                      layout.filters.forEach(dim => {\r\n                        if (jsonStat.size[jsonStat.id.indexOf(dim)] !== 1) {\r\n                          staticFilters.push({\r\n                            dim: dim,\r\n                            dimLabel: getDimensionLabelFromJsonStat(jsonStat, dim),\r\n                            value: layout.filtersValue[dim],\r\n                            valueLabel: getDimensionValueLabelFromJsonStat(jsonStat, dim, layout.filtersValue[dim])\r\n                          })\r\n                        }\r\n                      });\r\n                    }\r\n\r\n                    return (\r\n                      <Fragment>\r\n                        <div\r\n                          id={`dashboard__view-container__${uuid}__controllers__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`}\r\n                          className={classes.viewControllers}\r\n                        >\r\n                          <div style={{float: \"right\"}}>\r\n                            <Tooltip\r\n                              title={isFullscreen\r\n                                ? t(\"components.dashboard.fullscreen.exit\")\r\n                                : t(\"components.dashboard.fullscreen.enter\")\r\n                              }\r\n                            >\r\n                              <IconButton\r\n                                color=\"primary\"\r\n                                onClick={handleFullscreen}\r\n                              >\r\n                                {isFullscreen ? <FullscreenExitIcon/> : <FullscreenIcon/>}\r\n                              </IconButton>\r\n                            </Tooltip>\r\n                          </div>\r\n                          {col[DASHBOARD_ELEM_SHOW_TITLE_KEY] && (\r\n                            <div className={classes.viewTitle}>\r\n                              {localizeI18nObj(view.title, defaultLanguage, languages)}\r\n                            </div>\r\n                          )}\r\n                          <div className={classes.viewStaticFilters}>\r\n                            {staticFilters.map(({dim, dimLabel, value, valueLabel}, idx) =>\r\n                              <div key={idx} className={classes.viewStaticFilter}>\r\n                                <b>{(dimLabel || dim)}</b>: <i>{(valueLabel || value)}</i>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                          {col[DASHBOARD_ELEM_ENABLE_FILTERS_KEY] && (\r\n                            <div className={classes.viewActiveFilters}>\r\n                              <DatasetFilters\r\n                                jsonStat={jsonStat}\r\n                                layout={layout}\r\n                                onSelect={(dimension, value) => onSelect(viewIdx, dimension, value)}\r\n                              />\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                        <div\r\n                          id={`dashboard__view-container__${uuid}__view__${getViewIdxFromRowAndCol(rowIdx, colIdx)}`}\r\n                          className={classes.view}\r\n                        >\r\n                          {(() => {\r\n                            if (viewerIdx === 0) {\r\n                              return (\r\n                                <JsonStatTable\r\n                                  jsonStat={jsonStat}\r\n                                  layout={layout}\r\n                                  labelFormat={view.layouts.labelFormat}\r\n                                  decimalSeparator={\",\"} // TODO\r\n                                  decimalPlaces={view.decimalNumber} // TODO\r\n                                  emptyChar={\"\"} // TODO\r\n                                  hideSpinner\r\n                                />\r\n                              )\r\n                            } else if (viewerIdx === 1) {\r\n                              return (\r\n                                <Map\r\n                                  classes={classes}\r\n                                  jsonStat={jsonStat}\r\n                                  mapLayout={layout}\r\n                                  onGeometryFetch={idList => fetchMapGeometries(idList, viewIdx)}\r\n                                  geometries={maps?.[viewIdx]?.geometries || null}\r\n                                  geometryDetailLevels={maps?.[viewIdx]?.geometryDetailLevels || null}\r\n                                  hideSpinner\r\n                                />\r\n                              )\r\n                            } else {\r\n                              return (\r\n                                <ChartWrapper\r\n                                  jsonStat={jsonStat}\r\n                                  type={view.defaultView}\r\n                                  layout={layout}\r\n                                />\r\n                              )\r\n                            }\r\n                          })()}\r\n                        </div>\r\n                      </Fragment>\r\n                    )\r\n                  } else {\r\n                    return <span/>\r\n                  }\r\n                })()}\r\n              </Fragment>\r\n            )\r\n          }\r\n        })()}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst DashboardRow = ({\r\n                        t,\r\n                        classes,\r\n                        defaultLanguage,\r\n                        languages,\r\n                        dashboard,\r\n                        filterValue,\r\n                        row,\r\n                        rowIdx,\r\n                        jsonStats,\r\n                        viewLayouts,\r\n                        onSelect,\r\n                        maps,\r\n                        fetchMapGeometries\r\n                      }) =>\r\n  <div className={classes.row}>\r\n    {row.map((col, idx) =>\r\n      <DashboardCol\r\n        key={idx}\r\n        t={t}\r\n        classes={classes}\r\n        defaultLanguage={defaultLanguage}\r\n        languages={languages}\r\n        dashboard={dashboard}\r\n        filterValue={filterValue}\r\n        rowIdx={rowIdx}\r\n        colIdx={idx}\r\n        col={col}\r\n        jsonStats={jsonStats}\r\n        viewLayouts={viewLayouts}\r\n        onSelect={onSelect}\r\n        maps={maps}\r\n        fetchMapGeometries={fetchMapGeometries}\r\n      />\r\n    )}\r\n  </div>;\r\n\r\nfunction Dashboard(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    dashboard,\r\n    filterValue,\r\n    jsonStats,\r\n    maps,\r\n    fetchMapGeometries\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [viewLayouts, setViewLayouts] = useState(null);\r\n\r\n  useEffect(() => {\r\n    dashboard.dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col.type === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n          setViewLayouts(prevViewLayouts => {\r\n            const newViewLayouts = prevViewLayouts\r\n              ? _.cloneDeep(prevViewLayouts)\r\n              : {};\r\n\r\n            const viewIdx = getViewIdxFromRowAndCol(rowIdx, colIdx);\r\n            if (!jsonStats?.[viewIdx]?.id) {\r\n              return newViewLayouts;\r\n            }\r\n\r\n            const layouts = JSON.parse(dashboard.views[col.value].layouts);\r\n            let layout = (layouts.tableLayout || layouts.mapLayout || layouts.chartLayout);\r\n            layout = getFilteredLayoutObject(jsonStats[viewIdx], layout);\r\n\r\n            newViewLayouts[viewIdx] = layout;\r\n            return newViewLayouts;\r\n          });\r\n        }\r\n      })\r\n    })\r\n  }, [dashboard, jsonStats]);\r\n\r\n  const handleFilterSelect = (viewIdx, dimension, value) => {\r\n    setViewLayouts(prevViewLayouts => {\r\n      const newViewLayouts = _.cloneDeep(prevViewLayouts);\r\n\r\n      if (newViewLayouts[viewIdx].filters.includes(dimension)) {\r\n        newViewLayouts[viewIdx].filtersValue[dimension] = value;\r\n      } else if (newViewLayouts[viewIdx].primaryDim.includes(dimension)) {\r\n        newViewLayouts[viewIdx].primaryDimValues = value;\r\n      } else if (newViewLayouts[viewIdx].secondaryDim.includes(dimension)) {\r\n        newViewLayouts[viewIdx].secondaryDimValues = value;\r\n      }\r\n\r\n      return newViewLayouts;\r\n    });\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      {(dashboard.dashboardConfig || []).map((row, idx) =>\r\n        <DashboardRow\r\n          key={idx}\r\n          t={t}\r\n          classes={classes}\r\n          defaultLanguage={defaultLanguage}\r\n          languages={languages}\r\n          dashboard={dashboard}\r\n          filterValue={filterValue}\r\n          row={row}\r\n          rowIdx={idx}\r\n          jsonStats={jsonStats}\r\n          viewLayouts={viewLayouts}\r\n          onSelect={handleFilterSelect}\r\n          maps={maps}\r\n          fetchMapGeometries={fetchMapGeometries}\r\n        />\r\n      )}\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(state => ({\r\n    languages: state.app.languages,\r\n    defaultLanguage: state.app.language\r\n  }))\r\n)(Dashboard);","import React, {forwardRef, Fragment, useEffect, useImperativeHandle, useState} from 'react';\r\nimport Search from \"@material-ui/icons/Search\";\r\nimport Clear from \"@material-ui/icons/Clear\";\r\nimport {Box, withStyles} from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\nimport EditIcon from \"@material-ui/icons/Edit\";\r\nimport {\r\n  changeOtherConfigDashboard,\r\n  clearOtherConfigDashboards,\r\n  clearOtherConfigDashboardsDataset,\r\n  clearOtherConfigDashboardViews,\r\n  closeOtherConfigDashboard,\r\n  createOtherConfigDashboard,\r\n  deleteOtherConfigDashboard,\r\n  fetchOtherConfigDashboards,\r\n  fetchOtherConfigDashboardsDataset,\r\n  fetchOtherConfigDashboardsMapGeometries,\r\n  fetchOtherConfigDashboardViews,\r\n  hideOtherConfigDashboard,\r\n  submitOtherConfigDashboardCreate,\r\n  submitOtherConfigDashboardUpdate,\r\n  updateOtherConfigDashboard\r\n} from \"../../../state/otherConfig/otherConfigActions\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\nimport {goToDashboard} from \"../../../links\";\r\nimport DashboardBuilder from \"../../dashboard-builder\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport CustomMaterialTable from \"../../custom-material-table\";\r\nimport {\r\n  getI18nObjCustomFilterAndSearch,\r\n  localizeI18nObj,\r\n  validateI18nObj\r\n} from \"../../../utils/i18n\";\r\nimport Call from \"../../../hocs/call\";\r\nimport Dashboard from \"../../dashboard\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../../../utils/dashboards\";\r\nimport _ from \"lodash\"\r\nimport {MTableToolbar} from \"material-table\";\r\n\r\nconst tableIcons = {\r\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref}/>),\r\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref}/>),\r\n};\r\n\r\nconst styles = theme => ({\r\n  tableToolbar: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages,\r\n  needDashboards: state.otherConfig.needDashboards,\r\n  dashboards: state.otherConfig.dashboards,\r\n  dashboard: state.otherConfig.dashboard,\r\n  dashboardViews: state.otherConfig.dashboardViews,\r\n  dashboardJsonStats: state.otherConfig.dashboardJsonStats,\r\n  dashboardMaps: state.otherConfig.dashboardMaps\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboards: () => dispatch(fetchOtherConfigDashboards()),\r\n  clearDashboards: () => dispatch(clearOtherConfigDashboards()),\r\n  createDashboard: dashboard => dispatch(createOtherConfigDashboard(dashboard)),\r\n  updateDashboard: dashboardId => dispatch(updateOtherConfigDashboard(dashboardId)),\r\n  changeDashboard: dashboard => dispatch(changeOtherConfigDashboard(dashboard)),\r\n  submitDashboardCreate: dashboard => dispatch(submitOtherConfigDashboardCreate(dashboard)),\r\n  submitDashboardUpdate: (dashboardId, dashboard) => dispatch(submitOtherConfigDashboardUpdate(dashboardId, dashboard)),\r\n  deleteDashboard: dashboardId => dispatch(deleteOtherConfigDashboard(dashboardId)),\r\n  hideDashboard: () => dispatch(hideOtherConfigDashboard()),\r\n  fetchViews: () => dispatch(fetchOtherConfigDashboardViews()),\r\n  clearViews: () => dispatch(clearOtherConfigDashboardViews()),\r\n  onClose: () => dispatch(closeOtherConfigDashboard()),\r\n  fetchDataset: (nodeId, datasetId, criteria, requestIds) => dispatch(fetchOtherConfigDashboardsDataset(nodeId, datasetId, criteria, requestIds)),\r\n  fetchMapGeometries: (idList, requestId) => dispatch(fetchOtherConfigDashboardsMapGeometries(idList, requestId)),\r\n  clearDatasets: () => dispatch(clearOtherConfigDashboardsDataset()),\r\n});\r\n\r\nconst getStaticDashboard = dashboard => {\r\n  if (!dashboard) {\r\n    return null\r\n  }\r\n\r\n  const staticDashboard = _.cloneDeep(dashboard);\r\n  staticDashboard.dashboardConfig.forEach(row => {\r\n    row.forEach(col => {\r\n      col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] = null\r\n    });\r\n  });\r\n\r\n  return staticDashboard\r\n};\r\n\r\nconst initialDashboard = {\r\n  title: {},\r\n  dashboardConfig: [],\r\n  viewIds: [],\r\n  views: {},\r\n  filterLevels: {}\r\n};\r\n\r\nconst UserDashboardsSettingsForm = ({\r\n                                      classes,\r\n                                      defaultLanguage,\r\n                                      languages,\r\n                                      nodes,\r\n                                      needDashboards,\r\n                                      dashboards,\r\n                                      dashboard,\r\n                                      fetchDashboards,\r\n                                      clearDashboards,\r\n                                      createDashboard,\r\n                                      updateDashboard,\r\n                                      changeDashboard,\r\n                                      submitDashboardCreate,\r\n                                      submitDashboardUpdate,\r\n                                      deleteDashboard,\r\n                                      hideDashboard,\r\n                                      dashboardViews,\r\n                                      fetchViews,\r\n                                      clearViews,\r\n                                      onClose,\r\n                                      dashboardJsonStats,\r\n                                      dashboardMaps,\r\n                                      fetchDataset,\r\n                                      fetchMapGeometries,\r\n                                      clearDatasets\r\n                                    }, ref) => {\r\n\r\n  const [deleteDashboardId, setDeleteDashboardId] = useState(null);\r\n  const [updateDashboardId, setUpdateDashboardId] = useState(null);\r\n\r\n  const [isPreviewVisible, setPreviewVisibility] = useState(false);\r\n\r\n  const {t} = useTranslation();\r\n\r\n  useEffect(() => {\r\n    fetchDashboards();\r\n  }, [fetchDashboards]);\r\n\r\n  useEffect(() => {\r\n    if (needDashboards) {\r\n      fetchDashboards();\r\n    }\r\n  }, [dashboards, needDashboards, fetchDashboards]);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    cancel(f) {\r\n      clearDashboards();\r\n      onClose();\r\n      f();\r\n    }\r\n  }));\r\n\r\n  const handleFetchDatasets = () => {\r\n\r\n    const requests = [];\r\n    dashboard.dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n\r\n          const view = dashboard.views[col[DASHBOARD_ELEM_VALUE_KEY]];\r\n\r\n          let newCriteria = view.criteria;\r\n\r\n          const request = requests.find(({nodeId, datasetId, criteria}) => {\r\n            return (\r\n              nodeId === view.nodeId &&\r\n              datasetId === view.datasetId &&\r\n              _.isEqual(criteria, newCriteria)\r\n            )\r\n          });\r\n\r\n          if (request === undefined) {\r\n            requests.push({\r\n              nodeId: view.nodeId,\r\n              datasetId: view.datasetId.split(\"+\").join(\",\"),\r\n              criteria: newCriteria,\r\n              requestIds: [getViewIdxFromRowAndCol(rowIdx, colIdx)]\r\n            });\r\n          } else {\r\n            request.requestIds.push(getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n          }\r\n        }\r\n      });\r\n    });\r\n    requests.forEach(({nodeId, datasetId, criteria, requestIds}) => fetchDataset(nodeId, datasetId, criteria, requestIds));\r\n  };\r\n\r\n  return dashboards && (\r\n    <Fragment>\r\n      <CustomMaterialTable\r\n        components={{\r\n          Container: Box,\r\n          Toolbar: props =>\r\n            <Grid container justify=\"space-between\" spacing={1} alignItems=\"center\">\r\n              <Grid item>\r\n                <MTableToolbar {...props} />\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  size=\"small\"\r\n                  startIcon={<AddIcon/>}\r\n                  onClick={() => createDashboard(initialDashboard)}\r\n                >\r\n                  {t(\"scenes.dashboardsSettings.createDashboard\")}\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n        }}\r\n        columns={[\r\n          {\r\n            field: \"title\",\r\n            title: t(\"scenes.dashboardsSettings.table.columns.dashboardTitle\"),\r\n            render: ({title}) => localizeI18nObj(title, defaultLanguage, languages),\r\n            customFilterAndSearch: getI18nObjCustomFilterAndSearch(defaultLanguage, languages)\r\n          }\r\n        ]}\r\n        data={dashboards}\r\n        actions={[\r\n          {\r\n            icon: VisibilityIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.viewDashboard\"),\r\n            onClick: (_, {dashboardId}) => goToDashboard(dashboardId)\r\n          },\r\n          {\r\n            icon: EditIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.editDashboard\"),\r\n            onClick: (_, {dashboardId}) => {\r\n              updateDashboard(dashboardId);\r\n              setUpdateDashboardId(dashboardId);\r\n            }\r\n          },\r\n          {\r\n            icon: DeleteIcon,\r\n            tooltip: t(\"scenes.dashboardsSettings.table.actions.deleteDashboard\"),\r\n            onClick: (_, {dashboardId}) => setDeleteDashboardId(dashboardId)\r\n          }\r\n        ]}\r\n        options={{\r\n          paging: false,\r\n          draggable: true,\r\n          actionsColumnIndex: 1,\r\n          maxBodyHeight: 400,\r\n          showTitle: false,\r\n          searchFieldAlignment: \"left\"\r\n        }}\r\n        icons={tableIcons}\r\n      />\r\n\r\n      <Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        maxWidth=\"xs\"\r\n        open={deleteDashboardId !== null}\r\n      >\r\n        <DialogTitle>{t(\"scenes.dashboardsSettings.modals.deleteDashboard.title\")}</DialogTitle>\r\n        <DialogContent>\r\n          {t(\"scenes.dashboardsSettings.modals.deleteDashboard.content\")}\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            autoFocus\r\n            onClick={() => setDeleteDashboardId(null)}\r\n          >\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n          <Button\r\n            onClick={() => {\r\n              deleteDashboard(deleteDashboardId);\r\n              setDeleteDashboardId(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.confirm\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={dashboard !== null}\r\n        fullScreen\r\n        onClose={hideDashboard}\r\n      >\r\n        <DialogTitle>\r\n          {updateDashboardId\r\n            ? t(\"scenes.dashboardsSettings.modals.updateDashboard.title\")\r\n            : t(\"scenes.dashboardsSettings.modals.createDashboard.title\")\r\n          }\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <DashboardBuilder\r\n            nodes={nodes}\r\n            dashboard={dashboard}\r\n            onChange={changeDashboard}\r\n            views={dashboardViews}\r\n            fetchViews={fetchViews}\r\n            onViewsHide={clearViews}\r\n            jsonStats={dashboardJsonStats}\r\n            fetchDataset={fetchDataset}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              hideDashboard();\r\n              setUpdateDashboardId(null);\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n          <Button\r\n            onClick={() => setPreviewVisibility(true)}\r\n          >\r\n            {t(\"commons.confirm.preview\")}\r\n          </Button>\r\n          <Button\r\n            onClick={updateDashboardId\r\n              ? () => submitDashboardUpdate(updateDashboardId, dashboard)\r\n              : () => {\r\n                submitDashboardCreate(dashboard);\r\n                hideDashboard();\r\n              }\r\n            }\r\n            disabled={dashboard && !validateI18nObj(dashboard.title)}\r\n          >\r\n            {t(\"commons.confirm.save\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      <Dialog\r\n        open={isPreviewVisible}\r\n        fullScreen\r\n        onClose={() => setPreviewVisibility(false)}\r\n      >\r\n        <DialogTitle>\r\n          {t(\"components.dashboardBuilder.modals.preview.title\")}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Call cb={handleFetchDatasets}>\r\n            <Dashboard\r\n              dashboard={getStaticDashboard(dashboard)}\r\n              jsonStats={dashboardJsonStats}\r\n              maps={dashboardMaps}\r\n              fetchMapGeometries={(idList, requestId) => fetchMapGeometries(idList, requestId)}\r\n            />\r\n          </Call>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button\r\n            onClick={() => {\r\n              setPreviewVisibility(false);\r\n              clearDatasets();\r\n            }}\r\n          >\r\n            {t(\"commons.confirm.close\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default compose(withStyles(styles), connect(mapStateToProps, mapDispatchToProps, null, {forwardRef: true}), forwardRef)(UserDashboardsSettingsForm);","import React, {Fragment} from 'react';\r\nimport ButtonSelect from \"../button-select\";\r\nimport SettingsDialog from \"../settings-dialog\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport ViewsSettingsForm from \"./views-settings-form\";\r\nimport WorkIcon from '@material-ui/icons/Work';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {canDisplayUserViews, canManagePersonalDashboards} from \"../../utils/user\";\r\nimport UserDashboardsSettingsForm from \"./user-dashboards-settings-form\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  option: {\r\n    width: \"100%\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nclass OtherSettingsSelect extends React.Component {\r\n\r\n  state = {\r\n    isViewsOpen: false,\r\n    isDashboardsOpen: false,\r\n    viewsSettigsRef: React.createRef(),\r\n    dashboardsSettingsRef: React.createRef()\r\n  };\r\n\r\n  onViewsOpen = () => this.setState({\r\n    ...this.state,\r\n    isViewsOpen: true\r\n  });\r\n\r\n  onViewsClose = () => this.setState({\r\n    ...this.state,\r\n    isViewsOpen: false\r\n  });\r\n\r\n  onDashboardsOpen = () => this.setState({\r\n    ...this.state,\r\n    isDashboardsOpen: true\r\n  });\r\n\r\n  onDashboardsClose = () => this.setState({\r\n    ...this.state,\r\n    isDashboardsOpen: false\r\n  });\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      nodes,\r\n      user,\r\n      t\r\n    } = this.props;\r\n\r\n    const {\r\n      isViewsOpen,\r\n      isDashboardsOpen,\r\n      viewsSettigsRef,\r\n      dashboardsSettingsRef\r\n    } = this.state;\r\n\r\n    return (\r\n      <Fragment>\r\n        <ButtonSelect value=\"\" icon={<WorkIcon/>}>\r\n          {canDisplayUserViews(user) && (\r\n            <div onClick={this.onViewsOpen} className={classes.option}>{t(\"components.header.otherSettings.views\")}</div>\r\n          )}\r\n          {canManagePersonalDashboards(user) && (\r\n            <div onClick={this.onDashboardsOpen} className={classes.option}>{t(\"components.header.otherSettings.dashboards\")}</div>\r\n          )}\r\n        </ButtonSelect>\r\n        <SettingsDialog\r\n          title={t(\"scenes.viewsSettings.title\")}\r\n          open={isViewsOpen}\r\n          onClose={() => {\r\n            if (viewsSettigsRef.current) {\r\n              viewsSettigsRef.current.cancel(() => this.onViewsClose());\r\n            } else {\r\n              this.onViewsClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <ViewsSettingsForm ref={viewsSettigsRef} nodes={nodes}/>\r\n        </SettingsDialog>\r\n        <SettingsDialog\r\n          title={t(\"scenes.dashboardsSettings.title\")}\r\n          open={isDashboardsOpen}\r\n          onClose={() => {\r\n            if (dashboardsSettingsRef.current) {\r\n              dashboardsSettingsRef.current.cancel(() => this.onDashboardsClose());\r\n            } else {\r\n              this.onDashboardsClose();\r\n            }\r\n          }}\r\n          maxWidth=\"md\"\r\n        >\r\n          <UserDashboardsSettingsForm ref={dashboardsSettingsRef} nodes={nodes}/>\r\n        </SettingsDialog>\r\n      </Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  connect(mapStateToProps),\r\n  withTranslation()\r\n)(OtherSettingsSelect);","import {Link, withStyles} from \"@material-ui/core\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Toolbar from \"@material-ui/core/Toolbar\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport MenuIcon from \"@material-ui/icons/Menu\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport React, {Component} from \"react\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport UserSelect from \"../user-select\";\r\nimport Drawer from \"@material-ui/core/Drawer\";\r\nimport ChevronLeftIcon from \"@material-ui/icons/ChevronLeft\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport CategoriesTree from \"../categories-tree\";\r\nimport {withRouter} from \"react-router\";\r\nimport SettingsSelect from \"../settings-select\";\r\nimport SearchDialog from \"../search-dialog\";\r\nimport ButtonSelect from \"../button-select\";\r\nimport {goToDatasetsSearch, goToHome, goToNode, goToNodeDashboards} from \"../../links\";\r\nimport I18nInputAdornmentSelect from \"../i18n-input-adornment-select\";\r\nimport HomeIcon from '@material-ui/icons/Home';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport OtherSettingsSelect from \"../other-settings-select\";\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport {\r\n  canClearServerCache,\r\n  canDisplayAppSettingsForm,\r\n  canDisplayNodesSettingsForm,\r\n  canDisplayUsersSettingsForm,\r\n  canDisplayUserViews,\r\n  canGetQueryLog,\r\n  canManagePersonalDashboards\r\n} from \"../../utils/user\";\r\nimport {setAppLanguage} from \"../../state/app/appActions\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    position: \"fixed\",\r\n    width: \"100%\",\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n    display: 'none',\r\n    [theme.breakpoints.up('sm')]: {\r\n      display: 'block',\r\n    },\r\n    color: \"white\"\r\n  },\r\n  leftToolbar: {\r\n    zIndex: theme.zIndex.appBar\r\n  },\r\n  leftContainer: {\r\n    width: \"calc((100% - 296px)/2)\"\r\n  },\r\n  rightContainer: {\r\n    width: \"calc((100% - 296px)/2)\"\r\n  },\r\n  drawer: {\r\n    minWidth: 448\r\n  },\r\n  drawerHeader: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    padding: theme.spacing(0, 1),\r\n    ...theme.mixins.toolbar,\r\n    justifyContent: 'flex-end',\r\n  },\r\n  drawerHeaderTitle: {\r\n    position: \"absolute\",\r\n    left: theme.spacing(2),\r\n  },\r\n  drawerCategories: {\r\n    margin: theme.spacing(2)\r\n  },\r\n  drawerCategoriesTitle: {\r\n    marginBottom: theme.spacing(2)\r\n  },\r\n  goToHome: {\r\n    margin: theme.spacing(2, 2, 0, 2)\r\n  },\r\n  centerContainer: {\r\n    width: 280,\r\n    textAlign: \"center\"\r\n  },\r\n  sistanLogo: {\r\n    width: 32,\r\n    height: 32,\r\n    transform: \"translateY(3px)\"\r\n  }\r\n});\r\n\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL,\r\n  user: state.user,\r\n  language: state.app.language\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onLanguageChange: (language, nodeId) => dispatch(setAppLanguage(language, nodeId))\r\n});\r\n\r\nclass NodeHeader extends Component {\r\n\r\n  state = {\r\n    isDrawerOpen: this.props.defaultTreeOpen || false\r\n  };\r\n\r\n  onDrawerOpen = () => {\r\n    this.setState({\r\n      isDrawerOpen: true\r\n    });\r\n  };\r\n\r\n  onDrawerClose = () => {\r\n    this.setState({\r\n      isDrawerOpen: false\r\n    });\r\n  };\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      selectedCategoryPath,\r\n      shortName,\r\n      title,\r\n      defaultAppConfigOpen,\r\n      defaultUsersConfigOpen,\r\n      defaultNodesConfigOpen,\r\n      defaultNodeConfigOpen,\r\n      nodes,\r\n      noNode,\r\n      catalog,\r\n      node,\r\n      query,\r\n      hub,\r\n      baseURL,\r\n      user,\r\n      onLanguageChange,\r\n      language,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isDrawerOpen} = this.state;\r\n\r\n    return (\r\n      <div className={classes.root} id=\"node-header\">\r\n        <AppBar position=\"static\" color=\"primary\">\r\n          <Grid container justify=\"space-between\" alignItems=\"center\">\r\n            <Grid item className={classes.leftContainer}>\r\n              {!noNode && (\r\n                <Toolbar className={classes.leftToolbar}>\r\n                  <Grid container spacing={1} alignItems=\"center\">\r\n                    <Grid item>\r\n                      <IconButton\r\n                        className={classes.menuButton}\r\n                        edge=\"start\"\r\n                        color=\"inherit\"\r\n                        onClick={this.onDrawerOpen}\r\n                      >\r\n                        <MenuIcon/>\r\n                      </IconButton>\r\n                    </Grid>\r\n                    <Grid item>\r\n                      <ButtonSelect\r\n                        value={\r\n                          <Typography variant=\"h6\" color=\"inherit\">\r\n                            {shortName}\r\n                          </Typography>\r\n                        }\r\n                      >\r\n                        {nodes.sort((a, b) => a.order - b.order).map(({code, name}, i) =>\r\n                          <span key={i} onClick={() =>\r\n                            goToNode(code.toLowerCase())\r\n                          }>\r\n                            {code} - {name}\r\n                          </span>\r\n                        )}\r\n                      </ButtonSelect>\r\n                    </Grid>\r\n                  </Grid>\r\n                </Toolbar>\r\n              )}\r\n            </Grid>\r\n            <Grid item className={classes.centerContainer}>\r\n              <Link onClick={goToHome} style={{cursor: \"pointer\"}}>\r\n                <Grid container spacing={2} alignItems=\"center\" justify=\"center\">\r\n                  {hub.logoURL && (\r\n                    <Grid item>\r\n                      <img src={baseURL + hub.logoURL} alt={hub.name} className={classes.sistanLogo}/>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid item>\r\n                    <Typography variant=\"h6\" color=\"secondary\">\r\n                      {hub.name}\r\n                    </Typography>\r\n                  </Grid>\r\n                </Grid>\r\n              </Link>\r\n            </Grid>\r\n            <Grid item className={classes.rightContainer}>\r\n              <Toolbar>\r\n                <Grid container justify=\"flex-end\" alignItems=\"center\" spacing={1}>\r\n                  {!noNode && (\r\n                    <div>\r\n                      <SearchDialog\r\n                        query={query}\r\n                        modalWidth={320}\r\n                        dialogTop={56}\r\n                        onSubmit={value => goToDatasetsSearch(node.code, value)}\r\n                      />\r\n                    </div>\r\n                  )}\r\n                  <Grid item id=\"language-btn\">\r\n                    <I18nInputAdornmentSelect\r\n                      onChange={val => onLanguageChange(val, node ? node.nodeId : null)}\r\n                      value={language}\r\n                    />\r\n                  </Grid>\r\n                  {!noNode && node && node.dashboards && node.dashboards.length > 0 && (\r\n                    <Grid item id=\"dashboards-btn\">\r\n                      <IconButton onClick={() => goToNodeDashboards(node.code)} color=\"inherit\">\r\n                        <DashboardIcon/>\r\n                      </IconButton>\r\n                    </Grid>\r\n                  )}\r\n                  {(canDisplayAppSettingsForm(user) ||\r\n                    canDisplayUsersSettingsForm(user) ||\r\n                    canDisplayNodesSettingsForm(user) ||\r\n                    canGetQueryLog(user) ||\r\n                    canClearServerCache(user)\r\n                  ) && (\r\n                    <Grid item id=\"admin-settings-btn\">\r\n                      <SettingsSelect\r\n                        defaultAppOpen={defaultAppConfigOpen}\r\n                        defaultNodesOpen={defaultNodesConfigOpen}\r\n                        defaultUsersOpen={defaultUsersConfigOpen}\r\n                        defaultNodeOpen={defaultNodeConfigOpen}\r\n                        nodes={nodes}\r\n                      />\r\n                    </Grid>\r\n                  )}\r\n                  {(canDisplayUserViews(user) || canManagePersonalDashboards(user)) && (\r\n                    <Grid item id=\"other-settings-btn\">\r\n                      <OtherSettingsSelect nodes={nodes}/>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid item id=\"user-settings-btn\">\r\n                    <UserSelect/>\r\n                  </Grid>\r\n                </Grid>\r\n              </Toolbar>\r\n            </Grid>\r\n          </Grid>\r\n        </AppBar>\r\n        {!noNode && (\r\n          <Drawer\r\n            anchor=\"left\"\r\n            open={isDrawerOpen}\r\n            classes={{\r\n              paper: classes.drawer\r\n            }}\r\n            onClose={this.onDrawerClose}\r\n          >\r\n            <div className={classes.drawerHeader}>\r\n              <Typography variant=\"h6\" className={classes.drawerHeaderTitle}>\r\n                {title}\r\n              </Typography>\r\n              <IconButton onClick={this.onDrawerClose}>\r\n                <ChevronLeftIcon/>\r\n              </IconButton>\r\n            </div>\r\n            <Divider/>\r\n            <div className={classes.goToHome}>\r\n              <Link underline=\"none\" onClick={() => {\r\n                goToNode(node.code);\r\n                window.location.reload();\r\n              }} style={{cursor: \"pointer\"}}>\r\n                <Grid container spacing={1}>\r\n                  <Grid item>\r\n                    <HomeIcon/>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    <Typography>\r\n                      {t(\"components.header.drawer.backToNodeHome\")}\r\n                    </Typography>\r\n                  </Grid>\r\n                </Grid>\r\n              </Link>\r\n            </div>\r\n            {catalog && (\r\n              <div className={classes.drawerCategories}>\r\n                <div className={classes.drawerCategoriesTitle}>\r\n                  <Typography>\r\n                    {t(\"components.header.drawer.categoriesTitle\")}\r\n                  </Typography>\r\n                </div>\r\n                <CategoriesTree selectedCategoryPath={selectedCategoryPath} catalog={catalog} node={node}\r\n                                onClose={this.onDrawerClose}/>\r\n              </div>\r\n            )}\r\n          </Drawer>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withRouter\r\n)(NodeHeader);","export const APP_LANGUAGE_SET = \"app/languageSet\";\r\n\r\nexport const setAppLanguage = (language: string, nodeId: number) => ({\r\n  type: APP_LANGUAGE_SET,\r\n  payload: {\r\n    language,\r\n    nodeId\r\n  }\r\n});\r\n","import React, {Component} from 'react';\r\nimport Box from \"@material-ui/core/Box\";\r\nimport Hero from \"../hero\";\r\nimport CardsGrid from \"../cards-grid\";\r\nimport PageSection from \"../page-section\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Page from \"../page\";\r\nimport NodeHeader from \"../node-header\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport {goToHubDashboards, goToNode} from \"../../links\";\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  appBar: {\r\n    transition: \"opacity 1s\",\r\n  },\r\n  toolbarButtons: {\r\n    marginLeft: \"auto\",\r\n    '& > *': {\r\n      marginRight: theme.spacing(1)\r\n    }\r\n  },\r\n  anchorContainer: {\r\n    position: \"relative\"\r\n  },\r\n  anchor: {\r\n    position: \"absolute\",\r\n    top: -theme.mixins.toolbar.minHeight\r\n  },\r\n  fullWidthContainer: {\r\n    backgroundColor: \"white\",\r\n    width: \"100%\"\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(3),\r\n    width: 1024,\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  footer: {\r\n    paddingTop: theme.spacing(4)\r\n  },\r\n  footerContent: {\r\n    paddingTop: theme.spacing(2)\r\n  },\r\n  footerImage: {\r\n    height: 20,\r\n    margin: theme.spacing(1)\r\n  },\r\n  nodesContainer: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  centerContainer: {\r\n    width: 316,\r\n    textAlign: \"center\"\r\n  },\r\n  sistanLogo: {\r\n    width: 32,\r\n    height: 32,\r\n    transform: \"translateY(3px)\"\r\n  },\r\n  leftContainer: {\r\n    width: \"calc((100% - 316px)/2)\"\r\n  },\r\n  rightContainer: {\r\n    width: \"calc((100% - 316px)/2)\"\r\n  },\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL\r\n});\r\n\r\nclass Home extends Component {\r\n\r\n  info = React.createRef();\r\n  nodesRef = React.createRef();\r\n  dashboard = React.createRef();\r\n  // explore = React.createRef();\r\n\r\n  state = {\r\n    isListMode: true,\r\n  };\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true,\r\n    });\r\n  }\r\n\r\n  /*  onListModeToggle = () => {\r\n      this.setState({isListMode: !this.state.isListMode});\r\n    };*/\r\n\r\n  render() {\r\n\r\n    const {classes, hub, baseURL, t} = this.props;\r\n    // const {isListMode} = this.state;\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          noNode\r\n          defaultNodeConfigOpen={this.props.defaultNodeConfigOpen}\r\n          defaultAppConfigOpen={this.props.defaultAppConfigOpen}\r\n          defaultUserConfigOpen={this.props.defaultUserConfigOpen}\r\n          defaultNodesConfigOpen={this.props.defaultNodesConfigOpen}\r\n          hub={hub.hub}\r\n          nodes={hub.nodes}\r\n        />\r\n        <Hero\r\n          title={hub.hub.name}\r\n          slogan={hub.hub.slogan}\r\n          logo={hub.hub.logoURL && <img src={baseURL + hub.hub.logoURL} alt={hub.hub.name}/>}\r\n          background={\r\n            hub.hub.backgroundMediaURL\r\n              ? (hub.hub.backgroundMediaURL.match(/\\.(jpeg|jpg|gif|png|JPEG|JPG|GIF|PNG)$/)\r\n                ? <img src={baseURL + hub.hub.backgroundMediaURL} alt={hub.hub.name}/>\r\n                : (\r\n                  <video autoPlay muted loop>\r\n                    <source src={baseURL + hub.hub.backgroundMediaURL}/>\r\n                  </video>\r\n                )\r\n              ) : <video autoPlay muted loop>\r\n                <source src=\"./videos/landing-background.mp4\"/>\r\n              </video>\r\n          }\r\n        >\r\n          {hub.hub.description && hub.hub.description.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.info)}>\r\n              {t(\"scenes.hub.informations\")}\r\n            </Button>\r\n          )}\r\n          <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                  onClick={() => this.scroll(this.nodesRef)}>\r\n            {t(\"scenes.hub.nodes\")}\r\n          </Button>\r\n          {hub.hub.dashboards && hub.hub.dashboards.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\" onClick={goToHubDashboards}>\r\n              {t(\"scenes.hub.dashboards\")}\r\n            </Button>\r\n          )}\r\n        </Hero>\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            {hub.hub.description && hub.hub.description.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.info}/>\r\n                <PageSection className={classes.section} sectiontitle={t(\"scenes.hub.informations\")}>\r\n                  <Box textAlign=\"justify\">\r\n                    <Box dangerouslySetInnerHTML={{__html: hub.hub.description}}/>\r\n                  </Box>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n            <div className={classes.anchorContainer}>\r\n              <div className={classes.anchor} ref={this.nodesRef}/>\r\n              <PageSection className={classes.section} sectiontitle={t(\"scenes.hub.nodes\")}>\r\n                <Box className={classes.nodesContainer}>\r\n                  <CardsGrid\r\n                    list={hub.nodes.sort((a, b) => a.order - b.order).map(({code, name, backgroundMediaURL}) => ({\r\n                      code,\r\n                      id: code,\r\n                      label: name,\r\n                      image: backgroundMediaURL ? baseURL + backgroundMediaURL : \"./images/istat/istat-background.jpg\"\r\n                    }))}\r\n                    onClick={node => goToNode(node.code.toLowerCase())}\r\n                  />\r\n                </Box>\r\n              </PageSection>\r\n            </div>\r\n            <div className={classes.footer}>\r\n              <Divider/>\r\n              <div className={classes.footerContent}>\r\n                <Grid container type=\"flex\" justify=\"center\" alignItems=\"center\">\r\n                  <Grid item>\r\n                    <img src=\"images/istat/istat-logo-gray.png\" className={classes.footerImage} alt=\"istat logo\"/>\r\n                  </Grid>\r\n                  <Grid item>\r\n                    Data Browser v0.5\r\n                  </Grid>\r\n                </Grid>\r\n              </div>\r\n            </div>\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps)\r\n)(Home);","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getHubMinimalInfoUrl} from \"../../serverApi/urls\";\r\n\r\nexport const HUB_FETCH = \"hub/fetch\";\r\n\r\nexport const fetchHub = () => initRequest(\r\n  HUB_FETCH,\r\n  getHubMinimalInfoUrl(),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"domains.hub.messages.fetch.start\")\r\n  })\r\n);","import React, {Fragment} from 'react';\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport List from \"@material-ui/core/List\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport {withStyles} from '@material-ui/core/styles';\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport {Link} from \"@material-ui/core\";\r\n\r\nconst styles = theme => ({\r\n  list: {\r\n    paddingLeft: theme.spacing(1),\r\n    paddingRight: theme.spacing(1)\r\n  },\r\n  cardContainer: {\r\n    position: \"relative\"\r\n  },\r\n  card: {\r\n    height: \"100%\",\r\n    backgroundColor: theme.palette.background.default\r\n  },\r\n  item: {\r\n    padding: 0\r\n  },\r\n  link: {\r\n    cursor: \"pointer\"\r\n  }\r\n});\r\n\r\nconst CategoriesLists = ({classes, categories, onClick}) => {\r\n\r\n  const rows = [];\r\n\r\n  const chunkSize = 3;\r\n\r\n  for (let i = 0; i < categories.length; i += chunkSize) {\r\n\r\n    const categoriesChunk = categories.slice(i, i + chunkSize);\r\n\r\n    /* first level */\r\n    rows.push(\r\n      <Grid key={i} container spacing={2}>\r\n        {categoriesChunk.map((rootCategory, i) =>\r\n          <Grid item key={i} xs={4}>\r\n            <Typography variant=\"h5\" className={classes.title} style={{fontSize: 20}}>\r\n              {rootCategory.datasetIdentifiers?.length > 0\r\n                ? (\r\n                  <Link onClick={() => onClick([rootCategory.id])} className={classes.link}>\r\n                    {rootCategory.label} ({rootCategory.datasetIdentifiers.length})\r\n                  </Link>\r\n                ) : rootCategory.label\r\n              }\r\n            </Typography>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n\r\n    const fontSizes = [18, 16, 15, 14];\r\n\r\n    /* recursively renders subtree of categories */\r\n    const Subtree = ({root, depth, fontSizes, parentPath = []}) =>\r\n      root.childrenCategories && (\r\n        <div className={classes.card}>\r\n          <List className={classes.list}>\r\n            {root.childrenCategories.map((child, i) =>\r\n              <Fragment key={i}>\r\n                <ListItem className={classes.item}>\r\n                  <ListItemText\r\n                    primary={\r\n                      <Typography style={{fontSize: fontSizes[0]}}>\r\n                        {child.datasetIdentifiers?.length > 0\r\n                          ? (\r\n                            <Link onClick={() => onClick([...parentPath, root.id, child.id])} className={classes.link}>\r\n                              {child.label} ({child.datasetIdentifiers.length})\r\n                            </Link>\r\n                          ) : child.label}\r\n                      </Typography>\r\n                    }\r\n                  />\r\n                </ListItem>\r\n                {/* recursion on subtree of child category */}\r\n                {depth > 1 && (\r\n                  <Subtree\r\n                    root={child}\r\n                    depth={depth - 1}\r\n                    fontSizes={fontSizes.slice(1)}\r\n                    parentPath={[...parentPath, root.id]}\r\n                  />\r\n                )}\r\n              </Fragment>\r\n            )}\r\n          </List>\r\n        </div>\r\n      );\r\n\r\n    /* 4 levels subtree */\r\n    rows.push(\r\n      <Grid key={i + 1} container spacing={2}>\r\n        {categoriesChunk.map((rootCategory, i) =>\r\n          <Grid item key={i} xs={4} className={classes.cardContainer}>\r\n            <Subtree root={rootCategory} depth={4} fontSizes={fontSizes}/>\r\n          </Grid>\r\n        )}\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  return rows;\r\n};\r\n\r\nexport default withStyles(styles)(CategoriesLists);\r\n","import React, {Component} from 'react';\r\nimport Hero from \"../hero\";\r\nimport CardsGrid from \"../cards-grid\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport PageSection from \"../page-section\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport NodeHeader from \"../node-header\";\r\nimport Page from \"../page\";\r\nimport {goToDatasets, goToNodeDashboards} from \"../../links\";\r\nimport \"./style.css\";\r\nimport CategoriesLists from \"../../components/categories-lists\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {connect} from \"react-redux\";\r\nimport {compose} from \"redux\";\r\nimport {withTranslation} from \"react-i18next\";\r\n\r\nconst styles = theme => ({\r\n  anchor: {\r\n    position: \"absolute\",\r\n    top: -theme.mixins.toolbar.minHeight\r\n  },\r\n  anchorContainer: {\r\n    position: \"relative\"\r\n  },\r\n  fullWidthContainer: {\r\n    backgroundColor: \"white\",\r\n    width: \"100%\",\r\n    minHeight: \"100%\"\r\n  },\r\n  container: {\r\n    paddingTop: theme.spacing(3),\r\n    width: 1024,\r\n  },\r\n  categoriesContainer: {\r\n    paddingTop: theme.spacing(2)\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  categorySchemesTabs: {\r\n    marginBottom: theme.spacing(2)\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  baseURL: state.config.baseURL\r\n});\r\n\r\nclass Node extends Component {\r\n\r\n  state = {\r\n    configIsListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5,\r\n    isListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5,\r\n    categorySchemeTab: 0\r\n  };\r\n\r\n  info = React.createRef();\r\n  nodes = React.createRef();\r\n  dashboard = React.createRef();\r\n\r\n  scroll(ref) {\r\n    ref.current.scrollIntoView({\r\n      behavior: 'smooth',\r\n      alignToTop: true\r\n    });\r\n  }\r\n\r\n  onListModeToggle = () => {\r\n    this.setState({isListMode: !this.state.isListMode});\r\n  };\r\n\r\n  setCategorySchemeTab = tab => {\r\n    this.setState({categorySchemeTab: tab});\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n\r\n    const configIsListMode = props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === props.nodeCode.toLowerCase())\r\n      .showCategoryLevels === 5;\r\n\r\n    if (configIsListMode !== state.configIsListMode) {\r\n      return {\r\n        ...state,\r\n        configIsListMode,\r\n        isListMode: configIsListMode\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      light,\r\n      defaultTreeOpen,\r\n      defaultNodeConfigOpen,\r\n      defaultAppConfigOpen,\r\n      defaultUserConfigOpen,\r\n      defaultNodesConfigOpen,\r\n      node,\r\n      nodeCode,\r\n      hub,\r\n      catalog,\r\n      baseURL,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isListMode, categorySchemeTab} = this.state;\r\n\r\n    const nodeMinimalInfo = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n\r\n    const uncategorizedCategory = {\r\n      id: \"uncategorized\",\r\n      label: t(\"commons.catalog.uncategorized\"),\r\n      childrenCategories: [],\r\n      datasetIdentifiers: catalog?.uncategorizedDatasets.map(({identifier}) => identifier)\r\n    };\r\n\r\n    const categoriesForExplore =\r\n      catalog\r\n        ? (\r\n          catalog.categoryGroups.length > 1\r\n            ? (\r\n              categorySchemeTab === \"uncategorized\"\r\n                ? [uncategorizedCategory]\r\n                : catalog.categoryGroups[categorySchemeTab].categories.map(c => ({\r\n                  ...c,\r\n                  image: c.image ? baseURL + c.image : undefined\r\n                }))\r\n            )\r\n            : (\r\n              catalog.uncategorizedDatasets.length > 0\r\n                ? catalog.categoryGroups[0]?.categories.map(c => ({\r\n                ...c,\r\n                image: c.image ? baseURL + c.image : undefined\r\n              })).concat([uncategorizedCategory]) || [uncategorizedCategory]\r\n                : catalog.categoryGroups[0]?.categories.map(c => ({\r\n                ...c,\r\n                image: c.image ? baseURL + c.image : undefined\r\n              })) || []\r\n            ))\r\n        : [];\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          hub={hub.hub}\r\n          nodes={hub.nodes}\r\n          catalog={catalog}\r\n          defaultTreeOpen={defaultTreeOpen}\r\n          shortName={nodeCode}\r\n          title={nodeMinimalInfo.name}\r\n          node={node}\r\n          defaultNodeConfigOpen={defaultNodeConfigOpen}\r\n          defaultAppConfigOpen={defaultAppConfigOpen}\r\n          defaultUserConfigOpen={defaultUserConfigOpen}\r\n          defaultNodesConfigOpen={defaultNodesConfigOpen}\r\n          nodeId={nodeMinimalInfo.nodeId}\r\n        />\r\n        <Hero\r\n          light={light}\r\n          title={nodeMinimalInfo.name}\r\n          slogan={node && node.slogan}\r\n          logo={node && nodeMinimalInfo.logoURL &&\r\n          <img src={baseURL + nodeMinimalInfo.logoURL} alt={nodeMinimalInfo.name}/>}\r\n          background={\r\n            nodeMinimalInfo.backgroundMediaURL\r\n              ? (\r\n                nodeMinimalInfo.backgroundMediaURL.match(/\\.(jpeg|jpg|gif|png|JPEG|JPG|GIF|PNG)$/)\r\n                  ? <img src={baseURL + nodeMinimalInfo.backgroundMediaURL} alt={nodeMinimalInfo.name}/>\r\n                  : (\r\n                    <video autoPlay muted loop>\r\n                      <source src={baseURL + nodeMinimalInfo.backgroundMediaURL}/>\r\n                    </video>\r\n                  )\r\n              )\r\n              : <img src=\"./images/istat/istat-background.jpg\" alt={nodeMinimalInfo.name}/>\r\n          }\r\n        >\r\n          {node && node.description && node.description.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => this.scroll(this.info)}>\r\n              {t(\"scenes.node.informations\")}\r\n            </Button>\r\n          )}\r\n          <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                  onClick={() => this.scroll(this.nodes)}>\r\n            {t(\"scenes.node.explore\")}\r\n          </Button>\r\n          {nodeMinimalInfo.dashboards && nodeMinimalInfo.dashboards.length > 0 && (\r\n            <Button size=\"large\" color=\"secondary\" variant=\"contained\"\r\n                    onClick={() => goToNodeDashboards(nodeCode)}>\r\n              {t(\"scenes.node.dashboards\")}\r\n            </Button>\r\n          )}\r\n        </Hero>\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            {node && node.description && node.description.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.info}/>\r\n                <PageSection className={classes.section} sectiontitle={t(\"scenes.node.informations\")}>\r\n                  <Box textAlign=\"justify\">\r\n                    <Box dangerouslySetInnerHTML={{__html: node.description}}/>\r\n                  </Box>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n            {catalog && categoriesForExplore.length > 0 && (\r\n              <div className={classes.anchorContainer}>\r\n                <div className={classes.anchor} ref={this.nodes}/>\r\n                <PageSection className={classes.section} sectiontitle={t(\"scenes.node.explore\")}>\r\n                  <div className={classes.categoriesContainer}>\r\n                    {catalog.categoryGroups.length > 1 && (\r\n                      <Tabs\r\n                        value={categorySchemeTab}\r\n                        onChange={(_, tab) => this.setCategorySchemeTab(tab)}\r\n                        className={classes.categorySchemesTabs}\r\n                      >\r\n                        {catalog.categoryGroups.map(({label}, index) =>\r\n                          <Tab value={index} label={label} key={index}/>\r\n                        )}\r\n                        {catalog.uncategorizedDatasets?.length > 0 && (\r\n                          <Tab value=\"uncategorized\" label={t(\"commons.catalog.uncategorized\")}\r\n                               key=\"uncategorized\"/>\r\n                        )}\r\n                      </Tabs>\r\n                    )}\r\n                    {isListMode\r\n                      ? (\r\n                        <CategoriesLists\r\n                          categories={categoriesForExplore}\r\n                          onClick={\r\n                            categoryPath =>\r\n                              goToDatasets(\r\n                                node.code,\r\n                                categoryPath[0] === \"uncategorized\"\r\n                                  ? [\"uncategorized\"]\r\n                                  : catalog.categoryGroups.length > 1 ? [catalog.categoryGroups[categorySchemeTab].id, ...categoryPath] : categoryPath\r\n                              )\r\n                          }\r\n                        />\r\n                      )\r\n                      : (\r\n                        <CardsGrid\r\n                          squareImage\r\n                          list={categoriesForExplore}\r\n                          onClick={\r\n                            category =>\r\n                              goToDatasets(\r\n                                node.code,\r\n                                category.id === \"uncategorized\"\r\n                                  ? [\"uncategorized\"]\r\n                                  : catalog.categoryGroups.length > 1 ? [catalog.categoryGroups[categorySchemeTab].id, category.id] : [category.id]\r\n                              )\r\n                          }\r\n                        />\r\n                      )\r\n                    }\r\n                  </div>\r\n                </PageSection>\r\n              </div>\r\n            )}\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation(),\r\n  connect(mapStateToProps)\r\n)(Node);","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getNodeUrl} from \"../../serverApi/urls\";\r\n\r\nexport const NODE_FETCH = \"node/fetch\";\r\n\r\nexport const fetchNode = (nodeId: number) =>\r\n  initRequest(\r\n    NODE_FETCH,\r\n    getNodeUrl(nodeId),\r\n    undefined,\r\n    undefined,\r\n    t => ({\r\n      onStart: t(\"domains.node.messages.fetch.start\")\r\n    })\r\n  );","import {initRequest} from \"../../middlewares/request/requestActions\";\r\nimport {getNodeCatalogUrl} from \"../../serverApi/urls\";\r\n\r\nexport const CATALOG_FETCH = \"catalog/fetch\";\r\n\r\nexport const fetchCatalog = (nodeId: number) => initRequest(\r\n  CATALOG_FETCH,\r\n  getNodeCatalogUrl(nodeId),\r\n  undefined,\r\n  undefined,\r\n  t => ({\r\n    onStart: t(\"domains.catalog.messages.fetch.start\")\r\n  })\r\n);\r\n","import React, {useState} from \"react\";\r\nimport TreeItem from \"@material-ui/lab/TreeItem\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport TreeView from \"@material-ui/lab/TreeView\";\r\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\r\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\r\nimport {goToDatasetsSearch} from \"../../links\";\r\nimport Checkbox from \"@material-ui/core/Checkbox\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport Box from \"@material-ui/core/Box\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\n\r\nconst styles = () => ({\r\n  container: {\r\n    background: \"#F5F5F5\",\r\n    paddingTop: 8,\r\n    paddingBottom: 8\r\n  },\r\n  nodeIcon: {\r\n    marginTop: 5\r\n  },\r\n  item: {\r\n    background: \"none !important\"\r\n  },\r\n  resCount: {\r\n    fontWeight: \"bold\",\r\n    marginLeft: 4\r\n  },\r\n  checkbox: {\r\n    padding: 0,\r\n    transform: \"translateY(-2px)\"\r\n  }\r\n});\r\n\r\nfunction ResultTree(props) {\r\n  const {\r\n    classes,\r\n    catalog,\r\n    query,\r\n    node,\r\n    filters = [],\r\n    categoryGroupsWithCount,\r\n    uncategorizedDatasetsCount,\r\n    t\r\n  } = props;\r\n\r\n  const [expanded, setExpanded] = useState([]);\r\n\r\n  const getTreeItems = (tree, prevPath) =>\r\n    tree.map((cat, i) => {\r\n\r\n      const selected = !!filters.find(filter => filter.includes(cat.id));\r\n\r\n      return (\r\n        <TreeItem\r\n          key={i}\r\n          nodeId={cat.id}\r\n          label={\r\n            <Grid spacing={1} container alignItems=\"flex-start\" style={{flexWrap: \"nowrap\", marginTop: 4}}>\r\n              <Grid item>\r\n                <label htmlFor={`result-tree__checkbox__${cat.id}`} style={{display: \"none\"}}>\r\n                  {cat.label}\r\n                </label>\r\n                <Checkbox\r\n                  id={`result-tree__checkbox__${cat.id}`}\r\n                  checked={selected}\r\n                  className={classes.checkbox}\r\n                  onClick={\r\n                    e => {\r\n                      goToDatasetsSearch(\r\n                        node.code,\r\n                        query,\r\n                        selected\r\n                          ? filters.filter(path => JSON.stringify(path) !== JSON.stringify([...prevPath, cat.id]))\r\n                          : [...filters, [...prevPath, cat.id]]\r\n                      );\r\n                      e.stopPropagation();\r\n                    }}\r\n                />\r\n              </Grid>\r\n              <Grid style={{width: \"100%\"}} item>\r\n                {cat.label} <span className={classes.resCount}>({cat.count})</span>\r\n              </Grid>\r\n            </Grid>\r\n          }\r\n          classes={{label: classes.item}}\r\n        >\r\n          {cat.categories && cat.categories.length > 0 && getTreeItems(cat.categories, [...prevPath, cat.id])}\r\n        </TreeItem>\r\n      );\r\n    });\r\n\r\n  const uncategorizedSelected = !!filters.find(filter => filter.includes(\"uncategorized\"));\r\n\r\n  return (\r\n    <Box className={classes.container}>\r\n      {categoryGroupsWithCount.length > 0 && (\r\n        <TreeView\r\n          defaultCollapseIcon={<ExpandMoreIcon/>}\r\n          defaultExpandIcon={<ChevronRightIcon/>}\r\n          expanded={expanded}\r\n          onNodeToggle={(_, nodeIds) => setExpanded(nodeIds)}\r\n        >\r\n          {getTreeItems(\r\n            catalog.categoryGroups.length > 1\r\n              ? categoryGroupsWithCount\r\n              : categoryGroupsWithCount[0].categories,\r\n            []\r\n          )}\r\n        </TreeView>\r\n      )}\r\n      {uncategorizedDatasetsCount > 0 && (\r\n        <TreeView\r\n          defaultCollapseIcon={<ExpandMoreIcon/>}\r\n          defaultExpandIcon={<ChevronRightIcon/>}\r\n          expanded={expanded}\r\n          onNodeToggle={(_, nodeIds) => setExpanded(nodeIds)}\r\n        >\r\n          <TreeItem\r\n            key={\"uncategorized\"}\r\n            nodeId={\"uncategorized\"}\r\n            label={\r\n              <Grid spacing={1} container alignItems=\"flex-start\" style={{flexWrap: \"nowrap\", marginTop: 4}}>\r\n                <Grid item>\r\n                  <label htmlFor=\"result-tree__checkbox__uncategorized\" style={{display: \"none\"}}>\r\n                    {t(\"commons.catalog.uncategorized\")}\r\n                  </label>\r\n                  <Checkbox\r\n                    id=\"result-tree__checkbox__uncategorized\"\r\n                    checked={uncategorizedSelected}\r\n                    className={classes.checkbox}\r\n                    onClick={\r\n                      e => {\r\n                        goToDatasetsSearch(\r\n                          node.code,\r\n                          query,\r\n                          uncategorizedSelected\r\n                            ? filters.filter(path => JSON.stringify(path) !== JSON.stringify([\"uncategorized\"]))\r\n                            : [...filters, [\"uncategorized\"]]\r\n                        );\r\n                        e.stopPropagation();\r\n                      }}\r\n                  />\r\n                </Grid>\r\n                <Grid style={{width: \"100%\"}} item>\r\n                  {t(\"commons.catalog.uncategorized\")} <span\r\n                  className={classes.resCount}>({uncategorizedDatasetsCount})</span>\r\n                </Grid>\r\n              </Grid>\r\n            }\r\n            classes={{label: classes.item}}\r\n          />\r\n        </TreeView>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(ResultTree);","import React, {Component, Fragment} from 'react';\r\nimport NodeHeader from \"../node-header\";\r\nimport {Link, withStyles} from \"@material-ui/core\";\r\nimport Page from \"../page\";\r\nimport Container from \"@material-ui/core/Container\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {goToData, goToDatasets, goToNode} from \"../../links\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport Divider from \"@material-ui/core/Divider\";\r\nimport ListIcon from '@material-ui/icons/List';\r\nimport GridOnIcon from '@material-ui/icons/GridOn';\r\nimport Breadcrumbs from \"@material-ui/core/Breadcrumbs\";\r\nimport ResultTree from \"./ResultTree\";\r\nimport Chip from \"@material-ui/core/Chip\";\r\nimport {withTranslation} from \"react-i18next\";\r\nimport {compose} from \"redux\";\r\nimport FolderIcon from \"@material-ui/icons/Folder\";\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  fullWidthContainer: {\r\n    width: \"100%\",\r\n    paddingTop: 64,\r\n    backgroundColor: \"white\",\r\n    minHeight: \"100%\"\r\n  },\r\n  container: {\r\n    width: 1024,\r\n  },\r\n  section: {\r\n    paddingTop: theme.spacing(3)\r\n  },\r\n  results: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  cubeIcon: {\r\n    width: 24,\r\n    height: 24\r\n  },\r\n  collapsedDescription: {\r\n    marginTop: 8,\r\n    height: 49,\r\n    overflow: \"hidden\"\r\n  },\r\n  expandedDescription: {\r\n    marginTop: 8\r\n  },\r\n  resultSource: {\r\n    fontSize: 14,\r\n    color: \"rgba(0, 0, 0, 0.54)\",\r\n  },\r\n  expansion: {},\r\n  toolbar: {\r\n    marginTop: theme.spacing(2),\r\n    marginBottom: theme.spacing(1)\r\n  },\r\n  pager: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  cardContent: {\r\n    padding: \"16px !important\"\r\n  },\r\n  subCat: {\r\n    padding: theme.spacing(1)\r\n  },\r\n  row: {\r\n    marginBottom: theme.spacing(1)\r\n  }\r\n});\r\n\r\nclass Results extends Component {\r\n\r\n  state = {\r\n    isDialogOpen: false,\r\n    expandedIndexes: [],\r\n    configIsListMode: this.props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n      .catalogNavigationMode === \"List\",\r\n    isListMode:\r\n      this.props.hub.nodes\r\n        .find(({code}) => code.toLowerCase() === this.props.nodeCode.toLowerCase())\r\n        .catalogNavigationMode === \"List\",\r\n    isA11yMode: false\r\n  };\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n\r\n    const configIsListMode = props.hub.nodes\r\n      .find(({code}) => code.toLowerCase() === props.nodeCode.toLowerCase())\r\n      .catalogNavigationMode === \"List\";\r\n\r\n    if (configIsListMode !== state.configIsListMode) {\r\n      return {\r\n        ...state,\r\n        configIsListMode,\r\n        isListMode: configIsListMode\r\n      };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  onDialogOpen = () => this.setState({isDialogOpen: true});\r\n\r\n  onDialogClose = () => this.setState({isDialogOpen: false});\r\n\r\n  expand = index =>\r\n    this.setState({\r\n      expandedIndexes: [...this.state.expandedIndexes, index]\r\n    });\r\n\r\n  collapse = index =>\r\n    this.setState({\r\n      expandedIndexes: [...this.state.expandedIndexes.filter(i => i !== index)]\r\n    });\r\n\r\n  onListModeToggle = () => {\r\n    this.setState({isListMode: !this.state.isListMode});\r\n  };\r\n\r\n  onA11yModeToggle = () => {\r\n    this.setState({isA11yMode: !this.state.isA11yMode});\r\n  };\r\n\r\n  render() {\r\n\r\n    const {\r\n      classes,\r\n      query,\r\n      hub,\r\n      catalog,\r\n      node,\r\n      nodeCode,\r\n      categoryPath,\r\n      datasets,\r\n      subCategories,\r\n      filters,\r\n      categoryGroupsWithCount,\r\n      uncategorizedDatasetsCount,\r\n      t\r\n    } = this.props;\r\n\r\n    const {isDialogOpen, expandedIndexes, isListMode, isA11yMode} = this.state;\r\n\r\n    const nodeMinimalInfo = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n\r\n    let categoryPathLabels = [];\r\n    if (categoryPath) {\r\n      if (categoryPath[0] === \"uncategorized\") {\r\n        categoryPathLabels = [t(\"commons.catalog.uncategorized\")];\r\n      } else {\r\n\r\n        let category;\r\n\r\n        if (catalog.categoryGroups.length > 1) {\r\n          category = catalog.categoryGroups.find(({id}) => id === categoryPath[0]);\r\n        } else {\r\n          category = catalog.categoryGroups[0].categories.find(({id}) => id === categoryPath[0]);\r\n        }\r\n\r\n        categoryPathLabels.push(category.label);\r\n        for (let i = 1; i < categoryPath.length; i++) {\r\n          category = (category.childrenCategories || category.categories).find(({id}) => id === categoryPath[i]);\r\n          categoryPathLabels.push(category.label);\r\n        }\r\n      }\r\n    }\r\n\r\n    return (\r\n      <Page>\r\n        <NodeHeader\r\n          hub={hub.hub}\r\n          query={query}\r\n          nodes={hub.nodes}\r\n          catalog={catalog}\r\n          shortName={nodeMinimalInfo.code}\r\n          title={nodeMinimalInfo.name}\r\n          node={node}\r\n          nodeId={nodeMinimalInfo.nodeId}\r\n          selectedCategoryPath={categoryPath}\r\n        />\r\n        <div className={classes.fullWidthContainer}>\r\n          <Container className={classes.container}>\r\n            <Grid container justify=\"space-between\" alignItems=\"center\" className={classes.toolbar}>\r\n              <Grid item>\r\n                {query ?\r\n                  (\r\n                    <Typography variant={\"h5\"}>\r\n                      {t(\"scenes.results.searchTitle\", {query})}\r\n                    </Typography>\r\n                  )\r\n                  : (\r\n                    <Breadcrumbs>\r\n                      <Link underline=\"none\" onClick={() => {\r\n                        goToNode(node.code);\r\n                        window.location.reload();\r\n                      }} style={{cursor: \"pointer\"}}\r\n                      >\r\n                        <Typography>\r\n                          {nodeCode.toUpperCase()}\r\n                        </Typography>\r\n                      </Link>\r\n                      {categoryPath.map((id, idx) => {\r\n                        if (idx >= (catalog && catalog.categoryGroups.length === 1 ? 0 : 1)) {\r\n                          return (\r\n                            <Link\r\n                              key={idx}\r\n                              underline=\"none\"\r\n                              onClick={\r\n                                idx >= (\r\n                                  catalog && catalog.categoryGroups.length === 1\r\n                                    ? 0\r\n                                    : 1\r\n                                )\r\n                                  ? () => goToDatasets(node.code, categoryPath.slice(0, idx + 1))\r\n                                  : null\r\n                              }\r\n                              style={idx < categoryPath.length - 1 ? {cursor: \"pointer\"} : undefined}\r\n                            >\r\n                              <Typography>\r\n                                {id === \"uncategorized\"\r\n                                  ? t(\"commons.catalog.uncategorized\")\r\n                                  : categoryPathLabels[idx]\r\n                                }\r\n                              </Typography>\r\n                            </Link>\r\n                          );\r\n                        } else {\r\n                          return (\r\n                            <Typography key=\"idx\" color=\"primary\">\r\n                              {id === \"uncategorized\"\r\n                                ? t(\"commons.catalog.uncategorized\")\r\n                                : categoryPathLabels[idx]\r\n                              }\r\n                            </Typography>\r\n                          );\r\n                        }\r\n                      })}\r\n                    </Breadcrumbs>\r\n                  )}\r\n              </Grid>\r\n              <Grid item>\r\n                <Grid container alignItems=\"center\" justify=\"flex-end\" spacing={1}>\r\n                  <Grid item>\r\n                    {datasets.length > 0 && (\r\n                      <IconButton onClick={this.onListModeToggle}>\r\n                        {isListMode\r\n                          ? <GridOnIcon/>\r\n                          : <ListIcon/>\r\n                        }\r\n                      </IconButton>\r\n                    )}\r\n                  </Grid>\r\n                  {/*<Grid item>\r\n                    <label htmlFor=\"results__a11y-mode-toggle\" style={{display: \"none\"}}>\r\n                      {t(\"scenes.results.a11yModeToggle.label\")}\r\n                    </label>\r\n                    <FormControlLabel\r\n                      label={t(\"scenes.results.a11yModeToggle.label\")}\r\n                      control={\r\n                        <Switch\r\n                          checked={isA11yMode}\r\n                          onChange={this.onA11yModeToggle}\r\n                          color=\"primary\"\r\n                          name=\"checkedB\"\r\n                          id=\"results__a11y-mode-toggle\"\r\n                        />\r\n                      }\r\n                    />\r\n                  </Grid>*/}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n            <Grid container spacing={2} className={classes.results}>\r\n              {query && datasets.length > 0 && (\r\n                <Grid item style={{width: 256, transform: \"translateX(-24px)\"}}>\r\n                  <ResultTree\r\n                    query={query} filters={filters} catalog={catalog} node={node}\r\n                    datasets={datasets}\r\n                    categoryGroupsWithCount={categoryGroupsWithCount}\r\n                    uncategorizedDatasetsCount={uncategorizedDatasetsCount}\r\n                  />\r\n                </Grid>\r\n              )}\r\n              <Grid item style={{width: query ? `calc(100% - 256px)` : \"100%\"}}>\r\n                {subCategories && subCategories.length\r\n                  ? (\r\n                      <Grid container spacing={2} className={classes.row}>\r\n                        {subCategories.map(({id, label, datasetIdentifiers}) =>\r\n                          <Grid item key={id}>\r\n                            <Card className={classes.subCat}>\r\n                              <CardActionArea\r\n                                onClick={() => goToDatasets(node.code.toLowerCase(), [...categoryPath, id])}>\r\n                                <Typography variant=\"body1\">\r\n                                  <Grid container spacing={1}>\r\n                                    <Grid item>\r\n                                      <FolderIcon/>\r\n                                    </Grid>\r\n                                    <Grid item>\r\n                                      {label} {datasetIdentifiers && datasetIdentifiers.length ? `(${datasetIdentifiers.length})` : ''}\r\n                                    </Grid>\r\n                                  </Grid>\r\n                                </Typography>\r\n                              </CardActionArea>\r\n                            </Card>\r\n                          </Grid>\r\n                        )}\r\n                      </Grid>\r\n                  )\r\n                  : null}\r\n                {query && datasets.length\r\n                  ? (\r\n                    <Typography variant=\"body1\" className={classes.row}>\r\n                      {datasets.length > 1\r\n                        ? t(\"scenes.results.datasetsCount.plural\", {datasetsCount: datasets.length})\r\n                        : t(\"scenes.results.datasetsCount.singular\", {datasetsCount: datasets.length})\r\n                      }:\r\n                    </Typography>\r\n                  ) : null\r\n                }\r\n                <Grid container spacing={2}>\r\n                  {datasets.length > 0\r\n                    ? datasets.map((dataset, i) => {\r\n\r\n                      const isExpanded = expandedIndexes.includes(i);\r\n\r\n                      const header =\r\n                        <CardActionArea\r\n                          onClick={() => goToData(node.code, dataset.categoryPath, dataset.identifier, undefined, isA11yMode)}>\r\n                          <Typography variant=\"h6\">\r\n                            {dataset.title}\r\n                          </Typography>\r\n                          {dataset.source && (\r\n                            <Typography variant=\"body1\" className={classes.resultSource}>\r\n                              {dataset.source}\r\n                            </Typography>\r\n                          )}\r\n                        </CardActionArea>;\r\n\r\n                      const description = dataset.description || (dataset.keywords && dataset.keywords.length > 0)\r\n                        ? (\r\n                          <Typography\r\n                            component='div'\r\n                            variant=\"body1\"\r\n                            className={isExpanded ? classes.expandedDescription : classes.collapsedDescription}>\r\n                            <div dangerouslySetInnerHTML={{__html: dataset.description}}/>\r\n                            {dataset.keywords && dataset.keywords.length > 0 && (\r\n                              <Grid container spacing={1}>\r\n                                {dataset.keywords.map((keyword, index) =>\r\n                                  <Grid item key={index}>\r\n                                    <Chip\r\n                                      label={keyword}\r\n                                      size=\"small\"\r\n                                    />\r\n                                  </Grid>\r\n                                )}\r\n                              </Grid>\r\n                            )}\r\n                          </Typography>\r\n                        )\r\n                        : null;\r\n\r\n                      const expandIcon = <Grid container justify=\"flex-end\">\r\n                        <Grid item>\r\n                          <IconButton\r\n                            onClick={() => isExpanded ? this.collapse(i) : this.expand(i)}\r\n                          >\r\n                            {isExpanded\r\n                              ? <ExpandLessIcon/>\r\n                              : <ExpandMoreIcon/>\r\n                            }\r\n                          </IconButton>\r\n                        </Grid>\r\n                      </Grid>;\r\n\r\n                      /*    const viewButton = <Button onClick={() => goToData(node.code, dataset.categoryPath, dataset.identifier)}\r\n                                                     color=\"primary\">View</Button>;*/\r\n\r\n                      /*   const downloadButton = <Button color=\"secondary\" onClick={this.onDialogOpen}>\r\n                           Download\r\n                         </Button>;\r\n       */\r\n                      return (\r\n                        <Grid item key={i} xs={isListMode ? 12 : 4}>\r\n                          <Card>\r\n                            {isListMode\r\n                              ? (\r\n                                <CardContent className={classes.cardContent}>\r\n                                  <Grid container>\r\n                                    <Grid item xs={12}>\r\n                                      {header}\r\n                                    </Grid>\r\n                                  </Grid>\r\n                                  {description}\r\n                                  {description && expandIcon}\r\n                                </CardContent>\r\n                              )\r\n                              : (\r\n                                <Fragment>\r\n                                  <CardContent>\r\n                                    {header}\r\n                                    {description}\r\n                                    {description && expandIcon}\r\n                                  </CardContent>\r\n                                  <Divider/>\r\n                                  {/*<CardActions>\r\n                                <Grid container justify=\"space-between\">\r\n                                  <Grid item>\r\n                                    {viewButton}\r\n                                  </Grid>\r\n                                </Grid>\r\n                              </CardActions>*/}\r\n                                </Fragment>\r\n                              )}\r\n                          </Card>\r\n                        </Grid>\r\n                      );\r\n                    })\r\n                    : <Grid container><Grid\r\n                      item>{t(\"scenes.results.datasetsCount.none\")}</Grid></Grid>}\r\n                </Grid>\r\n              </Grid>\r\n            </Grid>\r\n            {/* pagination */}\r\n            {/* <Grid container justify=\"flex-end\" className={classes.pager}>\r\n              <Grid item>\r\n                <Pagination count={10}/>\r\n              </Grid>\r\n            </Grid>*/}\r\n            <Dialog open={isDialogOpen} onClose={this.onDialogClose}>\r\n              <DialogTitle>Download</DialogTitle>\r\n              <DialogContent>\r\n                <Button color=\"primary\" onClick={this.onDialogClose}>\r\n                  CSV\r\n                </Button>\r\n                <Button color=\"primary\" onClick={this.onDialogClose}>\r\n                  SDMX\r\n                </Button>\r\n              </DialogContent>\r\n              <DialogActions>\r\n                <Button onClick={this.onDialogClose}>\r\n                  {t(\"commons.confirm.cancel\")}\r\n                </Button>\r\n              </DialogActions>\r\n            </Dialog>\r\n          </Container>\r\n        </div>\r\n      </Page>\r\n    );\r\n  }\r\n}\r\n\r\nexport default compose(\r\n  withStyles(styles),\r\n  withTranslation()\r\n)(Results);","import React from 'react';\r\nimport NodeHeader from \"../node-header\";\r\nimport DataViewer from \"../data-viewer\";\r\nimport Page from \"../page\";\r\nimport {withStyles} from \"@material-ui/core\";\r\n\r\nconst styles = () => ({\r\n  fullWidthContainer: {\r\n    backgroundColor: \"white\",\r\n    width: \"100%\",\r\n    minHeight: \"100%\"\r\n  }\r\n});\r\n\r\nconst Data = ({\r\n                classes,\r\n                hub,\r\n                node,\r\n                catalog,\r\n                categoryPath,\r\n                isAccessible,\r\n                datasetId,\r\n                datasetTitle,\r\n                notes,\r\n                attachedFiles,\r\n                referenceMetadataUrl,\r\n                dataset\r\n              }) => {\r\n\r\n  const nodeExtras = {};\r\n  if (node?.extras) {\r\n    node.extras.map(({key, value}) => nodeExtras[key] = JSON.parse(value));\r\n  }\r\n\r\n  const hubExtras = JSON.parse(hub.hub.extras || \"{}\");\r\n\r\n  return (\r\n    <Page>\r\n      <NodeHeader\r\n        hub={hub.hub}\r\n        nodes={hub?.nodes}\r\n        catalog={catalog}\r\n        shortName={node?.code}\r\n        title={node?.name}\r\n        node={node}\r\n        nodeId={node?.nodeId}\r\n        selectedCategoryPath={categoryPath}\r\n      />\r\n      <div style={{paddingTop: 64}} className={classes.fullWidthContainer}>\r\n        <div style={{marginLeft: 16}}/>\r\n        <DataViewer\r\n          nodeId={node?.nodeId}\r\n          nodeCode={node?.code}\r\n\r\n          isAccessible={isAccessible}\r\n\r\n          datasetId={datasetId}\r\n          datasetTitle={datasetTitle}\r\n          dataset={dataset?.dataset}\r\n          isFetchDatasetDisabled={dataset?.isFetchDatasetDisabled}\r\n\r\n          isCriteriaVisible={dataset?.isCriteriaVisible}\r\n          isCriteriaAlertVisible={dataset?.isCriteriaAlertVisible}\r\n\r\n          hasTemplateLayout={dataset?.hasTemplateLayout}\r\n          hasAnnotationLayout={dataset?.hasAnnotationLayout}\r\n\r\n          dimensions={dataset?.dimensions}\r\n          mode={dataset?.mode}\r\n          type={dataset?.type}\r\n          codelistsLength={dataset?.codelistsLength}\r\n          viewerIdx={dataset?.viewerIdx}\r\n          initialTableLayout={dataset?.initialTableLayout}\r\n          initialMapLayout={dataset?.initialMapLayout}\r\n          initialChartLayout={dataset?.initialChartLayout}\r\n          labelFormat={dataset?.labelFormat}\r\n          filters={dataset?.filters}\r\n          decimalSeparator={dataset?.decimalSeparator}\r\n          decimalPlaces={dataset?.decimalPlaces}\r\n          emptyChar={dataset?.emptyChar}\r\n          enableCriteria={dataset?.enableCriteria}\r\n          enableLayout={dataset?.enableLayout}\r\n          maxAllowedCells={dataset?.maxAllowedCells}\r\n          territorialDims={dataset?.territorialDims}\r\n          codes={dataset?.codes}\r\n          isCodesFlat={dataset?.isCodesFlat}\r\n          codelists={dataset?.codelists}\r\n          areCodelistsFlat={dataset?.areCodelistsFlat}\r\n          timePeriod={dataset?.timePeriod}\r\n\r\n          geometries={dataset?.geometries}\r\n          geometryDetailLevels={dataset?.geometryDetailLevels}\r\n          isPartialData={dataset?.isPartialData}\r\n          isEmptyData={dataset?.isEmptyData}\r\n          isTooBigData={dataset?.isTooBigData}\r\n\r\n          maxObservation={hub?.hub?.maxObservationsAfterCriteria}\r\n\r\n          isDownloadWarningVisible={dataset?.isDownloadWarningVisible}\r\n          isUnavailableViewWarningVisible={dataset?.isUnavailableViewWarningVisible}\r\n          isCriteriaLengthWarningVisible={dataset?.isCriteriaLengthWarningVisible}\r\n\r\n          timings={dataset?.timings}\r\n\r\n          notes={notes}\r\n          attachedFiles={attachedFiles}\r\n          referenceMetadataUrl={referenceMetadataUrl}\r\n\r\n          hubExtras={hubExtras}\r\n          nodeExtras={nodeExtras}\r\n        />\r\n      </div>\r\n    </Page>\r\n  )\r\n};\r\n\r\nexport default withStyles(styles)(Data);","import React, {useEffect, useState} from 'react';\r\nimport Data from \"../components/data\";\r\nimport {connect} from \"react-redux\";\r\nimport {enableDatasetStructureFetch, fetchDatasetStructure, resetDataset} from \"../state/dataset/datasetActions\";\r\nimport Call from \"../hocs/call\";\r\n\r\nconst mapStateToProps = state => ({\r\n  dataset: state.dataset,\r\n  defaultLanguage: state.app.language,\r\n  languages: state.app.languages\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  onFetchStructureEnable: datasetId => dispatch(enableDatasetStructureFetch(datasetId)),\r\n  fetchStructure: ({nodeId, datasetId, viewId, defaultLanguage, languages}) =>\r\n    dispatch(fetchDatasetStructure(nodeId, datasetId, viewId, defaultLanguage, languages)),\r\n  onDatasetReset: () => dispatch(resetDataset())\r\n});\r\n\r\nconst DatasetDomain = ({\r\n                         dataset,\r\n                         defaultLanguage,\r\n                         languages,\r\n                         hub,\r\n                         node,\r\n                         catalog,\r\n                         categoryPath,\r\n                         isAccessible,\r\n                         datasetId,\r\n                         datasetTitle,\r\n                         notes,\r\n                         attachedFiles,\r\n                         referenceMetadataUrl,\r\n                         viewId,\r\n                         onFetchStructureEnable,\r\n                         fetchStructure,\r\n                         onDatasetReset\r\n                       }) => {\r\n\r\n  const [isReset, setIsReset] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!isReset && hub && node && catalog && categoryPath && datasetId && datasetTitle && dataset) {\r\n      onFetchStructureEnable(datasetId);\r\n      setIsReset(true);\r\n    }\r\n  }, [isReset, hub, node, catalog, categoryPath, datasetId, datasetTitle, dataset, onFetchStructureEnable, onDatasetReset, setIsReset]);\r\n\r\n  return (\r\n    <Call\r\n      cb={fetchStructure}\r\n      cbParam={{nodeId: node ? node.nodeId : null, datasetId, viewId, defaultLanguage, languages}}\r\n      disabled={!node || !node.nodeId || !datasetId || !dataset || dataset.isFetchStructureDisabled}\r\n    >\r\n      <Data\r\n        hub={hub}\r\n        node={node}\r\n        catalog={catalog}\r\n        categoryPath={categoryPath}\r\n        isAccessible={isAccessible}\r\n        datasetId={datasetId}\r\n        datasetTitle={datasetTitle}\r\n        notes={notes}\r\n        attachedFiles={attachedFiles}\r\n        referenceMetadataUrl={referenceMetadataUrl}\r\n        dataset={dataset}\r\n        viewId={viewId}\r\n      />\r\n    </Call>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DatasetDomain);","import React, {Fragment, useState} from \"react\";\r\nimport {useTranslation} from \"react-i18next\";\r\nimport withStyles from \"@material-ui/core/styles/withStyles\";\r\nimport {getTextWidth} from \"../../utils/style\";\r\nimport FormControl from \"@material-ui/core/FormControl\";\r\nimport InputLabel from \"@material-ui/core/InputLabel\";\r\nimport Select from \"@material-ui/core/Select\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport InfiniteScrollTable from \"../infinite-scroll-table\";\r\nimport {getNode, getNodes, getNodesAtDepth} from \"../../utils/tree\";\r\nimport {getDashboardDynamicFilterLabelTranslations} from \"../../constants/getDashboardDynamicFilterLabelTranslations\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst styles = theme => ({\r\n  root: {},\r\n  filter: {\r\n    display: \"inline-block\",\r\n    verticalAlign: \"bottom\",\r\n    marginRight: 16,\r\n    \"& label\": {\r\n      fontSize: 16\r\n    }\r\n  },\r\n  item: {\r\n    fontSize: 14\r\n  },\r\n  dialogContent: {\r\n    padding: \"8px !important\"\r\n  },\r\n});\r\n\r\nconst getLabelsMap = tree => {\r\n  const map = {};\r\n  getNodes(tree, \"children\", () => true).forEach(({id, name}) => map[id] = name);\r\n\r\n  return map;\r\n}\r\n\r\nfunction DashboardFilters(props) {\r\n  const {\r\n    classes,\r\n    filters,\r\n    isFilterEnabled,\r\n    selectValues,\r\n    setSelectValues,\r\n    lastValorizedIdx,\r\n    setLastValorizedIdx,\r\n    filterLevels,\r\n    onFilterApply\r\n  } = props;\r\n\r\n  const {\r\n    labels,\r\n    values\r\n  } = filters;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [isApplyDisabled, setIsApplyDisable] = useState(false);\r\n\r\n  const [visibleId, setVisibleId] = useState(null);\r\n\r\n  const [labelsMap] = useState(getLabelsMap(values));\r\n\r\n  const handleFilterSelect = (dimension, value) => {\r\n    const newSelectedValues = {};\r\n    let found = false;\r\n    labels.forEach(label => {\r\n      if (!found) {\r\n        if (label !== dimension) {\r\n          newSelectedValues[label] = selectValues[label];\r\n        } else {\r\n          found = true;\r\n          newSelectedValues[label] = value;\r\n        }\r\n      } else {\r\n        newSelectedValues[label] = \"\";\r\n      }\r\n    })\r\n    setSelectValues(newSelectedValues);\r\n    setLastValorizedIdx(visibleId);\r\n    setVisibleId(null);\r\n    setIsApplyDisable(false);\r\n  };\r\n\r\n  let data = [];\r\n  if (visibleId !== null) {\r\n    data = visibleId === 0\r\n      ? values\r\n      : getNode(values, \"children\", ({id}) => id === selectValues[labels[visibleId - 1]]).children\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className={classes.root}>\r\n        {(() => {\r\n          const getTextWidthEl = $('<span>').css({\r\n            visibility: 'hidden',\r\n            position: 'absolute',\r\n            fontSize: 16\r\n          }).appendTo('body').get(0);\r\n\r\n          const selects = [];\r\n\r\n          for (let i = 0; i <= Math.min(lastValorizedIdx + 1, labels.length - 1); i++) {\r\n            const label = labels[i];\r\n            const minWidth = getTextWidth(label, getTextWidthEl) + 32;\r\n\r\n            selects.push(\r\n              <div key={i} className={classes.filter}>\r\n                <FormControl style={{display: \"inline-block\", verticalAlign: \"bottom\"}}>\r\n                  <InputLabel>{getDashboardDynamicFilterLabelTranslations(t)[label]}</InputLabel>\r\n                  <Select\r\n                    open={false}\r\n                    style={{minWidth: minWidth}}\r\n                    value={isFilterEnabled ? (selectValues[label] || \"\") : \"-\"}\r\n                    renderValue={value => isFilterEnabled ? labelsMap[value] : \"---\"}\r\n                    className={classes.item}\r\n                    onOpen={() => setVisibleId(i)}\r\n                    disabled={!isFilterEnabled}\r\n                  >\r\n                    {isFilterEnabled\r\n                      ? getNodesAtDepth(values, \"children\", (i + 1)).map(({id}, idx) => (\r\n                        <MenuItem key={idx} value={id}>{id}</MenuItem>\r\n                      ))\r\n                      : <MenuItem key={\"-\"} value={\"-\"}/>\r\n                    }\r\n                  </Select>\r\n                </FormControl>\r\n              </div>\r\n            )\r\n          }\r\n\r\n          $(getTextWidthEl).remove();\r\n\r\n          if (isFilterEnabled) {\r\n            selects.push(\r\n              <Button\r\n                key={labels.length}\r\n                onClick={() => {\r\n                  onFilterApply(selectValues[labels[lastValorizedIdx]]);\r\n                  setIsApplyDisable(true);\r\n                }}\r\n                disabled={isApplyDisabled || lastValorizedIdx < 0 || filterLevels?.[labels[lastValorizedIdx]] === false}\r\n              >\r\n                {t(\"commons.confirm.apply\")}\r\n              </Button>\r\n            );\r\n          }\r\n\r\n          return selects\r\n        })()}\r\n      </div>\r\n\r\n      <Dialog\r\n        open={visibleId !== null}\r\n        onClose={() => setVisibleId(null)}\r\n        fullWidth\r\n        maxWidth=\"md\"\r\n      >\r\n        <DialogContent className={classes.dialogContent}>\r\n          <InfiniteScrollTable\r\n            data={data}\r\n            getRowKey={({id}) => id}\r\n            showHeader={false}\r\n            columns={[\r\n              {\r\n                title: \"ID\",\r\n                dataIndex: \"id\",\r\n                minWidth: 100\r\n              },\r\n              {\r\n                title: \"Label\",\r\n                dataIndex: \"name\",\r\n                minWidth: 150\r\n              }\r\n            ]}\r\n            onRowClick={rowData => handleFilterSelect(labels[visibleId], rowData.id)}\r\n            getRowStyle={rowData => ({\r\n              background: rowData.id === selectValues[labels[visibleId]]\r\n                ? \"#fff9e5\"\r\n                : undefined\r\n            })}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setVisibleId(null)} color=\"primary\">\r\n            {t(\"commons.confirm.cancel\")}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Fragment>\r\n  )\r\n}\r\n\r\nexport default withStyles(styles)(DashboardFilters);","import React, {Fragment, useEffect, useState} from 'react';\r\nimport {compose} from \"redux\";\r\nimport {connect} from \"react-redux\";\r\nimport {withStyles} from \"@material-ui/core\";\r\nimport {\r\n  clearDashboardsDashboards,\r\n  fetchDashboardsDashboard,\r\n  fetchDashboardsDataset,\r\n  fetchDashboardsMapGeometries,\r\n  setDashboardsDatasetFetchEnableStatus\r\n} from \"../state/dashboard/dashboardActions\";\r\nimport Call from \"../hocs/call\";\r\nimport Dashboard from \"../components/dashboard\";\r\nimport filters from \"../dummy/filters.json\";\r\nimport DashboardFilters from \"../components/dashboard-filters\";\r\nimport {\r\n  DASHBOARD_ELEM_FILTER_DIMENSION_KEY,\r\n  DASHBOARD_ELEM_TYPE_KEY,\r\n  DASHBOARD_ELEM_TYPE_VALUE_VIEW,\r\n  DASHBOARD_ELEM_VALUE_KEY,\r\n  getViewIdxFromRowAndCol\r\n} from \"../utils/dashboards\";\r\nimport _ from \"lodash\";\r\nimport AppBar from \"@material-ui/core/AppBar\";\r\nimport Tabs from \"@material-ui/core/Tabs\";\r\nimport Tab from \"@material-ui/core/Tab\";\r\nimport CustomEmpty from \"../components/custom-empty\";\r\nimport NodeHeader from \"../components/node-header\";\r\nimport {localizeI18nObj} from \"../utils/i18n\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst COMMONS_FILTERS_HEIGHT = 80;\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    backgroundColor: \"white\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n  },\r\n  fullWidthContainer: {\r\n    padding: 8,\r\n    width: \"100%\",\r\n    height: \"100%\"\r\n  },\r\n  commonsFilters: {\r\n    height: COMMONS_FILTERS_HEIGHT,\r\n    padding: \"16px 8px\"\r\n  },\r\n  dashboardHeader: {\r\n    padding: \"0 8px\"\r\n  },\r\n  dashboardTabs: {\r\n    marginBottom: 16\r\n  },\r\n  dashboardTitle: {\r\n    padding: \"8px 0\",\r\n    marginBottom: 4,\r\n    fontSize: 20,\r\n    fontWeight: 500\r\n  },\r\n  dashboard: {\r\n    overflow: \"auto\",\r\n    margin: \"0 8px\"\r\n  }\r\n});\r\n\r\nconst mapStateToProps = state => ({\r\n  languages: state.app.languages,\r\n  defaultLanguage: state.app.language,\r\n  dashboards: state.dashboard.dashboards,\r\n  isFetchDatasetDisabled: state.dashboard.isFetchDatasetDisabled,\r\n  jsonStats: state.dashboard.jsonStats,\r\n  maps: state.dashboard.maps\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchDashboard: dashboardId => dispatch(fetchDashboardsDashboard(dashboardId)),\r\n  clearDashboards: () => dispatch(clearDashboardsDashboards()),\r\n  setDatasetFetchEnableStatus: enabled => dispatch(setDashboardsDatasetFetchEnableStatus(enabled)),\r\n  fetchDataset: (dashboardId, nodeId, datasetId, criteria, requestIds) =>\r\n    dispatch(fetchDashboardsDataset(dashboardId, nodeId, datasetId, criteria, requestIds)),\r\n  fetchMapGeometries: (dashboardId, idList, requestId) => dispatch(fetchDashboardsMapGeometries(dashboardId, idList, requestId)),\r\n});\r\n\r\nconst handleHeight = () => {\r\n  const headerHeight = document.getElementById(\"node-header\")\r\n    ? document.getElementById(\"node-header\").offsetHeight\r\n    : 0;\r\n\r\n  if (document.getElementById(\"dashboards-container\")) {\r\n    document.getElementById(\"dashboards-container\").setAttribute(\"style\", `padding-top: ${headerHeight}px`);\r\n  }\r\n};\r\n\r\nconst getIsFilterEnabled = dashboard => {\r\n  let isFilterEnabled = false;\r\n  dashboard.dashboardConfig.forEach(row => {\r\n    row.forEach(col => {\r\n      if ((col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || \"\").length > 0) {\r\n        isFilterEnabled = true;\r\n      }\r\n    });\r\n  });\r\n\r\n  return isFilterEnabled\r\n};\r\n\r\nfunction DashboardsDomain(props) {\r\n  const {\r\n    classes,\r\n    defaultLanguage,\r\n    languages,\r\n    hub,\r\n    node,\r\n    nodeId,\r\n    catalog,\r\n    dashboardId,\r\n    dashboards,\r\n    isFetchDatasetDisabled,\r\n    jsonStats,\r\n    maps,\r\n    fetchDashboard,\r\n    clearDashboards,\r\n    setDatasetFetchEnableStatus,\r\n    fetchDataset,\r\n    fetchMapGeometries\r\n  } = props;\r\n\r\n  const {t} = useTranslation();\r\n\r\n  const [filterValue, setFilterValue] = useState(\"\");\r\n  const [selectValues, setSelectValues] = useState({});\r\n  const [lastValorizedIdx, setLastValorizedIdx] = useState(-1);\r\n\r\n  const [allowedDashboards, setAllowedDashboards] = useState(null);\r\n  const [currentDashboardId, setCurrentDashboardId] = useState(null);\r\n\r\n  const [fetchedDashboards, setFetchedDashboards] = useState(null);\r\n\r\n  const [tabIdx, setTabIdx] = useState(0);\r\n\r\n  // const {\r\n  //   labels\r\n  // } = filters;\r\n\r\n  useEffect(() => {\r\n    clearDashboards();\r\n    setFilterValue(\"\");\r\n    handleHeight();\r\n  }, [clearDashboards, nodeId, dashboardId]);\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"resize\", handleHeight);\r\n    return () => window.removeEventListener(\"resize\", handleHeight)\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const nodeDashboards = nodeId ? (hub.nodes.find(node => node.nodeId === nodeId).dashboards || []) : []\r\n    const hubDashboards = (hub.hub.dashboards || [])\r\n\r\n    setAllowedDashboards(dashboardId\r\n      ? [{id: dashboardId}]\r\n      : nodeId\r\n        ? hubDashboards.concat(nodeDashboards)\r\n        : hubDashboards\r\n    );\r\n  }, [hub, nodeId, dashboardId]);\r\n\r\n  useEffect(() => {\r\n    if (allowedDashboards) {\r\n      const newCurrentDashboardId = dashboardId\r\n        ? dashboardId\r\n        : allowedDashboards[tabIdx].id\r\n          ? allowedDashboards[tabIdx].id\r\n          : null;\r\n      setCurrentDashboardId(newCurrentDashboardId);\r\n    }\r\n  }, [allowedDashboards, dashboardId, tabIdx]);\r\n\r\n  useEffect(() => {\r\n    if (allowedDashboards) {\r\n      const newFetchedDashboards = {};\r\n      allowedDashboards.forEach(({id}) => newFetchedDashboards[id] = {static: false, dynamic: false});\r\n      setFetchedDashboards(newFetchedDashboards);\r\n    }\r\n  }, [allowedDashboards]);\r\n\r\n  const handleFilterApply = value => {\r\n    if (value !== filterValue) {\r\n      setFilterValue(value);\r\n      setDatasetFetchEnableStatus(true);\r\n\r\n      const newFetchedDashboard = _.cloneDeep(fetchedDashboards);\r\n      allowedDashboards.forEach(({id}) => newFetchedDashboard[id] = {...fetchedDashboards[id], dynamic: false});\r\n      setFetchedDashboards(newFetchedDashboard);\r\n    }\r\n  };\r\n\r\n  const handleFetchDatasets = ({dashboardId, fetchStatic, fetchDynamic, dynamicFilterValue}) => {\r\n\r\n    const newFetchedDashboards = _.cloneDeep(fetchedDashboards);\r\n    if (fetchStatic) {\r\n      newFetchedDashboards[dashboardId].static = true;\r\n    }\r\n    if (fetchDynamic && dynamicFilterValue) {\r\n      newFetchedDashboards[dashboardId].dynamic = true;\r\n    }\r\n    setFetchedDashboards(newFetchedDashboards);\r\n\r\n    const requests = [];\r\n    dashboards[dashboardId].dashboardConfig.forEach((row, rowIdx) => {\r\n      row.forEach((col, colIdx) => {\r\n        if (col[DASHBOARD_ELEM_TYPE_KEY] === DASHBOARD_ELEM_TYPE_VALUE_VIEW) {\r\n\r\n          const view = dashboards[dashboardId].views[col[DASHBOARD_ELEM_VALUE_KEY]];\r\n\r\n          let newCriteria = view?.criteria ? view.criteria : {};\r\n\r\n          let addRequest = false;\r\n\r\n          if (!col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY] || col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY].length === 0) {\r\n            addRequest = fetchStatic\r\n\r\n          } else {\r\n            if (fetchDynamic) {\r\n              addRequest = true;\r\n              if (dynamicFilterValue) {\r\n                newCriteria = {\r\n                  ...newCriteria,\r\n                  [col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY]]: [dynamicFilterValue]\r\n                };\r\n              } else {\r\n                newCriteria = {\r\n                  ...newCriteria,\r\n                  [col[DASHBOARD_ELEM_FILTER_DIMENSION_KEY]]: [filters.defaultFilterValue]\r\n                };\r\n              }\r\n            }\r\n          }\r\n\r\n          if (addRequest) {\r\n            const request = requests.find(({nodeId, datasetId, criteria}) => {\r\n              return (\r\n                nodeId === view.nodeId &&\r\n                datasetId === view.datasetId &&\r\n                _.isEqual(criteria, newCriteria)\r\n              )\r\n            });\r\n\r\n            if (request === undefined) {\r\n              requests.push({\r\n                nodeId: view.nodeId,\r\n                datasetId: view.datasetId,\r\n                criteria: newCriteria,\r\n                requestIds: [getViewIdxFromRowAndCol(rowIdx, colIdx)]\r\n              });\r\n            } else {\r\n              request.requestIds.push(getViewIdxFromRowAndCol(rowIdx, colIdx));\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n    requests.forEach(({nodeId, datasetId, criteria, requestIds}) => fetchDataset(dashboardId, nodeId, datasetId, criteria, requestIds));\r\n  };\r\n\r\n  // const resetFilter = () => {\r\n  //   setFilterValue(\"\");\r\n  //   setSelectValues({});\r\n  //   setLastValorizedIdx(-1);\r\n  //   if (allowedDashboards) {\r\n  //     const newFetchedDashboards = {};\r\n  //     allowedDashboards.forEach(({id}) => newFetchedDashboards[id] = {static: fetchedDashboards[id].static, dynamic: false});\r\n  //     setFetchedDashboards(newFetchedDashboards);\r\n  //   }\r\n  // };\r\n\r\n  return (\r\n    <div key={dashboardId} className={classes.root}>\r\n      {nodeId\r\n        ? (\r\n          <NodeHeader\r\n            hub={hub.hub}\r\n            nodes={hub?.nodes}\r\n            node={node}\r\n            nodeId={nodeId}\r\n            shortName={node?.code}\r\n            title={node?.name}\r\n            catalog={catalog}\r\n            defaultNodeConfigOpen={props.defaultNodeConfigOpen}\r\n            defaultAppConfigOpen={props.defaultAppConfigOpen}\r\n            defaultUserConfigOpen={props.defaultUserConfigOpen}\r\n            defaultNodesConfigOpen={props.defaultNodesConfigOpen}\r\n          />\r\n        )\r\n        : (\r\n          <NodeHeader\r\n            noNode\r\n            hub={hub.hub}\r\n            nodes={hub.nodes}\r\n            defaultNodeConfigOpen={props.defaultNodeConfigOpen}\r\n            defaultAppConfigOpen={props.defaultAppConfigOpen}\r\n            defaultUserConfigOpen={props.defaultUserConfigOpen}\r\n            defaultNodesConfigOpen={props.defaultNodesConfigOpen}\r\n          />\r\n        )\r\n      }\r\n      <div className={classes.fullWidthContainer} id=\"dashboards-container\">\r\n        {currentDashboardId\r\n          ? (\r\n            <Call\r\n              cb={fetchDashboard}\r\n              cbParam={currentDashboardId}\r\n              disabled={!currentDashboardId || (dashboards && dashboards[currentDashboardId] !== null && dashboards[currentDashboardId] !== undefined)}\r\n            >\r\n              {(() => {\r\n                return (\r\n                  <Call\r\n                    cb={handleFetchDatasets}\r\n                    cbParam={{\r\n                      dashboardId: currentDashboardId,\r\n                      fetchStatic: true,\r\n                      fetchDynamic: !filterValue,\r\n                      dynamicFilterValue: null\r\n                    }}\r\n                    disabled={!dashboards || !dashboards[currentDashboardId] || fetchedDashboards[currentDashboardId].static === true}\r\n                  >\r\n                    <Fragment>\r\n                      <div className={classes.commonsFilters}>\r\n                        <DashboardFilters\r\n                          filters={filters}\r\n                          isFilterEnabled={dashboards?.[currentDashboardId] ? getIsFilterEnabled(dashboards[currentDashboardId]) : null}\r\n                          selectValues={selectValues}\r\n                          setSelectValues={setSelectValues}\r\n                          lastValorizedIdx={lastValorizedIdx}\r\n                          setLastValorizedIdx={setLastValorizedIdx}\r\n                          filterLevels={dashboards?.[currentDashboardId] ? dashboards[currentDashboardId].filterLevels : null}\r\n                          onFilterApply={filterValue => handleFilterApply(filterValue)}\r\n                        />\r\n                      </div>\r\n                      {(() => {\r\n                        if (dashboards?.[currentDashboardId]) {\r\n\r\n                          let newFilterValue = filterValue;\r\n\r\n                          // if (lastValorizedIdx >= 0 && dashboards[currentDashboardId].filterLevels && dashboards[currentDashboardId].filterLevels?.[labels[lastValorizedIdx]] === false) {\r\n                          //   newFilterValue = \"\";\r\n                          //   resetFilter();\r\n                          // }\r\n\r\n                          return (\r\n                            <Call\r\n                              cb={handleFetchDatasets}\r\n                              cbParam={{\r\n                                dashboardId: currentDashboardId,\r\n                                fetchStatic: false,\r\n                                fetchDynamic: !!newFilterValue,\r\n                                dynamicFilterValue: newFilterValue\r\n                              }}\r\n                              disabled={isFetchDatasetDisabled || fetchedDashboards[currentDashboardId].dynamic === true || fetchedDashboards[currentDashboardId].static !== true}\r\n                            >\r\n                              <Fragment>\r\n                                <div className={classes.dashboardHeader}>\r\n                                  {(allowedDashboards.length > 1)\r\n                                    ? (\r\n                                      <AppBar position=\"static\" color=\"default\" className={classes.dashboardTabs}>\r\n                                        <Tabs\r\n                                          value={tabIdx}\r\n                                          variant=\"scrollable\"\r\n                                          scrollButtons=\"auto\"\r\n                                          indicatorColor=\"primary\"\r\n                                          textColor=\"primary\"\r\n                                          onChange={(_, newValue) => setTabIdx(newValue)}\r\n                                        >\r\n                                          {allowedDashboards.map(({id, title}, idx) =>\r\n                                            <Tab key={idx} label={title}/>\r\n                                          )}\r\n                                        </Tabs>\r\n                                      </AppBar>\r\n                                    )\r\n                                    : (\r\n                                      <div className={classes.dashboardTitle}>\r\n                                        {localizeI18nObj(dashboards[currentDashboardId].title, defaultLanguage, languages)}\r\n                                      </div>\r\n                                    )\r\n                                  }\r\n                                </div>\r\n                                <div\r\n                                  className={classes.dashboard}\r\n                                  style={{height: `calc(100% - ${COMMONS_FILTERS_HEIGHT + (allowedDashboards.length > 1 ? 64 : 48)}px)`}}\r\n                                >\r\n                                  {dashboards[currentDashboardId] && (\r\n                                    <Dashboard\r\n                                      key={currentDashboardId}\r\n                                      dashboard={dashboards[currentDashboardId]}\r\n                                      filterValue={filterValue}\r\n                                      jsonStats={(jsonStats && jsonStats[currentDashboardId]) ? jsonStats[currentDashboardId] : null}\r\n                                      maps={maps ? maps[currentDashboardId] : null}\r\n                                      fetchMapGeometries={(idList, requestId) => fetchMapGeometries(currentDashboardId, idList, requestId)}\r\n                                    />\r\n                                  )}\r\n                                </div>\r\n                              </Fragment>\r\n                            </Call>\r\n                          )\r\n                        }\r\n                      })()}\r\n                    </Fragment>\r\n                  </Call>\r\n                )\r\n              })()}\r\n            </Call>\r\n          )\r\n          : (\r\n            <CustomEmpty\r\n              text={nodeId\r\n                ? t(\"scenes.dashboard.noDashboard.node\")\r\n                : t(\"scenes.dashboard.noDashboard.hub\")\r\n              }\r\n            />\r\n          )\r\n        }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default compose(\r\n  connect(mapStateToProps, mapDispatchToProps),\r\n  withStyles(styles)\r\n)(DashboardsDomain);","import React, {Fragment, useEffect} from 'react';\r\nimport {Route, Switch} from \"react-router\";\r\nimport Node from \"../components/node\";\r\nimport {fetchNode} from \"../state/node/nodeActions\";\r\nimport {fetchCatalog} from \"../state/catalog/catalogActions\";\r\nimport Results from \"../components/results\";\r\nimport DatasetDomain from \"./DatasetDomain\";\r\nimport {connect} from \"react-redux\";\r\nimport DashboardsDomain from \"./DashboardsDomain\";\r\n\r\nconst mapStateToProps = state => ({\r\n  node: state.node,\r\n  catalog: state.catalog\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchNode: nodeId => dispatch(fetchNode(nodeId)),\r\n  fetchCatalog: nodeId => dispatch(fetchCatalog(nodeId))\r\n});\r\n\r\nconst NodeDomain = ({hub, nodeCode, node, catalog, fetchNode, fetchCatalog}) => {\r\n\r\n  useEffect(() => {\r\n\r\n    if (hub && (!node || nodeCode.toLowerCase() !== node.code.toLowerCase())) {\r\n      const nodeHavingCode = hub.nodes.find(({code}) => code.toLowerCase() === nodeCode.toLowerCase());\r\n      if (nodeHavingCode) {\r\n        fetchNode(nodeHavingCode.nodeId);\r\n        fetchCatalog(nodeHavingCode.nodeId);\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [hub, nodeCode, node]);\r\n\r\n\r\n  const Recursive = ({path, match}) =>\r\n    <Switch>\r\n      <Route\r\n        exact\r\n        path={match.url}\r\n        render={({location}) => {\r\n\r\n          const viewParam = new URLSearchParams(location.search).get(\"view\");\r\n          const a11yParam = new URLSearchParams(location.search).get(\"accessible\");\r\n\r\n          if (path.length === 1 && catalog.datasets[path[0]]) {\r\n            return (\r\n              <DatasetDomain\r\n                hub={hub}\r\n                node={node}\r\n                nodeCode={nodeCode}\r\n                catalog={catalog}\r\n                categoryPath={[]}\r\n                datasetId={path[0]}\r\n                datasetTitle={catalog.datasets[path[0]].title}\r\n                notes={catalog.datasets[path[0]]?.note}\r\n                attachedFiles={catalog.datasets[path[0]]?.attachedDataFiles}\r\n                referenceMetadataUrl={catalog.datasets[path[0]]?.referenceMetadata}\r\n                viewId={viewParam || undefined}\r\n                isAccessible={!!a11yParam}\r\n              />\r\n            );\r\n          } else if (path.length === 1 && catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[0])) {\r\n\r\n            const dataset = catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[0]);\r\n\r\n            return (\r\n              <DatasetDomain\r\n                hub={hub}\r\n                node={node}\r\n                nodeCode={nodeCode}\r\n                catalog={catalog}\r\n                categoryPath={[]}\r\n                datasetId={path[0]}\r\n                datasetTitle={dataset.title}\r\n                notes={dataset?.note}\r\n                attachedFiles={dataset?.attachedDataFiles}\r\n                referenceMetadataUrl={dataset?.referenceMetadata}\r\n                viewId={viewParam || undefined}\r\n                isAccessible={!!a11yParam}\r\n              />\r\n            );\r\n          } else if (path.length > 0 && path[0] === \"uncategorized\" &&\r\n            catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0) {\r\n\r\n            if (path.length === 1) {\r\n\r\n              return (<Results hub={hub} node={node} nodeCode={nodeCode} catalog={catalog}\r\n                               categoryPath={path}\r\n                               datasets={catalog.uncategorizedDatasets.map(ds => ({\r\n                                 ...ds,\r\n                                 categoryPath: path\r\n                               }))}/>);\r\n\r\n            } else if (path.length === 2) {\r\n\r\n              const dataset = catalog.uncategorizedDatasets.find(({identifier}) => identifier === path[1]);\r\n\r\n              if (dataset) {\r\n                return (\r\n                  <DatasetDomain\r\n                    hub={hub}\r\n                    node={node}\r\n                    nodeCode={nodeCode}\r\n                    catalog={catalog}\r\n                    categoryPath={path.slice(0, -1)}\r\n                    datasetId={dataset.identifier}\r\n                    datasetTitle={dataset.title}\r\n                    notes={dataset?.note}\r\n                    attachedFiles={dataset?.attachedDataFiles}\r\n                    referenceMetadataUrl={dataset?.referenceMetadata}\r\n                    isAccessible={!!a11yParam}\r\n                  />\r\n                );\r\n              }\r\n\r\n            }\r\n          } else if (catalog.categoryGroups.length > 0) {\r\n\r\n            const getDatasetsIdsAndSubcategoriesOrDatasetId = (categoryPath = [], categories = [], datasetsIds = []) => {\r\n\r\n              if (categoryPath.length > 0) {\r\n\r\n                if (categoryPath.length === 1) {\r\n\r\n                  const datasetId = datasetsIds.find(id => id === categoryPath[0]);\r\n\r\n                  if (datasetId) {\r\n                    return datasetId;\r\n                  } else {\r\n\r\n                    const lastCategory = categories.find(({id}) => id === categoryPath[0]);\r\n                    if (lastCategory) {\r\n                      return {\r\n                        datasetIds: lastCategory.datasetIdentifiers,\r\n                        subCategories: lastCategory.categories || lastCategory.childrenCategories\r\n                      }\r\n                    }\r\n\r\n                  }\r\n\r\n                } else {\r\n                  const nextCategory = categories.find(({id}) => id === categoryPath[0]);\r\n\r\n                  if (nextCategory) {\r\n                    return getDatasetsIdsAndSubcategoriesOrDatasetId(categoryPath.slice(1), nextCategory.categories || nextCategory.childrenCategories, nextCategory.datasetIdentifiers);\r\n                  }\r\n                }\r\n              }\r\n\r\n              return null;\r\n            };\r\n\r\n            const datasetsIdsOrDatasetId = getDatasetsIdsAndSubcategoriesOrDatasetId(\r\n              path,\r\n              catalog.categoryGroups.length === 1 ? catalog.categoryGroups[0].categories : catalog.categoryGroups,\r\n              []\r\n            );\r\n\r\n            if (datasetsIdsOrDatasetId?.datasetIds) {\r\n              return (\r\n                <Results hub={hub} node={node} nodeCode={nodeCode} catalog={catalog}\r\n                         categoryPath={path}\r\n                         datasets={datasetsIdsOrDatasetId.datasetIds.map(id => ({\r\n                           ...catalog.datasets[id],\r\n                           identifier: id,\r\n                           categoryPath: path\r\n                         }))} subCategories={datasetsIdsOrDatasetId.subCategories}\r\n                />);\r\n            } else if (datasetsIdsOrDatasetId) {\r\n              return (\r\n                <DatasetDomain\r\n                  hub={hub} node={node}\r\n                  nodeCode={nodeCode}\r\n                  catalog={catalog}\r\n                  categoryPath={path.slice(0, -1)}\r\n                  datasetId={datasetsIdsOrDatasetId}\r\n                  datasetTitle={catalog.datasets[datasetsIdsOrDatasetId].title}\r\n                  notes={catalog.datasets[datasetsIdsOrDatasetId]?.note}\r\n                  attachedFiles={catalog.datasets[datasetsIdsOrDatasetId]?.attachedDataFiles}\r\n                  referenceMetadataUrl={catalog.datasets[datasetsIdsOrDatasetId]?.referenceMetadata}\r\n                  isAccessible={!!a11yParam}\r\n                />\r\n              );\r\n            } else {\r\n              return \"Not found\";\r\n            }\r\n          }\r\n\r\n          return \"Not found\";\r\n        }}/>\r\n      <Route\r\n        path={`${match.url}/:categoryId`}\r\n        render={({match}) => <Recursive match={match} path={[...path, match.params.categoryId]}/>}\r\n      />\r\n    </Switch>;\r\n\r\n  return (\r\n    <Fragment>\r\n      <Switch>\r\n        <Route\r\n          exact\r\n          path={'/:nodeCode'}\r\n          render={props =>\r\n            <Node\r\n              {...props}\r\n              nodeCode={nodeCode}\r\n              hub={hub}\r\n              node={node}\r\n              catalog={catalog}\r\n            />\r\n          }\r\n        />\r\n        <Route\r\n          exact\r\n          path={'/:nodeCode/dashboards'}\r\n          render={() => (\r\n            <DashboardsDomain\r\n              hub={hub}\r\n              node={node}\r\n              nodeId={node?.nodeId}\r\n              catalog={catalog}\r\n            />\r\n          )}\r\n        />\r\n        {catalog && (\r\n          <Route\r\n            exact\r\n            path={'/:nodeCode/search'}\r\n            render={({location}) => {\r\n              const query = new URLSearchParams(location.search).get(\"q\");\r\n              const filters =\r\n                (new URLSearchParams(location.search).get(\"c\") || \"\")\r\n                  .split(\"//\").filter(str => str.length > 0).map(decodeURIComponent)\r\n                  .map(filter => filter.split(\"/\")).filter(path => path.length > 0);\r\n\r\n              let filteredCatIds = [];\r\n              filters.forEach(filter => filter.forEach(id => filteredCatIds.push(id)));\r\n              filteredCatIds = [...new Set(filteredCatIds)];\r\n\r\n              if (query && query.length > 0) {\r\n\r\n                const datasetSatisfyQueryOrKeywords = ds =>\r\n                  (ds.title || \"\").toLowerCase().includes(query.toLowerCase()) ||\r\n                  !!ds.keywords?.find(keyword => keyword.toLowerCase().includes(query.toLowerCase()));\r\n\r\n                const categorySatisfyFilters = cat => filteredCatIds.length === 0 || filteredCatIds.includes(cat.id);\r\n\r\n                const datasetsSatisfyQueryOrKeywords = [];\r\n                const datasetsSatisfyFilters = [];\r\n\r\n                // uncategorized datasets\r\n                if (catalog.uncategorizedDatasets && catalog.uncategorizedDatasets.length > 0) {\r\n                  catalog.uncategorizedDatasets\r\n                    .map(ds => ({\r\n                      ...ds,\r\n                      categoryPath: [\"uncategorized\"]\r\n                    }))\r\n                    .filter(datasetSatisfyQueryOrKeywords)\r\n                    .forEach(ds => {\r\n                      datasetsSatisfyQueryOrKeywords.push(ds);\r\n                      if (filteredCatIds.length === 0 || filteredCatIds.includes(\"uncategorized\")) {\r\n                        datasetsSatisfyFilters.push(ds);\r\n                      }\r\n                    });\r\n                }\r\n\r\n                const searchRecursive = (categories, categoryPath, parentCategorySatisfyFilters) => {\r\n\r\n                  categories.forEach(c => {\r\n\r\n                    const catSatisfyFilters =\r\n                      filteredCatIds.length === 0 ||\r\n                      parentCategorySatisfyFilters ||\r\n                      categorySatisfyFilters(c);\r\n\r\n                    c.datasetIdentifiers\r\n                      .map(id => ({\r\n                        ...catalog.datasets[id],\r\n                        identifier: id\r\n                      }))\r\n                      .filter(datasetSatisfyQueryOrKeywords)\r\n                      .map(ds => ({\r\n                        ...ds,\r\n                        categoryPath: [...categoryPath, c.id]\r\n                      }))\r\n                      .forEach(ds => {\r\n                        datasetsSatisfyQueryOrKeywords.push(ds);\r\n\r\n                        if (catSatisfyFilters) {\r\n                          datasetsSatisfyFilters.push(ds);\r\n                        }\r\n                      });\r\n\r\n                    searchRecursive(c.childrenCategories, [...categoryPath, c.id], catSatisfyFilters);\r\n                  });\r\n                };\r\n\r\n                if (catalog.categoryGroups.length > 1) {\r\n                  catalog.categoryGroups.map(group =>\r\n                    searchRecursive(\r\n                      group.categories,\r\n                      [group.id],\r\n                      filteredCatIds.length === 0 || filteredCatIds.includes(group.id)\r\n                    ));\r\n                } else if (catalog.categoryGroups.length === 1) {\r\n                  searchRecursive(catalog.categoryGroups[0].categories, [], false);\r\n                }\r\n\r\n                // for each category, count datasets which satisfy query or keywords in the subtree of that category\r\n\r\n                const datasetsSatisfyQueryOrKeywordsMap = {};\r\n                datasetsSatisfyQueryOrKeywords.forEach(ds => datasetsSatisfyQueryOrKeywordsMap[ds.identifier] = ds);\r\n\r\n                const recursiveCountAndFilterZero = tree => tree.map(node => {\r\n\r\n                  const children = recursiveCountAndFilterZero(node.childrenCategories || node.categories).filter(({count}) => count > 0);\r\n\r\n                  return ({\r\n                    ...node,\r\n                    childrenCategories: node.childrenCategories ? children : undefined,\r\n                    categories: node.categories ? children : undefined,\r\n                    count:\r\n                      children.reduce((acc, node) => acc + node.count, 0) +\r\n                      (node.datasetIdentifiers?.filter(dsId => datasetsSatisfyQueryOrKeywordsMap[dsId] !== undefined).length || 0)\r\n                  });\r\n                }).filter(({count}) => count > 0);\r\n\r\n                const categoryGroupsWithCount = recursiveCountAndFilterZero(catalog.categoryGroups);\r\n\r\n                const uncategorizedDatasetsCount = catalog.uncategorizedDatasets.filter(({identifier}) => datasetsSatisfyQueryOrKeywordsMap[identifier] !== undefined).length;\r\n\r\n                // remove duplicates from datasetsSatisfyFilters ( O(2n) )\r\n                const datasetsSatisfyFiltersMap = {};\r\n                datasetsSatisfyFilters.forEach(ds => {\r\n                  datasetsSatisfyFiltersMap[ds.identifier] = ds\r\n                });\r\n                const uniqueDatasets = Object.keys(datasetsSatisfyFiltersMap).map(id => datasetsSatisfyFiltersMap[id]);\r\n\r\n                return (\r\n                  <Results query={query}\r\n                           filters={filters}\r\n                           filtered\r\n                           hub={hub}\r\n                           node={node}\r\n                           nodeCode={nodeCode}\r\n                           catalog={catalog}\r\n                           datasets={uniqueDatasets}\r\n                           categoryGroupsWithCount={categoryGroupsWithCount}\r\n                           uncategorizedDatasetsCount={uncategorizedDatasetsCount}\r\n                  />\r\n                );\r\n              } else {\r\n                return \"Not found\";\r\n              }\r\n            }}\r\n          />\r\n        )}\r\n        {catalog && (\r\n          <Route\r\n            path={'/:nodeCode/:path'}\r\n            render={({match}) => <Recursive match={match} path={[match.params.path]}/>}\r\n          />\r\n        )}\r\n      </Switch>\r\n    </Fragment>\r\n  )\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(NodeDomain);","import React, {Fragment, useEffect} from 'react';\r\nimport {Route, Switch} from \"react-router\";\r\nimport Home from \"../components/home\";\r\nimport {connect} from \"react-redux\";\r\nimport {fetchHub} from \"../state/hub/hubActions\";\r\nimport NodeDomain from \"./NodeDomain\";\r\nimport {HashRouter} from \"react-router-dom\";\r\nimport DashboardsDomain from \"./DashboardsDomain\";\r\n\r\nconst mapStateToProps = state => ({\r\n  hub: state.hub\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  fetchHub: () => dispatch(fetchHub())\r\n});\r\n\r\nconst HubDomain = ({hub, fetchHub}) => {\r\n\r\n  useEffect(() => {\r\n    if (!hub) {\r\n      fetchHub();\r\n    }\r\n  }, [hub, fetchHub]);\r\n\r\n  return (\r\n    <Fragment>\r\n      {hub && (\r\n        <HashRouter>\r\n          <Switch>\r\n            <Route path='/' exact render={props => <Home {...props} hub={hub}/>}/>\r\n            <Route\r\n              path='/dashboards'\r\n              exact\r\n              render={props => <DashboardsDomain {...props} hub={hub}/>}\r\n            />\r\n            <Route\r\n              path='/dashboards/:dashboardId'\r\n              render={props => <DashboardsDomain {...props} hub={hub} dashboardId={props.match.params.dashboardId}/>}\r\n            />\r\n            <Route path='/:nodeCode'\r\n                   render={props =>\r\n                     <NodeDomain\r\n                       {...props}\r\n                       hub={hub}\r\n                       nodeCode={props.match.params.nodeCode}\r\n                     />\r\n                   }\r\n            />\r\n          </Switch>\r\n        </HashRouter>\r\n      )}\r\n    </Fragment>\r\n  );\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(HubDomain);\r\n","import React from 'react';\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport {DialogActions} from \"@material-ui/core\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport {connect} from \"react-redux\";\r\nimport {closeDeleteConflictModal} from \"../../state/delete-conflict-modal/deleteConflictModalActions\";\r\nimport {useTranslation} from \"react-i18next\";\r\n\r\nconst getObjectTranslation = t => ({\r\n  dashboard: t(\"components.deleteConflictModal.objectType.dashboard\"),\r\n  view: t(\"components.deleteConflictModal.objectType.view\"),\r\n  node: t(\"components.deleteConflictModal.objectType.node\"),\r\n});\r\n\r\nconst DeleteConflictModal = ({\r\n                               response,\r\n                               onClose,\r\n                               onForce\r\n                             }) => {\r\n\r\n  const {t} = useTranslation();\r\n\r\n  return (\r\n    <Dialog\r\n      open={!!response}\r\n      disableEscapeKeyDown\r\n      disableBackdropClick\r\n      maxWidth=\"xs\"\r\n      fullWidth\r\n      onClose={onClose}\r\n    >\r\n      <DialogTitle>\r\n        {t(\"components.deleteConflictModal.title\")}\r\n      </DialogTitle>\r\n      {response?.usedBy?.length > 0 && (\r\n        <DialogContent>\r\n          {onForce\r\n            ? <p>{t(\"components.deleteConflictModal.contentTitleWithForce\")}</p>\r\n            : <p>{t(\"components.deleteConflictModal.contentTitle\")}</p>\r\n          }\r\n          <div>\r\n            {response.usedBy.map(({type, title, id}, index) =>\r\n              <ul key={index}>{getObjectTranslation(t)[type]} {id} - {title}</ul>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      )}\r\n      <DialogActions>\r\n        <Button onClick={onClose}>\r\n          {t(\"commons.confirm.close\")}\r\n        </Button>\r\n        {onForce && (\r\n          <Button onClick={onForce}>\r\n            {t(\"components.deleteConflictModal.force\")}\r\n          </Button>\r\n        )}\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default connect(\r\n  state => ({\r\n    response: state.deleteConflictModal.response\r\n  }),\r\n  dispatch => ({\r\n    onClose: () => dispatch(closeDeleteConflictModal())\r\n  })\r\n)(DeleteConflictModal);","export const DELETE_CONFLICT_MODAL_CLOSE = \"deleteConflictModal/close\";\r\n\r\nexport const closeDeleteConflictModal = () => ({\r\n    type: DELETE_CONFLICT_MODAL_CLOSE\r\n});","import React from 'react';\r\nimport {ThemeProvider} from \"@material-ui/core/styles\";\r\nimport {createMuiTheme, CssBaseline} from \"@material-ui/core\";\r\nimport NotImplementedSnackbar from \"./components/not-implemented-snackbar/NotImplementedSnackbar\";\r\nimport Spinner from \"./components/spinner/Spinner\";\r\nimport ErrorSnackbar from \"./components/error-snackbar/ErrorSnackbar\";\r\nimport HubDomain from \"./domains/HubDomain\";\r\nimport Helmet from \"react-helmet\";\r\nimport {connect} from \"react-redux\";\r\nimport DeleteConflictModal from \"./components/delete-conflict-modal\";\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    text: {\r\n      primary: \"#00295a\"\r\n    },\r\n    primary: {\r\n      main: \"#00295a\",\r\n      light: \"#3b5187\",\r\n      dark: \"#000030\",\r\n      contrastText: \"#ffffff\"\r\n    },\r\n    secondary: {\r\n      main: \"#f8a81e\",\r\n      light: \"#ffd956\",\r\n      dark: \"#c07900\",\r\n      contrastText: \"#00295a\"\r\n    }\r\n  }\r\n});\r\n\r\nconst App = ({language}) =>\r\n  <ThemeProvider theme={theme}>\r\n    <Helmet>\r\n      <html lang={language}/>\r\n    </Helmet>\r\n    <CssBaseline/>\r\n    <Spinner>\r\n      <NotImplementedSnackbar/>\r\n      <ErrorSnackbar/>\r\n      <DeleteConflictModal/>\r\n      <HubDomain/>\r\n    </Spinner>\r\n  </ThemeProvider>;\r\n\r\nexport default connect(state => ({\r\n  language: state.app.language\r\n}))(App);","import {Reducer} from \"@reduxjs/toolkit\";\r\nimport {IHub} from \"../../model/IHub\";\r\nimport {IHubMinimalNode} from \"../../model/IHubMinimalNode\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {HUB_FETCH} from \"./hubActions\";\r\n\r\nexport type HubState = {\r\n  hub: IHub,\r\n  nodes: IHubMinimalNode[]\r\n} | null;\r\n\r\nconst hubReducer: Reducer<HubState> = (\r\n  state: HubState = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case HUB_FETCH: {\r\n          return ({\r\n            hub: action.payload.response.hub,\r\n            nodes: action.payload.response.nodes\r\n          });\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default hubReducer;","import {IHubNode} from \"../../model/IHubNode\";\r\nimport {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {NODE_FETCH} from \"./nodeActions\";\r\n\r\nexport type NodeState = IHubNode | null;\r\n\r\nconst nodeReducer: Reducer<NodeState> = (\r\n  state = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODE_FETCH: {\r\n          return action.payload.response;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodeReducer;","import {ICategoryProvider} from \"./ICategoryProvider\";\r\nimport {IFilter} from \"./IFilter\";\r\nimport {ICategoryGroup} from \"./ICategoryGroup\";\r\nimport {ICategory} from \"./ICategory\";\r\nimport {IDataset} from \"./IDataset\";\r\n\r\nexport class LocalCategoryProvider implements ICategoryProvider {\r\n\r\n  categoryGroups: Array<ICategoryGroup>;\r\n\r\n  datasets: Map<String, IDataset>;\r\n\r\n  uncategorizedDatasets: IDataset[];\r\n\r\n  constructor(categories: Array<ICategoryGroup>, datasets: Map<String, IDataset>, uncategorizedDatasets: IDataset[] = []) {\r\n    this.datasets = datasets || {};\r\n    this.categoryGroups = categories || [];\r\n    this.uncategorizedDatasets = uncategorizedDatasets || [];\r\n  }\r\n\r\n  searchCategories(filter?: IFilter): Array<ICategory> {\r\n\r\n    let result: Array<ICategory> = [];\r\n\r\n    let searchText: string;\r\n    if (filter) {\r\n      searchText = filter.text.toLowerCase();\r\n    }\r\n\r\n    this.categoryGroups.forEach(categ => {\r\n\r\n      if (!searchText) {\r\n        result.push(...categ.categories);\r\n      } else {\r\n        categ.categories.forEach(category => {\r\n          let matchFound: boolean = category.label.toLowerCase().indexOf(searchText) >= 0;\r\n\r\n          if (matchFound) {\r\n            result.push(category);\r\n          }\r\n        });\r\n      }\r\n    });\r\n\r\n    return result;\r\n  }\r\n\r\n  searchDataset(filter?: IFilter): IDataset[] {\r\n    return [];\r\n  }\r\n}","import {ReducersMapObject} from \"redux\";\r\nimport hubReducer from \"./hub/hubReducer\";\r\nimport nodeReducer from \"./node/nodeReducer\";\r\nimport catalogReducer from \"./catalog/catalogReducer\";\r\nimport datasetReducer from \"./dataset/datasetReducer\";\r\nimport appReducer from \"./app/appReducer\";\r\nimport hubConfigReducer from \"./hubConfig/hubConfigReducer\";\r\nimport spinnerReducer from \"./spinner/spinnerReducer\";\r\nimport appConfigReducer from \"./appConfig/appConfigReducer\";\r\nimport nodesConfigReducer from \"./nodesConfig/nodesConfigReducer\";\r\nimport cacheReducer from \"./cache/cacheReducer\";\r\nimport otherConfigReducer from \"./otherConfig/otherConfigReducer\";\r\nimport nodeTemplatesConfigReducer from \"./noteTemplatesConfig/nodeTemplatesConfigReducer\";\r\nimport userReducer from './user/userReducer';\r\nimport usersConfigReducer from \"./usersConfig/usersConfigReducer\";\r\nimport dashboardReducer from \"./dashboard/dashboardReducer\";\r\nimport nodePermissionsConfigReducer from './nodePermissionsConfig/nodePermissionsConfigReducer';\r\nimport deleteConflictModalReducer from './delete-conflict-modal/deleteConflictModalReducer';\r\n\r\nconst rootReducer: ReducersMapObject = ({\r\n  spinner: spinnerReducer,\r\n  config: appConfigReducer,\r\n  app: appReducer,\r\n  hub: hubReducer,\r\n  node: nodeReducer,\r\n  nodeTemplatesConfig: nodeTemplatesConfigReducer,\r\n  catalog: catalogReducer,\r\n  dataset: datasetReducer,\r\n  hubConfig: hubConfigReducer,\r\n  nodesConfig: nodesConfigReducer,\r\n  cacheConfig: cacheReducer,\r\n  otherConfig: otherConfigReducer,\r\n  user: userReducer,\r\n  usersConfig: usersConfigReducer,\r\n  dashboard: dashboardReducer,\r\n  nodePermissionsConfig: nodePermissionsConfigReducer,\r\n  deleteConflictModal: deleteConflictModalReducer\r\n});\r\n\r\nexport default rootReducer;","import {Reducer} from \"redux\";\r\nimport {\r\n  SPINNER_FLUSH,\r\n  SPINNER_MESSAGE_ADD,\r\n  SPINNER_MESSAGE_REMOVE,\r\n  SPINNER_TIMEOUT_CLEAR,\r\n  SPINNER_TIMEOUT_SET\r\n} from \"./spinnerActions\";\r\n\r\nexport type SpinnerState = {\r\n  messages: any[],\r\n  timeout: any\r\n};\r\n\r\nconst spinnerReducer: Reducer<SpinnerState> = (\r\n  state = {\r\n    messages: [],\r\n    timeout: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case SPINNER_MESSAGE_ADD: {\r\n      return {\r\n        ...state,\r\n        messages: [...state.messages, ({uid: action.payload.uid, message: action.payload.message, removed: false})]\r\n      };\r\n    }\r\n    case SPINNER_MESSAGE_REMOVE: {\r\n      return {\r\n        ...state,\r\n        messages: [\r\n          ...state.messages.map(message => message.uid !== action.payload.uid ? message : ({...message, removed: true, isError: action.payload.isError}))\r\n        ]\r\n      };\r\n    }\r\n    case SPINNER_TIMEOUT_SET: {\r\n      return {\r\n        ...state,\r\n        timeout: action.payload.timeout\r\n      };\r\n    }\r\n    case SPINNER_TIMEOUT_CLEAR: {\r\n      return {\r\n        ...state,\r\n        timeout: null\r\n      };\r\n    }\r\n    case SPINNER_FLUSH: {\r\n      if (state.timeout) {\r\n        clearTimeout(state.timeout);\r\n      }\r\n      return {\r\n        ...state,\r\n        timeout: null,\r\n        messages: []\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default spinnerReducer;","import {Reducer} from \"redux\";\r\nimport {INIT} from '../rootActions';\r\n\r\nexport type AppConfigState = {\r\n  baseURL: string\r\n} | null;\r\n\r\nconst appConfigReducer: Reducer<AppConfigState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n  switch (action.type) {\r\n    case INIT: {\r\n      return {\r\n        baseURL: action.payload.baseURL\r\n      };\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default appConfigReducer;","import {Reducer} from \"redux\";\r\nimport {APP_LANGUAGE_SET} from \"./appActions\";\r\nimport {INIT} from '../rootActions';\r\nimport {PERSISTENCE_ACTION_KEY} from '../../middlewares/persistence/middleware';\r\nimport _ from \"lodash\";\r\n\r\nexport type AppState = {\r\n    language: string,\r\n    languages: string[]\r\n} | null\r\n    ;\r\nconst appReducer: Reducer<AppState> = (\r\n    state = null,\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case INIT:\r\n            const initialState = {\r\n                language: action.payload.defaultLanguage,\r\n                languages: action.payload.supportedLanguages\r\n            };\r\n            return _.merge(initialState, action.payload[PERSISTENCE_ACTION_KEY].app) || initialState;\r\n        case APP_LANGUAGE_SET: {\r\n            return {\r\n                ...state,\r\n                language: action.payload.language\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default appReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {NODE_TEMPLATES_CONFIG_CLEAR, NODE_TEMPLATES_CONFIG_FETCH} from \"./nodeTemplatesConfigActions\";\r\n\r\nexport type NodesConfigState = {\r\n  templates: any[] | null\r\n};\r\n\r\nconst nodeTemplatesConfigReducer: Reducer<NodesConfigState> = (\r\n  state = {\r\n    templates: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODE_TEMPLATES_CONFIG_CLEAR: {\r\n      return {\r\n        ...state,\r\n        templates: null\r\n      };\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODE_TEMPLATES_CONFIG_FETCH: {\r\n          return {\r\n            ...state,\r\n            templates: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodeTemplatesConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {CATALOG_FETCH} from \"./catalogActions\";\r\nimport {ICategoryProvider} from \"../../model/ICategoryProvider\";\r\nimport {LocalCategoryProvider} from \"../../model/LocalCategoryProvider\";\r\n\r\nexport type CatalogState = ICategoryProvider | null;\r\n\r\nconst catalogReducer: Reducer<CatalogState> = (\r\n  state = null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case CATALOG_FETCH: {\r\n          return null;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case CATALOG_FETCH: {\r\n          return new LocalCategoryProvider(\r\n            action.payload.response.categoryGroups,\r\n            action.payload.response.datasetMap,\r\n            action.payload.response.datasetUncategorized\r\n          );\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default catalogReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  HUB_CONFIG_CLEAR,\r\n  HUB_CONFIG_DASHBOARDS_CLEAR,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n  HUB_CONFIG_DASHBOARDS_FETCH,\r\n  HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n  HUB_CONFIG_FETCH,\r\n  HUB_CONFIG_SEND,\r\n  HUB_CONFIG_DASHBOARDS_CLEAR_ALL,\r\n  HUB_CONFIG_DASHBOARDS_FETCH_ALL\r\n} from \"./hubConfigActions\";\r\n\r\nexport type HubConfigState = {\r\n  hub: any | null,\r\n  hubDashboards: any[] | null,\r\n  allDashboards: any[] | null\r\n};\r\n\r\nconst hubConfigReducer: Reducer<HubConfigState> = (\r\n    state = {\r\n      hub: null,\r\n      hubDashboards: null,\r\n      allDashboards: null\r\n    },\r\n    action\r\n) => {\r\n  switch (action.type) {\r\n    case HUB_CONFIG_CLEAR: {\r\n      return {\r\n        ...state,\r\n        hub: null\r\n      };\r\n    }\r\n    case HUB_CONFIG_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        hubDashboards: null\r\n      };\r\n    }\r\n    case HUB_CONFIG_DASHBOARDS_CLEAR_ALL: {\r\n      return {\r\n        ...state,\r\n        allDashboards: null\r\n      };\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case HUB_CONFIG_FETCH: {\r\n          return {\r\n            ...state,\r\n            hub: action.payload.response[0]\r\n          }\r\n        }\r\n        case HUB_CONFIG_SEND: {\r\n          return {\r\n            ...state,\r\n            hub: null,\r\n            hubDashboards: null\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            hubDashboards: action.payload.response\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_FETCH_ALL: {\r\n          return {\r\n            ...state,\r\n            allDashboards: action.payload.response\r\n          };\r\n        }\r\n        case HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD:\r\n          return {\r\n            ...state,\r\n            allDashboards: null,\r\n            hubDashboards: null\r\n          };\r\n        case HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE:\r\n        case HUB_CONFIG_DASHBOARDS_ORDERS_SEND:\r\n          return {\r\n            ...state,\r\n            hubDashboards: null\r\n          }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default hubConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_START, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  NODES_CONFIG_NODE_CLEAR,\r\n  NODES_CONFIG_NODE_CREATE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_CLEAR,\r\n  NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_FETCH,\r\n  NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL,\r\n  NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n  NODES_CONFIG_NODE_EDIT,\r\n  NODES_CONFIG_NODE_FETCH,\r\n  NODES_CONFIG_NODES_CLEAR,\r\n  NODES_CONFIG_NODES_FETCH\r\n} from \"./nodesConfigActions\";\r\nimport {IHubNode} from \"../../model/IHubNode\";\r\n\r\nexport type NodesConfigState = {\r\n  nodes: IHubNode[] | null,\r\n  node: IHubNode | null,\r\n  nodeDashboards: any[] | null,\r\n  allDashboards: any[] | null\r\n};\r\n\r\nconst nodesConfigReducer: Reducer<NodesConfigState> = (\r\n  state = {\r\n    nodes: null,\r\n    node: null,\r\n    nodeDashboards: null,\r\n    allDashboards: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case NODES_CONFIG_NODES_CLEAR: {\r\n      return {\r\n        ...state,\r\n        nodes: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_CLEAR: {\r\n      return {\r\n        ...state,\r\n        node: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        nodeDashboards: null\r\n      };\r\n    }\r\n    case NODES_CONFIG_NODE_DASHBOARDS_CLEAR_ALL: {\r\n      return {\r\n        ...state,\r\n        allDashboards: null\r\n      };\r\n    }\r\n    case REQUEST_START: {\r\n      switch (action.payload.label) {\r\n        case NODES_CONFIG_NODE_EDIT: {\r\n          return {\r\n            ...state,\r\n            node: null\r\n          };\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case NODES_CONFIG_NODES_FETCH: {\r\n          return {\r\n            ...state,\r\n            nodes: action.payload.response\r\n          };\r\n        }\r\n        case NODES_CONFIG_NODE_FETCH: {\r\n          return {\r\n            ...state,\r\n            node: action.payload.response\r\n          }\r\n        }\r\n        case NODES_CONFIG_NODE_CREATE:\r\n        case NODES_CONFIG_NODE_EDIT:\r\n          return {\r\n            ...state,\r\n            node: null\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_FETCH:\r\n          return {\r\n            ...state,\r\n            nodeDashboards: action.payload.response\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_FETCH_ALL:\r\n          return {\r\n            ...state,\r\n            allDashboards: action.payload.response\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD:\r\n          return {\r\n            ...state,\r\n            allDashboards: null,\r\n            nodeDashboards: null\r\n          };\r\n        case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE:\r\n        case NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND:\r\n          return {\r\n            ...state,\r\n            nodeDashboards: null\r\n          }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default nodesConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {IDataflowCache} from \"../../model/IDataflowCache\";\r\nimport {\r\n  DATAFLOW_CACHE_CLEAR,\r\n  DATAFLOW_CACHE_CREATE,\r\n  DATAFLOW_CACHE_DELETE,\r\n  DATAFLOW_CACHE_FETCH,\r\n  DATAFLOW_CACHE_UPDATE\r\n} from \"./cacheActions\";\r\n\r\nexport type DataflowCacheState =  IDataflowCache[] | null;\r\n\r\nconst cacheReducer: Reducer<DataflowCacheState> = (\r\n  state =  null,\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case DATAFLOW_CACHE_FETCH: {\r\n          return action.payload.response;\r\n        }\r\n        case DATAFLOW_CACHE_UPDATE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.id === action.payload.extra.cacheId && e.nodeId === action.payload.extra.nodeId) {\r\n                  e.ttl = action.payload.extra.ttl;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        case DATAFLOW_CACHE_CREATE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.dataflowId === action.payload.extra.oldData.dataflowId && e.nodeId === action.payload.extra.oldData.nodeId) {\r\n                  e.ttl = action.payload.response.ttl;\r\n                  e.id = action.payload.response.id;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        case DATAFLOW_CACHE_DELETE: {\r\n          const newState = (state || []).map((e:IDataflowCache) => {\r\n                if(e.id === action.payload.extra.cacheId && e.nodeId === action.payload.extra.nodeId) {\r\n                  e.cacheSize = 0;\r\n                  e.cachedDataflow = 0;\r\n                }\r\n                return e;\r\n              }\r\n          );\r\n          return newState\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_ERROR: {\r\n      switch (action.payload.label) {\r\n        case DATAFLOW_CACHE_FETCH: {\r\n          return null;\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case DATAFLOW_CACHE_CLEAR: {\r\n      return null;\r\n    }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default cacheReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_ERROR, REQUEST_INIT, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n  OTHER_CONFIG_DASHBOARD_CHANGE,\r\n  OTHER_CONFIG_DASHBOARD_CREATE,\r\n  OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT,\r\n  OTHER_CONFIG_DASHBOARD_DATASET_CLEAR,\r\n  OTHER_CONFIG_DASHBOARD_DATASET_FETCH,\r\n  OTHER_CONFIG_DASHBOARD_DELETE,\r\n  OTHER_CONFIG_DASHBOARD_HIDE,\r\n  OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE,\r\n  OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT,\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR,\r\n  OTHER_CONFIG_DASHBOARD_VIEWS_FETCH,\r\n  OTHER_CONFIG_DASHBOARDS_CLEAR,\r\n  OTHER_CONFIG_DASHBOARDS_FETCH,\r\n  OTHER_CONFIG_VIEW_DELETE,\r\n  OTHER_CONFIG_VIEWS_CLEAR,\r\n  OTHER_CONFIG_VIEWS_FETCH\r\n} from \"./otherConfigActions\";\r\nimport _ from \"lodash\"\r\nimport {DASHBOARD_VIEW_STATE_ERROR, DASHBOARD_VIEW_STATE_FETCHING} from \"../dashboard/dashboardReducer\";\r\n\r\nexport type OtherConfigState = {\r\n  views: any[] | null,\r\n  needDashboards: boolean,\r\n  dashboards: any[] | null,\r\n  dashboard: any[] | null,\r\n  dashboardViews: any[] | null,\r\n  dashboardJsonStats: any,\r\n  dashboardMaps: any,\r\n};\r\n\r\nconst otherConfigReducer: Reducer<OtherConfigState> = (\r\n  state = {\r\n    views: null,\r\n    needDashboards: false,\r\n    dashboards: null,\r\n    dashboard: null,\r\n    dashboardViews: null,\r\n    dashboardJsonStats: null,\r\n    dashboardMaps: null\r\n  },\r\n  action\r\n) => {\r\n  switch (action.type) {\r\n    case OTHER_CONFIG_VIEWS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        views: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_VIEWS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboardViews: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARDS_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboards: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_CREATE: {\r\n      return {\r\n        ...state,\r\n        dashboard: action.payload.dashboard\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_CHANGE: {\r\n      return {\r\n        ...state,\r\n        dashboard: action.payload.dashboard\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_HIDE: {\r\n      return {\r\n        ...state,\r\n        dashboard: null\r\n      };\r\n    }\r\n    case OTHER_CONFIG_DASHBOARD_DATASET_CLEAR: {\r\n      return {\r\n        ...state,\r\n        dashboardJsonStats: null,\r\n        dashboardMaps: null\r\n      };\r\n    }\r\n    case REQUEST_INIT: {\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            needDashboards: false\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: DASHBOARD_VIEW_STATE_FETCHING\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_SUCCESS: {\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_VIEWS_FETCH: {\r\n          return {\r\n            ...state,\r\n            views: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_VIEWS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboardViews: action.payload.response.map((v: any) => ({\r\n              ...v,\r\n              datasetId: v.datasetId ? v.datasetId.split(\"+\").join(\",\") : undefined\r\n            }))\r\n          };\r\n        }\r\n        case OTHER_CONFIG_VIEW_DELETE: {\r\n          return {\r\n            ...state,\r\n            views: null\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboards: action.payload.response\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_UPDATE: {\r\n          return {\r\n            ...state,\r\n            dashboard: {\r\n              ...action.payload.response,\r\n              dashboardConfig: action.payload.response?.dashboardConfig\r\n                ? JSON.parse(action.payload.response.dashboardConfig)\r\n                : {},\r\n              filterLevels: action.payload.response?.filterLevels\r\n                ? JSON.parse(action.payload.response.filterLevels)\r\n                : {}\r\n            }\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DELETE:\r\n        case OTHER_CONFIG_DASHBOARD_CREATE_SUBMIT:\r\n        case OTHER_CONFIG_DASHBOARD_UPDATE_SUBMIT: {\r\n          return {\r\n            ...state,\r\n            needDashboards: true\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n          const jsonStat = (action.payload.response?.id || []).length > 0\r\n            ? action.payload.response\r\n            : \"\";\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: jsonStat\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats\r\n          }\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_MAP_GEOMETRY_FETCH: {\r\n          const detailLevels = action.payload.response\r\n            .map((val: any, idx: number) => val.nutsLevel)\r\n            .reduce((acc: any, val: any) => {\r\n              if (!acc[val]) {\r\n                const label = \"Nuts level \" + val;\r\n                acc[val] = {level: val, counter: 0, label: label};\r\n              }\r\n              acc[val].counter++;\r\n              return acc;\r\n            }, []);\r\n\r\n          return {\r\n            ...state,\r\n            dashboardMaps: {\r\n              ...state.dashboardMaps,\r\n              [action.payload.extra.requestId]: {\r\n                geometries: action.payload.response,\r\n                geometryDetailLevels: detailLevels\r\n              }\r\n            }\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    }\r\n    case REQUEST_ERROR:\r\n      switch (action.payload.label) {\r\n        case OTHER_CONFIG_DASHBOARDS_FETCH: {\r\n          return {\r\n            ...state,\r\n            dashboards: action.payload.statusCode === 404 ? [] : null\r\n          };\r\n        }\r\n        case OTHER_CONFIG_DASHBOARD_DATASET_FETCH: {\r\n          let jsonStats = _.cloneDeep(state.dashboardJsonStats);\r\n\r\n          (action.payload.extra.requestIds || []).forEach((id: string) => {\r\n            jsonStats = {\r\n              ...jsonStats,\r\n              [id]: DASHBOARD_VIEW_STATE_ERROR\r\n            }\r\n          });\r\n\r\n          return {\r\n            ...state,\r\n            dashboardJsonStats: jsonStats\r\n          }\r\n        }\r\n        default:\r\n          return state;\r\n      }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default otherConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_START, REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    USERS_CONFIG_USER_CLEAR,\r\n    USERS_CONFIG_USER_CREATE,\r\n    USERS_CONFIG_USER_EDIT,\r\n    USERS_CONFIG_USER_FETCH,\r\n    USERS_CONFIG_USERS_CLEAR,\r\n    USERS_CONFIG_USERS_FETCH,\r\n    USER_CONFIG_FORM_SHOW, USER_CONFIG_FORM_HIDE\r\n} from \"./usersConfigActions\";\r\n\r\nexport type User = {\r\n\r\n};\r\n\r\nexport type UsersConfigState = {\r\n    users: User[] | null,\r\n    user: User | null,\r\n    userErrors: string[] | null,\r\n    userId: number | null\r\n};\r\n\r\nconst usersConfigReducer: Reducer<UsersConfigState> = (\r\n    state = {\r\n        users: null,\r\n        user: null,\r\n        userErrors: null,\r\n        userId: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case USER_CONFIG_FORM_SHOW:\r\n            return {\r\n                ...state,\r\n                userId: action.payload.userId\r\n            };\r\n        case USER_CONFIG_FORM_HIDE:\r\n            return {\r\n                ...state,\r\n                user: null,\r\n                userId: null,\r\n                userErrors: null\r\n            };\r\n        case USERS_CONFIG_USERS_CLEAR: {\r\n            return {\r\n                ...state,\r\n                users: null\r\n            };\r\n        }\r\n        case USERS_CONFIG_USER_CLEAR: {\r\n            return {\r\n                ...state,\r\n                user: null\r\n            };\r\n        }\r\n        case REQUEST_START: {\r\n            switch (action.payload.label) {\r\n                case USERS_CONFIG_USER_EDIT: {\r\n                    return {\r\n                        ...state,\r\n                        user: null\r\n                    };\r\n                }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case USERS_CONFIG_USERS_FETCH: {\r\n                    return {\r\n                        ...state,\r\n                        users: action.payload.response\r\n                    };\r\n                }\r\n                case USERS_CONFIG_USER_FETCH: {\r\n                    return {\r\n                        ...state,\r\n                        user: action.payload.response\r\n                    }\r\n                }\r\n                case USERS_CONFIG_USER_CREATE:\r\n                case USERS_CONFIG_USER_EDIT:\r\n                    if (action.payload.response.haveError) {\r\n                        return {\r\n                            ...state,\r\n                            userErrors: action.payload.response.errors\r\n                        };\r\n                    } else {\r\n                        return {\r\n                            ...state,\r\n                            user: null,\r\n                            userErrors: null,\r\n                            userId: null\r\n                        };\r\n                    }\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default usersConfigReducer;","import {Reducer} from \"redux\";\r\nimport {REQUEST_SUCCESS} from \"../../middlewares/request/requestActions\";\r\nimport {\r\n    NODE_PERMISSIONS_CONFIG_CLEAR,\r\n    NODE_PERMISSIONS_CONFIG_FETCH,\r\n    NODE_PERMISSIONS_CONFIG_SEND\r\n} from './nodePermissionsConfigActions';\r\n\r\nexport type NodePermissionsConfigState = {\r\n    permissions: any[] | null\r\n};\r\n\r\nconst nodePermissionsConfigReducer: Reducer<NodePermissionsConfigState> = (\r\n    state = {\r\n        permissions: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case NODE_PERMISSIONS_CONFIG_CLEAR: {\r\n            return {\r\n                ...state,\r\n                permissions: null\r\n            };\r\n        }\r\n        case REQUEST_SUCCESS: {\r\n            switch (action.payload.label) {\r\n                case NODE_PERMISSIONS_CONFIG_FETCH: {\r\n                    return {\r\n                        state,\r\n                        permissions: action.payload.response\r\n                    };\r\n                }\r\n                case NODE_PERMISSIONS_CONFIG_SEND:\r\n                    return {permissions: null};\r\n                default:\r\n                    return state;\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default nodePermissionsConfigReducer;","import {Reducer} from 'redux';\r\nimport {REQUEST_ERROR, RequestMethod} from '../../middlewares/request/requestActions';\r\nimport {DELETE_CONFLICT_MODAL_CLOSE} from './deleteConflictModalActions';\r\n\r\ntype DeleteConflictModalState = {\r\n    response: any | null,\r\n    onForce: any | null\r\n};\r\n\r\nconst deleteConflictModalReducer: Reducer<DeleteConflictModalState> = (\r\n    state = {\r\n        response: null,\r\n        onForce: null\r\n    },\r\n    action\r\n) => {\r\n    switch (action.type) {\r\n        case REQUEST_ERROR:\r\n            if (action.payload.statusCode === 409 && action.payload.method === RequestMethod.DELETE) {\r\n                return {\r\n                    ...state,\r\n                    response: action.payload.response,\r\n                    onForce: action.payload.extra?.onDeleteConflictForce || null\r\n                };\r\n            } else {\r\n                return state;\r\n            }\r\n        case DELETE_CONFLICT_MODAL_CLOSE:\r\n            return {\r\n                ...state,\r\n                response: null,\r\n                onForce: null\r\n            };\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n\r\nexport default deleteConflictModalReducer;","import {clearUser, USER_REFRESH} from \"../../state/user/userActions\";\r\nimport {REQUEST_INIT, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {HUB_FETCH} from \"../../state/hub/hubActions\";\r\nimport {NODE_FETCH} from \"../../state/node/nodeActions\";\r\n\r\nconst userMiddlewareFactory = t => ({dispatch, getState}) => next => action => {\r\n\r\n  const state = getState();\r\n\r\n  let result;\r\n\r\n  // if a request is starting but auth token is expired\r\n  if (\r\n    action.type === REQUEST_INIT &&\r\n    action.payload.label !== HUB_FETCH &&\r\n    action.payload.label !== NODE_FETCH &&\r\n    action.payload.label !== USER_REFRESH &&\r\n    state.user.isAuthenticated &&\r\n    state.user.tokenReceivedTime !== null &&\r\n    state.user.tokenTTL !== null &&\r\n    new Date(new Date().getTime() - state.user.tokenReceivedTime).getMinutes()\r\n    >= state.user.tokenTTL - 1\r\n  ) {\r\n\r\n    /*\r\n      result = next(refreshUser()); // block current request dispatching, and replace it with token refresh request\r\n      dispatch(setUserDelayedRequestWhenTokenExpired(action)); // delay current (request) action\r\n    */\r\n\r\n    result = next(({type: \"NOP\"}));\r\n    if (window.error) {\r\n      window.error.show(`${t(\"middlewares.user.sessionExpired\")} <a href=\"./#/\">${t(\"middlewares.user.backToHome\")}</a>`);\r\n    }\r\n    dispatch(clearUser());\r\n\r\n  } else {\r\n\r\n    result = next(action); // do nothing, continue action dispatching as normal\r\n\r\n  }\r\n\r\n  // if sent token is expired (in some cases it can happen, even if i checked expiration in the previous code)\r\n  if (action.payload?.extra?.responseHeaders && action.payload.extra.responseHeaders[\"token-expired\"]) {\r\n    /*\r\n      dispatch(clearUser()); // init user state\r\n      dispatch(showUserLoginForm(\"Authentication is expired. Please log in again.\")); // show login form with alert\r\n     */\r\n\r\n    if (window.error) {\r\n      window.error.show(`${t(\"middlewares.user.sessionExpired\")} <a href=\"./#/\">${t(\"middlewares.user.backToHome\")}</a>`);\r\n    }\r\n    dispatch(clearUser());\r\n\r\n  }\r\n\r\n  // if token has been refreshed and delayed request is pending\r\n  if (action.type === REQUEST_SUCCESS && action.payload?.label === USER_REFRESH && state.user.delayedRequest) {\r\n    dispatch(state.user.delayedRequest); // dispatch pending (request) action\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport default userMiddlewareFactory;","import {errorRequest, REQUEST_INIT, RequestActionPayload, startRequest, successRequest} from './requestActions';\r\nimport axios, {AxiosResponse} from 'axios';\r\nimport {Middleware} from 'redux';\r\nimport {PayloadAction} from \"@reduxjs/toolkit\";\r\n\r\nconst requestMiddlewareFactory = (\r\n  options: {\r\n    onSuccess?: (requestAction: object, data?: any, extra?: any) => void,\r\n    onManagedServerError?: (requestAction: RequestActionPayload, statusCode: number, managedServerError: any) => void,\r\n    onGenericError?: (requestAction: RequestActionPayload, statusCode?: number) => void\r\n  }\r\n): Middleware =>\r\n  ({dispatch, getState}) => next => action => {\r\n\r\n    const handleSuccess = (requestAction: RequestActionPayload, response: AxiosResponse) => {\r\n\r\n      if (options.onSuccess) {\r\n        options.onSuccess(requestAction, response.data, {\r\n          responseHeaders: response.headers\r\n        });\r\n      }\r\n\r\n      dispatch(successRequest(requestAction, response.data, {\r\n        responseHeaders: response.headers,\r\n        status: response.status\r\n      }));\r\n    };\r\n\r\n    const handleManagedServerError = (requestAction: RequestActionPayload, response: AxiosResponse) => {\r\n\r\n      if (options.onManagedServerError && (!requestAction?.getHideErrorMessage || !requestAction.getHideErrorMessage(response?.status))) {\r\n        options.onManagedServerError(requestAction, response.status, response.data);\r\n      }\r\n\r\n        dispatch(errorRequest(requestAction, response.status, response.data, {responseHeaders: response.headers}));\r\n    };\r\n\r\n      const handleGenericError = (requestAction: RequestActionPayload, response?: AxiosResponse) => {\r\n\r\n          if (options.onGenericError && (!requestAction?.getHideErrorMessage || !requestAction.getHideErrorMessage(response?.status))) {\r\n              options.onGenericError(requestAction, response?.status);\r\n          }\r\n\r\n          dispatch(errorRequest(requestAction, response?.status, response?.data, {responseHeaders: response?.headers}));\r\n      };\r\n\r\n    const handleError = (requestAction: RequestActionPayload, response?: AxiosResponse) => {\r\n\r\n      if (response?.data) {\r\n\r\n          if (response.data.usedBy !== undefined) {\r\n              handleManagedServerError(requestAction, response);\r\n          } else {\r\n              handleGenericError(requestAction, response);\r\n          }\r\n      } else {\r\n          handleGenericError(requestAction, response);\r\n      }\r\n    };\r\n\r\n    const result = next(action);\r\n\r\n    if (action.type !== REQUEST_INIT) {\r\n      return result;\r\n    }\r\n\r\n      const requestAction: PayloadAction<RequestActionPayload> = action;\r\n\r\n      dispatch(startRequest(requestAction.payload));\r\n\r\n      let {\r\n          method,\r\n          url,\r\n          data,\r\n          baseURL\r\n      } = requestAction.payload;\r\n\r\n      const token = getState().user.token;\r\n\r\n      axios.request({\r\n          method,\r\n          url: ((baseURL && baseURL.length > 0) ? baseURL : getState().config.baseURL) + url,\r\n          data,\r\n          headers: {\r\n              \"UserLang\": getState().app.language,\r\n              \"Authorization\": token ? `bearer ${token}` : undefined\r\n          },\r\n          withCredentials: true\r\n      }).then((response: AxiosResponse) => {\r\n      if (response.status.toString()[0] === \"2\") {\r\n        handleSuccess(requestAction.payload, response);\r\n      } else {\r\n        handleError(requestAction.payload, response);\r\n      }\r\n    }).catch(error => {\r\n      console.log(error);\r\n      handleError(requestAction.payload, error.response);\r\n    });\r\n\r\n    return result;\r\n  };\r\n\r\nexport default requestMiddlewareFactory;\r\n","export const showGenericError = () => {\r\n  if (window && window.error) {\r\n    window.error.show(\"An error occurred while contacting the server.\");\r\n  }\r\n};\r\n\r\nexport const showTranslatedGenericErrorFactory = t => () => {\r\n  if (window && window.error) {\r\n    window.error.show(t(\"errors.generic\"));\r\n  }\r\n};","import {REQUEST_START, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {\r\n  fetchHubConfigDashboards,\r\n  HUB_CONFIG_CLOSE,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD,\r\n  HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE,\r\n  HUB_CONFIG_DASHBOARDS_ORDERS_SEND,\r\n  HUB_CONFIG_SEND\r\n} from \"../../state/hubConfig/hubConfigActions\";\r\nimport {fetchHub} from \"../../state/hub/hubActions\";\r\nimport {\r\n  fetchNodesConfigNodeDashboards,\r\n  fetchNodesConfigNodes,\r\n  NODES_CONFIG_CLOSE,\r\n  NODES_CONFIG_NODE_CREATE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD,\r\n  NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE,\r\n  NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND,\r\n  NODES_CONFIG_NODE_DELETE,\r\n  NODES_CONFIG_NODE_EDIT,\r\n  NODES_CONFIG_NODES_ORDER_SEND\r\n} from \"../../state/nodesConfig/nodesConfigActions\";\r\nimport {\r\n  fetchUsersConfigUsers,\r\n  USERS_CONFIG_USER_CREATE,\r\n  USERS_CONFIG_USER_DELETE,\r\n  USERS_CONFIG_USER_EDIT,\r\n} from \"../../state/usersConfig/usersConfigActions\";\r\nimport {goToHome} from \"../../links\";\r\nimport {\r\n  fetchOtherConfigViews,\r\n  OTHER_CONFIG_DASHBOARDS_CLOSE,\r\n  OTHER_CONFIG_VIEW_DELETE\r\n} from \"../../state/otherConfig/otherConfigActions\";\r\nimport {\r\n  fetchNodeTemplatesConfig,\r\n  NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE\r\n} from \"../../state/noteTemplatesConfig/nodeTemplatesConfigActions\";\r\nimport {\r\n  DATAFLOW_CACHE_DELETE_ALL,\r\n  DATAFLOW_CACHE_DELETE_CATALOG,\r\n  fetchDataflowCache\r\n} from \"../../state/cache/cacheActions\";\r\nimport {fetchCatalog} from \"../../state/catalog/catalogActions\";\r\nimport {fetchNode} from \"../../state/node/nodeActions\";\r\n\r\nconst configMiddleware = ({dispatch, getState}) => next => action => {\r\n\r\n  const state = getState();\r\n\r\n  const res = next(action);\r\n\r\n  if (action.type === REQUEST_START && action.payload.label === NODES_CONFIG_NODE_DELETE) {\r\n    if (state.node && state.node.nodeId === action.payload.extra?.nodeId) {\r\n      goToHome();\r\n    }\r\n  }\r\n\r\n  if (\r\n    action.type === NODES_CONFIG_CLOSE ||\r\n    action.type === HUB_CONFIG_CLOSE ||\r\n    action.type === OTHER_CONFIG_DASHBOARDS_CLOSE\r\n  ) {\r\n    dispatch(fetchHub());\r\n  } else if (action.type === REQUEST_SUCCESS) {\r\n    switch (action.payload.label) {\r\n      case HUB_CONFIG_SEND: {\r\n        window.location.reload();\r\n        break;\r\n      }\r\n      case HUB_CONFIG_DASHBOARDS_DASHBOARD_ADD:\r\n      case HUB_CONFIG_DASHBOARDS_DASHBOARD_REMOVE:\r\n      case HUB_CONFIG_DASHBOARDS_ORDERS_SEND: {\r\n        dispatch(fetchHubConfigDashboards());\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_ADD:\r\n      case NODES_CONFIG_NODE_DASHBOARDS_DASHBOARD_REMOVE:\r\n      case NODES_CONFIG_NODE_DASHBOARDS_ORDERS_SEND: {\r\n        dispatch(fetchNodesConfigNodeDashboards(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODES_ORDER_SEND: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_EDIT: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        if (state.node && state.node.nodeId === action.payload.extra.nodeId) {\r\n          dispatch(fetchNode(action.payload.extra.nodeId));\r\n        }\r\n        break;\r\n      }\r\n      case NODES_CONFIG_NODE_CREATE:\r\n      case NODES_CONFIG_NODE_DELETE: {\r\n        dispatch(fetchNodesConfigNodes());\r\n        break;\r\n      }\r\n      case USERS_CONFIG_USER_EDIT:\r\n      case USERS_CONFIG_USER_DELETE: {\r\n        if (!action.payload.response.haveError && !action.payload.extra?.isAnonymous) {\r\n          dispatch(fetchUsersConfigUsers());\r\n        }\r\n        break;\r\n      }\r\n      case USERS_CONFIG_USER_CREATE:\r\n        if (!action.payload.response.haveError && !action.payload.extra?.isAnonymous) {\r\n          dispatch(fetchUsersConfigUsers());\r\n        } else if (!action.payload.response.haveError && action.payload.extra?.isAnonymous) {\r\n          window.location.reload();\r\n        }\r\n        break;\r\n      case OTHER_CONFIG_VIEW_DELETE: {\r\n        dispatch(fetchOtherConfigViews());\r\n        break;\r\n      }\r\n      case NODE_TEMPLATES_CONFIG_TEMPLATE_DELETE: {\r\n        dispatch(fetchNodeTemplatesConfig(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case DATAFLOW_CACHE_DELETE_ALL: {\r\n        dispatch(fetchDataflowCache(action.payload.extra.nodeId));\r\n        break;\r\n      }\r\n      case DATAFLOW_CACHE_DELETE_CATALOG: {\r\n        if (state.node && state.node.nodeId === action.payload.extra.nodeId) {\r\n          dispatch(fetchCatalog(action.payload.extra.nodeId));\r\n        }\r\n        break;\r\n      }\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  return res;\r\n};\r\n\r\nexport default configMiddleware;","import {REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport FileSaver from \"file-saver\";\r\nimport {QUERY_LOG_DOWNLOAD} from \"../../components/settings-select/actions\";\r\nimport {DATASET_DOWNLOAD_SUBMIT} from \"../../state/dataset/datasetActions\";\r\n\r\nconst fileSaveMiddleware = () => next => action => {\r\n\r\n  const result = next(action);\r\n\r\n  if (action.type === REQUEST_SUCCESS && action.payload.extra.fileSave) {\r\n    if (\r\n      action.payload.label === QUERY_LOG_DOWNLOAD ||\r\n      action.payload.label === DATASET_DOWNLOAD_SUBMIT\r\n    ) {\r\n\r\n      let name = action.payload.extra.fileSave.name;\r\n\r\n      FileSaver.saveAs(\r\n        new Blob(\r\n          action.payload?.extra?.stringifyResponse\r\n            ? [JSON.stringify(action.payload.response, null, 2)]\r\n            : [action.payload.response],\r\n          {type: action.payload.extra.fileSave.type}\r\n        ),\r\n        name\r\n      )\r\n    }\r\n  }\r\n\r\n  return result;\r\n\r\n};\r\n\r\nexport default fileSaveMiddleware;\r\n","import {APP_LANGUAGE_SET} from \"../../state/app/appActions\";\r\nimport i18n from 'i18next';\r\nimport {INIT} from \"../../state/rootActions\";\r\nimport {PERSISTENCE_ACTION_KEY} from \"../persistence/middleware\";\r\n\r\nconst i18nMiddleware = ({getState}) => next => action => {\r\n\r\n  const res = next(action);\r\n\r\n  if (action.type === APP_LANGUAGE_SET) {\r\n    i18n.changeLanguage(action.payload.language, () => {\r\n      window.location.reload();\r\n    });\r\n  }\r\n\r\n  if (\r\n    action.type === INIT &&\r\n    action.payload[PERSISTENCE_ACTION_KEY]?.app?.language\r\n  ) {\r\n    if (getState().app.languages.includes(action.payload[PERSISTENCE_ACTION_KEY]?.app?.language)) {\r\n      i18n.changeLanguage(action.payload[PERSISTENCE_ACTION_KEY].app.language)\r\n    } else {\r\n\r\n    }\r\n  }\r\n\r\n  return res;\r\n\r\n};\r\n\r\nexport default i18nMiddleware;","import {REQUEST_ERROR, REQUEST_START, REQUEST_SUCCESS} from \"../request/requestActions\";\r\nimport {\r\n  addSpinnerMessage,\r\n  clearSpinnerTimeout,\r\n  flushSpinner,\r\n  markSpinnerMessage,\r\n  setSpinnerTimeout,\r\n  SPINNER_MESSAGE_ADD,\r\n  SPINNER_MESSAGE_REMOVE\r\n} from \"../../state/spinner/spinnerActions\";\r\n\r\nconst SPINNER_TIMEOUT = 1000;\r\n\r\nconst requestSpinnerMiddlewareFactory = t => ({dispatch, getState}) => next => action => {\r\n\r\n  if ((action.type === REQUEST_START || action.type === REQUEST_SUCCESS || action.type === REQUEST_ERROR) && action.payload.messages) {\r\n\r\n    const messages = action.payload.messages(t);\r\n\r\n    if (messages.onStart) {\r\n      if (action.type === REQUEST_START && !action.payload.hideSpinner) {\r\n        dispatch(addSpinnerMessage(action.payload.uuid, messages.onStart));\r\n      } else if (action.type === REQUEST_SUCCESS && !action.payload.response?.haveError) {\r\n        dispatch(markSpinnerMessage(action.payload.uuid));\r\n      } else if (action.type === REQUEST_ERROR || (action.type === REQUEST_SUCCESS && action.payload.response?.haveError)) {\r\n        dispatch(markSpinnerMessage(action.payload.uuid, true));\r\n      }\r\n    }\r\n  }\r\n\r\n  const result = next(action);\r\n\r\n  const spinnerState = getState().spinner;\r\n\r\n  if (action.type === SPINNER_MESSAGE_ADD) {\r\n    if (spinnerState.timeout) {\r\n      clearTimeout(spinnerState.timeout);\r\n      dispatch(clearSpinnerTimeout());\r\n    }\r\n  } else if (action.type === SPINNER_MESSAGE_REMOVE && !spinnerState.timeout && spinnerState.messages.length > 0 &&\r\n    spinnerState.messages.filter(({removed}) => !removed).length === 0\r\n  ) {\r\n    dispatch(setSpinnerTimeout(setTimeout(() => dispatch(flushSpinner()), SPINNER_TIMEOUT)));\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport default requestSpinnerMiddlewareFactory;","import {configureStore} from \"@reduxjs/toolkit\";\r\nimport rootReducer from \"./state/rootReducer\";\r\nimport userMiddlewareFactory from \"./middlewares/user/userMiddlewareFactory\";\r\nimport requestMiddlewareFactory from \"./middlewares/request/requestMiddlewareFactory\";\r\nimport {showGenericError, showTranslatedGenericErrorFactory} from \"./utils/other\";\r\nimport configMiddleware from \"./middlewares/config/configMiddleware\";\r\nimport fileSaveMiddleware from \"./middlewares/file-save/middleware\";\r\nimport persistenceMiddleware from \"./middlewares/persistence/middleware\";\r\nimport i18nMiddleware from \"./middlewares/i18n-middleware/middleware\";\r\nimport i18n from \"i18next\";\r\nimport {initReactI18next} from \"react-i18next\";\r\nimport {init as initAction} from \"./state/rootActions\";\r\nimport requestSpinnerMiddlewareFactory\r\n  from \"./middlewares/request-spinner/requestSpinnerMiddlewareFactory\";\r\nimport {getAppConfigUrl, getHubMinimalInfoUrl} from \"./serverApi/urls\";\r\n\r\nconst init = cb => {\r\n\r\n  fetch(`./${getAppConfigUrl()}`)\r\n    .then(response => response.json())\r\n    .then(({baseURL}) => {\r\n\r\n      fetch(`${baseURL}${getHubMinimalInfoUrl()}`)\r\n        .then(response => response.json())\r\n        .then(({hub}) => {\r\n\r\n          Promise.all(\r\n            hub.supportedLanguages.map(code =>\r\n              fetch(`./i18n/${code}.json`)\r\n                .then(response =>\r\n                  response.headers.get(\"content-type\").indexOf(\"application/json\") !== -1\r\n                    ? response.json()\r\n                    : null\r\n                )\r\n                .catch(showGenericError)\r\n            )\r\n          )\r\n            .then(translations => {\r\n\r\n              let resources = {};\r\n\r\n              hub.supportedLanguages.forEach((code, idx) => {\r\n                if (translations[idx]) {\r\n                  resources[code] = {translation: translations[idx]}\r\n                }\r\n              });\r\n\r\n              const supportedAndTranslatedLanguages = Object.keys(resources);\r\n              const defaultLanguage =\r\n                resources[hub.defaultLanguage]\r\n                  ? hub.defaultLanguage\r\n                  : supportedAndTranslatedLanguages[0];\r\n\r\n              i18n\r\n                .use(initReactI18next)\r\n                .init({\r\n                  lng: defaultLanguage,\r\n                  resources,\r\n                  returnEmptyString: false,\r\n                  interpolation: {\r\n                    escapeValue: false\r\n                  }\r\n                });\r\n\r\n              const store = configureStore({\r\n                reducer: rootReducer,\r\n                middleware: [\r\n                  userMiddlewareFactory(i18n.t.bind(i18n)),\r\n                  requestMiddlewareFactory({\r\n                    onGenericError: showTranslatedGenericErrorFactory(i18n.t.bind(i18n))\r\n                  }),\r\n                  requestSpinnerMiddlewareFactory(i18n.t.bind(i18n)),\r\n                  fileSaveMiddleware,\r\n                  persistenceMiddleware,\r\n                  i18nMiddleware,\r\n                  configMiddleware\r\n                ]\r\n              });\r\n\r\n              store.dispatch(initAction(baseURL, supportedAndTranslatedLanguages, defaultLanguage));\r\n\r\n              cb(store);\r\n\r\n            })\r\n            .catch(showGenericError);\r\n        })\r\n        .catch(showGenericError);\r\n    })\r\n    .catch(showGenericError);\r\n};\r\n\r\nexport default init;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport 'typeface-roboto';\r\nimport \"fontsource-do-hyeon\";\r\nimport \"./style.css\";\r\nimport 'flag-icon-css/css/flag-icon.css';\r\nimport {Provider} from 'react-redux'\r\nimport init from \"./init\";\r\n\r\ninit(store =>\r\n  ReactDOM.render(\r\n    <Provider store={store}>\r\n      <App/>\r\n    </Provider>,\r\n    document.getElementById('root')\r\n  ));\r\n"],"sourceRoot":""}